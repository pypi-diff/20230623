# Comparing `tmp/xarray-2023.5.0.tar.gz` & `tmp/xarray-2023.6.0.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "xarray-2023.5.0.tar", last modified: Fri May 19 02:36:32 2023, max compression
+gzip compressed data, was "xarray-2023.6.0.tar", last modified: Fri Jun 23 21:18:41 2023, max compression
```

## Comparing `xarray-2023.5.0.tar` & `xarray-2023.6.0.tar`

### file list

```diff
@@ -1,374 +1,373 @@
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.792526 xarray-2023.5.0/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.744524 xarray-2023.5.0/.binder/
--rw-r--r--   0 runner    (1001) docker     (123)      533 2023-05-19 02:36:14.000000 xarray-2023.5.0/.binder/environment.yml
--rw-r--r--   0 runner    (1001) docker     (123)      297 2023-05-19 02:36:14.000000 xarray-2023.5.0/.codecov.yml
--rw-r--r--   0 runner    (1001) docker     (123)      115 2023-05-19 02:36:14.000000 xarray-2023.5.0/.git-blame-ignore-revs
--rw-r--r--   0 runner    (1001) docker     (123)      125 2023-05-19 02:36:14.000000 xarray-2023.5.0/.git_archival.txt
--rw-r--r--   0 runner    (1001) docker     (123)      138 2023-05-19 02:36:14.000000 xarray-2023.5.0/.gitattributes
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.744524 xarray-2023.5.0/.github/
--rw-r--r--   0 runner    (1001) docker     (123)       62 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/FUNDING.yml
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.744524 xarray-2023.5.0/.github/ISSUE_TEMPLATE/
--rw-r--r--   0 runner    (1001) docker     (123)     2738 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/ISSUE_TEMPLATE/bugreport.yml
--rw-r--r--   0 runner    (1001) docker     (123)      702 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/ISSUE_TEMPLATE/config.yml
--rw-r--r--   0 runner    (1001) docker     (123)      490 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/ISSUE_TEMPLATE/misc.yml
--rw-r--r--   0 runner    (1001) docker     (123)     1158 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/ISSUE_TEMPLATE/newfeature.yml
--rw-r--r--   0 runner    (1001) docker     (123)      258 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/PULL_REQUEST_TEMPLATE.md
--rw-r--r--   0 runner    (1001) docker     (123)     1167 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/config.yml
--rw-r--r--   0 runner    (1001) docker     (123)      156 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/dependabot.yml
--rw-r--r--   0 runner    (1001) docker     (123)     1242 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/labeler.yml
--rw-r--r--   0 runner    (1001) docker     (123)     2133 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/stale.yml
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.744524 xarray-2023.5.0/.github/workflows/
--rw-r--r--   0 runner    (1001) docker     (123)     2582 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/benchmarks-last-release.yml
--rw-r--r--   0 runner    (1001) docker     (123)     2748 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/benchmarks.yml
--rw-r--r--   0 runner    (1001) docker     (123)     6662 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/ci-additional.yaml
--rw-r--r--   0 runner    (1001) docker     (123)     5047 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/ci.yaml
--rw-r--r--   0 runner    (1001) docker     (123)     1163 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/configure-testpypi-version.py
--rw-r--r--   0 runner    (1001) docker     (123)      298 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/label-all.yml
--rw-r--r--   0 runner    (1001) docker     (123)      221 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/label-prs.yml
--rw-r--r--   0 runner    (1001) docker     (123)     2446 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/parse_logs.py
--rw-r--r--   0 runner    (1001) docker     (123)     1360 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/publish-test-results.yaml
--rw-r--r--   0 runner    (1001) docker     (123)     2454 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/pypi-release.yaml
--rw-r--r--   0 runner    (1001) docker     (123)     2259 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/testpypi-release.yaml
--rw-r--r--   0 runner    (1001) docker     (123)     4523 2023-05-19 02:36:14.000000 xarray-2023.5.0/.github/workflows/upstream-dev-ci.yaml
--rw-r--r--   0 runner    (1001) docker     (123)      865 2023-05-19 02:36:14.000000 xarray-2023.5.0/.gitignore
--rw-r--r--   0 runner    (1001) docker     (123)      163 2023-05-19 02:36:14.000000 xarray-2023.5.0/.pep8speaks.yml
--rw-r--r--   0 runner    (1001) docker     (123)     1689 2023-05-19 02:36:14.000000 xarray-2023.5.0/.pre-commit-config.yaml
--rw-r--r--   0 runner    (1001) docker     (123)      383 2023-05-19 02:36:14.000000 xarray-2023.5.0/.readthedocs.yaml
--rw-r--r--   0 runner    (1001) docker     (123)     3064 2023-05-19 02:36:14.000000 xarray-2023.5.0/CITATION.cff
--rw-r--r--   0 runner    (1001) docker     (123)     3230 2023-05-19 02:36:14.000000 xarray-2023.5.0/CODE_OF_CONDUCT.md
--rw-r--r--   0 runner    (1001) docker     (123)      127 2023-05-19 02:36:14.000000 xarray-2023.5.0/CONTRIBUTING.md
--rw-r--r--   0 runner    (1001) docker     (123)     4763 2023-05-19 02:36:14.000000 xarray-2023.5.0/HOW_TO_RELEASE.md
--rw-r--r--   0 runner    (1001) docker     (123)    10273 2023-05-19 02:36:14.000000 xarray-2023.5.0/LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)     3495 2023-05-19 02:36:32.792526 xarray-2023.5.0/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     8944 2023-05-19 02:36:14.000000 xarray-2023.5.0/README.md
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.744524 xarray-2023.5.0/asv_bench/
--rw-r--r--   0 runner    (1001) docker     (123)     6350 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/asv.conf.json
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.748525 xarray-2023.5.0/asv_bench/benchmarks/
--rw-r--r--   0 runner    (1001) docker     (123)     7991 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/README_CI.md
--rw-r--r--   0 runner    (1001) docker     (123)     1654 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)      622 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/accessors.py
--rw-r--r--   0 runner    (1001) docker     (123)     1648 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/alignment.py
--rw-r--r--   0 runner    (1001) docker     (123)     1192 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/combine.py
--rw-r--r--   0 runner    (1001) docker     (123)     1872 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/dataarray_missing.py
--rw-r--r--   0 runner    (1001) docker     (123)    21598 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/dataset_io.py
--rw-r--r--   0 runner    (1001) docker     (123)     5881 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/groupby.py
--rw-r--r--   0 runner    (1001) docker     (123)      500 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/import.py
--rw-r--r--   0 runner    (1001) docker     (123)     5373 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/indexing.py
--rw-r--r--   0 runner    (1001) docker     (123)     1492 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/interp.py
--rw-r--r--   0 runner    (1001) docker     (123)     2443 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/merge.py
--rw-r--r--   0 runner    (1001) docker     (123)     1674 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/pandas.py
--rw-r--r--   0 runner    (1001) docker     (123)     1021 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/polyfit.py
--rw-r--r--   0 runner    (1001) docker     (123)     1379 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/reindexing.py
--rw-r--r--   0 runner    (1001) docker     (123)      784 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/renaming.py
--rw-r--r--   0 runner    (1001) docker     (123)     1037 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/repr.py
--rw-r--r--   0 runner    (1001) docker     (123)     4603 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/rolling.py
--rw-r--r--   0 runner    (1001) docker     (123)     1860 2023-05-19 02:36:14.000000 xarray-2023.5.0/asv_bench/benchmarks/unstacking.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.748525 xarray-2023.5.0/ci/
--rwxr-xr-x   0 runner    (1001) docker     (123)     1232 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/install-upstream-wheels.sh
--rwxr-xr-x   0 runner    (1001) docker     (123)     6709 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/min_deps_check.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.748525 xarray-2023.5.0/ci/requirements/
--rw-r--r--   0 runner    (1001) docker     (123)      601 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/requirements/all-but-dask.yml
--rw-r--r--   0 runner    (1001) docker     (123)      237 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/requirements/bare-minimum.yml
--rw-r--r--   0 runner    (1001) docker     (123)      812 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/requirements/doc.yml
--rw-r--r--   0 runner    (1001) docker     (123)      661 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/requirements/environment-py311.yml
--rw-r--r--   0 runner    (1001) docker     (123)      636 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/requirements/environment-windows-py311.yml
--rw-r--r--   0 runner    (1001) docker     (123)      635 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/requirements/environment-windows.yml
--rw-r--r--   0 runner    (1001) docker     (123)      658 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/requirements/environment.yml
--rw-r--r--   0 runner    (1001) docker     (123)     1289 2023-05-19 02:36:14.000000 xarray-2023.5.0/ci/requirements/min-all-deps.yml
--rw-r--r--   0 runner    (1001) docker     (123)     1232 2023-05-19 02:36:14.000000 xarray-2023.5.0/conftest.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.748525 xarray-2023.5.0/design_notes/
--rw-r--r--   0 runner    (1001) docker     (123)    28105 2023-05-19 02:36:14.000000 xarray-2023.5.0/design_notes/flexible_indexes_notes.md
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.752524 xarray-2023.5.0/doc/
--rw-r--r--   0 runner    (1001) docker     (123)     8471 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/Makefile
--rw-r--r--   0 runner    (1001) docker     (123)      189 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/README.rst
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.756525 xarray-2023.5.0/doc/_static/
--rw-r--r--   0 runner    (1001) docker     (123)       46 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/.gitignore
--rw-r--r--   0 runner    (1001) docker     (123)    31185 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/advanced_selection_interpolation.svg
--rw-r--r--   0 runner    (1001) docker     (123)   114027 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/ci.png
--rw-r--r--   0 runner    (1001) docker     (123)    13488 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dask_array.png
--rwxr-xr-x   0 runner    (1001) docker     (123)       63 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dataset-diagram-build.sh
--rw-r--r--   0 runner    (1001) docker     (123)    13358 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dataset-diagram-logo.pdf
--rw-r--r--   0 runner    (1001) docker     (123)   117124 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dataset-diagram-logo.png
--rw-r--r--   0 runner    (1001) docker     (123)    66565 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dataset-diagram-logo.svg
--rw-r--r--   0 runner    (1001) docker     (123)    11200 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dataset-diagram-logo.tex
--rw-r--r--   0 runner    (1001) docker     (123)   183796 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dataset-diagram-square-logo.png
--rw-r--r--   0 runner    (1001) docker     (123)    10947 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dataset-diagram-square-logo.tex
--rw-r--r--   0 runner    (1001) docker     (123)    45348 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dataset-diagram.png
--rw-r--r--   0 runner    (1001) docker     (123)    10875 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/dataset-diagram.tex
--rw-r--r--   0 runner    (1001) docker     (123)     4286 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/favicon.ico
--rw-r--r--   0 runner    (1001) docker     (123)     3519 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/index_api.svg
--rw-r--r--   0 runner    (1001) docker     (123)     2528 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/index_contribute.svg
--rw-r--r--   0 runner    (1001) docker     (123)     3977 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/index_getting_started.svg
--rw-r--r--   0 runner    (1001) docker     (123)     6429 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/index_user_guide.svg
--rw-r--r--   0 runner    (1001) docker     (123)    24992 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/numfocus_logo.png
--rw-r--r--   0 runner    (1001) docker     (123)   104979 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/opendap-prism-tmax.png
--rw-r--r--   0 runner    (1001) docker     (123)     4761 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/style.css
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.756525 xarray-2023.5.0/doc/_static/thumbnails/
--rw-r--r--   0 runner    (1001) docker     (123)    32739 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/thumbnails/ERA5-GRIB-example.png
--rw-r--r--   0 runner    (1001) docker     (123)    77903 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/thumbnails/ROMS_ocean_model.png
--rw-r--r--   0 runner    (1001) docker     (123)    26018 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/thumbnails/area_weighted_temperature.png
--rw-r--r--   0 runner    (1001) docker     (123)   454794 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/thumbnails/monthly-means.png
--rw-r--r--   0 runner    (1001) docker     (123)    57609 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/thumbnails/multidimensional-coords.png
--rw-r--r--   0 runner    (1001) docker     (123)    37844 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/thumbnails/toy-weather-data.png
--rw-r--r--   0 runner    (1001) docker     (123)    43053 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/thumbnails/visualization_gallery.png
--rw-r--r--   0 runner    (1001) docker     (123)   664021 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_static/view-docs.png
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.736524 xarray-2023.5.0/doc/_templates/
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.760525 xarray-2023.5.0/doc/_templates/autosummary/
--rw-r--r--   0 runner    (1001) docker     (123)      151 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_templates/autosummary/accessor.rst
--rw-r--r--   0 runner    (1001) docker     (123)      160 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_templates/autosummary/accessor_attribute.rst
--rw-r--r--   0 runner    (1001) docker     (123)      168 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_templates/autosummary/accessor_callable.rst
--rw-r--r--   0 runner    (1001) docker     (123)      157 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/_templates/autosummary/accessor_method.rst
--rw-r--r--   0 runner    (1001) docker     (123)    19245 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/api-hidden.rst
--rw-r--r--   0 runner    (1001) docker     (123)    21379 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/api.rst
--rw-r--r--   0 runner    (1001) docker     (123)    14643 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/conf.py
--rw-r--r--   0 runner    (1001) docker     (123)    42845 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/contributing.rst
--rw-r--r--   0 runner    (1001) docker     (123)     1200 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/developers-meeting.rst
--rw-r--r--   0 runner    (1001) docker     (123)     9097 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/ecosystem.rst
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.760525 xarray-2023.5.0/doc/examples/
--rw-r--r--   0 runner    (1001) docker     (123)     2823 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/ERA5-GRIB-example.ipynb
--rw-r--r--   0 runner    (1001) docker     (123)     7270 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/ROMS_ocean_model.ipynb
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.760525 xarray-2023.5.0/doc/examples/_code/
--rw-r--r--   0 runner    (1001) docker     (123)      703 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/_code/accessor_example.py
--rw-r--r--   0 runner    (1001) docker     (123)    28228 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/apply_ufunc_vectorize_1d.ipynb
--rw-r--r--   0 runner    (1001) docker     (123)     6187 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/area_weighted_temperature.ipynb
--rw-r--r--   0 runner    (1001) docker     (123)     1107 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/blank_template.ipynb
--rw-r--r--   0 runner    (1001) docker     (123)     7510 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/monthly-means.ipynb
--rw-r--r--   0 runner    (1001) docker     (123)   445711 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/monthly_means_output.png
--rw-r--r--   0 runner    (1001) docker     (123)     6742 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/multidimensional-coords.ipynb
--rw-r--r--   0 runner    (1001) docker     (123)     8569 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/visualization_gallery.ipynb
--rw-r--r--   0 runner    (1001) docker     (123)     8734 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/examples/weather-data.ipynb
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.760525 xarray-2023.5.0/doc/gallery/
--rw-r--r--   0 runner    (1001) docker     (123)       30 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/gallery/README.txt
--rw-r--r--   0 runner    (1001) docker     (123)     1285 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/gallery/plot_cartopy_facetgrid.py
--rw-r--r--   0 runner    (1001) docker     (123)     1035 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/gallery/plot_colorbar_center.py
--rw-r--r--   0 runner    (1001) docker     (123)      848 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/gallery/plot_control_colorbar.py
--rw-r--r--   0 runner    (1001) docker     (123)      908 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/gallery/plot_lines_from_2d.py
--rw-r--r--   0 runner    (1001) docker     (123)      747 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/gallery.rst
--rw-r--r--   0 runner    (1001) docker     (123)     1844 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/gallery.yml
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.760525 xarray-2023.5.0/doc/getting-started-guide/
--rw-r--r--   0 runner    (1001) docker     (123)    20697 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/getting-started-guide/faq.rst
--rw-r--r--   0 runner    (1001) docker     (123)      346 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/getting-started-guide/index.rst
--rw-r--r--   0 runner    (1001) docker     (123)     6801 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/getting-started-guide/installing.rst
--rw-r--r--   0 runner    (1001) docker     (123)     7747 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/getting-started-guide/quick-overview.rst
--rw-r--r--   0 runner    (1001) docker     (123)     5851 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/getting-started-guide/why-xarray.rst
--rw-r--r--   0 runner    (1001) docker     (123)     4535 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/howdoi.rst
--rw-r--r--   0 runner    (1001) docker     (123)     2799 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/index.rst
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.764525 xarray-2023.5.0/doc/internals/
--rw-r--r--   0 runner    (1001) docker     (123)     1416 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/internals/duck-arrays-integration.rst
--rw-r--r--   0 runner    (1001) docker     (123)     4040 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/internals/extending-xarray.rst
--rw-r--r--   0 runner    (1001) docker     (123)    17684 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/internals/how-to-add-new-backend.rst
--rw-r--r--   0 runner    (1001) docker     (123)      490 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/internals/index.rst
--rw-r--r--   0 runner    (1001) docker     (123)     1561 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/internals/variable-objects.rst
--rw-r--r--   0 runner    (1001) docker     (123)     3083 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/internals/zarr-encoding-spec.rst
--rw-r--r--   0 runner    (1001) docker     (123)    12008 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/roadmap.rst
--rw-r--r--   0 runner    (1001) docker     (123)     1087 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/tutorials-and-videos.rst
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.764525 xarray-2023.5.0/doc/user-guide/
--rw-r--r--   0 runner    (1001) docker     (123)    11116 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/combining.rst
--rw-r--r--   0 runner    (1001) docker     (123)    29189 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/computation.rst
--rw-r--r--   0 runner    (1001) docker     (123)    23127 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/dask.rst
--rw-r--r--   0 runner    (1001) docker     (123)    21446 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/data-structures.rst
--rw-r--r--   0 runner    (1001) docker     (123)     2812 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/duckarrays.rst
--rw-r--r--   0 runner    (1001) docker     (123)     7383 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/groupby.rst
--rw-r--r--   0 runner    (1001) docker     (123)      428 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/index.rst
--rw-r--r--   0 runner    (1001) docker     (123)    27433 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/indexing.rst
--rw-r--r--   0 runner    (1001) docker     (123)    10483 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/interpolation.rst
--rw-r--r--   0 runner    (1001) docker     (123)    47085 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/io.rst
--rw-r--r--   0 runner    (1001) docker     (123)      844 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/options.rst
--rw-r--r--   0 runner    (1001) docker     (123)     8704 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/pandas.rst
--rw-r--r--   0 runner    (1001) docker     (123)    31542 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/plotting.rst
--rw-r--r--   0 runner    (1001) docker     (123)    11220 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/reshaping.rst
--rw-r--r--   0 runner    (1001) docker     (123)     6179 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/terminology.rst
--rw-r--r--   0 runner    (1001) docker     (123)     8365 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/time-series.rst
--rw-r--r--   0 runner    (1001) docker     (123)     9199 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/user-guide/weather-climate.rst
--rw-r--r--   0 runner    (1001) docker     (123)     2479 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/videos.yml
--rw-r--r--   0 runner    (1001) docker     (123)   321108 2023-05-19 02:36:14.000000 xarray-2023.5.0/doc/whats-new.rst
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.768525 xarray-2023.5.0/licenses/
--rw-r--r--   0 runner    (1001) docker     (123)     1485 2023-05-19 02:36:14.000000 xarray-2023.5.0/licenses/DASK_LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)    18656 2023-05-19 02:36:14.000000 xarray-2023.5.0/licenses/ICOMOON_LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)     1543 2023-05-19 02:36:14.000000 xarray-2023.5.0/licenses/NUMPY_LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)     1678 2023-05-19 02:36:14.000000 xarray-2023.5.0/licenses/PANDAS_LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)    12761 2023-05-19 02:36:14.000000 xarray-2023.5.0/licenses/PYTHON_LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)     1531 2023-05-19 02:36:14.000000 xarray-2023.5.0/licenses/SCIKIT_LEARN_LICENSE
--rw-r--r--   0 runner    (1001) docker     (123)     1498 2023-05-19 02:36:14.000000 xarray-2023.5.0/licenses/SEABORN_LICENSE
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.768525 xarray-2023.5.0/properties/
--rw-r--r--   0 runner    (1001) docker     (123)      993 2023-05-19 02:36:14.000000 xarray-2023.5.0/properties/README.md
--rw-r--r--   0 runner    (1001) docker     (123)      244 2023-05-19 02:36:14.000000 xarray-2023.5.0/properties/conftest.py
--rw-r--r--   0 runner    (1001) docker     (123)     1397 2023-05-19 02:36:14.000000 xarray-2023.5.0/properties/test_encode_decode.py
--rw-r--r--   0 runner    (1001) docker     (123)     3075 2023-05-19 02:36:14.000000 xarray-2023.5.0/properties/test_pandas_roundtrip.py
--rw-r--r--   0 runner    (1001) docker     (123)     1773 2023-05-19 02:36:14.000000 xarray-2023.5.0/pyproject.toml
--rw-r--r--   0 runner    (1001) docker     (123)      278 2023-05-19 02:36:14.000000 xarray-2023.5.0/requirements.txt
--rw-r--r--   0 runner    (1001) docker     (123)     4580 2023-05-19 02:36:32.796526 xarray-2023.5.0/setup.cfg
--rwxr-xr-x   0 runner    (1001) docker     (123)      103 2023-05-19 02:36:14.000000 xarray-2023.5.0/setup.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.768525 xarray-2023.5.0/xarray/
--rw-r--r--   0 runner    (1001) docker     (123)     2843 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.772525 xarray-2023.5.0/xarray/backends/
--rw-r--r--   0 runner    (1001) docker     (123)     1708 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    66968 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/api.py
--rw-r--r--   0 runner    (1001) docker     (123)    13833 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/common.py
--rw-r--r--   0 runner    (1001) docker     (123)    12264 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/file_manager.py
--rw-r--r--   0 runner    (1001) docker     (123)    13947 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/h5netcdf_.py
--rw-r--r--   0 runner    (1001) docker     (123)     5595 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/locks.py
--rw-r--r--   0 runner    (1001) docker     (123)     3661 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/lru_cache.py
--rw-r--r--   0 runner    (1001) docker     (123)     1392 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/memory.py
--rw-r--r--   0 runner    (1001) docker     (123)    20307 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/netCDF4_.py
--rw-r--r--   0 runner    (1001) docker     (123)     4163 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/netcdf3.py
--rw-r--r--   0 runner    (1001) docker     (123)     8172 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/plugins.py
--rw-r--r--   0 runner    (1001) docker     (123)     5696 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/pseudonetcdf_.py
--rw-r--r--   0 runner    (1001) docker     (123)     6472 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/pydap_.py
--rw-r--r--   0 runner    (1001) docker     (123)     4893 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/pynio_.py
--rw-r--r--   0 runner    (1001) docker     (123)    10902 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/scipy_.py
--rw-r--r--   0 runner    (1001) docker     (123)     2062 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/store.py
--rw-r--r--   0 runner    (1001) docker     (123)    35357 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/backends/zarr.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.772525 xarray-2023.5.0/xarray/coding/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/coding/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    13824 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/coding/calendar_ops.py
--rw-r--r--   0 runner    (1001) docker     (123)    47274 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/coding/cftime_offsets.py
--rw-r--r--   0 runner    (1001) docker     (123)    29864 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/coding/cftimeindex.py
--rw-r--r--   0 runner    (1001) docker     (123)     9256 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/coding/frequencies.py
--rw-r--r--   0 runner    (1001) docker     (123)     8041 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/coding/strings.py
--rw-r--r--   0 runner    (1001) docker     (123)    27896 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/coding/times.py
--rw-r--r--   0 runner    (1001) docker     (123)    19168 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/coding/variables.py
--rw-r--r--   0 runner    (1001) docker     (123)    29000 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/conventions.py
--rw-r--r--   0 runner    (1001) docker     (123)     9712 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/convert.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.780526 xarray-2023.5.0/xarray/core/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)   293555 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/_aggregations.py
--rw-r--r--   0 runner    (1001) docker     (123)    28533 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/_typed_ops.py
--rw-r--r--   0 runner    (1001) docker     (123)    32142 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/_typed_ops.pyi
--rw-r--r--   0 runner    (1001) docker     (123)    20311 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/accessor_dt.py
--rw-r--r--   0 runner    (1001) docker     (123)    98648 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/accessor_str.py
--rw-r--r--   0 runner    (1001) docker     (123)    37538 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/alignment.py
--rw-r--r--   0 runner    (1001) docker     (123)     4406 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/arithmetic.py
--rw-r--r--   0 runner    (1001) docker     (123)    37528 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/combine.py
--rw-r--r--   0 runner    (1001) docker     (123)    68915 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/common.py
--rw-r--r--   0 runner    (1001) docker     (123)    75278 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/computation.py
--rw-r--r--   0 runner    (1001) docker     (123)    28139 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/concat.py
--rw-r--r--   0 runner    (1001) docker     (123)    16433 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/coordinates.py
--rw-r--r--   0 runner    (1001) docker     (123)     3078 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/dask_array_ops.py
--rw-r--r--   0 runner    (1001) docker     (123)     6190 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/daskmanager.py
--rw-r--r--   0 runner    (1001) docker     (123)   258467 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/dataarray.py
--rw-r--r--   0 runner    (1001) docker     (123)   357417 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/dataset.py
--rw-r--r--   0 runner    (1001) docker     (123)     4869 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/dtypes.py
--rw-r--r--   0 runner    (1001) docker     (123)    23561 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/duck_array_ops.py
--rw-r--r--   0 runner    (1001) docker     (123)     3516 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/extensions.py
--rw-r--r--   0 runner    (1001) docker     (123)    27908 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/formatting.py
--rw-r--r--   0 runner    (1001) docker     (123)    10214 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/formatting_html.py
--rw-r--r--   0 runner    (1001) docker     (123)    56789 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/groupby.py
--rw-r--r--   0 runner    (1001) docker     (123)    54154 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/indexes.py
--rw-r--r--   0 runner    (1001) docker     (123)    57900 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/indexing.py
--rw-r--r--   0 runner    (1001) docker     (123)    39490 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/merge.py
--rw-r--r--   0 runner    (1001) docker     (123)    26507 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/missing.py
--rw-r--r--   0 runner    (1001) docker     (123)     5644 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/nanops.py
--rw-r--r--   0 runner    (1001) docker     (123)     1593 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/npcompat.py
--rw-r--r--   0 runner    (1001) docker     (123)     8209 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/nputils.py
--rw-r--r--   0 runner    (1001) docker     (123)     9973 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/ops.py
--rw-r--r--   0 runner    (1001) docker     (123)    11050 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/options.py
--rw-r--r--   0 runner    (1001) docker     (123)    22317 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/parallel.py
--rw-r--r--   0 runner    (1001) docker     (123)     9105 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/parallelcompat.py
--rw-r--r--   0 runner    (1001) docker     (123)     3903 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/pdcompat.py
--rw-r--r--   0 runner    (1001) docker     (123)     2762 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/pycompat.py
--rw-r--r--   0 runner    (1001) docker     (123)    14121 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/resample.py
--rw-r--r--   0 runner    (1001) docker     (123)    19469 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/resample_cftime.py
--rw-r--r--   0 runner    (1001) docker     (123)    40165 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/rolling.py
--rw-r--r--   0 runner    (1001) docker     (123)     5745 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/rolling_exp.py
--rw-r--r--   0 runner    (1001) docker     (123)     6750 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/types.py
--rw-r--r--   0 runner    (1001) docker     (123)    37270 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)   122140 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/variable.py
--rw-r--r--   0 runner    (1001) docker     (123)    19161 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/core/weighted.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.780526 xarray-2023.5.0/xarray/indexes/
--rw-r--r--   0 runner    (1001) docker     (123)      226 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/indexes/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.780526 xarray-2023.5.0/xarray/plot/
--rw-r--r--   0 runner    (1001) docker     (123)      573 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/plot/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)    41974 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/plot/accessor.py
--rw-r--r--   0 runner    (1001) docker     (123)    86031 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/plot/dataarray_plot.py
--rw-r--r--   0 runner    (1001) docker     (123)    30818 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/plot/dataset_plot.py
--rw-r--r--   0 runner    (1001) docker     (123)    37227 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/plot/facetgrid.py
--rw-r--r--   0 runner    (1001) docker     (123)    59520 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/plot/utils.py
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/py.typed
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.780526 xarray-2023.5.0/xarray/static/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/static/__init__.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.780526 xarray-2023.5.0/xarray/static/css/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/static/css/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     6075 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/static/css/style.css
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.780526 xarray-2023.5.0/xarray/static/html/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/static/html/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     1343 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/static/html/icons-svg-inline.html
--rw-r--r--   0 runner    (1001) docker     (123)    14507 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/testing.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.792526 xarray-2023.5.0/xarray/tests/
--rw-r--r--   0 runner    (1001) docker     (123)     8789 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     2145 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/conftest.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.792526 xarray-2023.5.0/xarray/tests/data/
--rw-r--r--   0 runner    (1001) docker     (123)     1184 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/data/bears.nc
--rw-r--r--   0 runner    (1001) docker     (123)     5232 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/data/example.grib
--rw-r--r--   0 runner    (1001) docker     (123)      783 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/data/example.ict
--rw-r--r--   0 runner    (1001) docker     (123)      608 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/data/example.uamiv
--rw-r--r--   0 runner    (1001) docker     (123)     1736 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/data/example_1.nc
--rw-r--r--   0 runner    (1001) docker     (123)      470 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/data/example_1.nc.gz
--rw-r--r--   0 runner    (1001) docker     (123)    20566 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_accessor_dt.py
--rw-r--r--   0 runner    (1001) docker     (123)   121928 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_accessor_str.py
--rw-r--r--   0 runner    (1001) docker     (123)     3705 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_array_api.py
--rw-r--r--   0 runner    (1001) docker     (123)   205421 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_backends.py
--rw-r--r--   0 runner    (1001) docker     (123)     7152 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_backends_api.py
--rw-r--r--   0 runner    (1001) docker     (123)      774 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_backends_common.py
--rw-r--r--   0 runner    (1001) docker     (123)     7176 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_backends_file_manager.py
--rw-r--r--   0 runner    (1001) docker     (123)      366 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_backends_locks.py
--rw-r--r--   0 runner    (1001) docker     (123)     2300 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_backends_lru_cache.py
--rw-r--r--   0 runner    (1001) docker     (123)     7536 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_calendar_ops.py
--rw-r--r--   0 runner    (1001) docker     (123)    44969 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_cftime_offsets.py
--rw-r--r--   0 runner    (1001) docker     (123)    40106 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_cftimeindex.py
--rw-r--r--   0 runner    (1001) docker     (123)     9248 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_cftimeindex_resample.py
--rw-r--r--   0 runner    (1001) docker     (123)    11478 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_coarsen.py
--rw-r--r--   0 runner    (1001) docker     (123)     5162 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_coding.py
--rw-r--r--   0 runner    (1001) docker     (123)     8071 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_coding_strings.py
--rw-r--r--   0 runner    (1001) docker     (123)    43161 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_coding_times.py
--rw-r--r--   0 runner    (1001) docker     (123)    44271 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_combine.py
--rw-r--r--   0 runner    (1001) docker     (123)    77115 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_computation.py
--rw-r--r--   0 runner    (1001) docker     (123)    46051 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_concat.py
--rw-r--r--   0 runner    (1001) docker     (123)    18885 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_conventions.py
--rw-r--r--   0 runner    (1001) docker     (123)     1681 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_cupy.py
--rw-r--r--   0 runner    (1001) docker     (123)    60630 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_dask.py
--rw-r--r--   0 runner    (1001) docker     (123)   248255 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_dataarray.py
--rw-r--r--   0 runner    (1001) docker     (123)   260970 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_dataset.py
--rw-r--r--   0 runner    (1001) docker     (123)     4300 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_deprecation_helpers.py
--rw-r--r--   0 runner    (1001) docker     (123)     7699 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_distributed.py
--rw-r--r--   0 runner    (1001) docker     (123)     3472 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_dtypes.py
--rw-r--r--   0 runner    (1001) docker     (123)    30666 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_duck_array_ops.py
--rw-r--r--   0 runner    (1001) docker     (123)     2737 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_extensions.py
--rw-r--r--   0 runner    (1001) docker     (123)    24804 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_formatting.py
--rw-r--r--   0 runner    (1001) docker     (123)     6549 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_formatting_html.py
--rw-r--r--   0 runner    (1001) docker     (123)    84822 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_groupby.py
--rw-r--r--   0 runner    (1001) docker     (123)    25785 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_indexes.py
--rw-r--r--   0 runner    (1001) docker     (123)    31184 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_indexing.py
--rw-r--r--   0 runner    (1001) docker     (123)    29970 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_interp.py
--rw-r--r--   0 runner    (1001) docker     (123)    18119 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_merge.py
--rw-r--r--   0 runner    (1001) docker     (123)    23834 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_missing.py
--rw-r--r--   0 runner    (1001) docker     (123)      987 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_nputils.py
--rw-r--r--   0 runner    (1001) docker     (123)     7670 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_options.py
--rw-r--r--   0 runner    (1001) docker     (123)     6984 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_parallelcompat.py
--rw-r--r--   0 runner    (1001) docker     (123)   119180 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_plot.py
--rw-r--r--   0 runner    (1001) docker     (123)    10361 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_plugins.py
--rw-r--r--   0 runner    (1001) docker     (123)      200 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_print_versions.py
--rw-r--r--   0 runner    (1001) docker     (123)    31207 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_rolling.py
--rw-r--r--   0 runner    (1001) docker     (123)    28760 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_sparse.py
--rw-r--r--   0 runner    (1001) docker     (123)     4723 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_testing.py
--rw-r--r--   0 runner    (1001) docker     (123)      982 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_tutorial.py
--rw-r--r--   0 runner    (1001) docker     (123)     4738 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_ufuncs.py
--rw-r--r--   0 runner    (1001) docker     (123)   188860 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_units.py
--rw-r--r--   0 runner    (1001) docker     (123)    11253 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_utils.py
--rw-r--r--   0 runner    (1001) docker     (123)   111128 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_variable.py
--rw-r--r--   0 runner    (1001) docker     (123)    24189 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tests/test_weighted.py
--rw-r--r--   0 runner    (1001) docker     (123)     7254 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/tutorial.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.792526 xarray-2023.5.0/xarray/util/
--rw-r--r--   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/util/__init__.py
--rw-r--r--   0 runner    (1001) docker     (123)     4272 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/util/deprecation_helpers.py
--rw-r--r--   0 runner    (1001) docker     (123)    17583 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/util/generate_aggregations.py
--rw-r--r--   0 runner    (1001) docker     (123)     9354 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/util/generate_ops.py
--rwxr-xr-x   0 runner    (1001) docker     (123)     5219 2023-05-19 02:36:14.000000 xarray-2023.5.0/xarray/util/print_versions.py
-drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-05-19 02:36:32.768525 xarray-2023.5.0/xarray.egg-info/
--rw-r--r--   0 runner    (1001) docker     (123)     3495 2023-05-19 02:36:32.000000 xarray-2023.5.0/xarray.egg-info/PKG-INFO
--rw-r--r--   0 runner    (1001) docker     (123)     9839 2023-05-19 02:36:32.000000 xarray-2023.5.0/xarray.egg-info/SOURCES.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-05-19 02:36:32.000000 xarray-2023.5.0/xarray.egg-info/dependency_links.txt
--rw-r--r--   0 runner    (1001) docker     (123)       66 2023-05-19 02:36:32.000000 xarray-2023.5.0/xarray.egg-info/entry_points.txt
--rw-r--r--   0 runner    (1001) docker     (123)        1 2023-05-19 02:36:32.000000 xarray-2023.5.0/xarray.egg-info/not-zip-safe
--rw-r--r--   0 runner    (1001) docker     (123)      671 2023-05-19 02:36:32.000000 xarray-2023.5.0/xarray.egg-info/requires.txt
--rw-r--r--   0 runner    (1001) docker     (123)        7 2023-05-19 02:36:32.000000 xarray-2023.5.0/xarray.egg-info/top_level.txt
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.852270 xarray-2023.6.0/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.776270 xarray-2023.6.0/.binder/
+-rw-r--r--   0 runner    (1001) docker     (123)      533 2023-06-23 21:18:22.000000 xarray-2023.6.0/.binder/environment.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      297 2023-06-23 21:18:22.000000 xarray-2023.6.0/.codecov.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      115 2023-06-23 21:18:22.000000 xarray-2023.6.0/.git-blame-ignore-revs
+-rw-r--r--   0 runner    (1001) docker     (123)      125 2023-06-23 21:18:22.000000 xarray-2023.6.0/.git_archival.txt
+-rw-r--r--   0 runner    (1001) docker     (123)      138 2023-06-23 21:18:22.000000 xarray-2023.6.0/.gitattributes
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.776270 xarray-2023.6.0/.github/
+-rw-r--r--   0 runner    (1001) docker     (123)       62 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/FUNDING.yml
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.776270 xarray-2023.6.0/.github/ISSUE_TEMPLATE/
+-rw-r--r--   0 runner    (1001) docker     (123)     2738 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/ISSUE_TEMPLATE/bugreport.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      702 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/ISSUE_TEMPLATE/config.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      490 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/ISSUE_TEMPLATE/misc.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     1158 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/ISSUE_TEMPLATE/newfeature.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      258 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/PULL_REQUEST_TEMPLATE.md
+-rw-r--r--   0 runner    (1001) docker     (123)     1167 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/config.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      156 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/dependabot.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     1242 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/labeler.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     2133 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/stale.yml
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.780269 xarray-2023.6.0/.github/workflows/
+-rw-r--r--   0 runner    (1001) docker     (123)     2589 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/benchmarks-last-release.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     2755 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/benchmarks.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     6608 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/ci-additional.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)     5054 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/ci.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)     1163 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/configure-testpypi-version.py
+-rw-r--r--   0 runner    (1001) docker     (123)      298 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/label-all.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      221 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/label-prs.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     1122 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/nightly-wheels.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     1360 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/publish-test-results.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)     2762 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/pypi-release.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)     4514 2023-06-23 21:18:22.000000 xarray-2023.6.0/.github/workflows/upstream-dev-ci.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)      865 2023-06-23 21:18:22.000000 xarray-2023.6.0/.gitignore
+-rw-r--r--   0 runner    (1001) docker     (123)      163 2023-06-23 21:18:22.000000 xarray-2023.6.0/.pep8speaks.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     1689 2023-06-23 21:18:22.000000 xarray-2023.6.0/.pre-commit-config.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)      383 2023-06-23 21:18:22.000000 xarray-2023.6.0/.readthedocs.yaml
+-rw-r--r--   0 runner    (1001) docker     (123)     3064 2023-06-23 21:18:22.000000 xarray-2023.6.0/CITATION.cff
+-rw-r--r--   0 runner    (1001) docker     (123)     3230 2023-06-23 21:18:22.000000 xarray-2023.6.0/CODE_OF_CONDUCT.md
+-rw-r--r--   0 runner    (1001) docker     (123)      127 2023-06-23 21:18:22.000000 xarray-2023.6.0/CONTRIBUTING.md
+-rw-r--r--   0 runner    (1001) docker     (123)     4837 2023-06-23 21:18:22.000000 xarray-2023.6.0/HOW_TO_RELEASE.md
+-rw-r--r--   0 runner    (1001) docker     (123)    10273 2023-06-23 21:18:22.000000 xarray-2023.6.0/LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)     3495 2023-06-23 21:18:41.852270 xarray-2023.6.0/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     8944 2023-06-23 21:18:22.000000 xarray-2023.6.0/README.md
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.780269 xarray-2023.6.0/asv_bench/
+-rw-r--r--   0 runner    (1001) docker     (123)     6350 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/asv.conf.json
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.784269 xarray-2023.6.0/asv_bench/benchmarks/
+-rw-r--r--   0 runner    (1001) docker     (123)     7991 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/README_CI.md
+-rw-r--r--   0 runner    (1001) docker     (123)     1654 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)      622 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/accessors.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1648 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/alignment.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2417 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/combine.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1872 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/dataarray_missing.py
+-rw-r--r--   0 runner    (1001) docker     (123)    21598 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/dataset_io.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5881 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/groupby.py
+-rw-r--r--   0 runner    (1001) docker     (123)      500 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/import.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5373 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/indexing.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1492 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/interp.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2443 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/merge.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1763 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/pandas.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1021 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/polyfit.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1379 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/reindexing.py
+-rw-r--r--   0 runner    (1001) docker     (123)      784 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/renaming.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1037 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/repr.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4603 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/rolling.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1860 2023-06-23 21:18:22.000000 xarray-2023.6.0/asv_bench/benchmarks/unstacking.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.784269 xarray-2023.6.0/ci/
+-rwxr-xr-x   0 runner    (1001) docker     (123)     1232 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/install-upstream-wheels.sh
+-rwxr-xr-x   0 runner    (1001) docker     (123)     6709 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/min_deps_check.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.784269 xarray-2023.6.0/ci/requirements/
+-rw-r--r--   0 runner    (1001) docker     (123)      601 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/requirements/all-but-dask.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      237 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/requirements/bare-minimum.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      848 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/requirements/doc.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      655 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/requirements/environment-py311.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      636 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/requirements/environment-windows-py311.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      635 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/requirements/environment-windows.yml
+-rw-r--r--   0 runner    (1001) docker     (123)      658 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/requirements/environment.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     1289 2023-06-23 21:18:22.000000 xarray-2023.6.0/ci/requirements/min-all-deps.yml
+-rw-r--r--   0 runner    (1001) docker     (123)     1232 2023-06-23 21:18:22.000000 xarray-2023.6.0/conftest.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.784269 xarray-2023.6.0/design_notes/
+-rw-r--r--   0 runner    (1001) docker     (123)    28105 2023-06-23 21:18:22.000000 xarray-2023.6.0/design_notes/flexible_indexes_notes.md
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.788270 xarray-2023.6.0/doc/
+-rw-r--r--   0 runner    (1001) docker     (123)     8471 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/Makefile
+-rw-r--r--   0 runner    (1001) docker     (123)      189 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/README.rst
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.792270 xarray-2023.6.0/doc/_static/
+-rw-r--r--   0 runner    (1001) docker     (123)       46 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/.gitignore
+-rw-r--r--   0 runner    (1001) docker     (123)    31185 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/advanced_selection_interpolation.svg
+-rw-r--r--   0 runner    (1001) docker     (123)   114027 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/ci.png
+-rw-r--r--   0 runner    (1001) docker     (123)    13488 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dask_array.png
+-rwxr-xr-x   0 runner    (1001) docker     (123)       63 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dataset-diagram-build.sh
+-rw-r--r--   0 runner    (1001) docker     (123)    13358 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dataset-diagram-logo.pdf
+-rw-r--r--   0 runner    (1001) docker     (123)   117124 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dataset-diagram-logo.png
+-rw-r--r--   0 runner    (1001) docker     (123)    66565 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dataset-diagram-logo.svg
+-rw-r--r--   0 runner    (1001) docker     (123)    11200 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dataset-diagram-logo.tex
+-rw-r--r--   0 runner    (1001) docker     (123)   183796 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dataset-diagram-square-logo.png
+-rw-r--r--   0 runner    (1001) docker     (123)    10947 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dataset-diagram-square-logo.tex
+-rw-r--r--   0 runner    (1001) docker     (123)    45348 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dataset-diagram.png
+-rw-r--r--   0 runner    (1001) docker     (123)    10875 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/dataset-diagram.tex
+-rw-r--r--   0 runner    (1001) docker     (123)     4286 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/favicon.ico
+-rw-r--r--   0 runner    (1001) docker     (123)     3519 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/index_api.svg
+-rw-r--r--   0 runner    (1001) docker     (123)     2528 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/index_contribute.svg
+-rw-r--r--   0 runner    (1001) docker     (123)     3977 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/index_getting_started.svg
+-rw-r--r--   0 runner    (1001) docker     (123)     6429 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/index_user_guide.svg
+-rw-r--r--   0 runner    (1001) docker     (123)    24992 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/numfocus_logo.png
+-rw-r--r--   0 runner    (1001) docker     (123)   104979 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/opendap-prism-tmax.png
+-rw-r--r--   0 runner    (1001) docker     (123)     4761 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/style.css
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.796270 xarray-2023.6.0/doc/_static/thumbnails/
+-rw-r--r--   0 runner    (1001) docker     (123)    32739 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/thumbnails/ERA5-GRIB-example.png
+-rw-r--r--   0 runner    (1001) docker     (123)    77903 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/thumbnails/ROMS_ocean_model.png
+-rw-r--r--   0 runner    (1001) docker     (123)    26018 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/thumbnails/area_weighted_temperature.png
+-rw-r--r--   0 runner    (1001) docker     (123)   454794 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/thumbnails/monthly-means.png
+-rw-r--r--   0 runner    (1001) docker     (123)    57609 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/thumbnails/multidimensional-coords.png
+-rw-r--r--   0 runner    (1001) docker     (123)    37844 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/thumbnails/toy-weather-data.png
+-rw-r--r--   0 runner    (1001) docker     (123)    43053 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/thumbnails/visualization_gallery.png
+-rw-r--r--   0 runner    (1001) docker     (123)   664021 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_static/view-docs.png
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.772270 xarray-2023.6.0/doc/_templates/
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.796270 xarray-2023.6.0/doc/_templates/autosummary/
+-rw-r--r--   0 runner    (1001) docker     (123)      151 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_templates/autosummary/accessor.rst
+-rw-r--r--   0 runner    (1001) docker     (123)      160 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_templates/autosummary/accessor_attribute.rst
+-rw-r--r--   0 runner    (1001) docker     (123)      168 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_templates/autosummary/accessor_callable.rst
+-rw-r--r--   0 runner    (1001) docker     (123)      157 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/_templates/autosummary/accessor_method.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    19245 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/api-hidden.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    21379 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/api.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    14644 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/conf.py
+-rw-r--r--   0 runner    (1001) docker     (123)    42845 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/contributing.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     1259 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/developers-meeting.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     9097 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/ecosystem.rst
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.800270 xarray-2023.6.0/doc/examples/
+-rw-r--r--   0 runner    (1001) docker     (123)     2823 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/ERA5-GRIB-example.ipynb
+-rw-r--r--   0 runner    (1001) docker     (123)     7270 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/ROMS_ocean_model.ipynb
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.800270 xarray-2023.6.0/doc/examples/_code/
+-rw-r--r--   0 runner    (1001) docker     (123)      703 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/_code/accessor_example.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28228 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/apply_ufunc_vectorize_1d.ipynb
+-rw-r--r--   0 runner    (1001) docker     (123)     6187 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/area_weighted_temperature.ipynb
+-rw-r--r--   0 runner    (1001) docker     (123)     1107 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/blank_template.ipynb
+-rw-r--r--   0 runner    (1001) docker     (123)     7510 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/monthly-means.ipynb
+-rw-r--r--   0 runner    (1001) docker     (123)   445711 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/monthly_means_output.png
+-rw-r--r--   0 runner    (1001) docker     (123)     6742 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/multidimensional-coords.ipynb
+-rw-r--r--   0 runner    (1001) docker     (123)     6116 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/visualization_gallery.ipynb
+-rw-r--r--   0 runner    (1001) docker     (123)     8734 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/examples/weather-data.ipynb
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.800270 xarray-2023.6.0/doc/gallery/
+-rw-r--r--   0 runner    (1001) docker     (123)       30 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/gallery/README.txt
+-rw-r--r--   0 runner    (1001) docker     (123)     1285 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/gallery/plot_cartopy_facetgrid.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1035 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/gallery/plot_colorbar_center.py
+-rw-r--r--   0 runner    (1001) docker     (123)      848 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/gallery/plot_control_colorbar.py
+-rw-r--r--   0 runner    (1001) docker     (123)      908 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/gallery/plot_lines_from_2d.py
+-rw-r--r--   0 runner    (1001) docker     (123)      747 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/gallery.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     1844 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/gallery.yml
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.804270 xarray-2023.6.0/doc/getting-started-guide/
+-rw-r--r--   0 runner    (1001) docker     (123)    20697 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/getting-started-guide/faq.rst
+-rw-r--r--   0 runner    (1001) docker     (123)      346 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/getting-started-guide/index.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     6801 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/getting-started-guide/installing.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     7747 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/getting-started-guide/quick-overview.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     5851 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/getting-started-guide/why-xarray.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     4535 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/howdoi.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     2799 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/index.rst
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.804270 xarray-2023.6.0/doc/internals/
+-rw-r--r--   0 runner    (1001) docker     (123)     1416 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/internals/duck-arrays-integration.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     4040 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/internals/extending-xarray.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    17684 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/internals/how-to-add-new-backend.rst
+-rw-r--r--   0 runner    (1001) docker     (123)      490 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/internals/index.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     1561 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/internals/variable-objects.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     3083 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/internals/zarr-encoding-spec.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    12008 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/roadmap.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     1087 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/tutorials-and-videos.rst
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.808270 xarray-2023.6.0/doc/user-guide/
+-rw-r--r--   0 runner    (1001) docker     (123)    11116 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/combining.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    29189 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/computation.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    23127 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/dask.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    21446 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/data-structures.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     2812 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/duckarrays.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     7383 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/groupby.rst
+-rw-r--r--   0 runner    (1001) docker     (123)      428 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/index.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    27433 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/indexing.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    10483 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/interpolation.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    47085 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/io.rst
+-rw-r--r--   0 runner    (1001) docker     (123)      844 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/options.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     8704 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/pandas.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    31542 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/plotting.rst
+-rw-r--r--   0 runner    (1001) docker     (123)    11220 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/reshaping.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     6179 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/terminology.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     8365 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/time-series.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     9199 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/user-guide/weather-climate.rst
+-rw-r--r--   0 runner    (1001) docker     (123)     2479 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/videos.yml
+-rw-r--r--   0 runner    (1001) docker     (123)   324173 2023-06-23 21:18:22.000000 xarray-2023.6.0/doc/whats-new.rst
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.808270 xarray-2023.6.0/licenses/
+-rw-r--r--   0 runner    (1001) docker     (123)     1485 2023-06-23 21:18:22.000000 xarray-2023.6.0/licenses/DASK_LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)    18656 2023-06-23 21:18:22.000000 xarray-2023.6.0/licenses/ICOMOON_LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)     1543 2023-06-23 21:18:22.000000 xarray-2023.6.0/licenses/NUMPY_LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)     1678 2023-06-23 21:18:22.000000 xarray-2023.6.0/licenses/PANDAS_LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)    12761 2023-06-23 21:18:22.000000 xarray-2023.6.0/licenses/PYTHON_LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)     1531 2023-06-23 21:18:22.000000 xarray-2023.6.0/licenses/SCIKIT_LEARN_LICENSE
+-rw-r--r--   0 runner    (1001) docker     (123)     1498 2023-06-23 21:18:22.000000 xarray-2023.6.0/licenses/SEABORN_LICENSE
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.808270 xarray-2023.6.0/properties/
+-rw-r--r--   0 runner    (1001) docker     (123)      993 2023-06-23 21:18:22.000000 xarray-2023.6.0/properties/README.md
+-rw-r--r--   0 runner    (1001) docker     (123)      244 2023-06-23 21:18:22.000000 xarray-2023.6.0/properties/conftest.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1397 2023-06-23 21:18:22.000000 xarray-2023.6.0/properties/test_encode_decode.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3075 2023-06-23 21:18:22.000000 xarray-2023.6.0/properties/test_pandas_roundtrip.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1773 2023-06-23 21:18:22.000000 xarray-2023.6.0/pyproject.toml
+-rw-r--r--   0 runner    (1001) docker     (123)      278 2023-06-23 21:18:22.000000 xarray-2023.6.0/requirements.txt
+-rw-r--r--   0 runner    (1001) docker     (123)     4580 2023-06-23 21:18:41.852270 xarray-2023.6.0/setup.cfg
+-rwxr-xr-x   0 runner    (1001) docker     (123)      103 2023-06-23 21:18:22.000000 xarray-2023.6.0/setup.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.812270 xarray-2023.6.0/xarray/
+-rw-r--r--   0 runner    (1001) docker     (123)     2843 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.816270 xarray-2023.6.0/xarray/backends/
+-rw-r--r--   0 runner    (1001) docker     (123)     1708 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    66968 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/api.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13833 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/common.py
+-rw-r--r--   0 runner    (1001) docker     (123)    12498 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/file_manager.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13947 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/h5netcdf_.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5595 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/locks.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3661 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/lru_cache.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1392 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/memory.py
+-rw-r--r--   0 runner    (1001) docker     (123)    20445 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/netCDF4_.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4163 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/netcdf3.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8172 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/plugins.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5696 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/pseudonetcdf_.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6472 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/pydap_.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4893 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/pynio_.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10902 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/scipy_.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2062 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/store.py
+-rw-r--r--   0 runner    (1001) docker     (123)    35626 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/backends/zarr.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.816270 xarray-2023.6.0/xarray/coding/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/coding/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    13824 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/coding/calendar_ops.py
+-rw-r--r--   0 runner    (1001) docker     (123)    47274 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/coding/cftime_offsets.py
+-rw-r--r--   0 runner    (1001) docker     (123)    29864 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/coding/cftimeindex.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9256 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/coding/frequencies.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8130 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/coding/strings.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27896 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/coding/times.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19168 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/coding/variables.py
+-rw-r--r--   0 runner    (1001) docker     (123)    29123 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/conventions.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9712 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/convert.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.832270 xarray-2023.6.0/xarray/core/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)   293555 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/_aggregations.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28533 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/_typed_ops.py
+-rw-r--r--   0 runner    (1001) docker     (123)    32142 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/_typed_ops.pyi
+-rw-r--r--   0 runner    (1001) docker     (123)    20311 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/accessor_dt.py
+-rw-r--r--   0 runner    (1001) docker     (123)    99007 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/accessor_str.py
+-rw-r--r--   0 runner    (1001) docker     (123)    37538 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/alignment.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4406 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/arithmetic.py
+-rw-r--r--   0 runner    (1001) docker     (123)    37464 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/combine.py
+-rw-r--r--   0 runner    (1001) docker     (123)    68915 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/common.py
+-rw-r--r--   0 runner    (1001) docker     (123)    75278 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/computation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28496 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/concat.py
+-rw-r--r--   0 runner    (1001) docker     (123)    16433 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/coordinates.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3078 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/dask_array_ops.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6190 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/daskmanager.py
+-rw-r--r--   0 runner    (1001) docker     (123)   263588 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/dataarray.py
+-rw-r--r--   0 runner    (1001) docker     (123)   360536 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/dataset.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5045 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/dtypes.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23633 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/duck_array_ops.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3516 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/extensions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    27908 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/formatting.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10214 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/formatting_html.py
+-rw-r--r--   0 runner    (1001) docker     (123)    56933 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/groupby.py
+-rw-r--r--   0 runner    (1001) docker     (123)    54152 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/indexes.py
+-rw-r--r--   0 runner    (1001) docker     (123)    57900 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/indexing.py
+-rw-r--r--   0 runner    (1001) docker     (123)    39754 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/merge.py
+-rw-r--r--   0 runner    (1001) docker     (123)    26507 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/missing.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5644 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/nanops.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1593 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/npcompat.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8209 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/nputils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9973 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/ops.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11050 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/options.py
+-rw-r--r--   0 runner    (1001) docker     (123)    22317 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/parallel.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9105 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/parallelcompat.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3903 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/pdcompat.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3159 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/pycompat.py
+-rw-r--r--   0 runner    (1001) docker     (123)    14121 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/resample.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19469 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/resample_cftime.py
+-rw-r--r--   0 runner    (1001) docker     (123)    40165 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/rolling.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5745 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/rolling_exp.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6750 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/types.py
+-rw-r--r--   0 runner    (1001) docker     (123)    37261 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)   122275 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/variable.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19161 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/core/weighted.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.832270 xarray-2023.6.0/xarray/indexes/
+-rw-r--r--   0 runner    (1001) docker     (123)      226 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/indexes/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.832270 xarray-2023.6.0/xarray/plot/
+-rw-r--r--   0 runner    (1001) docker     (123)      573 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/plot/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)    41974 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/plot/accessor.py
+-rw-r--r--   0 runner    (1001) docker     (123)    86031 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/plot/dataarray_plot.py
+-rw-r--r--   0 runner    (1001) docker     (123)    30818 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/plot/dataset_plot.py
+-rw-r--r--   0 runner    (1001) docker     (123)    37227 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/plot/facetgrid.py
+-rw-r--r--   0 runner    (1001) docker     (123)    59520 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/plot/utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/py.typed
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.832270 xarray-2023.6.0/xarray/static/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/static/__init__.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.832270 xarray-2023.6.0/xarray/static/css/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/static/css/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6075 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/static/css/style.css
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.836270 xarray-2023.6.0/xarray/static/html/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/static/html/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1343 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/static/html/icons-svg-inline.html
+-rw-r--r--   0 runner    (1001) docker     (123)    14507 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/testing.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.852270 xarray-2023.6.0/xarray/tests/
+-rw-r--r--   0 runner    (1001) docker     (123)     8789 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2145 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/conftest.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.852270 xarray-2023.6.0/xarray/tests/data/
+-rw-r--r--   0 runner    (1001) docker     (123)     1184 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/data/bears.nc
+-rw-r--r--   0 runner    (1001) docker     (123)     5232 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/data/example.grib
+-rw-r--r--   0 runner    (1001) docker     (123)      783 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/data/example.ict
+-rw-r--r--   0 runner    (1001) docker     (123)      608 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/data/example.uamiv
+-rw-r--r--   0 runner    (1001) docker     (123)     1736 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/data/example_1.nc
+-rw-r--r--   0 runner    (1001) docker     (123)      470 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/data/example_1.nc.gz
+-rw-r--r--   0 runner    (1001) docker     (123)    20566 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_accessor_dt.py
+-rw-r--r--   0 runner    (1001) docker     (123)   121928 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_accessor_str.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3705 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_array_api.py
+-rw-r--r--   0 runner    (1001) docker     (123)   206336 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_backends.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7152 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_backends_api.py
+-rw-r--r--   0 runner    (1001) docker     (123)      774 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_backends_common.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7176 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_backends_file_manager.py
+-rw-r--r--   0 runner    (1001) docker     (123)      366 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_backends_locks.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2300 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_backends_lru_cache.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7536 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_calendar_ops.py
+-rw-r--r--   0 runner    (1001) docker     (123)    44969 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_cftime_offsets.py
+-rw-r--r--   0 runner    (1001) docker     (123)    40106 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_cftimeindex.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9248 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_cftimeindex_resample.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11478 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_coarsen.py
+-rw-r--r--   0 runner    (1001) docker     (123)     5162 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_coding.py
+-rw-r--r--   0 runner    (1001) docker     (123)     8237 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_coding_strings.py
+-rw-r--r--   0 runner    (1001) docker     (123)    43161 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_coding_times.py
+-rw-r--r--   0 runner    (1001) docker     (123)    44271 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_combine.py
+-rw-r--r--   0 runner    (1001) docker     (123)    77115 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_computation.py
+-rw-r--r--   0 runner    (1001) docker     (123)    46051 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_concat.py
+-rw-r--r--   0 runner    (1001) docker     (123)    19481 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_conventions.py
+-rw-r--r--   0 runner    (1001) docker     (123)     1681 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_cupy.py
+-rw-r--r--   0 runner    (1001) docker     (123)    60630 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_dask.py
+-rw-r--r--   0 runner    (1001) docker     (123)   255487 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_dataarray.py
+-rw-r--r--   0 runner    (1001) docker     (123)   261289 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_dataset.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4300 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_deprecation_helpers.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7699 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_distributed.py
+-rw-r--r--   0 runner    (1001) docker     (123)     3520 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_dtypes.py
+-rw-r--r--   0 runner    (1001) docker     (123)    30666 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_duck_array_ops.py
+-rw-r--r--   0 runner    (1001) docker     (123)     2737 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_extensions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    24804 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_formatting.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6549 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_formatting_html.py
+-rw-r--r--   0 runner    (1001) docker     (123)    85622 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_groupby.py
+-rw-r--r--   0 runner    (1001) docker     (123)    25785 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_indexes.py
+-rw-r--r--   0 runner    (1001) docker     (123)    31184 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_indexing.py
+-rw-r--r--   0 runner    (1001) docker     (123)    29970 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_interp.py
+-rw-r--r--   0 runner    (1001) docker     (123)    18119 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_merge.py
+-rw-r--r--   0 runner    (1001) docker     (123)    23834 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_missing.py
+-rw-r--r--   0 runner    (1001) docker     (123)      987 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_nputils.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7670 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_options.py
+-rw-r--r--   0 runner    (1001) docker     (123)     6984 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_parallelcompat.py
+-rw-r--r--   0 runner    (1001) docker     (123)   119180 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_plot.py
+-rw-r--r--   0 runner    (1001) docker     (123)    10361 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_plugins.py
+-rw-r--r--   0 runner    (1001) docker     (123)      200 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_print_versions.py
+-rw-r--r--   0 runner    (1001) docker     (123)    31207 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_rolling.py
+-rw-r--r--   0 runner    (1001) docker     (123)    28760 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_sparse.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4723 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_testing.py
+-rw-r--r--   0 runner    (1001) docker     (123)      982 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_tutorial.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4731 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_ufuncs.py
+-rw-r--r--   0 runner    (1001) docker     (123)   189039 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_units.py
+-rw-r--r--   0 runner    (1001) docker     (123)    11253 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_utils.py
+-rw-r--r--   0 runner    (1001) docker     (123)   111128 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_variable.py
+-rw-r--r--   0 runner    (1001) docker     (123)    24189 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tests/test_weighted.py
+-rw-r--r--   0 runner    (1001) docker     (123)     7254 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/tutorial.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.852270 xarray-2023.6.0/xarray/util/
+-rw-r--r--   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/util/__init__.py
+-rw-r--r--   0 runner    (1001) docker     (123)     4272 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/util/deprecation_helpers.py
+-rw-r--r--   0 runner    (1001) docker     (123)    17583 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/util/generate_aggregations.py
+-rw-r--r--   0 runner    (1001) docker     (123)     9354 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/util/generate_ops.py
+-rwxr-xr-x   0 runner    (1001) docker     (123)     5219 2023-06-23 21:18:22.000000 xarray-2023.6.0/xarray/util/print_versions.py
+drwxr-xr-x   0 runner    (1001) docker     (123)        0 2023-06-23 21:18:41.812270 xarray-2023.6.0/xarray.egg-info/
+-rw-r--r--   0 runner    (1001) docker     (123)     3495 2023-06-23 21:18:41.000000 xarray-2023.6.0/xarray.egg-info/PKG-INFO
+-rw-r--r--   0 runner    (1001) docker     (123)     9804 2023-06-23 21:18:41.000000 xarray-2023.6.0/xarray.egg-info/SOURCES.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-23 21:18:41.000000 xarray-2023.6.0/xarray.egg-info/dependency_links.txt
+-rw-r--r--   0 runner    (1001) docker     (123)       66 2023-06-23 21:18:41.000000 xarray-2023.6.0/xarray.egg-info/entry_points.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        1 2023-06-23 21:18:41.000000 xarray-2023.6.0/xarray.egg-info/not-zip-safe
+-rw-r--r--   0 runner    (1001) docker     (123)      671 2023-06-23 21:18:41.000000 xarray-2023.6.0/xarray.egg-info/requires.txt
+-rw-r--r--   0 runner    (1001) docker     (123)        7 2023-06-23 21:18:41.000000 xarray-2023.6.0/xarray.egg-info/top_level.txt
```

### Comparing `xarray-2023.5.0/.binder/environment.yml` & `xarray-2023.6.0/.binder/environment.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.github/ISSUE_TEMPLATE/bugreport.yml` & `xarray-2023.6.0/.github/ISSUE_TEMPLATE/bugreport.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.github/ISSUE_TEMPLATE/config.yml` & `xarray-2023.6.0/.github/ISSUE_TEMPLATE/config.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.github/ISSUE_TEMPLATE/newfeature.yml` & `xarray-2023.6.0/.github/ISSUE_TEMPLATE/newfeature.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.github/config.yml` & `xarray-2023.6.0/.github/config.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.github/labeler.yml` & `xarray-2023.6.0/.github/labeler.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.github/stale.yml` & `xarray-2023.6.0/.github/stale.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.github/workflows/benchmarks-last-release.yml` & `xarray-2023.6.0/.github/workflows/benchmarks-last-release.yml`

 * *Files 7% similar despite different names*

```diff
@@ -18,21 +18,21 @@
       # We need the full repo to avoid this issue
       # https://github.com/actions/checkout/issues/23
       - uses: actions/checkout@v3
         with:
           fetch-depth: 0
 
       - name: Set up conda environment
-        uses: mamba-org/provision-with-micromamba@v15
+        uses: mamba-org/setup-micromamba@v1
         with:
           environment-file: ${{env.CONDA_ENV_FILE}}
           environment-name: xarray-tests
-          cache-env: true
-          cache-env-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}-benchmark"
-          extra-specs: |
+          cache-environment: true
+          cache-environment-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}-benchmark"
+          create-args: >-
             asv
 
       - name: 'Get Previous tag'
         id: previoustag
         uses: "WyriHaximus/github-action-get-previous-tag@v1"
         # with:
         #   fallback: 1.0.0 # Optional fallback tag to use when no tag can be found
```

### Comparing `xarray-2023.5.0/.github/workflows/benchmarks.yml` & `xarray-2023.6.0/.github/workflows/benchmarks.yml`

 * *Files 4% similar despite different names*

```diff
@@ -18,21 +18,21 @@
       # We need the full repo to avoid this issue
       # https://github.com/actions/checkout/issues/23
       - uses: actions/checkout@v3
         with:
           fetch-depth: 0
 
       - name: Set up conda environment
-        uses: mamba-org/provision-with-micromamba@v15
+        uses: mamba-org/setup-micromamba@v1
         with:
           environment-file: ${{env.CONDA_ENV_FILE}}
           environment-name: xarray-tests
-          cache-env: true
-          cache-env-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}-benchmark"
-          extra-specs: |
+          cache-environment: true
+          cache-environment-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}-benchmark"
+          create-args: >-
             asv
 
 
       - name: Run benchmarks
         shell: bash -l {0}
         id: benchmark
         env:
```

### Comparing `xarray-2023.5.0/.github/workflows/ci-additional.yaml` & `xarray-2023.6.0/.github/workflows/ci-additional.yaml`

 * *Files 5% similar despite different names*

```diff
@@ -49,23 +49,23 @@
           fetch-depth: 0 # Fetch all history for all branches and tags.
 
       - name: set environment variables
         run: |
           echo "TODAY=$(date  +'%Y-%m-%d')" >> $GITHUB_ENV
 
       - name: Setup micromamba
-        uses: mamba-org/provision-with-micromamba@v15
+        uses: mamba-org/setup-micromamba@v1
         with:
           environment-file: ${{env.CONDA_ENV_FILE}}
           environment-name: xarray-tests
-          extra-specs: |
+          create-args: >-
             python=${{env.PYTHON_VERSION}}
             conda
-          cache-env: true
-          cache-env-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}"
+          cache-environment: true
+          cache-environment-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}"
 
       - name: Install xarray
         run: |
           python -m pip install --no-deps -e .
       - name: Version info
         run: |
           conda info -a
@@ -96,23 +96,23 @@
         with:
           fetch-depth: 0 # Fetch all history for all branches and tags.
 
       - name: set environment variables
         run: |
           echo "TODAY=$(date +'%Y-%m-%d')" >> $GITHUB_ENV
       - name: Setup micromamba
-        uses: mamba-org/provision-with-micromamba@v15
+        uses: mamba-org/setup-micromamba@v1
         with:
           environment-file: ${{env.CONDA_ENV_FILE}}
           environment-name: xarray-tests
-          extra-specs: |
+          create-args: >-
             python=${{env.PYTHON_VERSION}}
             conda
-          cache-env: true
-          cache-env-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}"
+          cache-environment: true
+          cache-environment-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}"
       - name: Install xarray
         run: |
           python -m pip install --no-deps -e .
       - name: Version info
         run: |
           conda info -a
           conda list
@@ -122,15 +122,15 @@
           python -m pip install mypy --force-reinstall
 
       - name: Run mypy
         run: |
           python -m mypy --install-types --non-interactive --cobertura-xml-report mypy_report
 
       - name: Upload mypy coverage to Codecov
-        uses: codecov/codecov-action@v3.1.3
+        uses: codecov/codecov-action@v3.1.4
         with:
           file: mypy_report/cobertura.xml
           flags: mypy
           env_vars: PYTHON_VERSION
           name: codecov-umbrella
           fail_ci_if_error: false
 
@@ -150,23 +150,23 @@
         with:
           fetch-depth: 0 # Fetch all history for all branches and tags.
 
       - name: set environment variables
         run: |
           echo "TODAY=$(date +'%Y-%m-%d')" >> $GITHUB_ENV
       - name: Setup micromamba
-        uses: mamba-org/provision-with-micromamba@v15
+        uses: mamba-org/setup-micromamba@v1
         with:
           environment-file: ${{env.CONDA_ENV_FILE}}
           environment-name: xarray-tests
-          extra-specs: |
+          create-args: >-
             python=${{env.PYTHON_VERSION}}
             conda
-          cache-env: true
-          cache-env-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}"
+          cache-environment: true
+          cache-environment-key: "${{runner.os}}-${{runner.arch}}-py${{env.PYTHON_VERSION}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}"
       - name: Install xarray
         run: |
           python -m pip install --no-deps -e .
       - name: Version info
         run: |
           conda info -a
           conda list
@@ -176,15 +176,15 @@
           python -m pip install mypy --force-reinstall
 
       - name: Run mypy
         run: |
           python -m mypy --install-types --non-interactive --cobertura-xml-report mypy_report
 
       - name: Upload mypy coverage to Codecov
-        uses: codecov/codecov-action@v3.1.3
+        uses: codecov/codecov-action@v3.1.4
         with:
           file: mypy_report/cobertura.xml
           flags: mypy39
           env_vars: PYTHON_VERSION
           name: codecov-umbrella
           fail_ci_if_error: false
 
@@ -206,21 +206,19 @@
 
     steps:
       - uses: actions/checkout@v3
         with:
           fetch-depth: 0 # Fetch all history for all branches and tags.
 
       - name: Setup micromamba
-        uses: mamba-org/provision-with-micromamba@v15
+        uses: mamba-org/setup-micromamba@v1
         with:
           environment-name: xarray-tests
-          environment-file: false
-          extra-specs: |
+          create-args: >-
             python=3.10
             pyyaml
             conda
             python-dateutil
-          channels: conda-forge
 
       - name: minimum versions policy
         run: |
           python ci/min_deps_check.py ci/requirements/${{ matrix.environment-file }}.yml
```

### Comparing `xarray-2023.5.0/.github/workflows/ci.yaml` & `xarray-2023.6.0/.github/workflows/ci.yaml`

 * *Files 3% similar despite different names*

```diff
@@ -88,21 +88,21 @@
           else
             echo "CONDA_ENV_FILE=ci/requirements/environment.yml" >> $GITHUB_ENV
           fi
 
           echo "PYTHON_VERSION=${{ matrix.python-version }}" >> $GITHUB_ENV
 
       - name: Setup micromamba
-        uses: mamba-org/provision-with-micromamba@v15
+        uses: mamba-org/setup-micromamba@v1
         with:
           environment-file: ${{ env.CONDA_ENV_FILE }}
           environment-name: xarray-tests
-          cache-env: true
-          cache-env-key: "${{runner.os}}-${{runner.arch}}-py${{matrix.python-version}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}"
-          extra-specs: |
+          cache-environment: true
+          cache-environment-key: "${{runner.os}}-${{runner.arch}}-py${{matrix.python-version}}-${{env.TODAY}}-${{hashFiles(env.CONDA_ENV_FILE)}}"
+          create-args: >-
             python=${{matrix.python-version}}
             conda
 
       # We only want to install this on one run, because otherwise we'll have
       # duplicate annotations.
       - name: Install error reporter
         if: ${{ matrix.os }} == 'ubuntu-latest' and ${{ matrix.python-version }} == '3.10'
@@ -135,15 +135,15 @@
         if: always()
         uses: actions/upload-artifact@v3
         with:
           name: Test results for ${{ runner.os }}-${{ matrix.python-version }}
           path: pytest.xml
 
       - name: Upload code coverage to Codecov
-        uses: codecov/codecov-action@v3.1.3
+        uses: codecov/codecov-action@v3.1.4
         with:
           file: ./coverage.xml
           flags: unittests
           env_vars: RUNNER_OS,PYTHON_VERSION
           name: codecov-umbrella
           fail_ci_if_error: false
```

### Comparing `xarray-2023.5.0/.github/workflows/configure-testpypi-version.py` & `xarray-2023.6.0/.github/workflows/configure-testpypi-version.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.github/workflows/publish-test-results.yaml` & `xarray-2023.6.0/.github/workflows/publish-test-results.yaml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.github/workflows/pypi-release.yaml` & `xarray-2023.6.0/.github/workflows/pypi-release.yaml`

 * *Files 5% similar despite different names*

```diff
@@ -66,32 +66,51 @@
       - name: Verify the built dist/wheel is valid
         if: github.event_name == 'push'
         run: |
           python -m pip install --upgrade pip
           python -m pip install dist/xarray*.whl
           python -m xarray.util.print_versions
 
+  upload-to-test-pypi:
+    needs: test-built-dist
+    if: github.event_name == 'push'
+    runs-on: ubuntu-latest
+
+    environment:
+      name: pypi
+      url: https://test.pypi.org/p/xarray
+    permissions:
+      id-token: write
+
+    steps:
+      - uses: actions/download-artifact@v3
+        with:
+          name: releases
+          path: dist
       - name: Publish package to TestPyPI
         if: github.event_name == 'push'
         uses: pypa/gh-action-pypi-publish@v1.8.6
         with:
-          user: __token__
-          password: ${{ secrets.TESTPYPI_TOKEN }}
           repository_url: https://test.pypi.org/legacy/
           verbose: true
 
 
   upload-to-pypi:
     needs: test-built-dist
     if: github.event_name == 'release'
     runs-on: ubuntu-latest
+
+    environment:
+      name: pypi
+      url: https://pypi.org/p/xarray
+    permissions:
+      id-token: write
+
     steps:
       - uses: actions/download-artifact@v3
         with:
           name: releases
           path: dist
       - name: Publish package to PyPI
         uses: pypa/gh-action-pypi-publish@v1.8.6
         with:
-          user: __token__
-          password: ${{ secrets.PYPI_TOKEN }}
           verbose: true
```

### Comparing `xarray-2023.5.0/.github/workflows/testpypi-release.yaml` & `xarray-2023.6.0/.github/workflows/nightly-wheels.yml`

 * *Files 26% similar despite different names*

```diff
@@ -1,86 +1,44 @@
-name: Build and Upload xarray to PyPI
+name: Upload nightly wheels
 on:
-  push:
-    branches:
-      - 'main'
-
-# no need for concurrency limits
-
+  workflow_dispatch:
+  schedule:
+    - cron: "0 0 * * *"
 jobs:
-  build-artifacts:
+  cron:
     runs-on: ubuntu-latest
     if: github.repository == 'pydata/xarray'
     steps:
       - uses: actions/checkout@v3
         with:
           fetch-depth: 0
-
       - uses: actions/setup-python@v4
-        name: Install Python
         with:
-          python-version: "3.10"
+          python-version: "3.11"
 
       - name: Install dependencies
         run: |
           python -m pip install --upgrade pip
           python -m pip install build twine
-          python -m pip install tomli tomli_w
-
-      - name: Disable local versions
-        run: |
-          python .github/workflows/configure-testpypi-version.py pyproject.toml
-          git update-index --assume-unchanged pyproject.toml
-          cat pyproject.toml
 
       - name: Build tarball and wheels
         run: |
           git clean -xdf
+          git restore -SW .
           python -m build
 
       - name: Check built artifacts
         run: |
           python -m twine check --strict dist/*
+          pwd
           if [ -f dist/xarray-0.0.0.tar.gz ]; then
-            echo " INVALID VERSION NUMBER"
-            exit 1
+              echo " INVALID VERSION NUMBER"
+              exit 1
           else
-            echo " Looks good"
+              echo " Looks good"
           fi
 
-      - uses: actions/upload-artifact@v3
-        with:
-          name: releases
-          path: dist
-
-  test-built-dist:
-    needs: build-artifacts
-    runs-on: ubuntu-latest
-    steps:
-      - uses: actions/setup-python@v4
-        name: Install Python
-        with:
-          python-version: "3.10"
-      - uses: actions/download-artifact@v3
-        with:
-          name: releases
-          path: dist
-      - name: List contents of built dist
-        run: |
-          ls -ltrh
-          ls -ltrh dist
-
-      - name: Verify the built dist/wheel is valid
-        if: github.event_name == 'push'
-        run: |
-          python -m pip install --upgrade pip
-          python -m pip install dist/xarray*.whl
-          python -m xarray.util.print_versions
-
-      - name: Publish package to TestPyPI
-        if: github.event_name == 'push'
-        uses: pypa/gh-action-pypi-publish@v1.8.6
+      - name: Upload wheel
+        uses: scientific-python/upload-nightly-action@main
         with:
-          user: __token__
-          password: ${{ secrets.TESTPYPI_TOKEN }}
-          repository_url: https://test.pypi.org/legacy/
-          verbose: true
+          anaconda_nightly_upload_token: ${{ secrets.ANACONDA_NIGHTLY }}
+          artifacts_path: dist
```

### Comparing `xarray-2023.5.0/.github/workflows/upstream-dev-ci.yaml` & `xarray-2023.6.0/.github/workflows/upstream-dev-ci.yaml`

 * *Files 3% similar despite different names*

```diff
@@ -52,19 +52,19 @@
       matrix:
         python-version: ["3.10"]
     steps:
       - uses: actions/checkout@v3
         with:
           fetch-depth: 0 # Fetch all history for all branches and tags.
       - name: Set up conda environment
-        uses: mamba-org/provision-with-micromamba@v15
+        uses: mamba-org/setup-micromamba@v1
         with:
           environment-file: ci/requirements/environment.yml
           environment-name: xarray-tests
-          extra-specs: |
+          create-args: >-
             python=${{ matrix.python-version }}
             pytest-reportlog
             conda
       - name: Install upstream versions
         run: |
           bash ci/install-upstream-wheels.sh
       - name: Install xarray
@@ -138,14 +138,14 @@
       - name: Install mypy
         run: |
           python -m pip install mypy --force-reinstall
       - name: Run mypy
         run: |
           python -m mypy --install-types --non-interactive --cobertura-xml-report mypy_report
       - name: Upload mypy coverage to Codecov
-        uses: codecov/codecov-action@v3.1.3
+        uses: codecov/codecov-action@v3.1.4
         with:
           file: mypy_report/cobertura.xml
           flags: mypy
           env_vars: PYTHON_VERSION
           name: codecov-umbrella
           fail_ci_if_error: false
```

### Comparing `xarray-2023.5.0/.gitignore` & `xarray-2023.6.0/.gitignore`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/.pre-commit-config.yaml` & `xarray-2023.6.0/.pre-commit-config.yaml`

 * *Files 2% similar despite different names*

```diff
@@ -12,15 +12,15 @@
     rev: v0.3.1
     hooks:
       - id: absolufy-imports
         name: absolufy-imports
         files: ^xarray/
   - repo: https://github.com/charliermarsh/ruff-pre-commit
     # Ruff version.
-    rev: 'v0.0.267'
+    rev: 'v0.0.272'
     hooks:
       - id: ruff
         args: ["--fix"]
   # https://github.com/python/black#version-control-integration
   - repo: https://github.com/psf/black
     rev: 23.3.0
     hooks:
```

### Comparing `xarray-2023.5.0/CITATION.cff` & `xarray-2023.6.0/CITATION.cff`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/CODE_OF_CONDUCT.md` & `xarray-2023.6.0/CODE_OF_CONDUCT.md`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/HOW_TO_RELEASE.md` & `xarray-2023.6.0/HOW_TO_RELEASE.md`

 * *Files 2% similar despite different names*

```diff
@@ -55,15 +55,15 @@
  8. Check that the ReadTheDocs build is passing on the `main` branch.
  9. Issue the release on GitHub. Click on "Draft a new release" at
     <https://github.com/pydata/xarray/releases>. Type in the version number (with a "v")
     and paste the release summary in the notes.
  10. This should automatically trigger an upload of the new build to PyPI via GitHub Actions.
     Check this has run [here](https://github.com/pydata/xarray/actions/workflows/pypi-release.yaml),
     and that the version number you expect is displayed [on PyPI](https://pypi.org/project/xarray/)
-11. Add a section for the next release {YYYY.MM.X+1} to doc/whats-new.rst:
+11. Add a section for the next release {YYYY.MM.X+1} to doc/whats-new.rst (we avoid doing this earlier so that it doesn't show up in the RTD build):
      ```rst
      .. _whats-new.YYYY.MM.X+1:
 
      vYYYY.MM.X+1 (unreleased)
      -----------------------
 
      New Features
```

### Comparing `xarray-2023.5.0/LICENSE` & `xarray-2023.6.0/LICENSE`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/PKG-INFO` & `xarray-2023.6.0/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: xarray
-Version: 2023.5.0
+Version: 2023.6.0
 Summary: N-D labeled arrays and datasets in Python
 Home-page: https://github.com/pydata/xarray
 Author: xarray Developers
 Author-email: xarray@googlegroups.com
 License: Apache-2.0
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: License :: OSI Approved :: Apache Software License
```

### Comparing `xarray-2023.5.0/README.md` & `xarray-2023.6.0/README.md`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/asv.conf.json` & `xarray-2023.6.0/asv_bench/asv.conf.json`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/README_CI.md` & `xarray-2023.6.0/asv_bench/benchmarks/README_CI.md`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/__init__.py` & `xarray-2023.6.0/asv_bench/benchmarks/__init__.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/accessors.py` & `xarray-2023.6.0/asv_bench/benchmarks/accessors.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/alignment.py` & `xarray-2023.6.0/asv_bench/benchmarks/alignment.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/dataarray_missing.py` & `xarray-2023.6.0/asv_bench/benchmarks/dataarray_missing.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/dataset_io.py` & `xarray-2023.6.0/asv_bench/benchmarks/dataset_io.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/groupby.py` & `xarray-2023.6.0/asv_bench/benchmarks/groupby.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/indexing.py` & `xarray-2023.6.0/asv_bench/benchmarks/indexing.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/interp.py` & `xarray-2023.6.0/asv_bench/benchmarks/interp.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/merge.py` & `xarray-2023.6.0/asv_bench/benchmarks/merge.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/pandas.py` & `xarray-2023.6.0/asv_bench/benchmarks/pandas.py`

 * *Files 9% similar despite different names*

```diff
@@ -25,27 +25,28 @@
     def time_from_series(self, dtype, subset):
         xr.DataArray.from_series(self.series)
 
 
 class ToDataFrame:
     def setup(self, *args, **kwargs):
         xp = kwargs.get("xp", np)
+        nvars = kwargs.get("nvars", 1)
         random_kws = kwargs.get("random_kws", {})
         method = kwargs.get("method", "to_dataframe")
 
         dim1 = 10_000
         dim2 = 10_000
+
+        var = xr.Variable(
+            dims=("dim1", "dim2"), data=xp.random.random((dim1, dim2), **random_kws)
+        )
+        data_vars = {f"long_name_{v}": (("dim1", "dim2"), var) for v in range(nvars)}
+
         ds = xr.Dataset(
-            {
-                "x": xr.DataArray(
-                    data=xp.random.random((dim1, dim2), **random_kws),
-                    dims=["dim1", "dim2"],
-                    coords={"dim1": np.arange(0, dim1), "dim2": np.arange(0, dim2)},
-                )
-            }
+            data_vars, coords={"dim1": np.arange(0, dim1), "dim2": np.arange(0, dim2)}
         )
         self.to_frame = getattr(ds, method)
 
     def time_to_dataframe(self):
         self.to_frame()
 
     def peakmem_to_dataframe(self):
@@ -54,8 +55,10 @@
 
 class ToDataFrameDask(ToDataFrame):
     def setup(self, *args, **kwargs):
         requires_dask()
 
         import dask.array as da
 
-        super().setup(xp=da, random_kws=dict(chunks=5000), method="to_dask_dataframe")
+        super().setup(
+            xp=da, random_kws=dict(chunks=5000), method="to_dask_dataframe", nvars=500
+        )
```

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/polyfit.py` & `xarray-2023.6.0/asv_bench/benchmarks/polyfit.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/reindexing.py` & `xarray-2023.6.0/asv_bench/benchmarks/reindexing.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/renaming.py` & `xarray-2023.6.0/asv_bench/benchmarks/renaming.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/repr.py` & `xarray-2023.6.0/asv_bench/benchmarks/repr.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/rolling.py` & `xarray-2023.6.0/asv_bench/benchmarks/rolling.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/asv_bench/benchmarks/unstacking.py` & `xarray-2023.6.0/asv_bench/benchmarks/unstacking.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/ci/install-upstream-wheels.sh` & `xarray-2023.6.0/ci/install-upstream-wheels.sh`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/ci/min_deps_check.py` & `xarray-2023.6.0/ci/min_deps_check.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/ci/requirements/all-but-dask.yml` & `xarray-2023.6.0/ci/requirements/all-but-dask.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/ci/requirements/doc.yml` & `xarray-2023.6.0/ci/requirements/doc.yml`

 * *Files 26% similar despite different names*

```diff
@@ -3,32 +3,33 @@
   # Don't change to pkgs/main, as it causes random timeouts in readthedocs
   - conda-forge
   - nodefaults
 dependencies:
   - python=3.10
   - bottleneck
   - cartopy
+  - cfgrib
   - dask-core>=2022.1
   - h5netcdf>=0.13
   - ipykernel
+  - ipywidgets  # silence nbsphinx warning
   - ipython
   - iris>=2.3
   - jupyter_client
   - matplotlib-base
   - nbsphinx
   - netcdf4>=1.5
   - numba
   - numpy>=1.21,<1.24
   - packaging>=21.3
   - pandas>=1.4
   - pooch
   - pip
   - pre-commit
   - pyproj
-  - rasterio>=1.1
   - scipy!=1.10.0
   - seaborn
   - setuptools
   - sparse
   - sphinx-autosummary-accessors
   - sphinx-book-theme >= 0.3.0
   - sphinx-copybutton
```

### Comparing `xarray-2023.5.0/ci/requirements/environment-py311.yml` & `xarray-2023.6.0/ci/requirements/environment-py311.yml`

 * *Files 3% similar despite different names*

```diff
@@ -18,16 +18,16 @@
   - hdf5
   - hypothesis
   - iris
   - lxml  # Optional dep of pydap
   - matplotlib-base
   - nc-time-axis
   - netcdf4
-  # - numba
-  # - numbagg
+  - numba
+  - numbagg
   - numexpr
   - numpy
   - packaging
   - pandas
   - pint<0.21
   - pip
   - pooch
@@ -38,11 +38,11 @@
   - pytest-cov
   - pytest-env
   - pytest-xdist
   - pytest-timeout
   - rasterio
   - scipy
   - seaborn
-  # - sparse
+  - sparse
   - toolz
   - typing_extensions
   - zarr
```

### Comparing `xarray-2023.5.0/ci/requirements/environment-windows-py311.yml` & `xarray-2023.6.0/ci/requirements/environment-windows-py311.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/ci/requirements/environment-windows.yml` & `xarray-2023.6.0/ci/requirements/environment-windows.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/ci/requirements/environment.yml` & `xarray-2023.6.0/ci/requirements/environment.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/ci/requirements/min-all-deps.yml` & `xarray-2023.6.0/ci/requirements/min-all-deps.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/conftest.py` & `xarray-2023.6.0/conftest.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/design_notes/flexible_indexes_notes.md` & `xarray-2023.6.0/design_notes/flexible_indexes_notes.md`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/Makefile` & `xarray-2023.6.0/doc/Makefile`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/advanced_selection_interpolation.svg` & `xarray-2023.6.0/doc/_static/advanced_selection_interpolation.svg`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/ci.png` & `xarray-2023.6.0/doc/_static/ci.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/dask_array.png` & `xarray-2023.6.0/doc/_static/dask_array.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/dataset-diagram-logo.pdf` & `xarray-2023.6.0/doc/_static/dataset-diagram-logo.pdf`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/dataset-diagram-logo.png` & `xarray-2023.6.0/doc/_static/dataset-diagram-logo.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/dataset-diagram-logo.svg` & `xarray-2023.6.0/doc/_static/dataset-diagram-logo.svg`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/dataset-diagram-logo.tex` & `xarray-2023.6.0/doc/_static/dataset-diagram-logo.tex`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/dataset-diagram-square-logo.png` & `xarray-2023.6.0/doc/_static/dataset-diagram-square-logo.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/dataset-diagram-square-logo.tex` & `xarray-2023.6.0/doc/_static/dataset-diagram-square-logo.tex`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/dataset-diagram.png` & `xarray-2023.6.0/doc/_static/dataset-diagram.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/dataset-diagram.tex` & `xarray-2023.6.0/doc/_static/dataset-diagram.tex`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/favicon.ico` & `xarray-2023.6.0/doc/_static/favicon.ico`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/index_api.svg` & `xarray-2023.6.0/doc/_static/index_api.svg`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/index_contribute.svg` & `xarray-2023.6.0/doc/_static/index_contribute.svg`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/index_getting_started.svg` & `xarray-2023.6.0/doc/_static/index_getting_started.svg`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/index_user_guide.svg` & `xarray-2023.6.0/doc/_static/index_user_guide.svg`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/numfocus_logo.png` & `xarray-2023.6.0/doc/_static/numfocus_logo.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/opendap-prism-tmax.png` & `xarray-2023.6.0/doc/_static/opendap-prism-tmax.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/style.css` & `xarray-2023.6.0/doc/_static/style.css`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/thumbnails/ERA5-GRIB-example.png` & `xarray-2023.6.0/doc/_static/thumbnails/ERA5-GRIB-example.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/thumbnails/ROMS_ocean_model.png` & `xarray-2023.6.0/doc/_static/thumbnails/ROMS_ocean_model.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/thumbnails/area_weighted_temperature.png` & `xarray-2023.6.0/doc/_static/thumbnails/area_weighted_temperature.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/thumbnails/monthly-means.png` & `xarray-2023.6.0/doc/_static/thumbnails/monthly-means.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/thumbnails/multidimensional-coords.png` & `xarray-2023.6.0/doc/_static/thumbnails/multidimensional-coords.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/thumbnails/toy-weather-data.png` & `xarray-2023.6.0/doc/_static/thumbnails/toy-weather-data.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/thumbnails/visualization_gallery.png` & `xarray-2023.6.0/doc/_static/thumbnails/visualization_gallery.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/_static/view-docs.png` & `xarray-2023.6.0/doc/_static/view-docs.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/api-hidden.rst` & `xarray-2023.6.0/doc/api-hidden.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/api.rst` & `xarray-2023.6.0/doc/api.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/conf.py` & `xarray-2023.6.0/doc/conf.py`

 * *Files 0% similar despite different names*

```diff
@@ -54,15 +54,15 @@
 except ImportError:
     allowed_failures.update(
         [
             "gallery/plot_cartopy_facetgrid.py",
         ]
     )
 
-nbsphinx_allow_errors = True
+nbsphinx_allow_errors = False
 
 # -- General configuration ------------------------------------------------
 
 # If your documentation needs a minimal Sphinx version, state it here.
 # needs_sphinx = '1.0'
 
 # Add any Sphinx extension module names here, as strings. They can be
```

### Comparing `xarray-2023.5.0/doc/contributing.rst` & `xarray-2023.6.0/doc/contributing.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/developers-meeting.rst` & `xarray-2023.6.0/doc/developers-meeting.rst`

 * *Files 20% similar despite different names*

```diff
@@ -1,20 +1,20 @@
 Developers meeting
 ------------------
 
 Xarray developers meet bi-weekly every other Wednesday.
 
-The meeting occurs on `Zoom <https://us02web.zoom.us/j/88251613296?pwd=azZsSkU1UWJZTVFKNnhIUVdZcENUZz09>`__.
+The meeting occurs on `Zoom <https://us02web.zoom.us/j/87503265754?pwd=cEFJMzFqdTFaS3BMdkx4UkNZRk1QZz09>`__.
 
-Find the `notes for the meeting here <https://hackmd.io/@U4W-olO3TX-hc-cvbjNe4A/xarray-dev-meeting/edit>`__.
+Find the `notes for the meeting here <https://hackmd.io/fx7KNO2vTKutZeUysE-SIA/edit>`__.
 
 There is a :issue:`GitHub issue for changes to the meeting<4001>`.
 
 You can subscribe to this calendar to be notified of changes:
 
-* `Google Calendar <https://calendar.google.com/calendar/embed?src=ucar.edu_2gjd5fuugcj4ol6ij7knj8krn8%40group.calendar.google.com&ctz=America%2FLos_Angeles>`__
-* `iCal <https://calendar.google.com/calendar/ical/ucar.edu_2gjd5fuugcj4ol6ij7knj8krn8%40group.calendar.google.com/public/basic.ics>`__
+* `Google Calendar <https://calendar.google.com/calendar/embed?src=59589f9634ab4ef304e8209be66cda9812dababca71eb8a01a6fa2d167f90d94%40group.calendar.google.com&ctz=America%2FLos_Angeles>`__
+* `iCal <https://calendar.google.com/calendar/ical/59589f9634ab4ef304e8209be66cda9812dababca71eb8a01a6fa2d167f90d94%40group.calendar.google.com/public/basic.ics>`__
 
 .. raw:: html
 
-   <iframe id="calendariframe" src="https://calendar.google.com/calendar/embed?ctz=local&amp;src=ucar.edu_2gjd5fuugcj4ol6ij7knj8krn8%40group.calendar.google.com" style="border: 0" width="800" height="600" frameborder="0" scrolling="no"></iframe>
+   <iframe src="https://calendar.google.com/calendar/embed?src=59589f9634ab4ef304e8209be66cda9812dababca71eb8a01a6fa2d167f90d94%40group.calendar.google.com&ctz=America%2FLos_Angeles" style="border: 0" width="800" height="600" frameborder="0" scrolling="no"></iframe>
    <script>document.getElementById("calendariframe").src = document.getElementById("calendariframe").src.replace("ctz=local", "ctz=" + Intl.DateTimeFormat().resolvedOptions().timeZone)</script>
```

#### html2text {}

```diff
@@ -1,14 +1,14 @@
 Developers meeting ------------------ Xarray developers meet bi-weekly every
 other Wednesday. The meeting occurs on `Zoom
-us02web.zoom.us/j/88251613296?pwd=azZsSkU1UWJZTVFKNnhIUVdZcENUZz09>`__. Find
+us02web.zoom.us/j/87503265754?pwd=cEFJMzFqdTFaS3BMdkx4UkNZRk1QZz09>`__. Find
 the `notes for the meeting here
-hackmd.io/@U4W-olO3TX-hc-cvbjNe4A/xarray-dev-meeting/edit>`__. There is a :
-issue:`GitHub issue for changes to the meeting<4001>`. You can subscribe to
-this calendar to be notified of changes: * `Google Calendar
+hackmd.io/fx7KNO2vTKutZeUysE-SIA/edit>`__. There is a :issue:`GitHub issue for
+changes to the meeting<4001>`. You can subscribe to this calendar to be
+notified of changes: * `Google Calendar
 calendar.google.com/calendar/
-embed?src=ucar.edu_2gjd5fuugcj4ol6ij7knj8krn8%40group.calendar.google.com&ctz=America%2FLos_Angeles>`__
+embed?src=59589f9634ab4ef304e8209be66cda9812dababca71eb8a01a6fa2d167f90d94%40group.calendar.google.com&ctz=America%2FLos_Angeles>`__
 * `iCal
 calendar.google.com/calendar/ical/
-ucar.edu_2gjd5fuugcj4ol6ij7knj8krn8%40group.calendar.google.com/public/
-basic.ics>`__ .. raw:: html
+59589f9634ab4ef304e8209be66cda9812dababca71eb8a01a6fa2d167f90d94%40group.calendar.google.com/
+public/basic.ics>`__ .. raw:: html
```

### Comparing `xarray-2023.5.0/doc/ecosystem.rst` & `xarray-2023.6.0/doc/ecosystem.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/ERA5-GRIB-example.ipynb` & `xarray-2023.6.0/doc/examples/ERA5-GRIB-example.ipynb`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/ROMS_ocean_model.ipynb` & `xarray-2023.6.0/doc/examples/ROMS_ocean_model.ipynb`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/_code/accessor_example.py` & `xarray-2023.6.0/doc/examples/_code/accessor_example.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/apply_ufunc_vectorize_1d.ipynb` & `xarray-2023.6.0/doc/examples/apply_ufunc_vectorize_1d.ipynb`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/area_weighted_temperature.ipynb` & `xarray-2023.6.0/doc/examples/area_weighted_temperature.ipynb`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/blank_template.ipynb` & `xarray-2023.6.0/doc/examples/blank_template.ipynb`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/monthly-means.ipynb` & `xarray-2023.6.0/doc/examples/monthly-means.ipynb`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/monthly_means_output.png` & `xarray-2023.6.0/doc/examples/monthly_means_output.png`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/multidimensional-coords.ipynb` & `xarray-2023.6.0/doc/examples/multidimensional-coords.ipynb`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/examples/visualization_gallery.ipynb` & `xarray-2023.6.0/doc/examples/visualization_gallery.ipynb`

 * *Files 26% similar despite different names*

#### Pretty-printed

 * *Similarity: 0.9270833333333333%*

 * *Differences: {"'cells'": '{delete: [15, 14, 13, 12]}',*

 * * "'metadata'": "{'widgets': OrderedDict([('application/vnd.jupyter.widget-state+json', "*

 * *               "OrderedDict([('state', OrderedDict()), ('version_major', 2), ('version_minor', "*

 * *               '0)]))])}'}*

```diff
@@ -189,98 +189,14 @@
                 "# Temperature vs time plot - illustrates the \"x\" and \"add_legend\" kwargs\n",
                 "air.isel(lon=30, lat=isel_lats).plot.line(ax=ax2, x=\"time\", add_legend=False)\n",
                 "ax2.set_ylabel(\"\")\n",
                 "\n",
                 "# Show\n",
                 "plt.tight_layout()"
             ]
-        },
-        {
-            "cell_type": "markdown",
-            "metadata": {
-                "jp-MarkdownHeadingCollapsed": true,
-                "tags": []
-            },
-            "source": [
-                "## `imshow()` and rasterio map projections\n",
-                "\n",
-                "\n",
-                "Using rasterio's projection information for more accurate plots.\n",
-                "\n",
-                "This example extends `recipes.rasterio` and plots the image in the\n",
-                "original map projection instead of relying on pcolormesh and a map\n",
-                "transformation."
-            ]
-        },
-        {
-            "cell_type": "code",
-            "execution_count": null,
-            "metadata": {},
-            "outputs": [],
-            "source": [
-                "da = xr.tutorial.open_rasterio(\"RGB.byte\")\n",
-                "\n",
-                "# The data is in UTM projection. We have to set it manually until\n",
-                "# https://github.com/SciTools/cartopy/issues/813 is implemented\n",
-                "crs = ccrs.UTM(\"18\")\n",
-                "\n",
-                "# Plot on a map\n",
-                "ax = plt.subplot(projection=crs)\n",
-                "da.plot.imshow(ax=ax, rgb=\"band\", transform=crs)\n",
-                "ax.coastlines(\"10m\", color=\"r\")"
-            ]
-        },
-        {
-            "cell_type": "markdown",
-            "metadata": {},
-            "source": [
-                "## Parsing rasterio geocoordinates\n",
-                "\n",
-                "Converting a projection's cartesian coordinates into 2D longitudes and\n",
-                "latitudes.\n",
-                "\n",
-                "These new coordinates might be handy for plotting and indexing, but it should\n",
-                "be kept in mind that a grid which is regular in projection coordinates will\n",
-                "likely be irregular in lon/lat. It is often recommended to work in the data's\n",
-                "original map projection (see `recipes.rasterio_rgb`)."
-            ]
-        },
-        {
-            "cell_type": "code",
-            "execution_count": null,
-            "metadata": {},
-            "outputs": [],
-            "source": [
-                "from pyproj import Transformer\n",
-                "import numpy as np\n",
-                "\n",
-                "da = xr.tutorial.open_rasterio(\"RGB.byte\")\n",
-                "\n",
-                "x, y = np.meshgrid(da[\"x\"], da[\"y\"])\n",
-                "transformer = Transformer.from_crs(da.crs, \"EPSG:4326\", always_xy=True)\n",
-                "lon, lat = transformer.transform(x, y)\n",
-                "da.coords[\"lon\"] = ((\"y\", \"x\"), lon)\n",
-                "da.coords[\"lat\"] = ((\"y\", \"x\"), lat)\n",
-                "\n",
-                "# Compute a greyscale out of the rgb image\n",
-                "greyscale = da.mean(dim=\"band\")\n",
-                "\n",
-                "# Plot on a map\n",
-                "ax = plt.subplot(projection=ccrs.PlateCarree())\n",
-                "greyscale.plot(\n",
-                "    ax=ax,\n",
-                "    x=\"lon\",\n",
-                "    y=\"lat\",\n",
-                "    transform=ccrs.PlateCarree(),\n",
-                "    cmap=\"Greys_r\",\n",
-                "    shading=\"auto\",\n",
-                "    add_colorbar=False,\n",
-                ")\n",
-                "ax.coastlines(\"10m\", color=\"r\")"
-            ]
         }
     ],
     "metadata": {
         "kernelspec": {
             "display_name": "Python 3 (ipykernel)",
             "language": "python",
             "name": "python3"
@@ -292,12 +208,19 @@
             },
             "file_extension": ".py",
             "mimetype": "text/x-python",
             "name": "python",
             "nbconvert_exporter": "python",
             "pygments_lexer": "ipython3",
             "version": "3.9.7"
+        },
+        "widgets": {
+            "application/vnd.jupyter.widget-state+json": {
+                "state": {},
+                "version_major": 2,
+                "version_minor": 0
+            }
         }
     },
     "nbformat": 4,
     "nbformat_minor": 4
 }
```

### Comparing `xarray-2023.5.0/doc/examples/weather-data.ipynb` & `xarray-2023.6.0/doc/examples/weather-data.ipynb`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/gallery/plot_cartopy_facetgrid.py` & `xarray-2023.6.0/doc/gallery/plot_cartopy_facetgrid.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/gallery/plot_colorbar_center.py` & `xarray-2023.6.0/doc/gallery/plot_colorbar_center.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/gallery/plot_control_colorbar.py` & `xarray-2023.6.0/doc/gallery/plot_control_colorbar.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/gallery/plot_lines_from_2d.py` & `xarray-2023.6.0/doc/gallery/plot_lines_from_2d.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/gallery.rst` & `xarray-2023.6.0/doc/gallery.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/gallery.yml` & `xarray-2023.6.0/doc/gallery.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/getting-started-guide/faq.rst` & `xarray-2023.6.0/doc/getting-started-guide/faq.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/getting-started-guide/installing.rst` & `xarray-2023.6.0/doc/getting-started-guide/installing.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/getting-started-guide/quick-overview.rst` & `xarray-2023.6.0/doc/getting-started-guide/quick-overview.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/getting-started-guide/why-xarray.rst` & `xarray-2023.6.0/doc/getting-started-guide/why-xarray.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/howdoi.rst` & `xarray-2023.6.0/doc/howdoi.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/index.rst` & `xarray-2023.6.0/doc/index.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/internals/duck-arrays-integration.rst` & `xarray-2023.6.0/doc/internals/duck-arrays-integration.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/internals/extending-xarray.rst` & `xarray-2023.6.0/doc/internals/extending-xarray.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/internals/how-to-add-new-backend.rst` & `xarray-2023.6.0/doc/internals/how-to-add-new-backend.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/internals/variable-objects.rst` & `xarray-2023.6.0/doc/internals/variable-objects.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/internals/zarr-encoding-spec.rst` & `xarray-2023.6.0/doc/internals/zarr-encoding-spec.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/roadmap.rst` & `xarray-2023.6.0/doc/roadmap.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/tutorials-and-videos.rst` & `xarray-2023.6.0/doc/tutorials-and-videos.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/combining.rst` & `xarray-2023.6.0/doc/user-guide/combining.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/computation.rst` & `xarray-2023.6.0/doc/user-guide/computation.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/dask.rst` & `xarray-2023.6.0/doc/user-guide/dask.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/data-structures.rst` & `xarray-2023.6.0/doc/user-guide/data-structures.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/duckarrays.rst` & `xarray-2023.6.0/doc/user-guide/duckarrays.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/groupby.rst` & `xarray-2023.6.0/doc/user-guide/groupby.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/indexing.rst` & `xarray-2023.6.0/doc/user-guide/indexing.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/interpolation.rst` & `xarray-2023.6.0/doc/user-guide/interpolation.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/io.rst` & `xarray-2023.6.0/doc/user-guide/io.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/options.rst` & `xarray-2023.6.0/doc/user-guide/options.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/pandas.rst` & `xarray-2023.6.0/doc/user-guide/pandas.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/plotting.rst` & `xarray-2023.6.0/doc/user-guide/plotting.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/reshaping.rst` & `xarray-2023.6.0/doc/user-guide/reshaping.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/terminology.rst` & `xarray-2023.6.0/doc/user-guide/terminology.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/time-series.rst` & `xarray-2023.6.0/doc/user-guide/time-series.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/user-guide/weather-climate.rst` & `xarray-2023.6.0/doc/user-guide/weather-climate.rst`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/videos.yml` & `xarray-2023.6.0/doc/videos.yml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/doc/whats-new.rst` & `xarray-2023.6.0/doc/whats-new.rst`

 * *Files 0% similar despite different names*

```diff
@@ -11,54 +11,90 @@
     import xarray as xray
     import xarray
     import xarray as xr
 
     np.random.seed(123456)
 
 
-.. _whats-new.2023.05.1:
+.. _whats-new.2023.06.0:
+
+v2023.06.0 (June 21, 2023)
+--------------------------
+
+This release adds features to ``curvefit``, improves the performance of concatenation, and fixes various bugs.
+
+Thank to our 13 contributors to this release:
+Anderson Banihirwe, Deepak Cherian, dependabot[bot], Illviljan, Juniper Tyree, Justus Magin, Martin Fleischmann,
+Mattia Almansi, mgunyho, Rutger van Haasteren, Thomas Nicholas, Tom Nicholas, Tom White.
 
-v2023.05.1 (unreleased)
------------------------
 
 New Features
 ~~~~~~~~~~~~
 
+- Added support for multidimensional initial guess and bounds in :py:meth:`DataArray.curvefit` (:issue:`7768`, :pull:`7821`).
+  By `Andrs Gunyh <https://github.com/mgunyho>`_.
+- Add an ``errors`` option to :py:meth:`Dataset.curve_fit` that allows
+  returning NaN for the parameters and covariances of failed fits, rather than
+  failing the whole series of fits (:issue:`6317`, :pull:`7891`).
+  By `Dominik Staczak <https://github.com/StanczakDominik>`_ and `Andrs Gunyh <https://github.com/mgunyho>`_.
 
 Breaking changes
 ~~~~~~~~~~~~~~~~
 
 
 Deprecations
 ~~~~~~~~~~~~
+- Deprecate the `cdms2 <https://github.com/CDAT/cdms>`_ conversion methods (:pull:`7876`)
+  By `Justus Magin <https://github.com/keewis>`_.
 
 Performance
 ~~~~~~~~~~~
-
+- Improve concatenation performance (:issue:`7833`, :pull:`7824`).
+  By `Jimmy Westling <https://github.com/illviljan>`_.
 
 Bug fixes
 ~~~~~~~~~
-
+- Fix bug where weighted ``polyfit`` were changing the original object (:issue:`5644`, :pull:`7900`).
+  By `Mattia Almansi <https://github.com/malmans2>`_.
+- Don't call ``CachingFileManager.__del__`` on interpreter shutdown (:issue:`7814`, :pull:`7880`).
+  By `Justus Magin <https://github.com/keewis>`_.
+- Preserve vlen dtype for empty string arrays (:issue:`7328`, :pull:`7862`).
+  By `Tom White <https://github.com/tomwhite>`_ and `Kai Mhlbauer <https://github.com/kmuehlbauer>`_.
+- Ensure dtype of reindex result matches dtype of the original DataArray (:issue:`7299`, :pull:`7917`)
+  By `Anderson Banihirwe <https://github.com/andersy005>`_.
+- Fix bug where a zero-length zarr ``chunk_store`` was ignored as if it was ``None`` (:pull:`7923`)
+  By `Juniper Tyree <https://github.com/juntyr>`_.
 
 Documentation
 ~~~~~~~~~~~~~
 
 
 Internal Changes
 ~~~~~~~~~~~~~~~~
 
+- Minor improvements to support of the python `array api standard <https://data-apis.org/array-api/latest/>`_,
+  internally using the function ``xp.astype()`` instead of the method ``arr.astype()``, as the latter is not in the standard.
+  (:pull:`7847`) By `Tom Nicholas <https://github.com/TomNicholas>`_.
+- Xarray now uploads nightly wheels to https://pypi.anaconda.org/scientific-python-nightly-wheels/simple/ (:issue:`7863`, :pull:`7865`).
+  By `Martin Fleischmann <https://github.com/martinfleis>`_.
+- Stop uploading development wheels to TestPyPI (:pull:`7889`)
+  By `Justus Magin <https://github.com/keewis>`_.
+- Added an exception catch for ``AttributeError`` along with ``ImportError`` when duck typing the dynamic imports in pycompat.py. This catches some name collisions between packages. (:issue:`7870`, :pull:`7874`)
 
 .. _whats-new.2023.05.0:
 
 v2023.05.0 (May 18, 2023)
 -------------------------
 
 This release adds some new methods and operators, updates our deprecation policy for python versions, fixes some bugs with groupby,
 and introduces experimental support for alternative chunked parallel array computation backends via a new plugin system!
 
+**Note:** If you are using a locally-installed development version of xarray then pulling the changes from this release may require you to re-install.
+This avoids an error where xarray cannot detect dask via the new entrypoints system introduced in :pull:`7019`. See :issue:`7856` for details.
+
 Thanks to our 14 contributors:
 Alan Brammer, crusaderky, David Stansby, dcherian, Deeksha, Deepak Cherian, Illviljan, James McCreight,
 Joe Hamman, Justus Magin, Kyle Sunden, Max Hollmann, mgunyho, and Tom Nicholas
 
 
 New Features
 ~~~~~~~~~~~~
```

### Comparing `xarray-2023.5.0/licenses/DASK_LICENSE` & `xarray-2023.6.0/licenses/DASK_LICENSE`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/licenses/ICOMOON_LICENSE` & `xarray-2023.6.0/licenses/ICOMOON_LICENSE`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/licenses/NUMPY_LICENSE` & `xarray-2023.6.0/licenses/NUMPY_LICENSE`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/licenses/PANDAS_LICENSE` & `xarray-2023.6.0/licenses/PANDAS_LICENSE`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/licenses/PYTHON_LICENSE` & `xarray-2023.6.0/licenses/PYTHON_LICENSE`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/licenses/SCIKIT_LEARN_LICENSE` & `xarray-2023.6.0/licenses/SCIKIT_LEARN_LICENSE`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/licenses/SEABORN_LICENSE` & `xarray-2023.6.0/licenses/SEABORN_LICENSE`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/properties/README.md` & `xarray-2023.6.0/properties/README.md`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/properties/test_encode_decode.py` & `xarray-2023.6.0/properties/test_encode_decode.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/properties/test_pandas_roundtrip.py` & `xarray-2023.6.0/properties/test_pandas_roundtrip.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/pyproject.toml` & `xarray-2023.6.0/pyproject.toml`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/setup.cfg` & `xarray-2023.6.0/setup.cfg`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/__init__.py` & `xarray-2023.6.0/xarray/__init__.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/__init__.py` & `xarray-2023.6.0/xarray/backends/__init__.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/api.py` & `xarray-2023.6.0/xarray/backends/api.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/common.py` & `xarray-2023.6.0/xarray/backends/common.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/file_manager.py` & `xarray-2023.6.0/xarray/backends/file_manager.py`

 * *Files 1% similar despite different names*

```diff
@@ -1,9 +1,10 @@
 from __future__ import annotations
 
+import atexit
 import contextlib
 import io
 import threading
 import uuid
 import warnings
 from collections.abc import Hashable
 from typing import Any
@@ -285,14 +286,21 @@
             args_string += f", mode={self._mode!r}"
         return (
             f"{type(self).__name__}({self._opener!r}, {args_string}, "
             f"kwargs={self._kwargs}, manager_id={self._manager_id!r})"
         )
 
 
+@atexit.register
+def _remove_del_method():
+    # We don't need to close unclosed files at program exit, and may not be able
+    # to, because Python is cleaning up imports / globals.
+    del CachingFileManager.__del__
+
+
 class _RefCounter:
     """Class for keeping track of reference counts."""
 
     def __init__(self, counts):
         self._counts = counts
         self._lock = threading.Lock()
```

### Comparing `xarray-2023.5.0/xarray/backends/h5netcdf_.py` & `xarray-2023.6.0/xarray/backends/h5netcdf_.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/locks.py` & `xarray-2023.6.0/xarray/backends/locks.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/lru_cache.py` & `xarray-2023.6.0/xarray/backends/lru_cache.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/memory.py` & `xarray-2023.6.0/xarray/backends/memory.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/netCDF4_.py` & `xarray-2023.6.0/xarray/backends/netCDF4_.py`

 * *Files 1% similar despite different names*

```diff
@@ -61,18 +61,20 @@
         self.variable_name = variable_name
 
         array = self.get_array()
         self.shape = array.shape
 
         dtype = array.dtype
         if dtype is str:
-            # use object dtype because that's the only way in numpy to
-            # represent variable length strings; it also prevents automatic
-            # string concatenation via conventions.decode_cf_variable
-            dtype = np.dtype("O")
+            # use object dtype (with additional vlen string metadata) because that's
+            # the only way in numpy to represent variable length strings and to
+            # check vlen string dtype in further steps
+            # it also prevents automatic string concatenation via
+            # conventions.decode_cf_variable
+            dtype = coding.strings.create_vlen_dtype(str)
         self.dtype = dtype
 
     def __setitem__(self, key, value):
         with self.datastore.lock:
             data = self.get_array(needs_lock=False)
             data[key] = value
             if self.datastore.autoclose:
```

### Comparing `xarray-2023.5.0/xarray/backends/netcdf3.py` & `xarray-2023.6.0/xarray/backends/netcdf3.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/plugins.py` & `xarray-2023.6.0/xarray/backends/plugins.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/pseudonetcdf_.py` & `xarray-2023.6.0/xarray/backends/pseudonetcdf_.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/pydap_.py` & `xarray-2023.6.0/xarray/backends/pydap_.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/pynio_.py` & `xarray-2023.6.0/xarray/backends/pynio_.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/scipy_.py` & `xarray-2023.6.0/xarray/backends/scipy_.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/store.py` & `xarray-2023.6.0/xarray/backends/store.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/backends/zarr.py` & `xarray-2023.6.0/xarray/backends/zarr.py`

 * *Files 1% similar despite different names*

```diff
@@ -66,15 +66,22 @@
     def __init__(self, variable_name, datastore):
         self.datastore = datastore
         self.variable_name = variable_name
 
         array = self.get_array()
         self.shape = array.shape
 
-        dtype = array.dtype
+        # preserve vlen string object dtype (GH 7328)
+        if array.filters is not None and any(
+            [filt.codec_id == "vlen-utf8" for filt in array.filters]
+        ):
+            dtype = coding.strings.create_vlen_dtype(str)
+        else:
+            dtype = array.dtype
+
         self.dtype = dtype
 
     def get_array(self):
         return self.datastore.zarr_group[self.variable_name]
 
     def _oindex(self, key):
         return self.get_array().oindex[key]
@@ -406,15 +413,15 @@
                     f"zarr version {zarr_version}. See also "
                     "https://github.com/zarr-developers/zarr-specs/issues/136"
                 )
 
             if consolidated is None:
                 consolidated = False
 
-        if chunk_store:
+        if chunk_store is not None:
             open_kwargs["chunk_store"] = chunk_store
             if consolidated is None:
                 consolidated = False
 
         if consolidated is None:
             try:
                 zarr_group = zarr.open_consolidated(store, **open_kwargs)
```

### Comparing `xarray-2023.5.0/xarray/coding/calendar_ops.py` & `xarray-2023.6.0/xarray/coding/calendar_ops.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/coding/cftime_offsets.py` & `xarray-2023.6.0/xarray/coding/cftime_offsets.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/coding/cftimeindex.py` & `xarray-2023.6.0/xarray/coding/cftimeindex.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/coding/frequencies.py` & `xarray-2023.6.0/xarray/coding/frequencies.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/coding/strings.py` & `xarray-2023.6.0/xarray/coding/strings.py`

 * *Files 1% similar despite different names*

```diff
@@ -25,15 +25,16 @@
     return np.dtype("O", metadata={"element_type": element_type})
 
 
 def check_vlen_dtype(dtype):
     if dtype.kind != "O" or dtype.metadata is None:
         return None
     else:
-        return dtype.metadata.get("element_type")
+        # check xarray (element_type) as well as h5py (vlen)
+        return dtype.metadata.get("element_type", dtype.metadata.get("vlen"))
 
 
 def is_unicode_dtype(dtype):
     return dtype.kind == "U" or check_vlen_dtype(dtype) == str
 
 
 def is_bytes_dtype(dtype):
```

### Comparing `xarray-2023.5.0/xarray/coding/times.py` & `xarray-2023.6.0/xarray/coding/times.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/coding/variables.py` & `xarray-2023.6.0/xarray/coding/variables.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/conventions.py` & `xarray-2023.6.0/xarray/conventions.py`

 * *Files 0% similar despite different names*

```diff
@@ -104,14 +104,18 @@
 
 
 def ensure_dtype_not_object(var: Variable, name: T_Name = None) -> Variable:
     # TODO: move this from conventions to backends? (it's not CF related)
     if var.dtype.kind == "O":
         dims, data, attrs, encoding = _var_as_tuple(var)
 
+        # leave vlen dtypes unchanged
+        if strings.check_vlen_dtype(data.dtype) is not None:
+            return var
+
         if is_duck_dask_array(data):
             warnings.warn(
                 "variable {} has data in the form of a dask array with "
                 "dtype=object, which means it is being loaded into memory "
                 "to determine a data type that can be safely stored on disk. "
                 "To avoid this, coerce this variable to a fixed-size dtype "
                 "with astype() before saving it.".format(name),
```

### Comparing `xarray-2023.5.0/xarray/convert.py` & `xarray-2023.6.0/xarray/convert.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/_aggregations.py` & `xarray-2023.6.0/xarray/core/_aggregations.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/_typed_ops.py` & `xarray-2023.6.0/xarray/core/_typed_ops.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/_typed_ops.pyi` & `xarray-2023.6.0/xarray/core/_typed_ops.pyi`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/accessor_dt.py` & `xarray-2023.6.0/xarray/core/accessor_dt.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/accessor_str.py` & `xarray-2023.6.0/xarray/core/accessor_str.py`

 * *Files 1% similar despite different names*

```diff
@@ -47,14 +47,15 @@
 from operator import or_ as set_union
 from re import Pattern
 from typing import TYPE_CHECKING, Any, Callable, Generic
 from unicodedata import normalize
 
 import numpy as np
 
+from xarray.core import duck_array_ops
 from xarray.core.computation import apply_ufunc
 from xarray.core.types import T_DataArray
 
 if TYPE_CHECKING:
     from numpy.typing import DTypeLike
 
     from xarray.core.dataarray import DataArray
@@ -2081,21 +2082,24 @@
             return np.array(match, val.dtype)
 
         if dim is None:
             return self._apply(func=_get_res_single, func_args=(pat,))
         else:
             # dtype MUST be object or strings can be truncated
             # See: https://github.com/numpy/numpy/issues/8352
-            return self._apply(
-                func=_get_res_multi,
-                func_args=(pat,),
-                dtype=np.object_,
-                output_core_dims=[[dim]],
-                output_sizes={dim: maxgroups},
-            ).astype(self._obj.dtype.kind)
+            return duck_array_ops.astype(
+                self._apply(
+                    func=_get_res_multi,
+                    func_args=(pat,),
+                    dtype=np.object_,
+                    output_core_dims=[[dim]],
+                    output_sizes={dim: maxgroups},
+                ),
+                self._obj.dtype.kind,
+            )
 
     def extractall(
         self,
         pat: str | bytes | Pattern | Any,
         group_dim: Hashable,
         match_dim: Hashable,
         case: bool | None = None,
@@ -2254,23 +2258,26 @@
             else:
                 for imatch, match in enumerate(matches):
                     for jmatch, submatch in enumerate(match):
                         res[imatch, jmatch] = submatch
 
             return res
 
-        return self._apply(
-            # dtype MUST be object or strings can be truncated
-            # See: https://github.com/numpy/numpy/issues/8352
-            func=_get_res,
-            func_args=(pat,),
-            dtype=np.object_,
-            output_core_dims=[[group_dim, match_dim]],
-            output_sizes={group_dim: maxgroups, match_dim: maxcount},
-        ).astype(self._obj.dtype.kind)
+        return duck_array_ops.astype(
+            self._apply(
+                # dtype MUST be object or strings can be truncated
+                # See: https://github.com/numpy/numpy/issues/8352
+                func=_get_res,
+                func_args=(pat,),
+                dtype=np.object_,
+                output_core_dims=[[group_dim, match_dim]],
+                output_sizes={group_dim: maxgroups, match_dim: maxcount},
+            ),
+            self._obj.dtype.kind,
+        )
 
     def findall(
         self,
         pat: str | bytes | Pattern | Any,
         case: bool | None = None,
         flags: int = 0,
     ) -> T_DataArray:
@@ -2381,21 +2388,24 @@
         if not self._obj.size:
             return self._obj.copy().expand_dims({dim: 0}, axis=-1)  # type: ignore[return-value]
 
         arrfunc = lambda x, isep: np.array(func(x, isep), dtype=self._obj.dtype)
 
         # dtype MUST be object or strings can be truncated
         # See: https://github.com/numpy/numpy/issues/8352
-        return self._apply(
-            func=arrfunc,
-            func_args=(sep,),
-            dtype=np.object_,
-            output_core_dims=[[dim]],
-            output_sizes={dim: 3},
-        ).astype(self._obj.dtype.kind)
+        return duck_array_ops.astype(
+            self._apply(
+                func=arrfunc,
+                func_args=(sep,),
+                dtype=np.object_,
+                output_core_dims=[[dim]],
+                output_sizes={dim: 3},
+            ),
+            self._obj.dtype.kind,
+        )
 
     def partition(
         self,
         dim: Hashable | None,
         sep: str | bytes | Any = " ",
     ) -> T_DataArray:
         """
@@ -2506,21 +2516,24 @@
                     res += pad
                 else:
                     res = pad + res
             return np.array(res, dtype=dtype)
 
         # dtype MUST be object or strings can be truncated
         # See: https://github.com/numpy/numpy/issues/8352
-        return self._apply(
-            func=_dosplit,
-            func_args=(sep,),
-            dtype=np.object_,
-            output_core_dims=[[dim]],
-            output_sizes={dim: maxsplit},
-        ).astype(self._obj.dtype.kind)
+        return duck_array_ops.astype(
+            self._apply(
+                func=_dosplit,
+                func_args=(sep,),
+                dtype=np.object_,
+                output_core_dims=[[dim]],
+                output_sizes={dim: maxsplit},
+            ),
+            self._obj.dtype.kind,
+        )
 
     def split(
         self,
         dim: Hashable | None,
         sep: str | bytes | Any = None,
         maxsplit: int = -1,
     ) -> DataArray:
```

### Comparing `xarray-2023.5.0/xarray/core/alignment.py` & `xarray-2023.6.0/xarray/core/alignment.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/arithmetic.py` & `xarray-2023.6.0/xarray/core/arithmetic.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/combine.py` & `xarray-2023.6.0/xarray/core/combine.py`

 * *Files 0% similar despite different names*

```diff
@@ -966,26 +966,26 @@
 
         # Group by data vars
         sorted_datasets = sorted(data_objects, key=vars_as_keys)
         grouped_by_vars = itertools.groupby(sorted_datasets, key=vars_as_keys)
 
         # Perform the multidimensional combine on each group of data variables
         # before merging back together
-        concatenated_grouped_by_data_vars = []
-        for vars, datasets_with_same_vars in grouped_by_vars:
-            concatenated = _combine_single_variable_hypercube(
-                list(datasets_with_same_vars),
+        concatenated_grouped_by_data_vars = tuple(
+            _combine_single_variable_hypercube(
+                tuple(datasets_with_same_vars),
                 fill_value=fill_value,
                 data_vars=data_vars,
                 coords=coords,
                 compat=compat,
                 join=join,
                 combine_attrs=combine_attrs,
             )
-            concatenated_grouped_by_data_vars.append(concatenated)
+            for vars, datasets_with_same_vars in grouped_by_vars
+        )
 
     return merge(
         concatenated_grouped_by_data_vars,
         compat=compat,
         fill_value=fill_value,
         join=join,
         combine_attrs=combine_attrs,
```

### Comparing `xarray-2023.5.0/xarray/core/common.py` & `xarray-2023.6.0/xarray/core/common.py`

 * *Files 0% similar despite different names*

```diff
@@ -207,15 +207,15 @@
             Dimension name(s) for which to lookup axes.
 
         Returns
         -------
         int or tuple of int
             Axis number or numbers corresponding to the given dimensions.
         """
-        if isinstance(dim, Iterable) and not isinstance(dim, str):
+        if not isinstance(dim, str) and isinstance(dim, Iterable):
             return tuple(self._get_axis_num(d) for d in dim)
         else:
             return self._get_axis_num(dim)
 
     def _get_axis_num(self: Any, dim: Hashable) -> int:
         try:
             return self.dims.index(dim)
```

### Comparing `xarray-2023.5.0/xarray/core/computation.py` & `xarray-2023.6.0/xarray/core/computation.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/concat.py` & `xarray-2023.6.0/xarray/core/concat.py`

 * *Files 2% similar despite different names*

```diff
@@ -1,12 +1,13 @@
 from __future__ import annotations
 
 from collections.abc import Hashable, Iterable
 from typing import TYPE_CHECKING, Any, Union, cast, overload
 
+import numpy as np
 import pandas as pd
 
 from xarray.core import dtypes, utils
 from xarray.core.alignment import align, reindex_variables
 from xarray.core.duck_array_ops import lazy_array_equiv
 from xarray.core.indexes import Index, PandasIndex
 from xarray.core.merge import (
@@ -513,15 +514,15 @@
 
     result_vars = {}
     result_indexes = {}
 
     if variables_to_merge:
         grouped = {
             k: v
-            for k, v in collect_variables_and_indexes(list(datasets)).items()
+            for k, v in collect_variables_and_indexes(datasets).items()
             if k in variables_to_merge
         }
         merged_vars, merged_indexes = merge_collected(
             grouped, compat=compat, equals=equals
         )
         result_vars.update(merged_vars)
         result_indexes.update(merged_indexes)
@@ -539,15 +540,15 @@
 
     # we've already verified everything is consistent; now, calculate
     # shared dimension sizes so we can expand the necessary variables
     def ensure_common_dims(vars, concat_dim_lengths):
         # ensure each variable with the given name shares the same
         # dimensions and the same shape for all of them except along the
         # concat dimension
-        common_dims = tuple(pd.unique([d for v in vars for d in v.dims]))
+        common_dims = tuple(utils.OrderedSet(d for v in vars for d in v.dims))
         if dim not in common_dims:
             common_dims = (dim,) + common_dims
         for var, dim_len in zip(vars, concat_dim_lengths):
             if var.dims != common_dims:
                 common_shape = tuple(dims_sizes.get(d, dim_len) for d in common_dims)
                 var = var.set_dims(common_dims, common_shape)
             yield var
@@ -564,46 +565,53 @@
             elif name == dim:
                 var = ds._variables[name]
                 if not var.dims:
                     data = var.set_dims(dim).values
                     yield PandasIndex(data, dim, coord_dtype=var.dtype)
 
     # create concatenation index, needed for later reindexing
-    concat_index = list(range(sum(concat_dim_lengths)))
+    file_start_indexes = np.append(0, np.cumsum(concat_dim_lengths))
+    concat_index = np.arange(file_start_indexes[-1])
+    concat_index_size = concat_index.size
+    variable_index_mask = np.ones(concat_index_size, dtype=bool)
 
     # stack up each variable and/or index to fill-out the dataset (in order)
     # n.b. this loop preserves variable order, needed for groupby.
+    ndatasets = len(datasets)
     for name in vars_order:
         if name in concat_over and name not in result_indexes:
             variables = []
-            variable_index = []
+            # Initialize the mask to all True then set False if any name is missing in
+            # the datasets:
+            variable_index_mask.fill(True)
             var_concat_dim_length = []
             for i, ds in enumerate(datasets):
                 if name in ds.variables:
                     variables.append(ds[name].variable)
-                    # add to variable index, needed for reindexing
-                    var_idx = [
-                        sum(concat_dim_lengths[:i]) + k
-                        for k in range(concat_dim_lengths[i])
-                    ]
-                    variable_index.extend(var_idx)
-                    var_concat_dim_length.append(len(var_idx))
+                    var_concat_dim_length.append(concat_dim_lengths[i])
                 else:
                     # raise if coordinate not in all datasets
                     if name in coord_names:
                         raise ValueError(
                             f"coordinate {name!r} not present in all datasets."
                         )
+
+                    # Mask out the indexes without the name:
+                    start = file_start_indexes[i]
+                    end = file_start_indexes[i + 1]
+                    variable_index_mask[slice(start, end)] = False
+
+            variable_index = concat_index[variable_index_mask]
             vars = ensure_common_dims(variables, var_concat_dim_length)
 
             # Try to concatenate the indexes, concatenate the variables when no index
             # is found on all datasets.
             indexes: list[Index] = list(get_indexes(name))
             if indexes:
-                if len(indexes) < len(datasets):
+                if len(indexes) < ndatasets:
                     raise ValueError(
                         f"{name!r} must have either an index or no index in all datasets, "
                         f"found {len(indexes)}/{len(datasets)} datasets with an index."
                     )
                 combined_idx = indexes[0].concat(indexes, dim, positions)
                 if name in datasets[0]._indexes:
                     idx_vars = datasets[0].xindexes.get_all_coords(name)
@@ -619,15 +627,15 @@
                     )
                     result_vars[k] = v
             else:
                 combined_var = concat_vars(
                     vars, dim, positions, combine_attrs=combine_attrs
                 )
                 # reindex if variable is not present in all datasets
-                if len(variable_index) < len(concat_index):
+                if len(variable_index) < concat_index_size:
                     combined_var = reindex_variables(
                         variables={name: combined_var},
                         dim_pos_indexers={
                             dim: pd.Index(variable_index).get_indexer(concat_index)
                         },
                         fill_value=fill_value,
                     )[name]
```

### Comparing `xarray-2023.5.0/xarray/core/coordinates.py` & `xarray-2023.6.0/xarray/core/coordinates.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/dask_array_ops.py` & `xarray-2023.6.0/xarray/core/dask_array_ops.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/daskmanager.py` & `xarray-2023.6.0/xarray/core/daskmanager.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/dataarray.py` & `xarray-2023.6.0/xarray/core/dataarray.py`

 * *Files 0% similar despite different names*

```diff
@@ -38,14 +38,15 @@
 from xarray.core.options import OPTIONS, _get_keep_attrs
 from xarray.core.utils import (
     Default,
     HybridMappingProxy,
     ReprObject,
     _default,
     either_dict_or_kwargs,
+    emit_user_level_warning,
 )
 from xarray.core.variable import (
     IndexVariable,
     Variable,
     as_compatible_data,
     as_variable,
 )
@@ -4327,24 +4328,52 @@
         df = pd.DataFrame({temp_name: series})
         ds = Dataset.from_dataframe(df, sparse=sparse)
         result = cast(DataArray, ds[temp_name])
         result.name = series.name
         return result
 
     def to_cdms2(self) -> cdms2_Variable:
-        """Convert this array into a cdms2.Variable"""
+        """Convert this array into a cdms2.Variable
+
+        .. deprecated:: 2023.06.0
+            The `cdms2`_ library has been deprecated. Please consider using the
+            `xcdat`_ library instead.
+
+        .. _cdms2: https://github.com/CDAT/cdms
+        .. _xcdat: https://github.com/xCDAT/xcdat
+        """
         from xarray.convert import to_cdms2
 
+        emit_user_level_warning(
+            "The cdms2 library has been deprecated."
+            " Please consider using the xcdat library instead.",
+            DeprecationWarning,
+        )
+
         return to_cdms2(self)
 
     @classmethod
     def from_cdms2(cls, variable: cdms2_Variable) -> DataArray:
-        """Convert a cdms2.Variable into an xarray.DataArray"""
+        """Convert a cdms2.Variable into an xarray.DataArray
+
+        .. deprecated:: 2023.06.0
+            The `cdms2`_ library has been deprecated. Please consider using the
+            `xcdat`_ library instead.
+
+        .. _cdms2: https://github.com/CDAT/cdms
+        .. _xcdat: https://github.com/xCDAT/xcdat
+        """
         from xarray.convert import from_cdms2
 
+        emit_user_level_warning(
+            "The cdms2 library has been deprecated."
+            " Please consider using the xcdat library instead.",
+            DeprecationWarning,
+        )
+
         return from_cdms2(variable)
 
     def to_iris(self) -> iris_Cube:
         """Convert this array into a iris.cube.Cube"""
         from xarray.convert import to_iris
 
         return to_iris(self)
@@ -5471,14 +5500,15 @@
                 The covariance matrix of the polynomial coefficient estimates (only included if `full=False` and `cov=True`)
 
         See Also
         --------
         numpy.polyfit
         numpy.polyval
         xarray.polyval
+        DataArray.curvefit
         """
         return self._to_temp_dataset().polyfit(
             dim, deg, skipna=skipna, rcond=rcond, w=w, full=full, cov=cov
         )
 
     def pad(
         self: T_DataArray,
@@ -6125,17 +6155,18 @@
 
     def curvefit(
         self,
         coords: str | DataArray | Iterable[str | DataArray],
         func: Callable[..., Any],
         reduce_dims: Dims = None,
         skipna: bool = True,
-        p0: dict[str, Any] | None = None,
-        bounds: dict[str, Any] | None = None,
+        p0: dict[str, float | DataArray] | None = None,
+        bounds: dict[str, tuple[float | DataArray, float | DataArray]] | None = None,
         param_names: Sequence[str] | None = None,
+        errors: ErrorOptions = "raise",
         kwargs: dict[str, Any] | None = None,
     ) -> Dataset:
         """
         Curve fitting optimization for arbitrary functions.
 
         Wraps `scipy.optimize.curve_fit` with `apply_ufunc`.
 
@@ -6157,51 +6188,140 @@
             calling `ds.curvefit(coords='time', reduce_dims=['lat', 'lon'], ...)` will
             aggregate all lat and lon points and fit the specified function along the
             time dimension.
         skipna : bool, default: True
             Whether to skip missing values when fitting. Default is True.
         p0 : dict-like or None, optional
             Optional dictionary of parameter names to initial guesses passed to the
-            `curve_fit` `p0` arg. If none or only some parameters are passed, the rest will
-            be assigned initial values following the default scipy behavior.
-        bounds : dict-like or None, optional
-            Optional dictionary of parameter names to bounding values passed to the
-            `curve_fit` `bounds` arg. If none or only some parameters are passed, the rest
-            will be unbounded following the default scipy behavior.
+            `curve_fit` `p0` arg. If the values are DataArrays, they will be appropriately
+            broadcast to the coordinates of the array. If none or only some parameters are
+            passed, the rest will be assigned initial values following the default scipy
+            behavior.
+        bounds : dict-like, optional
+            Optional dictionary of parameter names to tuples of bounding values passed to the
+            `curve_fit` `bounds` arg. If any of the bounds are DataArrays, they will be
+            appropriately broadcast to the coordinates of the array. If none or only some
+            parameters are passed, the rest will be unbounded following the default scipy
+            behavior.
         param_names : sequence of Hashable or None, optional
             Sequence of names for the fittable parameters of `func`. If not supplied,
             this will be automatically determined by arguments of `func`. `param_names`
             should be manually supplied when fitting a function that takes a variable
             number of parameters.
+        errors : {"raise", "ignore"}, default: "raise"
+            If 'raise', any errors from the `scipy.optimize_curve_fit` optimization will
+            raise an exception. If 'ignore', the coefficients and covariances for the
+            coordinates where the fitting failed will be NaN.
         **kwargs : optional
             Additional keyword arguments to passed to scipy curve_fit.
 
         Returns
         -------
         curvefit_results : Dataset
             A single dataset which contains:
 
             [var]_curvefit_coefficients
                 The coefficients of the best fit.
             [var]_curvefit_covariance
                 The covariance matrix of the coefficient estimates.
 
+        Examples
+        --------
+        Generate some exponentially decaying data, where the decay constant and amplitude are
+        different for different values of the coordinate ``x``:
+
+        >>> rng = np.random.default_rng(seed=0)
+        >>> def exp_decay(t, time_constant, amplitude):
+        ...     return np.exp(-t / time_constant) * amplitude
+        ...
+        >>> t = np.linspace(0, 10, 11)
+        >>> da = xr.DataArray(
+        ...     np.stack(
+        ...         [
+        ...             exp_decay(t, 1, 0.1),
+        ...             exp_decay(t, 2, 0.2),
+        ...             exp_decay(t, 3, 0.3),
+        ...         ]
+        ...     )
+        ...     + rng.normal(size=(3, t.size)) * 0.01,
+        ...     coords={"x": [0, 1, 2], "time": t},
+        ... )
+        >>> da
+        <xarray.DataArray (x: 3, time: 11)>
+        array([[ 0.1012573 ,  0.0354669 ,  0.01993775,  0.00602771, -0.00352513,
+                 0.00428975,  0.01328788,  0.009562  , -0.00700381, -0.01264187,
+                -0.0062282 ],
+               [ 0.20041326,  0.09805582,  0.07138797,  0.03216692,  0.01974438,
+                 0.01097441,  0.00679441,  0.01015578,  0.01408826,  0.00093645,
+                 0.01501222],
+               [ 0.29334805,  0.21847449,  0.16305984,  0.11130396,  0.07164415,
+                 0.04744543,  0.03602333,  0.03129354,  0.01074885,  0.01284436,
+                 0.00910995]])
+        Coordinates:
+          * x        (x) int64 0 1 2
+          * time     (time) float64 0.0 1.0 2.0 3.0 4.0 5.0 6.0 7.0 8.0 9.0 10.0
+
+        Fit the exponential decay function to the data along the ``time`` dimension:
+
+        >>> fit_result = da.curvefit("time", exp_decay)
+        >>> fit_result["curvefit_coefficients"].sel(
+        ...     param="time_constant"
+        ... )  # doctest: +NUMBER
+        <xarray.DataArray 'curvefit_coefficients' (x: 3)>
+        array([1.0569203, 1.7354963, 2.9421577])
+        Coordinates:
+          * x        (x) int64 0 1 2
+            param    <U13 'time_constant'
+        >>> fit_result["curvefit_coefficients"].sel(param="amplitude")
+        <xarray.DataArray 'curvefit_coefficients' (x: 3)>
+        array([0.1005489 , 0.19631423, 0.30003579])
+        Coordinates:
+          * x        (x) int64 0 1 2
+            param    <U13 'amplitude'
+
+        An initial guess can also be given with the ``p0`` arg (although it does not make much
+        of a difference in this simple example). To have a different guess for different
+        coordinate points, the guess can be a DataArray. Here we use the same initial guess
+        for the amplitude but different guesses for the time constant:
+
+        >>> fit_result = da.curvefit(
+        ...     "time",
+        ...     exp_decay,
+        ...     p0={
+        ...         "amplitude": 0.2,
+        ...         "time_constant": xr.DataArray([1, 2, 3], coords=[da.x]),
+        ...     },
+        ... )
+        >>> fit_result["curvefit_coefficients"].sel(param="time_constant")
+        <xarray.DataArray 'curvefit_coefficients' (x: 3)>
+        array([1.0569213 , 1.73550052, 2.94215733])
+        Coordinates:
+          * x        (x) int64 0 1 2
+            param    <U13 'time_constant'
+        >>> fit_result["curvefit_coefficients"].sel(param="amplitude")
+        <xarray.DataArray 'curvefit_coefficients' (x: 3)>
+        array([0.10054889, 0.1963141 , 0.3000358 ])
+        Coordinates:
+          * x        (x) int64 0 1 2
+            param    <U13 'amplitude'
+
         See Also
         --------
         DataArray.polyfit
         scipy.optimize.curve_fit
         """
         return self._to_temp_dataset().curvefit(
             coords,
             func,
             reduce_dims=reduce_dims,
             skipna=skipna,
             p0=p0,
             bounds=bounds,
             param_names=param_names,
+            errors=errors,
             kwargs=kwargs,
         )
 
     def drop_duplicates(
         self: T_DataArray,
         dim: Hashable | Iterable[Hashable],
         keep: Literal["first", "last", False] = "first",
```

### Comparing `xarray-2023.5.0/xarray/core/dataset.py` & `xarray-2023.6.0/xarray/core/dataset.py`

 * *Files 1% similar despite different names*

```diff
@@ -675,21665 +675,21860 @@
 00002a20: 7420 696e 6974 6961 6c20 6775 6573 7320  t initial guess 
 00002a30: 616e 6420 626f 756e 6473 2066 6f72 2063  and bounds for c
 00002a40: 7572 7665 6669 742e 0a20 2020 2050 7269  urvefit..    Pri
 00002a50: 6f72 6974 793a 2031 2920 7061 7373 6564  ority: 1) passed
 00002a60: 2061 7267 7320 3229 2066 756e 6320 7369   args 2) func si
 00002a70: 676e 6174 7572 6520 3329 2073 6369 7079  gnature 3) scipy
 00002a80: 2064 6566 6175 6c74 730a 2020 2020 2222   defaults.    ""
-00002a90: 220a 0a20 2020 2064 6566 205f 696e 6974  "..    def _init
-00002aa0: 6961 6c69 7a65 5f66 6561 7369 626c 6528  ialize_feasible(
-00002ab0: 6c62 2c20 7562 293a 0a20 2020 2020 2020  lb, ub):.       
-00002ac0: 2023 204d 696d 6963 7320 6675 6e63 7469   # Mimics functi
-00002ad0: 6f6e 616c 6974 7920 6f66 2073 6369 7079  onality of scipy
-00002ae0: 2e6f 7074 696d 697a 652e 6d69 6e70 6163  .optimize.minpac
-00002af0: 6b2e 5f69 6e69 7469 616c 697a 655f 6665  k._initialize_fe
-00002b00: 6173 6962 6c65 0a20 2020 2020 2020 206c  asible.        l
-00002b10: 625f 6669 6e69 7465 203d 206e 702e 6973  b_finite = np.is
-00002b20: 6669 6e69 7465 286c 6229 0a20 2020 2020  finite(lb).     
-00002b30: 2020 2075 625f 6669 6e69 7465 203d 206e     ub_finite = n
-00002b40: 702e 6973 6669 6e69 7465 2875 6229 0a20  p.isfinite(ub). 
-00002b50: 2020 2020 2020 2070 3020 3d20 6e70 2e6e         p0 = np.n
-00002b60: 616e 7375 6d28 0a20 2020 2020 2020 2020  ansum(.         
-00002b70: 2020 205b 0a20 2020 2020 2020 2020 2020     [.           
-00002b80: 2020 2020 2030 2e35 202a 2028 6c62 202b       0.5 * (lb +
-00002b90: 2075 6229 202a 2069 6e74 286c 625f 6669   ub) * int(lb_fi
-00002ba0: 6e69 7465 2026 2075 625f 6669 6e69 7465  nite & ub_finite
-00002bb0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00002bc0: 2020 2028 6c62 202b 2031 2920 2a20 696e     (lb + 1) * in
-00002bd0: 7428 6c62 5f66 696e 6974 6520 2620 7e75  t(lb_finite & ~u
-00002be0: 625f 6669 6e69 7465 292c 0a20 2020 2020  b_finite),.     
-00002bf0: 2020 2020 2020 2020 2020 2028 7562 202d             (ub -
-00002c00: 2031 2920 2a20 696e 7428 7e6c 625f 6669   1) * int(~lb_fi
-00002c10: 6e69 7465 2026 2075 625f 6669 6e69 7465  nite & ub_finite
-00002c20: 292c 0a20 2020 2020 2020 2020 2020 205d  ),.            ]
-00002c30: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00002c40: 2020 2072 6574 7572 6e20 7030 0a0a 2020     return p0..  
-00002c50: 2020 7061 7261 6d5f 6465 6661 756c 7473    param_defaults
-00002c60: 203d 207b 703a 2031 2066 6f72 2070 2069   = {p: 1 for p i
-00002c70: 6e20 7061 7261 6d73 7d0a 2020 2020 626f  n params}.    bo
-00002c80: 756e 6473 5f64 6566 6175 6c74 7320 3d20  unds_defaults = 
-00002c90: 7b70 3a20 282d 6e70 2e69 6e66 2c20 6e70  {p: (-np.inf, np
-00002ca0: 2e69 6e66 2920 666f 7220 7020 696e 2070  .inf) for p in p
-00002cb0: 6172 616d 737d 0a20 2020 2066 6f72 2070  arams}.    for p
-00002cc0: 2069 6e20 7061 7261 6d73 3a0a 2020 2020   in params:.    
-00002cd0: 2020 2020 6966 2070 2069 6e20 6675 6e63      if p in func
-00002ce0: 5f61 7267 7320 616e 6420 6675 6e63 5f61  _args and func_a
-00002cf0: 7267 735b 705d 2e64 6566 6175 6c74 2069  rgs[p].default i
-00002d00: 7320 6e6f 7420 6675 6e63 5f61 7267 735b  s not func_args[
-00002d10: 705d 2e65 6d70 7479 3a0a 2020 2020 2020  p].empty:.      
-00002d20: 2020 2020 2020 7061 7261 6d5f 6465 6661        param_defa
-00002d30: 756c 7473 5b70 5d20 3d20 6675 6e63 5f61  ults[p] = func_a
-00002d40: 7267 735b 705d 2e64 6566 6175 6c74 0a20  rgs[p].default. 
-00002d50: 2020 2020 2020 2069 6620 7020 696e 2062         if p in b
-00002d60: 6f75 6e64 733a 0a20 2020 2020 2020 2020  ounds:.         
-00002d70: 2020 2062 6f75 6e64 735f 6465 6661 756c     bounds_defaul
-00002d80: 7473 5b70 5d20 3d20 7475 706c 6528 626f  ts[p] = tuple(bo
-00002d90: 756e 6473 5b70 5d29 0a20 2020 2020 2020  unds[p]).       
-00002da0: 2020 2020 2069 6620 7061 7261 6d5f 6465       if param_de
-00002db0: 6661 756c 7473 5b70 5d20 3c20 626f 756e  faults[p] < boun
-00002dc0: 6473 5b70 5d5b 305d 206f 7220 7061 7261  ds[p][0] or para
-00002dd0: 6d5f 6465 6661 756c 7473 5b70 5d20 3e20  m_defaults[p] > 
-00002de0: 626f 756e 6473 5b70 5d5b 315d 3a0a 2020  bounds[p][1]:.  
-00002df0: 2020 2020 2020 2020 2020 2020 2020 7061                pa
-00002e00: 7261 6d5f 6465 6661 756c 7473 5b70 5d20  ram_defaults[p] 
-00002e10: 3d20 5f69 6e69 7469 616c 697a 655f 6665  = _initialize_fe
-00002e20: 6173 6962 6c65 2862 6f75 6e64 735b 705d  asible(bounds[p]
-00002e30: 5b30 5d2c 2062 6f75 6e64 735b 705d 5b31  [0], bounds[p][1
-00002e40: 5d29 0a20 2020 2020 2020 2069 6620 7020  ]).        if p 
-00002e50: 696e 2070 303a 0a20 2020 2020 2020 2020  in p0:.         
-00002e60: 2020 2070 6172 616d 5f64 6566 6175 6c74     param_default
-00002e70: 735b 705d 203d 2070 305b 705d 0a20 2020  s[p] = p0[p].   
-00002e80: 2072 6574 7572 6e20 7061 7261 6d5f 6465   return param_de
-00002e90: 6661 756c 7473 2c20 626f 756e 6473 5f64  faults, bounds_d
-00002ea0: 6566 6175 6c74 730a 0a0a 636c 6173 7320  efaults...class 
-00002eb0: 4461 7461 5661 7269 6162 6c65 7328 4d61  DataVariables(Ma
-00002ec0: 7070 696e 675b 416e 792c 2022 4461 7461  pping[Any, "Data
-00002ed0: 4172 7261 7922 5d29 3a0a 2020 2020 5f5f  Array"]):.    __
-00002ee0: 736c 6f74 735f 5f20 3d20 2822 5f64 6174  slots__ = ("_dat
-00002ef0: 6173 6574 222c 290a 0a20 2020 2064 6566  aset",)..    def
-00002f00: 205f 5f69 6e69 745f 5f28 7365 6c66 2c20   __init__(self, 
-00002f10: 6461 7461 7365 743a 2044 6174 6173 6574  dataset: Dataset
-00002f20: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00002f30: 5f64 6174 6173 6574 203d 2064 6174 6173  _dataset = datas
-00002f40: 6574 0a0a 2020 2020 6465 6620 5f5f 6974  et..    def __it
-00002f50: 6572 5f5f 2873 656c 6629 202d 3e20 4974  er__(self) -> It
-00002f60: 6572 6174 6f72 5b48 6173 6861 626c 655d  erator[Hashable]
-00002f70: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00002f80: 2028 0a20 2020 2020 2020 2020 2020 206b   (.            k
-00002f90: 6579 0a20 2020 2020 2020 2020 2020 2066  ey.            f
-00002fa0: 6f72 206b 6579 2069 6e20 7365 6c66 2e5f  or key in self._
-00002fb0: 6461 7461 7365 742e 5f76 6172 6961 626c  dataset._variabl
-00002fc0: 6573 0a20 2020 2020 2020 2020 2020 2069  es.            i
-00002fd0: 6620 6b65 7920 6e6f 7420 696e 2073 656c  f key not in sel
-00002fe0: 662e 5f64 6174 6173 6574 2e5f 636f 6f72  f._dataset._coor
-00002ff0: 645f 6e61 6d65 730a 2020 2020 2020 2020  d_names.        
-00003000: 290a 0a20 2020 2064 6566 205f 5f6c 656e  )..    def __len
-00003010: 5f5f 2873 656c 6629 202d 3e20 696e 743a  __(self) -> int:
-00003020: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00003030: 6c65 6e28 7365 6c66 2e5f 6461 7461 7365  len(self._datase
-00003040: 742e 5f76 6172 6961 626c 6573 2920 2d20  t._variables) - 
-00003050: 6c65 6e28 7365 6c66 2e5f 6461 7461 7365  len(self._datase
-00003060: 742e 5f63 6f6f 7264 5f6e 616d 6573 290a  t._coord_names).
-00003070: 0a20 2020 2064 6566 205f 5f63 6f6e 7461  .    def __conta
-00003080: 696e 735f 5f28 7365 6c66 2c20 6b65 793a  ins__(self, key:
-00003090: 2048 6173 6861 626c 6529 202d 3e20 626f   Hashable) -> bo
-000030a0: 6f6c 3a0a 2020 2020 2020 2020 7265 7475  ol:.        retu
-000030b0: 726e 206b 6579 2069 6e20 7365 6c66 2e5f  rn key in self._
-000030c0: 6461 7461 7365 742e 5f76 6172 6961 626c  dataset._variabl
-000030d0: 6573 2061 6e64 206b 6579 206e 6f74 2069  es and key not i
-000030e0: 6e20 7365 6c66 2e5f 6461 7461 7365 742e  n self._dataset.
-000030f0: 5f63 6f6f 7264 5f6e 616d 6573 0a0a 2020  _coord_names..  
-00003100: 2020 6465 6620 5f5f 6765 7469 7465 6d5f    def __getitem_
-00003110: 5f28 7365 6c66 2c20 6b65 793a 2048 6173  _(self, key: Has
-00003120: 6861 626c 6529 202d 3e20 4461 7461 4172  hable) -> DataAr
-00003130: 7261 793a 0a20 2020 2020 2020 2069 6620  ray:.        if 
-00003140: 6b65 7920 6e6f 7420 696e 2073 656c 662e  key not in self.
-00003150: 5f64 6174 6173 6574 2e5f 636f 6f72 645f  _dataset._coord_
-00003160: 6e61 6d65 733a 0a20 2020 2020 2020 2020  names:.         
-00003170: 2020 2072 6574 7572 6e20 6361 7374 2822     return cast("
-00003180: 4461 7461 4172 7261 7922 2c20 7365 6c66  DataArray", self
-00003190: 2e5f 6461 7461 7365 745b 6b65 795d 290a  ._dataset[key]).
-000031a0: 2020 2020 2020 2020 7261 6973 6520 4b65          raise Ke
-000031b0: 7945 7272 6f72 286b 6579 290a 0a20 2020  yError(key)..   
-000031c0: 2064 6566 205f 5f72 6570 725f 5f28 7365   def __repr__(se
-000031d0: 6c66 2920 2d3e 2073 7472 3a0a 2020 2020  lf) -> str:.    
-000031e0: 2020 2020 7265 7475 726e 2066 6f72 6d61      return forma
-000031f0: 7474 696e 672e 6461 7461 5f76 6172 735f  tting.data_vars_
-00003200: 7265 7072 2873 656c 6629 0a0a 2020 2020  repr(self)..    
-00003210: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00003220: 6620 7661 7269 6162 6c65 7328 7365 6c66  f variables(self
-00003230: 2920 2d3e 204d 6170 7069 6e67 5b48 6173  ) -> Mapping[Has
-00003240: 6861 626c 652c 2056 6172 6961 626c 655d  hable, Variable]
-00003250: 3a0a 2020 2020 2020 2020 616c 6c5f 7661  :.        all_va
-00003260: 7269 6162 6c65 7320 3d20 7365 6c66 2e5f  riables = self._
-00003270: 6461 7461 7365 742e 7661 7269 6162 6c65  dataset.variable
-00003280: 730a 2020 2020 2020 2020 7265 7475 726e  s.        return
-00003290: 2046 726f 7a65 6e28 7b6b 3a20 616c 6c5f   Frozen({k: all_
-000032a0: 7661 7269 6162 6c65 735b 6b5d 2066 6f72  variables[k] for
-000032b0: 206b 2069 6e20 7365 6c66 7d29 0a0a 2020   k in self})..  
-000032c0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-000032d0: 6465 6620 6474 7970 6573 2873 656c 6629  def dtypes(self)
-000032e0: 202d 3e20 4672 6f7a 656e 5b48 6173 6861   -> Frozen[Hasha
-000032f0: 626c 652c 206e 702e 6474 7970 655d 3a0a  ble, np.dtype]:.
-00003300: 2020 2020 2020 2020 2222 224d 6170 7069          """Mappi
-00003310: 6e67 2066 726f 6d20 6461 7461 2076 6172  ng from data var
-00003320: 6961 626c 6520 6e61 6d65 7320 746f 2064  iable names to d
-00003330: 7479 7065 732e 0a0a 2020 2020 2020 2020  types...        
-00003340: 4361 6e6e 6f74 2062 6520 6d6f 6469 6669  Cannot be modifi
-00003350: 6564 2064 6972 6563 746c 792c 2062 7574  ed directly, but
-00003360: 2069 7320 7570 6461 7465 6420 7768 656e   is updated when
-00003370: 2061 6464 696e 6720 6e65 7720 7661 7269   adding new vari
-00003380: 6162 6c65 732e 0a0a 2020 2020 2020 2020  ables...        
-00003390: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-000033a0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-000033b0: 2020 4461 7461 7365 742e 6474 7970 650a    Dataset.dtype.
-000033c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000033d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000033e0: 5f64 6174 6173 6574 2e64 7479 7065 730a  _dataset.dtypes.
-000033f0: 0a20 2020 2064 6566 205f 6970 7974 686f  .    def _ipytho
-00003400: 6e5f 6b65 795f 636f 6d70 6c65 7469 6f6e  n_key_completion
-00003410: 735f 2873 656c 6629 3a0a 2020 2020 2020  s_(self):.      
-00003420: 2020 2222 2250 726f 7669 6465 206d 6574    """Provide met
-00003430: 686f 6420 666f 7220 7468 6520 6b65 792d  hod for the key-
-00003440: 6175 746f 636f 6d70 6c65 7469 6f6e 7320  autocompletions 
-00003450: 696e 2049 5079 7468 6f6e 2e22 2222 0a20  in IPython.""". 
-00003460: 2020 2020 2020 2072 6574 7572 6e20 5b0a         return [.
-00003470: 2020 2020 2020 2020 2020 2020 6b65 790a              key.
-00003480: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00003490: 6b65 7920 696e 2073 656c 662e 5f64 6174  key in self._dat
-000034a0: 6173 6574 2e5f 6970 7974 686f 6e5f 6b65  aset._ipython_ke
-000034b0: 795f 636f 6d70 6c65 7469 6f6e 735f 2829  y_completions_()
-000034c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000034d0: 6b65 7920 6e6f 7420 696e 2073 656c 662e  key not in self.
-000034e0: 5f64 6174 6173 6574 2e5f 636f 6f72 645f  _dataset._coord_
-000034f0: 6e61 6d65 730a 2020 2020 2020 2020 5d0a  names.        ].
-00003500: 0a0a 636c 6173 7320 5f4c 6f63 496e 6465  ..class _LocInde
-00003510: 7865 7228 4765 6e65 7269 635b 545f 4461  xer(Generic[T_Da
-00003520: 7461 7365 745d 293a 0a20 2020 205f 5f73  taset]):.    __s
-00003530: 6c6f 7473 5f5f 203d 2028 2264 6174 6173  lots__ = ("datas
-00003540: 6574 222c 290a 0a20 2020 2064 6566 205f  et",)..    def _
-00003550: 5f69 6e69 745f 5f28 7365 6c66 2c20 6461  _init__(self, da
-00003560: 7461 7365 743a 2054 5f44 6174 6173 6574  taset: T_Dataset
-00003570: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00003580: 6461 7461 7365 7420 3d20 6461 7461 7365  dataset = datase
-00003590: 740a 0a20 2020 2064 6566 205f 5f67 6574  t..    def __get
-000035a0: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
-000035b0: 3a20 4d61 7070 696e 675b 416e 792c 2041  : Mapping[Any, A
-000035c0: 6e79 5d29 202d 3e20 545f 4461 7461 7365  ny]) -> T_Datase
-000035d0: 743a 0a20 2020 2020 2020 2069 6620 6e6f  t:.        if no
-000035e0: 7420 7574 696c 732e 6973 5f64 6963 745f  t utils.is_dict_
-000035f0: 6c69 6b65 286b 6579 293a 0a20 2020 2020  like(key):.     
-00003600: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00003610: 6545 7272 6f72 2822 6361 6e20 6f6e 6c79  eError("can only
-00003620: 206c 6f6f 6b75 7020 6469 6374 696f 6e61   lookup dictiona
-00003630: 7269 6573 2066 726f 6d20 4461 7461 7365  ries from Datase
-00003640: 742e 6c6f 6322 290a 2020 2020 2020 2020  t.loc").        
-00003650: 7265 7475 726e 2073 656c 662e 6461 7461  return self.data
-00003660: 7365 742e 7365 6c28 6b65 7929 0a0a 2020  set.sel(key)..  
-00003670: 2020 6465 6620 5f5f 7365 7469 7465 6d5f    def __setitem_
-00003680: 5f28 7365 6c66 2c20 6b65 792c 2076 616c  _(self, key, val
-00003690: 7565 2920 2d3e 204e 6f6e 653a 0a20 2020  ue) -> None:.   
-000036a0: 2020 2020 2069 6620 6e6f 7420 7574 696c       if not util
-000036b0: 732e 6973 5f64 6963 745f 6c69 6b65 286b  s.is_dict_like(k
-000036c0: 6579 293a 0a20 2020 2020 2020 2020 2020  ey):.           
-000036d0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-000036e0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000036f0: 2020 2263 616e 206f 6e6c 7920 7365 7420    "can only set 
-00003700: 6c6f 6361 7469 6f6e 7320 6465 6669 6e65  locations define
-00003710: 6420 6279 2064 6963 7469 6f6e 6172 6965  d by dictionarie
-00003720: 7320 6672 6f6d 2044 6174 6173 6574 2e6c  s from Dataset.l
-00003730: 6f63 2e22 0a20 2020 2020 2020 2020 2020  oc.".           
-00003740: 2020 2020 2066 2220 476f 743a 207b 6b65       f" Got: {ke
-00003750: 797d 220a 2020 2020 2020 2020 2020 2020  y}".            
-00003760: 290a 0a20 2020 2020 2020 2023 2073 6574  )..        # set
-00003770: 206e 6577 2076 616c 7565 730a 2020 2020   new values.    
-00003780: 2020 2020 6469 6d5f 696e 6465 7865 7273      dim_indexers
-00003790: 203d 206d 6170 5f69 6e64 6578 5f71 7565   = map_index_que
-000037a0: 7269 6573 2873 656c 662e 6461 7461 7365  ries(self.datase
-000037b0: 742c 206b 6579 292e 6469 6d5f 696e 6465  t, key).dim_inde
-000037c0: 7865 7273 0a20 2020 2020 2020 2073 656c  xers.        sel
-000037d0: 662e 6461 7461 7365 745b 6469 6d5f 696e  f.dataset[dim_in
-000037e0: 6465 7865 7273 5d20 3d20 7661 6c75 650a  dexers] = value.
-000037f0: 0a0a 636c 6173 7320 4461 7461 7365 7428  ..class Dataset(
-00003800: 0a20 2020 2044 6174 6157 6974 6843 6f6f  .    DataWithCoo
-00003810: 7264 732c 0a20 2020 2044 6174 6173 6574  rds,.    Dataset
-00003820: 4167 6772 6567 6174 696f 6e73 2c0a 2020  Aggregations,.  
-00003830: 2020 4461 7461 7365 7441 7269 7468 6d65    DatasetArithme
-00003840: 7469 632c 0a20 2020 204d 6170 7069 6e67  tic,.    Mapping
-00003850: 5b48 6173 6861 626c 652c 2022 4461 7461  [Hashable, "Data
-00003860: 4172 7261 7922 5d2c 0a29 3a0a 2020 2020  Array"],.):.    
-00003870: 2222 2241 206d 756c 7469 2d64 696d 656e  """A multi-dimen
-00003880: 7369 6f6e 616c 2c20 696e 206d 656d 6f72  sional, in memor
-00003890: 792c 2061 7272 6179 2064 6174 6162 6173  y, array databas
-000038a0: 652e 0a0a 2020 2020 4120 6461 7461 7365  e...    A datase
-000038b0: 7420 7265 7365 6d62 6c65 7320 616e 2069  t resembles an i
-000038c0: 6e2d 6d65 6d6f 7279 2072 6570 7265 7365  n-memory represe
-000038d0: 6e74 6174 696f 6e20 6f66 2061 204e 6574  ntation of a Net
-000038e0: 4344 4620 6669 6c65 2c0a 2020 2020 616e  CDF file,.    an
-000038f0: 6420 636f 6e73 6973 7473 206f 6620 7661  d consists of va
-00003900: 7269 6162 6c65 732c 2063 6f6f 7264 696e  riables, coordin
-00003910: 6174 6573 2061 6e64 2061 7474 7269 6275  ates and attribu
-00003920: 7465 7320 7768 6963 680a 2020 2020 746f  tes which.    to
-00003930: 6765 7468 6572 2066 6f72 6d20 6120 7365  gether form a se
-00003940: 6c66 2064 6573 6372 6962 696e 6720 6461  lf describing da
-00003950: 7461 7365 742e 0a0a 2020 2020 4461 7461  taset...    Data
-00003960: 7365 7420 696d 706c 656d 656e 7473 2074  set implements t
-00003970: 6865 206d 6170 7069 6e67 2069 6e74 6572  he mapping inter
-00003980: 6661 6365 2077 6974 6820 6b65 7973 2067  face with keys g
-00003990: 6976 656e 2062 7920 7661 7269 6162 6c65  iven by variable
-000039a0: 0a20 2020 206e 616d 6573 2061 6e64 2076  .    names and v
-000039b0: 616c 7565 7320 6769 7665 6e20 6279 2044  alues given by D
-000039c0: 6174 6141 7272 6179 206f 626a 6563 7473  ataArray objects
-000039d0: 2066 6f72 2065 6163 6820 7661 7269 6162   for each variab
-000039e0: 6c65 206e 616d 652e 0a0a 2020 2020 4f6e  le name...    On
-000039f0: 6520 6469 6d65 6e73 696f 6e61 6c20 7661  e dimensional va
-00003a00: 7269 6162 6c65 7320 7769 7468 206e 616d  riables with nam
-00003a10: 6520 6571 7561 6c20 746f 2074 6865 6972  e equal to their
-00003a20: 2064 696d 656e 7369 6f6e 2061 7265 0a20   dimension are. 
-00003a30: 2020 2069 6e64 6578 2063 6f6f 7264 696e     index coordin
-00003a40: 6174 6573 2075 7365 6420 666f 7220 6c61  ates used for la
-00003a50: 6265 6c20 6261 7365 6420 696e 6465 7869  bel based indexi
-00003a60: 6e67 2e0a 0a20 2020 2054 6f20 6c6f 6164  ng...    To load
-00003a70: 2064 6174 6120 6672 6f6d 2061 2066 696c   data from a fil
-00003a80: 6520 6f72 2066 696c 652d 6c69 6b65 206f  e or file-like o
-00003a90: 626a 6563 742c 2075 7365 2074 6865 2060  bject, use the `
-00003aa0: 6f70 656e 5f64 6174 6173 6574 600a 2020  open_dataset`.  
-00003ab0: 2020 6675 6e63 7469 6f6e 2e0a 0a20 2020    function...   
-00003ac0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00003ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2064  ----------.    d
-00003ae0: 6174 615f 7661 7273 203a 2064 6963 742d  ata_vars : dict-
-00003af0: 6c69 6b65 2c20 6f70 7469 6f6e 616c 0a20  like, optional. 
-00003b00: 2020 2020 2020 2041 206d 6170 7069 6e67         A mapping
-00003b10: 2066 726f 6d20 7661 7269 6162 6c65 206e   from variable n
-00003b20: 616d 6573 2074 6f20 3a70 793a 636c 6173  ames to :py:clas
-00003b30: 733a 607e 7861 7272 6179 2e44 6174 6141  s:`~xarray.DataA
-00003b40: 7272 6179 600a 2020 2020 2020 2020 6f62  rray`.        ob
-00003b50: 6a65 6374 732c 203a 7079 3a63 6c61 7373  jects, :py:class
-00003b60: 3a60 7e78 6172 7261 792e 5661 7269 6162  :`~xarray.Variab
-00003b70: 6c65 6020 6f62 6a65 6374 7320 6f72 2074  le` objects or t
-00003b80: 6f20 7475 706c 6573 206f 660a 2020 2020  o tuples of.    
-00003b90: 2020 2020 7468 6520 666f 726d 2060 6028      the form ``(
-00003ba0: 6469 6d73 2c20 6461 7461 5b2c 2061 7474  dims, data[, att
-00003bb0: 7273 5d29 6060 2077 6869 6368 2063 616e  rs])`` which can
-00003bc0: 2062 6520 7573 6564 2061 730a 2020 2020   be used as.    
-00003bd0: 2020 2020 6172 6775 6d65 6e74 7320 746f      arguments to
-00003be0: 2063 7265 6174 6520 6120 6e65 7720 6060   create a new ``
-00003bf0: 5661 7269 6162 6c65 6060 2e20 4561 6368  Variable``. Each
-00003c00: 2064 696d 656e 7369 6f6e 206d 7573 740a   dimension must.
-00003c10: 2020 2020 2020 2020 6861 7665 2074 6865          have the
-00003c20: 2073 616d 6520 6c65 6e67 7468 2069 6e20   same length in 
-00003c30: 616c 6c20 7661 7269 6162 6c65 7320 696e  all variables in
-00003c40: 2077 6869 6368 2069 7420 6170 7065 6172   which it appear
-00003c50: 732e 0a0a 2020 2020 2020 2020 5468 6520  s...        The 
-00003c60: 666f 6c6c 6f77 696e 6720 6e6f 7461 7469  following notati
-00003c70: 6f6e 7320 6172 6520 6163 6365 7074 6564  ons are accepted
-00003c80: 3a0a 0a20 2020 2020 2020 202d 206d 6170  :..        - map
-00003c90: 7069 6e67 207b 7661 7220 6e61 6d65 3a20  ping {var name: 
-00003ca0: 4461 7461 4172 7261 797d 0a20 2020 2020  DataArray}.     
-00003cb0: 2020 202d 206d 6170 7069 6e67 207b 7661     - mapping {va
-00003cc0: 7220 6e61 6d65 3a20 5661 7269 6162 6c65  r name: Variable
-00003cd0: 7d0a 2020 2020 2020 2020 2d20 6d61 7070  }.        - mapp
-00003ce0: 696e 6720 7b76 6172 206e 616d 653a 2028  ing {var name: (
-00003cf0: 6469 6d65 6e73 696f 6e20 6e61 6d65 2c20  dimension name, 
-00003d00: 6172 7261 792d 6c69 6b65 297d 0a20 2020  array-like)}.   
-00003d10: 2020 2020 202d 206d 6170 7069 6e67 207b       - mapping {
-00003d20: 7661 7220 6e61 6d65 3a20 2874 7570 6c65  var name: (tuple
-00003d30: 206f 6620 6469 6d65 6e73 696f 6e20 6e61   of dimension na
-00003d40: 6d65 732c 2061 7272 6179 2d6c 696b 6529  mes, array-like)
-00003d50: 7d0a 2020 2020 2020 2020 2d20 6d61 7070  }.        - mapp
-00003d60: 696e 6720 7b64 696d 656e 7369 6f6e 206e  ing {dimension n
-00003d70: 616d 653a 2061 7272 6179 2d6c 696b 657d  ame: array-like}
-00003d80: 0a20 2020 2020 2020 2020 2028 6974 2077  .          (it w
-00003d90: 696c 6c20 6265 2061 7574 6f6d 6174 6963  ill be automatic
-00003da0: 616c 6c79 206d 6f76 6564 2074 6f20 636f  ally moved to co
-00003db0: 6f72 6473 2c20 7365 6520 6265 6c6f 7729  ords, see below)
-00003dc0: 0a0a 2020 2020 2020 2020 4561 6368 2064  ..        Each d
-00003dd0: 696d 656e 7369 6f6e 206d 7573 7420 6861  imension must ha
-00003de0: 7665 2074 6865 2073 616d 6520 6c65 6e67  ve the same leng
-00003df0: 7468 2069 6e20 616c 6c20 7661 7269 6162  th in all variab
-00003e00: 6c65 7320 696e 0a20 2020 2020 2020 2077  les in.        w
-00003e10: 6869 6368 2069 7420 6170 7065 6172 732e  hich it appears.
-00003e20: 0a20 2020 2063 6f6f 7264 7320 3a20 6469  .    coords : di
-00003e30: 6374 2d6c 696b 652c 206f 7074 696f 6e61  ct-like, optiona
-00003e40: 6c0a 2020 2020 2020 2020 416e 6f74 6865  l.        Anothe
-00003e50: 7220 6d61 7070 696e 6720 696e 2073 696d  r mapping in sim
-00003e60: 696c 6172 2066 6f72 6d20 6173 2074 6865  ilar form as the
-00003e70: 2060 6461 7461 5f76 6172 7360 2061 7267   `data_vars` arg
-00003e80: 756d 656e 742c 0a20 2020 2020 2020 2065  ument,.        e
-00003e90: 7863 6570 7420 7468 6520 6561 6368 2069  xcept the each i
-00003ea0: 7465 6d20 6973 2073 6176 6564 206f 6e20  tem is saved on 
-00003eb0: 7468 6520 6461 7461 7365 7420 6173 2061  the dataset as a
-00003ec0: 2022 636f 6f72 6469 6e61 7465 222e 0a20   "coordinate".. 
-00003ed0: 2020 2020 2020 2054 6865 7365 2076 6172         These var
-00003ee0: 6961 626c 6573 2068 6176 6520 616e 2061  iables have an a
-00003ef0: 7373 6f63 6961 7465 6420 6d65 616e 696e  ssociated meanin
-00003f00: 673a 2074 6865 7920 6465 7363 7269 6265  g: they describe
-00003f10: 0a20 2020 2020 2020 2063 6f6e 7374 616e  .        constan
-00003f20: 742f 6669 7865 642f 696e 6465 7065 6e64  t/fixed/independ
-00003f30: 656e 7420 7175 616e 7469 7469 6573 2c20  ent quantities, 
-00003f40: 756e 6c69 6b65 2074 6865 0a20 2020 2020  unlike the.     
-00003f50: 2020 2076 6172 7969 6e67 2f6d 6561 7375     varying/measu
-00003f60: 7265 642f 6465 7065 6e64 656e 7420 7175  red/dependent qu
-00003f70: 616e 7469 7469 6573 2074 6861 7420 6265  antities that be
-00003f80: 6c6f 6e67 2069 6e0a 2020 2020 2020 2020  long in.        
-00003f90: 6076 6172 6961 626c 6573 602e 2043 6f6f  `variables`. Coo
-00003fa0: 7264 696e 6174 6573 2076 616c 7565 7320  rdinates values 
-00003fb0: 6d61 7920 6265 2067 6976 656e 2062 7920  may be given by 
-00003fc0: 312d 6469 6d65 6e73 696f 6e61 6c0a 2020  1-dimensional.  
-00003fd0: 2020 2020 2020 6172 7261 7973 206f 7220        arrays or 
-00003fe0: 7363 616c 6172 732c 2069 6e20 7768 6963  scalars, in whic
-00003ff0: 6820 6361 7365 2060 6469 6d73 6020 646f  h case `dims` do
-00004000: 206e 6f74 206e 6565 6420 746f 2062 650a   not need to be.
-00004010: 2020 2020 2020 2020 7375 7070 6c69 6564          supplied
-00004020: 3a20 3144 2061 7272 6179 7320 7769 6c6c  : 1D arrays will
-00004030: 2062 6520 6173 7375 6d65 6420 746f 2067   be assumed to g
-00004040: 6976 6520 696e 6465 7820 7661 6c75 6573  ive index values
-00004050: 2061 6c6f 6e67 0a20 2020 2020 2020 2074   along.        t
-00004060: 6865 2064 696d 656e 7369 6f6e 2077 6974  he dimension wit
-00004070: 6820 7468 6520 7361 6d65 206e 616d 652e  h the same name.
-00004080: 0a0a 2020 2020 2020 2020 5468 6520 666f  ..        The fo
-00004090: 6c6c 6f77 696e 6720 6e6f 7461 7469 6f6e  llowing notation
-000040a0: 7320 6172 6520 6163 6365 7074 6564 3a0a  s are accepted:.
-000040b0: 0a20 2020 2020 2020 202d 206d 6170 7069  .        - mappi
-000040c0: 6e67 207b 636f 6f72 6420 6e61 6d65 3a20  ng {coord name: 
-000040d0: 4461 7461 4172 7261 797d 0a20 2020 2020  DataArray}.     
-000040e0: 2020 202d 206d 6170 7069 6e67 207b 636f     - mapping {co
-000040f0: 6f72 6420 6e61 6d65 3a20 5661 7269 6162  ord name: Variab
-00004100: 6c65 7d0a 2020 2020 2020 2020 2d20 6d61  le}.        - ma
-00004110: 7070 696e 6720 7b63 6f6f 7264 206e 616d  pping {coord nam
-00004120: 653a 2028 6469 6d65 6e73 696f 6e20 6e61  e: (dimension na
-00004130: 6d65 2c20 6172 7261 792d 6c69 6b65 297d  me, array-like)}
-00004140: 0a20 2020 2020 2020 202d 206d 6170 7069  .        - mappi
-00004150: 6e67 207b 636f 6f72 6420 6e61 6d65 3a20  ng {coord name: 
-00004160: 2874 7570 6c65 206f 6620 6469 6d65 6e73  (tuple of dimens
-00004170: 696f 6e20 6e61 6d65 732c 2061 7272 6179  ion names, array
-00004180: 2d6c 696b 6529 7d0a 2020 2020 2020 2020  -like)}.        
-00004190: 2d20 6d61 7070 696e 6720 7b64 696d 656e  - mapping {dimen
-000041a0: 7369 6f6e 206e 616d 653a 2061 7272 6179  sion name: array
-000041b0: 2d6c 696b 657d 0a20 2020 2020 2020 2020  -like}.         
-000041c0: 2028 7468 6520 6469 6d65 6e73 696f 6e20   (the dimension 
-000041d0: 6e61 6d65 2069 7320 696d 706c 6963 6974  name is implicit
-000041e0: 6c79 2073 6574 2074 6f20 6265 2074 6865  ly set to be the
-000041f0: 2073 616d 6520 6173 2074 6865 0a20 2020   same as the.   
-00004200: 2020 2020 2020 2063 6f6f 7264 206e 616d         coord nam
-00004210: 6529 0a0a 2020 2020 2020 2020 5468 6520  e)..        The 
-00004220: 6c61 7374 206e 6f74 6174 696f 6e20 696d  last notation im
-00004230: 706c 6965 7320 7468 6174 2074 6865 2063  plies that the c
-00004240: 6f6f 7264 206e 616d 6520 6973 2074 6865  oord name is the
-00004250: 2073 616d 6520 6173 0a20 2020 2020 2020   same as.       
-00004260: 2074 6865 2064 696d 656e 7369 6f6e 206e   the dimension n
-00004270: 616d 652e 0a0a 2020 2020 6174 7472 7320  ame...    attrs 
-00004280: 3a20 6469 6374 2d6c 696b 652c 206f 7074  : dict-like, opt
-00004290: 696f 6e61 6c0a 2020 2020 2020 2020 476c  ional.        Gl
-000042a0: 6f62 616c 2061 7474 7269 6275 7465 7320  obal attributes 
-000042b0: 746f 2073 6176 6520 6f6e 2074 6869 7320  to save on this 
-000042c0: 6461 7461 7365 742e 0a0a 2020 2020 4578  dataset...    Ex
-000042d0: 616d 706c 6573 0a20 2020 202d 2d2d 2d2d  amples.    -----
-000042e0: 2d2d 2d0a 2020 2020 4372 6561 7465 2064  ---.    Create d
-000042f0: 6174 613a 0a0a 2020 2020 3e3e 3e20 6e70  ata:..    >>> np
-00004300: 2e72 616e 646f 6d2e 7365 6564 2830 290a  .random.seed(0).
-00004310: 2020 2020 3e3e 3e20 7465 6d70 6572 6174      >>> temperat
-00004320: 7572 6520 3d20 3135 202b 2038 202a 206e  ure = 15 + 8 * n
-00004330: 702e 7261 6e64 6f6d 2e72 616e 646e 2832  p.random.randn(2
-00004340: 2c20 322c 2033 290a 2020 2020 3e3e 3e20  , 2, 3).    >>> 
-00004350: 7072 6563 6970 6974 6174 696f 6e20 3d20  precipitation = 
-00004360: 3130 202a 206e 702e 7261 6e64 6f6d 2e72  10 * np.random.r
-00004370: 616e 6428 322c 2032 2c20 3329 0a20 2020  and(2, 2, 3).   
-00004380: 203e 3e3e 206c 6f6e 203d 205b 5b2d 3939   >>> lon = [[-99
-00004390: 2e38 332c 202d 3939 2e33 325d 2c20 5b2d  .83, -99.32], [-
-000043a0: 3939 2e37 392c 202d 3939 2e32 335d 5d0a  99.79, -99.23]].
-000043b0: 2020 2020 3e3e 3e20 6c61 7420 3d20 5b5b      >>> lat = [[
-000043c0: 3432 2e32 352c 2034 322e 3231 5d2c 205b  42.25, 42.21], [
-000043d0: 3432 2e36 332c 2034 322e 3539 5d5d 0a20  42.63, 42.59]]. 
-000043e0: 2020 203e 3e3e 2074 696d 6520 3d20 7064     >>> time = pd
-000043f0: 2e64 6174 655f 7261 6e67 6528 2232 3031  .date_range("201
-00004400: 342d 3039 2d30 3622 2c20 7065 7269 6f64  4-09-06", period
-00004410: 733d 3329 0a20 2020 203e 3e3e 2072 6566  s=3).    >>> ref
-00004420: 6572 656e 6365 5f74 696d 6520 3d20 7064  erence_time = pd
-00004430: 2e54 696d 6573 7461 6d70 2822 3230 3134  .Timestamp("2014
-00004440: 2d30 392d 3035 2229 0a0a 2020 2020 496e  -09-05")..    In
-00004450: 6974 6961 6c69 7a65 2061 2064 6174 6173  itialize a datas
-00004460: 6574 2077 6974 6820 6d75 6c74 6970 6c65  et with multiple
-00004470: 2064 696d 656e 7369 6f6e 733a 0a0a 2020   dimensions:..  
-00004480: 2020 3e3e 3e20 6473 203d 2078 722e 4461    >>> ds = xr.Da
-00004490: 7461 7365 7428 0a20 2020 202e 2e2e 2020  taset(.    ...  
-000044a0: 2020 2064 6174 615f 7661 7273 3d64 6963     data_vars=dic
-000044b0: 7428 0a20 2020 202e 2e2e 2020 2020 2020  t(.    ...      
-000044c0: 2020 2074 656d 7065 7261 7475 7265 3d28     temperature=(
-000044d0: 5b22 7822 2c20 2279 222c 2022 7469 6d65  ["x", "y", "time
-000044e0: 225d 2c20 7465 6d70 6572 6174 7572 6529  "], temperature)
-000044f0: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
-00004500: 2020 7072 6563 6970 6974 6174 696f 6e3d    precipitation=
-00004510: 285b 2278 222c 2022 7922 2c20 2274 696d  (["x", "y", "tim
-00004520: 6522 5d2c 2070 7265 6369 7069 7461 7469  e"], precipitati
-00004530: 6f6e 292c 0a20 2020 202e 2e2e 2020 2020  on),.    ...    
-00004540: 2029 2c0a 2020 2020 2e2e 2e20 2020 2020   ),.    ...     
-00004550: 636f 6f72 6473 3d64 6963 7428 0a20 2020  coords=dict(.   
-00004560: 202e 2e2e 2020 2020 2020 2020 206c 6f6e   ...         lon
-00004570: 3d28 5b22 7822 2c20 2279 225d 2c20 6c6f  =(["x", "y"], lo
-00004580: 6e29 2c0a 2020 2020 2e2e 2e20 2020 2020  n),.    ...     
-00004590: 2020 2020 6c61 743d 285b 2278 222c 2022      lat=(["x", "
-000045a0: 7922 5d2c 206c 6174 292c 0a20 2020 202e  y"], lat),.    .
-000045b0: 2e2e 2020 2020 2020 2020 2074 696d 653d  ..         time=
-000045c0: 7469 6d65 2c0a 2020 2020 2e2e 2e20 2020  time,.    ...   
-000045d0: 2020 2020 2020 7265 6665 7265 6e63 655f        reference_
-000045e0: 7469 6d65 3d72 6566 6572 656e 6365 5f74  time=reference_t
-000045f0: 696d 652c 0a20 2020 202e 2e2e 2020 2020  ime,.    ...    
-00004600: 2029 2c0a 2020 2020 2e2e 2e20 2020 2020   ),.    ...     
-00004610: 6174 7472 733d 6469 6374 2864 6573 6372  attrs=dict(descr
-00004620: 6970 7469 6f6e 3d22 5765 6174 6865 7220  iption="Weather 
-00004630: 7265 6c61 7465 6420 6461 7461 2e22 292c  related data."),
-00004640: 0a20 2020 202e 2e2e 2029 0a20 2020 203e  .    ... ).    >
-00004650: 3e3e 2064 730a 2020 2020 3c78 6172 7261  >> ds.    <xarra
-00004660: 792e 4461 7461 7365 743e 0a20 2020 2044  y.Dataset>.    D
-00004670: 696d 656e 7369 6f6e 733a 2020 2020 2020  imensions:      
-00004680: 2020 2028 783a 2032 2c20 793a 2032 2c20     (x: 2, y: 2, 
-00004690: 7469 6d65 3a20 3329 0a20 2020 2043 6f6f  time: 3).    Coo
-000046a0: 7264 696e 6174 6573 3a0a 2020 2020 2020  rdinates:.      
-000046b0: 2020 6c6f 6e20 2020 2020 2020 2020 2020    lon           
-000046c0: 2020 2878 2c20 7929 2066 6c6f 6174 3634    (x, y) float64
-000046d0: 202d 3939 2e38 3320 2d39 392e 3332 202d   -99.83 -99.32 -
-000046e0: 3939 2e37 3920 2d39 392e 3233 0a20 2020  99.79 -99.23.   
-000046f0: 2020 2020 206c 6174 2020 2020 2020 2020       lat        
-00004700: 2020 2020 2028 782c 2079 2920 666c 6f61       (x, y) floa
-00004710: 7436 3420 3432 2e32 3520 3432 2e32 3120  t64 42.25 42.21 
-00004720: 3432 2e36 3320 3432 2e35 390a 2020 2020  42.63 42.59.    
-00004730: 2020 2a20 7469 6d65 2020 2020 2020 2020    * time        
-00004740: 2020 2020 2874 696d 6529 2064 6174 6574      (time) datet
-00004750: 696d 6536 345b 6e73 5d20 3230 3134 2d30  ime64[ns] 2014-0
-00004760: 392d 3036 2032 3031 342d 3039 2d30 3720  9-06 2014-09-07 
-00004770: 3230 3134 2d30 392d 3038 0a20 2020 2020  2014-09-08.     
-00004780: 2020 2072 6566 6572 656e 6365 5f74 696d     reference_tim
-00004790: 6520 2064 6174 6574 696d 6536 345b 6e73  e  datetime64[ns
-000047a0: 5d20 3230 3134 2d30 392d 3035 0a20 2020  ] 2014-09-05.   
-000047b0: 2044 696d 656e 7369 6f6e 7320 7769 7468   Dimensions with
-000047c0: 6f75 7420 636f 6f72 6469 6e61 7465 733a  out coordinates:
-000047d0: 2078 2c20 790a 2020 2020 4461 7461 2076   x, y.    Data v
-000047e0: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
-000047f0: 2020 7465 6d70 6572 6174 7572 6520 2020    temperature   
-00004800: 2020 2878 2c20 792c 2074 696d 6529 2066    (x, y, time) f
-00004810: 6c6f 6174 3634 2032 392e 3131 2031 382e  loat64 29.11 18.
-00004820: 3220 3232 2e38 3320 2e2e 2e20 3138 2e32  2 22.83 ... 18.2
-00004830: 3820 3136 2e31 3520 3236 2e36 330a 2020  8 16.15 26.63.  
-00004840: 2020 2020 2020 7072 6563 6970 6974 6174        precipitat
-00004850: 696f 6e20 2020 2878 2c20 792c 2074 696d  ion   (x, y, tim
-00004860: 6529 2066 6c6f 6174 3634 2035 2e36 3820  e) float64 5.68 
-00004870: 392e 3235 3620 302e 3731 3034 202e 2e2e  9.256 0.7104 ...
-00004880: 2037 2e39 3932 2034 2e36 3135 2037 2e38   7.992 4.615 7.8
-00004890: 3035 0a20 2020 2041 7474 7269 6275 7465  05.    Attribute
-000048a0: 733a 0a20 2020 2020 2020 2064 6573 6372  s:.        descr
-000048b0: 6970 7469 6f6e 3a20 2057 6561 7468 6572  iption:  Weather
-000048c0: 2072 656c 6174 6564 2064 6174 612e 0a0a   related data...
-000048d0: 2020 2020 4669 6e64 206f 7574 2077 6865      Find out whe
-000048e0: 7265 2074 6865 2063 6f6c 6465 7374 2074  re the coldest t
-000048f0: 656d 7065 7261 7475 7265 2077 6173 2061  emperature was a
-00004900: 6e64 2077 6861 7420 7661 6c75 6573 2074  nd what values t
-00004910: 6865 0a20 2020 206f 7468 6572 2076 6172  he.    other var
-00004920: 6961 626c 6573 2068 6164 3a0a 0a20 2020  iables had:..   
-00004930: 203e 3e3e 2064 732e 6973 656c 2864 732e   >>> ds.isel(ds.
-00004940: 7465 6d70 6572 6174 7572 652e 6172 676d  temperature.argm
-00004950: 696e 282e 2e2e 2929 0a20 2020 203c 7861  in(...)).    <xa
-00004960: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
-00004970: 2020 4469 6d65 6e73 696f 6e73 3a20 2020    Dimensions:   
-00004980: 2020 2020 2020 2829 0a20 2020 2043 6f6f        ().    Coo
-00004990: 7264 696e 6174 6573 3a0a 2020 2020 2020  rdinates:.      
-000049a0: 2020 6c6f 6e20 2020 2020 2020 2020 2020    lon           
-000049b0: 2020 666c 6f61 7436 3420 2d39 392e 3332    float64 -99.32
-000049c0: 0a20 2020 2020 2020 206c 6174 2020 2020  .        lat    
-000049d0: 2020 2020 2020 2020 2066 6c6f 6174 3634           float64
-000049e0: 2034 322e 3231 0a20 2020 2020 2020 2074   42.21.        t
-000049f0: 696d 6520 2020 2020 2020 2020 2020 2064  ime            d
-00004a00: 6174 6574 696d 6536 345b 6e73 5d20 3230  atetime64[ns] 20
-00004a10: 3134 2d30 392d 3038 0a20 2020 2020 2020  14-09-08.       
-00004a20: 2072 6566 6572 656e 6365 5f74 696d 6520   reference_time 
-00004a30: 2064 6174 6574 696d 6536 345b 6e73 5d20   datetime64[ns] 
-00004a40: 3230 3134 2d30 392d 3035 0a20 2020 2044  2014-09-05.    D
-00004a50: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
-00004a60: 2020 2020 2020 2074 656d 7065 7261 7475         temperatu
-00004a70: 7265 2020 2020 2066 6c6f 6174 3634 2037  re     float64 7
-00004a80: 2e31 3832 0a20 2020 2020 2020 2070 7265  .182.        pre
-00004a90: 6369 7069 7461 7469 6f6e 2020 2066 6c6f  cipitation   flo
-00004aa0: 6174 3634 2038 2e33 3236 0a20 2020 2041  at64 8.326.    A
-00004ab0: 7474 7269 6275 7465 733a 0a20 2020 2020  ttributes:.     
-00004ac0: 2020 2064 6573 6372 6970 7469 6f6e 3a20     description: 
-00004ad0: 2057 6561 7468 6572 2072 656c 6174 6564   Weather related
-00004ae0: 2064 6174 612e 0a20 2020 2022 2222 0a0a   data..    """..
-00004af0: 2020 2020 5f61 7474 7273 3a20 6469 6374      _attrs: dict
-00004b00: 5b48 6173 6861 626c 652c 2041 6e79 5d20  [Hashable, Any] 
-00004b10: 7c20 4e6f 6e65 0a20 2020 205f 6361 6368  | None.    _cach
-00004b20: 653a 2064 6963 745b 7374 722c 2041 6e79  e: dict[str, Any
-00004b30: 5d0a 2020 2020 5f63 6f6f 7264 5f6e 616d  ].    _coord_nam
-00004b40: 6573 3a20 7365 745b 4861 7368 6162 6c65  es: set[Hashable
-00004b50: 5d0a 2020 2020 5f64 696d 733a 2064 6963  ].    _dims: dic
-00004b60: 745b 4861 7368 6162 6c65 2c20 696e 745d  t[Hashable, int]
-00004b70: 0a20 2020 205f 656e 636f 6469 6e67 3a20  .    _encoding: 
-00004b80: 6469 6374 5b48 6173 6861 626c 652c 2041  dict[Hashable, A
-00004b90: 6e79 5d20 7c20 4e6f 6e65 0a20 2020 205f  ny] | None.    _
-00004ba0: 636c 6f73 653a 2043 616c 6c61 626c 655b  close: Callable[
-00004bb0: 5b5d 2c20 4e6f 6e65 5d20 7c20 4e6f 6e65  [], None] | None
-00004bc0: 0a20 2020 205f 696e 6465 7865 733a 2064  .    _indexes: d
-00004bd0: 6963 745b 4861 7368 6162 6c65 2c20 496e  ict[Hashable, In
-00004be0: 6465 785d 0a20 2020 205f 7661 7269 6162  dex].    _variab
-00004bf0: 6c65 733a 2064 6963 745b 4861 7368 6162  les: dict[Hashab
-00004c00: 6c65 2c20 5661 7269 6162 6c65 5d0a 0a20  le, Variable].. 
-00004c10: 2020 205f 5f73 6c6f 7473 5f5f 203d 2028     __slots__ = (
-00004c20: 0a20 2020 2020 2020 2022 5f61 7474 7273  .        "_attrs
-00004c30: 222c 0a20 2020 2020 2020 2022 5f63 6163  ",.        "_cac
-00004c40: 6865 222c 0a20 2020 2020 2020 2022 5f63  he",.        "_c
-00004c50: 6f6f 7264 5f6e 616d 6573 222c 0a20 2020  oord_names",.   
-00004c60: 2020 2020 2022 5f64 696d 7322 2c0a 2020       "_dims",.  
-00004c70: 2020 2020 2020 225f 656e 636f 6469 6e67        "_encoding
-00004c80: 222c 0a20 2020 2020 2020 2022 5f63 6c6f  ",.        "_clo
-00004c90: 7365 222c 0a20 2020 2020 2020 2022 5f69  se",.        "_i
-00004ca0: 6e64 6578 6573 222c 0a20 2020 2020 2020  ndexes",.       
-00004cb0: 2022 5f76 6172 6961 626c 6573 222c 0a20   "_variables",. 
-00004cc0: 2020 2020 2020 2022 5f5f 7765 616b 7265         "__weakre
-00004cd0: 665f 5f22 2c0a 2020 2020 290a 0a20 2020  f__",.    )..   
-00004ce0: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
-00004cf0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-00004d00: 2020 2020 2023 2063 6f75 6c64 206d 616b       # could mak
-00004d10: 6520 6120 5661 7269 6162 6c65 4172 6773  e a VariableArgs
-00004d20: 2074 6f20 7573 6520 6d6f 7265 2067 656e   to use more gen
-00004d30: 6572 616c 6c79 2c20 616e 6420 7265 6669  erally, and refi
-00004d40: 6e65 2074 6865 7365 0a20 2020 2020 2020  ne these.       
-00004d50: 2023 2063 6174 6567 6f72 6965 730a 2020   # categories.  
-00004d60: 2020 2020 2020 6461 7461 5f76 6172 733a        data_vars:
-00004d70: 204d 6170 7069 6e67 5b41 6e79 2c20 416e   Mapping[Any, An
-00004d80: 795d 207c 204e 6f6e 6520 3d20 4e6f 6e65  y] | None = None
-00004d90: 2c0a 2020 2020 2020 2020 636f 6f72 6473  ,.        coords
-00004da0: 3a20 4d61 7070 696e 675b 416e 792c 2041  : Mapping[Any, A
-00004db0: 6e79 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ny] | None = Non
-00004dc0: 652c 0a20 2020 2020 2020 2061 7474 7273  e,.        attrs
-00004dd0: 3a20 4d61 7070 696e 675b 416e 792c 2041  : Mapping[Any, A
-00004de0: 6e79 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ny] | None = Non
-00004df0: 652c 0a20 2020 2029 202d 3e20 4e6f 6e65  e,.    ) -> None
-00004e00: 3a0a 2020 2020 2020 2020 2320 544f 444f  :.        # TODO
-00004e10: 2873 686f 7965 7229 3a20 6578 706f 7365  (shoyer): expose
-00004e20: 2069 6e64 6578 6573 2061 7320 6120 7075   indexes as a pu
-00004e30: 626c 6963 2061 7267 756d 656e 7420 696e  blic argument in
-00004e40: 205f 5f69 6e69 745f 5f0a 0a20 2020 2020   __init__..     
-00004e50: 2020 2069 6620 6461 7461 5f76 6172 7320     if data_vars 
-00004e60: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00004e70: 2020 2020 2064 6174 615f 7661 7273 203d       data_vars =
-00004e80: 207b 7d0a 2020 2020 2020 2020 6966 2063   {}.        if c
-00004e90: 6f6f 7264 7320 6973 204e 6f6e 653a 0a20  oords is None:. 
-00004ea0: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
-00004eb0: 7320 3d20 7b7d 0a0a 2020 2020 2020 2020  s = {}..        
-00004ec0: 626f 7468 5f64 6174 615f 616e 645f 636f  both_data_and_co
-00004ed0: 6f72 6473 203d 2073 6574 2864 6174 615f  ords = set(data_
-00004ee0: 7661 7273 2920 2620 7365 7428 636f 6f72  vars) & set(coor
-00004ef0: 6473 290a 2020 2020 2020 2020 6966 2062  ds).        if b
-00004f00: 6f74 685f 6461 7461 5f61 6e64 5f63 6f6f  oth_data_and_coo
-00004f10: 7264 733a 0a20 2020 2020 2020 2020 2020  rds:.           
-00004f20: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00004f30: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00004f40: 2020 2066 2276 6172 6961 626c 6573 207b     f"variables {
-00004f50: 626f 7468 5f64 6174 615f 616e 645f 636f  both_data_and_co
-00004f60: 6f72 6473 2172 7d20 6172 6520 666f 756e  ords!r} are foun
-00004f70: 6420 696e 2062 6f74 6820 6461 7461 5f76  d in both data_v
-00004f80: 6172 7320 616e 6420 636f 6f72 6473 220a  ars and coords".
-00004f90: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00004fa0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00004fb0: 616e 6365 2863 6f6f 7264 732c 2044 6174  ance(coords, Dat
-00004fc0: 6173 6574 293a 0a20 2020 2020 2020 2020  aset):.         
-00004fd0: 2020 2063 6f6f 7264 7320 3d20 636f 6f72     coords = coor
-00004fe0: 6473 2e76 6172 6961 626c 6573 0a0a 2020  ds.variables..  
-00004ff0: 2020 2020 2020 7661 7269 6162 6c65 732c        variables,
-00005000: 2063 6f6f 7264 5f6e 616d 6573 2c20 6469   coord_names, di
-00005010: 6d73 2c20 696e 6465 7865 732c 205f 203d  ms, indexes, _ =
-00005020: 206d 6572 6765 5f64 6174 615f 616e 645f   merge_data_and_
-00005030: 636f 6f72 6473 280a 2020 2020 2020 2020  coords(.        
-00005040: 2020 2020 6461 7461 5f76 6172 732c 2063      data_vars, c
-00005050: 6f6f 7264 732c 2063 6f6d 7061 743d 2262  oords, compat="b
-00005060: 726f 6164 6361 7374 5f65 7175 616c 7322  roadcast_equals"
-00005070: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00005080: 2020 2020 7365 6c66 2e5f 6174 7472 7320      self._attrs 
-00005090: 3d20 6469 6374 2861 7474 7273 2920 6966  = dict(attrs) if
-000050a0: 2061 7474 7273 2069 7320 6e6f 7420 4e6f   attrs is not No
-000050b0: 6e65 2065 6c73 6520 4e6f 6e65 0a20 2020  ne else None.   
-000050c0: 2020 2020 2073 656c 662e 5f63 6c6f 7365       self._close
-000050d0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-000050e0: 7365 6c66 2e5f 656e 636f 6469 6e67 203d  self._encoding =
-000050f0: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-00005100: 6c66 2e5f 7661 7269 6162 6c65 7320 3d20  lf._variables = 
-00005110: 7661 7269 6162 6c65 730a 2020 2020 2020  variables.      
-00005120: 2020 7365 6c66 2e5f 636f 6f72 645f 6e61    self._coord_na
-00005130: 6d65 7320 3d20 636f 6f72 645f 6e61 6d65  mes = coord_name
-00005140: 730a 2020 2020 2020 2020 7365 6c66 2e5f  s.        self._
-00005150: 6469 6d73 203d 2064 696d 730a 2020 2020  dims = dims.    
-00005160: 2020 2020 7365 6c66 2e5f 696e 6465 7865      self._indexe
-00005170: 7320 3d20 696e 6465 7865 730a 0a20 2020  s = indexes..   
-00005180: 2040 636c 6173 736d 6574 686f 640a 2020   @classmethod.  
-00005190: 2020 6465 6620 6c6f 6164 5f73 746f 7265    def load_store
-000051a0: 2863 6c73 3a20 7479 7065 5b54 5f44 6174  (cls: type[T_Dat
-000051b0: 6173 6574 5d2c 2073 746f 7265 2c20 6465  aset], store, de
-000051c0: 636f 6465 723d 4e6f 6e65 2920 2d3e 2054  coder=None) -> T
-000051d0: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
-000051e0: 2020 2222 2243 7265 6174 6520 6120 6e65    """Create a ne
-000051f0: 7720 6461 7461 7365 7420 6672 6f6d 2074  w dataset from t
-00005200: 6865 2063 6f6e 7465 6e74 7320 6f66 2061  he contents of a
-00005210: 2062 6163 6b65 6e64 732e 2a44 6174 6153   backends.*DataS
-00005220: 746f 7265 0a20 2020 2020 2020 206f 626a  tore.        obj
-00005230: 6563 740a 2020 2020 2020 2020 2222 220a  ect.        """.
-00005240: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-00005250: 732c 2061 7474 7269 6275 7465 7320 3d20  s, attributes = 
-00005260: 7374 6f72 652e 6c6f 6164 2829 0a20 2020  store.load().   
-00005270: 2020 2020 2069 6620 6465 636f 6465 723a       if decoder:
-00005280: 0a20 2020 2020 2020 2020 2020 2076 6172  .            var
-00005290: 6961 626c 6573 2c20 6174 7472 6962 7574  iables, attribut
-000052a0: 6573 203d 2064 6563 6f64 6572 2876 6172  es = decoder(var
-000052b0: 6961 626c 6573 2c20 6174 7472 6962 7574  iables, attribut
-000052c0: 6573 290a 2020 2020 2020 2020 6f62 6a20  es).        obj 
-000052d0: 3d20 636c 7328 7661 7269 6162 6c65 732c  = cls(variables,
-000052e0: 2061 7474 7273 3d61 7474 7269 6275 7465   attrs=attribute
-000052f0: 7329 0a20 2020 2020 2020 206f 626a 2e73  s).        obj.s
-00005300: 6574 5f63 6c6f 7365 2873 746f 7265 2e63  et_close(store.c
-00005310: 6c6f 7365 290a 2020 2020 2020 2020 7265  lose).        re
-00005320: 7475 726e 206f 626a 0a0a 2020 2020 4070  turn obj..    @p
-00005330: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00005340: 7661 7269 6162 6c65 7328 7365 6c66 2920  variables(self) 
-00005350: 2d3e 2046 726f 7a65 6e5b 4861 7368 6162  -> Frozen[Hashab
-00005360: 6c65 2c20 5661 7269 6162 6c65 5d3a 0a20  le, Variable]:. 
-00005370: 2020 2020 2020 2022 2222 4c6f 7720 6c65         """Low le
-00005380: 7665 6c20 696e 7465 7266 6163 6520 746f  vel interface to
-00005390: 2044 6174 6173 6574 2063 6f6e 7465 6e74   Dataset content
-000053a0: 7320 6173 2064 6963 7420 6f66 2056 6172  s as dict of Var
-000053b0: 6961 626c 6520 6f62 6a65 6374 732e 0a0a  iable objects...
-000053c0: 2020 2020 2020 2020 5468 6973 206f 7264          This ord
-000053d0: 6572 6564 2064 6963 7469 6f6e 6172 7920  ered dictionary 
-000053e0: 6973 2066 726f 7a65 6e20 746f 2070 7265  is frozen to pre
-000053f0: 7665 6e74 206d 7574 6174 696f 6e20 7468  vent mutation th
-00005400: 6174 2063 6f75 6c64 0a20 2020 2020 2020  at could.       
-00005410: 2076 696f 6c61 7465 2044 6174 6173 6574   violate Dataset
-00005420: 2069 6e76 6172 6961 6e74 732e 2049 7420   invariants. It 
-00005430: 636f 6e74 6169 6e73 2061 6c6c 2076 6172  contains all var
-00005440: 6961 626c 6520 6f62 6a65 6374 730a 2020  iable objects.  
-00005450: 2020 2020 2020 636f 6e73 7469 7475 7469        constituti
-00005460: 6e67 2074 6865 2044 6174 6173 6574 2c20  ng the Dataset, 
-00005470: 696e 636c 7564 696e 6720 626f 7468 2064  including both d
-00005480: 6174 6120 7661 7269 6162 6c65 7320 616e  ata variables an
-00005490: 640a 2020 2020 2020 2020 636f 6f72 6469  d.        coordi
-000054a0: 6e61 7465 732e 0a20 2020 2020 2020 2022  nates..        "
-000054b0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-000054c0: 6e20 4672 6f7a 656e 2873 656c 662e 5f76  n Frozen(self._v
-000054d0: 6172 6961 626c 6573 290a 0a20 2020 2040  ariables)..    @
-000054e0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-000054f0: 2061 7474 7273 2873 656c 6629 202d 3e20   attrs(self) -> 
-00005500: 6469 6374 5b41 6e79 2c20 416e 795d 3a0a  dict[Any, Any]:.
-00005510: 2020 2020 2020 2020 2222 2244 6963 7469          """Dicti
-00005520: 6f6e 6172 7920 6f66 2067 6c6f 6261 6c20  onary of global 
-00005530: 6174 7472 6962 7574 6573 206f 6e20 7468  attributes on th
-00005540: 6973 2064 6174 6173 6574 2222 220a 2020  is dataset""".  
-00005550: 2020 2020 2020 6966 2073 656c 662e 5f61        if self._a
-00005560: 7474 7273 2069 7320 4e6f 6e65 3a0a 2020  ttrs is None:.  
-00005570: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00005580: 6174 7472 7320 3d20 7b7d 0a20 2020 2020  attrs = {}.     
-00005590: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-000055a0: 6174 7472 730a 0a20 2020 2040 6174 7472  attrs..    @attr
-000055b0: 732e 7365 7474 6572 0a20 2020 2064 6566  s.setter.    def
-000055c0: 2061 7474 7273 2873 656c 662c 2076 616c   attrs(self, val
-000055d0: 7565 3a20 4d61 7070 696e 675b 416e 792c  ue: Mapping[Any,
-000055e0: 2041 6e79 5d29 202d 3e20 4e6f 6e65 3a0a   Any]) -> None:.
-000055f0: 2020 2020 2020 2020 7365 6c66 2e5f 6174          self._at
-00005600: 7472 7320 3d20 6469 6374 2876 616c 7565  trs = dict(value
-00005610: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-00005620: 0a20 2020 2064 6566 2065 6e63 6f64 696e  .    def encodin
-00005630: 6728 7365 6c66 2920 2d3e 2064 6963 745b  g(self) -> dict[
-00005640: 416e 792c 2041 6e79 5d3a 0a20 2020 2020  Any, Any]:.     
-00005650: 2020 2022 2222 4469 6374 696f 6e61 7279     """Dictionary
-00005660: 206f 6620 676c 6f62 616c 2065 6e63 6f64   of global encod
-00005670: 696e 6720 6174 7472 6962 7574 6573 206f  ing attributes o
-00005680: 6e20 7468 6973 2064 6174 6173 6574 2222  n this dataset""
-00005690: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-000056a0: 662e 5f65 6e63 6f64 696e 6720 6973 204e  f._encoding is N
-000056b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000056c0: 2073 656c 662e 5f65 6e63 6f64 696e 6720   self._encoding 
-000056d0: 3d20 7b7d 0a20 2020 2020 2020 2072 6574  = {}.        ret
-000056e0: 7572 6e20 7365 6c66 2e5f 656e 636f 6469  urn self._encodi
-000056f0: 6e67 0a0a 2020 2020 4065 6e63 6f64 696e  ng..    @encodin
-00005700: 672e 7365 7474 6572 0a20 2020 2064 6566  g.setter.    def
-00005710: 2065 6e63 6f64 696e 6728 7365 6c66 2c20   encoding(self, 
-00005720: 7661 6c75 653a 204d 6170 7069 6e67 5b41  value: Mapping[A
-00005730: 6e79 2c20 416e 795d 2920 2d3e 204e 6f6e  ny, Any]) -> Non
-00005740: 653a 0a20 2020 2020 2020 2073 656c 662e  e:.        self.
-00005750: 5f65 6e63 6f64 696e 6720 3d20 6469 6374  _encoding = dict
-00005760: 2876 616c 7565 290a 0a20 2020 2064 6566  (value)..    def
-00005770: 2072 6573 6574 5f65 6e63 6f64 696e 6728   reset_encoding(
-00005780: 7365 6c66 3a20 545f 4461 7461 7365 7429  self: T_Dataset)
-00005790: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
-000057a0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-000057b0: 2061 206e 6577 2044 6174 6173 6574 2077   a new Dataset w
-000057c0: 6974 686f 7574 2065 6e63 6f64 696e 6720  ithout encoding 
-000057d0: 6f6e 2074 6865 2064 6174 6173 6574 206f  on the dataset o
-000057e0: 7220 616e 7920 6f66 2069 7473 0a20 2020  r any of its.   
-000057f0: 2020 2020 2076 6172 6961 626c 6573 2f63       variables/c
-00005800: 6f6f 7264 732e 2222 220a 2020 2020 2020  oords.""".      
-00005810: 2020 7661 7269 6162 6c65 7320 3d20 7b6b    variables = {k
-00005820: 3a20 762e 7265 7365 745f 656e 636f 6469  : v.reset_encodi
-00005830: 6e67 2829 2066 6f72 206b 2c20 7620 696e  ng() for k, v in
-00005840: 2073 656c 662e 7661 7269 6162 6c65 732e   self.variables.
-00005850: 6974 656d 7328 297d 0a20 2020 2020 2020  items()}.       
-00005860: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
-00005870: 706c 6163 6528 7661 7269 6162 6c65 733d  place(variables=
-00005880: 7661 7269 6162 6c65 732c 2065 6e63 6f64  variables, encod
-00005890: 696e 673d 7b7d 290a 0a20 2020 2040 7072  ing={})..    @pr
-000058a0: 6f70 6572 7479 0a20 2020 2064 6566 2064  operty.    def d
-000058b0: 696d 7328 7365 6c66 2920 2d3e 2046 726f  ims(self) -> Fro
-000058c0: 7a65 6e5b 4861 7368 6162 6c65 2c20 696e  zen[Hashable, in
-000058d0: 745d 3a0a 2020 2020 2020 2020 2222 224d  t]:.        """M
-000058e0: 6170 7069 6e67 2066 726f 6d20 6469 6d65  apping from dime
-000058f0: 6e73 696f 6e20 6e61 6d65 7320 746f 206c  nsion names to l
-00005900: 656e 6774 6873 2e0a 0a20 2020 2020 2020  engths...       
-00005910: 2043 616e 6e6f 7420 6265 206d 6f64 6966   Cannot be modif
-00005920: 6965 6420 6469 7265 6374 6c79 2c20 6275  ied directly, bu
-00005930: 7420 6973 2075 7064 6174 6564 2077 6865  t is updated whe
-00005940: 6e20 6164 6469 6e67 206e 6577 2076 6172  n adding new var
-00005950: 6961 626c 6573 2e0a 0a20 2020 2020 2020  iables...       
-00005960: 204e 6f74 6520 7468 6174 2074 7970 6520   Note that type 
-00005970: 6f66 2074 6869 7320 6f62 6a65 6374 2064  of this object d
-00005980: 6966 6665 7273 2066 726f 6d20 6044 6174  iffers from `Dat
-00005990: 6141 7272 6179 2e64 696d 7360 2e0a 2020  aArray.dims`..  
-000059a0: 2020 2020 2020 5365 6520 6044 6174 6173        See `Datas
-000059b0: 6574 2e73 697a 6573 6020 616e 6420 6044  et.sizes` and `D
-000059c0: 6174 6141 7272 6179 2e73 697a 6573 6020  ataArray.sizes` 
-000059d0: 666f 7220 636f 6e73 6973 7465 6e74 6c79  for consistently
-000059e0: 206e 616d 6564 0a20 2020 2020 2020 2070   named.        p
-000059f0: 726f 7065 7274 6965 732e 0a0a 2020 2020  roperties...    
-00005a00: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-00005a10: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-00005a20: 2020 2020 2020 4461 7461 7365 742e 7369        Dataset.si
-00005a30: 7a65 730a 2020 2020 2020 2020 4461 7461  zes.        Data
-00005a40: 4172 7261 792e 6469 6d73 0a20 2020 2020  Array.dims.     
-00005a50: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
-00005a60: 6574 7572 6e20 4672 6f7a 656e 2873 656c  eturn Frozen(sel
-00005a70: 662e 5f64 696d 7329 0a0a 2020 2020 4070  f._dims)..    @p
-00005a80: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00005a90: 7369 7a65 7328 7365 6c66 2920 2d3e 2046  sizes(self) -> F
-00005aa0: 726f 7a65 6e5b 4861 7368 6162 6c65 2c20  rozen[Hashable, 
-00005ab0: 696e 745d 3a0a 2020 2020 2020 2020 2222  int]:.        ""
-00005ac0: 224d 6170 7069 6e67 2066 726f 6d20 6469  "Mapping from di
-00005ad0: 6d65 6e73 696f 6e20 6e61 6d65 7320 746f  mension names to
-00005ae0: 206c 656e 6774 6873 2e0a 0a20 2020 2020   lengths...     
-00005af0: 2020 2043 616e 6e6f 7420 6265 206d 6f64     Cannot be mod
-00005b00: 6966 6965 6420 6469 7265 6374 6c79 2c20  ified directly, 
-00005b10: 6275 7420 6973 2075 7064 6174 6564 2077  but is updated w
-00005b20: 6865 6e20 6164 6469 6e67 206e 6577 2076  hen adding new v
-00005b30: 6172 6961 626c 6573 2e0a 0a20 2020 2020  ariables...     
-00005b40: 2020 2054 6869 7320 6973 2061 6e20 616c     This is an al
-00005b50: 6961 7320 666f 7220 6044 6174 6173 6574  ias for `Dataset
-00005b60: 2e64 696d 7360 2070 726f 7669 6465 6420  .dims` provided 
-00005b70: 666f 7220 7468 6520 6265 6e65 6669 7420  for the benefit 
-00005b80: 6f66 0a20 2020 2020 2020 2063 6f6e 7369  of.        consi
-00005b90: 7374 656e 6379 2077 6974 6820 6044 6174  stency with `Dat
-00005ba0: 6141 7272 6179 2e73 697a 6573 602e 0a0a  aArray.sizes`...
-00005bb0: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-00005bc0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00005bd0: 2d0a 2020 2020 2020 2020 4461 7461 4172  -.        DataAr
-00005be0: 7261 792e 7369 7a65 730a 2020 2020 2020  ray.sizes.      
-00005bf0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-00005c00: 7475 726e 2073 656c 662e 6469 6d73 0a0a  turn self.dims..
-00005c10: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00005c20: 2020 6465 6620 6474 7970 6573 2873 656c    def dtypes(sel
-00005c30: 6629 202d 3e20 4672 6f7a 656e 5b48 6173  f) -> Frozen[Has
-00005c40: 6861 626c 652c 206e 702e 6474 7970 655d  hable, np.dtype]
-00005c50: 3a0a 2020 2020 2020 2020 2222 224d 6170  :.        """Map
-00005c60: 7069 6e67 2066 726f 6d20 6461 7461 2076  ping from data v
-00005c70: 6172 6961 626c 6520 6e61 6d65 7320 746f  ariable names to
-00005c80: 2064 7479 7065 732e 0a0a 2020 2020 2020   dtypes...      
-00005c90: 2020 4361 6e6e 6f74 2062 6520 6d6f 6469    Cannot be modi
-00005ca0: 6669 6564 2064 6972 6563 746c 792c 2062  fied directly, b
-00005cb0: 7574 2069 7320 7570 6461 7465 6420 7768  ut is updated wh
-00005cc0: 656e 2061 6464 696e 6720 6e65 7720 7661  en adding new va
-00005cd0: 7269 6162 6c65 732e 0a0a 2020 2020 2020  riables...      
-00005ce0: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-00005cf0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00005d00: 2020 2020 4461 7461 4172 7261 792e 6474      DataArray.dt
-00005d10: 7970 650a 2020 2020 2020 2020 2222 220a  ype.        """.
-00005d20: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-00005d30: 726f 7a65 6e28 0a20 2020 2020 2020 2020  rozen(.         
-00005d40: 2020 207b 0a20 2020 2020 2020 2020 2020     {.           
-00005d50: 2020 2020 206e 3a20 762e 6474 7970 650a       n: v.dtype.
-00005d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005d70: 666f 7220 6e2c 2076 2069 6e20 7365 6c66  for n, v in self
-00005d80: 2e5f 7661 7269 6162 6c65 732e 6974 656d  ._variables.item
-00005d90: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
-00005da0: 2020 2020 6966 206e 206e 6f74 2069 6e20      if n not in 
-00005db0: 7365 6c66 2e5f 636f 6f72 645f 6e61 6d65  self._coord_name
-00005dc0: 730a 2020 2020 2020 2020 2020 2020 7d0a  s.            }.
-00005dd0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00005de0: 6566 206c 6f61 6428 7365 6c66 3a20 545f  ef load(self: T_
-00005df0: 4461 7461 7365 742c 202a 2a6b 7761 7267  Dataset, **kwarg
-00005e00: 7329 202d 3e20 545f 4461 7461 7365 743a  s) -> T_Dataset:
-00005e10: 0a20 2020 2020 2020 2022 2222 4d61 6e75  .        """Manu
-00005e20: 616c 6c79 2074 7269 6767 6572 206c 6f61  ally trigger loa
-00005e30: 6469 6e67 2061 6e64 2f6f 7220 636f 6d70  ding and/or comp
-00005e40: 7574 6174 696f 6e20 6f66 2074 6869 7320  utation of this 
-00005e50: 6461 7461 7365 7427 7320 6461 7461 0a20  dataset's data. 
-00005e60: 2020 2020 2020 2066 726f 6d20 6469 736b         from disk
-00005e70: 206f 7220 6120 7265 6d6f 7465 2073 6f75   or a remote sou
-00005e80: 7263 6520 696e 746f 206d 656d 6f72 7920  rce into memory 
-00005e90: 616e 6420 7265 7475 726e 2074 6869 7320  and return this 
-00005ea0: 6461 7461 7365 742e 0a20 2020 2020 2020  dataset..       
-00005eb0: 2055 6e6c 696b 6520 636f 6d70 7574 652c   Unlike compute,
-00005ec0: 2074 6865 206f 7269 6769 6e61 6c20 6461   the original da
-00005ed0: 7461 7365 7420 6973 206d 6f64 6966 6965  taset is modifie
-00005ee0: 6420 616e 6420 7265 7475 726e 6564 2e0a  d and returned..
-00005ef0: 0a20 2020 2020 2020 204e 6f72 6d61 6c6c  .        Normall
-00005f00: 792c 2069 7420 7368 6f75 6c64 206e 6f74  y, it should not
-00005f10: 2062 6520 6e65 6365 7373 6172 7920 746f   be necessary to
-00005f20: 2063 616c 6c20 7468 6973 206d 6574 686f   call this metho
-00005f30: 6420 696e 2075 7365 7220 636f 6465 2c0a  d in user code,.
-00005f40: 2020 2020 2020 2020 6265 6361 7573 6520          because 
-00005f50: 616c 6c20 7861 7272 6179 2066 756e 6374  all xarray funct
-00005f60: 696f 6e73 2073 686f 756c 6420 6569 7468  ions should eith
-00005f70: 6572 2077 6f72 6b20 6f6e 2064 6566 6572  er work on defer
-00005f80: 7265 6420 6461 7461 206f 720a 2020 2020  red data or.    
-00005f90: 2020 2020 6c6f 6164 2064 6174 6120 6175      load data au
-00005fa0: 746f 6d61 7469 6361 6c6c 792e 2048 6f77  tomatically. How
-00005fb0: 6576 6572 2c20 7468 6973 206d 6574 686f  ever, this metho
-00005fc0: 6420 6361 6e20 6265 206e 6563 6573 7361  d can be necessa
-00005fd0: 7279 2077 6865 6e0a 2020 2020 2020 2020  ry when.        
-00005fe0: 776f 726b 696e 6720 7769 7468 206d 616e  working with man
-00005ff0: 7920 6669 6c65 206f 626a 6563 7473 206f  y file objects o
-00006000: 6e20 6469 736b 2e0a 0a20 2020 2020 2020  n disk...       
-00006010: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00006020: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00006030: 2020 2020 2020 202a 2a6b 7761 7267 7320         **kwargs 
-00006040: 3a20 6469 6374 0a20 2020 2020 2020 2020  : dict.         
-00006050: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
-00006060: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
-00006070: 7061 7373 6564 206f 6e20 746f 2060 6064  passed on to ``d
-00006080: 6173 6b2e 636f 6d70 7574 6560 602e 0a0a  ask.compute``...
-00006090: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-000060a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000060b0: 2d0a 2020 2020 2020 2020 6461 736b 2e63  -.        dask.c
-000060c0: 6f6d 7075 7465 0a20 2020 2020 2020 2022  ompute.        "
-000060d0: 2222 0a20 2020 2020 2020 2023 2061 6363  "".        # acc
-000060e0: 6573 7320 2e64 6174 6120 746f 2063 6f65  ess .data to coe
-000060f0: 7263 6520 6576 6572 7974 6869 6e67 2074  rce everything t
-00006100: 6f20 6e75 6d70 7920 6f72 2064 6173 6b20  o numpy or dask 
-00006110: 6172 7261 7973 0a20 2020 2020 2020 206c  arrays.        l
-00006120: 617a 795f 6461 7461 203d 207b 0a20 2020  azy_data = {.   
-00006130: 2020 2020 2020 2020 206b 3a20 762e 5f64           k: v._d
-00006140: 6174 6120 666f 7220 6b2c 2076 2069 6e20  ata for k, v in 
-00006150: 7365 6c66 2e76 6172 6961 626c 6573 2e69  self.variables.i
-00006160: 7465 6d73 2829 2069 6620 6973 5f63 6875  tems() if is_chu
-00006170: 6e6b 6564 5f61 7272 6179 2876 2e5f 6461  nked_array(v._da
-00006180: 7461 290a 2020 2020 2020 2020 7d0a 2020  ta).        }.  
-00006190: 2020 2020 2020 6966 206c 617a 795f 6461        if lazy_da
-000061a0: 7461 3a0a 2020 2020 2020 2020 2020 2020  ta:.            
-000061b0: 6368 756e 6b6d 616e 6167 6572 203d 2067  chunkmanager = g
-000061c0: 6574 5f63 6875 6e6b 6564 5f61 7272 6179  et_chunked_array
-000061d0: 5f74 7970 6528 2a6c 617a 795f 6461 7461  _type(*lazy_data
-000061e0: 2e76 616c 7565 7328 2929 0a0a 2020 2020  .values())..    
-000061f0: 2020 2020 2020 2020 2320 6576 616c 7561          # evalua
-00006200: 7465 2061 6c6c 2074 6865 2063 6875 6e6b  te all the chunk
-00006210: 6564 2061 7272 6179 7320 7369 6d75 6c74  ed arrays simult
-00006220: 616e 656f 7573 6c79 0a20 2020 2020 2020  aneously.       
-00006230: 2020 2020 2065 7661 6c75 6174 6564 5f64       evaluated_d
-00006240: 6174 6120 3d20 6368 756e 6b6d 616e 6167  ata = chunkmanag
-00006250: 6572 2e63 6f6d 7075 7465 282a 6c61 7a79  er.compute(*lazy
-00006260: 5f64 6174 612e 7661 6c75 6573 2829 2c20  _data.values(), 
-00006270: 2a2a 6b77 6172 6773 290a 0a20 2020 2020  **kwargs)..     
-00006280: 2020 2020 2020 2066 6f72 206b 2c20 6461         for k, da
-00006290: 7461 2069 6e20 7a69 7028 6c61 7a79 5f64  ta in zip(lazy_d
-000062a0: 6174 612c 2065 7661 6c75 6174 6564 5f64  ata, evaluated_d
-000062b0: 6174 6129 3a0a 2020 2020 2020 2020 2020  ata):.          
-000062c0: 2020 2020 2020 7365 6c66 2e76 6172 6961        self.varia
-000062d0: 626c 6573 5b6b 5d2e 6461 7461 203d 2064  bles[k].data = d
-000062e0: 6174 610a 0a20 2020 2020 2020 2023 206c  ata..        # l
-000062f0: 6f61 6420 6576 6572 7974 6869 6e67 2065  oad everything e
-00006300: 6c73 6520 7365 7175 656e 7469 616c 6c79  lse sequentially
-00006310: 0a20 2020 2020 2020 2066 6f72 206b 2c20  .        for k, 
-00006320: 7620 696e 2073 656c 662e 7661 7269 6162  v in self.variab
-00006330: 6c65 732e 6974 656d 7328 293a 0a20 2020  les.items():.   
-00006340: 2020 2020 2020 2020 2069 6620 6b20 6e6f           if k no
-00006350: 7420 696e 206c 617a 795f 6461 7461 3a0a  t in lazy_data:.
-00006360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006370: 762e 6c6f 6164 2829 0a0a 2020 2020 2020  v.load()..      
-00006380: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
-00006390: 2020 2064 6566 205f 5f64 6173 6b5f 746f     def __dask_to
-000063a0: 6b65 6e69 7a65 5f5f 2873 656c 6629 3a0a  kenize__(self):.
-000063b0: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
-000063c0: 6b2e 6261 7365 2069 6d70 6f72 7420 6e6f  k.base import no
-000063d0: 726d 616c 697a 655f 746f 6b65 6e0a 0a20  rmalize_token.. 
-000063e0: 2020 2020 2020 2072 6574 7572 6e20 6e6f         return no
-000063f0: 726d 616c 697a 655f 746f 6b65 6e28 0a20  rmalize_token(. 
-00006400: 2020 2020 2020 2020 2020 2028 7479 7065             (type
-00006410: 2873 656c 6629 2c20 7365 6c66 2e5f 7661  (self), self._va
-00006420: 7269 6162 6c65 732c 2073 656c 662e 5f63  riables, self._c
-00006430: 6f6f 7264 5f6e 616d 6573 2c20 7365 6c66  oord_names, self
-00006440: 2e5f 6174 7472 7329 0a20 2020 2020 2020  ._attrs).       
-00006450: 2029 0a0a 2020 2020 6465 6620 5f5f 6461   )..    def __da
-00006460: 736b 5f67 7261 7068 5f5f 2873 656c 6629  sk_graph__(self)
-00006470: 3a0a 2020 2020 2020 2020 6772 6170 6873  :.        graphs
-00006480: 203d 207b 6b3a 2076 2e5f 5f64 6173 6b5f   = {k: v.__dask_
-00006490: 6772 6170 685f 5f28 2920 666f 7220 6b2c  graph__() for k,
-000064a0: 2076 2069 6e20 7365 6c66 2e76 6172 6961   v in self.varia
-000064b0: 626c 6573 2e69 7465 6d73 2829 7d0a 2020  bles.items()}.  
-000064c0: 2020 2020 2020 6772 6170 6873 203d 207b        graphs = {
-000064d0: 6b3a 2076 2066 6f72 206b 2c20 7620 696e  k: v for k, v in
-000064e0: 2067 7261 7068 732e 6974 656d 7328 2920   graphs.items() 
-000064f0: 6966 2076 2069 7320 6e6f 7420 4e6f 6e65  if v is not None
-00006500: 7d0a 2020 2020 2020 2020 6966 206e 6f74  }.        if not
-00006510: 2067 7261 7068 733a 0a20 2020 2020 2020   graphs:.       
-00006520: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-00006530: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00006540: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
-00006550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006560: 6672 6f6d 2064 6173 6b2e 6869 6768 6c65  from dask.highle
-00006570: 7665 6c67 7261 7068 2069 6d70 6f72 7420  velgraph import 
-00006580: 4869 6768 4c65 7665 6c47 7261 7068 0a0a  HighLevelGraph..
-00006590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000065a0: 7265 7475 726e 2048 6967 684c 6576 656c  return HighLevel
-000065b0: 4772 6170 682e 6d65 7267 6528 2a67 7261  Graph.merge(*gra
-000065c0: 7068 732e 7661 6c75 6573 2829 290a 2020  phs.values()).  
-000065d0: 2020 2020 2020 2020 2020 6578 6365 7074            except
-000065e0: 2049 6d70 6f72 7445 7272 6f72 3a0a 2020   ImportError:.  
-000065f0: 2020 2020 2020 2020 2020 2020 2020 6672                fr
-00006600: 6f6d 2064 6173 6b20 696d 706f 7274 2073  om dask import s
-00006610: 6861 7265 6469 6374 0a0a 2020 2020 2020  haredict..      
-00006620: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00006630: 2073 6861 7265 6469 6374 2e6d 6572 6765   sharedict.merge
-00006640: 282a 6772 6170 6873 2e76 616c 7565 7328  (*graphs.values(
-00006650: 2929 0a0a 2020 2020 6465 6620 5f5f 6461  ))..    def __da
-00006660: 736b 5f6b 6579 735f 5f28 7365 6c66 293a  sk_keys__(self):
-00006670: 0a20 2020 2020 2020 2069 6d70 6f72 7420  .        import 
-00006680: 6461 736b 0a0a 2020 2020 2020 2020 7265  dask..        re
-00006690: 7475 726e 205b 0a20 2020 2020 2020 2020  turn [.         
-000066a0: 2020 2076 2e5f 5f64 6173 6b5f 6b65 7973     v.__dask_keys
-000066b0: 5f5f 2829 0a20 2020 2020 2020 2020 2020  __().           
-000066c0: 2066 6f72 2076 2069 6e20 7365 6c66 2e76   for v in self.v
-000066d0: 6172 6961 626c 6573 2e76 616c 7565 7328  ariables.values(
-000066e0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-000066f0: 2064 6173 6b2e 6973 5f64 6173 6b5f 636f   dask.is_dask_co
-00006700: 6c6c 6563 7469 6f6e 2876 290a 2020 2020  llection(v).    
-00006710: 2020 2020 5d0a 0a20 2020 2064 6566 205f      ]..    def _
-00006720: 5f64 6173 6b5f 6c61 7965 7273 5f5f 2873  _dask_layers__(s
-00006730: 656c 6629 3a0a 2020 2020 2020 2020 696d  elf):.        im
-00006740: 706f 7274 2064 6173 6b0a 0a20 2020 2020  port dask..     
-00006750: 2020 2072 6574 7572 6e20 7375 6d28 0a20     return sum(. 
-00006760: 2020 2020 2020 2020 2020 2028 0a20 2020             (.   
-00006770: 2020 2020 2020 2020 2020 2020 2076 2e5f               v._
-00006780: 5f64 6173 6b5f 6c61 7965 7273 5f5f 2829  _dask_layers__()
-00006790: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000067a0: 2066 6f72 2076 2069 6e20 7365 6c66 2e76   for v in self.v
-000067b0: 6172 6961 626c 6573 2e76 616c 7565 7328  ariables.values(
-000067c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000067d0: 2020 6966 2064 6173 6b2e 6973 5f64 6173    if dask.is_das
-000067e0: 6b5f 636f 6c6c 6563 7469 6f6e 2876 290a  k_collection(v).
-000067f0: 2020 2020 2020 2020 2020 2020 292c 0a20              ),. 
-00006800: 2020 2020 2020 2020 2020 2028 292c 0a20             (),. 
-00006810: 2020 2020 2020 2029 0a0a 2020 2020 4070         )..    @p
-00006820: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00006830: 5f5f 6461 736b 5f6f 7074 696d 697a 655f  __dask_optimize_
-00006840: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
-00006850: 2069 6d70 6f72 7420 6461 736b 2e61 7272   import dask.arr
-00006860: 6179 2061 7320 6461 0a0a 2020 2020 2020  ay as da..      
-00006870: 2020 7265 7475 726e 2064 612e 4172 7261    return da.Arra
-00006880: 792e 5f5f 6461 736b 5f6f 7074 696d 697a  y.__dask_optimiz
-00006890: 655f 5f0a 0a20 2020 2040 7072 6f70 6572  e__..    @proper
-000068a0: 7479 0a20 2020 2064 6566 205f 5f64 6173  ty.    def __das
-000068b0: 6b5f 7363 6865 6475 6c65 725f 5f28 7365  k_scheduler__(se
-000068c0: 6c66 293a 0a20 2020 2020 2020 2069 6d70  lf):.        imp
-000068d0: 6f72 7420 6461 736b 2e61 7272 6179 2061  ort dask.array a
-000068e0: 7320 6461 0a0a 2020 2020 2020 2020 7265  s da..        re
-000068f0: 7475 726e 2064 612e 4172 7261 792e 5f5f  turn da.Array.__
-00006900: 6461 736b 5f73 6368 6564 756c 6572 5f5f  dask_scheduler__
-00006910: 0a0a 2020 2020 6465 6620 5f5f 6461 736b  ..    def __dask
-00006920: 5f70 6f73 7463 6f6d 7075 7465 5f5f 2873  _postcompute__(s
-00006930: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00006940: 7475 726e 2073 656c 662e 5f64 6173 6b5f  turn self._dask_
-00006950: 706f 7374 636f 6d70 7574 652c 2028 290a  postcompute, ().
-00006960: 0a20 2020 2064 6566 205f 5f64 6173 6b5f  .    def __dask_
-00006970: 706f 7374 7065 7273 6973 745f 5f28 7365  postpersist__(se
-00006980: 6c66 293a 0a20 2020 2020 2020 2072 6574  lf):.        ret
-00006990: 7572 6e20 7365 6c66 2e5f 6461 736b 5f70  urn self._dask_p
-000069a0: 6f73 7470 6572 7369 7374 2c20 2829 0a0a  ostpersist, ()..
-000069b0: 2020 2020 6465 6620 5f64 6173 6b5f 706f      def _dask_po
-000069c0: 7374 636f 6d70 7574 6528 7365 6c66 3a20  stcompute(self: 
-000069d0: 545f 4461 7461 7365 742c 2072 6573 756c  T_Dataset, resul
-000069e0: 7473 3a20 4974 6572 6162 6c65 5b56 6172  ts: Iterable[Var
-000069f0: 6961 626c 655d 2920 2d3e 2054 5f44 6174  iable]) -> T_Dat
-00006a00: 6173 6574 3a0a 2020 2020 2020 2020 696d  aset:.        im
-00006a10: 706f 7274 2064 6173 6b0a 0a20 2020 2020  port dask..     
-00006a20: 2020 2076 6172 6961 626c 6573 203d 207b     variables = {
-00006a30: 7d0a 2020 2020 2020 2020 7265 7375 6c74  }.        result
-00006a40: 735f 6974 6572 203d 2069 7465 7228 7265  s_iter = iter(re
-00006a50: 7375 6c74 7329 0a0a 2020 2020 2020 2020  sults)..        
-00006a60: 666f 7220 6b2c 2076 2069 6e20 7365 6c66  for k, v in self
-00006a70: 2e5f 7661 7269 6162 6c65 732e 6974 656d  ._variables.item
-00006a80: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-00006a90: 2069 6620 6461 736b 2e69 735f 6461 736b   if dask.is_dask
-00006aa0: 5f63 6f6c 6c65 6374 696f 6e28 7629 3a0a  _collection(v):.
-00006ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ac0: 7265 6275 696c 642c 2061 7267 7320 3d20  rebuild, args = 
-00006ad0: 762e 5f5f 6461 736b 5f70 6f73 7463 6f6d  v.__dask_postcom
-00006ae0: 7075 7465 5f5f 2829 0a20 2020 2020 2020  pute__().       
-00006af0: 2020 2020 2020 2020 2076 203d 2072 6562           v = reb
-00006b00: 7569 6c64 286e 6578 7428 7265 7375 6c74  uild(next(result
-00006b10: 735f 6974 6572 292c 202a 6172 6773 290a  s_iter), *args).
-00006b20: 2020 2020 2020 2020 2020 2020 7661 7269              vari
-00006b30: 6162 6c65 735b 6b5d 203d 2076 0a0a 2020  ables[k] = v..  
-00006b40: 2020 2020 2020 7265 7475 726e 2074 7970        return typ
-00006b50: 6528 7365 6c66 292e 5f63 6f6e 7374 7275  e(self)._constru
-00006b60: 6374 5f64 6972 6563 7428 0a20 2020 2020  ct_direct(.     
-00006b70: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-00006b80: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
-00006b90: 6c66 2e5f 636f 6f72 645f 6e61 6d65 732c  lf._coord_names,
-00006ba0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00006bb0: 662e 5f64 696d 732c 0a20 2020 2020 2020  f._dims,.       
-00006bc0: 2020 2020 2073 656c 662e 5f61 7474 7273       self._attrs
-00006bd0: 2c0a 2020 2020 2020 2020 2020 2020 7365  ,.            se
-00006be0: 6c66 2e5f 696e 6465 7865 732c 0a20 2020  lf._indexes,.   
-00006bf0: 2020 2020 2020 2020 2073 656c 662e 5f65           self._e
-00006c00: 6e63 6f64 696e 672c 0a20 2020 2020 2020  ncoding,.       
-00006c10: 2020 2020 2073 656c 662e 5f63 6c6f 7365       self._close
-00006c20: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00006c30: 2064 6566 205f 6461 736b 5f70 6f73 7470   def _dask_postp
-00006c40: 6572 7369 7374 280a 2020 2020 2020 2020  ersist(.        
-00006c50: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
-00006c60: 2064 736b 3a20 4d61 7070 696e 672c 202a   dsk: Mapping, *
-00006c70: 2c20 7265 6e61 6d65 3a20 4d61 7070 696e  , rename: Mappin
-00006c80: 675b 7374 722c 2073 7472 5d20 7c20 4e6f  g[str, str] | No
-00006c90: 6e65 203d 204e 6f6e 650a 2020 2020 2920  ne = None.    ) 
-00006ca0: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-00006cb0: 2020 2020 2020 6672 6f6d 2064 6173 6b20        from dask 
-00006cc0: 696d 706f 7274 2069 735f 6461 736b 5f63  import is_dask_c
-00006cd0: 6f6c 6c65 6374 696f 6e0a 2020 2020 2020  ollection.      
-00006ce0: 2020 6672 6f6d 2064 6173 6b2e 6869 6768    from dask.high
-00006cf0: 6c65 7665 6c67 7261 7068 2069 6d70 6f72  levelgraph impor
-00006d00: 7420 4869 6768 4c65 7665 6c47 7261 7068  t HighLevelGraph
-00006d10: 0a20 2020 2020 2020 2066 726f 6d20 6461  .        from da
-00006d20: 736b 2e6f 7074 696d 697a 6174 696f 6e20  sk.optimization 
-00006d30: 696d 706f 7274 2063 756c 6c0a 0a20 2020  import cull..   
-00006d40: 2020 2020 2076 6172 6961 626c 6573 203d       variables =
-00006d50: 207b 7d0a 0a20 2020 2020 2020 2066 6f72   {}..        for
-00006d60: 206b 2c20 7620 696e 2073 656c 662e 5f76   k, v in self._v
-00006d70: 6172 6961 626c 6573 2e69 7465 6d73 2829  ariables.items()
-00006d80: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00006d90: 206e 6f74 2069 735f 6461 736b 5f63 6f6c   not is_dask_col
-00006da0: 6c65 6374 696f 6e28 7629 3a0a 2020 2020  lection(v):.    
-00006db0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
-00006dc0: 6162 6c65 735b 6b5d 203d 2076 0a20 2020  ables[k] = v.   
-00006dd0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
-00006de0: 7469 6e75 650a 0a20 2020 2020 2020 2020  tinue..         
-00006df0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00006e00: 2864 736b 2c20 4869 6768 4c65 7665 6c47  (dsk, HighLevelG
-00006e10: 7261 7068 293a 0a20 2020 2020 2020 2020  raph):.         
-00006e20: 2020 2020 2020 2023 2064 6173 6b20 3e3d         # dask >=
-00006e30: 2032 3032 312e 330a 2020 2020 2020 2020   2021.3.        
-00006e40: 2020 2020 2020 2020 2320 5f5f 6461 736b          # __dask
-00006e50: 5f70 6f73 7470 6572 7369 7374 5f5f 2829  _postpersist__()
-00006e60: 2077 6173 2063 616c 6c65 6420 6279 2064   was called by d
-00006e70: 6173 6b2e 6869 6768 6c65 7665 6c67 7261  ask.highlevelgra
-00006e80: 7068 2e0a 2020 2020 2020 2020 2020 2020  ph..            
-00006e90: 2020 2020 2320 446f 6e27 7420 7573 6520      # Don't use 
-00006ea0: 6473 6b2e 6375 6c6c 2829 2c20 6173 2077  dsk.cull(), as w
-00006eb0: 6520 6e65 6564 2074 6f20 7072 6576 656e  e need to preven
-00006ec0: 7420 7061 7274 6961 6c20 6c61 7965 7273  t partial layers
-00006ed0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00006ee0: 2020 2320 6874 7470 733a 2f2f 6769 7468    # https://gith
-00006ef0: 7562 2e63 6f6d 2f64 6173 6b2f 6461 736b  ub.com/dask/dask
-00006f00: 2f69 7373 7565 732f 3731 3337 0a20 2020  /issues/7137.   
-00006f10: 2020 2020 2020 2020 2020 2020 206c 6179               lay
-00006f20: 6572 7320 3d20 762e 5f5f 6461 736b 5f6c  ers = v.__dask_l
-00006f30: 6179 6572 735f 5f28 290a 2020 2020 2020  ayers__().      
-00006f40: 2020 2020 2020 2020 2020 6966 2072 656e            if ren
-00006f50: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
-00006f60: 2020 2020 2020 2020 206c 6179 6572 7320           layers 
-00006f70: 3d20 5b72 656e 616d 652e 6765 7428 6b2c  = [rename.get(k,
-00006f80: 206b 2920 666f 7220 6b20 696e 206c 6179   k) for k in lay
-00006f90: 6572 735d 0a20 2020 2020 2020 2020 2020  ers].           
-00006fa0: 2020 2020 2064 736b 3220 3d20 6473 6b2e       dsk2 = dsk.
-00006fb0: 6375 6c6c 5f6c 6179 6572 7328 6c61 7965  cull_layers(laye
-00006fc0: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
-00006fd0: 656c 6966 2072 656e 616d 653a 2020 2320  elif rename:  # 
-00006fe0: 7072 6167 6d61 3a20 6e6f 636f 7665 720a  pragma: nocover.
-00006ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007000: 2320 4174 2074 6865 206d 6f6d 656e 7420  # At the moment 
-00007010: 6f66 2077 7269 7469 6e67 2c20 7468 6973  of writing, this
-00007020: 2069 7320 6f6e 6c79 2066 6f72 2066 6f72   is only for for
-00007030: 7761 7264 2063 6f6d 7061 7469 6269 6c69  ward compatibili
-00007040: 7479 2e0a 2020 2020 2020 2020 2020 2020  ty..            
-00007050: 2020 2020 2320 7265 706c 6163 655f 6e61      # replace_na
-00007060: 6d65 5f69 6e5f 6b65 7920 7265 7175 6972  me_in_key requir
-00007070: 6573 2064 6173 6b20 3e3d 2032 3032 312e  es dask >= 2021.
-00007080: 332e 0a20 2020 2020 2020 2020 2020 2020  3..             
-00007090: 2020 2066 726f 6d20 6461 736b 2e62 6173     from dask.bas
-000070a0: 6520 696d 706f 7274 2066 6c61 7474 656e  e import flatten
-000070b0: 2c20 7265 706c 6163 655f 6e61 6d65 5f69  , replace_name_i
-000070c0: 6e5f 6b65 790a 0a20 2020 2020 2020 2020  n_key..         
-000070d0: 2020 2020 2020 206b 6579 7320 3d20 5b0a         keys = [.
-000070e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000070f0: 2020 2020 7265 706c 6163 655f 6e61 6d65      replace_name
-00007100: 5f69 6e5f 6b65 7928 6b2c 2072 656e 616d  _in_key(k, renam
-00007110: 6529 2066 6f72 206b 2069 6e20 666c 6174  e) for k in flat
-00007120: 7465 6e28 762e 5f5f 6461 736b 5f6b 6579  ten(v.__dask_key
-00007130: 735f 5f28 2929 0a20 2020 2020 2020 2020  s__()).         
-00007140: 2020 2020 2020 205d 0a20 2020 2020 2020         ].       
-00007150: 2020 2020 2020 2020 2064 736b 322c 205f           dsk2, _
-00007160: 203d 2063 756c 6c28 6473 6b2c 206b 6579   = cull(dsk, key
-00007170: 7329 0a20 2020 2020 2020 2020 2020 2065  s).            e
-00007180: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00007190: 2020 2020 2023 205f 5f64 6173 6b5f 706f       # __dask_po
-000071a0: 7374 7065 7273 6973 745f 5f28 2920 7761  stpersist__() wa
-000071b0: 7320 6361 6c6c 6564 2062 7920 6461 736b  s called by dask
-000071c0: 2e6f 7074 696d 697a 6520 6f72 2064 6173  .optimize or das
-000071d0: 6b2e 7065 7273 6973 740a 2020 2020 2020  k.persist.      
-000071e0: 2020 2020 2020 2020 2020 6473 6b32 2c20            dsk2, 
-000071f0: 5f20 3d20 6375 6c6c 2864 736b 2c20 762e  _ = cull(dsk, v.
-00007200: 5f5f 6461 736b 5f6b 6579 735f 5f28 2929  __dask_keys__())
-00007210: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
-00007220: 6275 696c 642c 2061 7267 7320 3d20 762e  build, args = v.
-00007230: 5f5f 6461 736b 5f70 6f73 7470 6572 7369  __dask_postpersi
-00007240: 7374 5f5f 2829 0a20 2020 2020 2020 2020  st__().         
-00007250: 2020 2023 2072 656e 616d 6520 7761 7320     # rename was 
-00007260: 6164 6465 6420 696e 2064 6173 6b20 3230  added in dask 20
-00007270: 3231 2e33 0a20 2020 2020 2020 2020 2020  21.3.           
-00007280: 206b 7761 7267 7320 3d20 7b22 7265 6e61   kwargs = {"rena
-00007290: 6d65 223a 2072 656e 616d 657d 2069 6620  me": rename} if 
-000072a0: 7265 6e61 6d65 2065 6c73 6520 7b7d 0a20  rename else {}. 
-000072b0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-000072c0: 626c 6573 5b6b 5d20 3d20 7265 6275 696c  bles[k] = rebuil
-000072d0: 6428 6473 6b32 2c20 2a61 7267 732c 202a  d(dsk2, *args, *
-000072e0: 2a6b 7761 7267 7329 0a0a 2020 2020 2020  *kwargs)..      
-000072f0: 2020 7265 7475 726e 2074 7970 6528 7365    return type(se
-00007300: 6c66 292e 5f63 6f6e 7374 7275 6374 5f64  lf)._construct_d
-00007310: 6972 6563 7428 0a20 2020 2020 2020 2020  irect(.         
-00007320: 2020 2076 6172 6961 626c 6573 2c0a 2020     variables,.  
-00007330: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00007340: 636f 6f72 645f 6e61 6d65 732c 0a20 2020  coord_names,.   
-00007350: 2020 2020 2020 2020 2073 656c 662e 5f64           self._d
-00007360: 696d 732c 0a20 2020 2020 2020 2020 2020  ims,.           
-00007370: 2073 656c 662e 5f61 7474 7273 2c0a 2020   self._attrs,.  
-00007380: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00007390: 696e 6465 7865 732c 0a20 2020 2020 2020  indexes,.       
-000073a0: 2020 2020 2073 656c 662e 5f65 6e63 6f64       self._encod
-000073b0: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
-000073c0: 2073 656c 662e 5f63 6c6f 7365 2c0a 2020   self._close,.  
-000073d0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-000073e0: 2063 6f6d 7075 7465 2873 656c 663a 2054   compute(self: T
-000073f0: 5f44 6174 6173 6574 2c20 2a2a 6b77 6172  _Dataset, **kwar
-00007400: 6773 2920 2d3e 2054 5f44 6174 6173 6574  gs) -> T_Dataset
-00007410: 3a0a 2020 2020 2020 2020 2222 224d 616e  :.        """Man
-00007420: 7561 6c6c 7920 7472 6967 6765 7220 6c6f  ually trigger lo
-00007430: 6164 696e 6720 616e 642f 6f72 2063 6f6d  ading and/or com
-00007440: 7075 7461 7469 6f6e 206f 6620 7468 6973  putation of this
-00007450: 2064 6174 6173 6574 2773 2064 6174 610a   dataset's data.
-00007460: 2020 2020 2020 2020 6672 6f6d 2064 6973          from dis
-00007470: 6b20 6f72 2061 2072 656d 6f74 6520 736f  k or a remote so
-00007480: 7572 6365 2069 6e74 6f20 6d65 6d6f 7279  urce into memory
-00007490: 2061 6e64 2072 6574 7572 6e20 6120 6e65   and return a ne
-000074a0: 7720 6461 7461 7365 742e 0a20 2020 2020  w dataset..     
-000074b0: 2020 2055 6e6c 696b 6520 6c6f 6164 2c20     Unlike load, 
-000074c0: 7468 6520 6f72 6967 696e 616c 2064 6174  the original dat
-000074d0: 6173 6574 2069 7320 6c65 6674 2075 6e61  aset is left una
-000074e0: 6c74 6572 6564 2e0a 0a20 2020 2020 2020  ltered...       
-000074f0: 204e 6f72 6d61 6c6c 792c 2069 7420 7368   Normally, it sh
-00007500: 6f75 6c64 206e 6f74 2062 6520 6e65 6365  ould not be nece
-00007510: 7373 6172 7920 746f 2063 616c 6c20 7468  ssary to call th
-00007520: 6973 206d 6574 686f 6420 696e 2075 7365  is method in use
-00007530: 7220 636f 6465 2c0a 2020 2020 2020 2020  r code,.        
-00007540: 6265 6361 7573 6520 616c 6c20 7861 7272  because all xarr
-00007550: 6179 2066 756e 6374 696f 6e73 2073 686f  ay functions sho
-00007560: 756c 6420 6569 7468 6572 2077 6f72 6b20  uld either work 
-00007570: 6f6e 2064 6566 6572 7265 6420 6461 7461  on deferred data
-00007580: 206f 720a 2020 2020 2020 2020 6c6f 6164   or.        load
-00007590: 2064 6174 6120 6175 746f 6d61 7469 6361   data automatica
-000075a0: 6c6c 792e 2048 6f77 6576 6572 2c20 7468  lly. However, th
-000075b0: 6973 206d 6574 686f 6420 6361 6e20 6265  is method can be
-000075c0: 206e 6563 6573 7361 7279 2077 6865 6e0a   necessary when.
-000075d0: 2020 2020 2020 2020 776f 726b 696e 6720          working 
-000075e0: 7769 7468 206d 616e 7920 6669 6c65 206f  with many file o
-000075f0: 626a 6563 7473 206f 6e20 6469 736b 2e0a  bjects on disk..
-00007600: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00007610: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00007620: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 202a  ------.        *
-00007630: 2a6b 7761 7267 7320 3a20 6469 6374 0a20  *kwargs : dict. 
-00007640: 2020 2020 2020 2020 2020 2041 6464 6974             Addit
-00007650: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
-00007660: 6775 6d65 6e74 7320 7061 7373 6564 206f  guments passed o
-00007670: 6e20 746f 2060 6064 6173 6b2e 636f 6d70  n to ``dask.comp
-00007680: 7574 6560 602e 0a0a 2020 2020 2020 2020  ute``...        
-00007690: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-000076a0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-000076b0: 2020 6461 736b 2e63 6f6d 7075 7465 0a20    dask.compute. 
-000076c0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000076d0: 2020 206e 6577 203d 2073 656c 662e 636f     new = self.co
-000076e0: 7079 2864 6565 703d 4661 6c73 6529 0a20  py(deep=False). 
-000076f0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-00007700: 772e 6c6f 6164 282a 2a6b 7761 7267 7329  w.load(**kwargs)
-00007710: 0a0a 2020 2020 6465 6620 5f70 6572 7369  ..    def _persi
-00007720: 7374 5f69 6e70 6c61 6365 2873 656c 663a  st_inplace(self:
-00007730: 2054 5f44 6174 6173 6574 2c20 2a2a 6b77   T_Dataset, **kw
-00007740: 6172 6773 2920 2d3e 2054 5f44 6174 6173  args) -> T_Datas
-00007750: 6574 3a0a 2020 2020 2020 2020 2222 2250  et:.        """P
-00007760: 6572 7369 7374 2061 6c6c 2044 6173 6b20  ersist all Dask 
-00007770: 6172 7261 7973 2069 6e20 6d65 6d6f 7279  arrays in memory
-00007780: 2222 220a 2020 2020 2020 2020 2320 6163  """.        # ac
-00007790: 6365 7373 202e 6461 7461 2074 6f20 636f  cess .data to co
-000077a0: 6572 6365 2065 7665 7279 7468 696e 6720  erce everything 
-000077b0: 746f 206e 756d 7079 206f 7220 6461 736b  to numpy or dask
-000077c0: 2061 7272 6179 730a 2020 2020 2020 2020   arrays.        
-000077d0: 6c61 7a79 5f64 6174 6120 3d20 7b0a 2020  lazy_data = {.  
-000077e0: 2020 2020 2020 2020 2020 6b3a 2076 2e5f            k: v._
-000077f0: 6461 7461 2066 6f72 206b 2c20 7620 696e  data for k, v in
-00007800: 2073 656c 662e 7661 7269 6162 6c65 732e   self.variables.
-00007810: 6974 656d 7328 2920 6966 2069 735f 6475  items() if is_du
-00007820: 636b 5f64 6173 6b5f 6172 7261 7928 762e  ck_dask_array(v.
-00007830: 5f64 6174 6129 0a20 2020 2020 2020 207d  _data).        }
-00007840: 0a20 2020 2020 2020 2069 6620 6c61 7a79  .        if lazy
-00007850: 5f64 6174 613a 0a20 2020 2020 2020 2020  _data:.         
-00007860: 2020 2069 6d70 6f72 7420 6461 736b 0a0a     import dask..
-00007870: 2020 2020 2020 2020 2020 2020 2320 6576              # ev
-00007880: 616c 7561 7465 2061 6c6c 2074 6865 2064  aluate all the d
-00007890: 6173 6b20 6172 7261 7973 2073 696d 756c  ask arrays simul
-000078a0: 7461 6e65 6f75 736c 790a 2020 2020 2020  taneously.      
-000078b0: 2020 2020 2020 6576 616c 7561 7465 645f        evaluated_
-000078c0: 6461 7461 203d 2064 6173 6b2e 7065 7273  data = dask.pers
-000078d0: 6973 7428 2a6c 617a 795f 6461 7461 2e76  ist(*lazy_data.v
-000078e0: 616c 7565 7328 292c 202a 2a6b 7761 7267  alues(), **kwarg
-000078f0: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
-00007900: 666f 7220 6b2c 2064 6174 6120 696e 207a  for k, data in z
-00007910: 6970 286c 617a 795f 6461 7461 2c20 6576  ip(lazy_data, ev
-00007920: 616c 7561 7465 645f 6461 7461 293a 0a20  aluated_data):. 
-00007930: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00007940: 656c 662e 7661 7269 6162 6c65 735b 6b5d  elf.variables[k]
-00007950: 2e64 6174 6120 3d20 6461 7461 0a0a 2020  .data = data..  
-00007960: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00007970: 660a 0a20 2020 2064 6566 2070 6572 7369  f..    def persi
-00007980: 7374 2873 656c 663a 2054 5f44 6174 6173  st(self: T_Datas
-00007990: 6574 2c20 2a2a 6b77 6172 6773 2920 2d3e  et, **kwargs) ->
-000079a0: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
-000079b0: 2020 2020 2222 2254 7269 6767 6572 2063      """Trigger c
-000079c0: 6f6d 7075 7461 7469 6f6e 2c20 6b65 6570  omputation, keep
-000079d0: 696e 6720 6461 7461 2061 7320 6461 736b  ing data as dask
-000079e0: 2061 7272 6179 730a 0a20 2020 2020 2020   arrays..       
-000079f0: 2054 6869 7320 6f70 6572 6174 696f 6e20   This operation 
-00007a00: 6361 6e20 6265 2075 7365 6420 746f 2074  can be used to t
-00007a10: 7269 6767 6572 2063 6f6d 7075 7461 7469  rigger computati
-00007a20: 6f6e 206f 6e20 756e 6465 726c 7969 6e67  on on underlying
-00007a30: 2064 6173 6b0a 2020 2020 2020 2020 6172   dask.        ar
-00007a40: 7261 7973 2c20 7369 6d69 6c61 7220 746f  rays, similar to
-00007a50: 2060 602e 636f 6d70 7574 6528 2960 6020   ``.compute()`` 
-00007a60: 6f72 2060 602e 6c6f 6164 2829 6060 2e20  or ``.load()``. 
-00007a70: 2048 6f77 6576 6572 2074 6869 730a 2020   However this.  
-00007a80: 2020 2020 2020 6f70 6572 6174 696f 6e20        operation 
-00007a90: 6b65 6570 7320 7468 6520 6461 7461 2061  keeps the data a
-00007aa0: 7320 6461 736b 2061 7272 6179 732e 2054  s dask arrays. T
-00007ab0: 6869 7320 6973 2070 6172 7469 6375 6c61  his is particula
-00007ac0: 726c 7920 7573 6566 756c 0a20 2020 2020  rly useful.     
-00007ad0: 2020 2077 6865 6e20 7573 696e 6720 7468     when using th
-00007ae0: 6520 6461 736b 2e64 6973 7472 6962 7574  e dask.distribut
-00007af0: 6564 2073 6368 6564 756c 6572 2061 6e64  ed scheduler and
-00007b00: 2079 6f75 2077 616e 7420 746f 206c 6f61   you want to loa
-00007b10: 6420 6120 6c61 7267 650a 2020 2020 2020  d a large.      
-00007b20: 2020 616d 6f75 6e74 206f 6620 6461 7461    amount of data
-00007b30: 2069 6e74 6f20 6469 7374 7269 6275 7465   into distribute
-00007b40: 6420 6d65 6d6f 7279 2e0a 0a20 2020 2020  d memory...     
-00007b50: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00007b60: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00007b70: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-00007b80: 7320 3a20 6469 6374 0a20 2020 2020 2020  s : dict.       
-00007b90: 2020 2020 2041 6464 6974 696f 6e61 6c20       Additional 
-00007ba0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00007bb0: 7320 7061 7373 6564 206f 6e20 746f 2060  s passed on to `
-00007bc0: 6064 6173 6b2e 7065 7273 6973 7460 602e  `dask.persist``.
-00007bd0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-00007be0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-00007bf0: 2d2d 2d0a 2020 2020 2020 2020 6461 736b  ---.        dask
-00007c00: 2e70 6572 7369 7374 0a20 2020 2020 2020  .persist.       
-00007c10: 2022 2222 0a20 2020 2020 2020 206e 6577   """.        new
-00007c20: 203d 2073 656c 662e 636f 7079 2864 6565   = self.copy(dee
-00007c30: 703d 4661 6c73 6529 0a20 2020 2020 2020  p=False).       
-00007c40: 2072 6574 7572 6e20 6e65 772e 5f70 6572   return new._per
-00007c50: 7369 7374 5f69 6e70 6c61 6365 282a 2a6b  sist_inplace(**k
-00007c60: 7761 7267 7329 0a0a 2020 2020 4063 6c61  wargs)..    @cla
-00007c70: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
-00007c80: 205f 636f 6e73 7472 7563 745f 6469 7265   _construct_dire
-00007c90: 6374 280a 2020 2020 2020 2020 636c 733a  ct(.        cls:
-00007ca0: 2074 7970 655b 545f 4461 7461 7365 745d   type[T_Dataset]
-00007cb0: 2c0a 2020 2020 2020 2020 7661 7269 6162  ,.        variab
-00007cc0: 6c65 733a 2064 6963 745b 416e 792c 2056  les: dict[Any, V
-00007cd0: 6172 6961 626c 655d 2c0a 2020 2020 2020  ariable],.      
-00007ce0: 2020 636f 6f72 645f 6e61 6d65 733a 2073    coord_names: s
-00007cf0: 6574 5b48 6173 6861 626c 655d 2c0a 2020  et[Hashable],.  
-00007d00: 2020 2020 2020 6469 6d73 3a20 6469 6374        dims: dict
-00007d10: 5b41 6e79 2c20 696e 745d 207c 204e 6f6e  [Any, int] | Non
-00007d20: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-00007d30: 2020 6174 7472 733a 2064 6963 7420 7c20    attrs: dict | 
-00007d40: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-00007d50: 2020 2020 2069 6e64 6578 6573 3a20 6469       indexes: di
-00007d60: 6374 5b41 6e79 2c20 496e 6465 785d 207c  ct[Any, Index] |
-00007d70: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-00007d80: 2020 2020 2020 656e 636f 6469 6e67 3a20        encoding: 
-00007d90: 6469 6374 207c 204e 6f6e 6520 3d20 4e6f  dict | None = No
-00007da0: 6e65 2c0a 2020 2020 2020 2020 636c 6f73  ne,.        clos
-00007db0: 653a 2043 616c 6c61 626c 655b 5b5d 2c20  e: Callable[[], 
-00007dc0: 4e6f 6e65 5d20 7c20 4e6f 6e65 203d 204e  None] | None = N
-00007dd0: 6f6e 652c 0a20 2020 2029 202d 3e20 545f  one,.    ) -> T_
-00007de0: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
-00007df0: 2022 2222 5368 6f72 7463 7574 2061 726f   """Shortcut aro
-00007e00: 756e 6420 5f5f 696e 6974 5f5f 2066 6f72  und __init__ for
-00007e10: 2069 6e74 6572 6e61 6c20 7573 6520 7768   internal use wh
-00007e20: 656e 2077 6520 7761 6e74 2074 6f20 736b  en we want to sk
-00007e30: 6970 0a20 2020 2020 2020 2063 6f73 746c  ip.        costl
-00007e40: 7920 7661 6c69 6461 7469 6f6e 0a20 2020  y validation.   
-00007e50: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00007e60: 2069 6620 6469 6d73 2069 7320 4e6f 6e65   if dims is None
-00007e70: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-00007e80: 6d73 203d 2063 616c 6375 6c61 7465 5f64  ms = calculate_d
-00007e90: 696d 656e 7369 6f6e 7328 7661 7269 6162  imensions(variab
-00007ea0: 6c65 7329 0a20 2020 2020 2020 2069 6620  les).        if 
-00007eb0: 696e 6465 7865 7320 6973 204e 6f6e 653a  indexes is None:
-00007ec0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00007ed0: 6578 6573 203d 207b 7d0a 2020 2020 2020  exes = {}.      
-00007ee0: 2020 6f62 6a20 3d20 6f62 6a65 6374 2e5f    obj = object._
-00007ef0: 5f6e 6577 5f5f 2863 6c73 290a 2020 2020  _new__(cls).    
-00007f00: 2020 2020 6f62 6a2e 5f76 6172 6961 626c      obj._variabl
-00007f10: 6573 203d 2076 6172 6961 626c 6573 0a20  es = variables. 
-00007f20: 2020 2020 2020 206f 626a 2e5f 636f 6f72         obj._coor
-00007f30: 645f 6e61 6d65 7320 3d20 636f 6f72 645f  d_names = coord_
-00007f40: 6e61 6d65 730a 2020 2020 2020 2020 6f62  names.        ob
-00007f50: 6a2e 5f64 696d 7320 3d20 6469 6d73 0a20  j._dims = dims. 
-00007f60: 2020 2020 2020 206f 626a 2e5f 696e 6465         obj._inde
-00007f70: 7865 7320 3d20 696e 6465 7865 730a 2020  xes = indexes.  
-00007f80: 2020 2020 2020 6f62 6a2e 5f61 7474 7273        obj._attrs
-00007f90: 203d 2061 7474 7273 0a20 2020 2020 2020   = attrs.       
-00007fa0: 206f 626a 2e5f 636c 6f73 6520 3d20 636c   obj._close = cl
-00007fb0: 6f73 650a 2020 2020 2020 2020 6f62 6a2e  ose.        obj.
-00007fc0: 5f65 6e63 6f64 696e 6720 3d20 656e 636f  _encoding = enco
-00007fd0: 6469 6e67 0a20 2020 2020 2020 2072 6574  ding.        ret
-00007fe0: 7572 6e20 6f62 6a0a 0a20 2020 2064 6566  urn obj..    def
-00007ff0: 205f 7265 706c 6163 6528 0a20 2020 2020   _replace(.     
-00008000: 2020 2073 656c 663a 2054 5f44 6174 6173     self: T_Datas
-00008010: 6574 2c0a 2020 2020 2020 2020 7661 7269  et,.        vari
-00008020: 6162 6c65 733a 2064 6963 745b 4861 7368  ables: dict[Hash
-00008030: 6162 6c65 2c20 5661 7269 6162 6c65 5d20  able, Variable] 
-00008040: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00008050: 2020 2020 2020 2063 6f6f 7264 5f6e 616d         coord_nam
-00008060: 6573 3a20 7365 745b 4861 7368 6162 6c65  es: set[Hashable
-00008070: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-00008080: 0a20 2020 2020 2020 2064 696d 733a 2064  .        dims: d
-00008090: 6963 745b 416e 792c 2069 6e74 5d20 7c20  ict[Any, int] | 
-000080a0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-000080b0: 2020 2020 2061 7474 7273 3a20 6469 6374       attrs: dict
-000080c0: 5b48 6173 6861 626c 652c 2041 6e79 5d20  [Hashable, Any] 
-000080d0: 7c20 4e6f 6e65 207c 2044 6566 6175 6c74  | None | Default
-000080e0: 203d 205f 6465 6661 756c 742c 0a20 2020   = _default,.   
-000080f0: 2020 2020 2069 6e64 6578 6573 3a20 6469       indexes: di
-00008100: 6374 5b48 6173 6861 626c 652c 2049 6e64  ct[Hashable, Ind
-00008110: 6578 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ex] | None = Non
-00008120: 652c 0a20 2020 2020 2020 2065 6e63 6f64  e,.        encod
-00008130: 696e 673a 2064 6963 7420 7c20 4e6f 6e65  ing: dict | None
-00008140: 207c 2044 6566 6175 6c74 203d 205f 6465   | Default = _de
-00008150: 6661 756c 742c 0a20 2020 2020 2020 2069  fault,.        i
-00008160: 6e70 6c61 6365 3a20 626f 6f6c 203d 2046  nplace: bool = F
-00008170: 616c 7365 2c0a 2020 2020 2920 2d3e 2054  alse,.    ) -> T
-00008180: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
-00008190: 2020 2222 2246 6173 7470 6174 6820 636f    """Fastpath co
-000081a0: 6e73 7472 7563 746f 7220 666f 7220 696e  nstructor for in
-000081b0: 7465 726e 616c 2075 7365 2e0a 0a20 2020  ternal use...   
-000081c0: 2020 2020 2052 6574 7572 6e73 2061 6e20       Returns an 
-000081d0: 6f62 6a65 6374 2077 6974 6820 6f70 7469  object with opti
-000081e0: 6f6e 616c 6c79 2077 6974 6820 7265 706c  onally with repl
-000081f0: 6163 6564 2061 7474 7269 6275 7465 732e  aced attributes.
-00008200: 0a0a 2020 2020 2020 2020 4578 706c 6963  ..        Explic
-00008210: 6974 6c79 2070 6173 7365 6420 6172 6775  itly passed argu
-00008220: 6d65 6e74 7320 6172 6520 2a6e 6f74 2a20  ments are *not* 
-00008230: 636f 7069 6564 2077 6865 6e20 706c 6163  copied when plac
-00008240: 6564 206f 6e20 7468 6520 6e65 770a 2020  ed on the new.  
-00008250: 2020 2020 2020 6461 7461 7365 742e 2049        dataset. I
-00008260: 7420 6973 2075 7020 746f 2074 6865 2063  t is up to the c
-00008270: 616c 6c65 7220 746f 2065 6e73 7572 6520  aller to ensure 
-00008280: 7468 6174 2074 6865 7920 6861 7665 2074  that they have t
-00008290: 6865 2072 6967 6874 2074 7970 650a 2020  he right type.  
-000082a0: 2020 2020 2020 616e 6420 6172 6520 6e6f        and are no
-000082b0: 7420 7573 6564 2065 6c73 6577 6865 7265  t used elsewhere
-000082c0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-000082d0: 2020 2020 2020 6966 2069 6e70 6c61 6365        if inplace
-000082e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-000082f0: 2076 6172 6961 626c 6573 2069 7320 6e6f   variables is no
-00008300: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00008310: 2020 2020 2020 2020 7365 6c66 2e5f 7661          self._va
-00008320: 7269 6162 6c65 7320 3d20 7661 7269 6162  riables = variab
-00008330: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
-00008340: 6966 2063 6f6f 7264 5f6e 616d 6573 2069  if coord_names i
-00008350: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
-00008360: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00008370: 2e5f 636f 6f72 645f 6e61 6d65 7320 3d20  ._coord_names = 
-00008380: 636f 6f72 645f 6e61 6d65 730a 2020 2020  coord_names.    
-00008390: 2020 2020 2020 2020 6966 2064 696d 7320          if dims 
-000083a0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-000083b0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000083c0: 662e 5f64 696d 7320 3d20 6469 6d73 0a20  f._dims = dims. 
-000083d0: 2020 2020 2020 2020 2020 2069 6620 6174             if at
-000083e0: 7472 7320 6973 206e 6f74 205f 6465 6661  trs is not _defa
-000083f0: 756c 743a 0a20 2020 2020 2020 2020 2020  ult:.           
-00008400: 2020 2020 2073 656c 662e 5f61 7474 7273       self._attrs
-00008410: 203d 2061 7474 7273 0a20 2020 2020 2020   = attrs.       
-00008420: 2020 2020 2069 6620 696e 6465 7865 7320       if indexes 
-00008430: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
-00008440: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00008450: 662e 5f69 6e64 6578 6573 203d 2069 6e64  f._indexes = ind
-00008460: 6578 6573 0a20 2020 2020 2020 2020 2020  exes.           
-00008470: 2069 6620 656e 636f 6469 6e67 2069 7320   if encoding is 
-00008480: 6e6f 7420 5f64 6566 6175 6c74 3a0a 2020  not _default:.  
-00008490: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000084a0: 6c66 2e5f 656e 636f 6469 6e67 203d 2065  lf._encoding = e
-000084b0: 6e63 6f64 696e 670a 2020 2020 2020 2020  ncoding.        
-000084c0: 2020 2020 6f62 6a20 3d20 7365 6c66 0a20      obj = self. 
-000084d0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000084e0: 2020 2020 2020 2020 2069 6620 7661 7269           if vari
-000084f0: 6162 6c65 7320 6973 204e 6f6e 653a 0a20  ables is None:. 
-00008500: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00008510: 6172 6961 626c 6573 203d 2073 656c 662e  ariables = self.
-00008520: 5f76 6172 6961 626c 6573 2e63 6f70 7928  _variables.copy(
-00008530: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00008540: 2063 6f6f 7264 5f6e 616d 6573 2069 7320   coord_names is 
-00008550: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00008560: 2020 2020 2020 636f 6f72 645f 6e61 6d65        coord_name
-00008570: 7320 3d20 7365 6c66 2e5f 636f 6f72 645f  s = self._coord_
-00008580: 6e61 6d65 732e 636f 7079 2829 0a20 2020  names.copy().   
-00008590: 2020 2020 2020 2020 2069 6620 6469 6d73           if dims
-000085a0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-000085b0: 2020 2020 2020 2020 2020 6469 6d73 203d            dims =
-000085c0: 2073 656c 662e 5f64 696d 732e 636f 7079   self._dims.copy
-000085d0: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
-000085e0: 6620 6174 7472 7320 6973 205f 6465 6661  f attrs is _defa
-000085f0: 756c 743a 0a20 2020 2020 2020 2020 2020  ult:.           
-00008600: 2020 2020 2061 7474 7273 203d 2063 6f70       attrs = cop
-00008610: 792e 636f 7079 2873 656c 662e 5f61 7474  y.copy(self._att
-00008620: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
-00008630: 6966 2069 6e64 6578 6573 2069 7320 4e6f  if indexes is No
-00008640: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00008650: 2020 2020 696e 6465 7865 7320 3d20 7365      indexes = se
-00008660: 6c66 2e5f 696e 6465 7865 732e 636f 7079  lf._indexes.copy
-00008670: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
-00008680: 6620 656e 636f 6469 6e67 2069 7320 5f64  f encoding is _d
-00008690: 6566 6175 6c74 3a0a 2020 2020 2020 2020  efault:.        
-000086a0: 2020 2020 2020 2020 656e 636f 6469 6e67          encoding
-000086b0: 203d 2063 6f70 792e 636f 7079 2873 656c   = copy.copy(sel
-000086c0: 662e 5f65 6e63 6f64 696e 6729 0a20 2020  f._encoding).   
-000086d0: 2020 2020 2020 2020 206f 626a 203d 2073           obj = s
-000086e0: 656c 662e 5f63 6f6e 7374 7275 6374 5f64  elf._construct_d
-000086f0: 6972 6563 7428 0a20 2020 2020 2020 2020  irect(.         
-00008700: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-00008710: 2c20 636f 6f72 645f 6e61 6d65 732c 2064  , coord_names, d
-00008720: 696d 732c 2061 7474 7273 2c20 696e 6465  ims, attrs, inde
-00008730: 7865 732c 2065 6e63 6f64 696e 670a 2020  xes, encoding.  
-00008740: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00008750: 2020 2020 7265 7475 726e 206f 626a 0a0a      return obj..
-00008760: 2020 2020 6465 6620 5f72 6570 6c61 6365      def _replace
-00008770: 5f77 6974 685f 6e65 775f 6469 6d73 280a  _with_new_dims(.
-00008780: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
-00008790: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
-000087a0: 2076 6172 6961 626c 6573 3a20 6469 6374   variables: dict
-000087b0: 5b48 6173 6861 626c 652c 2056 6172 6961  [Hashable, Varia
-000087c0: 626c 655d 2c0a 2020 2020 2020 2020 636f  ble],.        co
-000087d0: 6f72 645f 6e61 6d65 733a 2073 6574 207c  ord_names: set |
-000087e0: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-000087f0: 2020 2020 2020 6174 7472 733a 2064 6963        attrs: dic
-00008800: 745b 4861 7368 6162 6c65 2c20 416e 795d  t[Hashable, Any]
-00008810: 207c 204e 6f6e 6520 7c20 4465 6661 756c   | None | Defaul
-00008820: 7420 3d20 5f64 6566 6175 6c74 2c0a 2020  t = _default,.  
-00008830: 2020 2020 2020 696e 6465 7865 733a 2064        indexes: d
-00008840: 6963 745b 4861 7368 6162 6c65 2c20 496e  ict[Hashable, In
-00008850: 6465 785d 207c 204e 6f6e 6520 3d20 4e6f  dex] | None = No
-00008860: 6e65 2c0a 2020 2020 2020 2020 696e 706c  ne,.        inpl
-00008870: 6163 653a 2062 6f6f 6c20 3d20 4661 6c73  ace: bool = Fals
-00008880: 652c 0a20 2020 2029 202d 3e20 545f 4461  e,.    ) -> T_Da
-00008890: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-000088a0: 2222 5265 706c 6163 6520 7661 7269 6162  ""Replace variab
-000088b0: 6c65 7320 7769 7468 2072 6563 616c 6375  les with recalcu
-000088c0: 6c61 7465 6420 6469 6d65 6e73 696f 6e73  lated dimensions
-000088d0: 2e22 2222 0a20 2020 2020 2020 2064 696d  .""".        dim
-000088e0: 7320 3d20 6361 6c63 756c 6174 655f 6469  s = calculate_di
-000088f0: 6d65 6e73 696f 6e73 2876 6172 6961 626c  mensions(variabl
-00008900: 6573 290a 2020 2020 2020 2020 7265 7475  es).        retu
-00008910: 726e 2073 656c 662e 5f72 6570 6c61 6365  rn self._replace
-00008920: 280a 2020 2020 2020 2020 2020 2020 7661  (.            va
-00008930: 7269 6162 6c65 732c 2063 6f6f 7264 5f6e  riables, coord_n
-00008940: 616d 6573 2c20 6469 6d73 2c20 6174 7472  ames, dims, attr
-00008950: 732c 2069 6e64 6578 6573 2c20 696e 706c  s, indexes, inpl
-00008960: 6163 653d 696e 706c 6163 650a 2020 2020  ace=inplace.    
-00008970: 2020 2020 290a 0a20 2020 2064 6566 205f      )..    def _
-00008980: 7265 706c 6163 655f 7661 7273 5f61 6e64  replace_vars_and
-00008990: 5f64 696d 7328 0a20 2020 2020 2020 2073  _dims(.        s
-000089a0: 656c 663a 2054 5f44 6174 6173 6574 2c0a  elf: T_Dataset,.
-000089b0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-000089c0: 733a 2064 6963 745b 4861 7368 6162 6c65  s: dict[Hashable
-000089d0: 2c20 5661 7269 6162 6c65 5d2c 0a20 2020  , Variable],.   
-000089e0: 2020 2020 2063 6f6f 7264 5f6e 616d 6573       coord_names
-000089f0: 3a20 7365 7420 7c20 4e6f 6e65 203d 204e  : set | None = N
-00008a00: 6f6e 652c 0a20 2020 2020 2020 2064 696d  one,.        dim
-00008a10: 733a 2064 6963 745b 4861 7368 6162 6c65  s: dict[Hashable
-00008a20: 2c20 696e 745d 207c 204e 6f6e 6520 3d20  , int] | None = 
-00008a30: 4e6f 6e65 2c0a 2020 2020 2020 2020 6174  None,.        at
-00008a40: 7472 733a 2064 6963 745b 4861 7368 6162  trs: dict[Hashab
-00008a50: 6c65 2c20 416e 795d 207c 204e 6f6e 6520  le, Any] | None 
-00008a60: 7c20 4465 6661 756c 7420 3d20 5f64 6566  | Default = _def
-00008a70: 6175 6c74 2c0a 2020 2020 2020 2020 696e  ault,.        in
-00008a80: 706c 6163 653a 2062 6f6f 6c20 3d20 4661  place: bool = Fa
-00008a90: 6c73 652c 0a20 2020 2029 202d 3e20 545f  lse,.    ) -> T_
-00008aa0: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
-00008ab0: 2022 2222 4465 7072 6563 6174 6564 2076   """Deprecated v
-00008ac0: 6572 7369 6f6e 206f 6620 5f72 6570 6c61  ersion of _repla
-00008ad0: 6365 5f77 6974 685f 6e65 775f 6469 6d73  ce_with_new_dims
-00008ae0: 2829 2e0a 0a20 2020 2020 2020 2055 6e6c  ()...        Unl
-00008af0: 696b 6520 5f72 6570 6c61 6365 5f77 6974  ike _replace_wit
-00008b00: 685f 6e65 775f 6469 6d73 2829 2c20 7468  h_new_dims(), th
-00008b10: 6973 206d 6574 686f 6420 616c 7761 7973  is method always
-00008b20: 2072 6563 616c 6375 6c61 7465 730a 2020   recalculates.  
-00008b30: 2020 2020 2020 696e 6465 7865 7320 6672        indexes fr
-00008b40: 6f6d 2076 6172 6961 626c 6573 2e0a 2020  om variables..  
-00008b50: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00008b60: 2020 6966 2064 696d 7320 6973 204e 6f6e    if dims is Non
-00008b70: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-00008b80: 696d 7320 3d20 6361 6c63 756c 6174 655f  ims = calculate_
-00008b90: 6469 6d65 6e73 696f 6e73 2876 6172 6961  dimensions(varia
-00008ba0: 626c 6573 290a 2020 2020 2020 2020 7265  bles).        re
-00008bb0: 7475 726e 2073 656c 662e 5f72 6570 6c61  turn self._repla
-00008bc0: 6365 280a 2020 2020 2020 2020 2020 2020  ce(.            
-00008bd0: 7661 7269 6162 6c65 732c 2063 6f6f 7264  variables, coord
-00008be0: 5f6e 616d 6573 2c20 6469 6d73 2c20 6174  _names, dims, at
-00008bf0: 7472 732c 2069 6e64 6578 6573 3d4e 6f6e  trs, indexes=Non
-00008c00: 652c 2069 6e70 6c61 6365 3d69 6e70 6c61  e, inplace=inpla
-00008c10: 6365 0a20 2020 2020 2020 2029 0a0a 2020  ce.        )..  
-00008c20: 2020 6465 6620 5f6f 7665 7277 7269 7465    def _overwrite
-00008c30: 5f69 6e64 6578 6573 280a 2020 2020 2020  _indexes(.      
-00008c40: 2020 7365 6c66 3a20 545f 4461 7461 7365    self: T_Datase
-00008c50: 742c 0a20 2020 2020 2020 2069 6e64 6578  t,.        index
-00008c60: 6573 3a20 4d61 7070 696e 675b 4861 7368  es: Mapping[Hash
-00008c70: 6162 6c65 2c20 496e 6465 785d 2c0a 2020  able, Index],.  
-00008c80: 2020 2020 2020 7661 7269 6162 6c65 733a        variables:
-00008c90: 204d 6170 7069 6e67 5b48 6173 6861 626c   Mapping[Hashabl
-00008ca0: 652c 2056 6172 6961 626c 655d 207c 204e  e, Variable] | N
-00008cb0: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-00008cc0: 2020 2020 6472 6f70 5f76 6172 6961 626c      drop_variabl
-00008cd0: 6573 3a20 6c69 7374 5b48 6173 6861 626c  es: list[Hashabl
-00008ce0: 655d 207c 204e 6f6e 6520 3d20 4e6f 6e65  e] | None = None
-00008cf0: 2c0a 2020 2020 2020 2020 6472 6f70 5f69  ,.        drop_i
-00008d00: 6e64 6578 6573 3a20 6c69 7374 5b48 6173  ndexes: list[Has
-00008d10: 6861 626c 655d 207c 204e 6f6e 6520 3d20  hable] | None = 
-00008d20: 4e6f 6e65 2c0a 2020 2020 2020 2020 7265  None,.        re
-00008d30: 6e61 6d65 5f64 696d 733a 204d 6170 7069  name_dims: Mappi
-00008d40: 6e67 5b48 6173 6861 626c 652c 2048 6173  ng[Hashable, Has
-00008d50: 6861 626c 655d 207c 204e 6f6e 6520 3d20  hable] | None = 
-00008d60: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2054  None,.    ) -> T
-00008d70: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
-00008d80: 2020 2222 224d 6179 6265 2072 6570 6c61    """Maybe repla
-00008d90: 6365 2069 6e64 6578 6573 2e0a 0a20 2020  ce indexes...   
-00008da0: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
-00008db0: 6f6e 206d 6179 2064 6f20 6120 6c6f 7420  on may do a lot 
-00008dc0: 6d6f 7265 2064 6570 656e 6469 6e67 206f  more depending o
-00008dd0: 6e20 696e 6465 7820 7175 6572 790a 2020  n index query.  
-00008de0: 2020 2020 2020 7265 7375 6c74 732e 0a0a        results...
-00008df0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00008e00: 2020 2020 6966 206e 6f74 2069 6e64 6578      if not index
-00008e10: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00008e20: 7265 7475 726e 2073 656c 660a 0a20 2020  return self..   
-00008e30: 2020 2020 2069 6620 7661 7269 6162 6c65       if variable
-00008e40: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-00008e50: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-00008e60: 203d 207b 7d0a 2020 2020 2020 2020 6966   = {}.        if
-00008e70: 2064 726f 705f 7661 7269 6162 6c65 7320   drop_variables 
-00008e80: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00008e90: 2020 2020 2064 726f 705f 7661 7269 6162       drop_variab
-00008ea0: 6c65 7320 3d20 5b5d 0a20 2020 2020 2020  les = [].       
-00008eb0: 2069 6620 6472 6f70 5f69 6e64 6578 6573   if drop_indexes
-00008ec0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00008ed0: 2020 2020 2020 6472 6f70 5f69 6e64 6578        drop_index
-00008ee0: 6573 203d 205b 5d0a 0a20 2020 2020 2020  es = []..       
-00008ef0: 206e 6577 5f76 6172 6961 626c 6573 203d   new_variables =
-00008f00: 2073 656c 662e 5f76 6172 6961 626c 6573   self._variables
-00008f10: 2e63 6f70 7928 290a 2020 2020 2020 2020  .copy().        
-00008f20: 6e65 775f 636f 6f72 645f 6e61 6d65 7320  new_coord_names 
-00008f30: 3d20 7365 6c66 2e5f 636f 6f72 645f 6e61  = self._coord_na
-00008f40: 6d65 732e 636f 7079 2829 0a20 2020 2020  mes.copy().     
-00008f50: 2020 206e 6577 5f69 6e64 6578 6573 203d     new_indexes =
-00008f60: 2064 6963 7428 7365 6c66 2e5f 696e 6465   dict(self._inde
-00008f70: 7865 7329 0a0a 2020 2020 2020 2020 696e  xes)..        in
-00008f80: 6465 785f 7661 7269 6162 6c65 7320 3d20  dex_variables = 
-00008f90: 7b7d 0a20 2020 2020 2020 206e 6f5f 696e  {}.        no_in
-00008fa0: 6465 785f 7661 7269 6162 6c65 7320 3d20  dex_variables = 
-00008fb0: 7b7d 0a20 2020 2020 2020 2066 6f72 206e  {}.        for n
-00008fc0: 616d 652c 2076 6172 2069 6e20 7661 7269  ame, var in vari
-00008fd0: 6162 6c65 732e 6974 656d 7328 293a 0a20  ables.items():. 
-00008fe0: 2020 2020 2020 2020 2020 206f 6c64 5f76             old_v
-00008ff0: 6172 203d 2073 656c 662e 5f76 6172 6961  ar = self._varia
-00009000: 626c 6573 2e67 6574 286e 616d 6529 0a20  bles.get(name). 
-00009010: 2020 2020 2020 2020 2020 2069 6620 6f6c             if ol
-00009020: 645f 7661 7220 6973 206e 6f74 204e 6f6e  d_var is not Non
-00009030: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00009040: 2020 2076 6172 2e61 7474 7273 2e75 7064     var.attrs.upd
-00009050: 6174 6528 6f6c 645f 7661 722e 6174 7472  ate(old_var.attr
-00009060: 7329 0a20 2020 2020 2020 2020 2020 2020  s).             
-00009070: 2020 2076 6172 2e65 6e63 6f64 696e 672e     var.encoding.
-00009080: 7570 6461 7465 286f 6c64 5f76 6172 2e65  update(old_var.e
-00009090: 6e63 6f64 696e 6729 0a20 2020 2020 2020  ncoding).       
-000090a0: 2020 2020 2069 6620 6e61 6d65 2069 6e20       if name in 
-000090b0: 696e 6465 7865 733a 0a20 2020 2020 2020  indexes:.       
-000090c0: 2020 2020 2020 2020 2069 6e64 6578 5f76           index_v
-000090d0: 6172 6961 626c 6573 5b6e 616d 655d 203d  ariables[name] =
-000090e0: 2076 6172 0a20 2020 2020 2020 2020 2020   var.           
-000090f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00009100: 2020 2020 2020 206e 6f5f 696e 6465 785f         no_index_
-00009110: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
-00009120: 3d20 7661 720a 0a20 2020 2020 2020 2066  = var..        f
-00009130: 6f72 206e 616d 6520 696e 2069 6e64 6578  or name in index
-00009140: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00009150: 6e65 775f 696e 6465 7865 735b 6e61 6d65  new_indexes[name
-00009160: 5d20 3d20 696e 6465 7865 735b 6e61 6d65  ] = indexes[name
-00009170: 5d0a 0a20 2020 2020 2020 2066 6f72 206e  ]..        for n
-00009180: 616d 652c 2076 6172 2069 6e20 696e 6465  ame, var in inde
-00009190: 785f 7661 7269 6162 6c65 732e 6974 656d  x_variables.item
-000091a0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-000091b0: 206e 6577 5f63 6f6f 7264 5f6e 616d 6573   new_coord_names
-000091c0: 2e61 6464 286e 616d 6529 0a20 2020 2020  .add(name).     
-000091d0: 2020 2020 2020 206e 6577 5f76 6172 6961         new_varia
-000091e0: 626c 6573 5b6e 616d 655d 203d 2076 6172  bles[name] = var
-000091f0: 0a0a 2020 2020 2020 2020 2320 6170 7065  ..        # appe
-00009200: 6e64 206e 6f2d 696e 6465 7820 7661 7269  nd no-index vari
-00009210: 6162 6c65 7320 6174 2074 6865 2065 6e64  ables at the end
-00009220: 0a20 2020 2020 2020 2066 6f72 206b 2069  .        for k i
-00009230: 6e20 6e6f 5f69 6e64 6578 5f76 6172 6961  n no_index_varia
-00009240: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
-00009250: 2020 6e65 775f 7661 7269 6162 6c65 732e    new_variables.
-00009260: 706f 7028 6b29 0a20 2020 2020 2020 206e  pop(k).        n
-00009270: 6577 5f76 6172 6961 626c 6573 2e75 7064  ew_variables.upd
-00009280: 6174 6528 6e6f 5f69 6e64 6578 5f76 6172  ate(no_index_var
-00009290: 6961 626c 6573 290a 0a20 2020 2020 2020  iables)..       
-000092a0: 2066 6f72 206e 616d 6520 696e 2064 726f   for name in dro
-000092b0: 705f 696e 6465 7865 733a 0a20 2020 2020  p_indexes:.     
-000092c0: 2020 2020 2020 206e 6577 5f69 6e64 6578         new_index
-000092d0: 6573 2e70 6f70 286e 616d 6529 0a0a 2020  es.pop(name)..  
-000092e0: 2020 2020 2020 666f 7220 6e61 6d65 2069        for name i
-000092f0: 6e20 6472 6f70 5f76 6172 6961 626c 6573  n drop_variables
-00009300: 3a0a 2020 2020 2020 2020 2020 2020 6e65  :.            ne
-00009310: 775f 7661 7269 6162 6c65 732e 706f 7028  w_variables.pop(
-00009320: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
-00009330: 2020 6e65 775f 696e 6465 7865 732e 706f    new_indexes.po
-00009340: 7028 6e61 6d65 2c20 4e6f 6e65 290a 2020  p(name, None).  
-00009350: 2020 2020 2020 2020 2020 6e65 775f 636f            new_co
-00009360: 6f72 645f 6e61 6d65 732e 7265 6d6f 7665  ord_names.remove
-00009370: 286e 616d 6529 0a0a 2020 2020 2020 2020  (name)..        
-00009380: 7265 706c 6163 6564 203d 2073 656c 662e  replaced = self.
-00009390: 5f72 6570 6c61 6365 280a 2020 2020 2020  _replace(.      
-000093a0: 2020 2020 2020 7661 7269 6162 6c65 733d        variables=
-000093b0: 6e65 775f 7661 7269 6162 6c65 732c 2063  new_variables, c
-000093c0: 6f6f 7264 5f6e 616d 6573 3d6e 6577 5f63  oord_names=new_c
-000093d0: 6f6f 7264 5f6e 616d 6573 2c20 696e 6465  oord_names, inde
-000093e0: 7865 733d 6e65 775f 696e 6465 7865 730a  xes=new_indexes.
-000093f0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00009400: 2020 2069 6620 7265 6e61 6d65 5f64 696d     if rename_dim
-00009410: 733a 0a20 2020 2020 2020 2020 2020 2023  s:.            #
-00009420: 2073 6b69 7020 7265 6e61 6d65 2069 6e64   skip rename ind
-00009430: 6578 6573 3a20 7468 6579 2073 686f 756c  exes: they shoul
-00009440: 6420 616c 7265 6164 7920 6861 7665 2074  d already have t
-00009450: 6865 2072 6967 6874 206e 616d 6528 7329  he right name(s)
-00009460: 0a20 2020 2020 2020 2020 2020 2064 696d  .            dim
-00009470: 7320 3d20 7265 706c 6163 6564 2e5f 7265  s = replaced._re
-00009480: 6e61 6d65 5f64 696d 7328 7265 6e61 6d65  name_dims(rename
-00009490: 5f64 696d 7329 0a20 2020 2020 2020 2020  _dims).         
-000094a0: 2020 206e 6577 5f76 6172 6961 626c 6573     new_variables
-000094b0: 2c20 6e65 775f 636f 6f72 645f 6e61 6d65  , new_coord_name
-000094c0: 7320 3d20 7265 706c 6163 6564 2e5f 7265  s = replaced._re
-000094d0: 6e61 6d65 5f76 6172 7328 7b7d 2c20 7265  name_vars({}, re
-000094e0: 6e61 6d65 5f64 696d 7329 0a20 2020 2020  name_dims).     
-000094f0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-00009500: 706c 6163 6564 2e5f 7265 706c 6163 6528  placed._replace(
-00009510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009520: 2076 6172 6961 626c 6573 3d6e 6577 5f76   variables=new_v
-00009530: 6172 6961 626c 6573 2c20 636f 6f72 645f  ariables, coord_
-00009540: 6e61 6d65 733d 6e65 775f 636f 6f72 645f  names=new_coord_
-00009550: 6e61 6d65 732c 2064 696d 733d 6469 6d73  names, dims=dims
-00009560: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00009570: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00009580: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-00009590: 7265 706c 6163 6564 0a0a 2020 2020 6465  replaced..    de
-000095a0: 6620 636f 7079 280a 2020 2020 2020 2020  f copy(.        
-000095b0: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
-000095c0: 2064 6565 703a 2062 6f6f 6c20 3d20 4661   deep: bool = Fa
-000095d0: 6c73 652c 2064 6174 613a 204d 6170 7069  lse, data: Mappi
-000095e0: 6e67 5b41 6e79 2c20 4172 7261 794c 696b  ng[Any, ArrayLik
-000095f0: 655d 207c 204e 6f6e 6520 3d20 4e6f 6e65  e] | None = None
-00009600: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
-00009610: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
-00009620: 5265 7475 726e 7320 6120 636f 7079 206f  Returns a copy o
-00009630: 6620 7468 6973 2064 6174 6173 6574 2e0a  f this dataset..
-00009640: 0a20 2020 2020 2020 2049 6620 6064 6565  .        If `dee
-00009650: 703d 5472 7565 602c 2061 2064 6565 7020  p=True`, a deep 
-00009660: 636f 7079 2069 7320 6d61 6465 206f 6620  copy is made of 
-00009670: 6561 6368 206f 6620 7468 6520 636f 6d70  each of the comp
-00009680: 6f6e 656e 7420 7661 7269 6162 6c65 732e  onent variables.
-00009690: 0a20 2020 2020 2020 204f 7468 6572 7769  .        Otherwi
-000096a0: 7365 2c20 6120 7368 616c 6c6f 7720 636f  se, a shallow co
-000096b0: 7079 206f 6620 6561 6368 206f 6620 7468  py of each of th
-000096c0: 6520 636f 6d70 6f6e 656e 7420 7661 7269  e component vari
-000096d0: 6162 6c65 2069 7320 6d61 6465 2c20 736f  able is made, so
-000096e0: 0a20 2020 2020 2020 2074 6861 7420 7468  .        that th
-000096f0: 6520 756e 6465 726c 7969 6e67 206d 656d  e underlying mem
-00009700: 6f72 7920 7265 6769 6f6e 206f 6620 7468  ory region of th
-00009710: 6520 6e65 7720 6461 7461 7365 7420 6973  e new dataset is
-00009720: 2074 6865 2073 616d 6520 6173 2069 6e0a   the same as in.
-00009730: 2020 2020 2020 2020 7468 6520 6f72 6967          the orig
-00009740: 696e 616c 2064 6174 6173 6574 2e0a 0a20  inal dataset... 
-00009750: 2020 2020 2020 2055 7365 2060 6461 7461         Use `data
-00009760: 6020 746f 2063 7265 6174 6520 6120 6e65  ` to create a ne
-00009770: 7720 6f62 6a65 6374 2077 6974 6820 7468  w object with th
-00009780: 6520 7361 6d65 2073 7472 7563 7475 7265  e same structure
-00009790: 2061 730a 2020 2020 2020 2020 6f72 6967   as.        orig
-000097a0: 696e 616c 2062 7574 2065 6e74 6972 656c  inal but entirel
-000097b0: 7920 6e65 7720 6461 7461 2e0a 0a20 2020  y new data...   
-000097c0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-000097d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000097e0: 2d2d 0a20 2020 2020 2020 2064 6565 7020  --.        deep 
-000097f0: 3a20 626f 6f6c 2c20 6465 6661 756c 743a  : bool, default:
-00009800: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-00009810: 2020 2057 6865 7468 6572 2065 6163 6820     Whether each 
-00009820: 636f 6d70 6f6e 656e 7420 7661 7269 6162  component variab
-00009830: 6c65 2069 7320 6c6f 6164 6564 2069 6e74  le is loaded int
-00009840: 6f20 6d65 6d6f 7279 2061 6e64 2063 6f70  o memory and cop
-00009850: 6965 6420 6f6e 746f 0a20 2020 2020 2020  ied onto.       
-00009860: 2020 2020 2074 6865 206e 6577 206f 626a       the new obj
-00009870: 6563 742e 2044 6566 6175 6c74 2069 7320  ect. Default is 
-00009880: 4661 6c73 652e 0a20 2020 2020 2020 2064  False..        d
-00009890: 6174 6120 3a20 6469 6374 2d6c 696b 6520  ata : dict-like 
-000098a0: 6f72 204e 6f6e 652c 206f 7074 696f 6e61  or None, optiona
-000098b0: 6c0a 2020 2020 2020 2020 2020 2020 4461  l.            Da
-000098c0: 7461 2074 6f20 7573 6520 696e 2074 6865  ta to use in the
-000098d0: 206e 6577 206f 626a 6563 742e 2045 6163   new object. Eac
-000098e0: 6820 6974 656d 2069 6e20 6064 6174 6160  h item in `data`
-000098f0: 206d 7573 7420 6861 7665 2073 616d 650a   must have same.
-00009900: 2020 2020 2020 2020 2020 2020 7368 6170              shap
-00009910: 6520 6173 2063 6f72 7265 7370 6f6e 6469  e as correspondi
-00009920: 6e67 2064 6174 6120 7661 7269 6162 6c65  ng data variable
-00009930: 2069 6e20 6f72 6967 696e 616c 2e20 5768   in original. Wh
-00009940: 656e 2060 6461 7461 6020 6973 0a20 2020  en `data` is.   
-00009950: 2020 2020 2020 2020 2075 7365 642c 2060           used, `
-00009960: 6465 6570 6020 6973 2069 676e 6f72 6564  deep` is ignored
-00009970: 2066 6f72 2074 6865 2064 6174 6120 7661   for the data va
-00009980: 7269 6162 6c65 7320 616e 6420 6f6e 6c79  riables and only
-00009990: 2075 7365 6420 666f 720a 2020 2020 2020   used for.      
-000099a0: 2020 2020 2020 636f 6f72 6473 2e0a 0a20        coords... 
-000099b0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-000099c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-000099d0: 2020 2020 2020 206f 626a 6563 7420 3a20         object : 
-000099e0: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
-000099f0: 2020 2020 4e65 7720 6f62 6a65 6374 2077      New object w
-00009a00: 6974 6820 6469 6d65 6e73 696f 6e73 2c20  ith dimensions, 
-00009a10: 6174 7472 6962 7574 6573 2c20 636f 6f72  attributes, coor
-00009a20: 6469 6e61 7465 732c 206e 616d 652c 2065  dinates, name, e
-00009a30: 6e63 6f64 696e 672c 0a20 2020 2020 2020  ncoding,.       
-00009a40: 2020 2020 2061 6e64 206f 7074 696f 6e61       and optiona
-00009a50: 6c6c 7920 6461 7461 2063 6f70 6965 6420  lly data copied 
-00009a60: 6672 6f6d 206f 7269 6769 6e61 6c2e 0a0a  from original...
-00009a70: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-00009a80: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00009a90: 2d0a 2020 2020 2020 2020 5368 616c 6c6f  -.        Shallo
-00009aa0: 7720 636f 7079 2076 6572 7375 7320 6465  w copy versus de
-00009ab0: 6570 2063 6f70 790a 0a20 2020 2020 2020  ep copy..       
-00009ac0: 203e 3e3e 2064 6120 3d20 7872 2e44 6174   >>> da = xr.Dat
-00009ad0: 6141 7272 6179 286e 702e 7261 6e64 6f6d  aArray(np.random
-00009ae0: 2e72 616e 646e 2832 2c20 3329 290a 2020  .randn(2, 3)).  
-00009af0: 2020 2020 2020 3e3e 3e20 6473 203d 2078        >>> ds = x
-00009b00: 722e 4461 7461 7365 7428 0a20 2020 2020  r.Dataset(.     
-00009b10: 2020 202e 2e2e 2020 2020 207b 2266 6f6f     ...     {"foo
-00009b20: 223a 2064 612c 2022 6261 7222 3a20 2822  ": da, "bar": ("
-00009b30: 7822 2c20 5b2d 312c 2032 5d29 7d2c 0a20  x", [-1, 2])},. 
-00009b40: 2020 2020 2020 202e 2e2e 2020 2020 2063         ...     c
-00009b50: 6f6f 7264 733d 7b22 7822 3a20 5b22 6f6e  oords={"x": ["on
-00009b60: 6522 2c20 2274 776f 225d 7d2c 0a20 2020  e", "two"]},.   
-00009b70: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
-00009b80: 2020 203e 3e3e 2064 732e 636f 7079 2829     >>> ds.copy()
-00009b90: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
-00009ba0: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
-00009bb0: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
-00009bc0: 6469 6d5f 303a 2032 2c20 6469 6d5f 313a  dim_0: 2, dim_1:
-00009bd0: 2033 2c20 783a 2032 290a 2020 2020 2020   3, x: 2).      
-00009be0: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
-00009bf0: 2020 2020 2020 2020 202a 2078 2020 2020           * x    
-00009c00: 2020 2020 2878 2920 3c55 3320 276f 6e65      (x) <U3 'one
-00009c10: 2720 2774 776f 270a 2020 2020 2020 2020  ' 'two'.        
-00009c20: 4469 6d65 6e73 696f 6e73 2077 6974 686f  Dimensions witho
-00009c30: 7574 2063 6f6f 7264 696e 6174 6573 3a20  ut coordinates: 
-00009c40: 6469 6d5f 302c 2064 696d 5f31 0a20 2020  dim_0, dim_1.   
-00009c50: 2020 2020 2044 6174 6120 7661 7269 6162       Data variab
-00009c60: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
-00009c70: 2066 6f6f 2020 2020 2020 2864 696d 5f30   foo      (dim_0
-00009c80: 2c20 6469 6d5f 3129 2066 6c6f 6174 3634  , dim_1) float64
-00009c90: 2031 2e37 3634 2030 2e34 3030 3220 302e   1.764 0.4002 0.
-00009ca0: 3937 3837 2032 2e32 3431 2031 2e38 3638  9787 2.241 1.868
-00009cb0: 202d 302e 3937 3733 0a20 2020 2020 2020   -0.9773.       
-00009cc0: 2020 2020 2062 6172 2020 2020 2020 2878       bar      (x
-00009cd0: 2920 696e 7436 3420 2d31 2032 0a0a 2020  ) int64 -1 2..  
-00009ce0: 2020 2020 2020 3e3e 3e20 6473 5f30 203d        >>> ds_0 =
-00009cf0: 2064 732e 636f 7079 2864 6565 703d 4661   ds.copy(deep=Fa
-00009d00: 6c73 6529 0a20 2020 2020 2020 203e 3e3e  lse).        >>>
-00009d10: 2064 735f 305b 2266 6f6f 225d 5b30 2c20   ds_0["foo"][0, 
-00009d20: 305d 203d 2037 0a20 2020 2020 2020 203e  0] = 7.        >
-00009d30: 3e3e 2064 735f 300a 2020 2020 2020 2020  >> ds_0.        
-00009d40: 3c78 6172 7261 792e 4461 7461 7365 743e  <xarray.Dataset>
-00009d50: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
-00009d60: 6f6e 733a 2020 2864 696d 5f30 3a20 322c  ons:  (dim_0: 2,
-00009d70: 2064 696d 5f31 3a20 332c 2078 3a20 3229   dim_1: 3, x: 2)
-00009d80: 0a20 2020 2020 2020 2043 6f6f 7264 696e  .        Coordin
-00009d90: 6174 6573 3a0a 2020 2020 2020 2020 2020  ates:.          
-00009da0: 2a20 7820 2020 2020 2020 2028 7829 203c  * x        (x) <
-00009db0: 5533 2027 6f6e 6527 2027 7477 6f27 0a20  U3 'one' 'two'. 
-00009dc0: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
-00009dd0: 7320 7769 7468 6f75 7420 636f 6f72 6469  s without coordi
-00009de0: 6e61 7465 733a 2064 696d 5f30 2c20 6469  nates: dim_0, di
-00009df0: 6d5f 310a 2020 2020 2020 2020 4461 7461  m_1.        Data
-00009e00: 2076 6172 6961 626c 6573 3a0a 2020 2020   variables:.    
-00009e10: 2020 2020 2020 2020 666f 6f20 2020 2020          foo     
-00009e20: 2028 6469 6d5f 302c 2064 696d 5f31 2920   (dim_0, dim_1) 
-00009e30: 666c 6f61 7436 3420 372e 3020 302e 3430  float64 7.0 0.40
-00009e40: 3032 2030 2e39 3738 3720 322e 3234 3120  02 0.9787 2.241 
-00009e50: 312e 3836 3820 2d30 2e39 3737 330a 2020  1.868 -0.9773.  
-00009e60: 2020 2020 2020 2020 2020 6261 7220 2020            bar   
-00009e70: 2020 2028 7829 2069 6e74 3634 202d 3120     (x) int64 -1 
-00009e80: 320a 0a20 2020 2020 2020 203e 3e3e 2064  2..        >>> d
-00009e90: 730a 2020 2020 2020 2020 3c78 6172 7261  s.        <xarra
-00009ea0: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
-00009eb0: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
-00009ec0: 2864 696d 5f30 3a20 322c 2064 696d 5f31  (dim_0: 2, dim_1
-00009ed0: 3a20 332c 2078 3a20 3229 0a20 2020 2020  : 3, x: 2).     
-00009ee0: 2020 2043 6f6f 7264 696e 6174 6573 3a0a     Coordinates:.
-00009ef0: 2020 2020 2020 2020 2020 2a20 7820 2020            * x   
-00009f00: 2020 2020 2028 7829 203c 5533 2027 6f6e       (x) <U3 'on
-00009f10: 6527 2027 7477 6f27 0a20 2020 2020 2020  e' 'two'.       
-00009f20: 2044 696d 656e 7369 6f6e 7320 7769 7468   Dimensions with
-00009f30: 6f75 7420 636f 6f72 6469 6e61 7465 733a  out coordinates:
-00009f40: 2064 696d 5f30 2c20 6469 6d5f 310a 2020   dim_0, dim_1.  
-00009f50: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
-00009f60: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
-00009f70: 2020 666f 6f20 2020 2020 2028 6469 6d5f    foo      (dim_
-00009f80: 302c 2064 696d 5f31 2920 666c 6f61 7436  0, dim_1) float6
-00009f90: 3420 372e 3020 302e 3430 3032 2030 2e39  4 7.0 0.4002 0.9
-00009fa0: 3738 3720 322e 3234 3120 312e 3836 3820  787 2.241 1.868 
-00009fb0: 2d30 2e39 3737 330a 2020 2020 2020 2020  -0.9773.        
-00009fc0: 2020 2020 6261 7220 2020 2020 2028 7829      bar      (x)
-00009fd0: 2069 6e74 3634 202d 3120 320a 0a20 2020   int64 -1 2..   
-00009fe0: 2020 2020 2043 6861 6e67 696e 6720 7468       Changing th
-00009ff0: 6520 6461 7461 2075 7369 6e67 2074 6865  e data using the
-0000a000: 2060 6064 6174 6160 6020 6172 6775 6d65   ``data`` argume
-0000a010: 6e74 206d 6169 6e74 6169 6e73 2074 6865  nt maintains the
-0000a020: 0a20 2020 2020 2020 2073 7472 7563 7475  .        structu
-0000a030: 7265 206f 6620 7468 6520 6f72 6967 696e  re of the origin
-0000a040: 616c 206f 626a 6563 742c 2062 7574 2077  al object, but w
-0000a050: 6974 6820 7468 6520 6e65 7720 6461 7461  ith the new data
-0000a060: 2e20 4f72 6967 696e 616c 0a20 2020 2020  . Original.     
-0000a070: 2020 206f 626a 6563 7420 6973 2075 6e61     object is una
-0000a080: 6666 6563 7465 642e 0a0a 2020 2020 2020  ffected...      
-0000a090: 2020 3e3e 3e20 6473 2e63 6f70 7928 6461    >>> ds.copy(da
-0000a0a0: 7461 3d7b 2266 6f6f 223a 206e 702e 6172  ta={"foo": np.ar
-0000a0b0: 616e 6765 2836 292e 7265 7368 6170 6528  ange(6).reshape(
-0000a0c0: 322c 2033 292c 2022 6261 7222 3a20 5b22  2, 3), "bar": ["
-0000a0d0: 6122 2c20 2262 225d 7d29 0a20 2020 2020  a", "b"]}).     
-0000a0e0: 2020 203c 7861 7272 6179 2e44 6174 6173     <xarray.Datas
-0000a0f0: 6574 3e0a 2020 2020 2020 2020 4469 6d65  et>.        Dime
-0000a100: 6e73 696f 6e73 3a20 2028 6469 6d5f 303a  nsions:  (dim_0:
-0000a110: 2032 2c20 6469 6d5f 313a 2033 2c20 783a   2, dim_1: 3, x:
-0000a120: 2032 290a 2020 2020 2020 2020 436f 6f72   2).        Coor
-0000a130: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
-0000a140: 2020 202a 2078 2020 2020 2020 2020 2878     * x        (x
-0000a150: 2920 3c55 3320 276f 6e65 2720 2774 776f  ) <U3 'one' 'two
-0000a160: 270a 2020 2020 2020 2020 4469 6d65 6e73  '.        Dimens
-0000a170: 696f 6e73 2077 6974 686f 7574 2063 6f6f  ions without coo
-0000a180: 7264 696e 6174 6573 3a20 6469 6d5f 302c  rdinates: dim_0,
-0000a190: 2064 696d 5f31 0a20 2020 2020 2020 2044   dim_1.        D
-0000a1a0: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
-0000a1b0: 2020 2020 2020 2020 2020 2066 6f6f 2020             foo  
-0000a1c0: 2020 2020 2864 696d 5f30 2c20 6469 6d5f      (dim_0, dim_
-0000a1d0: 3129 2069 6e74 3634 2030 2031 2032 2033  1) int64 0 1 2 3
-0000a1e0: 2034 2035 0a20 2020 2020 2020 2020 2020   4 5.           
-0000a1f0: 2062 6172 2020 2020 2020 2878 2920 3c55   bar      (x) <U
-0000a200: 3120 2761 2720 2762 270a 0a20 2020 2020  1 'a' 'b'..     
-0000a210: 2020 203e 3e3e 2064 730a 2020 2020 2020     >>> ds.      
-0000a220: 2020 3c78 6172 7261 792e 4461 7461 7365    <xarray.Datase
-0000a230: 743e 0a20 2020 2020 2020 2044 696d 656e  t>.        Dimen
-0000a240: 7369 6f6e 733a 2020 2864 696d 5f30 3a20  sions:  (dim_0: 
-0000a250: 322c 2064 696d 5f31 3a20 332c 2078 3a20  2, dim_1: 3, x: 
-0000a260: 3229 0a20 2020 2020 2020 2043 6f6f 7264  2).        Coord
-0000a270: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
-0000a280: 2020 2a20 7820 2020 2020 2020 2028 7829    * x        (x)
-0000a290: 203c 5533 2027 6f6e 6527 2027 7477 6f27   <U3 'one' 'two'
-0000a2a0: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
-0000a2b0: 6f6e 7320 7769 7468 6f75 7420 636f 6f72  ons without coor
-0000a2c0: 6469 6e61 7465 733a 2064 696d 5f30 2c20  dinates: dim_0, 
-0000a2d0: 6469 6d5f 310a 2020 2020 2020 2020 4461  dim_1.        Da
-0000a2e0: 7461 2076 6172 6961 626c 6573 3a0a 2020  ta variables:.  
-0000a2f0: 2020 2020 2020 2020 2020 666f 6f20 2020            foo   
-0000a300: 2020 2028 6469 6d5f 302c 2064 696d 5f31     (dim_0, dim_1
-0000a310: 2920 666c 6f61 7436 3420 372e 3020 302e  ) float64 7.0 0.
-0000a320: 3430 3032 2030 2e39 3738 3720 322e 3234  4002 0.9787 2.24
-0000a330: 3120 312e 3836 3820 2d30 2e39 3737 330a  1 1.868 -0.9773.
-0000a340: 2020 2020 2020 2020 2020 2020 6261 7220              bar 
-0000a350: 2020 2020 2028 7829 2069 6e74 3634 202d       (x) int64 -
-0000a360: 3120 320a 0a20 2020 2020 2020 2053 6565  1 2..        See
-0000a370: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-0000a380: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2070  ------.        p
-0000a390: 616e 6461 732e 4461 7461 4672 616d 652e  andas.DataFrame.
-0000a3a0: 636f 7079 0a20 2020 2020 2020 2022 2222  copy.        """
-0000a3b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000a3c0: 7365 6c66 2e5f 636f 7079 2864 6565 703d  self._copy(deep=
-0000a3d0: 6465 6570 2c20 6461 7461 3d64 6174 6129  deep, data=data)
-0000a3e0: 0a0a 2020 2020 6465 6620 5f63 6f70 7928  ..    def _copy(
-0000a3f0: 0a20 2020 2020 2020 2073 656c 663a 2054  .        self: T
-0000a400: 5f44 6174 6173 6574 2c0a 2020 2020 2020  _Dataset,.      
-0000a410: 2020 6465 6570 3a20 626f 6f6c 203d 2046    deep: bool = F
-0000a420: 616c 7365 2c0a 2020 2020 2020 2020 6461  alse,.        da
-0000a430: 7461 3a20 4d61 7070 696e 675b 416e 792c  ta: Mapping[Any,
-0000a440: 2041 7272 6179 4c69 6b65 5d20 7c20 4e6f   ArrayLike] | No
-0000a450: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
-0000a460: 2020 206d 656d 6f3a 2064 6963 745b 696e     memo: dict[in
-0000a470: 742c 2041 6e79 5d20 7c20 4e6f 6e65 203d  t, Any] | None =
-0000a480: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
-0000a490: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
-0000a4a0: 2020 2069 6620 6461 7461 2069 7320 4e6f     if data is No
-0000a4b0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000a4c0: 6461 7461 203d 207b 7d0a 2020 2020 2020  data = {}.      
-0000a4d0: 2020 656c 6966 206e 6f74 2075 7469 6c73    elif not utils
-0000a4e0: 2e69 735f 6469 6374 5f6c 696b 6528 6461  .is_dict_like(da
-0000a4f0: 7461 293a 0a20 2020 2020 2020 2020 2020  ta):.           
-0000a500: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0000a510: 7228 2244 6174 6120 6d75 7374 2062 6520  r("Data must be 
-0000a520: 6469 6374 2d6c 696b 6522 290a 0a20 2020  dict-like")..   
-0000a530: 2020 2020 2069 6620 6461 7461 3a0a 2020       if data:.  
-0000a540: 2020 2020 2020 2020 2020 7661 725f 6b65            var_ke
-0000a550: 7973 203d 2073 6574 2873 656c 662e 6461  ys = set(self.da
-0000a560: 7461 5f76 6172 732e 6b65 7973 2829 290a  ta_vars.keys()).
-0000a570: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0000a580: 5f6b 6579 7320 3d20 7365 7428 6461 7461  _keys = set(data
-0000a590: 2e6b 6579 7328 2929 0a20 2020 2020 2020  .keys()).       
-0000a5a0: 2020 2020 206b 6579 735f 6e6f 745f 696e       keys_not_in
-0000a5b0: 5f76 6172 7320 3d20 6461 7461 5f6b 6579  _vars = data_key
-0000a5c0: 7320 2d20 7661 725f 6b65 7973 0a20 2020  s - var_keys.   
-0000a5d0: 2020 2020 2020 2020 2069 6620 6b65 7973           if keys
-0000a5e0: 5f6e 6f74 5f69 6e5f 7661 7273 3a0a 2020  _not_in_vars:.  
-0000a5f0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0000a600: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0000a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a620: 2020 2020 2244 6174 6120 6d75 7374 206f      "Data must o
-0000a630: 6e6c 7920 636f 6e74 6169 6e20 7661 7269  nly contain vari
-0000a640: 6162 6c65 7320 696e 206f 7269 6769 6e61  ables in origina
-0000a650: 6c20 220a 2020 2020 2020 2020 2020 2020  l ".            
-0000a660: 2020 2020 2020 2020 2264 6174 6173 6574          "dataset
-0000a670: 2e20 4578 7472 6120 7661 7269 6162 6c65  . Extra variable
-0000a680: 733a 207b 7d22 2e66 6f72 6d61 7428 6b65  s: {}".format(ke
-0000a690: 7973 5f6e 6f74 5f69 6e5f 7661 7273 290a  ys_not_in_vars).
-0000a6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a6b0: 290a 2020 2020 2020 2020 2020 2020 6b65  ).            ke
-0000a6c0: 7973 5f6d 6973 7369 6e67 5f66 726f 6d5f  ys_missing_from_
-0000a6d0: 6461 7461 203d 2076 6172 5f6b 6579 7320  data = var_keys 
-0000a6e0: 2d20 6461 7461 5f6b 6579 730a 2020 2020  - data_keys.    
-0000a6f0: 2020 2020 2020 2020 6966 206b 6579 735f          if keys_
-0000a700: 6d69 7373 696e 675f 6672 6f6d 5f64 6174  missing_from_dat
-0000a710: 613a 0a20 2020 2020 2020 2020 2020 2020  a:.             
-0000a720: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000a730: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0000a740: 2020 2020 2020 2020 2022 4461 7461 206d           "Data m
-0000a750: 7573 7420 636f 6e74 6169 6e20 616c 6c20  ust contain all 
-0000a760: 7661 7269 6162 6c65 7320 696e 206f 7269  variables in ori
-0000a770: 6769 6e61 6c20 220a 2020 2020 2020 2020  ginal ".        
-0000a780: 2020 2020 2020 2020 2020 2020 2264 6174              "dat
-0000a790: 6173 6574 2e20 4461 7461 2069 7320 6d69  aset. Data is mi
-0000a7a0: 7373 696e 6720 7b7d 222e 666f 726d 6174  ssing {}".format
-0000a7b0: 286b 6579 735f 6d69 7373 696e 675f 6672  (keys_missing_fr
-0000a7c0: 6f6d 5f64 6174 6129 0a20 2020 2020 2020  om_data).       
-0000a7d0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000a7e0: 2020 2020 696e 6465 7865 732c 2069 6e64      indexes, ind
-0000a7f0: 6578 5f76 6172 7320 3d20 7365 6c66 2e78  ex_vars = self.x
-0000a800: 696e 6465 7865 732e 636f 7079 5f69 6e64  indexes.copy_ind
-0000a810: 6578 6573 2864 6565 703d 6465 6570 290a  exes(deep=deep).
-0000a820: 0a20 2020 2020 2020 2076 6172 6961 626c  .        variabl
-0000a830: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
-0000a840: 666f 7220 6b2c 2076 2069 6e20 7365 6c66  for k, v in self
-0000a850: 2e5f 7661 7269 6162 6c65 732e 6974 656d  ._variables.item
-0000a860: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-0000a870: 2069 6620 6b20 696e 2069 6e64 6578 5f76   if k in index_v
-0000a880: 6172 733a 0a20 2020 2020 2020 2020 2020  ars:.           
-0000a890: 2020 2020 2076 6172 6961 626c 6573 5b6b       variables[k
-0000a8a0: 5d20 3d20 696e 6465 785f 7661 7273 5b6b  ] = index_vars[k
-0000a8b0: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-0000a8c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000a8d0: 2020 2020 7661 7269 6162 6c65 735b 6b5d      variables[k]
-0000a8e0: 203d 2076 2e5f 636f 7079 2864 6565 703d   = v._copy(deep=
-0000a8f0: 6465 6570 2c20 6461 7461 3d64 6174 612e  deep, data=data.
-0000a900: 6765 7428 6b29 2c20 6d65 6d6f 3d6d 656d  get(k), memo=mem
-0000a910: 6f29 0a0a 2020 2020 2020 2020 6174 7472  o)..        attr
-0000a920: 7320 3d20 636f 7079 2e64 6565 7063 6f70  s = copy.deepcop
-0000a930: 7928 7365 6c66 2e5f 6174 7472 732c 206d  y(self._attrs, m
-0000a940: 656d 6f29 2069 6620 6465 6570 2065 6c73  emo) if deep els
-0000a950: 6520 636f 7079 2e63 6f70 7928 7365 6c66  e copy.copy(self
-0000a960: 2e5f 6174 7472 7329 0a20 2020 2020 2020  ._attrs).       
-0000a970: 2065 6e63 6f64 696e 6720 3d20 280a 2020   encoding = (.  
-0000a980: 2020 2020 2020 2020 2020 636f 7079 2e64            copy.d
-0000a990: 6565 7063 6f70 7928 7365 6c66 2e5f 656e  eepcopy(self._en
-0000a9a0: 636f 6469 6e67 2c20 6d65 6d6f 2920 6966  coding, memo) if
-0000a9b0: 2064 6565 7020 656c 7365 2063 6f70 792e   deep else copy.
-0000a9c0: 636f 7079 2873 656c 662e 5f65 6e63 6f64  copy(self._encod
-0000a9d0: 696e 6729 0a20 2020 2020 2020 2029 0a0a  ing).        )..
-0000a9e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000a9f0: 656c 662e 5f72 6570 6c61 6365 2876 6172  elf._replace(var
-0000aa00: 6961 626c 6573 2c20 696e 6465 7865 733d  iables, indexes=
-0000aa10: 696e 6465 7865 732c 2061 7474 7273 3d61  indexes, attrs=a
-0000aa20: 7474 7273 2c20 656e 636f 6469 6e67 3d65  ttrs, encoding=e
-0000aa30: 6e63 6f64 696e 6729 0a0a 2020 2020 6465  ncoding)..    de
-0000aa40: 6620 5f5f 636f 7079 5f5f 2873 656c 663a  f __copy__(self:
-0000aa50: 2054 5f44 6174 6173 6574 2920 2d3e 2054   T_Dataset) -> T
-0000aa60: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
-0000aa70: 2020 7265 7475 726e 2073 656c 662e 5f63    return self._c
-0000aa80: 6f70 7928 6465 6570 3d46 616c 7365 290a  opy(deep=False).
-0000aa90: 0a20 2020 2064 6566 205f 5f64 6565 7063  .    def __deepc
-0000aaa0: 6f70 795f 5f28 7365 6c66 3a20 545f 4461  opy__(self: T_Da
-0000aab0: 7461 7365 742c 206d 656d 6f3a 2064 6963  taset, memo: dic
-0000aac0: 745b 696e 742c 2041 6e79 5d20 7c20 4e6f  t[int, Any] | No
-0000aad0: 6e65 203d 204e 6f6e 6529 202d 3e20 545f  ne = None) -> T_
-0000aae0: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
-0000aaf0: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
-0000ab00: 7079 2864 6565 703d 5472 7565 2c20 6d65  py(deep=True, me
-0000ab10: 6d6f 3d6d 656d 6f29 0a0a 2020 2020 6465  mo=memo)..    de
-0000ab20: 6620 6173 5f6e 756d 7079 2873 656c 663a  f as_numpy(self:
-0000ab30: 2054 5f44 6174 6173 6574 2920 2d3e 2054   T_Dataset) -> T
-0000ab40: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
-0000ab50: 2020 2222 220a 2020 2020 2020 2020 436f    """.        Co
-0000ab60: 6572 6365 7320 7772 6170 7065 6420 6461  erces wrapped da
-0000ab70: 7461 2061 6e64 2063 6f6f 7264 696e 6174  ta and coordinat
-0000ab80: 6573 2069 6e74 6f20 6e75 6d70 7920 6172  es into numpy ar
-0000ab90: 7261 7973 2c20 7265 7475 726e 696e 6720  rays, returning 
-0000aba0: 6120 4461 7461 7365 742e 0a0a 2020 2020  a Dataset...    
-0000abb0: 2020 2020 5365 6520 616c 736f 0a20 2020      See also.   
-0000abc0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-0000abd0: 2020 2020 2020 4461 7461 4172 7261 792e        DataArray.
-0000abe0: 6173 5f6e 756d 7079 0a20 2020 2020 2020  as_numpy.       
-0000abf0: 2044 6174 6141 7272 6179 2e74 6f5f 6e75   DataArray.to_nu
-0000ac00: 6d70 7920 3a20 5265 7475 726e 7320 6f6e  mpy : Returns on
-0000ac10: 6c79 2074 6865 2064 6174 6120 6173 2061  ly the data as a
-0000ac20: 206e 756d 7079 2e6e 6461 7272 6179 206f   numpy.ndarray o
-0000ac30: 626a 6563 742e 0a20 2020 2020 2020 2022  bject..        "
-0000ac40: 2222 0a20 2020 2020 2020 206e 756d 7079  "".        numpy
-0000ac50: 5f76 6172 6961 626c 6573 203d 207b 6b3a  _variables = {k:
-0000ac60: 2076 2e61 735f 6e75 6d70 7928 2920 666f   v.as_numpy() fo
-0000ac70: 7220 6b2c 2076 2069 6e20 7365 6c66 2e76  r k, v in self.v
-0000ac80: 6172 6961 626c 6573 2e69 7465 6d73 2829  ariables.items()
-0000ac90: 7d0a 2020 2020 2020 2020 7265 7475 726e  }.        return
-0000aca0: 2073 656c 662e 5f72 6570 6c61 6365 2876   self._replace(v
-0000acb0: 6172 6961 626c 6573 3d6e 756d 7079 5f76  ariables=numpy_v
-0000acc0: 6172 6961 626c 6573 290a 0a20 2020 2064  ariables)..    d
-0000acd0: 6566 205f 636f 7079 5f6c 6973 7465 6428  ef _copy_listed(
-0000ace0: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
-0000acf0: 206e 616d 6573 3a20 4974 6572 6162 6c65   names: Iterable
-0000ad00: 5b48 6173 6861 626c 655d 2920 2d3e 2054  [Hashable]) -> T
-0000ad10: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
-0000ad20: 2020 2222 2243 7265 6174 6520 6120 6e65    """Create a ne
-0000ad30: 7720 4461 7461 7365 7420 7769 7468 2074  w Dataset with t
-0000ad40: 6865 206c 6973 7465 6420 7661 7269 6162  he listed variab
-0000ad50: 6c65 7320 6672 6f6d 2074 6869 7320 6461  les from this da
-0000ad60: 7461 7365 7420 616e 640a 2020 2020 2020  taset and.      
-0000ad70: 2020 7468 6520 616c 6c20 7265 6c65 7661    the all releva
-0000ad80: 6e74 2063 6f6f 7264 696e 6174 6573 2e20  nt coordinates. 
-0000ad90: 536b 6970 7320 616c 6c20 7661 6c69 6461  Skips all valida
-0000ada0: 7469 6f6e 2e0a 2020 2020 2020 2020 2222  tion..        ""
-0000adb0: 220a 2020 2020 2020 2020 7661 7269 6162  ".        variab
-0000adc0: 6c65 733a 2064 6963 745b 4861 7368 6162  les: dict[Hashab
-0000add0: 6c65 2c20 5661 7269 6162 6c65 5d20 3d20  le, Variable] = 
-0000ade0: 7b7d 0a20 2020 2020 2020 2063 6f6f 7264  {}.        coord
-0000adf0: 5f6e 616d 6573 203d 2073 6574 2829 0a20  _names = set(). 
-0000ae00: 2020 2020 2020 2069 6e64 6578 6573 3a20         indexes: 
-0000ae10: 6469 6374 5b48 6173 6861 626c 652c 2049  dict[Hashable, I
-0000ae20: 6e64 6578 5d20 3d20 7b7d 0a0a 2020 2020  ndex] = {}..    
-0000ae30: 2020 2020 666f 7220 6e61 6d65 2069 6e20      for name in 
-0000ae40: 6e61 6d65 733a 0a20 2020 2020 2020 2020  names:.         
-0000ae50: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0000ae60: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-0000ae70: 735b 6e61 6d65 5d20 3d20 7365 6c66 2e5f  s[name] = self._
-0000ae80: 7661 7269 6162 6c65 735b 6e61 6d65 5d0a  variables[name].
-0000ae90: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0000aea0: 7074 204b 6579 4572 726f 723a 0a20 2020  pt KeyError:.   
-0000aeb0: 2020 2020 2020 2020 2020 2020 2072 6566               ref
-0000aec0: 5f6e 616d 652c 2076 6172 5f6e 616d 652c  _name, var_name,
-0000aed0: 2076 6172 203d 205f 6765 745f 7669 7274   var = _get_virt
-0000aee0: 7561 6c5f 7661 7269 6162 6c65 280a 2020  ual_variable(.  
-0000aef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000af00: 2020 7365 6c66 2e5f 7661 7269 6162 6c65    self._variable
-0000af10: 732c 206e 616d 652c 2073 656c 662e 6469  s, name, self.di
-0000af20: 6d73 0a20 2020 2020 2020 2020 2020 2020  ms.             
-0000af30: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-0000af40: 2020 2020 2076 6172 6961 626c 6573 5b76       variables[v
-0000af50: 6172 5f6e 616d 655d 203d 2076 6172 0a20  ar_name] = var. 
-0000af60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000af70: 6620 7265 665f 6e61 6d65 2069 6e20 7365  f ref_name in se
-0000af80: 6c66 2e5f 636f 6f72 645f 6e61 6d65 7320  lf._coord_names 
-0000af90: 6f72 2072 6566 5f6e 616d 6520 696e 2073  or ref_name in s
-0000afa0: 656c 662e 6469 6d73 3a0a 2020 2020 2020  elf.dims:.      
-0000afb0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000afc0: 6f72 645f 6e61 6d65 732e 6164 6428 7661  ord_names.add(va
-0000afd0: 725f 6e61 6d65 290a 2020 2020 2020 2020  r_name).        
-0000afe0: 2020 2020 2020 2020 6966 2028 7661 725f          if (var_
-0000aff0: 6e61 6d65 2c29 203d 3d20 7661 722e 6469  name,) == var.di
-0000b000: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
-0000b010: 2020 2020 2020 2020 696e 6465 782c 2069          index, i
-0000b020: 6e64 6578 5f76 6172 7320 3d20 6372 6561  ndex_vars = crea
-0000b030: 7465 5f64 6566 6175 6c74 5f69 6e64 6578  te_default_index
-0000b040: 5f69 6d70 6c69 6369 7428 7661 722c 206e  _implicit(var, n
-0000b050: 616d 6573 290a 2020 2020 2020 2020 2020  ames).          
-0000b060: 2020 2020 2020 2020 2020 696e 6465 7865            indexe
-0000b070: 732e 7570 6461 7465 287b 6b3a 2069 6e64  s.update({k: ind
-0000b080: 6578 2066 6f72 206b 2069 6e20 696e 6465  ex for k in inde
-0000b090: 785f 7661 7273 7d29 0a20 2020 2020 2020  x_vars}).       
-0000b0a0: 2020 2020 2020 2020 2020 2020 2076 6172               var
-0000b0b0: 6961 626c 6573 2e75 7064 6174 6528 696e  iables.update(in
-0000b0c0: 6465 785f 7661 7273 290a 2020 2020 2020  dex_vars).      
-0000b0d0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000b0e0: 6f72 645f 6e61 6d65 732e 7570 6461 7465  ord_names.update
-0000b0f0: 2869 6e64 6578 5f76 6172 7329 0a0a 2020  (index_vars)..  
-0000b100: 2020 2020 2020 6e65 6564 6564 5f64 696d        needed_dim
-0000b110: 733a 204f 7264 6572 6564 5365 745b 4861  s: OrderedSet[Ha
-0000b120: 7368 6162 6c65 5d20 3d20 4f72 6465 7265  shable] = Ordere
-0000b130: 6453 6574 2829 0a20 2020 2020 2020 2066  dSet().        f
-0000b140: 6f72 2076 2069 6e20 7661 7269 6162 6c65  or v in variable
-0000b150: 732e 7661 6c75 6573 2829 3a0a 2020 2020  s.values():.    
-0000b160: 2020 2020 2020 2020 6e65 6564 6564 5f64          needed_d
-0000b170: 696d 732e 7570 6461 7465 2876 2e64 696d  ims.update(v.dim
-0000b180: 7329 0a0a 2020 2020 2020 2020 6469 6d73  s)..        dims
-0000b190: 203d 207b 6b3a 2073 656c 662e 6469 6d73   = {k: self.dims
-0000b1a0: 5b6b 5d20 666f 7220 6b20 696e 206e 6565  [k] for k in nee
-0000b1b0: 6465 645f 6469 6d73 7d0a 0a20 2020 2020  ded_dims}..     
-0000b1c0: 2020 2023 2070 7265 7365 7276 6573 206f     # preserves o
-0000b1d0: 7264 6572 696e 6720 6f66 2063 6f6f 7264  rdering of coord
-0000b1e0: 696e 6174 6573 0a20 2020 2020 2020 2066  inates.        f
-0000b1f0: 6f72 206b 2069 6e20 7365 6c66 2e5f 7661  or k in self._va
-0000b200: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
-0000b210: 2020 2020 2069 6620 6b20 6e6f 7420 696e       if k not in
-0000b220: 2073 656c 662e 5f63 6f6f 7264 5f6e 616d   self._coord_nam
-0000b230: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-0000b240: 2020 2020 636f 6e74 696e 7565 0a0a 2020      continue..  
-0000b250: 2020 2020 2020 2020 2020 6966 2073 6574            if set
-0000b260: 2873 656c 662e 7661 7269 6162 6c65 735b  (self.variables[
-0000b270: 6b5d 2e64 696d 7329 203c 3d20 6e65 6564  k].dims) <= need
-0000b280: 6564 5f64 696d 733a 0a20 2020 2020 2020  ed_dims:.       
-0000b290: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
-0000b2a0: 6573 5b6b 5d20 3d20 7365 6c66 2e5f 7661  es[k] = self._va
-0000b2b0: 7269 6162 6c65 735b 6b5d 0a20 2020 2020  riables[k].     
-0000b2c0: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
-0000b2d0: 5f6e 616d 6573 2e61 6464 286b 290a 0a20  _names.add(k).. 
-0000b2e0: 2020 2020 2020 2069 6e64 6578 6573 2e75         indexes.u
-0000b2f0: 7064 6174 6528 6669 6c74 6572 5f69 6e64  pdate(filter_ind
-0000b300: 6578 6573 5f66 726f 6d5f 636f 6f72 6473  exes_from_coords
-0000b310: 2873 656c 662e 5f69 6e64 6578 6573 2c20  (self._indexes, 
-0000b320: 636f 6f72 645f 6e61 6d65 7329 290a 0a20  coord_names)).. 
-0000b330: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000b340: 6c66 2e5f 7265 706c 6163 6528 7661 7269  lf._replace(vari
-0000b350: 6162 6c65 732c 2063 6f6f 7264 5f6e 616d  ables, coord_nam
-0000b360: 6573 2c20 6469 6d73 2c20 696e 6465 7865  es, dims, indexe
-0000b370: 733d 696e 6465 7865 7329 0a0a 2020 2020  s=indexes)..    
-0000b380: 6465 6620 5f63 6f6e 7374 7275 6374 5f64  def _construct_d
-0000b390: 6174 6161 7272 6179 2873 656c 662c 206e  ataarray(self, n
-0000b3a0: 616d 653a 2048 6173 6861 626c 6529 202d  ame: Hashable) -
-0000b3b0: 3e20 4461 7461 4172 7261 793a 0a20 2020  > DataArray:.   
-0000b3c0: 2020 2020 2022 2222 436f 6e73 7472 7563       """Construc
-0000b3d0: 7420 6120 4461 7461 4172 7261 7920 6279  t a DataArray by
-0000b3e0: 2069 6e64 6578 696e 6720 7468 6973 2064   indexing this d
-0000b3f0: 6174 6173 6574 2222 220a 2020 2020 2020  ataset""".      
-0000b400: 2020 6672 6f6d 2078 6172 7261 792e 636f    from xarray.co
-0000b410: 7265 2e64 6174 6161 7272 6179 2069 6d70  re.dataarray imp
-0000b420: 6f72 7420 4461 7461 4172 7261 790a 0a20  ort DataArray.. 
-0000b430: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0000b440: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-0000b450: 203d 2073 656c 662e 5f76 6172 6961 626c   = self._variabl
-0000b460: 6573 5b6e 616d 655d 0a20 2020 2020 2020  es[name].       
-0000b470: 2065 7863 6570 7420 4b65 7945 7272 6f72   except KeyError
-0000b480: 3a0a 2020 2020 2020 2020 2020 2020 5f2c  :.            _,
-0000b490: 206e 616d 652c 2076 6172 6961 626c 6520   name, variable 
-0000b4a0: 3d20 5f67 6574 5f76 6972 7475 616c 5f76  = _get_virtual_v
-0000b4b0: 6172 6961 626c 6528 7365 6c66 2e5f 7661  ariable(self._va
-0000b4c0: 7269 6162 6c65 732c 206e 616d 652c 2073  riables, name, s
-0000b4d0: 656c 662e 6469 6d73 290a 0a20 2020 2020  elf.dims)..     
-0000b4e0: 2020 206e 6565 6465 645f 6469 6d73 203d     needed_dims =
-0000b4f0: 2073 6574 2876 6172 6961 626c 652e 6469   set(variable.di
-0000b500: 6d73 290a 0a20 2020 2020 2020 2063 6f6f  ms)..        coo
-0000b510: 7264 733a 2064 6963 745b 4861 7368 6162  rds: dict[Hashab
-0000b520: 6c65 2c20 5661 7269 6162 6c65 5d20 3d20  le, Variable] = 
-0000b530: 7b7d 0a20 2020 2020 2020 2023 2070 7265  {}.        # pre
-0000b540: 7365 7276 6520 6f72 6465 7269 6e67 0a20  serve ordering. 
-0000b550: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
-0000b560: 7365 6c66 2e5f 7661 7269 6162 6c65 733a  self._variables:
-0000b570: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000b580: 6b20 696e 2073 656c 662e 5f63 6f6f 7264  k in self._coord
-0000b590: 5f6e 616d 6573 2061 6e64 2073 6574 2873  _names and set(s
-0000b5a0: 656c 662e 7661 7269 6162 6c65 735b 6b5d  elf.variables[k]
-0000b5b0: 2e64 696d 7329 203c 3d20 6e65 6564 6564  .dims) <= needed
-0000b5c0: 5f64 696d 733a 0a20 2020 2020 2020 2020  _dims:.         
-0000b5d0: 2020 2020 2020 2063 6f6f 7264 735b 6b5d         coords[k]
-0000b5e0: 203d 2073 656c 662e 7661 7269 6162 6c65   = self.variable
-0000b5f0: 735b 6b5d 0a0a 2020 2020 2020 2020 696e  s[k]..        in
-0000b600: 6465 7865 7320 3d20 6669 6c74 6572 5f69  dexes = filter_i
-0000b610: 6e64 6578 6573 5f66 726f 6d5f 636f 6f72  ndexes_from_coor
-0000b620: 6473 2873 656c 662e 5f69 6e64 6578 6573  ds(self._indexes
-0000b630: 2c20 7365 7428 636f 6f72 6473 2929 0a0a  , set(coords))..
-0000b640: 2020 2020 2020 2020 7265 7475 726e 2044          return D
-0000b650: 6174 6141 7272 6179 2876 6172 6961 626c  ataArray(variabl
-0000b660: 652c 2063 6f6f 7264 732c 206e 616d 653d  e, coords, name=
-0000b670: 6e61 6d65 2c20 696e 6465 7865 733d 696e  name, indexes=in
-0000b680: 6465 7865 732c 2066 6173 7470 6174 683d  dexes, fastpath=
-0000b690: 5472 7565 290a 0a20 2020 2040 7072 6f70  True)..    @prop
-0000b6a0: 6572 7479 0a20 2020 2064 6566 205f 6174  erty.    def _at
-0000b6b0: 7472 5f73 6f75 7263 6573 2873 656c 6629  tr_sources(self)
-0000b6c0: 202d 3e20 4974 6572 6162 6c65 5b4d 6170   -> Iterable[Map
-0000b6d0: 7069 6e67 5b48 6173 6861 626c 652c 2041  ping[Hashable, A
-0000b6e0: 6e79 5d5d 3a0a 2020 2020 2020 2020 2222  ny]]:.        ""
-0000b6f0: 2250 6c61 6365 7320 746f 206c 6f6f 6b2d  "Places to look-
-0000b700: 7570 2069 7465 6d73 2066 6f72 2061 7474  up items for att
-0000b710: 7269 6275 7465 2d73 7479 6c65 2061 6363  ribute-style acc
-0000b720: 6573 7322 2222 0a20 2020 2020 2020 2079  ess""".        y
-0000b730: 6965 6c64 2066 726f 6d20 7365 6c66 2e5f  ield from self._
-0000b740: 6974 656d 5f73 6f75 7263 6573 0a20 2020  item_sources.   
-0000b750: 2020 2020 2079 6965 6c64 2073 656c 662e       yield self.
-0000b760: 6174 7472 730a 0a20 2020 2040 7072 6f70  attrs..    @prop
-0000b770: 6572 7479 0a20 2020 2064 6566 205f 6974  erty.    def _it
-0000b780: 656d 5f73 6f75 7263 6573 2873 656c 6629  em_sources(self)
-0000b790: 202d 3e20 4974 6572 6162 6c65 5b4d 6170   -> Iterable[Map
-0000b7a0: 7069 6e67 5b48 6173 6861 626c 652c 2041  ping[Hashable, A
-0000b7b0: 6e79 5d5d 3a0a 2020 2020 2020 2020 2222  ny]]:.        ""
-0000b7c0: 2250 6c61 6365 7320 746f 206c 6f6f 6b2d  "Places to look-
-0000b7d0: 7570 2069 7465 6d73 2066 6f72 206b 6579  up items for key
-0000b7e0: 2d63 6f6d 706c 6574 696f 6e22 2222 0a20  -completion""". 
-0000b7f0: 2020 2020 2020 2079 6965 6c64 2073 656c         yield sel
-0000b800: 662e 6461 7461 5f76 6172 730a 2020 2020  f.data_vars.    
-0000b810: 2020 2020 7969 656c 6420 4879 6272 6964      yield Hybrid
-0000b820: 4d61 7070 696e 6750 726f 7879 286b 6579  MappingProxy(key
-0000b830: 733d 7365 6c66 2e5f 636f 6f72 645f 6e61  s=self._coord_na
-0000b840: 6d65 732c 206d 6170 7069 6e67 3d73 656c  mes, mapping=sel
-0000b850: 662e 636f 6f72 6473 290a 0a20 2020 2020  f.coords)..     
-0000b860: 2020 2023 2076 6972 7475 616c 2063 6f6f     # virtual coo
-0000b870: 7264 696e 6174 6573 0a20 2020 2020 2020  rdinates.       
-0000b880: 2079 6965 6c64 2048 7962 7269 644d 6170   yield HybridMap
-0000b890: 7069 6e67 5072 6f78 7928 6b65 7973 3d73  pingProxy(keys=s
-0000b8a0: 656c 662e 6469 6d73 2c20 6d61 7070 696e  elf.dims, mappin
-0000b8b0: 673d 7365 6c66 290a 0a20 2020 2064 6566  g=self)..    def
-0000b8c0: 205f 5f63 6f6e 7461 696e 735f 5f28 7365   __contains__(se
-0000b8d0: 6c66 2c20 6b65 793a 206f 626a 6563 7429  lf, key: object)
-0000b8e0: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
-0000b8f0: 2020 2222 2254 6865 2027 696e 2720 6f70    """The 'in' op
-0000b900: 6572 6174 6f72 2077 696c 6c20 7265 7475  erator will retu
-0000b910: 726e 2074 7275 6520 6f72 2066 616c 7365  rn true or false
-0000b920: 2064 6570 656e 6469 6e67 206f 6e20 7768   depending on wh
-0000b930: 6574 6865 720a 2020 2020 2020 2020 276b  ether.        'k
-0000b940: 6579 2720 6973 2061 6e20 6172 7261 7920  ey' is an array 
-0000b950: 696e 2074 6865 2064 6174 6173 6574 206f  in the dataset o
-0000b960: 7220 6e6f 742e 0a20 2020 2020 2020 2022  r not..        "
-0000b970: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0000b980: 6e20 6b65 7920 696e 2073 656c 662e 5f76  n key in self._v
-0000b990: 6172 6961 626c 6573 0a0a 2020 2020 6465  ariables..    de
-0000b9a0: 6620 5f5f 6c65 6e5f 5f28 7365 6c66 2920  f __len__(self) 
-0000b9b0: 2d3e 2069 6e74 3a0a 2020 2020 2020 2020  -> int:.        
-0000b9c0: 7265 7475 726e 206c 656e 2873 656c 662e  return len(self.
-0000b9d0: 6461 7461 5f76 6172 7329 0a0a 2020 2020  data_vars)..    
-0000b9e0: 6465 6620 5f5f 626f 6f6c 5f5f 2873 656c  def __bool__(sel
-0000b9f0: 6629 202d 3e20 626f 6f6c 3a0a 2020 2020  f) -> bool:.    
-0000ba00: 2020 2020 7265 7475 726e 2062 6f6f 6c28      return bool(
-0000ba10: 7365 6c66 2e64 6174 615f 7661 7273 290a  self.data_vars).
-0000ba20: 0a20 2020 2064 6566 205f 5f69 7465 725f  .    def __iter_
-0000ba30: 5f28 7365 6c66 2920 2d3e 2049 7465 7261  _(self) -> Itera
-0000ba40: 746f 725b 4861 7368 6162 6c65 5d3a 0a20  tor[Hashable]:. 
-0000ba50: 2020 2020 2020 2072 6574 7572 6e20 6974         return it
-0000ba60: 6572 2873 656c 662e 6461 7461 5f76 6172  er(self.data_var
-0000ba70: 7329 0a0a 2020 2020 6465 6620 5f5f 6172  s)..    def __ar
-0000ba80: 7261 795f 5f28 7365 6c66 2c20 6474 7970  ray__(self, dtyp
-0000ba90: 653d 4e6f 6e65 293a 0a20 2020 2020 2020  e=None):.       
-0000baa0: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-0000bab0: 280a 2020 2020 2020 2020 2020 2020 2263  (.            "c
-0000bac0: 616e 6e6f 7420 6469 7265 6374 6c79 2063  annot directly c
-0000bad0: 6f6e 7665 7274 2061 6e20 7861 7272 6179  onvert an xarray
-0000bae0: 2e44 6174 6173 6574 2069 6e74 6f20 6120  .Dataset into a 
-0000baf0: 220a 2020 2020 2020 2020 2020 2020 226e  ".            "n
-0000bb00: 756d 7079 2061 7272 6179 2e20 496e 7374  umpy array. Inst
-0000bb10: 6561 642c 2063 7265 6174 6520 616e 2078  ead, create an x
-0000bb20: 6172 7261 792e 4461 7461 4172 7261 7920  array.DataArray 
-0000bb30: 220a 2020 2020 2020 2020 2020 2020 2266  ".            "f
-0000bb40: 6972 7374 2c20 6569 7468 6572 2077 6974  irst, either wit
-0000bb50: 6820 696e 6465 7869 6e67 206f 6e20 7468  h indexing on th
-0000bb60: 6520 4461 7461 7365 7420 6f72 2062 7920  e Dataset or by 
-0000bb70: 220a 2020 2020 2020 2020 2020 2020 2269  ".            "i
-0000bb80: 6e76 6f6b 696e 6720 7468 6520 6074 6f5f  nvoking the `to_
-0000bb90: 6172 7261 7928 2960 206d 6574 686f 642e  array()` method.
-0000bba0: 220a 2020 2020 2020 2020 290a 0a20 2020  ".        )..   
-0000bbb0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-0000bbc0: 6566 206e 6279 7465 7328 7365 6c66 2920  ef nbytes(self) 
-0000bbd0: 2d3e 2069 6e74 3a0a 2020 2020 2020 2020  -> int:.        
-0000bbe0: 2222 220a 2020 2020 2020 2020 546f 7461  """.        Tota
-0000bbf0: 6c20 6279 7465 7320 636f 6e73 756d 6564  l bytes consumed
-0000bc00: 2062 7920 7468 6520 6461 7461 2061 7272   by the data arr
-0000bc10: 6179 7320 6f66 2061 6c6c 2076 6172 6961  ays of all varia
-0000bc20: 626c 6573 2069 6e20 7468 6973 2064 6174  bles in this dat
-0000bc30: 6173 6574 2e0a 0a20 2020 2020 2020 2049  aset...        I
-0000bc40: 6620 7468 6520 6261 636b 656e 6420 6172  f the backend ar
-0000bc50: 7261 7920 666f 7220 616e 7920 7661 7269  ray for any vari
-0000bc60: 6162 6c65 2064 6f65 7320 6e6f 7420 696e  able does not in
-0000bc70: 636c 7564 6520 6060 6e62 7974 6573 6060  clude ``nbytes``
-0000bc80: 2c20 6573 7469 6d61 7465 730a 2020 2020  , estimates.    
-0000bc90: 2020 2020 7468 6520 746f 7461 6c20 6279      the total by
-0000bca0: 7465 7320 666f 7220 7468 6174 2061 7272  tes for that arr
-0000bcb0: 6179 2062 6173 6564 206f 6e20 7468 6520  ay based on the 
-0000bcc0: 6060 7369 7a65 6060 2061 6e64 2060 6064  ``size`` and ``d
-0000bcd0: 7479 7065 6060 2e0a 2020 2020 2020 2020  type``..        
-0000bce0: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-0000bcf0: 726e 2073 756d 2876 2e6e 6279 7465 7320  rn sum(v.nbytes 
-0000bd00: 666f 7220 7620 696e 2073 656c 662e 7661  for v in self.va
-0000bd10: 7269 6162 6c65 732e 7661 6c75 6573 2829  riables.values()
-0000bd20: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000bd30: 0a20 2020 2064 6566 206c 6f63 2873 656c  .    def loc(sel
-0000bd40: 663a 2054 5f44 6174 6173 6574 2920 2d3e  f: T_Dataset) ->
-0000bd50: 205f 4c6f 6349 6e64 6578 6572 5b54 5f44   _LocIndexer[T_D
-0000bd60: 6174 6173 6574 5d3a 0a20 2020 2020 2020  ataset]:.       
-0000bd70: 2022 2222 4174 7472 6962 7574 6520 666f   """Attribute fo
-0000bd80: 7220 6c6f 6361 7469 6f6e 2062 6173 6564  r location based
-0000bd90: 2069 6e64 6578 696e 672e 204f 6e6c 7920   indexing. Only 
-0000bda0: 7375 7070 6f72 7473 205f 5f67 6574 6974  supports __getit
-0000bdb0: 656d 5f5f 2c0a 2020 2020 2020 2020 616e  em__,.        an
-0000bdc0: 6420 6f6e 6c79 2077 6865 6e20 7468 6520  d only when the 
-0000bdd0: 6b65 7920 6973 2061 2064 6963 7420 6f66  key is a dict of
-0000bde0: 2074 6865 2066 6f72 6d20 7b64 696d 3a20   the form {dim: 
-0000bdf0: 6c61 6265 6c73 7d2e 0a20 2020 2020 2020  labels}..       
-0000be00: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
-0000be10: 7572 6e20 5f4c 6f63 496e 6465 7865 7228  urn _LocIndexer(
-0000be20: 7365 6c66 290a 0a20 2020 2040 6f76 6572  self)..    @over
-0000be30: 6c6f 6164 0a20 2020 2064 6566 205f 5f67  load.    def __g
-0000be40: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
-0000be50: 6579 3a20 4861 7368 6162 6c65 2920 2d3e  ey: Hashable) ->
-0000be60: 2044 6174 6141 7272 6179 3a0a 2020 2020   DataArray:.    
-0000be70: 2020 2020 2e2e 2e0a 0a20 2020 2023 204d      .....    # M
-0000be80: 6170 7069 6e67 2069 7320 4974 6572 6162  apping is Iterab
-0000be90: 6c65 0a20 2020 2040 6f76 6572 6c6f 6164  le.    @overload
-0000bea0: 0a20 2020 2064 6566 205f 5f67 6574 6974  .    def __getit
-0000beb0: 656d 5f5f 2873 656c 663a 2054 5f44 6174  em__(self: T_Dat
-0000bec0: 6173 6574 2c20 6b65 793a 2049 7465 7261  aset, key: Itera
-0000bed0: 626c 655b 4861 7368 6162 6c65 5d29 202d  ble[Hashable]) -
-0000bee0: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
-0000bef0: 2020 2020 202e 2e2e 0a0a 2020 2020 6465       .....    de
-0000bf00: 6620 5f5f 6765 7469 7465 6d5f 5f28 0a20  f __getitem__(. 
-0000bf10: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
-0000bf20: 6174 6173 6574 2c20 6b65 793a 204d 6170  ataset, key: Map
-0000bf30: 7069 6e67 5b41 6e79 2c20 416e 795d 207c  ping[Any, Any] |
-0000bf40: 2048 6173 6861 626c 6520 7c20 4974 6572   Hashable | Iter
-0000bf50: 6162 6c65 5b48 6173 6861 626c 655d 0a20  able[Hashable]. 
-0000bf60: 2020 2029 202d 3e20 545f 4461 7461 7365     ) -> T_Datase
-0000bf70: 7420 7c20 4461 7461 4172 7261 793a 0a20  t | DataArray:. 
-0000bf80: 2020 2020 2020 2022 2222 4163 6365 7373         """Access
-0000bf90: 2076 6172 6961 626c 6573 206f 7220 636f   variables or co
-0000bfa0: 6f72 6469 6e61 7465 7320 6f66 2074 6869  ordinates of thi
-0000bfb0: 7320 6461 7461 7365 7420 6173 2061 0a20  s dataset as a. 
-0000bfc0: 2020 2020 2020 203a 7079 3a63 6c61 7373         :py:class
-0000bfd0: 3a60 7e78 6172 7261 792e 4461 7461 4172  :`~xarray.DataAr
-0000bfe0: 7261 7960 206f 7220 6120 7375 6273 6574  ray` or a subset
-0000bff0: 206f 6620 7661 7269 6162 6c65 7320 6f72   of variables or
-0000c000: 2061 2069 6e64 6578 6564 2064 6174 6173   a indexed datas
-0000c010: 6574 2e0a 0a20 2020 2020 2020 2049 6e64  et...        Ind
-0000c020: 6578 696e 6720 7769 7468 2061 206c 6973  exing with a lis
-0000c030: 7420 6f66 206e 616d 6573 2077 696c 6c20  t of names will 
-0000c040: 7265 7475 726e 2061 206e 6577 2060 6044  return a new ``D
-0000c050: 6174 6173 6574 6060 206f 626a 6563 742e  ataset`` object.
-0000c060: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0000c070: 2020 2020 2069 6620 7574 696c 732e 6973       if utils.is
-0000c080: 5f64 6963 745f 6c69 6b65 286b 6579 293a  _dict_like(key):
-0000c090: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000c0a0: 7572 6e20 7365 6c66 2e69 7365 6c28 2a2a  urn self.isel(**
-0000c0b0: 6b65 7929 0a20 2020 2020 2020 2069 6620  key).        if 
-0000c0c0: 7574 696c 732e 6861 7368 6162 6c65 286b  utils.hashable(k
-0000c0d0: 6579 293a 0a20 2020 2020 2020 2020 2020  ey):.           
-0000c0e0: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
-0000c0f0: 6e73 7472 7563 745f 6461 7461 6172 7261  nstruct_dataarra
-0000c100: 7928 6b65 7929 0a20 2020 2020 2020 2069  y(key).        i
-0000c110: 6620 7574 696c 732e 6974 6572 6162 6c65  f utils.iterable
-0000c120: 5f6f 665f 6861 7368 6162 6c65 286b 6579  _of_hashable(key
-0000c130: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
-0000c140: 6574 7572 6e20 7365 6c66 2e5f 636f 7079  eturn self._copy
-0000c150: 5f6c 6973 7465 6428 6b65 7929 0a20 2020  _listed(key).   
-0000c160: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000c170: 4572 726f 7228 6622 556e 7375 7070 6f72  Error(f"Unsuppor
-0000c180: 7465 6420 6b65 792d 7479 7065 207b 7479  ted key-type {ty
-0000c190: 7065 286b 6579 297d 2229 0a0a 2020 2020  pe(key)}")..    
-0000c1a0: 6465 6620 5f5f 7365 7469 7465 6d5f 5f28  def __setitem__(
-0000c1b0: 0a20 2020 2020 2020 2073 656c 662c 206b  .        self, k
-0000c1c0: 6579 3a20 4861 7368 6162 6c65 207c 2049  ey: Hashable | I
-0000c1d0: 7465 7261 626c 655b 4861 7368 6162 6c65  terable[Hashable
-0000c1e0: 5d20 7c20 4d61 7070 696e 672c 2076 616c  ] | Mapping, val
-0000c1f0: 7565 3a20 416e 790a 2020 2020 2920 2d3e  ue: Any.    ) ->
-0000c200: 204e 6f6e 653a 0a20 2020 2020 2020 2022   None:.        "
-0000c210: 2222 4164 6420 616e 2061 7272 6179 2074  ""Add an array t
-0000c220: 6f20 7468 6973 2064 6174 6173 6574 2e0a  o this dataset..
-0000c230: 2020 2020 2020 2020 4d75 6c74 6970 6c65          Multiple
-0000c240: 2061 7272 6179 7320 6361 6e20 6265 2061   arrays can be a
-0000c250: 6464 6564 2061 7420 7468 6520 7361 6d65  dded at the same
-0000c260: 2074 696d 652c 2069 6e20 7768 6963 6820   time, in which 
-0000c270: 6361 7365 2065 6163 6820 6f66 0a20 2020  case each of.   
-0000c280: 2020 2020 2074 6865 2066 6f6c 6c6f 7769       the followi
-0000c290: 6e67 206f 7065 7261 7469 6f6e 7320 6973  ng operations is
-0000c2a0: 2061 7070 6c69 6564 2074 6f20 7468 6520   applied to the 
-0000c2b0: 7265 7370 6563 7469 7665 2076 616c 7565  respective value
-0000c2c0: 2e0a 0a20 2020 2020 2020 2049 6620 6b65  ...        If ke
-0000c2d0: 7920 6973 2064 6963 742d 6c69 6b65 2c20  y is dict-like, 
-0000c2e0: 7570 6461 7465 2061 6c6c 2076 6172 6961  update all varia
-0000c2f0: 626c 6573 2069 6e20 7468 6520 6461 7461  bles in the data
-0000c300: 7365 740a 2020 2020 2020 2020 6f6e 6520  set.        one 
-0000c310: 6279 206f 6e65 2077 6974 6820 7468 6520  by one with the 
-0000c320: 6769 7665 6e20 7661 6c75 6520 6174 2074  given value at t
-0000c330: 6865 2067 6976 656e 206c 6f63 6174 696f  he given locatio
-0000c340: 6e2e 0a20 2020 2020 2020 2049 6620 7468  n..        If th
-0000c350: 6520 6769 7665 6e20 7661 6c75 6520 6973  e given value is
-0000c360: 2061 6c73 6f20 6120 6461 7461 7365 742c   also a dataset,
-0000c370: 2073 656c 6563 7420 636f 7272 6573 706f   select correspo
-0000c380: 6e64 696e 6720 7661 7269 6162 6c65 730a  nding variables.
-0000c390: 2020 2020 2020 2020 696e 2074 6865 2067          in the g
-0000c3a0: 6976 656e 2076 616c 7565 2061 6e64 2069  iven value and i
-0000c3b0: 6e20 7468 6520 6461 7461 7365 7420 746f  n the dataset to
-0000c3c0: 2062 6520 6368 616e 6765 642e 0a0a 2020   be changed...  
-0000c3d0: 2020 2020 2020 4966 2076 616c 7565 2069        If value i
-0000c3e0: 7320 6120 600a 2020 2020 2020 2020 6672  s a `.        fr
-0000c3f0: 6f6d 202e 6461 7461 6172 7261 7920 696d  om .dataarray im
-0000c400: 706f 7274 2044 6174 6141 7272 6179 602c  port DataArray`,
-0000c410: 2063 616c 6c20 6974 7320 6073 656c 6563   call its `selec
-0000c420: 745f 7661 7273 2829 6020 6d65 7468 6f64  t_vars()` method
-0000c430: 2c20 7265 6e61 6d65 2069 740a 2020 2020  , rename it.    
-0000c440: 2020 2020 746f 2060 6b65 7960 2061 6e64      to `key` and
-0000c450: 206d 6572 6765 2074 6865 2063 6f6e 7465   merge the conte
-0000c460: 6e74 7320 6f66 2074 6865 2072 6573 756c  nts of the resul
-0000c470: 7469 6e67 2064 6174 6173 6574 2069 6e74  ting dataset int
-0000c480: 6f20 7468 6973 0a20 2020 2020 2020 2064  o this.        d
-0000c490: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
-0000c4a0: 2049 6620 7661 6c75 6520 6973 2061 2060   If value is a `
-0000c4b0: 5661 7269 6162 6c65 6020 6f62 6a65 6374  Variable` object
-0000c4c0: 2028 6f72 2074 7570 6c65 206f 6620 666f   (or tuple of fo
-0000c4d0: 726d 0a20 2020 2020 2020 2060 6028 6469  rm.        ``(di
-0000c4e0: 6d73 2c20 6461 7461 5b2c 2061 7474 7273  ms, data[, attrs
-0000c4f0: 5d29 6060 292c 2061 6464 2069 7420 746f  ])``), add it to
-0000c500: 2074 6869 7320 6461 7461 7365 7420 6173   this dataset as
-0000c510: 2061 206e 6577 0a20 2020 2020 2020 2076   a new.        v
-0000c520: 6172 6961 626c 652e 0a20 2020 2020 2020  ariable..       
-0000c530: 2022 2222 0a20 2020 2020 2020 2066 726f   """.        fro
-0000c540: 6d20 7861 7272 6179 2e63 6f72 652e 6461  m xarray.core.da
-0000c550: 7461 6172 7261 7920 696d 706f 7274 2044  taarray import D
-0000c560: 6174 6141 7272 6179 0a0a 2020 2020 2020  ataArray..      
-0000c570: 2020 6966 2075 7469 6c73 2e69 735f 6469    if utils.is_di
-0000c580: 6374 5f6c 696b 6528 6b65 7929 3a0a 2020  ct_like(key):.  
-0000c590: 2020 2020 2020 2020 2020 2320 6368 6563            # chec
-0000c5a0: 6b20 666f 7220 636f 6e73 6973 7465 6e63  k for consistenc
-0000c5b0: 7920 616e 6420 636f 6e76 6572 7420 7661  y and convert va
-0000c5c0: 6c75 6520 746f 2064 6174 6173 6574 0a20  lue to dataset. 
-0000c5d0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0000c5e0: 203d 2073 656c 662e 5f73 6574 6974 656d   = self._setitem
-0000c5f0: 5f63 6865 636b 286b 6579 2c20 7661 6c75  _check(key, valu
-0000c600: 6529 0a20 2020 2020 2020 2020 2020 2023  e).            #
-0000c610: 206c 6f6f 7020 6f76 6572 2064 6174 6173   loop over datas
-0000c620: 6574 2076 6172 6961 626c 6573 2061 6e64  et variables and
-0000c630: 2073 6574 206e 6577 2076 616c 7565 730a   set new values.
-0000c640: 2020 2020 2020 2020 2020 2020 7072 6f63              proc
-0000c650: 6573 7365 6420 3d20 5b5d 0a20 2020 2020  essed = [].     
-0000c660: 2020 2020 2020 2066 6f72 206e 616d 652c         for name,
-0000c670: 2076 6172 2069 6e20 7365 6c66 2e69 7465   var in self.ite
-0000c680: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
-0000c690: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-0000c6a0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0000c6b0: 6172 5b6b 6579 5d20 3d20 7661 6c75 655b  ar[key] = value[
-0000c6c0: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
-0000c6d0: 2020 2020 2020 2020 2020 7072 6f63 6573            proces
-0000c6e0: 7365 642e 6170 7065 6e64 286e 616d 6529  sed.append(name)
-0000c6f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c700: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
-0000c710: 6e20 6173 2065 3a0a 2020 2020 2020 2020  n as e:.        
-0000c720: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-0000c730: 726f 6365 7373 6564 3a0a 2020 2020 2020  rocessed:.      
-0000c740: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c750: 2020 7261 6973 6520 5275 6e74 696d 6545    raise RuntimeE
-0000c760: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0000c770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c780: 2020 2241 6e20 6572 726f 7220 6f63 6375    "An error occu
-0000c790: 7272 6564 2077 6869 6c65 2073 6574 7469  rred while setti
-0000c7a0: 6e67 2076 616c 7565 7320 6f66 2074 6865  ng values of the
-0000c7b0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000c7c0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0000c7d0: 2076 6172 6961 626c 6520 277b 6e61 6d65   variable '{name
-0000c7e0: 7d27 2e20 5468 6520 666f 6c6c 6f77 696e  }'. The followin
-0000c7f0: 6720 7661 7269 6162 6c65 7320 6861 7665  g variables have
-0000c800: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000c810: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0000c820: 2062 6565 6e20 7375 6363 6573 7366 756c   been successful
-0000c830: 6c79 2075 7064 6174 6564 3a5c 6e7b 7072  ly updated:\n{pr
-0000c840: 6f63 6573 7365 647d 220a 2020 2020 2020  ocessed}".      
-0000c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c860: 2020 2920 6672 6f6d 2065 0a20 2020 2020    ) from e.     
-0000c870: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000c880: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000c890: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0000c8a0: 7365 2065 0a0a 2020 2020 2020 2020 656c  se e..        el
-0000c8b0: 6966 2075 7469 6c73 2e68 6173 6861 626c  if utils.hashabl
-0000c8c0: 6528 6b65 7929 3a0a 2020 2020 2020 2020  e(key):.        
-0000c8d0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-0000c8e0: 6528 7661 6c75 652c 2044 6174 6173 6574  e(value, Dataset
-0000c8f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-0000c900: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0000c910: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0000c920: 2020 2020 2020 2020 2243 616e 6e6f 7420          "Cannot 
-0000c930: 6173 7369 676e 2061 2044 6174 6173 6574  assign a Dataset
-0000c940: 2074 6f20 6120 7369 6e67 6c65 206b 6579   to a single key
-0000c950: 202d 206f 6e6c 7920 6120 4461 7461 4172   - only a DataAr
-0000c960: 7261 7920 6f72 2056 6172 6961 626c 6520  ray or Variable 
-0000c970: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000c980: 2020 2020 2020 226f 626a 6563 7420 6361        "object ca
-0000c990: 6e20 6265 2073 746f 7265 6420 756e 6465  n be stored unde
-0000c9a0: 7220 6120 7369 6e67 6c65 206b 6579 2e22  r a single key."
-0000c9b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c9c0: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
-0000c9d0: 656c 662e 7570 6461 7465 287b 6b65 793a  elf.update({key:
-0000c9e0: 2076 616c 7565 7d29 0a0a 2020 2020 2020   value})..      
-0000c9f0: 2020 656c 6966 2075 7469 6c73 2e69 7465    elif utils.ite
-0000ca00: 7261 626c 655f 6f66 5f68 6173 6861 626c  rable_of_hashabl
-0000ca10: 6528 6b65 7929 3a0a 2020 2020 2020 2020  e(key):.        
-0000ca20: 2020 2020 6b65 796c 6973 7420 3d20 6c69      keylist = li
-0000ca30: 7374 286b 6579 290a 2020 2020 2020 2020  st(key).        
-0000ca40: 2020 2020 6966 206c 656e 286b 6579 6c69      if len(keyli
-0000ca50: 7374 2920 3d3d 2030 3a0a 2020 2020 2020  st) == 0:.      
-0000ca60: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000ca70: 5661 6c75 6545 7272 6f72 2822 456d 7074  ValueError("Empt
-0000ca80: 7920 6c69 7374 206f 6620 7661 7269 6162  y list of variab
-0000ca90: 6c65 7320 746f 2062 6520 7365 7422 290a  les to be set").
-0000caa0: 2020 2020 2020 2020 2020 2020 6966 206c              if l
-0000cab0: 656e 286b 6579 6c69 7374 2920 3d3d 2031  en(keylist) == 1
-0000cac0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000cad0: 2020 7365 6c66 2e75 7064 6174 6528 7b6b    self.update({k
-0000cae0: 6579 6c69 7374 5b30 5d3a 2076 616c 7565  eylist[0]: value
-0000caf0: 7d29 0a20 2020 2020 2020 2020 2020 2065  }).            e
-0000cb00: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0000cb10: 2020 2020 2069 6620 6c65 6e28 6b65 796c       if len(keyl
-0000cb20: 6973 7429 2021 3d20 6c65 6e28 7661 6c75  ist) != len(valu
-0000cb30: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
-0000cb40: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0000cb50: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-0000cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cb70: 2020 6622 4469 6666 6572 656e 7420 6c65    f"Different le
-0000cb80: 6e67 7468 7320 6f66 2076 6172 6961 626c  ngths of variabl
-0000cb90: 6573 2074 6f20 6265 2073 6574 2022 0a20  es to be set ". 
-0000cba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cbb0: 2020 2020 2020 2066 2228 7b6c 656e 286b         f"({len(k
-0000cbc0: 6579 6c69 7374 297d 2920 616e 6420 6461  eylist)}) and da
-0000cbd0: 7461 2075 7365 6420 6173 2069 6e70 7574  ta used as input
-0000cbe0: 2066 6f72 2022 0a20 2020 2020 2020 2020   for ".         
-0000cbf0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000cc00: 2273 6574 7469 6e67 2028 7b6c 656e 2876  "setting ({len(v
-0000cc10: 616c 7565 297d 2922 0a20 2020 2020 2020  alue)})".       
-0000cc20: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0000cc30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000cc40: 6620 6973 696e 7374 616e 6365 2876 616c  f isinstance(val
-0000cc50: 7565 2c20 4461 7461 7365 7429 3a0a 2020  ue, Dataset):.  
-0000cc60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cc70: 2020 7365 6c66 2e75 7064 6174 6528 6469    self.update(di
-0000cc80: 6374 287a 6970 286b 6579 6c69 7374 2c20  ct(zip(keylist, 
-0000cc90: 7661 6c75 652e 6461 7461 5f76 6172 732e  value.data_vars.
-0000cca0: 7661 6c75 6573 2829 2929 290a 2020 2020  values()))).    
-0000ccb0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-0000ccc0: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
-0000ccd0: 652c 2044 6174 6141 7272 6179 293a 0a20  e, DataArray):. 
-0000cce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ccf0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000cd00: 726f 7228 2243 616e 6e6f 7420 6173 7369  ror("Cannot assi
-0000cd10: 676e 2073 696e 676c 6520 4461 7461 4172  gn single DataAr
-0000cd20: 7261 7920 746f 206d 756c 7469 706c 6520  ray to multiple 
-0000cd30: 6b65 7973 2229 0a20 2020 2020 2020 2020  keys").         
-0000cd40: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000cd50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000cd60: 2073 656c 662e 7570 6461 7465 2864 6963   self.update(dic
-0000cd70: 7428 7a69 7028 6b65 796c 6973 742c 2076  t(zip(keylist, v
-0000cd80: 616c 7565 2929 290a 0a20 2020 2020 2020  alue)))..       
-0000cd90: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000cda0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-0000cdb0: 726f 7228 6622 556e 7375 7070 6f72 7465  ror(f"Unsupporte
-0000cdc0: 6420 6b65 792d 7479 7065 207b 7479 7065  d key-type {type
-0000cdd0: 286b 6579 297d 2229 0a0a 2020 2020 6465  (key)}")..    de
-0000cde0: 6620 5f73 6574 6974 656d 5f63 6865 636b  f _setitem_check
-0000cdf0: 2873 656c 662c 206b 6579 2c20 7661 6c75  (self, key, valu
-0000ce00: 6529 3a0a 2020 2020 2020 2020 2222 2243  e):.        """C
-0000ce10: 6f6e 7369 7374 656e 6379 2063 6865 636b  onsistency check
-0000ce20: 2066 6f72 205f 5f73 6574 6974 656d 5f5f   for __setitem__
-0000ce30: 0a0a 2020 2020 2020 2020 5768 656e 2061  ..        When a
-0000ce40: 7373 6967 6e69 6e67 2076 616c 7565 7320  ssigning values 
-0000ce50: 746f 2061 2073 7562 7365 7420 6f66 2061  to a subset of a
-0000ce60: 2044 6174 6173 6574 2c20 646f 2063 6f6e   Dataset, do con
-0000ce70: 7369 7374 656e 6379 2063 6865 636b 2062  sistency check b
-0000ce80: 6566 6f72 6568 616e 640a 2020 2020 2020  eforehand.      
-0000ce90: 2020 746f 2061 766f 6964 206c 6561 7669    to avoid leavi
-0000cea0: 6e67 2074 6865 2064 6174 6173 6574 2069  ng the dataset i
-0000ceb0: 6e20 6120 7061 7274 6961 6c6c 7920 7570  n a partially up
-0000cec0: 6461 7465 6420 7374 6174 6520 7768 656e  dated state when
-0000ced0: 2061 6e20 6572 726f 7220 6f63 6375 7273   an error occurs
-0000cee0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-0000cef0: 2020 2020 2020 6672 6f6d 2078 6172 7261        from xarra
-0000cf00: 792e 636f 7265 2e61 6c69 676e 6d65 6e74  y.core.alignment
-0000cf10: 2069 6d70 6f72 7420 616c 6967 6e0a 2020   import align.  
-0000cf20: 2020 2020 2020 6672 6f6d 2078 6172 7261        from xarra
-0000cf30: 792e 636f 7265 2e64 6174 6161 7272 6179  y.core.dataarray
-0000cf40: 2069 6d70 6f72 7420 4461 7461 4172 7261   import DataArra
-0000cf50: 790a 0a20 2020 2020 2020 2069 6620 6973  y..        if is
-0000cf60: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
-0000cf70: 4461 7461 7365 7429 3a0a 2020 2020 2020  Dataset):.      
-0000cf80: 2020 2020 2020 6d69 7373 696e 675f 7661        missing_va
-0000cf90: 7273 203d 205b 0a20 2020 2020 2020 2020  rs = [.         
-0000cfa0: 2020 2020 2020 206e 616d 6520 666f 7220         name for 
-0000cfb0: 6e61 6d65 2069 6e20 7661 6c75 652e 6461  name in value.da
-0000cfc0: 7461 5f76 6172 7320 6966 206e 616d 6520  ta_vars if name 
-0000cfd0: 6e6f 7420 696e 2073 656c 662e 6461 7461  not in self.data
-0000cfe0: 5f76 6172 730a 2020 2020 2020 2020 2020  _vars.          
-0000cff0: 2020 5d0a 2020 2020 2020 2020 2020 2020    ].            
-0000d000: 6966 206d 6973 7369 6e67 5f76 6172 733a  if missing_vars:
-0000d010: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d020: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0000d030: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0000d040: 2020 2020 2020 2066 2256 6172 6961 626c         f"Variabl
-0000d050: 6573 207b 6d69 7373 696e 675f 7661 7273  es {missing_vars
-0000d060: 7d20 696e 206e 6577 2076 616c 7565 7322  } in new values"
-0000d070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d080: 2020 2020 2066 2220 6e6f 7420 6176 6169       f" not avai
-0000d090: 6c61 626c 6520 696e 206f 7269 6769 6e61  lable in origina
-0000d0a0: 6c20 6461 7461 7365 743a 5c6e 7b73 656c  l dataset:\n{sel
-0000d0b0: 667d 220a 2020 2020 2020 2020 2020 2020  f}".            
-0000d0c0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-0000d0d0: 6966 206e 6f74 2061 6e79 285b 6973 696e  if not any([isin
-0000d0e0: 7374 616e 6365 2876 616c 7565 2c20 7429  stance(value, t)
-0000d0f0: 2066 6f72 2074 2069 6e20 5b44 6174 6141   for t in [DataA
-0000d100: 7272 6179 2c20 4e75 6d62 6572 2c20 7374  rray, Number, st
-0000d110: 725d 5d29 3a0a 2020 2020 2020 2020 2020  r]]):.          
-0000d120: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-0000d130: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0000d140: 2020 2022 4461 7461 7365 7420 6173 7369     "Dataset assi
-0000d150: 676e 6d65 6e74 206f 6e6c 7920 6163 6365  gnment only acce
-0000d160: 7074 7320 4461 7461 4172 7261 7973 2c20  pts DataArrays, 
-0000d170: 4461 7461 7365 7473 2c20 616e 6420 7363  Datasets, and sc
-0000d180: 616c 6172 732e 220a 2020 2020 2020 2020  alars.".        
-0000d190: 2020 2020 290a 0a20 2020 2020 2020 206e      )..        n
-0000d1a0: 6577 5f76 616c 7565 203d 2044 6174 6173  ew_value = Datas
-0000d1b0: 6574 2829 0a20 2020 2020 2020 2066 6f72  et().        for
-0000d1c0: 206e 616d 652c 2076 6172 2069 6e20 7365   name, var in se
-0000d1d0: 6c66 2e69 7465 6d73 2829 3a0a 2020 2020  lf.items():.    
-0000d1e0: 2020 2020 2020 2020 2320 7465 7374 2069          # test i
-0000d1f0: 6e64 6578 696e 670a 2020 2020 2020 2020  ndexing.        
-0000d200: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-0000d210: 2020 2020 2020 2020 2076 6172 5f6b 203d           var_k =
-0000d220: 2076 6172 5b6b 6579 5d0a 2020 2020 2020   var[key].      
-0000d230: 2020 2020 2020 6578 6365 7074 2045 7863        except Exc
-0000d240: 6570 7469 6f6e 2061 7320 653a 0a20 2020  eption as e:.   
-0000d250: 2020 2020 2020 2020 2020 2020 2072 6169               rai
-0000d260: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0000d270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d280: 2020 2066 2256 6172 6961 626c 6520 277b     f"Variable '{
-0000d290: 6e61 6d65 7d27 3a20 696e 6465 7865 7220  name}': indexer 
-0000d2a0: 7b6b 6579 7d20 6e6f 7420 6176 6169 6c61  {key} not availa
-0000d2b0: 626c 6522 0a20 2020 2020 2020 2020 2020  ble".           
-0000d2c0: 2020 2020 2029 2066 726f 6d20 650a 0a20       ) from e.. 
-0000d2d0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0000d2e0: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
-0000d2f0: 4461 7461 7365 7429 3a0a 2020 2020 2020  Dataset):.      
-0000d300: 2020 2020 2020 2020 2020 7661 6c20 3d20            val = 
-0000d310: 7661 6c75 655b 6e61 6d65 5d0a 2020 2020  value[name].    
-0000d320: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000d330: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0000d340: 6c20 3d20 7661 6c75 650a 0a20 2020 2020  l = value..     
-0000d350: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0000d360: 616e 6365 2876 616c 2c20 4461 7461 4172  ance(val, DataAr
-0000d370: 7261 7929 3a0a 2020 2020 2020 2020 2020  ray):.          
-0000d380: 2020 2020 2020 2320 6368 6563 6b20 636f        # check co
-0000d390: 6e73 6973 7465 6e63 7920 6f66 2064 696d  nsistency of dim
-0000d3a0: 656e 7369 6f6e 730a 2020 2020 2020 2020  ensions.        
-0000d3b0: 2020 2020 2020 2020 666f 7220 6469 6d20          for dim 
-0000d3c0: 696e 2076 616c 2e64 696d 733a 0a20 2020  in val.dims:.   
-0000d3d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d3e0: 2069 6620 6469 6d20 6e6f 7420 696e 2076   if dim not in v
-0000d3f0: 6172 5f6b 2e64 696d 733a 0a20 2020 2020  ar_k.dims:.     
-0000d400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d410: 2020 2072 6169 7365 204b 6579 4572 726f     raise KeyErro
-0000d420: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-0000d430: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000d440: 2256 6172 6961 626c 6520 277b 6e61 6d65  "Variable '{name
-0000d450: 7d27 3a20 6469 6d65 6e73 696f 6e20 277b  }': dimension '{
-0000d460: 6469 6d7d 2720 6170 7065 6172 7320 696e  dim}' appears in
-0000d470: 206e 6577 2076 616c 7565 7320 220a 2020   new values ".  
+00002a90: 220a 2020 2020 6672 6f6d 2078 6172 7261  ".    from xarra
+00002aa0: 792e 636f 7265 2e63 6f6d 7075 7461 7469  y.core.computati
+00002ab0: 6f6e 2069 6d70 6f72 7420 7768 6572 650a  on import where.
+00002ac0: 0a20 2020 2064 6566 205f 696e 6974 6961  .    def _initia
+00002ad0: 6c69 7a65 5f66 6561 7369 626c 6528 6c62  lize_feasible(lb
+00002ae0: 2c20 7562 293a 0a20 2020 2020 2020 2023  , ub):.        #
+00002af0: 204d 696d 6963 7320 6675 6e63 7469 6f6e   Mimics function
+00002b00: 616c 6974 7920 6f66 2073 6369 7079 2e6f  ality of scipy.o
+00002b10: 7074 696d 697a 652e 6d69 6e70 6163 6b2e  ptimize.minpack.
+00002b20: 5f69 6e69 7469 616c 697a 655f 6665 6173  _initialize_feas
+00002b30: 6962 6c65 0a20 2020 2020 2020 206c 625f  ible.        lb_
+00002b40: 6669 6e69 7465 203d 206e 702e 6973 6669  finite = np.isfi
+00002b50: 6e69 7465 286c 6229 0a20 2020 2020 2020  nite(lb).       
+00002b60: 2075 625f 6669 6e69 7465 203d 206e 702e   ub_finite = np.
+00002b70: 6973 6669 6e69 7465 2875 6229 0a20 2020  isfinite(ub).   
+00002b80: 2020 2020 2070 3020 3d20 7768 6572 6528       p0 = where(
+00002b90: 0a20 2020 2020 2020 2020 2020 206c 625f  .            lb_
+00002ba0: 6669 6e69 7465 2c0a 2020 2020 2020 2020  finite,.        
+00002bb0: 2020 2020 7768 6572 6528 0a20 2020 2020      where(.     
+00002bc0: 2020 2020 2020 2020 2020 2075 625f 6669             ub_fi
+00002bd0: 6e69 7465 2c0a 2020 2020 2020 2020 2020  nite,.          
+00002be0: 2020 2020 2020 302e 3520 2a20 286c 6220        0.5 * (lb 
+00002bf0: 2b20 7562 292c 2020 2320 626f 7468 2062  + ub),  # both b
+00002c00: 6f75 6e64 7320 6669 6e69 7465 0a20 2020  ounds finite.   
+00002c10: 2020 2020 2020 2020 2020 2020 206c 6220               lb 
+00002c20: 2b20 312c 2020 2320 6c6f 7765 7220 626f  + 1,  # lower bo
+00002c30: 756e 6420 6669 6e69 7465 2c20 7570 7065  und finite, uppe
+00002c40: 7220 696e 6669 6e69 7465 0a20 2020 2020  r infinite.     
+00002c50: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
+00002c60: 2020 2020 2020 7768 6572 6528 0a20 2020        where(.   
+00002c70: 2020 2020 2020 2020 2020 2020 2075 625f               ub_
+00002c80: 6669 6e69 7465 2c0a 2020 2020 2020 2020  finite,.        
+00002c90: 2020 2020 2020 2020 7562 202d 2031 2c20          ub - 1, 
+00002ca0: 2023 206c 6f77 6572 2062 6f75 6e64 2069   # lower bound i
+00002cb0: 6e66 696e 6974 652c 2075 7070 6572 2066  nfinite, upper f
+00002cc0: 696e 6974 650a 2020 2020 2020 2020 2020  inite.          
+00002cd0: 2020 2020 2020 302c 2020 2320 626f 7468        0,  # both
+00002ce0: 2062 6f75 6e64 7320 696e 6669 6e69 7465   bounds infinite
+00002cf0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
+00002d00: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00002d10: 2020 7265 7475 726e 2070 300a 0a20 2020    return p0..   
+00002d20: 2070 6172 616d 5f64 6566 6175 6c74 7320   param_defaults 
+00002d30: 3d20 7b70 3a20 3120 666f 7220 7020 696e  = {p: 1 for p in
+00002d40: 2070 6172 616d 737d 0a20 2020 2062 6f75   params}.    bou
+00002d50: 6e64 735f 6465 6661 756c 7473 203d 207b  nds_defaults = {
+00002d60: 703a 2028 2d6e 702e 696e 662c 206e 702e  p: (-np.inf, np.
+00002d70: 696e 6629 2066 6f72 2070 2069 6e20 7061  inf) for p in pa
+00002d80: 7261 6d73 7d0a 2020 2020 666f 7220 7020  rams}.    for p 
+00002d90: 696e 2070 6172 616d 733a 0a20 2020 2020  in params:.     
+00002da0: 2020 2069 6620 7020 696e 2066 756e 635f     if p in func_
+00002db0: 6172 6773 2061 6e64 2066 756e 635f 6172  args and func_ar
+00002dc0: 6773 5b70 5d2e 6465 6661 756c 7420 6973  gs[p].default is
+00002dd0: 206e 6f74 2066 756e 635f 6172 6773 5b70   not func_args[p
+00002de0: 5d2e 656d 7074 793a 0a20 2020 2020 2020  ].empty:.       
+00002df0: 2020 2020 2070 6172 616d 5f64 6566 6175       param_defau
+00002e00: 6c74 735b 705d 203d 2066 756e 635f 6172  lts[p] = func_ar
+00002e10: 6773 5b70 5d2e 6465 6661 756c 740a 2020  gs[p].default.  
+00002e20: 2020 2020 2020 6966 2070 2069 6e20 626f        if p in bo
+00002e30: 756e 6473 3a0a 2020 2020 2020 2020 2020  unds:.          
+00002e40: 2020 6c62 2c20 7562 203d 2062 6f75 6e64    lb, ub = bound
+00002e50: 735b 705d 0a20 2020 2020 2020 2020 2020  s[p].           
+00002e60: 2062 6f75 6e64 735f 6465 6661 756c 7473   bounds_defaults
+00002e70: 5b70 5d20 3d20 286c 622c 2075 6229 0a20  [p] = (lb, ub). 
+00002e80: 2020 2020 2020 2020 2020 2070 6172 616d             param
+00002e90: 5f64 6566 6175 6c74 735b 705d 203d 2077  _defaults[p] = w
+00002ea0: 6865 7265 280a 2020 2020 2020 2020 2020  here(.          
+00002eb0: 2020 2020 2020 2870 6172 616d 5f64 6566        (param_def
+00002ec0: 6175 6c74 735b 705d 203c 206c 6229 207c  aults[p] < lb) |
+00002ed0: 2028 7061 7261 6d5f 6465 6661 756c 7473   (param_defaults
+00002ee0: 5b70 5d20 3e20 7562 292c 0a20 2020 2020  [p] > ub),.     
+00002ef0: 2020 2020 2020 2020 2020 205f 696e 6974             _init
+00002f00: 6961 6c69 7a65 5f66 6561 7369 626c 6528  ialize_feasible(
+00002f10: 6c62 2c20 7562 292c 0a20 2020 2020 2020  lb, ub),.       
+00002f20: 2020 2020 2020 2020 2070 6172 616d 5f64           param_d
+00002f30: 6566 6175 6c74 735b 705d 2c0a 2020 2020  efaults[p],.    
+00002f40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00002f50: 2020 6966 2070 2069 6e20 7030 3a0a 2020    if p in p0:.  
+00002f60: 2020 2020 2020 2020 2020 7061 7261 6d5f            param_
+00002f70: 6465 6661 756c 7473 5b70 5d20 3d20 7030  defaults[p] = p0
+00002f80: 5b70 5d0a 2020 2020 7265 7475 726e 2070  [p].    return p
+00002f90: 6172 616d 5f64 6566 6175 6c74 732c 2062  aram_defaults, b
+00002fa0: 6f75 6e64 735f 6465 6661 756c 7473 0a0a  ounds_defaults..
+00002fb0: 0a63 6c61 7373 2044 6174 6156 6172 6961  .class DataVaria
+00002fc0: 626c 6573 284d 6170 7069 6e67 5b41 6e79  bles(Mapping[Any
+00002fd0: 2c20 2244 6174 6141 7272 6179 225d 293a  , "DataArray"]):
+00002fe0: 0a20 2020 205f 5f73 6c6f 7473 5f5f 203d  .    __slots__ =
+00002ff0: 2028 225f 6461 7461 7365 7422 2c29 0a0a   ("_dataset",)..
+00003000: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+00003010: 2873 656c 662c 2064 6174 6173 6574 3a20  (self, dataset: 
+00003020: 4461 7461 7365 7429 3a0a 2020 2020 2020  Dataset):.      
+00003030: 2020 7365 6c66 2e5f 6461 7461 7365 7420    self._dataset 
+00003040: 3d20 6461 7461 7365 740a 0a20 2020 2064  = dataset..    d
+00003050: 6566 205f 5f69 7465 725f 5f28 7365 6c66  ef __iter__(self
+00003060: 2920 2d3e 2049 7465 7261 746f 725b 4861  ) -> Iterator[Ha
+00003070: 7368 6162 6c65 5d3a 0a20 2020 2020 2020  shable]:.       
+00003080: 2072 6574 7572 6e20 280a 2020 2020 2020   return (.      
+00003090: 2020 2020 2020 6b65 790a 2020 2020 2020        key.      
+000030a0: 2020 2020 2020 666f 7220 6b65 7920 696e        for key in
+000030b0: 2073 656c 662e 5f64 6174 6173 6574 2e5f   self._dataset._
+000030c0: 7661 7269 6162 6c65 730a 2020 2020 2020  variables.      
+000030d0: 2020 2020 2020 6966 206b 6579 206e 6f74        if key not
+000030e0: 2069 6e20 7365 6c66 2e5f 6461 7461 7365   in self._datase
+000030f0: 742e 5f63 6f6f 7264 5f6e 616d 6573 0a20  t._coord_names. 
+00003100: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00003110: 6620 5f5f 6c65 6e5f 5f28 7365 6c66 2920  f __len__(self) 
+00003120: 2d3e 2069 6e74 3a0a 2020 2020 2020 2020  -> int:.        
+00003130: 7265 7475 726e 206c 656e 2873 656c 662e  return len(self.
+00003140: 5f64 6174 6173 6574 2e5f 7661 7269 6162  _dataset._variab
+00003150: 6c65 7329 202d 206c 656e 2873 656c 662e  les) - len(self.
+00003160: 5f64 6174 6173 6574 2e5f 636f 6f72 645f  _dataset._coord_
+00003170: 6e61 6d65 7329 0a0a 2020 2020 6465 6620  names)..    def 
+00003180: 5f5f 636f 6e74 6169 6e73 5f5f 2873 656c  __contains__(sel
+00003190: 662c 206b 6579 3a20 4861 7368 6162 6c65  f, key: Hashable
+000031a0: 2920 2d3e 2062 6f6f 6c3a 0a20 2020 2020  ) -> bool:.     
+000031b0: 2020 2072 6574 7572 6e20 6b65 7920 696e     return key in
+000031c0: 2073 656c 662e 5f64 6174 6173 6574 2e5f   self._dataset._
+000031d0: 7661 7269 6162 6c65 7320 616e 6420 6b65  variables and ke
+000031e0: 7920 6e6f 7420 696e 2073 656c 662e 5f64  y not in self._d
+000031f0: 6174 6173 6574 2e5f 636f 6f72 645f 6e61  ataset._coord_na
+00003200: 6d65 730a 0a20 2020 2064 6566 205f 5f67  mes..    def __g
+00003210: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
+00003220: 6579 3a20 4861 7368 6162 6c65 2920 2d3e  ey: Hashable) ->
+00003230: 2044 6174 6141 7272 6179 3a0a 2020 2020   DataArray:.    
+00003240: 2020 2020 6966 206b 6579 206e 6f74 2069      if key not i
+00003250: 6e20 7365 6c66 2e5f 6461 7461 7365 742e  n self._dataset.
+00003260: 5f63 6f6f 7264 5f6e 616d 6573 3a0a 2020  _coord_names:.  
+00003270: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00003280: 2063 6173 7428 2244 6174 6141 7272 6179   cast("DataArray
+00003290: 222c 2073 656c 662e 5f64 6174 6173 6574  ", self._dataset
+000032a0: 5b6b 6579 5d29 0a20 2020 2020 2020 2072  [key]).        r
+000032b0: 6169 7365 204b 6579 4572 726f 7228 6b65  aise KeyError(ke
+000032c0: 7929 0a0a 2020 2020 6465 6620 5f5f 7265  y)..    def __re
+000032d0: 7072 5f5f 2873 656c 6629 202d 3e20 7374  pr__(self) -> st
+000032e0: 723a 0a20 2020 2020 2020 2072 6574 7572  r:.        retur
+000032f0: 6e20 666f 726d 6174 7469 6e67 2e64 6174  n formatting.dat
+00003300: 615f 7661 7273 5f72 6570 7228 7365 6c66  a_vars_repr(self
+00003310: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+00003320: 0a20 2020 2064 6566 2076 6172 6961 626c  .    def variabl
+00003330: 6573 2873 656c 6629 202d 3e20 4d61 7070  es(self) -> Mapp
+00003340: 696e 675b 4861 7368 6162 6c65 2c20 5661  ing[Hashable, Va
+00003350: 7269 6162 6c65 5d3a 0a20 2020 2020 2020  riable]:.       
+00003360: 2061 6c6c 5f76 6172 6961 626c 6573 203d   all_variables =
+00003370: 2073 656c 662e 5f64 6174 6173 6574 2e76   self._dataset.v
+00003380: 6172 6961 626c 6573 0a20 2020 2020 2020  ariables.       
+00003390: 2072 6574 7572 6e20 4672 6f7a 656e 287b   return Frozen({
+000033a0: 6b3a 2061 6c6c 5f76 6172 6961 626c 6573  k: all_variables
+000033b0: 5b6b 5d20 666f 7220 6b20 696e 2073 656c  [k] for k in sel
+000033c0: 667d 290a 0a20 2020 2040 7072 6f70 6572  f})..    @proper
+000033d0: 7479 0a20 2020 2064 6566 2064 7479 7065  ty.    def dtype
+000033e0: 7328 7365 6c66 2920 2d3e 2046 726f 7a65  s(self) -> Froze
+000033f0: 6e5b 4861 7368 6162 6c65 2c20 6e70 2e64  n[Hashable, np.d
+00003400: 7479 7065 5d3a 0a20 2020 2020 2020 2022  type]:.        "
+00003410: 2222 4d61 7070 696e 6720 6672 6f6d 2064  ""Mapping from d
+00003420: 6174 6120 7661 7269 6162 6c65 206e 616d  ata variable nam
+00003430: 6573 2074 6f20 6474 7970 6573 2e0a 0a20  es to dtypes... 
+00003440: 2020 2020 2020 2043 616e 6e6f 7420 6265         Cannot be
+00003450: 206d 6f64 6966 6965 6420 6469 7265 6374   modified direct
+00003460: 6c79 2c20 6275 7420 6973 2075 7064 6174  ly, but is updat
+00003470: 6564 2077 6865 6e20 6164 6469 6e67 206e  ed when adding n
+00003480: 6577 2076 6172 6961 626c 6573 2e0a 0a20  ew variables... 
+00003490: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+000034a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000034b0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
+000034c0: 2e64 7479 7065 0a20 2020 2020 2020 2022  .dtype.        "
+000034d0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+000034e0: 6e20 7365 6c66 2e5f 6461 7461 7365 742e  n self._dataset.
+000034f0: 6474 7970 6573 0a0a 2020 2020 6465 6620  dtypes..    def 
+00003500: 5f69 7079 7468 6f6e 5f6b 6579 5f63 6f6d  _ipython_key_com
+00003510: 706c 6574 696f 6e73 5f28 7365 6c66 293a  pletions_(self):
+00003520: 0a20 2020 2020 2020 2022 2222 5072 6f76  .        """Prov
+00003530: 6964 6520 6d65 7468 6f64 2066 6f72 2074  ide method for t
+00003540: 6865 206b 6579 2d61 7574 6f63 6f6d 706c  he key-autocompl
+00003550: 6574 696f 6e73 2069 6e20 4950 7974 686f  etions in IPytho
+00003560: 6e2e 2222 220a 2020 2020 2020 2020 7265  n.""".        re
+00003570: 7475 726e 205b 0a20 2020 2020 2020 2020  turn [.         
+00003580: 2020 206b 6579 0a20 2020 2020 2020 2020     key.         
+00003590: 2020 2066 6f72 206b 6579 2069 6e20 7365     for key in se
+000035a0: 6c66 2e5f 6461 7461 7365 742e 5f69 7079  lf._dataset._ipy
+000035b0: 7468 6f6e 5f6b 6579 5f63 6f6d 706c 6574  thon_key_complet
+000035c0: 696f 6e73 5f28 290a 2020 2020 2020 2020  ions_().        
+000035d0: 2020 2020 6966 206b 6579 206e 6f74 2069      if key not i
+000035e0: 6e20 7365 6c66 2e5f 6461 7461 7365 742e  n self._dataset.
+000035f0: 5f63 6f6f 7264 5f6e 616d 6573 0a20 2020  _coord_names.   
+00003600: 2020 2020 205d 0a0a 0a63 6c61 7373 205f       ]...class _
+00003610: 4c6f 6349 6e64 6578 6572 2847 656e 6572  LocIndexer(Gener
+00003620: 6963 5b54 5f44 6174 6173 6574 5d29 3a0a  ic[T_Dataset]):.
+00003630: 2020 2020 5f5f 736c 6f74 735f 5f20 3d20      __slots__ = 
+00003640: 2822 6461 7461 7365 7422 2c29 0a0a 2020  ("dataset",)..  
+00003650: 2020 6465 6620 5f5f 696e 6974 5f5f 2873    def __init__(s
+00003660: 656c 662c 2064 6174 6173 6574 3a20 545f  elf, dataset: T_
+00003670: 4461 7461 7365 7429 3a0a 2020 2020 2020  Dataset):.      
+00003680: 2020 7365 6c66 2e64 6174 6173 6574 203d    self.dataset =
+00003690: 2064 6174 6173 6574 0a0a 2020 2020 6465   dataset..    de
+000036a0: 6620 5f5f 6765 7469 7465 6d5f 5f28 7365  f __getitem__(se
+000036b0: 6c66 2c20 6b65 793a 204d 6170 7069 6e67  lf, key: Mapping
+000036c0: 5b41 6e79 2c20 416e 795d 2920 2d3e 2054  [Any, Any]) -> T
+000036d0: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
+000036e0: 2020 6966 206e 6f74 2075 7469 6c73 2e69    if not utils.i
+000036f0: 735f 6469 6374 5f6c 696b 6528 6b65 7929  s_dict_like(key)
+00003700: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00003710: 6973 6520 5479 7065 4572 726f 7228 2263  ise TypeError("c
+00003720: 616e 206f 6e6c 7920 6c6f 6f6b 7570 2064  an only lookup d
+00003730: 6963 7469 6f6e 6172 6965 7320 6672 6f6d  ictionaries from
+00003740: 2044 6174 6173 6574 2e6c 6f63 2229 0a20   Dataset.loc"). 
+00003750: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00003760: 6c66 2e64 6174 6173 6574 2e73 656c 286b  lf.dataset.sel(k
+00003770: 6579 290a 0a20 2020 2064 6566 205f 5f73  ey)..    def __s
+00003780: 6574 6974 656d 5f5f 2873 656c 662c 206b  etitem__(self, k
+00003790: 6579 2c20 7661 6c75 6529 202d 3e20 4e6f  ey, value) -> No
+000037a0: 6e65 3a0a 2020 2020 2020 2020 6966 206e  ne:.        if n
+000037b0: 6f74 2075 7469 6c73 2e69 735f 6469 6374  ot utils.is_dict
+000037c0: 5f6c 696b 6528 6b65 7929 3a0a 2020 2020  _like(key):.    
+000037d0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+000037e0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+000037f0: 2020 2020 2020 2020 2022 6361 6e20 6f6e           "can on
+00003800: 6c79 2073 6574 206c 6f63 6174 696f 6e73  ly set locations
+00003810: 2064 6566 696e 6564 2062 7920 6469 6374   defined by dict
+00003820: 696f 6e61 7269 6573 2066 726f 6d20 4461  ionaries from Da
+00003830: 7461 7365 742e 6c6f 632e 220a 2020 2020  taset.loc.".    
+00003840: 2020 2020 2020 2020 2020 2020 6622 2047              f" G
+00003850: 6f74 3a20 7b6b 6579 7d22 0a20 2020 2020  ot: {key}".     
+00003860: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+00003870: 2020 2320 7365 7420 6e65 7720 7661 6c75    # set new valu
+00003880: 6573 0a20 2020 2020 2020 2064 696d 5f69  es.        dim_i
+00003890: 6e64 6578 6572 7320 3d20 6d61 705f 696e  ndexers = map_in
+000038a0: 6465 785f 7175 6572 6965 7328 7365 6c66  dex_queries(self
+000038b0: 2e64 6174 6173 6574 2c20 6b65 7929 2e64  .dataset, key).d
+000038c0: 696d 5f69 6e64 6578 6572 730a 2020 2020  im_indexers.    
+000038d0: 2020 2020 7365 6c66 2e64 6174 6173 6574      self.dataset
+000038e0: 5b64 696d 5f69 6e64 6578 6572 735d 203d  [dim_indexers] =
+000038f0: 2076 616c 7565 0a0a 0a63 6c61 7373 2044   value...class D
+00003900: 6174 6173 6574 280a 2020 2020 4461 7461  ataset(.    Data
+00003910: 5769 7468 436f 6f72 6473 2c0a 2020 2020  WithCoords,.    
+00003920: 4461 7461 7365 7441 6767 7265 6761 7469  DatasetAggregati
+00003930: 6f6e 732c 0a20 2020 2044 6174 6173 6574  ons,.    Dataset
+00003940: 4172 6974 686d 6574 6963 2c0a 2020 2020  Arithmetic,.    
+00003950: 4d61 7070 696e 675b 4861 7368 6162 6c65  Mapping[Hashable
+00003960: 2c20 2244 6174 6141 7272 6179 225d 2c0a  , "DataArray"],.
+00003970: 293a 0a20 2020 2022 2222 4120 6d75 6c74  ):.    """A mult
+00003980: 692d 6469 6d65 6e73 696f 6e61 6c2c 2069  i-dimensional, i
+00003990: 6e20 6d65 6d6f 7279 2c20 6172 7261 7920  n memory, array 
+000039a0: 6461 7461 6261 7365 2e0a 0a20 2020 2041  database...    A
+000039b0: 2064 6174 6173 6574 2072 6573 656d 626c   dataset resembl
+000039c0: 6573 2061 6e20 696e 2d6d 656d 6f72 7920  es an in-memory 
+000039d0: 7265 7072 6573 656e 7461 7469 6f6e 206f  representation o
+000039e0: 6620 6120 4e65 7443 4446 2066 696c 652c  f a NetCDF file,
+000039f0: 0a20 2020 2061 6e64 2063 6f6e 7369 7374  .    and consist
+00003a00: 7320 6f66 2076 6172 6961 626c 6573 2c20  s of variables, 
+00003a10: 636f 6f72 6469 6e61 7465 7320 616e 6420  coordinates and 
+00003a20: 6174 7472 6962 7574 6573 2077 6869 6368  attributes which
+00003a30: 0a20 2020 2074 6f67 6574 6865 7220 666f  .    together fo
+00003a40: 726d 2061 2073 656c 6620 6465 7363 7269  rm a self descri
+00003a50: 6269 6e67 2064 6174 6173 6574 2e0a 0a20  bing dataset... 
+00003a60: 2020 2044 6174 6173 6574 2069 6d70 6c65     Dataset imple
+00003a70: 6d65 6e74 7320 7468 6520 6d61 7070 696e  ments the mappin
+00003a80: 6720 696e 7465 7266 6163 6520 7769 7468  g interface with
+00003a90: 206b 6579 7320 6769 7665 6e20 6279 2076   keys given by v
+00003aa0: 6172 6961 626c 650a 2020 2020 6e61 6d65  ariable.    name
+00003ab0: 7320 616e 6420 7661 6c75 6573 2067 6976  s and values giv
+00003ac0: 656e 2062 7920 4461 7461 4172 7261 7920  en by DataArray 
+00003ad0: 6f62 6a65 6374 7320 666f 7220 6561 6368  objects for each
+00003ae0: 2076 6172 6961 626c 6520 6e61 6d65 2e0a   variable name..
+00003af0: 0a20 2020 204f 6e65 2064 696d 656e 7369  .    One dimensi
+00003b00: 6f6e 616c 2076 6172 6961 626c 6573 2077  onal variables w
+00003b10: 6974 6820 6e61 6d65 2065 7175 616c 2074  ith name equal t
+00003b20: 6f20 7468 6569 7220 6469 6d65 6e73 696f  o their dimensio
+00003b30: 6e20 6172 650a 2020 2020 696e 6465 7820  n are.    index 
+00003b40: 636f 6f72 6469 6e61 7465 7320 7573 6564  coordinates used
+00003b50: 2066 6f72 206c 6162 656c 2062 6173 6564   for label based
+00003b60: 2069 6e64 6578 696e 672e 0a0a 2020 2020   indexing...    
+00003b70: 546f 206c 6f61 6420 6461 7461 2066 726f  To load data fro
+00003b80: 6d20 6120 6669 6c65 206f 7220 6669 6c65  m a file or file
+00003b90: 2d6c 696b 6520 6f62 6a65 6374 2c20 7573  -like object, us
+00003ba0: 6520 7468 6520 606f 7065 6e5f 6461 7461  e the `open_data
+00003bb0: 7365 7460 0a20 2020 2066 756e 6374 696f  set`.    functio
+00003bc0: 6e2e 0a0a 2020 2020 5061 7261 6d65 7465  n...    Paramete
+00003bd0: 7273 0a20 2020 202d 2d2d 2d2d 2d2d 2d2d  rs.    ---------
+00003be0: 2d0a 2020 2020 6461 7461 5f76 6172 7320  -.    data_vars 
+00003bf0: 3a20 6469 6374 2d6c 696b 652c 206f 7074  : dict-like, opt
+00003c00: 696f 6e61 6c0a 2020 2020 2020 2020 4120  ional.        A 
+00003c10: 6d61 7070 696e 6720 6672 6f6d 2076 6172  mapping from var
+00003c20: 6961 626c 6520 6e61 6d65 7320 746f 203a  iable names to :
+00003c30: 7079 3a63 6c61 7373 3a60 7e78 6172 7261  py:class:`~xarra
+00003c40: 792e 4461 7461 4172 7261 7960 0a20 2020  y.DataArray`.   
+00003c50: 2020 2020 206f 626a 6563 7473 2c20 3a70       objects, :p
+00003c60: 793a 636c 6173 733a 607e 7861 7272 6179  y:class:`~xarray
+00003c70: 2e56 6172 6961 626c 6560 206f 626a 6563  .Variable` objec
+00003c80: 7473 206f 7220 746f 2074 7570 6c65 7320  ts or to tuples 
+00003c90: 6f66 0a20 2020 2020 2020 2074 6865 2066  of.        the f
+00003ca0: 6f72 6d20 6060 2864 696d 732c 2064 6174  orm ``(dims, dat
+00003cb0: 615b 2c20 6174 7472 735d 2960 6020 7768  a[, attrs])`` wh
+00003cc0: 6963 6820 6361 6e20 6265 2075 7365 6420  ich can be used 
+00003cd0: 6173 0a20 2020 2020 2020 2061 7267 756d  as.        argum
+00003ce0: 656e 7473 2074 6f20 6372 6561 7465 2061  ents to create a
+00003cf0: 206e 6577 2060 6056 6172 6961 626c 6560   new ``Variable`
+00003d00: 602e 2045 6163 6820 6469 6d65 6e73 696f  `. Each dimensio
+00003d10: 6e20 6d75 7374 0a20 2020 2020 2020 2068  n must.        h
+00003d20: 6176 6520 7468 6520 7361 6d65 206c 656e  ave the same len
+00003d30: 6774 6820 696e 2061 6c6c 2076 6172 6961  gth in all varia
+00003d40: 626c 6573 2069 6e20 7768 6963 6820 6974  bles in which it
+00003d50: 2061 7070 6561 7273 2e0a 0a20 2020 2020   appears...     
+00003d60: 2020 2054 6865 2066 6f6c 6c6f 7769 6e67     The following
+00003d70: 206e 6f74 6174 696f 6e73 2061 7265 2061   notations are a
+00003d80: 6363 6570 7465 643a 0a0a 2020 2020 2020  ccepted:..      
+00003d90: 2020 2d20 6d61 7070 696e 6720 7b76 6172    - mapping {var
+00003da0: 206e 616d 653a 2044 6174 6141 7272 6179   name: DataArray
+00003db0: 7d0a 2020 2020 2020 2020 2d20 6d61 7070  }.        - mapp
+00003dc0: 696e 6720 7b76 6172 206e 616d 653a 2056  ing {var name: V
+00003dd0: 6172 6961 626c 657d 0a20 2020 2020 2020  ariable}.       
+00003de0: 202d 206d 6170 7069 6e67 207b 7661 7220   - mapping {var 
+00003df0: 6e61 6d65 3a20 2864 696d 656e 7369 6f6e  name: (dimension
+00003e00: 206e 616d 652c 2061 7272 6179 2d6c 696b   name, array-lik
+00003e10: 6529 7d0a 2020 2020 2020 2020 2d20 6d61  e)}.        - ma
+00003e20: 7070 696e 6720 7b76 6172 206e 616d 653a  pping {var name:
+00003e30: 2028 7475 706c 6520 6f66 2064 696d 656e   (tuple of dimen
+00003e40: 7369 6f6e 206e 616d 6573 2c20 6172 7261  sion names, arra
+00003e50: 792d 6c69 6b65 297d 0a20 2020 2020 2020  y-like)}.       
+00003e60: 202d 206d 6170 7069 6e67 207b 6469 6d65   - mapping {dime
+00003e70: 6e73 696f 6e20 6e61 6d65 3a20 6172 7261  nsion name: arra
+00003e80: 792d 6c69 6b65 7d0a 2020 2020 2020 2020  y-like}.        
+00003e90: 2020 2869 7420 7769 6c6c 2062 6520 6175    (it will be au
+00003ea0: 746f 6d61 7469 6361 6c6c 7920 6d6f 7665  tomatically move
+00003eb0: 6420 746f 2063 6f6f 7264 732c 2073 6565  d to coords, see
+00003ec0: 2062 656c 6f77 290a 0a20 2020 2020 2020   below)..       
+00003ed0: 2045 6163 6820 6469 6d65 6e73 696f 6e20   Each dimension 
+00003ee0: 6d75 7374 2068 6176 6520 7468 6520 7361  must have the sa
+00003ef0: 6d65 206c 656e 6774 6820 696e 2061 6c6c  me length in all
+00003f00: 2076 6172 6961 626c 6573 2069 6e0a 2020   variables in.  
+00003f10: 2020 2020 2020 7768 6963 6820 6974 2061        which it a
+00003f20: 7070 6561 7273 2e0a 2020 2020 636f 6f72  ppears..    coor
+00003f30: 6473 203a 2064 6963 742d 6c69 6b65 2c20  ds : dict-like, 
+00003f40: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00003f50: 2041 6e6f 7468 6572 206d 6170 7069 6e67   Another mapping
+00003f60: 2069 6e20 7369 6d69 6c61 7220 666f 726d   in similar form
+00003f70: 2061 7320 7468 6520 6064 6174 615f 7661   as the `data_va
+00003f80: 7273 6020 6172 6775 6d65 6e74 2c0a 2020  rs` argument,.  
+00003f90: 2020 2020 2020 6578 6365 7074 2074 6865        except the
+00003fa0: 2065 6163 6820 6974 656d 2069 7320 7361   each item is sa
+00003fb0: 7665 6420 6f6e 2074 6865 2064 6174 6173  ved on the datas
+00003fc0: 6574 2061 7320 6120 2263 6f6f 7264 696e  et as a "coordin
+00003fd0: 6174 6522 2e0a 2020 2020 2020 2020 5468  ate"..        Th
+00003fe0: 6573 6520 7661 7269 6162 6c65 7320 6861  ese variables ha
+00003ff0: 7665 2061 6e20 6173 736f 6369 6174 6564  ve an associated
+00004000: 206d 6561 6e69 6e67 3a20 7468 6579 2064   meaning: they d
+00004010: 6573 6372 6962 650a 2020 2020 2020 2020  escribe.        
+00004020: 636f 6e73 7461 6e74 2f66 6978 6564 2f69  constant/fixed/i
+00004030: 6e64 6570 656e 6465 6e74 2071 7561 6e74  ndependent quant
+00004040: 6974 6965 732c 2075 6e6c 696b 6520 7468  ities, unlike th
+00004050: 650a 2020 2020 2020 2020 7661 7279 696e  e.        varyin
+00004060: 672f 6d65 6173 7572 6564 2f64 6570 656e  g/measured/depen
+00004070: 6465 6e74 2071 7561 6e74 6974 6965 7320  dent quantities 
+00004080: 7468 6174 2062 656c 6f6e 6720 696e 0a20  that belong in. 
+00004090: 2020 2020 2020 2060 7661 7269 6162 6c65         `variable
+000040a0: 7360 2e20 436f 6f72 6469 6e61 7465 7320  s`. Coordinates 
+000040b0: 7661 6c75 6573 206d 6179 2062 6520 6769  values may be gi
+000040c0: 7665 6e20 6279 2031 2d64 696d 656e 7369  ven by 1-dimensi
+000040d0: 6f6e 616c 0a20 2020 2020 2020 2061 7272  onal.        arr
+000040e0: 6179 7320 6f72 2073 6361 6c61 7273 2c20  ays or scalars, 
+000040f0: 696e 2077 6869 6368 2063 6173 6520 6064  in which case `d
+00004100: 696d 7360 2064 6f20 6e6f 7420 6e65 6564  ims` do not need
+00004110: 2074 6f20 6265 0a20 2020 2020 2020 2073   to be.        s
+00004120: 7570 706c 6965 643a 2031 4420 6172 7261  upplied: 1D arra
+00004130: 7973 2077 696c 6c20 6265 2061 7373 756d  ys will be assum
+00004140: 6564 2074 6f20 6769 7665 2069 6e64 6578  ed to give index
+00004150: 2076 616c 7565 7320 616c 6f6e 670a 2020   values along.  
+00004160: 2020 2020 2020 7468 6520 6469 6d65 6e73        the dimens
+00004170: 696f 6e20 7769 7468 2074 6865 2073 616d  ion with the sam
+00004180: 6520 6e61 6d65 2e0a 0a20 2020 2020 2020  e name...       
+00004190: 2054 6865 2066 6f6c 6c6f 7769 6e67 206e   The following n
+000041a0: 6f74 6174 696f 6e73 2061 7265 2061 6363  otations are acc
+000041b0: 6570 7465 643a 0a0a 2020 2020 2020 2020  epted:..        
+000041c0: 2d20 6d61 7070 696e 6720 7b63 6f6f 7264  - mapping {coord
+000041d0: 206e 616d 653a 2044 6174 6141 7272 6179   name: DataArray
+000041e0: 7d0a 2020 2020 2020 2020 2d20 6d61 7070  }.        - mapp
+000041f0: 696e 6720 7b63 6f6f 7264 206e 616d 653a  ing {coord name:
+00004200: 2056 6172 6961 626c 657d 0a20 2020 2020   Variable}.     
+00004210: 2020 202d 206d 6170 7069 6e67 207b 636f     - mapping {co
+00004220: 6f72 6420 6e61 6d65 3a20 2864 696d 656e  ord name: (dimen
+00004230: 7369 6f6e 206e 616d 652c 2061 7272 6179  sion name, array
+00004240: 2d6c 696b 6529 7d0a 2020 2020 2020 2020  -like)}.        
+00004250: 2d20 6d61 7070 696e 6720 7b63 6f6f 7264  - mapping {coord
+00004260: 206e 616d 653a 2028 7475 706c 6520 6f66   name: (tuple of
+00004270: 2064 696d 656e 7369 6f6e 206e 616d 6573   dimension names
+00004280: 2c20 6172 7261 792d 6c69 6b65 297d 0a20  , array-like)}. 
+00004290: 2020 2020 2020 202d 206d 6170 7069 6e67         - mapping
+000042a0: 207b 6469 6d65 6e73 696f 6e20 6e61 6d65   {dimension name
+000042b0: 3a20 6172 7261 792d 6c69 6b65 7d0a 2020  : array-like}.  
+000042c0: 2020 2020 2020 2020 2874 6865 2064 696d          (the dim
+000042d0: 656e 7369 6f6e 206e 616d 6520 6973 2069  ension name is i
+000042e0: 6d70 6c69 6369 746c 7920 7365 7420 746f  mplicitly set to
+000042f0: 2062 6520 7468 6520 7361 6d65 2061 7320   be the same as 
+00004300: 7468 650a 2020 2020 2020 2020 2020 636f  the.          co
+00004310: 6f72 6420 6e61 6d65 290a 0a20 2020 2020  ord name)..     
+00004320: 2020 2054 6865 206c 6173 7420 6e6f 7461     The last nota
+00004330: 7469 6f6e 2069 6d70 6c69 6573 2074 6861  tion implies tha
+00004340: 7420 7468 6520 636f 6f72 6420 6e61 6d65  t the coord name
+00004350: 2069 7320 7468 6520 7361 6d65 2061 730a   is the same as.
+00004360: 2020 2020 2020 2020 7468 6520 6469 6d65          the dime
+00004370: 6e73 696f 6e20 6e61 6d65 2e0a 0a20 2020  nsion name...   
+00004380: 2061 7474 7273 203a 2064 6963 742d 6c69   attrs : dict-li
+00004390: 6b65 2c20 6f70 7469 6f6e 616c 0a20 2020  ke, optional.   
+000043a0: 2020 2020 2047 6c6f 6261 6c20 6174 7472       Global attr
+000043b0: 6962 7574 6573 2074 6f20 7361 7665 206f  ibutes to save o
+000043c0: 6e20 7468 6973 2064 6174 6173 6574 2e0a  n this dataset..
+000043d0: 0a20 2020 2045 7861 6d70 6c65 730a 2020  .    Examples.  
+000043e0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2043    --------.    C
+000043f0: 7265 6174 6520 6461 7461 3a0a 0a20 2020  reate data:..   
+00004400: 203e 3e3e 206e 702e 7261 6e64 6f6d 2e73   >>> np.random.s
+00004410: 6565 6428 3029 0a20 2020 203e 3e3e 2074  eed(0).    >>> t
+00004420: 656d 7065 7261 7475 7265 203d 2031 3520  emperature = 15 
+00004430: 2b20 3820 2a20 6e70 2e72 616e 646f 6d2e  + 8 * np.random.
+00004440: 7261 6e64 6e28 322c 2032 2c20 3329 0a20  randn(2, 2, 3). 
+00004450: 2020 203e 3e3e 2070 7265 6369 7069 7461     >>> precipita
+00004460: 7469 6f6e 203d 2031 3020 2a20 6e70 2e72  tion = 10 * np.r
+00004470: 616e 646f 6d2e 7261 6e64 2832 2c20 322c  andom.rand(2, 2,
+00004480: 2033 290a 2020 2020 3e3e 3e20 6c6f 6e20   3).    >>> lon 
+00004490: 3d20 5b5b 2d39 392e 3833 2c20 2d39 392e  = [[-99.83, -99.
+000044a0: 3332 5d2c 205b 2d39 392e 3739 2c20 2d39  32], [-99.79, -9
+000044b0: 392e 3233 5d5d 0a20 2020 203e 3e3e 206c  9.23]].    >>> l
+000044c0: 6174 203d 205b 5b34 322e 3235 2c20 3432  at = [[42.25, 42
+000044d0: 2e32 315d 2c20 5b34 322e 3633 2c20 3432  .21], [42.63, 42
+000044e0: 2e35 395d 5d0a 2020 2020 3e3e 3e20 7469  .59]].    >>> ti
+000044f0: 6d65 203d 2070 642e 6461 7465 5f72 616e  me = pd.date_ran
+00004500: 6765 2822 3230 3134 2d30 392d 3036 222c  ge("2014-09-06",
+00004510: 2070 6572 696f 6473 3d33 290a 2020 2020   periods=3).    
+00004520: 3e3e 3e20 7265 6665 7265 6e63 655f 7469  >>> reference_ti
+00004530: 6d65 203d 2070 642e 5469 6d65 7374 616d  me = pd.Timestam
+00004540: 7028 2232 3031 342d 3039 2d30 3522 290a  p("2014-09-05").
+00004550: 0a20 2020 2049 6e69 7469 616c 697a 6520  .    Initialize 
+00004560: 6120 6461 7461 7365 7420 7769 7468 206d  a dataset with m
+00004570: 756c 7469 706c 6520 6469 6d65 6e73 696f  ultiple dimensio
+00004580: 6e73 3a0a 0a20 2020 203e 3e3e 2064 7320  ns:..    >>> ds 
+00004590: 3d20 7872 2e44 6174 6173 6574 280a 2020  = xr.Dataset(.  
+000045a0: 2020 2e2e 2e20 2020 2020 6461 7461 5f76    ...     data_v
+000045b0: 6172 733d 6469 6374 280a 2020 2020 2e2e  ars=dict(.    ..
+000045c0: 2e20 2020 2020 2020 2020 7465 6d70 6572  .         temper
+000045d0: 6174 7572 653d 285b 2278 222c 2022 7922  ature=(["x", "y"
+000045e0: 2c20 2274 696d 6522 5d2c 2074 656d 7065  , "time"], tempe
+000045f0: 7261 7475 7265 292c 0a20 2020 202e 2e2e  rature),.    ...
+00004600: 2020 2020 2020 2020 2070 7265 6369 7069           precipi
+00004610: 7461 7469 6f6e 3d28 5b22 7822 2c20 2279  tation=(["x", "y
+00004620: 222c 2022 7469 6d65 225d 2c20 7072 6563  ", "time"], prec
+00004630: 6970 6974 6174 696f 6e29 2c0a 2020 2020  ipitation),.    
+00004640: 2e2e 2e20 2020 2020 292c 0a20 2020 202e  ...     ),.    .
+00004650: 2e2e 2020 2020 2063 6f6f 7264 733d 6469  ..     coords=di
+00004660: 6374 280a 2020 2020 2e2e 2e20 2020 2020  ct(.    ...     
+00004670: 2020 2020 6c6f 6e3d 285b 2278 222c 2022      lon=(["x", "
+00004680: 7922 5d2c 206c 6f6e 292c 0a20 2020 202e  y"], lon),.    .
+00004690: 2e2e 2020 2020 2020 2020 206c 6174 3d28  ..         lat=(
+000046a0: 5b22 7822 2c20 2279 225d 2c20 6c61 7429  ["x", "y"], lat)
+000046b0: 2c0a 2020 2020 2e2e 2e20 2020 2020 2020  ,.    ...       
+000046c0: 2020 7469 6d65 3d74 696d 652c 0a20 2020    time=time,.   
+000046d0: 202e 2e2e 2020 2020 2020 2020 2072 6566   ...         ref
+000046e0: 6572 656e 6365 5f74 696d 653d 7265 6665  erence_time=refe
+000046f0: 7265 6e63 655f 7469 6d65 2c0a 2020 2020  rence_time,.    
+00004700: 2e2e 2e20 2020 2020 292c 0a20 2020 202e  ...     ),.    .
+00004710: 2e2e 2020 2020 2061 7474 7273 3d64 6963  ..     attrs=dic
+00004720: 7428 6465 7363 7269 7074 696f 6e3d 2257  t(description="W
+00004730: 6561 7468 6572 2072 656c 6174 6564 2064  eather related d
+00004740: 6174 612e 2229 2c0a 2020 2020 2e2e 2e20  ata."),.    ... 
+00004750: 290a 2020 2020 3e3e 3e20 6473 0a20 2020  ).    >>> ds.   
+00004760: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+00004770: 3e0a 2020 2020 4469 6d65 6e73 696f 6e73  >.    Dimensions
+00004780: 3a20 2020 2020 2020 2020 2878 3a20 322c  :         (x: 2,
+00004790: 2079 3a20 322c 2074 696d 653a 2033 290a   y: 2, time: 3).
+000047a0: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
+000047b0: 0a20 2020 2020 2020 206c 6f6e 2020 2020  .        lon    
+000047c0: 2020 2020 2020 2020 2028 782c 2079 2920           (x, y) 
+000047d0: 666c 6f61 7436 3420 2d39 392e 3833 202d  float64 -99.83 -
+000047e0: 3939 2e33 3220 2d39 392e 3739 202d 3939  99.32 -99.79 -99
+000047f0: 2e32 330a 2020 2020 2020 2020 6c61 7420  .23.        lat 
+00004800: 2020 2020 2020 2020 2020 2020 2878 2c20              (x, 
+00004810: 7929 2066 6c6f 6174 3634 2034 322e 3235  y) float64 42.25
+00004820: 2034 322e 3231 2034 322e 3633 2034 322e   42.21 42.63 42.
+00004830: 3539 0a20 2020 2020 202a 2074 696d 6520  59.      * time 
+00004840: 2020 2020 2020 2020 2020 2028 7469 6d65             (time
+00004850: 2920 6461 7465 7469 6d65 3634 5b6e 735d  ) datetime64[ns]
+00004860: 2032 3031 342d 3039 2d30 3620 3230 3134   2014-09-06 2014
+00004870: 2d30 392d 3037 2032 3031 342d 3039 2d30  -09-07 2014-09-0
+00004880: 380a 2020 2020 2020 2020 7265 6665 7265  8.        refere
+00004890: 6e63 655f 7469 6d65 2020 6461 7465 7469  nce_time  dateti
+000048a0: 6d65 3634 5b6e 735d 2032 3031 342d 3039  me64[ns] 2014-09
+000048b0: 2d30 350a 2020 2020 4469 6d65 6e73 696f  -05.    Dimensio
+000048c0: 6e73 2077 6974 686f 7574 2063 6f6f 7264  ns without coord
+000048d0: 696e 6174 6573 3a20 782c 2079 0a20 2020  inates: x, y.   
+000048e0: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
+000048f0: 0a20 2020 2020 2020 2074 656d 7065 7261  .        tempera
+00004900: 7475 7265 2020 2020 2028 782c 2079 2c20  ture     (x, y, 
+00004910: 7469 6d65 2920 666c 6f61 7436 3420 3239  time) float64 29
+00004920: 2e31 3120 3138 2e32 2032 322e 3833 202e  .11 18.2 22.83 .
+00004930: 2e2e 2031 382e 3238 2031 362e 3135 2032  .. 18.28 16.15 2
+00004940: 362e 3633 0a20 2020 2020 2020 2070 7265  6.63.        pre
+00004950: 6369 7069 7461 7469 6f6e 2020 2028 782c  cipitation   (x,
+00004960: 2079 2c20 7469 6d65 2920 666c 6f61 7436   y, time) float6
+00004970: 3420 352e 3638 2039 2e32 3536 2030 2e37  4 5.68 9.256 0.7
+00004980: 3130 3420 2e2e 2e20 372e 3939 3220 342e  104 ... 7.992 4.
+00004990: 3631 3520 372e 3830 350a 2020 2020 4174  615 7.805.    At
+000049a0: 7472 6962 7574 6573 3a0a 2020 2020 2020  tributes:.      
+000049b0: 2020 6465 7363 7269 7074 696f 6e3a 2020    description:  
+000049c0: 5765 6174 6865 7220 7265 6c61 7465 6420  Weather related 
+000049d0: 6461 7461 2e0a 0a20 2020 2046 696e 6420  data...    Find 
+000049e0: 6f75 7420 7768 6572 6520 7468 6520 636f  out where the co
+000049f0: 6c64 6573 7420 7465 6d70 6572 6174 7572  ldest temperatur
+00004a00: 6520 7761 7320 616e 6420 7768 6174 2076  e was and what v
+00004a10: 616c 7565 7320 7468 650a 2020 2020 6f74  alues the.    ot
+00004a20: 6865 7220 7661 7269 6162 6c65 7320 6861  her variables ha
+00004a30: 643a 0a0a 2020 2020 3e3e 3e20 6473 2e69  d:..    >>> ds.i
+00004a40: 7365 6c28 6473 2e74 656d 7065 7261 7475  sel(ds.temperatu
+00004a50: 7265 2e61 7267 6d69 6e28 2e2e 2e29 290a  re.argmin(...)).
+00004a60: 2020 2020 3c78 6172 7261 792e 4461 7461      <xarray.Data
+00004a70: 7365 743e 0a20 2020 2044 696d 656e 7369  set>.    Dimensi
+00004a80: 6f6e 733a 2020 2020 2020 2020 2028 290a  ons:         ().
+00004a90: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
+00004aa0: 0a20 2020 2020 2020 206c 6f6e 2020 2020  .        lon    
+00004ab0: 2020 2020 2020 2020 2066 6c6f 6174 3634           float64
+00004ac0: 202d 3939 2e33 320a 2020 2020 2020 2020   -99.32.        
+00004ad0: 6c61 7420 2020 2020 2020 2020 2020 2020  lat             
+00004ae0: 666c 6f61 7436 3420 3432 2e32 310a 2020  float64 42.21.  
+00004af0: 2020 2020 2020 7469 6d65 2020 2020 2020        time      
+00004b00: 2020 2020 2020 6461 7465 7469 6d65 3634        datetime64
+00004b10: 5b6e 735d 2032 3031 342d 3039 2d30 380a  [ns] 2014-09-08.
+00004b20: 2020 2020 2020 2020 7265 6665 7265 6e63          referenc
+00004b30: 655f 7469 6d65 2020 6461 7465 7469 6d65  e_time  datetime
+00004b40: 3634 5b6e 735d 2032 3031 342d 3039 2d30  64[ns] 2014-09-0
+00004b50: 350a 2020 2020 4461 7461 2076 6172 6961  5.    Data varia
+00004b60: 626c 6573 3a0a 2020 2020 2020 2020 7465  bles:.        te
+00004b70: 6d70 6572 6174 7572 6520 2020 2020 666c  mperature     fl
+00004b80: 6f61 7436 3420 372e 3138 320a 2020 2020  oat64 7.182.    
+00004b90: 2020 2020 7072 6563 6970 6974 6174 696f      precipitatio
+00004ba0: 6e20 2020 666c 6f61 7436 3420 382e 3332  n   float64 8.32
+00004bb0: 360a 2020 2020 4174 7472 6962 7574 6573  6.    Attributes
+00004bc0: 3a0a 2020 2020 2020 2020 6465 7363 7269  :.        descri
+00004bd0: 7074 696f 6e3a 2020 5765 6174 6865 7220  ption:  Weather 
+00004be0: 7265 6c61 7465 6420 6461 7461 2e0a 2020  related data..  
+00004bf0: 2020 2222 220a 0a20 2020 205f 6174 7472    """..    _attr
+00004c00: 733a 2064 6963 745b 4861 7368 6162 6c65  s: dict[Hashable
+00004c10: 2c20 416e 795d 207c 204e 6f6e 650a 2020  , Any] | None.  
+00004c20: 2020 5f63 6163 6865 3a20 6469 6374 5b73    _cache: dict[s
+00004c30: 7472 2c20 416e 795d 0a20 2020 205f 636f  tr, Any].    _co
+00004c40: 6f72 645f 6e61 6d65 733a 2073 6574 5b48  ord_names: set[H
+00004c50: 6173 6861 626c 655d 0a20 2020 205f 6469  ashable].    _di
+00004c60: 6d73 3a20 6469 6374 5b48 6173 6861 626c  ms: dict[Hashabl
+00004c70: 652c 2069 6e74 5d0a 2020 2020 5f65 6e63  e, int].    _enc
+00004c80: 6f64 696e 673a 2064 6963 745b 4861 7368  oding: dict[Hash
+00004c90: 6162 6c65 2c20 416e 795d 207c 204e 6f6e  able, Any] | Non
+00004ca0: 650a 2020 2020 5f63 6c6f 7365 3a20 4361  e.    _close: Ca
+00004cb0: 6c6c 6162 6c65 5b5b 5d2c 204e 6f6e 655d  llable[[], None]
+00004cc0: 207c 204e 6f6e 650a 2020 2020 5f69 6e64   | None.    _ind
+00004cd0: 6578 6573 3a20 6469 6374 5b48 6173 6861  exes: dict[Hasha
+00004ce0: 626c 652c 2049 6e64 6578 5d0a 2020 2020  ble, Index].    
+00004cf0: 5f76 6172 6961 626c 6573 3a20 6469 6374  _variables: dict
+00004d00: 5b48 6173 6861 626c 652c 2056 6172 6961  [Hashable, Varia
+00004d10: 626c 655d 0a0a 2020 2020 5f5f 736c 6f74  ble]..    __slot
+00004d20: 735f 5f20 3d20 280a 2020 2020 2020 2020  s__ = (.        
+00004d30: 225f 6174 7472 7322 2c0a 2020 2020 2020  "_attrs",.      
+00004d40: 2020 225f 6361 6368 6522 2c0a 2020 2020    "_cache",.    
+00004d50: 2020 2020 225f 636f 6f72 645f 6e61 6d65      "_coord_name
+00004d60: 7322 2c0a 2020 2020 2020 2020 225f 6469  s",.        "_di
+00004d70: 6d73 222c 0a20 2020 2020 2020 2022 5f65  ms",.        "_e
+00004d80: 6e63 6f64 696e 6722 2c0a 2020 2020 2020  ncoding",.      
+00004d90: 2020 225f 636c 6f73 6522 2c0a 2020 2020    "_close",.    
+00004da0: 2020 2020 225f 696e 6465 7865 7322 2c0a      "_indexes",.
+00004db0: 2020 2020 2020 2020 225f 7661 7269 6162          "_variab
+00004dc0: 6c65 7322 2c0a 2020 2020 2020 2020 225f  les",.        "_
+00004dd0: 5f77 6561 6b72 6566 5f5f 222c 0a20 2020  _weakref__",.   
+00004de0: 2029 0a0a 2020 2020 6465 6620 5f5f 696e   )..    def __in
+00004df0: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
+00004e00: 6c66 2c0a 2020 2020 2020 2020 2320 636f  lf,.        # co
+00004e10: 756c 6420 6d61 6b65 2061 2056 6172 6961  uld make a Varia
+00004e20: 626c 6541 7267 7320 746f 2075 7365 206d  bleArgs to use m
+00004e30: 6f72 6520 6765 6e65 7261 6c6c 792c 2061  ore generally, a
+00004e40: 6e64 2072 6566 696e 6520 7468 6573 650a  nd refine these.
+00004e50: 2020 2020 2020 2020 2320 6361 7465 676f          # catego
+00004e60: 7269 6573 0a20 2020 2020 2020 2064 6174  ries.        dat
+00004e70: 615f 7661 7273 3a20 4d61 7070 696e 675b  a_vars: Mapping[
+00004e80: 416e 792c 2041 6e79 5d20 7c20 4e6f 6e65  Any, Any] | None
+00004e90: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00004ea0: 2063 6f6f 7264 733a 204d 6170 7069 6e67   coords: Mapping
+00004eb0: 5b41 6e79 2c20 416e 795d 207c 204e 6f6e  [Any, Any] | Non
+00004ec0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+00004ed0: 2020 6174 7472 733a 204d 6170 7069 6e67    attrs: Mapping
+00004ee0: 5b41 6e79 2c20 416e 795d 207c 204e 6f6e  [Any, Any] | Non
+00004ef0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2920  e = None,.    ) 
+00004f00: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00004f10: 2023 2054 4f44 4f28 7368 6f79 6572 293a   # TODO(shoyer):
+00004f20: 2065 7870 6f73 6520 696e 6465 7865 7320   expose indexes 
+00004f30: 6173 2061 2070 7562 6c69 6320 6172 6775  as a public argu
+00004f40: 6d65 6e74 2069 6e20 5f5f 696e 6974 5f5f  ment in __init__
+00004f50: 0a0a 2020 2020 2020 2020 6966 2064 6174  ..        if dat
+00004f60: 615f 7661 7273 2069 7320 4e6f 6e65 3a0a  a_vars is None:.
+00004f70: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00004f80: 5f76 6172 7320 3d20 7b7d 0a20 2020 2020  _vars = {}.     
+00004f90: 2020 2069 6620 636f 6f72 6473 2069 7320     if coords is 
+00004fa0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00004fb0: 2020 636f 6f72 6473 203d 207b 7d0a 0a20    coords = {}.. 
+00004fc0: 2020 2020 2020 2062 6f74 685f 6461 7461         both_data
+00004fd0: 5f61 6e64 5f63 6f6f 7264 7320 3d20 7365  _and_coords = se
+00004fe0: 7428 6461 7461 5f76 6172 7329 2026 2073  t(data_vars) & s
+00004ff0: 6574 2863 6f6f 7264 7329 0a20 2020 2020  et(coords).     
+00005000: 2020 2069 6620 626f 7468 5f64 6174 615f     if both_data_
+00005010: 616e 645f 636f 6f72 6473 3a0a 2020 2020  and_coords:.    
+00005020: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00005030: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00005040: 2020 2020 2020 2020 2020 6622 7661 7269            f"vari
+00005050: 6162 6c65 7320 7b62 6f74 685f 6461 7461  ables {both_data
+00005060: 5f61 6e64 5f63 6f6f 7264 7321 727d 2061  _and_coords!r} a
+00005070: 7265 2066 6f75 6e64 2069 6e20 626f 7468  re found in both
+00005080: 2064 6174 615f 7661 7273 2061 6e64 2063   data_vars and c
+00005090: 6f6f 7264 7322 0a20 2020 2020 2020 2020  oords".         
+000050a0: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+000050b0: 2069 7369 6e73 7461 6e63 6528 636f 6f72   isinstance(coor
+000050c0: 6473 2c20 4461 7461 7365 7429 3a0a 2020  ds, Dataset):.  
+000050d0: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
+000050e0: 203d 2063 6f6f 7264 732e 5f76 6172 6961   = coords._varia
+000050f0: 626c 6573 0a0a 2020 2020 2020 2020 7661  bles..        va
+00005100: 7269 6162 6c65 732c 2063 6f6f 7264 5f6e  riables, coord_n
+00005110: 616d 6573 2c20 6469 6d73 2c20 696e 6465  ames, dims, inde
+00005120: 7865 732c 205f 203d 206d 6572 6765 5f64  xes, _ = merge_d
+00005130: 6174 615f 616e 645f 636f 6f72 6473 280a  ata_and_coords(.
+00005140: 2020 2020 2020 2020 2020 2020 6461 7461              data
+00005150: 5f76 6172 732c 2063 6f6f 7264 732c 2063  _vars, coords, c
+00005160: 6f6d 7061 743d 2262 726f 6164 6361 7374  ompat="broadcast
+00005170: 5f65 7175 616c 7322 0a20 2020 2020 2020  _equals".       
+00005180: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
+00005190: 2e5f 6174 7472 7320 3d20 6469 6374 2861  ._attrs = dict(a
+000051a0: 7474 7273 2920 6966 2061 7474 7273 2069  ttrs) if attrs i
+000051b0: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+000051c0: 4e6f 6e65 0a20 2020 2020 2020 2073 656c  None.        sel
+000051d0: 662e 5f63 6c6f 7365 203d 204e 6f6e 650a  f._close = None.
+000051e0: 2020 2020 2020 2020 7365 6c66 2e5f 656e          self._en
+000051f0: 636f 6469 6e67 203d 204e 6f6e 650a 2020  coding = None.  
+00005200: 2020 2020 2020 7365 6c66 2e5f 7661 7269        self._vari
+00005210: 6162 6c65 7320 3d20 7661 7269 6162 6c65  ables = variable
+00005220: 730a 2020 2020 2020 2020 7365 6c66 2e5f  s.        self._
+00005230: 636f 6f72 645f 6e61 6d65 7320 3d20 636f  coord_names = co
+00005240: 6f72 645f 6e61 6d65 730a 2020 2020 2020  ord_names.      
+00005250: 2020 7365 6c66 2e5f 6469 6d73 203d 2064    self._dims = d
+00005260: 696d 730a 2020 2020 2020 2020 7365 6c66  ims.        self
+00005270: 2e5f 696e 6465 7865 7320 3d20 696e 6465  ._indexes = inde
+00005280: 7865 730a 0a20 2020 2040 636c 6173 736d  xes..    @classm
+00005290: 6574 686f 640a 2020 2020 6465 6620 6c6f  ethod.    def lo
+000052a0: 6164 5f73 746f 7265 2863 6c73 3a20 7479  ad_store(cls: ty
+000052b0: 7065 5b54 5f44 6174 6173 6574 5d2c 2073  pe[T_Dataset], s
+000052c0: 746f 7265 2c20 6465 636f 6465 723d 4e6f  tore, decoder=No
+000052d0: 6e65 2920 2d3e 2054 5f44 6174 6173 6574  ne) -> T_Dataset
+000052e0: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
+000052f0: 6174 6520 6120 6e65 7720 6461 7461 7365  ate a new datase
+00005300: 7420 6672 6f6d 2074 6865 2063 6f6e 7465  t from the conte
+00005310: 6e74 7320 6f66 2061 2062 6163 6b65 6e64  nts of a backend
+00005320: 732e 2a44 6174 6153 746f 7265 0a20 2020  s.*DataStore.   
+00005330: 2020 2020 206f 626a 6563 740a 2020 2020       object.    
+00005340: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00005350: 7661 7269 6162 6c65 732c 2061 7474 7269  variables, attri
+00005360: 6275 7465 7320 3d20 7374 6f72 652e 6c6f  butes = store.lo
+00005370: 6164 2829 0a20 2020 2020 2020 2069 6620  ad().        if 
+00005380: 6465 636f 6465 723a 0a20 2020 2020 2020  decoder:.       
+00005390: 2020 2020 2076 6172 6961 626c 6573 2c20       variables, 
+000053a0: 6174 7472 6962 7574 6573 203d 2064 6563  attributes = dec
+000053b0: 6f64 6572 2876 6172 6961 626c 6573 2c20  oder(variables, 
+000053c0: 6174 7472 6962 7574 6573 290a 2020 2020  attributes).    
+000053d0: 2020 2020 6f62 6a20 3d20 636c 7328 7661      obj = cls(va
+000053e0: 7269 6162 6c65 732c 2061 7474 7273 3d61  riables, attrs=a
+000053f0: 7474 7269 6275 7465 7329 0a20 2020 2020  ttributes).     
+00005400: 2020 206f 626a 2e73 6574 5f63 6c6f 7365     obj.set_close
+00005410: 2873 746f 7265 2e63 6c6f 7365 290a 2020  (store.close).  
+00005420: 2020 2020 2020 7265 7475 726e 206f 626a        return obj
+00005430: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00005440: 2020 2020 6465 6620 7661 7269 6162 6c65      def variable
+00005450: 7328 7365 6c66 2920 2d3e 2046 726f 7a65  s(self) -> Froze
+00005460: 6e5b 4861 7368 6162 6c65 2c20 5661 7269  n[Hashable, Vari
+00005470: 6162 6c65 5d3a 0a20 2020 2020 2020 2022  able]:.        "
+00005480: 2222 4c6f 7720 6c65 7665 6c20 696e 7465  ""Low level inte
+00005490: 7266 6163 6520 746f 2044 6174 6173 6574  rface to Dataset
+000054a0: 2063 6f6e 7465 6e74 7320 6173 2064 6963   contents as dic
+000054b0: 7420 6f66 2056 6172 6961 626c 6520 6f62  t of Variable ob
+000054c0: 6a65 6374 732e 0a0a 2020 2020 2020 2020  jects...        
+000054d0: 5468 6973 206f 7264 6572 6564 2064 6963  This ordered dic
+000054e0: 7469 6f6e 6172 7920 6973 2066 726f 7a65  tionary is froze
+000054f0: 6e20 746f 2070 7265 7665 6e74 206d 7574  n to prevent mut
+00005500: 6174 696f 6e20 7468 6174 2063 6f75 6c64  ation that could
+00005510: 0a20 2020 2020 2020 2076 696f 6c61 7465  .        violate
+00005520: 2044 6174 6173 6574 2069 6e76 6172 6961   Dataset invaria
+00005530: 6e74 732e 2049 7420 636f 6e74 6169 6e73  nts. It contains
+00005540: 2061 6c6c 2076 6172 6961 626c 6520 6f62   all variable ob
+00005550: 6a65 6374 730a 2020 2020 2020 2020 636f  jects.        co
+00005560: 6e73 7469 7475 7469 6e67 2074 6865 2044  nstituting the D
+00005570: 6174 6173 6574 2c20 696e 636c 7564 696e  ataset, includin
+00005580: 6720 626f 7468 2064 6174 6120 7661 7269  g both data vari
+00005590: 6162 6c65 7320 616e 640a 2020 2020 2020  ables and.      
+000055a0: 2020 636f 6f72 6469 6e61 7465 732e 0a20    coordinates.. 
+000055b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000055c0: 2020 2072 6574 7572 6e20 4672 6f7a 656e     return Frozen
+000055d0: 2873 656c 662e 5f76 6172 6961 626c 6573  (self._variables
+000055e0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+000055f0: 0a20 2020 2064 6566 2061 7474 7273 2873  .    def attrs(s
+00005600: 656c 6629 202d 3e20 6469 6374 5b41 6e79  elf) -> dict[Any
+00005610: 2c20 416e 795d 3a0a 2020 2020 2020 2020  , Any]:.        
+00005620: 2222 2244 6963 7469 6f6e 6172 7920 6f66  """Dictionary of
+00005630: 2067 6c6f 6261 6c20 6174 7472 6962 7574   global attribut
+00005640: 6573 206f 6e20 7468 6973 2064 6174 6173  es on this datas
+00005650: 6574 2222 220a 2020 2020 2020 2020 6966  et""".        if
+00005660: 2073 656c 662e 5f61 7474 7273 2069 7320   self._attrs is 
+00005670: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00005680: 2020 7365 6c66 2e5f 6174 7472 7320 3d20    self._attrs = 
+00005690: 7b7d 0a20 2020 2020 2020 2072 6574 7572  {}.        retur
+000056a0: 6e20 7365 6c66 2e5f 6174 7472 730a 0a20  n self._attrs.. 
+000056b0: 2020 2040 6174 7472 732e 7365 7474 6572     @attrs.setter
+000056c0: 0a20 2020 2064 6566 2061 7474 7273 2873  .    def attrs(s
+000056d0: 656c 662c 2076 616c 7565 3a20 4d61 7070  elf, value: Mapp
+000056e0: 696e 675b 416e 792c 2041 6e79 5d29 202d  ing[Any, Any]) -
+000056f0: 3e20 4e6f 6e65 3a0a 2020 2020 2020 2020  > None:.        
+00005700: 7365 6c66 2e5f 6174 7472 7320 3d20 6469  self._attrs = di
+00005710: 6374 2876 616c 7565 290a 0a20 2020 2040  ct(value)..    @
+00005720: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00005730: 2065 6e63 6f64 696e 6728 7365 6c66 2920   encoding(self) 
+00005740: 2d3e 2064 6963 745b 416e 792c 2041 6e79  -> dict[Any, Any
+00005750: 5d3a 0a20 2020 2020 2020 2022 2222 4469  ]:.        """Di
+00005760: 6374 696f 6e61 7279 206f 6620 676c 6f62  ctionary of glob
+00005770: 616c 2065 6e63 6f64 696e 6720 6174 7472  al encoding attr
+00005780: 6962 7574 6573 206f 6e20 7468 6973 2064  ibutes on this d
+00005790: 6174 6173 6574 2222 220a 2020 2020 2020  ataset""".      
+000057a0: 2020 6966 2073 656c 662e 5f65 6e63 6f64    if self._encod
+000057b0: 696e 6720 6973 204e 6f6e 653a 0a20 2020  ing is None:.   
+000057c0: 2020 2020 2020 2020 2073 656c 662e 5f65           self._e
+000057d0: 6e63 6f64 696e 6720 3d20 7b7d 0a20 2020  ncoding = {}.   
+000057e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000057f0: 2e5f 656e 636f 6469 6e67 0a0a 2020 2020  ._encoding..    
+00005800: 4065 6e63 6f64 696e 672e 7365 7474 6572  @encoding.setter
+00005810: 0a20 2020 2064 6566 2065 6e63 6f64 696e  .    def encodin
+00005820: 6728 7365 6c66 2c20 7661 6c75 653a 204d  g(self, value: M
+00005830: 6170 7069 6e67 5b41 6e79 2c20 416e 795d  apping[Any, Any]
+00005840: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+00005850: 2020 2073 656c 662e 5f65 6e63 6f64 696e     self._encodin
+00005860: 6720 3d20 6469 6374 2876 616c 7565 290a  g = dict(value).
+00005870: 0a20 2020 2064 6566 2072 6573 6574 5f65  .    def reset_e
+00005880: 6e63 6f64 696e 6728 7365 6c66 3a20 545f  ncoding(self: T_
+00005890: 4461 7461 7365 7429 202d 3e20 545f 4461  Dataset) -> T_Da
+000058a0: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
+000058b0: 2222 5265 7475 726e 2061 206e 6577 2044  ""Return a new D
+000058c0: 6174 6173 6574 2077 6974 686f 7574 2065  ataset without e
+000058d0: 6e63 6f64 696e 6720 6f6e 2074 6865 2064  ncoding on the d
+000058e0: 6174 6173 6574 206f 7220 616e 7920 6f66  ataset or any of
+000058f0: 2069 7473 0a20 2020 2020 2020 2076 6172   its.        var
+00005900: 6961 626c 6573 2f63 6f6f 7264 732e 2222  iables/coords.""
+00005910: 220a 2020 2020 2020 2020 7661 7269 6162  ".        variab
+00005920: 6c65 7320 3d20 7b6b 3a20 762e 7265 7365  les = {k: v.rese
+00005930: 745f 656e 636f 6469 6e67 2829 2066 6f72  t_encoding() for
+00005940: 206b 2c20 7620 696e 2073 656c 662e 7661   k, v in self.va
+00005950: 7269 6162 6c65 732e 6974 656d 7328 297d  riables.items()}
+00005960: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00005970: 7365 6c66 2e5f 7265 706c 6163 6528 7661  self._replace(va
+00005980: 7269 6162 6c65 733d 7661 7269 6162 6c65  riables=variable
+00005990: 732c 2065 6e63 6f64 696e 673d 7b7d 290a  s, encoding={}).
+000059a0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+000059b0: 2020 2064 6566 2064 696d 7328 7365 6c66     def dims(self
+000059c0: 2920 2d3e 2046 726f 7a65 6e5b 4861 7368  ) -> Frozen[Hash
+000059d0: 6162 6c65 2c20 696e 745d 3a0a 2020 2020  able, int]:.    
+000059e0: 2020 2020 2222 224d 6170 7069 6e67 2066      """Mapping f
+000059f0: 726f 6d20 6469 6d65 6e73 696f 6e20 6e61  rom dimension na
+00005a00: 6d65 7320 746f 206c 656e 6774 6873 2e0a  mes to lengths..
+00005a10: 0a20 2020 2020 2020 2043 616e 6e6f 7420  .        Cannot 
+00005a20: 6265 206d 6f64 6966 6965 6420 6469 7265  be modified dire
+00005a30: 6374 6c79 2c20 6275 7420 6973 2075 7064  ctly, but is upd
+00005a40: 6174 6564 2077 6865 6e20 6164 6469 6e67  ated when adding
+00005a50: 206e 6577 2076 6172 6961 626c 6573 2e0a   new variables..
+00005a60: 0a20 2020 2020 2020 204e 6f74 6520 7468  .        Note th
+00005a70: 6174 2074 7970 6520 6f66 2074 6869 7320  at type of this 
+00005a80: 6f62 6a65 6374 2064 6966 6665 7273 2066  object differs f
+00005a90: 726f 6d20 6044 6174 6141 7272 6179 2e64  rom `DataArray.d
+00005aa0: 696d 7360 2e0a 2020 2020 2020 2020 5365  ims`..        Se
+00005ab0: 6520 6044 6174 6173 6574 2e73 697a 6573  e `Dataset.sizes
+00005ac0: 6020 616e 6420 6044 6174 6141 7272 6179  ` and `DataArray
+00005ad0: 2e73 697a 6573 6020 666f 7220 636f 6e73  .sizes` for cons
+00005ae0: 6973 7465 6e74 6c79 206e 616d 6564 0a20  istently named. 
+00005af0: 2020 2020 2020 2070 726f 7065 7274 6965         propertie
+00005b00: 732e 0a0a 2020 2020 2020 2020 5365 6520  s...        See 
+00005b10: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+00005b20: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
+00005b30: 7461 7365 742e 7369 7a65 730a 2020 2020  taset.sizes.    
+00005b40: 2020 2020 4461 7461 4172 7261 792e 6469      DataArray.di
+00005b50: 6d73 0a20 2020 2020 2020 2022 2222 0a20  ms.        """. 
+00005b60: 2020 2020 2020 2072 6574 7572 6e20 4672         return Fr
+00005b70: 6f7a 656e 2873 656c 662e 5f64 696d 7329  ozen(self._dims)
+00005b80: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00005b90: 2020 2020 6465 6620 7369 7a65 7328 7365      def sizes(se
+00005ba0: 6c66 2920 2d3e 2046 726f 7a65 6e5b 4861  lf) -> Frozen[Ha
+00005bb0: 7368 6162 6c65 2c20 696e 745d 3a0a 2020  shable, int]:.  
+00005bc0: 2020 2020 2020 2222 224d 6170 7069 6e67        """Mapping
+00005bd0: 2066 726f 6d20 6469 6d65 6e73 696f 6e20   from dimension 
+00005be0: 6e61 6d65 7320 746f 206c 656e 6774 6873  names to lengths
+00005bf0: 2e0a 0a20 2020 2020 2020 2043 616e 6e6f  ...        Canno
+00005c00: 7420 6265 206d 6f64 6966 6965 6420 6469  t be modified di
+00005c10: 7265 6374 6c79 2c20 6275 7420 6973 2075  rectly, but is u
+00005c20: 7064 6174 6564 2077 6865 6e20 6164 6469  pdated when addi
+00005c30: 6e67 206e 6577 2076 6172 6961 626c 6573  ng new variables
+00005c40: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
+00005c50: 6973 2061 6e20 616c 6961 7320 666f 7220  is an alias for 
+00005c60: 6044 6174 6173 6574 2e64 696d 7360 2070  `Dataset.dims` p
+00005c70: 726f 7669 6465 6420 666f 7220 7468 6520  rovided for the 
+00005c80: 6265 6e65 6669 7420 6f66 0a20 2020 2020  benefit of.     
+00005c90: 2020 2063 6f6e 7369 7374 656e 6379 2077     consistency w
+00005ca0: 6974 6820 6044 6174 6141 7272 6179 2e73  ith `DataArray.s
+00005cb0: 697a 6573 602e 0a0a 2020 2020 2020 2020  izes`...        
+00005cc0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+00005cd0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00005ce0: 2020 4461 7461 4172 7261 792e 7369 7a65    DataArray.size
+00005cf0: 730a 2020 2020 2020 2020 2222 220a 2020  s.        """.  
+00005d00: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00005d10: 662e 6469 6d73 0a0a 2020 2020 4070 726f  f.dims..    @pro
+00005d20: 7065 7274 790a 2020 2020 6465 6620 6474  perty.    def dt
+00005d30: 7970 6573 2873 656c 6629 202d 3e20 4672  ypes(self) -> Fr
+00005d40: 6f7a 656e 5b48 6173 6861 626c 652c 206e  ozen[Hashable, n
+00005d50: 702e 6474 7970 655d 3a0a 2020 2020 2020  p.dtype]:.      
+00005d60: 2020 2222 224d 6170 7069 6e67 2066 726f    """Mapping fro
+00005d70: 6d20 6461 7461 2076 6172 6961 626c 6520  m data variable 
+00005d80: 6e61 6d65 7320 746f 2064 7479 7065 732e  names to dtypes.
+00005d90: 0a0a 2020 2020 2020 2020 4361 6e6e 6f74  ..        Cannot
+00005da0: 2062 6520 6d6f 6469 6669 6564 2064 6972   be modified dir
+00005db0: 6563 746c 792c 2062 7574 2069 7320 7570  ectly, but is up
+00005dc0: 6461 7465 6420 7768 656e 2061 6464 696e  dated when addin
+00005dd0: 6720 6e65 7720 7661 7269 6162 6c65 732e  g new variables.
+00005de0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00005df0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+00005e00: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+00005e10: 4172 7261 792e 6474 7970 650a 2020 2020  Array.dtype.    
+00005e20: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00005e30: 7265 7475 726e 2046 726f 7a65 6e28 0a20  return Frozen(. 
+00005e40: 2020 2020 2020 2020 2020 207b 0a20 2020             {.   
+00005e50: 2020 2020 2020 2020 2020 2020 206e 3a20               n: 
+00005e60: 762e 6474 7970 650a 2020 2020 2020 2020  v.dtype.        
+00005e70: 2020 2020 2020 2020 666f 7220 6e2c 2076          for n, v
+00005e80: 2069 6e20 7365 6c66 2e5f 7661 7269 6162   in self._variab
+00005e90: 6c65 732e 6974 656d 7328 290a 2020 2020  les.items().    
+00005ea0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00005eb0: 206e 6f74 2069 6e20 7365 6c66 2e5f 636f   not in self._co
+00005ec0: 6f72 645f 6e61 6d65 730a 2020 2020 2020  ord_names.      
+00005ed0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00005ee0: 290a 0a20 2020 2064 6566 206c 6f61 6428  )..    def load(
+00005ef0: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+00005f00: 202a 2a6b 7761 7267 7329 202d 3e20 545f   **kwargs) -> T_
+00005f10: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
+00005f20: 2022 2222 4d61 6e75 616c 6c79 2074 7269   """Manually tri
+00005f30: 6767 6572 206c 6f61 6469 6e67 2061 6e64  gger loading and
+00005f40: 2f6f 7220 636f 6d70 7574 6174 696f 6e20  /or computation 
+00005f50: 6f66 2074 6869 7320 6461 7461 7365 7427  of this dataset'
+00005f60: 7320 6461 7461 0a20 2020 2020 2020 2066  s data.        f
+00005f70: 726f 6d20 6469 736b 206f 7220 6120 7265  rom disk or a re
+00005f80: 6d6f 7465 2073 6f75 7263 6520 696e 746f  mote source into
+00005f90: 206d 656d 6f72 7920 616e 6420 7265 7475   memory and retu
+00005fa0: 726e 2074 6869 7320 6461 7461 7365 742e  rn this dataset.
+00005fb0: 0a20 2020 2020 2020 2055 6e6c 696b 6520  .        Unlike 
+00005fc0: 636f 6d70 7574 652c 2074 6865 206f 7269  compute, the ori
+00005fd0: 6769 6e61 6c20 6461 7461 7365 7420 6973  ginal dataset is
+00005fe0: 206d 6f64 6966 6965 6420 616e 6420 7265   modified and re
+00005ff0: 7475 726e 6564 2e0a 0a20 2020 2020 2020  turned...       
+00006000: 204e 6f72 6d61 6c6c 792c 2069 7420 7368   Normally, it sh
+00006010: 6f75 6c64 206e 6f74 2062 6520 6e65 6365  ould not be nece
+00006020: 7373 6172 7920 746f 2063 616c 6c20 7468  ssary to call th
+00006030: 6973 206d 6574 686f 6420 696e 2075 7365  is method in use
+00006040: 7220 636f 6465 2c0a 2020 2020 2020 2020  r code,.        
+00006050: 6265 6361 7573 6520 616c 6c20 7861 7272  because all xarr
+00006060: 6179 2066 756e 6374 696f 6e73 2073 686f  ay functions sho
+00006070: 756c 6420 6569 7468 6572 2077 6f72 6b20  uld either work 
+00006080: 6f6e 2064 6566 6572 7265 6420 6461 7461  on deferred data
+00006090: 206f 720a 2020 2020 2020 2020 6c6f 6164   or.        load
+000060a0: 2064 6174 6120 6175 746f 6d61 7469 6361   data automatica
+000060b0: 6c6c 792e 2048 6f77 6576 6572 2c20 7468  lly. However, th
+000060c0: 6973 206d 6574 686f 6420 6361 6e20 6265  is method can be
+000060d0: 206e 6563 6573 7361 7279 2077 6865 6e0a   necessary when.
+000060e0: 2020 2020 2020 2020 776f 726b 696e 6720          working 
+000060f0: 7769 7468 206d 616e 7920 6669 6c65 206f  with many file o
+00006100: 626a 6563 7473 206f 6e20 6469 736b 2e0a  bjects on disk..
+00006110: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00006120: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00006130: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 202a  ------.        *
+00006140: 2a6b 7761 7267 7320 3a20 6469 6374 0a20  *kwargs : dict. 
+00006150: 2020 2020 2020 2020 2020 2041 6464 6974             Addit
+00006160: 696f 6e61 6c20 6b65 7977 6f72 6420 6172  ional keyword ar
+00006170: 6775 6d65 6e74 7320 7061 7373 6564 206f  guments passed o
+00006180: 6e20 746f 2060 6064 6173 6b2e 636f 6d70  n to ``dask.comp
+00006190: 7574 6560 602e 0a0a 2020 2020 2020 2020  ute``...        
+000061a0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+000061b0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+000061c0: 2020 6461 736b 2e63 6f6d 7075 7465 0a20    dask.compute. 
+000061d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000061e0: 2020 2023 2061 6363 6573 7320 2e64 6174     # access .dat
+000061f0: 6120 746f 2063 6f65 7263 6520 6576 6572  a to coerce ever
+00006200: 7974 6869 6e67 2074 6f20 6e75 6d70 7920  ything to numpy 
+00006210: 6f72 2064 6173 6b20 6172 7261 7973 0a20  or dask arrays. 
+00006220: 2020 2020 2020 206c 617a 795f 6461 7461         lazy_data
+00006230: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00006240: 206b 3a20 762e 5f64 6174 6120 666f 7220   k: v._data for 
+00006250: 6b2c 2076 2069 6e20 7365 6c66 2e76 6172  k, v in self.var
+00006260: 6961 626c 6573 2e69 7465 6d73 2829 2069  iables.items() i
+00006270: 6620 6973 5f63 6875 6e6b 6564 5f61 7272  f is_chunked_arr
+00006280: 6179 2876 2e5f 6461 7461 290a 2020 2020  ay(v._data).    
+00006290: 2020 2020 7d0a 2020 2020 2020 2020 6966      }.        if
+000062a0: 206c 617a 795f 6461 7461 3a0a 2020 2020   lazy_data:.    
+000062b0: 2020 2020 2020 2020 6368 756e 6b6d 616e          chunkman
+000062c0: 6167 6572 203d 2067 6574 5f63 6875 6e6b  ager = get_chunk
+000062d0: 6564 5f61 7272 6179 5f74 7970 6528 2a6c  ed_array_type(*l
+000062e0: 617a 795f 6461 7461 2e76 616c 7565 7328  azy_data.values(
+000062f0: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
+00006300: 2320 6576 616c 7561 7465 2061 6c6c 2074  # evaluate all t
+00006310: 6865 2063 6875 6e6b 6564 2061 7272 6179  he chunked array
+00006320: 7320 7369 6d75 6c74 616e 656f 7573 6c79  s simultaneously
+00006330: 0a20 2020 2020 2020 2020 2020 2065 7661  .            eva
+00006340: 6c75 6174 6564 5f64 6174 6120 3d20 6368  luated_data = ch
+00006350: 756e 6b6d 616e 6167 6572 2e63 6f6d 7075  unkmanager.compu
+00006360: 7465 282a 6c61 7a79 5f64 6174 612e 7661  te(*lazy_data.va
+00006370: 6c75 6573 2829 2c20 2a2a 6b77 6172 6773  lues(), **kwargs
+00006380: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
+00006390: 6f72 206b 2c20 6461 7461 2069 6e20 7a69  or k, data in zi
+000063a0: 7028 6c61 7a79 5f64 6174 612c 2065 7661  p(lazy_data, eva
+000063b0: 6c75 6174 6564 5f64 6174 6129 3a0a 2020  luated_data):.  
+000063c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000063d0: 6c66 2e76 6172 6961 626c 6573 5b6b 5d2e  lf.variables[k].
+000063e0: 6461 7461 203d 2064 6174 610a 0a20 2020  data = data..   
+000063f0: 2020 2020 2023 206c 6f61 6420 6576 6572       # load ever
+00006400: 7974 6869 6e67 2065 6c73 6520 7365 7175  ything else sequ
+00006410: 656e 7469 616c 6c79 0a20 2020 2020 2020  entially.       
+00006420: 2066 6f72 206b 2c20 7620 696e 2073 656c   for k, v in sel
+00006430: 662e 7661 7269 6162 6c65 732e 6974 656d  f.variables.item
+00006440: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00006450: 2069 6620 6b20 6e6f 7420 696e 206c 617a   if k not in laz
+00006460: 795f 6461 7461 3a0a 2020 2020 2020 2020  y_data:.        
+00006470: 2020 2020 2020 2020 762e 6c6f 6164 2829          v.load()
+00006480: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00006490: 2073 656c 660a 0a20 2020 2064 6566 205f   self..    def _
+000064a0: 5f64 6173 6b5f 746f 6b65 6e69 7a65 5f5f  _dask_tokenize__
+000064b0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000064c0: 6672 6f6d 2064 6173 6b2e 6261 7365 2069  from dask.base i
+000064d0: 6d70 6f72 7420 6e6f 726d 616c 697a 655f  mport normalize_
+000064e0: 746f 6b65 6e0a 0a20 2020 2020 2020 2072  token..        r
+000064f0: 6574 7572 6e20 6e6f 726d 616c 697a 655f  eturn normalize_
+00006500: 746f 6b65 6e28 0a20 2020 2020 2020 2020  token(.         
+00006510: 2020 2028 7479 7065 2873 656c 6629 2c20     (type(self), 
+00006520: 7365 6c66 2e5f 7661 7269 6162 6c65 732c  self._variables,
+00006530: 2073 656c 662e 5f63 6f6f 7264 5f6e 616d   self._coord_nam
+00006540: 6573 2c20 7365 6c66 2e5f 6174 7472 7329  es, self._attrs)
+00006550: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00006560: 6465 6620 5f5f 6461 736b 5f67 7261 7068  def __dask_graph
+00006570: 5f5f 2873 656c 6629 3a0a 2020 2020 2020  __(self):.      
+00006580: 2020 6772 6170 6873 203d 207b 6b3a 2076    graphs = {k: v
+00006590: 2e5f 5f64 6173 6b5f 6772 6170 685f 5f28  .__dask_graph__(
+000065a0: 2920 666f 7220 6b2c 2076 2069 6e20 7365  ) for k, v in se
+000065b0: 6c66 2e76 6172 6961 626c 6573 2e69 7465  lf.variables.ite
+000065c0: 6d73 2829 7d0a 2020 2020 2020 2020 6772  ms()}.        gr
+000065d0: 6170 6873 203d 207b 6b3a 2076 2066 6f72  aphs = {k: v for
+000065e0: 206b 2c20 7620 696e 2067 7261 7068 732e   k, v in graphs.
+000065f0: 6974 656d 7328 2920 6966 2076 2069 7320  items() if v is 
+00006600: 6e6f 7420 4e6f 6e65 7d0a 2020 2020 2020  not None}.      
+00006610: 2020 6966 206e 6f74 2067 7261 7068 733a    if not graphs:
+00006620: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00006630: 7572 6e20 4e6f 6e65 0a20 2020 2020 2020  urn None.       
+00006640: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00006650: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00006660: 2020 2020 2020 2020 6672 6f6d 2064 6173          from das
+00006670: 6b2e 6869 6768 6c65 7665 6c67 7261 7068  k.highlevelgraph
+00006680: 2069 6d70 6f72 7420 4869 6768 4c65 7665   import HighLeve
+00006690: 6c47 7261 7068 0a0a 2020 2020 2020 2020  lGraph..        
+000066a0: 2020 2020 2020 2020 7265 7475 726e 2048          return H
+000066b0: 6967 684c 6576 656c 4772 6170 682e 6d65  ighLevelGraph.me
+000066c0: 7267 6528 2a67 7261 7068 732e 7661 6c75  rge(*graphs.valu
+000066d0: 6573 2829 290a 2020 2020 2020 2020 2020  es()).          
+000066e0: 2020 6578 6365 7074 2049 6d70 6f72 7445    except ImportE
+000066f0: 7272 6f72 3a0a 2020 2020 2020 2020 2020  rror:.          
+00006700: 2020 2020 2020 6672 6f6d 2064 6173 6b20        from dask 
+00006710: 696d 706f 7274 2073 6861 7265 6469 6374  import sharedict
+00006720: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00006730: 2020 7265 7475 726e 2073 6861 7265 6469    return sharedi
+00006740: 6374 2e6d 6572 6765 282a 6772 6170 6873  ct.merge(*graphs
+00006750: 2e76 616c 7565 7328 2929 0a0a 2020 2020  .values())..    
+00006760: 6465 6620 5f5f 6461 736b 5f6b 6579 735f  def __dask_keys_
+00006770: 5f28 7365 6c66 293a 0a20 2020 2020 2020  _(self):.       
+00006780: 2069 6d70 6f72 7420 6461 736b 0a0a 2020   import dask..  
+00006790: 2020 2020 2020 7265 7475 726e 205b 0a20        return [. 
+000067a0: 2020 2020 2020 2020 2020 2076 2e5f 5f64             v.__d
+000067b0: 6173 6b5f 6b65 7973 5f5f 2829 0a20 2020  ask_keys__().   
+000067c0: 2020 2020 2020 2020 2066 6f72 2076 2069           for v i
+000067d0: 6e20 7365 6c66 2e76 6172 6961 626c 6573  n self.variables
+000067e0: 2e76 616c 7565 7328 290a 2020 2020 2020  .values().      
+000067f0: 2020 2020 2020 6966 2064 6173 6b2e 6973        if dask.is
+00006800: 5f64 6173 6b5f 636f 6c6c 6563 7469 6f6e  _dask_collection
+00006810: 2876 290a 2020 2020 2020 2020 5d0a 0a20  (v).        ].. 
+00006820: 2020 2064 6566 205f 5f64 6173 6b5f 6c61     def __dask_la
+00006830: 7965 7273 5f5f 2873 656c 6629 3a0a 2020  yers__(self):.  
+00006840: 2020 2020 2020 696d 706f 7274 2064 6173        import das
+00006850: 6b0a 0a20 2020 2020 2020 2072 6574 7572  k..        retur
+00006860: 6e20 7375 6d28 0a20 2020 2020 2020 2020  n sum(.         
+00006870: 2020 2028 0a20 2020 2020 2020 2020 2020     (.           
+00006880: 2020 2020 2076 2e5f 5f64 6173 6b5f 6c61       v.__dask_la
+00006890: 7965 7273 5f5f 2829 0a20 2020 2020 2020  yers__().       
+000068a0: 2020 2020 2020 2020 2066 6f72 2076 2069           for v i
+000068b0: 6e20 7365 6c66 2e76 6172 6961 626c 6573  n self.variables
+000068c0: 2e76 616c 7565 7328 290a 2020 2020 2020  .values().      
+000068d0: 2020 2020 2020 2020 2020 6966 2064 6173            if das
+000068e0: 6b2e 6973 5f64 6173 6b5f 636f 6c6c 6563  k.is_dask_collec
+000068f0: 7469 6f6e 2876 290a 2020 2020 2020 2020  tion(v).        
+00006900: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
+00006910: 2020 2028 292c 0a20 2020 2020 2020 2029     (),.        )
+00006920: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00006930: 2020 2020 6465 6620 5f5f 6461 736b 5f6f      def __dask_o
+00006940: 7074 696d 697a 655f 5f28 7365 6c66 293a  ptimize__(self):
+00006950: 0a20 2020 2020 2020 2069 6d70 6f72 7420  .        import 
+00006960: 6461 736b 2e61 7272 6179 2061 7320 6461  dask.array as da
+00006970: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00006980: 2064 612e 4172 7261 792e 5f5f 6461 736b   da.Array.__dask
+00006990: 5f6f 7074 696d 697a 655f 5f0a 0a20 2020  _optimize__..   
+000069a0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000069b0: 6566 205f 5f64 6173 6b5f 7363 6865 6475  ef __dask_schedu
+000069c0: 6c65 725f 5f28 7365 6c66 293a 0a20 2020  ler__(self):.   
+000069d0: 2020 2020 2069 6d70 6f72 7420 6461 736b       import dask
+000069e0: 2e61 7272 6179 2061 7320 6461 0a0a 2020  .array as da..  
+000069f0: 2020 2020 2020 7265 7475 726e 2064 612e        return da.
+00006a00: 4172 7261 792e 5f5f 6461 736b 5f73 6368  Array.__dask_sch
+00006a10: 6564 756c 6572 5f5f 0a0a 2020 2020 6465  eduler__..    de
+00006a20: 6620 5f5f 6461 736b 5f70 6f73 7463 6f6d  f __dask_postcom
+00006a30: 7075 7465 5f5f 2873 656c 6629 3a0a 2020  pute__(self):.  
+00006a40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00006a50: 662e 5f64 6173 6b5f 706f 7374 636f 6d70  f._dask_postcomp
+00006a60: 7574 652c 2028 290a 0a20 2020 2064 6566  ute, ()..    def
+00006a70: 205f 5f64 6173 6b5f 706f 7374 7065 7273   __dask_postpers
+00006a80: 6973 745f 5f28 7365 6c66 293a 0a20 2020  ist__(self):.   
+00006a90: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00006aa0: 2e5f 6461 736b 5f70 6f73 7470 6572 7369  ._dask_postpersi
+00006ab0: 7374 2c20 2829 0a0a 2020 2020 6465 6620  st, ()..    def 
+00006ac0: 5f64 6173 6b5f 706f 7374 636f 6d70 7574  _dask_postcomput
+00006ad0: 6528 7365 6c66 3a20 545f 4461 7461 7365  e(self: T_Datase
+00006ae0: 742c 2072 6573 756c 7473 3a20 4974 6572  t, results: Iter
+00006af0: 6162 6c65 5b56 6172 6961 626c 655d 2920  able[Variable]) 
+00006b00: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
+00006b10: 2020 2020 2020 696d 706f 7274 2064 6173        import das
+00006b20: 6b0a 0a20 2020 2020 2020 2076 6172 6961  k..        varia
+00006b30: 626c 6573 203d 207b 7d0a 2020 2020 2020  bles = {}.      
+00006b40: 2020 7265 7375 6c74 735f 6974 6572 203d    results_iter =
+00006b50: 2069 7465 7228 7265 7375 6c74 7329 0a0a   iter(results)..
+00006b60: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
+00006b70: 2069 6e20 7365 6c66 2e5f 7661 7269 6162   in self._variab
+00006b80: 6c65 732e 6974 656d 7328 293a 0a20 2020  les.items():.   
+00006b90: 2020 2020 2020 2020 2069 6620 6461 736b           if dask
+00006ba0: 2e69 735f 6461 736b 5f63 6f6c 6c65 6374  .is_dask_collect
+00006bb0: 696f 6e28 7629 3a0a 2020 2020 2020 2020  ion(v):.        
+00006bc0: 2020 2020 2020 2020 7265 6275 696c 642c          rebuild,
+00006bd0: 2061 7267 7320 3d20 762e 5f5f 6461 736b   args = v.__dask
+00006be0: 5f70 6f73 7463 6f6d 7075 7465 5f5f 2829  _postcompute__()
+00006bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006c00: 2076 203d 2072 6562 7569 6c64 286e 6578   v = rebuild(nex
+00006c10: 7428 7265 7375 6c74 735f 6974 6572 292c  t(results_iter),
+00006c20: 202a 6172 6773 290a 2020 2020 2020 2020   *args).        
+00006c30: 2020 2020 7661 7269 6162 6c65 735b 6b5d      variables[k]
+00006c40: 203d 2076 0a0a 2020 2020 2020 2020 7265   = v..        re
+00006c50: 7475 726e 2074 7970 6528 7365 6c66 292e  turn type(self).
+00006c60: 5f63 6f6e 7374 7275 6374 5f64 6972 6563  _construct_direc
+00006c70: 7428 0a20 2020 2020 2020 2020 2020 2076  t(.            v
+00006c80: 6172 6961 626c 6573 2c0a 2020 2020 2020  ariables,.      
+00006c90: 2020 2020 2020 7365 6c66 2e5f 636f 6f72        self._coor
+00006ca0: 645f 6e61 6d65 732c 0a20 2020 2020 2020  d_names,.       
+00006cb0: 2020 2020 2073 656c 662e 5f64 696d 732c       self._dims,
+00006cc0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00006cd0: 662e 5f61 7474 7273 2c0a 2020 2020 2020  f._attrs,.      
+00006ce0: 2020 2020 2020 7365 6c66 2e5f 696e 6465        self._inde
+00006cf0: 7865 732c 0a20 2020 2020 2020 2020 2020  xes,.           
+00006d00: 2073 656c 662e 5f65 6e63 6f64 696e 672c   self._encoding,
+00006d10: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00006d20: 662e 5f63 6c6f 7365 2c0a 2020 2020 2020  f._close,.      
+00006d30: 2020 290a 0a20 2020 2064 6566 205f 6461    )..    def _da
+00006d40: 736b 5f70 6f73 7470 6572 7369 7374 280a  sk_postpersist(.
+00006d50: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
+00006d60: 4461 7461 7365 742c 2064 736b 3a20 4d61  Dataset, dsk: Ma
+00006d70: 7070 696e 672c 202a 2c20 7265 6e61 6d65  pping, *, rename
+00006d80: 3a20 4d61 7070 696e 675b 7374 722c 2073  : Mapping[str, s
+00006d90: 7472 5d20 7c20 4e6f 6e65 203d 204e 6f6e  tr] | None = Non
+00006da0: 650a 2020 2020 2920 2d3e 2054 5f44 6174  e.    ) -> T_Dat
+00006db0: 6173 6574 3a0a 2020 2020 2020 2020 6672  aset:.        fr
+00006dc0: 6f6d 2064 6173 6b20 696d 706f 7274 2069  om dask import i
+00006dd0: 735f 6461 736b 5f63 6f6c 6c65 6374 696f  s_dask_collectio
+00006de0: 6e0a 2020 2020 2020 2020 6672 6f6d 2064  n.        from d
+00006df0: 6173 6b2e 6869 6768 6c65 7665 6c67 7261  ask.highlevelgra
+00006e00: 7068 2069 6d70 6f72 7420 4869 6768 4c65  ph import HighLe
+00006e10: 7665 6c47 7261 7068 0a20 2020 2020 2020  velGraph.       
+00006e20: 2066 726f 6d20 6461 736b 2e6f 7074 696d   from dask.optim
+00006e30: 697a 6174 696f 6e20 696d 706f 7274 2063  ization import c
+00006e40: 756c 6c0a 0a20 2020 2020 2020 2076 6172  ull..        var
+00006e50: 6961 626c 6573 203d 207b 7d0a 0a20 2020  iables = {}..   
+00006e60: 2020 2020 2066 6f72 206b 2c20 7620 696e       for k, v in
+00006e70: 2073 656c 662e 5f76 6172 6961 626c 6573   self._variables
+00006e80: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+00006e90: 2020 2020 2020 6966 206e 6f74 2069 735f        if not is_
+00006ea0: 6461 736b 5f63 6f6c 6c65 6374 696f 6e28  dask_collection(
+00006eb0: 7629 3a0a 2020 2020 2020 2020 2020 2020  v):.            
+00006ec0: 2020 2020 7661 7269 6162 6c65 735b 6b5d      variables[k]
+00006ed0: 203d 2076 0a20 2020 2020 2020 2020 2020   = v.           
+00006ee0: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
+00006ef0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00006f00: 696e 7374 616e 6365 2864 736b 2c20 4869  instance(dsk, Hi
+00006f10: 6768 4c65 7665 6c47 7261 7068 293a 0a20  ghLevelGraph):. 
+00006f20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00006f30: 2064 6173 6b20 3e3d 2032 3032 312e 330a   dask >= 2021.3.
+00006f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006f50: 2320 5f5f 6461 736b 5f70 6f73 7470 6572  # __dask_postper
+00006f60: 7369 7374 5f5f 2829 2077 6173 2063 616c  sist__() was cal
+00006f70: 6c65 6420 6279 2064 6173 6b2e 6869 6768  led by dask.high
+00006f80: 6c65 7665 6c67 7261 7068 2e0a 2020 2020  levelgraph..    
+00006f90: 2020 2020 2020 2020 2020 2020 2320 446f              # Do
+00006fa0: 6e27 7420 7573 6520 6473 6b2e 6375 6c6c  n't use dsk.cull
+00006fb0: 2829 2c20 6173 2077 6520 6e65 6564 2074  (), as we need t
+00006fc0: 6f20 7072 6576 656e 7420 7061 7274 6961  o prevent partia
+00006fd0: 6c20 6c61 7965 7273 3a0a 2020 2020 2020  l layers:.      
+00006fe0: 2020 2020 2020 2020 2020 2320 6874 7470            # http
+00006ff0: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f64  s://github.com/d
+00007000: 6173 6b2f 6461 736b 2f69 7373 7565 732f  ask/dask/issues/
+00007010: 3731 3337 0a20 2020 2020 2020 2020 2020  7137.           
+00007020: 2020 2020 206c 6179 6572 7320 3d20 762e       layers = v.
+00007030: 5f5f 6461 736b 5f6c 6179 6572 735f 5f28  __dask_layers__(
+00007040: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00007050: 2020 6966 2072 656e 616d 653a 0a20 2020    if rename:.   
+00007060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007070: 206c 6179 6572 7320 3d20 5b72 656e 616d   layers = [renam
+00007080: 652e 6765 7428 6b2c 206b 2920 666f 7220  e.get(k, k) for 
+00007090: 6b20 696e 206c 6179 6572 735d 0a20 2020  k in layers].   
+000070a0: 2020 2020 2020 2020 2020 2020 2064 736b               dsk
+000070b0: 3220 3d20 6473 6b2e 6375 6c6c 5f6c 6179  2 = dsk.cull_lay
+000070c0: 6572 7328 6c61 7965 7273 290a 2020 2020  ers(layers).    
+000070d0: 2020 2020 2020 2020 656c 6966 2072 656e          elif ren
+000070e0: 616d 653a 2020 2320 7072 6167 6d61 3a20  ame:  # pragma: 
+000070f0: 6e6f 636f 7665 720a 2020 2020 2020 2020  nocover.        
+00007100: 2020 2020 2020 2020 2320 4174 2074 6865          # At the
+00007110: 206d 6f6d 656e 7420 6f66 2077 7269 7469   moment of writi
+00007120: 6e67 2c20 7468 6973 2069 7320 6f6e 6c79  ng, this is only
+00007130: 2066 6f72 2066 6f72 7761 7264 2063 6f6d   for forward com
+00007140: 7061 7469 6269 6c69 7479 2e0a 2020 2020  patibility..    
+00007150: 2020 2020 2020 2020 2020 2020 2320 7265              # re
+00007160: 706c 6163 655f 6e61 6d65 5f69 6e5f 6b65  place_name_in_ke
+00007170: 7920 7265 7175 6972 6573 2064 6173 6b20  y requires dask 
+00007180: 3e3d 2032 3032 312e 332e 0a20 2020 2020  >= 2021.3..     
+00007190: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
+000071a0: 6461 736b 2e62 6173 6520 696d 706f 7274  dask.base import
+000071b0: 2066 6c61 7474 656e 2c20 7265 706c 6163   flatten, replac
+000071c0: 655f 6e61 6d65 5f69 6e5f 6b65 790a 0a20  e_name_in_key.. 
+000071d0: 2020 2020 2020 2020 2020 2020 2020 206b                 k
+000071e0: 6579 7320 3d20 5b0a 2020 2020 2020 2020  eys = [.        
+000071f0: 2020 2020 2020 2020 2020 2020 7265 706c              repl
+00007200: 6163 655f 6e61 6d65 5f69 6e5f 6b65 7928  ace_name_in_key(
+00007210: 6b2c 2072 656e 616d 6529 2066 6f72 206b  k, rename) for k
+00007220: 2069 6e20 666c 6174 7465 6e28 762e 5f5f   in flatten(v.__
+00007230: 6461 736b 5f6b 6579 735f 5f28 2929 0a20  dask_keys__()). 
+00007240: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00007250: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007260: 2064 736b 322c 205f 203d 2063 756c 6c28   dsk2, _ = cull(
+00007270: 6473 6b2c 206b 6579 7329 0a20 2020 2020  dsk, keys).     
+00007280: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00007290: 2020 2020 2020 2020 2020 2020 2023 205f               # _
+000072a0: 5f64 6173 6b5f 706f 7374 7065 7273 6973  _dask_postpersis
+000072b0: 745f 5f28 2920 7761 7320 6361 6c6c 6564  t__() was called
+000072c0: 2062 7920 6461 736b 2e6f 7074 696d 697a   by dask.optimiz
+000072d0: 6520 6f72 2064 6173 6b2e 7065 7273 6973  e or dask.persis
+000072e0: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+000072f0: 2020 6473 6b32 2c20 5f20 3d20 6375 6c6c    dsk2, _ = cull
+00007300: 2864 736b 2c20 762e 5f5f 6461 736b 5f6b  (dsk, v.__dask_k
+00007310: 6579 735f 5f28 2929 0a0a 2020 2020 2020  eys__())..      
+00007320: 2020 2020 2020 7265 6275 696c 642c 2061        rebuild, a
+00007330: 7267 7320 3d20 762e 5f5f 6461 736b 5f70  rgs = v.__dask_p
+00007340: 6f73 7470 6572 7369 7374 5f5f 2829 0a20  ostpersist__(). 
+00007350: 2020 2020 2020 2020 2020 2023 2072 656e             # ren
+00007360: 616d 6520 7761 7320 6164 6465 6420 696e  ame was added in
+00007370: 2064 6173 6b20 3230 3231 2e33 0a20 2020   dask 2021.3.   
+00007380: 2020 2020 2020 2020 206b 7761 7267 7320           kwargs 
+00007390: 3d20 7b22 7265 6e61 6d65 223a 2072 656e  = {"rename": ren
+000073a0: 616d 657d 2069 6620 7265 6e61 6d65 2065  ame} if rename e
+000073b0: 6c73 6520 7b7d 0a20 2020 2020 2020 2020  lse {}.         
+000073c0: 2020 2076 6172 6961 626c 6573 5b6b 5d20     variables[k] 
+000073d0: 3d20 7265 6275 696c 6428 6473 6b32 2c20  = rebuild(dsk2, 
+000073e0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+000073f0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00007400: 2074 7970 6528 7365 6c66 292e 5f63 6f6e   type(self)._con
+00007410: 7374 7275 6374 5f64 6972 6563 7428 0a20  struct_direct(. 
+00007420: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00007430: 626c 6573 2c0a 2020 2020 2020 2020 2020  bles,.          
+00007440: 2020 7365 6c66 2e5f 636f 6f72 645f 6e61    self._coord_na
+00007450: 6d65 732c 0a20 2020 2020 2020 2020 2020  mes,.           
+00007460: 2073 656c 662e 5f64 696d 732c 0a20 2020   self._dims,.   
+00007470: 2020 2020 2020 2020 2073 656c 662e 5f61           self._a
+00007480: 7474 7273 2c0a 2020 2020 2020 2020 2020  ttrs,.          
+00007490: 2020 7365 6c66 2e5f 696e 6465 7865 732c    self._indexes,
+000074a0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000074b0: 662e 5f65 6e63 6f64 696e 672c 0a20 2020  f._encoding,.   
+000074c0: 2020 2020 2020 2020 2073 656c 662e 5f63           self._c
+000074d0: 6c6f 7365 2c0a 2020 2020 2020 2020 290a  lose,.        ).
+000074e0: 0a20 2020 2064 6566 2063 6f6d 7075 7465  .    def compute
+000074f0: 2873 656c 663a 2054 5f44 6174 6173 6574  (self: T_Dataset
+00007500: 2c20 2a2a 6b77 6172 6773 2920 2d3e 2054  , **kwargs) -> T
+00007510: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
+00007520: 2020 2222 224d 616e 7561 6c6c 7920 7472    """Manually tr
+00007530: 6967 6765 7220 6c6f 6164 696e 6720 616e  igger loading an
+00007540: 642f 6f72 2063 6f6d 7075 7461 7469 6f6e  d/or computation
+00007550: 206f 6620 7468 6973 2064 6174 6173 6574   of this dataset
+00007560: 2773 2064 6174 610a 2020 2020 2020 2020  's data.        
+00007570: 6672 6f6d 2064 6973 6b20 6f72 2061 2072  from disk or a r
+00007580: 656d 6f74 6520 736f 7572 6365 2069 6e74  emote source int
+00007590: 6f20 6d65 6d6f 7279 2061 6e64 2072 6574  o memory and ret
+000075a0: 7572 6e20 6120 6e65 7720 6461 7461 7365  urn a new datase
+000075b0: 742e 0a20 2020 2020 2020 2055 6e6c 696b  t..        Unlik
+000075c0: 6520 6c6f 6164 2c20 7468 6520 6f72 6967  e load, the orig
+000075d0: 696e 616c 2064 6174 6173 6574 2069 7320  inal dataset is 
+000075e0: 6c65 6674 2075 6e61 6c74 6572 6564 2e0a  left unaltered..
+000075f0: 0a20 2020 2020 2020 204e 6f72 6d61 6c6c  .        Normall
+00007600: 792c 2069 7420 7368 6f75 6c64 206e 6f74  y, it should not
+00007610: 2062 6520 6e65 6365 7373 6172 7920 746f   be necessary to
+00007620: 2063 616c 6c20 7468 6973 206d 6574 686f   call this metho
+00007630: 6420 696e 2075 7365 7220 636f 6465 2c0a  d in user code,.
+00007640: 2020 2020 2020 2020 6265 6361 7573 6520          because 
+00007650: 616c 6c20 7861 7272 6179 2066 756e 6374  all xarray funct
+00007660: 696f 6e73 2073 686f 756c 6420 6569 7468  ions should eith
+00007670: 6572 2077 6f72 6b20 6f6e 2064 6566 6572  er work on defer
+00007680: 7265 6420 6461 7461 206f 720a 2020 2020  red data or.    
+00007690: 2020 2020 6c6f 6164 2064 6174 6120 6175      load data au
+000076a0: 746f 6d61 7469 6361 6c6c 792e 2048 6f77  tomatically. How
+000076b0: 6576 6572 2c20 7468 6973 206d 6574 686f  ever, this metho
+000076c0: 6420 6361 6e20 6265 206e 6563 6573 7361  d can be necessa
+000076d0: 7279 2077 6865 6e0a 2020 2020 2020 2020  ry when.        
+000076e0: 776f 726b 696e 6720 7769 7468 206d 616e  working with man
+000076f0: 7920 6669 6c65 206f 626a 6563 7473 206f  y file objects o
+00007700: 6e20 6469 736b 2e0a 0a20 2020 2020 2020  n disk...       
+00007710: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00007720: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00007730: 2020 2020 2020 202a 2a6b 7761 7267 7320         **kwargs 
+00007740: 3a20 6469 6374 0a20 2020 2020 2020 2020  : dict.         
+00007750: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
+00007760: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+00007770: 7061 7373 6564 206f 6e20 746f 2060 6064  passed on to ``d
+00007780: 6173 6b2e 636f 6d70 7574 6560 602e 0a0a  ask.compute``...
+00007790: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+000077a0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000077b0: 2d0a 2020 2020 2020 2020 6461 736b 2e63  -.        dask.c
+000077c0: 6f6d 7075 7465 0a20 2020 2020 2020 2022  ompute.        "
+000077d0: 2222 0a20 2020 2020 2020 206e 6577 203d  "".        new =
+000077e0: 2073 656c 662e 636f 7079 2864 6565 703d   self.copy(deep=
+000077f0: 4661 6c73 6529 0a20 2020 2020 2020 2072  False).        r
+00007800: 6574 7572 6e20 6e65 772e 6c6f 6164 282a  eturn new.load(*
+00007810: 2a6b 7761 7267 7329 0a0a 2020 2020 6465  *kwargs)..    de
+00007820: 6620 5f70 6572 7369 7374 5f69 6e70 6c61  f _persist_inpla
+00007830: 6365 2873 656c 663a 2054 5f44 6174 6173  ce(self: T_Datas
+00007840: 6574 2c20 2a2a 6b77 6172 6773 2920 2d3e  et, **kwargs) ->
+00007850: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
+00007860: 2020 2020 2222 2250 6572 7369 7374 2061      """Persist a
+00007870: 6c6c 2044 6173 6b20 6172 7261 7973 2069  ll Dask arrays i
+00007880: 6e20 6d65 6d6f 7279 2222 220a 2020 2020  n memory""".    
+00007890: 2020 2020 2320 6163 6365 7373 202e 6461      # access .da
+000078a0: 7461 2074 6f20 636f 6572 6365 2065 7665  ta to coerce eve
+000078b0: 7279 7468 696e 6720 746f 206e 756d 7079  rything to numpy
+000078c0: 206f 7220 6461 736b 2061 7272 6179 730a   or dask arrays.
+000078d0: 2020 2020 2020 2020 6c61 7a79 5f64 6174          lazy_dat
+000078e0: 6120 3d20 7b0a 2020 2020 2020 2020 2020  a = {.          
+000078f0: 2020 6b3a 2076 2e5f 6461 7461 2066 6f72    k: v._data for
+00007900: 206b 2c20 7620 696e 2073 656c 662e 7661   k, v in self.va
+00007910: 7269 6162 6c65 732e 6974 656d 7328 2920  riables.items() 
+00007920: 6966 2069 735f 6475 636b 5f64 6173 6b5f  if is_duck_dask_
+00007930: 6172 7261 7928 762e 5f64 6174 6129 0a20  array(v._data). 
+00007940: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00007950: 2069 6620 6c61 7a79 5f64 6174 613a 0a20   if lazy_data:. 
+00007960: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
+00007970: 7420 6461 736b 0a0a 2020 2020 2020 2020  t dask..        
+00007980: 2020 2020 2320 6576 616c 7561 7465 2061      # evaluate a
+00007990: 6c6c 2074 6865 2064 6173 6b20 6172 7261  ll the dask arra
+000079a0: 7973 2073 696d 756c 7461 6e65 6f75 736c  ys simultaneousl
+000079b0: 790a 2020 2020 2020 2020 2020 2020 6576  y.            ev
+000079c0: 616c 7561 7465 645f 6461 7461 203d 2064  aluated_data = d
+000079d0: 6173 6b2e 7065 7273 6973 7428 2a6c 617a  ask.persist(*laz
+000079e0: 795f 6461 7461 2e76 616c 7565 7328 292c  y_data.values(),
+000079f0: 202a 2a6b 7761 7267 7329 0a0a 2020 2020   **kwargs)..    
+00007a00: 2020 2020 2020 2020 666f 7220 6b2c 2064          for k, d
+00007a10: 6174 6120 696e 207a 6970 286c 617a 795f  ata in zip(lazy_
+00007a20: 6461 7461 2c20 6576 616c 7561 7465 645f  data, evaluated_
+00007a30: 6461 7461 293a 0a20 2020 2020 2020 2020  data):.         
+00007a40: 2020 2020 2020 2073 656c 662e 7661 7269         self.vari
+00007a50: 6162 6c65 735b 6b5d 2e64 6174 6120 3d20  ables[k].data = 
+00007a60: 6461 7461 0a0a 2020 2020 2020 2020 7265  data..        re
+00007a70: 7475 726e 2073 656c 660a 0a20 2020 2064  turn self..    d
+00007a80: 6566 2070 6572 7369 7374 2873 656c 663a  ef persist(self:
+00007a90: 2054 5f44 6174 6173 6574 2c20 2a2a 6b77   T_Dataset, **kw
+00007aa0: 6172 6773 2920 2d3e 2054 5f44 6174 6173  args) -> T_Datas
+00007ab0: 6574 3a0a 2020 2020 2020 2020 2222 2254  et:.        """T
+00007ac0: 7269 6767 6572 2063 6f6d 7075 7461 7469  rigger computati
+00007ad0: 6f6e 2c20 6b65 6570 696e 6720 6461 7461  on, keeping data
+00007ae0: 2061 7320 6461 736b 2061 7272 6179 730a   as dask arrays.
+00007af0: 0a20 2020 2020 2020 2054 6869 7320 6f70  .        This op
+00007b00: 6572 6174 696f 6e20 6361 6e20 6265 2075  eration can be u
+00007b10: 7365 6420 746f 2074 7269 6767 6572 2063  sed to trigger c
+00007b20: 6f6d 7075 7461 7469 6f6e 206f 6e20 756e  omputation on un
+00007b30: 6465 726c 7969 6e67 2064 6173 6b0a 2020  derlying dask.  
+00007b40: 2020 2020 2020 6172 7261 7973 2c20 7369        arrays, si
+00007b50: 6d69 6c61 7220 746f 2060 602e 636f 6d70  milar to ``.comp
+00007b60: 7574 6528 2960 6020 6f72 2060 602e 6c6f  ute()`` or ``.lo
+00007b70: 6164 2829 6060 2e20 2048 6f77 6576 6572  ad()``.  However
+00007b80: 2074 6869 730a 2020 2020 2020 2020 6f70   this.        op
+00007b90: 6572 6174 696f 6e20 6b65 6570 7320 7468  eration keeps th
+00007ba0: 6520 6461 7461 2061 7320 6461 736b 2061  e data as dask a
+00007bb0: 7272 6179 732e 2054 6869 7320 6973 2070  rrays. This is p
+00007bc0: 6172 7469 6375 6c61 726c 7920 7573 6566  articularly usef
+00007bd0: 756c 0a20 2020 2020 2020 2077 6865 6e20  ul.        when 
+00007be0: 7573 696e 6720 7468 6520 6461 736b 2e64  using the dask.d
+00007bf0: 6973 7472 6962 7574 6564 2073 6368 6564  istributed sched
+00007c00: 756c 6572 2061 6e64 2079 6f75 2077 616e  uler and you wan
+00007c10: 7420 746f 206c 6f61 6420 6120 6c61 7267  t to load a larg
+00007c20: 650a 2020 2020 2020 2020 616d 6f75 6e74  e.        amount
+00007c30: 206f 6620 6461 7461 2069 6e74 6f20 6469   of data into di
+00007c40: 7374 7269 6275 7465 6420 6d65 6d6f 7279  stributed memory
+00007c50: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00007c60: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00007c70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00007c80: 202a 2a6b 7761 7267 7320 3a20 6469 6374   **kwargs : dict
+00007c90: 0a20 2020 2020 2020 2020 2020 2041 6464  .            Add
+00007ca0: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
+00007cb0: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
+00007cc0: 206f 6e20 746f 2060 6064 6173 6b2e 7065   on to ``dask.pe
+00007cd0: 7273 6973 7460 602e 0a0a 2020 2020 2020  rsist``...      
+00007ce0: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+00007cf0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00007d00: 2020 2020 6461 736b 2e70 6572 7369 7374      dask.persist
+00007d10: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00007d20: 2020 2020 206e 6577 203d 2073 656c 662e       new = self.
+00007d30: 636f 7079 2864 6565 703d 4661 6c73 6529  copy(deep=False)
+00007d40: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00007d50: 6e65 772e 5f70 6572 7369 7374 5f69 6e70  new._persist_inp
+00007d60: 6c61 6365 282a 2a6b 7761 7267 7329 0a0a  lace(**kwargs)..
+00007d70: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
+00007d80: 0a20 2020 2064 6566 205f 636f 6e73 7472  .    def _constr
+00007d90: 7563 745f 6469 7265 6374 280a 2020 2020  uct_direct(.    
+00007da0: 2020 2020 636c 733a 2074 7970 655b 545f      cls: type[T_
+00007db0: 4461 7461 7365 745d 2c0a 2020 2020 2020  Dataset],.      
+00007dc0: 2020 7661 7269 6162 6c65 733a 2064 6963    variables: dic
+00007dd0: 745b 416e 792c 2056 6172 6961 626c 655d  t[Any, Variable]
+00007de0: 2c0a 2020 2020 2020 2020 636f 6f72 645f  ,.        coord_
+00007df0: 6e61 6d65 733a 2073 6574 5b48 6173 6861  names: set[Hasha
+00007e00: 626c 655d 2c0a 2020 2020 2020 2020 6469  ble],.        di
+00007e10: 6d73 3a20 6469 6374 5b41 6e79 2c20 696e  ms: dict[Any, in
+00007e20: 745d 207c 204e 6f6e 6520 3d20 4e6f 6e65  t] | None = None
+00007e30: 2c0a 2020 2020 2020 2020 6174 7472 733a  ,.        attrs:
+00007e40: 2064 6963 7420 7c20 4e6f 6e65 203d 204e   dict | None = N
+00007e50: 6f6e 652c 0a20 2020 2020 2020 2069 6e64  one,.        ind
+00007e60: 6578 6573 3a20 6469 6374 5b41 6e79 2c20  exes: dict[Any, 
+00007e70: 496e 6465 785d 207c 204e 6f6e 6520 3d20  Index] | None = 
+00007e80: 4e6f 6e65 2c0a 2020 2020 2020 2020 656e  None,.        en
+00007e90: 636f 6469 6e67 3a20 6469 6374 207c 204e  coding: dict | N
+00007ea0: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+00007eb0: 2020 2020 636c 6f73 653a 2043 616c 6c61      close: Calla
+00007ec0: 626c 655b 5b5d 2c20 4e6f 6e65 5d20 7c20  ble[[], None] | 
+00007ed0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+00007ee0: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
+00007ef0: 0a20 2020 2020 2020 2022 2222 5368 6f72  .        """Shor
+00007f00: 7463 7574 2061 726f 756e 6420 5f5f 696e  tcut around __in
+00007f10: 6974 5f5f 2066 6f72 2069 6e74 6572 6e61  it__ for interna
+00007f20: 6c20 7573 6520 7768 656e 2077 6520 7761  l use when we wa
+00007f30: 6e74 2074 6f20 736b 6970 0a20 2020 2020  nt to skip.     
+00007f40: 2020 2063 6f73 746c 7920 7661 6c69 6461     costly valida
+00007f50: 7469 6f6e 0a20 2020 2020 2020 2022 2222  tion.        """
+00007f60: 0a20 2020 2020 2020 2069 6620 6469 6d73  .        if dims
+00007f70: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00007f80: 2020 2020 2020 6469 6d73 203d 2063 616c        dims = cal
+00007f90: 6375 6c61 7465 5f64 696d 656e 7369 6f6e  culate_dimension
+00007fa0: 7328 7661 7269 6162 6c65 7329 0a20 2020  s(variables).   
+00007fb0: 2020 2020 2069 6620 696e 6465 7865 7320       if indexes 
+00007fc0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00007fd0: 2020 2020 2069 6e64 6578 6573 203d 207b       indexes = {
+00007fe0: 7d0a 2020 2020 2020 2020 6f62 6a20 3d20  }.        obj = 
+00007ff0: 6f62 6a65 6374 2e5f 5f6e 6577 5f5f 2863  object.__new__(c
+00008000: 6c73 290a 2020 2020 2020 2020 6f62 6a2e  ls).        obj.
+00008010: 5f76 6172 6961 626c 6573 203d 2076 6172  _variables = var
+00008020: 6961 626c 6573 0a20 2020 2020 2020 206f  iables.        o
+00008030: 626a 2e5f 636f 6f72 645f 6e61 6d65 7320  bj._coord_names 
+00008040: 3d20 636f 6f72 645f 6e61 6d65 730a 2020  = coord_names.  
+00008050: 2020 2020 2020 6f62 6a2e 5f64 696d 7320        obj._dims 
+00008060: 3d20 6469 6d73 0a20 2020 2020 2020 206f  = dims.        o
+00008070: 626a 2e5f 696e 6465 7865 7320 3d20 696e  bj._indexes = in
+00008080: 6465 7865 730a 2020 2020 2020 2020 6f62  dexes.        ob
+00008090: 6a2e 5f61 7474 7273 203d 2061 7474 7273  j._attrs = attrs
+000080a0: 0a20 2020 2020 2020 206f 626a 2e5f 636c  .        obj._cl
+000080b0: 6f73 6520 3d20 636c 6f73 650a 2020 2020  ose = close.    
+000080c0: 2020 2020 6f62 6a2e 5f65 6e63 6f64 696e      obj._encodin
+000080d0: 6720 3d20 656e 636f 6469 6e67 0a20 2020  g = encoding.   
+000080e0: 2020 2020 2072 6574 7572 6e20 6f62 6a0a       return obj.
+000080f0: 0a20 2020 2064 6566 205f 7265 706c 6163  .    def _replac
+00008100: 6528 0a20 2020 2020 2020 2073 656c 663a  e(.        self:
+00008110: 2054 5f44 6174 6173 6574 2c0a 2020 2020   T_Dataset,.    
+00008120: 2020 2020 7661 7269 6162 6c65 733a 2064      variables: d
+00008130: 6963 745b 4861 7368 6162 6c65 2c20 5661  ict[Hashable, Va
+00008140: 7269 6162 6c65 5d20 7c20 4e6f 6e65 203d  riable] | None =
+00008150: 204e 6f6e 652c 0a20 2020 2020 2020 2063   None,.        c
+00008160: 6f6f 7264 5f6e 616d 6573 3a20 7365 745b  oord_names: set[
+00008170: 4861 7368 6162 6c65 5d20 7c20 4e6f 6e65  Hashable] | None
+00008180: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00008190: 2064 696d 733a 2064 6963 745b 416e 792c   dims: dict[Any,
+000081a0: 2069 6e74 5d20 7c20 4e6f 6e65 203d 204e   int] | None = N
+000081b0: 6f6e 652c 0a20 2020 2020 2020 2061 7474  one,.        att
+000081c0: 7273 3a20 6469 6374 5b48 6173 6861 626c  rs: dict[Hashabl
+000081d0: 652c 2041 6e79 5d20 7c20 4e6f 6e65 207c  e, Any] | None |
+000081e0: 2044 6566 6175 6c74 203d 205f 6465 6661   Default = _defa
+000081f0: 756c 742c 0a20 2020 2020 2020 2069 6e64  ult,.        ind
+00008200: 6578 6573 3a20 6469 6374 5b48 6173 6861  exes: dict[Hasha
+00008210: 626c 652c 2049 6e64 6578 5d20 7c20 4e6f  ble, Index] | No
+00008220: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+00008230: 2020 2065 6e63 6f64 696e 673a 2064 6963     encoding: dic
+00008240: 7420 7c20 4e6f 6e65 207c 2044 6566 6175  t | None | Defau
+00008250: 6c74 203d 205f 6465 6661 756c 742c 0a20  lt = _default,. 
+00008260: 2020 2020 2020 2069 6e70 6c61 6365 3a20         inplace: 
+00008270: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00008280: 2020 2920 2d3e 2054 5f44 6174 6173 6574    ) -> T_Dataset
+00008290: 3a0a 2020 2020 2020 2020 2222 2246 6173  :.        """Fas
+000082a0: 7470 6174 6820 636f 6e73 7472 7563 746f  tpath constructo
+000082b0: 7220 666f 7220 696e 7465 726e 616c 2075  r for internal u
+000082c0: 7365 2e0a 0a20 2020 2020 2020 2052 6574  se...        Ret
+000082d0: 7572 6e73 2061 6e20 6f62 6a65 6374 2077  urns an object w
+000082e0: 6974 6820 6f70 7469 6f6e 616c 6c79 2077  ith optionally w
+000082f0: 6974 6820 7265 706c 6163 6564 2061 7474  ith replaced att
+00008300: 7269 6275 7465 732e 0a0a 2020 2020 2020  ributes...      
+00008310: 2020 4578 706c 6963 6974 6c79 2070 6173    Explicitly pas
+00008320: 7365 6420 6172 6775 6d65 6e74 7320 6172  sed arguments ar
+00008330: 6520 2a6e 6f74 2a20 636f 7069 6564 2077  e *not* copied w
+00008340: 6865 6e20 706c 6163 6564 206f 6e20 7468  hen placed on th
+00008350: 6520 6e65 770a 2020 2020 2020 2020 6461  e new.        da
+00008360: 7461 7365 742e 2049 7420 6973 2075 7020  taset. It is up 
+00008370: 746f 2074 6865 2063 616c 6c65 7220 746f  to the caller to
+00008380: 2065 6e73 7572 6520 7468 6174 2074 6865   ensure that the
+00008390: 7920 6861 7665 2074 6865 2072 6967 6874  y have the right
+000083a0: 2074 7970 650a 2020 2020 2020 2020 616e   type.        an
+000083b0: 6420 6172 6520 6e6f 7420 7573 6564 2065  d are not used e
+000083c0: 6c73 6577 6865 7265 2e0a 2020 2020 2020  lsewhere..      
+000083d0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+000083e0: 2069 6e70 6c61 6365 3a0a 2020 2020 2020   inplace:.      
+000083f0: 2020 2020 2020 6966 2076 6172 6961 626c        if variabl
+00008400: 6573 2069 7320 6e6f 7420 4e6f 6e65 3a0a  es is not None:.
+00008410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008420: 7365 6c66 2e5f 7661 7269 6162 6c65 7320  self._variables 
+00008430: 3d20 7661 7269 6162 6c65 730a 2020 2020  = variables.    
+00008440: 2020 2020 2020 2020 6966 2063 6f6f 7264          if coord
+00008450: 5f6e 616d 6573 2069 7320 6e6f 7420 4e6f  _names is not No
+00008460: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00008470: 2020 2020 7365 6c66 2e5f 636f 6f72 645f      self._coord_
+00008480: 6e61 6d65 7320 3d20 636f 6f72 645f 6e61  names = coord_na
+00008490: 6d65 730a 2020 2020 2020 2020 2020 2020  mes.            
+000084a0: 6966 2064 696d 7320 6973 206e 6f74 204e  if dims is not N
+000084b0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000084c0: 2020 2020 2073 656c 662e 5f64 696d 7320       self._dims 
+000084d0: 3d20 6469 6d73 0a20 2020 2020 2020 2020  = dims.         
+000084e0: 2020 2069 6620 6174 7472 7320 6973 206e     if attrs is n
+000084f0: 6f74 205f 6465 6661 756c 743a 0a20 2020  ot _default:.   
+00008500: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00008510: 662e 5f61 7474 7273 203d 2061 7474 7273  f._attrs = attrs
+00008520: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00008530: 696e 6465 7865 7320 6973 206e 6f74 204e  indexes is not N
+00008540: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+00008550: 2020 2020 2073 656c 662e 5f69 6e64 6578       self._index
+00008560: 6573 203d 2069 6e64 6578 6573 0a20 2020  es = indexes.   
+00008570: 2020 2020 2020 2020 2069 6620 656e 636f           if enco
+00008580: 6469 6e67 2069 7320 6e6f 7420 5f64 6566  ding is not _def
+00008590: 6175 6c74 3a0a 2020 2020 2020 2020 2020  ault:.          
+000085a0: 2020 2020 2020 7365 6c66 2e5f 656e 636f        self._enco
+000085b0: 6469 6e67 203d 2065 6e63 6f64 696e 670a  ding = encoding.
+000085c0: 2020 2020 2020 2020 2020 2020 6f62 6a20              obj 
+000085d0: 3d20 7365 6c66 0a20 2020 2020 2020 2065  = self.        e
+000085e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+000085f0: 2069 6620 7661 7269 6162 6c65 7320 6973   if variables is
+00008600: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00008610: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+00008620: 203d 2073 656c 662e 5f76 6172 6961 626c   = self._variabl
+00008630: 6573 2e63 6f70 7928 290a 2020 2020 2020  es.copy().      
+00008640: 2020 2020 2020 6966 2063 6f6f 7264 5f6e        if coord_n
+00008650: 616d 6573 2069 7320 4e6f 6e65 3a0a 2020  ames is None:.  
+00008660: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00008670: 6f72 645f 6e61 6d65 7320 3d20 7365 6c66  ord_names = self
+00008680: 2e5f 636f 6f72 645f 6e61 6d65 732e 636f  ._coord_names.co
+00008690: 7079 2829 0a20 2020 2020 2020 2020 2020  py().           
+000086a0: 2069 6620 6469 6d73 2069 7320 4e6f 6e65   if dims is None
+000086b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000086c0: 2020 6469 6d73 203d 2073 656c 662e 5f64    dims = self._d
+000086d0: 696d 732e 636f 7079 2829 0a20 2020 2020  ims.copy().     
+000086e0: 2020 2020 2020 2069 6620 6174 7472 7320         if attrs 
+000086f0: 6973 205f 6465 6661 756c 743a 0a20 2020  is _default:.   
+00008700: 2020 2020 2020 2020 2020 2020 2061 7474               att
+00008710: 7273 203d 2063 6f70 792e 636f 7079 2873  rs = copy.copy(s
+00008720: 656c 662e 5f61 7474 7273 290a 2020 2020  elf._attrs).    
+00008730: 2020 2020 2020 2020 6966 2069 6e64 6578          if index
+00008740: 6573 2069 7320 4e6f 6e65 3a0a 2020 2020  es is None:.    
+00008750: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00008760: 7865 7320 3d20 7365 6c66 2e5f 696e 6465  xes = self._inde
+00008770: 7865 732e 636f 7079 2829 0a20 2020 2020  xes.copy().     
+00008780: 2020 2020 2020 2069 6620 656e 636f 6469         if encodi
+00008790: 6e67 2069 7320 5f64 6566 6175 6c74 3a0a  ng is _default:.
+000087a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000087b0: 656e 636f 6469 6e67 203d 2063 6f70 792e  encoding = copy.
+000087c0: 636f 7079 2873 656c 662e 5f65 6e63 6f64  copy(self._encod
+000087d0: 696e 6729 0a20 2020 2020 2020 2020 2020  ing).           
+000087e0: 206f 626a 203d 2073 656c 662e 5f63 6f6e   obj = self._con
+000087f0: 7374 7275 6374 5f64 6972 6563 7428 0a20  struct_direct(. 
+00008800: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00008810: 6172 6961 626c 6573 2c20 636f 6f72 645f  ariables, coord_
+00008820: 6e61 6d65 732c 2064 696d 732c 2061 7474  names, dims, att
+00008830: 7273 2c20 696e 6465 7865 732c 2065 6e63  rs, indexes, enc
+00008840: 6f64 696e 670a 2020 2020 2020 2020 2020  oding.          
+00008850: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+00008860: 726e 206f 626a 0a0a 2020 2020 6465 6620  rn obj..    def 
+00008870: 5f72 6570 6c61 6365 5f77 6974 685f 6e65  _replace_with_ne
+00008880: 775f 6469 6d73 280a 2020 2020 2020 2020  w_dims(.        
+00008890: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+000088a0: 0a20 2020 2020 2020 2076 6172 6961 626c  .        variabl
+000088b0: 6573 3a20 6469 6374 5b48 6173 6861 626c  es: dict[Hashabl
+000088c0: 652c 2056 6172 6961 626c 655d 2c0a 2020  e, Variable],.  
+000088d0: 2020 2020 2020 636f 6f72 645f 6e61 6d65        coord_name
+000088e0: 733a 2073 6574 207c 204e 6f6e 6520 3d20  s: set | None = 
+000088f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6174  None,.        at
+00008900: 7472 733a 2064 6963 745b 4861 7368 6162  trs: dict[Hashab
+00008910: 6c65 2c20 416e 795d 207c 204e 6f6e 6520  le, Any] | None 
+00008920: 7c20 4465 6661 756c 7420 3d20 5f64 6566  | Default = _def
+00008930: 6175 6c74 2c0a 2020 2020 2020 2020 696e  ault,.        in
+00008940: 6465 7865 733a 2064 6963 745b 4861 7368  dexes: dict[Hash
+00008950: 6162 6c65 2c20 496e 6465 785d 207c 204e  able, Index] | N
+00008960: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+00008970: 2020 2020 696e 706c 6163 653a 2062 6f6f      inplace: boo
+00008980: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
+00008990: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
+000089a0: 2020 2020 2020 2022 2222 5265 706c 6163         """Replac
+000089b0: 6520 7661 7269 6162 6c65 7320 7769 7468  e variables with
+000089c0: 2072 6563 616c 6375 6c61 7465 6420 6469   recalculated di
+000089d0: 6d65 6e73 696f 6e73 2e22 2222 0a20 2020  mensions.""".   
+000089e0: 2020 2020 2064 696d 7320 3d20 6361 6c63       dims = calc
+000089f0: 756c 6174 655f 6469 6d65 6e73 696f 6e73  ulate_dimensions
+00008a00: 2876 6172 6961 626c 6573 290a 2020 2020  (variables).    
+00008a10: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00008a20: 5f72 6570 6c61 6365 280a 2020 2020 2020  _replace(.      
+00008a30: 2020 2020 2020 7661 7269 6162 6c65 732c        variables,
+00008a40: 2063 6f6f 7264 5f6e 616d 6573 2c20 6469   coord_names, di
+00008a50: 6d73 2c20 6174 7472 732c 2069 6e64 6578  ms, attrs, index
+00008a60: 6573 2c20 696e 706c 6163 653d 696e 706c  es, inplace=inpl
+00008a70: 6163 650a 2020 2020 2020 2020 290a 0a20  ace.        ).. 
+00008a80: 2020 2064 6566 205f 7265 706c 6163 655f     def _replace_
+00008a90: 7661 7273 5f61 6e64 5f64 696d 7328 0a20  vars_and_dims(. 
+00008aa0: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
+00008ab0: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
+00008ac0: 7661 7269 6162 6c65 733a 2064 6963 745b  variables: dict[
+00008ad0: 4861 7368 6162 6c65 2c20 5661 7269 6162  Hashable, Variab
+00008ae0: 6c65 5d2c 0a20 2020 2020 2020 2063 6f6f  le],.        coo
+00008af0: 7264 5f6e 616d 6573 3a20 7365 7420 7c20  rd_names: set | 
+00008b00: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+00008b10: 2020 2020 2064 696d 733a 2064 6963 745b       dims: dict[
+00008b20: 4861 7368 6162 6c65 2c20 696e 745d 207c  Hashable, int] |
+00008b30: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+00008b40: 2020 2020 2020 6174 7472 733a 2064 6963        attrs: dic
+00008b50: 745b 4861 7368 6162 6c65 2c20 416e 795d  t[Hashable, Any]
+00008b60: 207c 204e 6f6e 6520 7c20 4465 6661 756c   | None | Defaul
+00008b70: 7420 3d20 5f64 6566 6175 6c74 2c0a 2020  t = _default,.  
+00008b80: 2020 2020 2020 696e 706c 6163 653a 2062        inplace: b
+00008b90: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
+00008ba0: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
+00008bb0: 0a20 2020 2020 2020 2022 2222 4465 7072  .        """Depr
+00008bc0: 6563 6174 6564 2076 6572 7369 6f6e 206f  ecated version o
+00008bd0: 6620 5f72 6570 6c61 6365 5f77 6974 685f  f _replace_with_
+00008be0: 6e65 775f 6469 6d73 2829 2e0a 0a20 2020  new_dims()...   
+00008bf0: 2020 2020 2055 6e6c 696b 6520 5f72 6570       Unlike _rep
+00008c00: 6c61 6365 5f77 6974 685f 6e65 775f 6469  lace_with_new_di
+00008c10: 6d73 2829 2c20 7468 6973 206d 6574 686f  ms(), this metho
+00008c20: 6420 616c 7761 7973 2072 6563 616c 6375  d always recalcu
+00008c30: 6c61 7465 730a 2020 2020 2020 2020 696e  lates.        in
+00008c40: 6465 7865 7320 6672 6f6d 2076 6172 6961  dexes from varia
+00008c50: 626c 6573 2e0a 2020 2020 2020 2020 2222  bles..        ""
+00008c60: 220a 2020 2020 2020 2020 6966 2064 696d  ".        if dim
+00008c70: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+00008c80: 2020 2020 2020 2064 696d 7320 3d20 6361         dims = ca
+00008c90: 6c63 756c 6174 655f 6469 6d65 6e73 696f  lculate_dimensio
+00008ca0: 6e73 2876 6172 6961 626c 6573 290a 2020  ns(variables).  
+00008cb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00008cc0: 662e 5f72 6570 6c61 6365 280a 2020 2020  f._replace(.    
+00008cd0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+00008ce0: 732c 2063 6f6f 7264 5f6e 616d 6573 2c20  s, coord_names, 
+00008cf0: 6469 6d73 2c20 6174 7472 732c 2069 6e64  dims, attrs, ind
+00008d00: 6578 6573 3d4e 6f6e 652c 2069 6e70 6c61  exes=None, inpla
+00008d10: 6365 3d69 6e70 6c61 6365 0a20 2020 2020  ce=inplace.     
+00008d20: 2020 2029 0a0a 2020 2020 6465 6620 5f6f     )..    def _o
+00008d30: 7665 7277 7269 7465 5f69 6e64 6578 6573  verwrite_indexes
+00008d40: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
+00008d50: 545f 4461 7461 7365 742c 0a20 2020 2020  T_Dataset,.     
+00008d60: 2020 2069 6e64 6578 6573 3a20 4d61 7070     indexes: Mapp
+00008d70: 696e 675b 4861 7368 6162 6c65 2c20 496e  ing[Hashable, In
+00008d80: 6465 785d 2c0a 2020 2020 2020 2020 7661  dex],.        va
+00008d90: 7269 6162 6c65 733a 204d 6170 7069 6e67  riables: Mapping
+00008da0: 5b48 6173 6861 626c 652c 2056 6172 6961  [Hashable, Varia
+00008db0: 626c 655d 207c 204e 6f6e 6520 3d20 4e6f  ble] | None = No
+00008dc0: 6e65 2c0a 2020 2020 2020 2020 6472 6f70  ne,.        drop
+00008dd0: 5f76 6172 6961 626c 6573 3a20 6c69 7374  _variables: list
+00008de0: 5b48 6173 6861 626c 655d 207c 204e 6f6e  [Hashable] | Non
+00008df0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+00008e00: 2020 6472 6f70 5f69 6e64 6578 6573 3a20    drop_indexes: 
+00008e10: 6c69 7374 5b48 6173 6861 626c 655d 207c  list[Hashable] |
+00008e20: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+00008e30: 2020 2020 2020 7265 6e61 6d65 5f64 696d        rename_dim
+00008e40: 733a 204d 6170 7069 6e67 5b48 6173 6861  s: Mapping[Hasha
+00008e50: 626c 652c 2048 6173 6861 626c 655d 207c  ble, Hashable] |
+00008e60: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+00008e70: 2020 2920 2d3e 2054 5f44 6174 6173 6574    ) -> T_Dataset
+00008e80: 3a0a 2020 2020 2020 2020 2222 224d 6179  :.        """May
+00008e90: 6265 2072 6570 6c61 6365 2069 6e64 6578  be replace index
+00008ea0: 6573 2e0a 0a20 2020 2020 2020 2054 6869  es...        Thi
+00008eb0: 7320 6675 6e63 7469 6f6e 206d 6179 2064  s function may d
+00008ec0: 6f20 6120 6c6f 7420 6d6f 7265 2064 6570  o a lot more dep
+00008ed0: 656e 6469 6e67 206f 6e20 696e 6465 7820  ending on index 
+00008ee0: 7175 6572 790a 2020 2020 2020 2020 7265  query.        re
+00008ef0: 7375 6c74 732e 0a0a 2020 2020 2020 2020  sults...        
+00008f00: 2222 220a 2020 2020 2020 2020 6966 206e  """.        if n
+00008f10: 6f74 2069 6e64 6578 6573 3a0a 2020 2020  ot indexes:.    
+00008f20: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00008f30: 656c 660a 0a20 2020 2020 2020 2069 6620  elf..        if 
+00008f40: 7661 7269 6162 6c65 7320 6973 204e 6f6e  variables is Non
+00008f50: 653a 0a20 2020 2020 2020 2020 2020 2076  e:.            v
+00008f60: 6172 6961 626c 6573 203d 207b 7d0a 2020  ariables = {}.  
+00008f70: 2020 2020 2020 6966 2064 726f 705f 7661        if drop_va
+00008f80: 7269 6162 6c65 7320 6973 204e 6f6e 653a  riables is None:
+00008f90: 0a20 2020 2020 2020 2020 2020 2064 726f  .            dro
+00008fa0: 705f 7661 7269 6162 6c65 7320 3d20 5b5d  p_variables = []
+00008fb0: 0a20 2020 2020 2020 2069 6620 6472 6f70  .        if drop
+00008fc0: 5f69 6e64 6578 6573 2069 7320 4e6f 6e65  _indexes is None
+00008fd0: 3a0a 2020 2020 2020 2020 2020 2020 6472  :.            dr
+00008fe0: 6f70 5f69 6e64 6578 6573 203d 205b 5d0a  op_indexes = [].
+00008ff0: 0a20 2020 2020 2020 206e 6577 5f76 6172  .        new_var
+00009000: 6961 626c 6573 203d 2073 656c 662e 5f76  iables = self._v
+00009010: 6172 6961 626c 6573 2e63 6f70 7928 290a  ariables.copy().
+00009020: 2020 2020 2020 2020 6e65 775f 636f 6f72          new_coor
+00009030: 645f 6e61 6d65 7320 3d20 7365 6c66 2e5f  d_names = self._
+00009040: 636f 6f72 645f 6e61 6d65 732e 636f 7079  coord_names.copy
+00009050: 2829 0a20 2020 2020 2020 206e 6577 5f69  ().        new_i
+00009060: 6e64 6578 6573 203d 2064 6963 7428 7365  ndexes = dict(se
+00009070: 6c66 2e5f 696e 6465 7865 7329 0a0a 2020  lf._indexes)..  
+00009080: 2020 2020 2020 696e 6465 785f 7661 7269        index_vari
+00009090: 6162 6c65 7320 3d20 7b7d 0a20 2020 2020  ables = {}.     
+000090a0: 2020 206e 6f5f 696e 6465 785f 7661 7269     no_index_vari
+000090b0: 6162 6c65 7320 3d20 7b7d 0a20 2020 2020  ables = {}.     
+000090c0: 2020 2066 6f72 206e 616d 652c 2076 6172     for name, var
+000090d0: 2069 6e20 7661 7269 6162 6c65 732e 6974   in variables.it
+000090e0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+000090f0: 2020 206f 6c64 5f76 6172 203d 2073 656c     old_var = sel
+00009100: 662e 5f76 6172 6961 626c 6573 2e67 6574  f._variables.get
+00009110: 286e 616d 6529 0a20 2020 2020 2020 2020  (name).         
+00009120: 2020 2069 6620 6f6c 645f 7661 7220 6973     if old_var is
+00009130: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+00009140: 2020 2020 2020 2020 2020 2076 6172 2e61             var.a
+00009150: 7474 7273 2e75 7064 6174 6528 6f6c 645f  ttrs.update(old_
+00009160: 7661 722e 6174 7472 7329 0a20 2020 2020  var.attrs).     
+00009170: 2020 2020 2020 2020 2020 2076 6172 2e65             var.e
+00009180: 6e63 6f64 696e 672e 7570 6461 7465 286f  ncoding.update(o
+00009190: 6c64 5f76 6172 2e65 6e63 6f64 696e 6729  ld_var.encoding)
+000091a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000091b0: 6e61 6d65 2069 6e20 696e 6465 7865 733a  name in indexes:
+000091c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000091d0: 2069 6e64 6578 5f76 6172 6961 626c 6573   index_variables
+000091e0: 5b6e 616d 655d 203d 2076 6172 0a20 2020  [name] = var.   
+000091f0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00009200: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00009210: 6f5f 696e 6465 785f 7661 7269 6162 6c65  o_index_variable
+00009220: 735b 6e61 6d65 5d20 3d20 7661 720a 0a20  s[name] = var.. 
+00009230: 2020 2020 2020 2066 6f72 206e 616d 6520         for name 
+00009240: 696e 2069 6e64 6578 6573 3a0a 2020 2020  in indexes:.    
+00009250: 2020 2020 2020 2020 6e65 775f 696e 6465          new_inde
+00009260: 7865 735b 6e61 6d65 5d20 3d20 696e 6465  xes[name] = inde
+00009270: 7865 735b 6e61 6d65 5d0a 0a20 2020 2020  xes[name]..     
+00009280: 2020 2066 6f72 206e 616d 652c 2076 6172     for name, var
+00009290: 2069 6e20 696e 6465 785f 7661 7269 6162   in index_variab
+000092a0: 6c65 732e 6974 656d 7328 293a 0a20 2020  les.items():.   
+000092b0: 2020 2020 2020 2020 206e 6577 5f63 6f6f           new_coo
+000092c0: 7264 5f6e 616d 6573 2e61 6464 286e 616d  rd_names.add(nam
+000092d0: 6529 0a20 2020 2020 2020 2020 2020 206e  e).            n
+000092e0: 6577 5f76 6172 6961 626c 6573 5b6e 616d  ew_variables[nam
+000092f0: 655d 203d 2076 6172 0a0a 2020 2020 2020  e] = var..      
+00009300: 2020 2320 6170 7065 6e64 206e 6f2d 696e    # append no-in
+00009310: 6465 7820 7661 7269 6162 6c65 7320 6174  dex variables at
+00009320: 2074 6865 2065 6e64 0a20 2020 2020 2020   the end.       
+00009330: 2066 6f72 206b 2069 6e20 6e6f 5f69 6e64   for k in no_ind
+00009340: 6578 5f76 6172 6961 626c 6573 3a0a 2020  ex_variables:.  
+00009350: 2020 2020 2020 2020 2020 6e65 775f 7661            new_va
+00009360: 7269 6162 6c65 732e 706f 7028 6b29 0a20  riables.pop(k). 
+00009370: 2020 2020 2020 206e 6577 5f76 6172 6961         new_varia
+00009380: 626c 6573 2e75 7064 6174 6528 6e6f 5f69  bles.update(no_i
+00009390: 6e64 6578 5f76 6172 6961 626c 6573 290a  ndex_variables).
+000093a0: 0a20 2020 2020 2020 2066 6f72 206e 616d  .        for nam
+000093b0: 6520 696e 2064 726f 705f 696e 6465 7865  e in drop_indexe
+000093c0: 733a 0a20 2020 2020 2020 2020 2020 206e  s:.            n
+000093d0: 6577 5f69 6e64 6578 6573 2e70 6f70 286e  ew_indexes.pop(n
+000093e0: 616d 6529 0a0a 2020 2020 2020 2020 666f  ame)..        fo
+000093f0: 7220 6e61 6d65 2069 6e20 6472 6f70 5f76  r name in drop_v
+00009400: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
+00009410: 2020 2020 2020 6e65 775f 7661 7269 6162        new_variab
+00009420: 6c65 732e 706f 7028 6e61 6d65 290a 2020  les.pop(name).  
+00009430: 2020 2020 2020 2020 2020 6e65 775f 696e            new_in
+00009440: 6465 7865 732e 706f 7028 6e61 6d65 2c20  dexes.pop(name, 
+00009450: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
+00009460: 2020 6e65 775f 636f 6f72 645f 6e61 6d65    new_coord_name
+00009470: 732e 7265 6d6f 7665 286e 616d 6529 0a0a  s.remove(name)..
+00009480: 2020 2020 2020 2020 7265 706c 6163 6564          replaced
+00009490: 203d 2073 656c 662e 5f72 6570 6c61 6365   = self._replace
+000094a0: 280a 2020 2020 2020 2020 2020 2020 7661  (.            va
+000094b0: 7269 6162 6c65 733d 6e65 775f 7661 7269  riables=new_vari
+000094c0: 6162 6c65 732c 2063 6f6f 7264 5f6e 616d  ables, coord_nam
+000094d0: 6573 3d6e 6577 5f63 6f6f 7264 5f6e 616d  es=new_coord_nam
+000094e0: 6573 2c20 696e 6465 7865 733d 6e65 775f  es, indexes=new_
+000094f0: 696e 6465 7865 730a 2020 2020 2020 2020  indexes.        
+00009500: 290a 0a20 2020 2020 2020 2069 6620 7265  )..        if re
+00009510: 6e61 6d65 5f64 696d 733a 0a20 2020 2020  name_dims:.     
+00009520: 2020 2020 2020 2023 2073 6b69 7020 7265         # skip re
+00009530: 6e61 6d65 2069 6e64 6578 6573 3a20 7468  name indexes: th
+00009540: 6579 2073 686f 756c 6420 616c 7265 6164  ey should alread
+00009550: 7920 6861 7665 2074 6865 2072 6967 6874  y have the right
+00009560: 206e 616d 6528 7329 0a20 2020 2020 2020   name(s).       
+00009570: 2020 2020 2064 696d 7320 3d20 7265 706c       dims = repl
+00009580: 6163 6564 2e5f 7265 6e61 6d65 5f64 696d  aced._rename_dim
+00009590: 7328 7265 6e61 6d65 5f64 696d 7329 0a20  s(rename_dims). 
+000095a0: 2020 2020 2020 2020 2020 206e 6577 5f76             new_v
+000095b0: 6172 6961 626c 6573 2c20 6e65 775f 636f  ariables, new_co
+000095c0: 6f72 645f 6e61 6d65 7320 3d20 7265 706c  ord_names = repl
+000095d0: 6163 6564 2e5f 7265 6e61 6d65 5f76 6172  aced._rename_var
+000095e0: 7328 7b7d 2c20 7265 6e61 6d65 5f64 696d  s({}, rename_dim
+000095f0: 7329 0a20 2020 2020 2020 2020 2020 2072  s).            r
+00009600: 6574 7572 6e20 7265 706c 6163 6564 2e5f  eturn replaced._
+00009610: 7265 706c 6163 6528 0a20 2020 2020 2020  replace(.       
+00009620: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
+00009630: 6573 3d6e 6577 5f76 6172 6961 626c 6573  es=new_variables
+00009640: 2c20 636f 6f72 645f 6e61 6d65 733d 6e65  , coord_names=ne
+00009650: 775f 636f 6f72 645f 6e61 6d65 732c 2064  w_coord_names, d
+00009660: 696d 733d 6469 6d73 0a20 2020 2020 2020  ims=dims.       
+00009670: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
+00009680: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00009690: 2072 6574 7572 6e20 7265 706c 6163 6564   return replaced
+000096a0: 0a0a 2020 2020 6465 6620 636f 7079 280a  ..    def copy(.
+000096b0: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
+000096c0: 4461 7461 7365 742c 2064 6565 703a 2062  Dataset, deep: b
+000096d0: 6f6f 6c20 3d20 4661 6c73 652c 2064 6174  ool = False, dat
+000096e0: 613a 204d 6170 7069 6e67 5b41 6e79 2c20  a: Mapping[Any, 
+000096f0: 4172 7261 794c 696b 655d 207c 204e 6f6e  ArrayLike] | Non
+00009700: 6520 3d20 4e6f 6e65 0a20 2020 2029 202d  e = None.    ) -
+00009710: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
+00009720: 2020 2020 2022 2222 5265 7475 726e 7320       """Returns 
+00009730: 6120 636f 7079 206f 6620 7468 6973 2064  a copy of this d
+00009740: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
+00009750: 2049 6620 6064 6565 703d 5472 7565 602c   If `deep=True`,
+00009760: 2061 2064 6565 7020 636f 7079 2069 7320   a deep copy is 
+00009770: 6d61 6465 206f 6620 6561 6368 206f 6620  made of each of 
+00009780: 7468 6520 636f 6d70 6f6e 656e 7420 7661  the component va
+00009790: 7269 6162 6c65 732e 0a20 2020 2020 2020  riables..       
+000097a0: 204f 7468 6572 7769 7365 2c20 6120 7368   Otherwise, a sh
+000097b0: 616c 6c6f 7720 636f 7079 206f 6620 6561  allow copy of ea
+000097c0: 6368 206f 6620 7468 6520 636f 6d70 6f6e  ch of the compon
+000097d0: 656e 7420 7661 7269 6162 6c65 2069 7320  ent variable is 
+000097e0: 6d61 6465 2c20 736f 0a20 2020 2020 2020  made, so.       
+000097f0: 2074 6861 7420 7468 6520 756e 6465 726c   that the underl
+00009800: 7969 6e67 206d 656d 6f72 7920 7265 6769  ying memory regi
+00009810: 6f6e 206f 6620 7468 6520 6e65 7720 6461  on of the new da
+00009820: 7461 7365 7420 6973 2074 6865 2073 616d  taset is the sam
+00009830: 6520 6173 2069 6e0a 2020 2020 2020 2020  e as in.        
+00009840: 7468 6520 6f72 6967 696e 616c 2064 6174  the original dat
+00009850: 6173 6574 2e0a 0a20 2020 2020 2020 2055  aset...        U
+00009860: 7365 2060 6461 7461 6020 746f 2063 7265  se `data` to cre
+00009870: 6174 6520 6120 6e65 7720 6f62 6a65 6374  ate a new object
+00009880: 2077 6974 6820 7468 6520 7361 6d65 2073   with the same s
+00009890: 7472 7563 7475 7265 2061 730a 2020 2020  tructure as.    
+000098a0: 2020 2020 6f72 6967 696e 616c 2062 7574      original but
+000098b0: 2065 6e74 6972 656c 7920 6e65 7720 6461   entirely new da
+000098c0: 7461 2e0a 0a20 2020 2020 2020 2050 6172  ta...        Par
+000098d0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+000098e0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+000098f0: 2020 2064 6565 7020 3a20 626f 6f6c 2c20     deep : bool, 
+00009900: 6465 6661 756c 743a 2046 616c 7365 0a20  default: False. 
+00009910: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+00009920: 6572 2065 6163 6820 636f 6d70 6f6e 656e  er each componen
+00009930: 7420 7661 7269 6162 6c65 2069 7320 6c6f  t variable is lo
+00009940: 6164 6564 2069 6e74 6f20 6d65 6d6f 7279  aded into memory
+00009950: 2061 6e64 2063 6f70 6965 6420 6f6e 746f   and copied onto
+00009960: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+00009970: 206e 6577 206f 626a 6563 742e 2044 6566   new object. Def
+00009980: 6175 6c74 2069 7320 4661 6c73 652e 0a20  ault is False.. 
+00009990: 2020 2020 2020 2064 6174 6120 3a20 6469         data : di
+000099a0: 6374 2d6c 696b 6520 6f72 204e 6f6e 652c  ct-like or None,
+000099b0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+000099c0: 2020 2020 2020 4461 7461 2074 6f20 7573        Data to us
+000099d0: 6520 696e 2074 6865 206e 6577 206f 626a  e in the new obj
+000099e0: 6563 742e 2045 6163 6820 6974 656d 2069  ect. Each item i
+000099f0: 6e20 6064 6174 6160 206d 7573 7420 6861  n `data` must ha
+00009a00: 7665 2073 616d 650a 2020 2020 2020 2020  ve same.        
+00009a10: 2020 2020 7368 6170 6520 6173 2063 6f72      shape as cor
+00009a20: 7265 7370 6f6e 6469 6e67 2064 6174 6120  responding data 
+00009a30: 7661 7269 6162 6c65 2069 6e20 6f72 6967  variable in orig
+00009a40: 696e 616c 2e20 5768 656e 2060 6461 7461  inal. When `data
+00009a50: 6020 6973 0a20 2020 2020 2020 2020 2020  ` is.           
+00009a60: 2075 7365 642c 2060 6465 6570 6020 6973   used, `deep` is
+00009a70: 2069 676e 6f72 6564 2066 6f72 2074 6865   ignored for the
+00009a80: 2064 6174 6120 7661 7269 6162 6c65 7320   data variables 
+00009a90: 616e 6420 6f6e 6c79 2075 7365 6420 666f  and only used fo
+00009aa0: 720a 2020 2020 2020 2020 2020 2020 636f  r.            co
+00009ab0: 6f72 6473 2e0a 0a20 2020 2020 2020 2052  ords...        R
+00009ac0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+00009ad0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
+00009ae0: 626a 6563 7420 3a20 4461 7461 7365 740a  bject : Dataset.
+00009af0: 2020 2020 2020 2020 2020 2020 4e65 7720              New 
+00009b00: 6f62 6a65 6374 2077 6974 6820 6469 6d65  object with dime
+00009b10: 6e73 696f 6e73 2c20 6174 7472 6962 7574  nsions, attribut
+00009b20: 6573 2c20 636f 6f72 6469 6e61 7465 732c  es, coordinates,
+00009b30: 206e 616d 652c 2065 6e63 6f64 696e 672c   name, encoding,
+00009b40: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00009b50: 206f 7074 696f 6e61 6c6c 7920 6461 7461   optionally data
+00009b60: 2063 6f70 6965 6420 6672 6f6d 206f 7269   copied from ori
+00009b70: 6769 6e61 6c2e 0a0a 2020 2020 2020 2020  ginal...        
+00009b80: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+00009b90: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00009ba0: 2020 5368 616c 6c6f 7720 636f 7079 2076    Shallow copy v
+00009bb0: 6572 7375 7320 6465 6570 2063 6f70 790a  ersus deep copy.
+00009bc0: 0a20 2020 2020 2020 203e 3e3e 2064 6120  .        >>> da 
+00009bd0: 3d20 7872 2e44 6174 6141 7272 6179 286e  = xr.DataArray(n
+00009be0: 702e 7261 6e64 6f6d 2e72 616e 646e 2832  p.random.randn(2
+00009bf0: 2c20 3329 290a 2020 2020 2020 2020 3e3e  , 3)).        >>
+00009c00: 3e20 6473 203d 2078 722e 4461 7461 7365  > ds = xr.Datase
+00009c10: 7428 0a20 2020 2020 2020 202e 2e2e 2020  t(.        ...  
+00009c20: 2020 207b 2266 6f6f 223a 2064 612c 2022     {"foo": da, "
+00009c30: 6261 7222 3a20 2822 7822 2c20 5b2d 312c  bar": ("x", [-1,
+00009c40: 2032 5d29 7d2c 0a20 2020 2020 2020 202e   2])},.        .
+00009c50: 2e2e 2020 2020 2063 6f6f 7264 733d 7b22  ..     coords={"
+00009c60: 7822 3a20 5b22 6f6e 6522 2c20 2274 776f  x": ["one", "two
+00009c70: 225d 7d2c 0a20 2020 2020 2020 202e 2e2e  "]},.        ...
+00009c80: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+00009c90: 732e 636f 7079 2829 0a20 2020 2020 2020  s.copy().       
+00009ca0: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+00009cb0: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
+00009cc0: 696f 6e73 3a20 2028 6469 6d5f 303a 2032  ions:  (dim_0: 2
+00009cd0: 2c20 6469 6d5f 313a 2033 2c20 783a 2032  , dim_1: 3, x: 2
+00009ce0: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
+00009cf0: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
+00009d00: 202a 2078 2020 2020 2020 2020 2878 2920   * x        (x) 
+00009d10: 3c55 3320 276f 6e65 2720 2774 776f 270a  <U3 'one' 'two'.
+00009d20: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+00009d30: 6e73 2077 6974 686f 7574 2063 6f6f 7264  ns without coord
+00009d40: 696e 6174 6573 3a20 6469 6d5f 302c 2064  inates: dim_0, d
+00009d50: 696d 5f31 0a20 2020 2020 2020 2044 6174  im_1.        Dat
+00009d60: 6120 7661 7269 6162 6c65 733a 0a20 2020  a variables:.   
+00009d70: 2020 2020 2020 2020 2066 6f6f 2020 2020           foo    
+00009d80: 2020 2864 696d 5f30 2c20 6469 6d5f 3129    (dim_0, dim_1)
+00009d90: 2066 6c6f 6174 3634 2031 2e37 3634 2030   float64 1.764 0
+00009da0: 2e34 3030 3220 302e 3937 3837 2032 2e32  .4002 0.9787 2.2
+00009db0: 3431 2031 2e38 3638 202d 302e 3937 3733  41 1.868 -0.9773
+00009dc0: 0a20 2020 2020 2020 2020 2020 2062 6172  .            bar
+00009dd0: 2020 2020 2020 2878 2920 696e 7436 3420        (x) int64 
+00009de0: 2d31 2032 0a0a 2020 2020 2020 2020 3e3e  -1 2..        >>
+00009df0: 3e20 6473 5f30 203d 2064 732e 636f 7079  > ds_0 = ds.copy
+00009e00: 2864 6565 703d 4661 6c73 6529 0a20 2020  (deep=False).   
+00009e10: 2020 2020 203e 3e3e 2064 735f 305b 2266       >>> ds_0["f
+00009e20: 6f6f 225d 5b30 2c20 305d 203d 2037 0a20  oo"][0, 0] = 7. 
+00009e30: 2020 2020 2020 203e 3e3e 2064 735f 300a         >>> ds_0.
+00009e40: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
+00009e50: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
+00009e60: 2044 696d 656e 7369 6f6e 733a 2020 2864   Dimensions:  (d
+00009e70: 696d 5f30 3a20 322c 2064 696d 5f31 3a20  im_0: 2, dim_1: 
+00009e80: 332c 2078 3a20 3229 0a20 2020 2020 2020  3, x: 2).       
+00009e90: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
+00009ea0: 2020 2020 2020 2020 2a20 7820 2020 2020          * x     
+00009eb0: 2020 2028 7829 203c 5533 2027 6f6e 6527     (x) <U3 'one'
+00009ec0: 2027 7477 6f27 0a20 2020 2020 2020 2044   'two'.        D
+00009ed0: 696d 656e 7369 6f6e 7320 7769 7468 6f75  imensions withou
+00009ee0: 7420 636f 6f72 6469 6e61 7465 733a 2064  t coordinates: d
+00009ef0: 696d 5f30 2c20 6469 6d5f 310a 2020 2020  im_0, dim_1.    
+00009f00: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
+00009f10: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00009f20: 666f 6f20 2020 2020 2028 6469 6d5f 302c  foo      (dim_0,
+00009f30: 2064 696d 5f31 2920 666c 6f61 7436 3420   dim_1) float64 
+00009f40: 372e 3020 302e 3430 3032 2030 2e39 3738  7.0 0.4002 0.978
+00009f50: 3720 322e 3234 3120 312e 3836 3820 2d30  7 2.241 1.868 -0
+00009f60: 2e39 3737 330a 2020 2020 2020 2020 2020  .9773.          
+00009f70: 2020 6261 7220 2020 2020 2028 7829 2069    bar      (x) i
+00009f80: 6e74 3634 202d 3120 320a 0a20 2020 2020  nt64 -1 2..     
+00009f90: 2020 203e 3e3e 2064 730a 2020 2020 2020     >>> ds.      
+00009fa0: 2020 3c78 6172 7261 792e 4461 7461 7365    <xarray.Datase
+00009fb0: 743e 0a20 2020 2020 2020 2044 696d 656e  t>.        Dimen
+00009fc0: 7369 6f6e 733a 2020 2864 696d 5f30 3a20  sions:  (dim_0: 
+00009fd0: 322c 2064 696d 5f31 3a20 332c 2078 3a20  2, dim_1: 3, x: 
+00009fe0: 3229 0a20 2020 2020 2020 2043 6f6f 7264  2).        Coord
+00009ff0: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
+0000a000: 2020 2a20 7820 2020 2020 2020 2028 7829    * x        (x)
+0000a010: 203c 5533 2027 6f6e 6527 2027 7477 6f27   <U3 'one' 'two'
+0000a020: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
+0000a030: 6f6e 7320 7769 7468 6f75 7420 636f 6f72  ons without coor
+0000a040: 6469 6e61 7465 733a 2064 696d 5f30 2c20  dinates: dim_0, 
+0000a050: 6469 6d5f 310a 2020 2020 2020 2020 4461  dim_1.        Da
+0000a060: 7461 2076 6172 6961 626c 6573 3a0a 2020  ta variables:.  
+0000a070: 2020 2020 2020 2020 2020 666f 6f20 2020            foo   
+0000a080: 2020 2028 6469 6d5f 302c 2064 696d 5f31     (dim_0, dim_1
+0000a090: 2920 666c 6f61 7436 3420 372e 3020 302e  ) float64 7.0 0.
+0000a0a0: 3430 3032 2030 2e39 3738 3720 322e 3234  4002 0.9787 2.24
+0000a0b0: 3120 312e 3836 3820 2d30 2e39 3737 330a  1 1.868 -0.9773.
+0000a0c0: 2020 2020 2020 2020 2020 2020 6261 7220              bar 
+0000a0d0: 2020 2020 2028 7829 2069 6e74 3634 202d       (x) int64 -
+0000a0e0: 3120 320a 0a20 2020 2020 2020 2043 6861  1 2..        Cha
+0000a0f0: 6e67 696e 6720 7468 6520 6461 7461 2075  nging the data u
+0000a100: 7369 6e67 2074 6865 2060 6064 6174 6160  sing the ``data`
+0000a110: 6020 6172 6775 6d65 6e74 206d 6169 6e74  ` argument maint
+0000a120: 6169 6e73 2074 6865 0a20 2020 2020 2020  ains the.       
+0000a130: 2073 7472 7563 7475 7265 206f 6620 7468   structure of th
+0000a140: 6520 6f72 6967 696e 616c 206f 626a 6563  e original objec
+0000a150: 742c 2062 7574 2077 6974 6820 7468 6520  t, but with the 
+0000a160: 6e65 7720 6461 7461 2e20 4f72 6967 696e  new data. Origin
+0000a170: 616c 0a20 2020 2020 2020 206f 626a 6563  al.        objec
+0000a180: 7420 6973 2075 6e61 6666 6563 7465 642e  t is unaffected.
+0000a190: 0a0a 2020 2020 2020 2020 3e3e 3e20 6473  ..        >>> ds
+0000a1a0: 2e63 6f70 7928 6461 7461 3d7b 2266 6f6f  .copy(data={"foo
+0000a1b0: 223a 206e 702e 6172 616e 6765 2836 292e  ": np.arange(6).
+0000a1c0: 7265 7368 6170 6528 322c 2033 292c 2022  reshape(2, 3), "
+0000a1d0: 6261 7222 3a20 5b22 6122 2c20 2262 225d  bar": ["a", "b"]
+0000a1e0: 7d29 0a20 2020 2020 2020 203c 7861 7272  }).        <xarr
+0000a1f0: 6179 2e44 6174 6173 6574 3e0a 2020 2020  ay.Dataset>.    
+0000a200: 2020 2020 4469 6d65 6e73 696f 6e73 3a20      Dimensions: 
+0000a210: 2028 6469 6d5f 303a 2032 2c20 6469 6d5f   (dim_0: 2, dim_
+0000a220: 313a 2033 2c20 783a 2032 290a 2020 2020  1: 3, x: 2).    
+0000a230: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
+0000a240: 0a20 2020 2020 2020 2020 202a 2078 2020  .          * x  
+0000a250: 2020 2020 2020 2878 2920 3c55 3320 276f        (x) <U3 'o
+0000a260: 6e65 2720 2774 776f 270a 2020 2020 2020  ne' 'two'.      
+0000a270: 2020 4469 6d65 6e73 696f 6e73 2077 6974    Dimensions wit
+0000a280: 686f 7574 2063 6f6f 7264 696e 6174 6573  hout coordinates
+0000a290: 3a20 6469 6d5f 302c 2064 696d 5f31 0a20  : dim_0, dim_1. 
+0000a2a0: 2020 2020 2020 2044 6174 6120 7661 7269         Data vari
+0000a2b0: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
+0000a2c0: 2020 2066 6f6f 2020 2020 2020 2864 696d     foo      (dim
+0000a2d0: 5f30 2c20 6469 6d5f 3129 2069 6e74 3634  _0, dim_1) int64
+0000a2e0: 2030 2031 2032 2033 2034 2035 0a20 2020   0 1 2 3 4 5.   
+0000a2f0: 2020 2020 2020 2020 2062 6172 2020 2020           bar    
+0000a300: 2020 2878 2920 3c55 3120 2761 2720 2762    (x) <U1 'a' 'b
+0000a310: 270a 0a20 2020 2020 2020 203e 3e3e 2064  '..        >>> d
+0000a320: 730a 2020 2020 2020 2020 3c78 6172 7261  s.        <xarra
+0000a330: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
+0000a340: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
+0000a350: 2864 696d 5f30 3a20 322c 2064 696d 5f31  (dim_0: 2, dim_1
+0000a360: 3a20 332c 2078 3a20 3229 0a20 2020 2020  : 3, x: 2).     
+0000a370: 2020 2043 6f6f 7264 696e 6174 6573 3a0a     Coordinates:.
+0000a380: 2020 2020 2020 2020 2020 2a20 7820 2020            * x   
+0000a390: 2020 2020 2028 7829 203c 5533 2027 6f6e       (x) <U3 'on
+0000a3a0: 6527 2027 7477 6f27 0a20 2020 2020 2020  e' 'two'.       
+0000a3b0: 2044 696d 656e 7369 6f6e 7320 7769 7468   Dimensions with
+0000a3c0: 6f75 7420 636f 6f72 6469 6e61 7465 733a  out coordinates:
+0000a3d0: 2064 696d 5f30 2c20 6469 6d5f 310a 2020   dim_0, dim_1.  
+0000a3e0: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
+0000a3f0: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
+0000a400: 2020 666f 6f20 2020 2020 2028 6469 6d5f    foo      (dim_
+0000a410: 302c 2064 696d 5f31 2920 666c 6f61 7436  0, dim_1) float6
+0000a420: 3420 372e 3020 302e 3430 3032 2030 2e39  4 7.0 0.4002 0.9
+0000a430: 3738 3720 322e 3234 3120 312e 3836 3820  787 2.241 1.868 
+0000a440: 2d30 2e39 3737 330a 2020 2020 2020 2020  -0.9773.        
+0000a450: 2020 2020 6261 7220 2020 2020 2028 7829      bar      (x)
+0000a460: 2069 6e74 3634 202d 3120 320a 0a20 2020   int64 -1 2..   
+0000a470: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+0000a480: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+0000a490: 2020 2020 2020 2070 616e 6461 732e 4461         pandas.Da
+0000a4a0: 7461 4672 616d 652e 636f 7079 0a20 2020  taFrame.copy.   
+0000a4b0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000a4c0: 2072 6574 7572 6e20 7365 6c66 2e5f 636f   return self._co
+0000a4d0: 7079 2864 6565 703d 6465 6570 2c20 6461  py(deep=deep, da
+0000a4e0: 7461 3d64 6174 6129 0a0a 2020 2020 6465  ta=data)..    de
+0000a4f0: 6620 5f63 6f70 7928 0a20 2020 2020 2020  f _copy(.       
+0000a500: 2073 656c 663a 2054 5f44 6174 6173 6574   self: T_Dataset
+0000a510: 2c0a 2020 2020 2020 2020 6465 6570 3a20  ,.        deep: 
+0000a520: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0000a530: 2020 2020 2020 6461 7461 3a20 4d61 7070        data: Mapp
+0000a540: 696e 675b 416e 792c 2041 7272 6179 4c69  ing[Any, ArrayLi
+0000a550: 6b65 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ke] | None = Non
+0000a560: 652c 0a20 2020 2020 2020 206d 656d 6f3a  e,.        memo:
+0000a570: 2064 6963 745b 696e 742c 2041 6e79 5d20   dict[int, Any] 
+0000a580: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+0000a590: 2020 2029 202d 3e20 545f 4461 7461 7365     ) -> T_Datase
+0000a5a0: 743a 0a20 2020 2020 2020 2069 6620 6461  t:.        if da
+0000a5b0: 7461 2069 7320 4e6f 6e65 3a0a 2020 2020  ta is None:.    
+0000a5c0: 2020 2020 2020 2020 6461 7461 203d 207b          data = {
+0000a5d0: 7d0a 2020 2020 2020 2020 656c 6966 206e  }.        elif n
+0000a5e0: 6f74 2075 7469 6c73 2e69 735f 6469 6374  ot utils.is_dict
+0000a5f0: 5f6c 696b 6528 6461 7461 293a 0a20 2020  _like(data):.   
+0000a600: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0000a610: 616c 7565 4572 726f 7228 2244 6174 6120  alueError("Data 
+0000a620: 6d75 7374 2062 6520 6469 6374 2d6c 696b  must be dict-lik
+0000a630: 6522 290a 0a20 2020 2020 2020 2069 6620  e")..        if 
+0000a640: 6461 7461 3a0a 2020 2020 2020 2020 2020  data:.          
+0000a650: 2020 7661 725f 6b65 7973 203d 2073 6574    var_keys = set
+0000a660: 2873 656c 662e 6461 7461 5f76 6172 732e  (self.data_vars.
+0000a670: 6b65 7973 2829 290a 2020 2020 2020 2020  keys()).        
+0000a680: 2020 2020 6461 7461 5f6b 6579 7320 3d20      data_keys = 
+0000a690: 7365 7428 6461 7461 2e6b 6579 7328 2929  set(data.keys())
+0000a6a0: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+0000a6b0: 735f 6e6f 745f 696e 5f76 6172 7320 3d20  s_not_in_vars = 
+0000a6c0: 6461 7461 5f6b 6579 7320 2d20 7661 725f  data_keys - var_
+0000a6d0: 6b65 7973 0a20 2020 2020 2020 2020 2020  keys.           
+0000a6e0: 2069 6620 6b65 7973 5f6e 6f74 5f69 6e5f   if keys_not_in_
+0000a6f0: 7661 7273 3a0a 2020 2020 2020 2020 2020  vars:.          
+0000a700: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+0000a710: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+0000a720: 2020 2020 2020 2020 2020 2020 2244 6174              "Dat
+0000a730: 6120 6d75 7374 206f 6e6c 7920 636f 6e74  a must only cont
+0000a740: 6169 6e20 7661 7269 6162 6c65 7320 696e  ain variables in
+0000a750: 206f 7269 6769 6e61 6c20 220a 2020 2020   original ".    
+0000a760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a770: 2264 6174 6173 6574 2e20 4578 7472 6120  "dataset. Extra 
+0000a780: 7661 7269 6162 6c65 733a 207b 7d22 2e66  variables: {}".f
+0000a790: 6f72 6d61 7428 6b65 7973 5f6e 6f74 5f69  ormat(keys_not_i
+0000a7a0: 6e5f 7661 7273 290a 2020 2020 2020 2020  n_vars).        
+0000a7b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000a7c0: 2020 2020 2020 6b65 7973 5f6d 6973 7369        keys_missi
+0000a7d0: 6e67 5f66 726f 6d5f 6461 7461 203d 2076  ng_from_data = v
+0000a7e0: 6172 5f6b 6579 7320 2d20 6461 7461 5f6b  ar_keys - data_k
+0000a7f0: 6579 730a 2020 2020 2020 2020 2020 2020  eys.            
+0000a800: 6966 206b 6579 735f 6d69 7373 696e 675f  if keys_missing_
+0000a810: 6672 6f6d 5f64 6174 613a 0a20 2020 2020  from_data:.     
+0000a820: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000a830: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0000a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a850: 2022 4461 7461 206d 7573 7420 636f 6e74   "Data must cont
+0000a860: 6169 6e20 616c 6c20 7661 7269 6162 6c65  ain all variable
+0000a870: 7320 696e 206f 7269 6769 6e61 6c20 220a  s in original ".
+0000a880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a890: 2020 2020 2264 6174 6173 6574 2e20 4461      "dataset. Da
+0000a8a0: 7461 2069 7320 6d69 7373 696e 6720 7b7d  ta is missing {}
+0000a8b0: 222e 666f 726d 6174 286b 6579 735f 6d69  ".format(keys_mi
+0000a8c0: 7373 696e 675f 6672 6f6d 5f64 6174 6129  ssing_from_data)
+0000a8d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a8e0: 2029 0a0a 2020 2020 2020 2020 696e 6465   )..        inde
+0000a8f0: 7865 732c 2069 6e64 6578 5f76 6172 7320  xes, index_vars 
+0000a900: 3d20 7365 6c66 2e78 696e 6465 7865 732e  = self.xindexes.
+0000a910: 636f 7079 5f69 6e64 6578 6573 2864 6565  copy_indexes(dee
+0000a920: 703d 6465 6570 290a 0a20 2020 2020 2020  p=deep)..       
+0000a930: 2076 6172 6961 626c 6573 203d 207b 7d0a   variables = {}.
+0000a940: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
+0000a950: 2069 6e20 7365 6c66 2e5f 7661 7269 6162   in self._variab
+0000a960: 6c65 732e 6974 656d 7328 293a 0a20 2020  les.items():.   
+0000a970: 2020 2020 2020 2020 2069 6620 6b20 696e           if k in
+0000a980: 2069 6e64 6578 5f76 6172 733a 0a20 2020   index_vars:.   
+0000a990: 2020 2020 2020 2020 2020 2020 2076 6172               var
+0000a9a0: 6961 626c 6573 5b6b 5d20 3d20 696e 6465  iables[k] = inde
+0000a9b0: 785f 7661 7273 5b6b 5d0a 2020 2020 2020  x_vars[k].      
+0000a9c0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000a9d0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+0000a9e0: 6162 6c65 735b 6b5d 203d 2076 2e5f 636f  ables[k] = v._co
+0000a9f0: 7079 2864 6565 703d 6465 6570 2c20 6461  py(deep=deep, da
+0000aa00: 7461 3d64 6174 612e 6765 7428 6b29 2c20  ta=data.get(k), 
+0000aa10: 6d65 6d6f 3d6d 656d 6f29 0a0a 2020 2020  memo=memo)..    
+0000aa20: 2020 2020 6174 7472 7320 3d20 636f 7079      attrs = copy
+0000aa30: 2e64 6565 7063 6f70 7928 7365 6c66 2e5f  .deepcopy(self._
+0000aa40: 6174 7472 732c 206d 656d 6f29 2069 6620  attrs, memo) if 
+0000aa50: 6465 6570 2065 6c73 6520 636f 7079 2e63  deep else copy.c
+0000aa60: 6f70 7928 7365 6c66 2e5f 6174 7472 7329  opy(self._attrs)
+0000aa70: 0a20 2020 2020 2020 2065 6e63 6f64 696e  .        encodin
+0000aa80: 6720 3d20 280a 2020 2020 2020 2020 2020  g = (.          
+0000aa90: 2020 636f 7079 2e64 6565 7063 6f70 7928    copy.deepcopy(
+0000aaa0: 7365 6c66 2e5f 656e 636f 6469 6e67 2c20  self._encoding, 
+0000aab0: 6d65 6d6f 2920 6966 2064 6565 7020 656c  memo) if deep el
+0000aac0: 7365 2063 6f70 792e 636f 7079 2873 656c  se copy.copy(sel
+0000aad0: 662e 5f65 6e63 6f64 696e 6729 0a20 2020  f._encoding).   
+0000aae0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+0000aaf0: 7265 7475 726e 2073 656c 662e 5f72 6570  return self._rep
+0000ab00: 6c61 6365 2876 6172 6961 626c 6573 2c20  lace(variables, 
+0000ab10: 696e 6465 7865 733d 696e 6465 7865 732c  indexes=indexes,
+0000ab20: 2061 7474 7273 3d61 7474 7273 2c20 656e   attrs=attrs, en
+0000ab30: 636f 6469 6e67 3d65 6e63 6f64 696e 6729  coding=encoding)
+0000ab40: 0a0a 2020 2020 6465 6620 5f5f 636f 7079  ..    def __copy
+0000ab50: 5f5f 2873 656c 663a 2054 5f44 6174 6173  __(self: T_Datas
+0000ab60: 6574 2920 2d3e 2054 5f44 6174 6173 6574  et) -> T_Dataset
+0000ab70: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000ab80: 2073 656c 662e 5f63 6f70 7928 6465 6570   self._copy(deep
+0000ab90: 3d46 616c 7365 290a 0a20 2020 2064 6566  =False)..    def
+0000aba0: 205f 5f64 6565 7063 6f70 795f 5f28 7365   __deepcopy__(se
+0000abb0: 6c66 3a20 545f 4461 7461 7365 742c 206d  lf: T_Dataset, m
+0000abc0: 656d 6f3a 2064 6963 745b 696e 742c 2041  emo: dict[int, A
+0000abd0: 6e79 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ny] | None = Non
+0000abe0: 6529 202d 3e20 545f 4461 7461 7365 743a  e) -> T_Dataset:
+0000abf0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0000ac00: 7365 6c66 2e5f 636f 7079 2864 6565 703d  self._copy(deep=
+0000ac10: 5472 7565 2c20 6d65 6d6f 3d6d 656d 6f29  True, memo=memo)
+0000ac20: 0a0a 2020 2020 6465 6620 6173 5f6e 756d  ..    def as_num
+0000ac30: 7079 2873 656c 663a 2054 5f44 6174 6173  py(self: T_Datas
+0000ac40: 6574 2920 2d3e 2054 5f44 6174 6173 6574  et) -> T_Dataset
+0000ac50: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000ac60: 2020 2020 2020 436f 6572 6365 7320 7772        Coerces wr
+0000ac70: 6170 7065 6420 6461 7461 2061 6e64 2063  apped data and c
+0000ac80: 6f6f 7264 696e 6174 6573 2069 6e74 6f20  oordinates into 
+0000ac90: 6e75 6d70 7920 6172 7261 7973 2c20 7265  numpy arrays, re
+0000aca0: 7475 726e 696e 6720 6120 4461 7461 7365  turning a Datase
+0000acb0: 742e 0a0a 2020 2020 2020 2020 5365 6520  t...        See 
+0000acc0: 616c 736f 0a20 2020 2020 2020 202d 2d2d  also.        ---
+0000acd0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
+0000ace0: 7461 4172 7261 792e 6173 5f6e 756d 7079  taArray.as_numpy
+0000acf0: 0a20 2020 2020 2020 2044 6174 6141 7272  .        DataArr
+0000ad00: 6179 2e74 6f5f 6e75 6d70 7920 3a20 5265  ay.to_numpy : Re
+0000ad10: 7475 726e 7320 6f6e 6c79 2074 6865 2064  turns only the d
+0000ad20: 6174 6120 6173 2061 206e 756d 7079 2e6e  ata as a numpy.n
+0000ad30: 6461 7272 6179 206f 626a 6563 742e 0a20  darray object.. 
+0000ad40: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000ad50: 2020 206e 756d 7079 5f76 6172 6961 626c     numpy_variabl
+0000ad60: 6573 203d 207b 6b3a 2076 2e61 735f 6e75  es = {k: v.as_nu
+0000ad70: 6d70 7928 2920 666f 7220 6b2c 2076 2069  mpy() for k, v i
+0000ad80: 6e20 7365 6c66 2e76 6172 6961 626c 6573  n self.variables
+0000ad90: 2e69 7465 6d73 2829 7d0a 2020 2020 2020  .items()}.      
+0000ada0: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
+0000adb0: 6570 6c61 6365 2876 6172 6961 626c 6573  eplace(variables
+0000adc0: 3d6e 756d 7079 5f76 6172 6961 626c 6573  =numpy_variables
+0000add0: 290a 0a20 2020 2064 6566 205f 636f 7079  )..    def _copy
+0000ade0: 5f6c 6973 7465 6428 7365 6c66 3a20 545f  _listed(self: T_
+0000adf0: 4461 7461 7365 742c 206e 616d 6573 3a20  Dataset, names: 
+0000ae00: 4974 6572 6162 6c65 5b48 6173 6861 626c  Iterable[Hashabl
+0000ae10: 655d 2920 2d3e 2054 5f44 6174 6173 6574  e]) -> T_Dataset
+0000ae20: 3a0a 2020 2020 2020 2020 2222 2243 7265  :.        """Cre
+0000ae30: 6174 6520 6120 6e65 7720 4461 7461 7365  ate a new Datase
+0000ae40: 7420 7769 7468 2074 6865 206c 6973 7465  t with the liste
+0000ae50: 6420 7661 7269 6162 6c65 7320 6672 6f6d  d variables from
+0000ae60: 2074 6869 7320 6461 7461 7365 7420 616e   this dataset an
+0000ae70: 640a 2020 2020 2020 2020 7468 6520 616c  d.        the al
+0000ae80: 6c20 7265 6c65 7661 6e74 2063 6f6f 7264  l relevant coord
+0000ae90: 696e 6174 6573 2e20 536b 6970 7320 616c  inates. Skips al
+0000aea0: 6c20 7661 6c69 6461 7469 6f6e 2e0a 2020  l validation..  
+0000aeb0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000aec0: 2020 7661 7269 6162 6c65 733a 2064 6963    variables: dic
+0000aed0: 745b 4861 7368 6162 6c65 2c20 5661 7269  t[Hashable, Vari
+0000aee0: 6162 6c65 5d20 3d20 7b7d 0a20 2020 2020  able] = {}.     
+0000aef0: 2020 2063 6f6f 7264 5f6e 616d 6573 203d     coord_names =
+0000af00: 2073 6574 2829 0a20 2020 2020 2020 2069   set().        i
+0000af10: 6e64 6578 6573 3a20 6469 6374 5b48 6173  ndexes: dict[Has
+0000af20: 6861 626c 652c 2049 6e64 6578 5d20 3d20  hable, Index] = 
+0000af30: 7b7d 0a0a 2020 2020 2020 2020 666f 7220  {}..        for 
+0000af40: 6e61 6d65 2069 6e20 6e61 6d65 733a 0a20  name in names:. 
+0000af50: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+0000af60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000af70: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
+0000af80: 3d20 7365 6c66 2e5f 7661 7269 6162 6c65  = self._variable
+0000af90: 735b 6e61 6d65 5d0a 2020 2020 2020 2020  s[name].        
+0000afa0: 2020 2020 6578 6365 7074 204b 6579 4572      except KeyEr
+0000afb0: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+0000afc0: 2020 2020 2072 6566 5f6e 616d 652c 2076       ref_name, v
+0000afd0: 6172 5f6e 616d 652c 2076 6172 203d 205f  ar_name, var = _
+0000afe0: 6765 745f 7669 7274 7561 6c5f 7661 7269  get_virtual_vari
+0000aff0: 6162 6c65 280a 2020 2020 2020 2020 2020  able(.          
+0000b000: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0000b010: 7661 7269 6162 6c65 732c 206e 616d 652c  variables, name,
+0000b020: 2073 656c 662e 6469 6d73 0a20 2020 2020   self.dims.     
+0000b030: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000b040: 2020 2020 2020 2020 2020 2020 2076 6172               var
+0000b050: 6961 626c 6573 5b76 6172 5f6e 616d 655d  iables[var_name]
+0000b060: 203d 2076 6172 0a20 2020 2020 2020 2020   = var.         
+0000b070: 2020 2020 2020 2069 6620 7265 665f 6e61         if ref_na
+0000b080: 6d65 2069 6e20 7365 6c66 2e5f 636f 6f72  me in self._coor
+0000b090: 645f 6e61 6d65 7320 6f72 2072 6566 5f6e  d_names or ref_n
+0000b0a0: 616d 6520 696e 2073 656c 662e 6469 6d73  ame in self.dims
+0000b0b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000b0c0: 2020 2020 2020 636f 6f72 645f 6e61 6d65        coord_name
+0000b0d0: 732e 6164 6428 7661 725f 6e61 6d65 290a  s.add(var_name).
+0000b0e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b0f0: 6966 2028 7661 725f 6e61 6d65 2c29 203d  if (var_name,) =
+0000b100: 3d20 7661 722e 6469 6d73 3a0a 2020 2020  = var.dims:.    
+0000b110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b120: 696e 6465 782c 2069 6e64 6578 5f76 6172  index, index_var
+0000b130: 7320 3d20 6372 6561 7465 5f64 6566 6175  s = create_defau
+0000b140: 6c74 5f69 6e64 6578 5f69 6d70 6c69 6369  lt_index_implici
+0000b150: 7428 7661 722c 206e 616d 6573 290a 2020  t(var, names).  
+0000b160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b170: 2020 696e 6465 7865 732e 7570 6461 7465    indexes.update
+0000b180: 287b 6b3a 2069 6e64 6578 2066 6f72 206b  ({k: index for k
+0000b190: 2069 6e20 696e 6465 785f 7661 7273 7d29   in index_vars})
+0000b1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b1b0: 2020 2020 2076 6172 6961 626c 6573 2e75       variables.u
+0000b1c0: 7064 6174 6528 696e 6465 785f 7661 7273  pdate(index_vars
+0000b1d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0000b1e0: 2020 2020 2020 636f 6f72 645f 6e61 6d65        coord_name
+0000b1f0: 732e 7570 6461 7465 2869 6e64 6578 5f76  s.update(index_v
+0000b200: 6172 7329 0a0a 2020 2020 2020 2020 6e65  ars)..        ne
+0000b210: 6564 6564 5f64 696d 733a 204f 7264 6572  eded_dims: Order
+0000b220: 6564 5365 745b 4861 7368 6162 6c65 5d20  edSet[Hashable] 
+0000b230: 3d20 4f72 6465 7265 6453 6574 2829 0a20  = OrderedSet(). 
+0000b240: 2020 2020 2020 2066 6f72 2076 2069 6e20         for v in 
+0000b250: 7661 7269 6162 6c65 732e 7661 6c75 6573  variables.values
+0000b260: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0000b270: 6e65 6564 6564 5f64 696d 732e 7570 6461  needed_dims.upda
+0000b280: 7465 2876 2e64 696d 7329 0a0a 2020 2020  te(v.dims)..    
+0000b290: 2020 2020 6469 6d73 203d 207b 6b3a 2073      dims = {k: s
+0000b2a0: 656c 662e 6469 6d73 5b6b 5d20 666f 7220  elf.dims[k] for 
+0000b2b0: 6b20 696e 206e 6565 6465 645f 6469 6d73  k in needed_dims
+0000b2c0: 7d0a 0a20 2020 2020 2020 2023 2070 7265  }..        # pre
+0000b2d0: 7365 7276 6573 206f 7264 6572 696e 6720  serves ordering 
+0000b2e0: 6f66 2063 6f6f 7264 696e 6174 6573 0a20  of coordinates. 
+0000b2f0: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
+0000b300: 7365 6c66 2e5f 7661 7269 6162 6c65 733a  self._variables:
+0000b310: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000b320: 6b20 6e6f 7420 696e 2073 656c 662e 5f63  k not in self._c
+0000b330: 6f6f 7264 5f6e 616d 6573 3a0a 2020 2020  oord_names:.    
+0000b340: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+0000b350: 696e 7565 0a0a 2020 2020 2020 2020 2020  inue..          
+0000b360: 2020 6966 2073 6574 2873 656c 662e 7661    if set(self.va
+0000b370: 7269 6162 6c65 735b 6b5d 2e64 696d 7329  riables[k].dims)
+0000b380: 203c 3d20 6e65 6564 6564 5f64 696d 733a   <= needed_dims:
+0000b390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b3a0: 2076 6172 6961 626c 6573 5b6b 5d20 3d20   variables[k] = 
+0000b3b0: 7365 6c66 2e5f 7661 7269 6162 6c65 735b  self._variables[
+0000b3c0: 6b5d 0a20 2020 2020 2020 2020 2020 2020  k].             
+0000b3d0: 2020 2063 6f6f 7264 5f6e 616d 6573 2e61     coord_names.a
+0000b3e0: 6464 286b 290a 0a20 2020 2020 2020 2069  dd(k)..        i
+0000b3f0: 6e64 6578 6573 2e75 7064 6174 6528 6669  ndexes.update(fi
+0000b400: 6c74 6572 5f69 6e64 6578 6573 5f66 726f  lter_indexes_fro
+0000b410: 6d5f 636f 6f72 6473 2873 656c 662e 5f69  m_coords(self._i
+0000b420: 6e64 6578 6573 2c20 636f 6f72 645f 6e61  ndexes, coord_na
+0000b430: 6d65 7329 290a 0a20 2020 2020 2020 2072  mes))..        r
+0000b440: 6574 7572 6e20 7365 6c66 2e5f 7265 706c  eturn self._repl
+0000b450: 6163 6528 7661 7269 6162 6c65 732c 2063  ace(variables, c
+0000b460: 6f6f 7264 5f6e 616d 6573 2c20 6469 6d73  oord_names, dims
+0000b470: 2c20 696e 6465 7865 733d 696e 6465 7865  , indexes=indexe
+0000b480: 7329 0a0a 2020 2020 6465 6620 5f63 6f6e  s)..    def _con
+0000b490: 7374 7275 6374 5f64 6174 6161 7272 6179  struct_dataarray
+0000b4a0: 2873 656c 662c 206e 616d 653a 2048 6173  (self, name: Has
+0000b4b0: 6861 626c 6529 202d 3e20 4461 7461 4172  hable) -> DataAr
+0000b4c0: 7261 793a 0a20 2020 2020 2020 2022 2222  ray:.        """
+0000b4d0: 436f 6e73 7472 7563 7420 6120 4461 7461  Construct a Data
+0000b4e0: 4172 7261 7920 6279 2069 6e64 6578 696e  Array by indexin
+0000b4f0: 6720 7468 6973 2064 6174 6173 6574 2222  g this dataset""
+0000b500: 220a 2020 2020 2020 2020 6672 6f6d 2078  ".        from x
+0000b510: 6172 7261 792e 636f 7265 2e64 6174 6161  array.core.dataa
+0000b520: 7272 6179 2069 6d70 6f72 7420 4461 7461  rray import Data
+0000b530: 4172 7261 790a 0a20 2020 2020 2020 2074  Array..        t
+0000b540: 7279 3a0a 2020 2020 2020 2020 2020 2020  ry:.            
+0000b550: 7661 7269 6162 6c65 203d 2073 656c 662e  variable = self.
+0000b560: 5f76 6172 6961 626c 6573 5b6e 616d 655d  _variables[name]
+0000b570: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0000b580: 4b65 7945 7272 6f72 3a0a 2020 2020 2020  KeyError:.      
+0000b590: 2020 2020 2020 5f2c 206e 616d 652c 2076        _, name, v
+0000b5a0: 6172 6961 626c 6520 3d20 5f67 6574 5f76  ariable = _get_v
+0000b5b0: 6972 7475 616c 5f76 6172 6961 626c 6528  irtual_variable(
+0000b5c0: 7365 6c66 2e5f 7661 7269 6162 6c65 732c  self._variables,
+0000b5d0: 206e 616d 652c 2073 656c 662e 6469 6d73   name, self.dims
+0000b5e0: 290a 0a20 2020 2020 2020 206e 6565 6465  )..        neede
+0000b5f0: 645f 6469 6d73 203d 2073 6574 2876 6172  d_dims = set(var
+0000b600: 6961 626c 652e 6469 6d73 290a 0a20 2020  iable.dims)..   
+0000b610: 2020 2020 2063 6f6f 7264 733a 2064 6963       coords: dic
+0000b620: 745b 4861 7368 6162 6c65 2c20 5661 7269  t[Hashable, Vari
+0000b630: 6162 6c65 5d20 3d20 7b7d 0a20 2020 2020  able] = {}.     
+0000b640: 2020 2023 2070 7265 7365 7276 6520 6f72     # preserve or
+0000b650: 6465 7269 6e67 0a20 2020 2020 2020 2066  dering.        f
+0000b660: 6f72 206b 2069 6e20 7365 6c66 2e5f 7661  or k in self._va
+0000b670: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
+0000b680: 2020 2020 2069 6620 6b20 696e 2073 656c       if k in sel
+0000b690: 662e 5f63 6f6f 7264 5f6e 616d 6573 2061  f._coord_names a
+0000b6a0: 6e64 2073 6574 2873 656c 662e 5f76 6172  nd set(self._var
+0000b6b0: 6961 626c 6573 5b6b 5d2e 6469 6d73 2920  iables[k].dims) 
+0000b6c0: 3c3d 206e 6565 6465 645f 6469 6d73 3a0a  <= needed_dims:.
+0000b6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b6e0: 636f 6f72 6473 5b6b 5d20 3d20 7365 6c66  coords[k] = self
+0000b6f0: 2e5f 7661 7269 6162 6c65 735b 6b5d 0a0a  ._variables[k]..
+0000b700: 2020 2020 2020 2020 696e 6465 7865 7320          indexes 
+0000b710: 3d20 6669 6c74 6572 5f69 6e64 6578 6573  = filter_indexes
+0000b720: 5f66 726f 6d5f 636f 6f72 6473 2873 656c  _from_coords(sel
+0000b730: 662e 5f69 6e64 6578 6573 2c20 7365 7428  f._indexes, set(
+0000b740: 636f 6f72 6473 2929 0a0a 2020 2020 2020  coords))..      
+0000b750: 2020 7265 7475 726e 2044 6174 6141 7272    return DataArr
+0000b760: 6179 2876 6172 6961 626c 652c 2063 6f6f  ay(variable, coo
+0000b770: 7264 732c 206e 616d 653d 6e61 6d65 2c20  rds, name=name, 
+0000b780: 696e 6465 7865 733d 696e 6465 7865 732c  indexes=indexes,
+0000b790: 2066 6173 7470 6174 683d 5472 7565 290a   fastpath=True).
+0000b7a0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000b7b0: 2020 2064 6566 205f 6174 7472 5f73 6f75     def _attr_sou
+0000b7c0: 7263 6573 2873 656c 6629 202d 3e20 4974  rces(self) -> It
+0000b7d0: 6572 6162 6c65 5b4d 6170 7069 6e67 5b48  erable[Mapping[H
+0000b7e0: 6173 6861 626c 652c 2041 6e79 5d5d 3a0a  ashable, Any]]:.
+0000b7f0: 2020 2020 2020 2020 2222 2250 6c61 6365          """Place
+0000b800: 7320 746f 206c 6f6f 6b2d 7570 2069 7465  s to look-up ite
+0000b810: 6d73 2066 6f72 2061 7474 7269 6275 7465  ms for attribute
+0000b820: 2d73 7479 6c65 2061 6363 6573 7322 2222  -style access"""
+0000b830: 0a20 2020 2020 2020 2079 6965 6c64 2066  .        yield f
+0000b840: 726f 6d20 7365 6c66 2e5f 6974 656d 5f73  rom self._item_s
+0000b850: 6f75 7263 6573 0a20 2020 2020 2020 2079  ources.        y
+0000b860: 6965 6c64 2073 656c 662e 6174 7472 730a  ield self.attrs.
+0000b870: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000b880: 2020 2064 6566 205f 6974 656d 5f73 6f75     def _item_sou
+0000b890: 7263 6573 2873 656c 6629 202d 3e20 4974  rces(self) -> It
+0000b8a0: 6572 6162 6c65 5b4d 6170 7069 6e67 5b48  erable[Mapping[H
+0000b8b0: 6173 6861 626c 652c 2041 6e79 5d5d 3a0a  ashable, Any]]:.
+0000b8c0: 2020 2020 2020 2020 2222 2250 6c61 6365          """Place
+0000b8d0: 7320 746f 206c 6f6f 6b2d 7570 2069 7465  s to look-up ite
+0000b8e0: 6d73 2066 6f72 206b 6579 2d63 6f6d 706c  ms for key-compl
+0000b8f0: 6574 696f 6e22 2222 0a20 2020 2020 2020  etion""".       
+0000b900: 2079 6965 6c64 2073 656c 662e 6461 7461   yield self.data
+0000b910: 5f76 6172 730a 2020 2020 2020 2020 7969  _vars.        yi
+0000b920: 656c 6420 4879 6272 6964 4d61 7070 696e  eld HybridMappin
+0000b930: 6750 726f 7879 286b 6579 733d 7365 6c66  gProxy(keys=self
+0000b940: 2e5f 636f 6f72 645f 6e61 6d65 732c 206d  ._coord_names, m
+0000b950: 6170 7069 6e67 3d73 656c 662e 636f 6f72  apping=self.coor
+0000b960: 6473 290a 0a20 2020 2020 2020 2023 2076  ds)..        # v
+0000b970: 6972 7475 616c 2063 6f6f 7264 696e 6174  irtual coordinat
+0000b980: 6573 0a20 2020 2020 2020 2079 6965 6c64  es.        yield
+0000b990: 2048 7962 7269 644d 6170 7069 6e67 5072   HybridMappingPr
+0000b9a0: 6f78 7928 6b65 7973 3d73 656c 662e 6469  oxy(keys=self.di
+0000b9b0: 6d73 2c20 6d61 7070 696e 673d 7365 6c66  ms, mapping=self
+0000b9c0: 290a 0a20 2020 2064 6566 205f 5f63 6f6e  )..    def __con
+0000b9d0: 7461 696e 735f 5f28 7365 6c66 2c20 6b65  tains__(self, ke
+0000b9e0: 793a 206f 626a 6563 7429 202d 3e20 626f  y: object) -> bo
+0000b9f0: 6f6c 3a0a 2020 2020 2020 2020 2222 2254  ol:.        """T
+0000ba00: 6865 2027 696e 2720 6f70 6572 6174 6f72  he 'in' operator
+0000ba10: 2077 696c 6c20 7265 7475 726e 2074 7275   will return tru
+0000ba20: 6520 6f72 2066 616c 7365 2064 6570 656e  e or false depen
+0000ba30: 6469 6e67 206f 6e20 7768 6574 6865 720a  ding on whether.
+0000ba40: 2020 2020 2020 2020 276b 6579 2720 6973          'key' is
+0000ba50: 2061 6e20 6172 7261 7920 696e 2074 6865   an array in the
+0000ba60: 2064 6174 6173 6574 206f 7220 6e6f 742e   dataset or not.
+0000ba70: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0000ba80: 2020 2020 2072 6574 7572 6e20 6b65 7920       return key 
+0000ba90: 696e 2073 656c 662e 5f76 6172 6961 626c  in self._variabl
+0000baa0: 6573 0a0a 2020 2020 6465 6620 5f5f 6c65  es..    def __le
+0000bab0: 6e5f 5f28 7365 6c66 2920 2d3e 2069 6e74  n__(self) -> int
+0000bac0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+0000bad0: 206c 656e 2873 656c 662e 6461 7461 5f76   len(self.data_v
+0000bae0: 6172 7329 0a0a 2020 2020 6465 6620 5f5f  ars)..    def __
+0000baf0: 626f 6f6c 5f5f 2873 656c 6629 202d 3e20  bool__(self) -> 
+0000bb00: 626f 6f6c 3a0a 2020 2020 2020 2020 7265  bool:.        re
+0000bb10: 7475 726e 2062 6f6f 6c28 7365 6c66 2e64  turn bool(self.d
+0000bb20: 6174 615f 7661 7273 290a 0a20 2020 2064  ata_vars)..    d
+0000bb30: 6566 205f 5f69 7465 725f 5f28 7365 6c66  ef __iter__(self
+0000bb40: 2920 2d3e 2049 7465 7261 746f 725b 4861  ) -> Iterator[Ha
+0000bb50: 7368 6162 6c65 5d3a 0a20 2020 2020 2020  shable]:.       
+0000bb60: 2072 6574 7572 6e20 6974 6572 2873 656c   return iter(sel
+0000bb70: 662e 6461 7461 5f76 6172 7329 0a0a 2020  f.data_vars)..  
+0000bb80: 2020 6465 6620 5f5f 6172 7261 795f 5f28    def __array__(
+0000bb90: 7365 6c66 2c20 6474 7970 653d 4e6f 6e65  self, dtype=None
+0000bba0: 293a 0a20 2020 2020 2020 2072 6169 7365  ):.        raise
+0000bbb0: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
+0000bbc0: 2020 2020 2020 2020 2263 616e 6e6f 7420          "cannot 
+0000bbd0: 6469 7265 6374 6c79 2063 6f6e 7665 7274  directly convert
+0000bbe0: 2061 6e20 7861 7272 6179 2e44 6174 6173   an xarray.Datas
+0000bbf0: 6574 2069 6e74 6f20 6120 220a 2020 2020  et into a ".    
+0000bc00: 2020 2020 2020 2020 226e 756d 7079 2061          "numpy a
+0000bc10: 7272 6179 2e20 496e 7374 6561 642c 2063  rray. Instead, c
+0000bc20: 7265 6174 6520 616e 2078 6172 7261 792e  reate an xarray.
+0000bc30: 4461 7461 4172 7261 7920 220a 2020 2020  DataArray ".    
+0000bc40: 2020 2020 2020 2020 2266 6972 7374 2c20          "first, 
+0000bc50: 6569 7468 6572 2077 6974 6820 696e 6465  either with inde
+0000bc60: 7869 6e67 206f 6e20 7468 6520 4461 7461  xing on the Data
+0000bc70: 7365 7420 6f72 2062 7920 220a 2020 2020  set or by ".    
+0000bc80: 2020 2020 2020 2020 2269 6e76 6f6b 696e          "invokin
+0000bc90: 6720 7468 6520 6074 6f5f 6172 7261 7928  g the `to_array(
+0000bca0: 2960 206d 6574 686f 642e 220a 2020 2020  )` method.".    
+0000bcb0: 2020 2020 290a 0a20 2020 2040 7072 6f70      )..    @prop
+0000bcc0: 6572 7479 0a20 2020 2064 6566 206e 6279  erty.    def nby
+0000bcd0: 7465 7328 7365 6c66 2920 2d3e 2069 6e74  tes(self) -> int
+0000bce0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0000bcf0: 2020 2020 2020 546f 7461 6c20 6279 7465        Total byte
+0000bd00: 7320 636f 6e73 756d 6564 2062 7920 7468  s consumed by th
+0000bd10: 6520 6461 7461 2061 7272 6179 7320 6f66  e data arrays of
+0000bd20: 2061 6c6c 2076 6172 6961 626c 6573 2069   all variables i
+0000bd30: 6e20 7468 6973 2064 6174 6173 6574 2e0a  n this dataset..
+0000bd40: 0a20 2020 2020 2020 2049 6620 7468 6520  .        If the 
+0000bd50: 6261 636b 656e 6420 6172 7261 7920 666f  backend array fo
+0000bd60: 7220 616e 7920 7661 7269 6162 6c65 2064  r any variable d
+0000bd70: 6f65 7320 6e6f 7420 696e 636c 7564 6520  oes not include 
+0000bd80: 6060 6e62 7974 6573 6060 2c20 6573 7469  ``nbytes``, esti
+0000bd90: 6d61 7465 730a 2020 2020 2020 2020 7468  mates.        th
+0000bda0: 6520 746f 7461 6c20 6279 7465 7320 666f  e total bytes fo
+0000bdb0: 7220 7468 6174 2061 7272 6179 2062 6173  r that array bas
+0000bdc0: 6564 206f 6e20 7468 6520 6060 7369 7a65  ed on the ``size
+0000bdd0: 6060 2061 6e64 2060 6064 7479 7065 6060  `` and ``dtype``
+0000bde0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0000bdf0: 2020 2020 2020 7265 7475 726e 2073 756d        return sum
+0000be00: 2876 2e6e 6279 7465 7320 666f 7220 7620  (v.nbytes for v 
+0000be10: 696e 2073 656c 662e 7661 7269 6162 6c65  in self.variable
+0000be20: 732e 7661 6c75 6573 2829 290a 0a20 2020  s.values())..   
+0000be30: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+0000be40: 6566 206c 6f63 2873 656c 663a 2054 5f44  ef loc(self: T_D
+0000be50: 6174 6173 6574 2920 2d3e 205f 4c6f 6349  ataset) -> _LocI
+0000be60: 6e64 6578 6572 5b54 5f44 6174 6173 6574  ndexer[T_Dataset
+0000be70: 5d3a 0a20 2020 2020 2020 2022 2222 4174  ]:.        """At
+0000be80: 7472 6962 7574 6520 666f 7220 6c6f 6361  tribute for loca
+0000be90: 7469 6f6e 2062 6173 6564 2069 6e64 6578  tion based index
+0000bea0: 696e 672e 204f 6e6c 7920 7375 7070 6f72  ing. Only suppor
+0000beb0: 7473 205f 5f67 6574 6974 656d 5f5f 2c0a  ts __getitem__,.
+0000bec0: 2020 2020 2020 2020 616e 6420 6f6e 6c79          and only
+0000bed0: 2077 6865 6e20 7468 6520 6b65 7920 6973   when the key is
+0000bee0: 2061 2064 6963 7420 6f66 2074 6865 2066   a dict of the f
+0000bef0: 6f72 6d20 7b64 696d 3a20 6c61 6265 6c73  orm {dim: labels
+0000bf00: 7d2e 0a20 2020 2020 2020 2022 2222 0a20  }..        """. 
+0000bf10: 2020 2020 2020 2072 6574 7572 6e20 5f4c         return _L
+0000bf20: 6f63 496e 6465 7865 7228 7365 6c66 290a  ocIndexer(self).
+0000bf30: 0a20 2020 2040 6f76 6572 6c6f 6164 0a20  .    @overload. 
+0000bf40: 2020 2064 6566 205f 5f67 6574 6974 656d     def __getitem
+0000bf50: 5f5f 2873 656c 662c 206b 6579 3a20 4861  __(self, key: Ha
+0000bf60: 7368 6162 6c65 2920 2d3e 2044 6174 6141  shable) -> DataA
+0000bf70: 7272 6179 3a0a 2020 2020 2020 2020 2e2e  rray:.        ..
+0000bf80: 2e0a 0a20 2020 2023 204d 6170 7069 6e67  ...    # Mapping
+0000bf90: 2069 7320 4974 6572 6162 6c65 0a20 2020   is Iterable.   
+0000bfa0: 2040 6f76 6572 6c6f 6164 0a20 2020 2064   @overload.    d
+0000bfb0: 6566 205f 5f67 6574 6974 656d 5f5f 2873  ef __getitem__(s
+0000bfc0: 656c 663a 2054 5f44 6174 6173 6574 2c20  elf: T_Dataset, 
+0000bfd0: 6b65 793a 2049 7465 7261 626c 655b 4861  key: Iterable[Ha
+0000bfe0: 7368 6162 6c65 5d29 202d 3e20 545f 4461  shable]) -> T_Da
+0000bff0: 7461 7365 743a 0a20 2020 2020 2020 202e  taset:.        .
+0000c000: 2e2e 0a0a 2020 2020 6465 6620 5f5f 6765  ....    def __ge
+0000c010: 7469 7465 6d5f 5f28 0a20 2020 2020 2020  titem__(.       
+0000c020: 2073 656c 663a 2054 5f44 6174 6173 6574   self: T_Dataset
+0000c030: 2c20 6b65 793a 204d 6170 7069 6e67 5b41  , key: Mapping[A
+0000c040: 6e79 2c20 416e 795d 207c 2048 6173 6861  ny, Any] | Hasha
+0000c050: 626c 6520 7c20 4974 6572 6162 6c65 5b48  ble | Iterable[H
+0000c060: 6173 6861 626c 655d 0a20 2020 2029 202d  ashable].    ) -
+0000c070: 3e20 545f 4461 7461 7365 7420 7c20 4461  > T_Dataset | Da
+0000c080: 7461 4172 7261 793a 0a20 2020 2020 2020  taArray:.       
+0000c090: 2022 2222 4163 6365 7373 2076 6172 6961   """Access varia
+0000c0a0: 626c 6573 206f 7220 636f 6f72 6469 6e61  bles or coordina
+0000c0b0: 7465 7320 6f66 2074 6869 7320 6461 7461  tes of this data
+0000c0c0: 7365 7420 6173 2061 0a20 2020 2020 2020  set as a.       
+0000c0d0: 203a 7079 3a63 6c61 7373 3a60 7e78 6172   :py:class:`~xar
+0000c0e0: 7261 792e 4461 7461 4172 7261 7960 206f  ray.DataArray` o
+0000c0f0: 7220 6120 7375 6273 6574 206f 6620 7661  r a subset of va
+0000c100: 7269 6162 6c65 7320 6f72 2061 2069 6e64  riables or a ind
+0000c110: 6578 6564 2064 6174 6173 6574 2e0a 0a20  exed dataset... 
+0000c120: 2020 2020 2020 2049 6e64 6578 696e 6720         Indexing 
+0000c130: 7769 7468 2061 206c 6973 7420 6f66 206e  with a list of n
+0000c140: 616d 6573 2077 696c 6c20 7265 7475 726e  ames will return
+0000c150: 2061 206e 6577 2060 6044 6174 6173 6574   a new ``Dataset
+0000c160: 6060 206f 626a 6563 742e 0a20 2020 2020  `` object..     
+0000c170: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0000c180: 6620 7574 696c 732e 6973 5f64 6963 745f  f utils.is_dict_
+0000c190: 6c69 6b65 286b 6579 293a 0a20 2020 2020  like(key):.     
+0000c1a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0000c1b0: 6c66 2e69 7365 6c28 2a2a 6b65 7929 0a20  lf.isel(**key). 
+0000c1c0: 2020 2020 2020 2069 6620 7574 696c 732e         if utils.
+0000c1d0: 6861 7368 6162 6c65 286b 6579 293a 0a20  hashable(key):. 
+0000c1e0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000c1f0: 6e20 7365 6c66 2e5f 636f 6e73 7472 7563  n self._construc
+0000c200: 745f 6461 7461 6172 7261 7928 6b65 7929  t_dataarray(key)
+0000c210: 0a20 2020 2020 2020 2069 6620 7574 696c  .        if util
+0000c220: 732e 6974 6572 6162 6c65 5f6f 665f 6861  s.iterable_of_ha
+0000c230: 7368 6162 6c65 286b 6579 293a 0a20 2020  shable(key):.   
+0000c240: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000c250: 7365 6c66 2e5f 636f 7079 5f6c 6973 7465  self._copy_liste
+0000c260: 6428 6b65 7929 0a20 2020 2020 2020 2072  d(key).        r
+0000c270: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000c280: 6622 556e 7375 7070 6f72 7465 6420 6b65  f"Unsupported ke
+0000c290: 792d 7479 7065 207b 7479 7065 286b 6579  y-type {type(key
+0000c2a0: 297d 2229 0a0a 2020 2020 6465 6620 5f5f  )}")..    def __
+0000c2b0: 7365 7469 7465 6d5f 5f28 0a20 2020 2020  setitem__(.     
+0000c2c0: 2020 2073 656c 662c 206b 6579 3a20 4861     self, key: Ha
+0000c2d0: 7368 6162 6c65 207c 2049 7465 7261 626c  shable | Iterabl
+0000c2e0: 655b 4861 7368 6162 6c65 5d20 7c20 4d61  e[Hashable] | Ma
+0000c2f0: 7070 696e 672c 2076 616c 7565 3a20 416e  pping, value: An
+0000c300: 790a 2020 2020 2920 2d3e 204e 6f6e 653a  y.    ) -> None:
+0000c310: 0a20 2020 2020 2020 2022 2222 4164 6420  .        """Add 
+0000c320: 616e 2061 7272 6179 2074 6f20 7468 6973  an array to this
+0000c330: 2064 6174 6173 6574 2e0a 2020 2020 2020   dataset..      
+0000c340: 2020 4d75 6c74 6970 6c65 2061 7272 6179    Multiple array
+0000c350: 7320 6361 6e20 6265 2061 6464 6564 2061  s can be added a
+0000c360: 7420 7468 6520 7361 6d65 2074 696d 652c  t the same time,
+0000c370: 2069 6e20 7768 6963 6820 6361 7365 2065   in which case e
+0000c380: 6163 6820 6f66 0a20 2020 2020 2020 2074  ach of.        t
+0000c390: 6865 2066 6f6c 6c6f 7769 6e67 206f 7065  he following ope
+0000c3a0: 7261 7469 6f6e 7320 6973 2061 7070 6c69  rations is appli
+0000c3b0: 6564 2074 6f20 7468 6520 7265 7370 6563  ed to the respec
+0000c3c0: 7469 7665 2076 616c 7565 2e0a 0a20 2020  tive value...   
+0000c3d0: 2020 2020 2049 6620 6b65 7920 6973 2064       If key is d
+0000c3e0: 6963 742d 6c69 6b65 2c20 7570 6461 7465  ict-like, update
+0000c3f0: 2061 6c6c 2076 6172 6961 626c 6573 2069   all variables i
+0000c400: 6e20 7468 6520 6461 7461 7365 740a 2020  n the dataset.  
+0000c410: 2020 2020 2020 6f6e 6520 6279 206f 6e65        one by one
+0000c420: 2077 6974 6820 7468 6520 6769 7665 6e20   with the given 
+0000c430: 7661 6c75 6520 6174 2074 6865 2067 6976  value at the giv
+0000c440: 656e 206c 6f63 6174 696f 6e2e 0a20 2020  en location..   
+0000c450: 2020 2020 2049 6620 7468 6520 6769 7665       If the give
+0000c460: 6e20 7661 6c75 6520 6973 2061 6c73 6f20  n value is also 
+0000c470: 6120 6461 7461 7365 742c 2073 656c 6563  a dataset, selec
+0000c480: 7420 636f 7272 6573 706f 6e64 696e 6720  t corresponding 
+0000c490: 7661 7269 6162 6c65 730a 2020 2020 2020  variables.      
+0000c4a0: 2020 696e 2074 6865 2067 6976 656e 2076    in the given v
+0000c4b0: 616c 7565 2061 6e64 2069 6e20 7468 6520  alue and in the 
+0000c4c0: 6461 7461 7365 7420 746f 2062 6520 6368  dataset to be ch
+0000c4d0: 616e 6765 642e 0a0a 2020 2020 2020 2020  anged...        
+0000c4e0: 4966 2076 616c 7565 2069 7320 6120 600a  If value is a `.
+0000c4f0: 2020 2020 2020 2020 6672 6f6d 202e 6461          from .da
+0000c500: 7461 6172 7261 7920 696d 706f 7274 2044  taarray import D
+0000c510: 6174 6141 7272 6179 602c 2063 616c 6c20  ataArray`, call 
+0000c520: 6974 7320 6073 656c 6563 745f 7661 7273  its `select_vars
+0000c530: 2829 6020 6d65 7468 6f64 2c20 7265 6e61  ()` method, rena
+0000c540: 6d65 2069 740a 2020 2020 2020 2020 746f  me it.        to
+0000c550: 2060 6b65 7960 2061 6e64 206d 6572 6765   `key` and merge
+0000c560: 2074 6865 2063 6f6e 7465 6e74 7320 6f66   the contents of
+0000c570: 2074 6865 2072 6573 756c 7469 6e67 2064   the resulting d
+0000c580: 6174 6173 6574 2069 6e74 6f20 7468 6973  ataset into this
+0000c590: 0a20 2020 2020 2020 2064 6174 6173 6574  .        dataset
+0000c5a0: 2e0a 0a20 2020 2020 2020 2049 6620 7661  ...        If va
+0000c5b0: 6c75 6520 6973 2061 2060 5661 7269 6162  lue is a `Variab
+0000c5c0: 6c65 6020 6f62 6a65 6374 2028 6f72 2074  le` object (or t
+0000c5d0: 7570 6c65 206f 6620 666f 726d 0a20 2020  uple of form.   
+0000c5e0: 2020 2020 2060 6028 6469 6d73 2c20 6461       ``(dims, da
+0000c5f0: 7461 5b2c 2061 7474 7273 5d29 6060 292c  ta[, attrs])``),
+0000c600: 2061 6464 2069 7420 746f 2074 6869 7320   add it to this 
+0000c610: 6461 7461 7365 7420 6173 2061 206e 6577  dataset as a new
+0000c620: 0a20 2020 2020 2020 2076 6172 6961 626c  .        variabl
+0000c630: 652e 0a20 2020 2020 2020 2022 2222 0a20  e..        """. 
+0000c640: 2020 2020 2020 2066 726f 6d20 7861 7272         from xarr
+0000c650: 6179 2e63 6f72 652e 6461 7461 6172 7261  ay.core.dataarra
+0000c660: 7920 696d 706f 7274 2044 6174 6141 7272  y import DataArr
+0000c670: 6179 0a0a 2020 2020 2020 2020 6966 2075  ay..        if u
+0000c680: 7469 6c73 2e69 735f 6469 6374 5f6c 696b  tils.is_dict_lik
+0000c690: 6528 6b65 7929 3a0a 2020 2020 2020 2020  e(key):.        
+0000c6a0: 2020 2020 2320 6368 6563 6b20 666f 7220      # check for 
+0000c6b0: 636f 6e73 6973 7465 6e63 7920 616e 6420  consistency and 
+0000c6c0: 636f 6e76 6572 7420 7661 6c75 6520 746f  convert value to
+0000c6d0: 2064 6174 6173 6574 0a20 2020 2020 2020   dataset.       
+0000c6e0: 2020 2020 2076 616c 7565 203d 2073 656c       value = sel
+0000c6f0: 662e 5f73 6574 6974 656d 5f63 6865 636b  f._setitem_check
+0000c700: 286b 6579 2c20 7661 6c75 6529 0a20 2020  (key, value).   
+0000c710: 2020 2020 2020 2020 2023 206c 6f6f 7020           # loop 
+0000c720: 6f76 6572 2064 6174 6173 6574 2076 6172  over dataset var
+0000c730: 6961 626c 6573 2061 6e64 2073 6574 206e  iables and set n
+0000c740: 6577 2076 616c 7565 730a 2020 2020 2020  ew values.      
+0000c750: 2020 2020 2020 7072 6f63 6573 7365 6420        processed 
+0000c760: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+0000c770: 2066 6f72 206e 616d 652c 2076 6172 2069   for name, var i
+0000c780: 6e20 7365 6c66 2e69 7465 6d73 2829 3a0a  n self.items():.
+0000c790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7a0: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+0000c7b0: 2020 2020 2020 2020 2076 6172 5b6b 6579           var[key
+0000c7c0: 5d20 3d20 7661 6c75 655b 6e61 6d65 5d0a  ] = value[name].
+0000c7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c7e0: 2020 2020 7072 6f63 6573 7365 642e 6170      processed.ap
+0000c7f0: 7065 6e64 286e 616d 6529 0a20 2020 2020  pend(name).     
+0000c800: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0000c810: 7420 4578 6365 7074 696f 6e20 6173 2065  t Exception as e
+0000c820: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000c830: 2020 2020 2020 6966 2070 726f 6365 7373        if process
+0000c840: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+0000c850: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000c860: 6520 5275 6e74 696d 6545 7272 6f72 280a  e RuntimeError(.
+0000c870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c880: 2020 2020 2020 2020 2020 2020 2241 6e20              "An 
+0000c890: 6572 726f 7220 6f63 6375 7272 6564 2077  error occurred w
+0000c8a0: 6869 6c65 2073 6574 7469 6e67 2076 616c  hile setting val
+0000c8b0: 7565 7320 6f66 2074 6865 220a 2020 2020  ues of the".    
+0000c8c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c8d0: 2020 2020 2020 2020 6622 2076 6172 6961          f" varia
+0000c8e0: 626c 6520 277b 6e61 6d65 7d27 2e20 5468  ble '{name}'. Th
+0000c8f0: 6520 666f 6c6c 6f77 696e 6720 7661 7269  e following vari
+0000c900: 6162 6c65 7320 6861 7665 220a 2020 2020  ables have".    
+0000c910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c920: 2020 2020 2020 2020 6622 2062 6565 6e20          f" been 
+0000c930: 7375 6363 6573 7366 756c 6c79 2075 7064  successfully upd
+0000c940: 6174 6564 3a5c 6e7b 7072 6f63 6573 7365  ated:\n{processe
+0000c950: 647d 220a 2020 2020 2020 2020 2020 2020  d}".            
+0000c960: 2020 2020 2020 2020 2020 2020 2920 6672              ) fr
+0000c970: 6f6d 2065 0a20 2020 2020 2020 2020 2020  om e.           
+0000c980: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000c990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c9a0: 2020 2020 2020 2072 6169 7365 2065 0a0a         raise e..
+0000c9b0: 2020 2020 2020 2020 656c 6966 2075 7469          elif uti
+0000c9c0: 6c73 2e68 6173 6861 626c 6528 6b65 7929  ls.hashable(key)
+0000c9d0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0000c9e0: 2069 7369 6e73 7461 6e63 6528 7661 6c75   isinstance(valu
+0000c9f0: 652c 2044 6174 6173 6574 293a 0a20 2020  e, Dataset):.   
+0000ca00: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000ca10: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+0000ca20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca30: 2020 2243 616e 6e6f 7420 6173 7369 676e    "Cannot assign
+0000ca40: 2061 2044 6174 6173 6574 2074 6f20 6120   a Dataset to a 
+0000ca50: 7369 6e67 6c65 206b 6579 202d 206f 6e6c  single key - onl
+0000ca60: 7920 6120 4461 7461 4172 7261 7920 6f72  y a DataArray or
+0000ca70: 2056 6172 6961 626c 6520 220a 2020 2020   Variable ".    
+0000ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ca90: 226f 626a 6563 7420 6361 6e20 6265 2073  "object can be s
+0000caa0: 746f 7265 6420 756e 6465 7220 6120 7369  tored under a si
+0000cab0: 6e67 6c65 206b 6579 2e22 0a20 2020 2020  ngle key.".     
+0000cac0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000cad0: 2020 2020 2020 2020 2073 656c 662e 7570           self.up
+0000cae0: 6461 7465 287b 6b65 793a 2076 616c 7565  date({key: value
+0000caf0: 7d29 0a0a 2020 2020 2020 2020 656c 6966  })..        elif
+0000cb00: 2075 7469 6c73 2e69 7465 7261 626c 655f   utils.iterable_
+0000cb10: 6f66 5f68 6173 6861 626c 6528 6b65 7929  of_hashable(key)
+0000cb20: 3a0a 2020 2020 2020 2020 2020 2020 6b65  :.            ke
+0000cb30: 796c 6973 7420 3d20 6c69 7374 286b 6579  ylist = list(key
+0000cb40: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0000cb50: 206c 656e 286b 6579 6c69 7374 2920 3d3d   len(keylist) ==
+0000cb60: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+0000cb70: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0000cb80: 7272 6f72 2822 456d 7074 7920 6c69 7374  rror("Empty list
+0000cb90: 206f 6620 7661 7269 6162 6c65 7320 746f   of variables to
+0000cba0: 2062 6520 7365 7422 290a 2020 2020 2020   be set").      
+0000cbb0: 2020 2020 2020 6966 206c 656e 286b 6579        if len(key
+0000cbc0: 6c69 7374 2920 3d3d 2031 3a0a 2020 2020  list) == 1:.    
+0000cbd0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000cbe0: 2e75 7064 6174 6528 7b6b 6579 6c69 7374  .update({keylist
+0000cbf0: 5b30 5d3a 2076 616c 7565 7d29 0a20 2020  [0]: value}).   
+0000cc00: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000cc10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000cc20: 6620 6c65 6e28 6b65 796c 6973 7429 2021  f len(keylist) !
+0000cc30: 3d20 6c65 6e28 7661 6c75 6529 3a0a 2020  = len(value):.  
+0000cc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000cc50: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+0000cc60: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+0000cc70: 2020 2020 2020 2020 2020 2020 6622 4469              f"Di
+0000cc80: 6666 6572 656e 7420 6c65 6e67 7468 7320  fferent lengths 
+0000cc90: 6f66 2076 6172 6961 626c 6573 2074 6f20  of variables to 
+0000cca0: 6265 2073 6574 2022 0a20 2020 2020 2020  be set ".       
+0000ccb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ccc0: 2066 2228 7b6c 656e 286b 6579 6c69 7374   f"({len(keylist
+0000ccd0: 297d 2920 616e 6420 6461 7461 2075 7365  )}) and data use
+0000cce0: 6420 6173 2069 6e70 7574 2066 6f72 2022  d as input for "
+0000ccf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cd00: 2020 2020 2020 2020 2066 2273 6574 7469           f"setti
+0000cd10: 6e67 2028 7b6c 656e 2876 616c 7565 297d  ng ({len(value)}
+0000cd20: 2922 0a20 2020 2020 2020 2020 2020 2020  )".             
+0000cd30: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0000cd40: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
+0000cd50: 7374 616e 6365 2876 616c 7565 2c20 4461  stance(value, Da
+0000cd60: 7461 7365 7429 3a0a 2020 2020 2020 2020  taset):.        
+0000cd70: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000cd80: 2e75 7064 6174 6528 6469 6374 287a 6970  .update(dict(zip
+0000cd90: 286b 6579 6c69 7374 2c20 7661 6c75 652e  (keylist, value.
+0000cda0: 6461 7461 5f76 6172 732e 7661 6c75 6573  data_vars.values
+0000cdb0: 2829 2929 290a 2020 2020 2020 2020 2020  ()))).          
+0000cdc0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+0000cdd0: 7461 6e63 6528 7661 6c75 652c 2044 6174  tance(value, Dat
+0000cde0: 6141 7272 6179 293a 0a20 2020 2020 2020  aArray):.       
+0000cdf0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000ce00: 7365 2056 616c 7565 4572 726f 7228 2243  se ValueError("C
+0000ce10: 616e 6e6f 7420 6173 7369 676e 2073 696e  annot assign sin
+0000ce20: 676c 6520 4461 7461 4172 7261 7920 746f  gle DataArray to
+0000ce30: 206d 756c 7469 706c 6520 6b65 7973 2229   multiple keys")
+0000ce40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ce50: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0000ce60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000ce70: 7570 6461 7465 2864 6963 7428 7a69 7028  update(dict(zip(
+0000ce80: 6b65 796c 6973 742c 2076 616c 7565 2929  keylist, value))
+0000ce90: 290a 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+0000cea0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000ceb0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+0000cec0: 556e 7375 7070 6f72 7465 6420 6b65 792d  Unsupported key-
+0000ced0: 7479 7065 207b 7479 7065 286b 6579 297d  type {type(key)}
+0000cee0: 2229 0a0a 2020 2020 6465 6620 5f73 6574  ")..    def _set
+0000cef0: 6974 656d 5f63 6865 636b 2873 656c 662c  item_check(self,
+0000cf00: 206b 6579 2c20 7661 6c75 6529 3a0a 2020   key, value):.  
+0000cf10: 2020 2020 2020 2222 2243 6f6e 7369 7374        """Consist
+0000cf20: 656e 6379 2063 6865 636b 2066 6f72 205f  ency check for _
+0000cf30: 5f73 6574 6974 656d 5f5f 0a0a 2020 2020  _setitem__..    
+0000cf40: 2020 2020 5768 656e 2061 7373 6967 6e69      When assigni
+0000cf50: 6e67 2076 616c 7565 7320 746f 2061 2073  ng values to a s
+0000cf60: 7562 7365 7420 6f66 2061 2044 6174 6173  ubset of a Datas
+0000cf70: 6574 2c20 646f 2063 6f6e 7369 7374 656e  et, do consisten
+0000cf80: 6379 2063 6865 636b 2062 6566 6f72 6568  cy check beforeh
+0000cf90: 616e 640a 2020 2020 2020 2020 746f 2061  and.        to a
+0000cfa0: 766f 6964 206c 6561 7669 6e67 2074 6865  void leaving the
+0000cfb0: 2064 6174 6173 6574 2069 6e20 6120 7061   dataset in a pa
+0000cfc0: 7274 6961 6c6c 7920 7570 6461 7465 6420  rtially updated 
+0000cfd0: 7374 6174 6520 7768 656e 2061 6e20 6572  state when an er
+0000cfe0: 726f 7220 6f63 6375 7273 2e0a 2020 2020  ror occurs..    
+0000cff0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000d000: 6672 6f6d 2078 6172 7261 792e 636f 7265  from xarray.core
+0000d010: 2e61 6c69 676e 6d65 6e74 2069 6d70 6f72  .alignment impor
+0000d020: 7420 616c 6967 6e0a 2020 2020 2020 2020  t align.        
+0000d030: 6672 6f6d 2078 6172 7261 792e 636f 7265  from xarray.core
+0000d040: 2e64 6174 6161 7272 6179 2069 6d70 6f72  .dataarray impor
+0000d050: 7420 4461 7461 4172 7261 790a 0a20 2020  t DataArray..   
+0000d060: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0000d070: 6365 2876 616c 7565 2c20 4461 7461 7365  ce(value, Datase
+0000d080: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0000d090: 6d69 7373 696e 675f 7661 7273 203d 205b  missing_vars = [
+0000d0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d0b0: 206e 616d 6520 666f 7220 6e61 6d65 2069   name for name i
+0000d0c0: 6e20 7661 6c75 652e 6461 7461 5f76 6172  n value.data_var
+0000d0d0: 7320 6966 206e 616d 6520 6e6f 7420 696e  s if name not in
+0000d0e0: 2073 656c 662e 6461 7461 5f76 6172 730a   self.data_vars.
+0000d0f0: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
+0000d100: 2020 2020 2020 2020 2020 6966 206d 6973            if mis
+0000d110: 7369 6e67 5f76 6172 733a 0a20 2020 2020  sing_vars:.     
+0000d120: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000d130: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0000d140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d150: 2066 2256 6172 6961 626c 6573 207b 6d69   f"Variables {mi
+0000d160: 7373 696e 675f 7661 7273 7d20 696e 206e  ssing_vars} in n
+0000d170: 6577 2076 616c 7565 7322 0a20 2020 2020  ew values".     
+0000d180: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000d190: 2220 6e6f 7420 6176 6169 6c61 626c 6520  " not available 
+0000d1a0: 696e 206f 7269 6769 6e61 6c20 6461 7461  in original data
+0000d1b0: 7365 743a 5c6e 7b73 656c 667d 220a 2020  set:\n{self}".  
+0000d1c0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0000d1d0: 2020 2020 2020 2020 656c 6966 206e 6f74          elif not
+0000d1e0: 2061 6e79 285b 6973 696e 7374 616e 6365   any([isinstance
+0000d1f0: 2876 616c 7565 2c20 7429 2066 6f72 2074  (value, t) for t
+0000d200: 2069 6e20 5b44 6174 6141 7272 6179 2c20   in [DataArray, 
+0000d210: 4e75 6d62 6572 2c20 7374 725d 5d29 3a0a  Number, str]]):.
+0000d220: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000d230: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+0000d240: 2020 2020 2020 2020 2020 2020 2022 4461               "Da
+0000d250: 7461 7365 7420 6173 7369 676e 6d65 6e74  taset assignment
+0000d260: 206f 6e6c 7920 6163 6365 7074 7320 4461   only accepts Da
+0000d270: 7461 4172 7261 7973 2c20 4461 7461 7365  taArrays, Datase
+0000d280: 7473 2c20 616e 6420 7363 616c 6172 732e  ts, and scalars.
+0000d290: 220a 2020 2020 2020 2020 2020 2020 290a  ".            ).
+0000d2a0: 0a20 2020 2020 2020 206e 6577 5f76 616c  .        new_val
+0000d2b0: 7565 203d 2044 6174 6173 6574 2829 0a20  ue = Dataset(). 
+0000d2c0: 2020 2020 2020 2066 6f72 206e 616d 652c         for name,
+0000d2d0: 2076 6172 2069 6e20 7365 6c66 2e69 7465   var in self.ite
+0000d2e0: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+0000d2f0: 2020 2320 7465 7374 2069 6e64 6578 696e    # test indexin
+0000d300: 670a 2020 2020 2020 2020 2020 2020 7472  g.            tr
+0000d310: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+0000d320: 2020 2076 6172 5f6b 203d 2076 6172 5b6b     var_k = var[k
+0000d330: 6579 5d0a 2020 2020 2020 2020 2020 2020  ey].            
+0000d340: 6578 6365 7074 2045 7863 6570 7469 6f6e  except Exception
+0000d350: 2061 7320 653a 0a20 2020 2020 2020 2020   as e:.         
+0000d360: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0000d370: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+0000d380: 2020 2020 2020 2020 2020 2020 2066 2256               f"V
+0000d390: 6172 6961 626c 6520 277b 6e61 6d65 7d27  ariable '{name}'
+0000d3a0: 3a20 696e 6465 7865 7220 7b6b 6579 7d20  : indexer {key} 
+0000d3b0: 6e6f 7420 6176 6169 6c61 626c 6522 0a20  not available". 
+0000d3c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0000d3d0: 2066 726f 6d20 650a 0a20 2020 2020 2020   from e..       
+0000d3e0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0000d3f0: 6365 2876 616c 7565 2c20 4461 7461 7365  ce(value, Datase
+0000d400: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+0000d410: 2020 2020 7661 6c20 3d20 7661 6c75 655b      val = value[
+0000d420: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
+0000d430: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000d440: 2020 2020 2020 2020 7661 6c20 3d20 7661          val = va
+0000d450: 6c75 650a 0a20 2020 2020 2020 2020 2020  lue..           
+0000d460: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
+0000d470: 616c 2c20 4461 7461 4172 7261 7929 3a0a  al, DataArray):.
 0000d480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d490: 2020 2020 2020 2020 2020 6622 6275 7420            f"but 
-0000d4a0: 6e6f 7420 696e 2074 6865 2069 6e64 6578  not in the index
-0000d4b0: 6564 206f 7269 6769 6e61 6c20 6461 7461  ed original data
-0000d4c0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000d4d0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000d4e0: 2020 2020 2020 2020 2020 2020 6469 6d73              dims
-0000d4f0: 203d 2074 7570 6c65 2864 696d 2066 6f72   = tuple(dim for
-0000d500: 2064 696d 2069 6e20 7661 725f 6b2e 6469   dim in var_k.di
-0000d510: 6d73 2069 6620 6469 6d20 696e 2076 616c  ms if dim in val
-0000d520: 2e64 696d 7329 0a20 2020 2020 2020 2020  .dims).         
-0000d530: 2020 2020 2020 2069 6620 6469 6d73 2021         if dims !
-0000d540: 3d20 7661 6c2e 6469 6d73 3a0a 2020 2020  = val.dims:.    
-0000d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d560: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000d570: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000d580: 2020 2020 2020 2020 2020 6622 5661 7269            f"Vari
-0000d590: 6162 6c65 2027 7b6e 616d 657d 273a 2064  able '{name}': d
-0000d5a0: 696d 656e 7369 6f6e 206f 7264 6572 2064  imension order d
-0000d5b0: 6966 6665 7273 2062 6574 7765 656e 220a  iffers between".
-0000d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d5d0: 2020 2020 2020 2020 6622 206f 7269 6769          f" origi
-0000d5e0: 6e61 6c20 616e 6420 6e65 7720 6461 7461  nal and new data
-0000d5f0: 3a5c 6e7b 6469 6d73 7d5c 6e76 732e 5c6e  :\n{dims}\nvs.\n
-0000d600: 7b76 616c 2e64 696d 737d 220a 2020 2020  {val.dims}".    
-0000d610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d620: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-0000d630: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000d640: 2020 2020 7661 6c20 3d20 6e70 2e61 7272      val = np.arr
-0000d650: 6179 2876 616c 290a 0a20 2020 2020 2020  ay(val)..       
-0000d660: 2020 2020 2023 2074 7970 6520 636f 6e76       # type conv
-0000d670: 6572 7369 6f6e 0a20 2020 2020 2020 2020  ersion.         
-0000d680: 2020 206e 6577 5f76 616c 7565 5b6e 616d     new_value[nam
-0000d690: 655d 203d 2064 7563 6b5f 6172 7261 795f  e] = duck_array_
-0000d6a0: 6f70 732e 6173 7479 7065 2876 616c 2c20  ops.astype(val, 
-0000d6b0: 6474 7970 653d 7661 725f 6b2e 6474 7970  dtype=var_k.dtyp
-0000d6c0: 652c 2063 6f70 793d 4661 6c73 6529 0a0a  e, copy=False)..
-0000d6d0: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
-0000d6e0: 636f 6e73 6973 7465 6e63 7920 6f66 2064  consistency of d
-0000d6f0: 696d 656e 7369 6f6e 2073 697a 6573 2061  imension sizes a
-0000d700: 6e64 2064 696d 656e 7369 6f6e 2063 6f6f  nd dimension coo
-0000d710: 7264 696e 6174 6573 0a20 2020 2020 2020  rdinates.       
-0000d720: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
-0000d730: 616c 7565 2c20 4461 7461 4172 7261 7929  alue, DataArray)
-0000d740: 206f 7220 6973 696e 7374 616e 6365 2876   or isinstance(v
-0000d750: 616c 7565 2c20 4461 7461 7365 7429 3a0a  alue, Dataset):.
-0000d760: 2020 2020 2020 2020 2020 2020 616c 6967              alig
-0000d770: 6e28 7365 6c66 5b6b 6579 5d2c 2076 616c  n(self[key], val
-0000d780: 7565 2c20 6a6f 696e 3d22 6578 6163 7422  ue, join="exact"
-0000d790: 2c20 636f 7079 3d46 616c 7365 290a 0a20  , copy=False).. 
-0000d7a0: 2020 2020 2020 2072 6574 7572 6e20 6e65         return ne
-0000d7b0: 775f 7661 6c75 650a 0a20 2020 2064 6566  w_value..    def
-0000d7c0: 205f 5f64 656c 6974 656d 5f5f 2873 656c   __delitem__(sel
-0000d7d0: 662c 206b 6579 3a20 4861 7368 6162 6c65  f, key: Hashable
-0000d7e0: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-0000d7f0: 2020 2022 2222 5265 6d6f 7665 2061 2076     """Remove a v
-0000d800: 6172 6961 626c 6520 6672 6f6d 2074 6869  ariable from thi
-0000d810: 7320 6461 7461 7365 742e 2222 220a 2020  s dataset.""".  
-0000d820: 2020 2020 2020 6173 7365 7274 5f6e 6f5f        assert_no_
-0000d830: 696e 6465 785f 636f 7272 7570 7465 6428  index_corrupted(
-0000d840: 7365 6c66 2e78 696e 6465 7865 732c 207b  self.xindexes, {
-0000d850: 6b65 797d 290a 0a20 2020 2020 2020 2069  key})..        i
-0000d860: 6620 6b65 7920 696e 2073 656c 662e 5f69  f key in self._i
-0000d870: 6e64 6578 6573 3a0a 2020 2020 2020 2020  ndexes:.        
-0000d880: 2020 2020 6465 6c20 7365 6c66 2e5f 696e      del self._in
-0000d890: 6465 7865 735b 6b65 795d 0a20 2020 2020  dexes[key].     
-0000d8a0: 2020 2064 656c 2073 656c 662e 5f76 6172     del self._var
-0000d8b0: 6961 626c 6573 5b6b 6579 5d0a 2020 2020  iables[key].    
-0000d8c0: 2020 2020 7365 6c66 2e5f 636f 6f72 645f      self._coord_
-0000d8d0: 6e61 6d65 732e 6469 7363 6172 6428 6b65  names.discard(ke
-0000d8e0: 7929 0a20 2020 2020 2020 2073 656c 662e  y).        self.
-0000d8f0: 5f64 696d 7320 3d20 6361 6c63 756c 6174  _dims = calculat
-0000d900: 655f 6469 6d65 6e73 696f 6e73 2873 656c  e_dimensions(sel
-0000d910: 662e 5f76 6172 6961 626c 6573 290a 0a20  f._variables).. 
-0000d920: 2020 2023 206d 7574 6162 6c65 206f 626a     # mutable obj
-0000d930: 6563 7473 2073 686f 756c 6420 6e6f 7420  ects should not 
-0000d940: 6265 2068 6173 6861 626c 650a 2020 2020  be hashable.    
-0000d950: 2320 6874 7470 733a 2f2f 6769 7468 7562  # https://github
-0000d960: 2e63 6f6d 2f70 7974 686f 6e2f 6d79 7079  .com/python/mypy
-0000d970: 2f69 7373 7565 732f 3432 3636 0a20 2020  /issues/4266.   
-0000d980: 205f 5f68 6173 685f 5f20 3d20 4e6f 6e65   __hash__ = None
-0000d990: 2020 2320 7479 7065 3a20 6967 6e6f 7265    # type: ignore
-0000d9a0: 5b61 7373 6967 6e6d 656e 745d 0a0a 2020  [assignment]..  
-0000d9b0: 2020 6465 6620 5f61 6c6c 5f63 6f6d 7061    def _all_compa
-0000d9c0: 7428 7365 6c66 2c20 6f74 6865 723a 2044  t(self, other: D
-0000d9d0: 6174 6173 6574 2c20 636f 6d70 6174 5f73  ataset, compat_s
-0000d9e0: 7472 3a20 7374 7229 202d 3e20 626f 6f6c  tr: str) -> bool
-0000d9f0: 3a0a 2020 2020 2020 2020 2222 2248 656c  :.        """Hel
-0000da00: 7065 7220 6675 6e63 7469 6f6e 2066 6f72  per function for
-0000da10: 2065 7175 616c 7320 616e 6420 6964 656e   equals and iden
-0000da20: 7469 6361 6c22 2222 0a0a 2020 2020 2020  tical"""..      
-0000da30: 2020 2320 736f 6d65 2073 746f 7265 7320    # some stores 
-0000da40: 2865 2e67 2e2c 2073 6369 7079 2920 646f  (e.g., scipy) do
-0000da50: 206e 6f74 2073 6565 6d20 746f 2070 7265   not seem to pre
-0000da60: 7365 7276 6520 6f72 6465 722c 2073 6f20  serve order, so 
-0000da70: 646f 6e27 740a 2020 2020 2020 2020 2320  don't.        # 
-0000da80: 7265 7175 6972 6520 6d61 7463 6869 6e67  require matching
-0000da90: 206f 7264 6572 2066 6f72 2065 7175 616c   order for equal
-0000daa0: 6974 790a 2020 2020 2020 2020 6465 6620  ity.        def 
-0000dab0: 636f 6d70 6174 2878 3a20 5661 7269 6162  compat(x: Variab
-0000dac0: 6c65 2c20 793a 2056 6172 6961 626c 6529  le, y: Variable)
-0000dad0: 202d 3e20 626f 6f6c 3a0a 2020 2020 2020   -> bool:.      
-0000dae0: 2020 2020 2020 7265 7475 726e 2067 6574        return get
-0000daf0: 6174 7472 2878 2c20 636f 6d70 6174 5f73  attr(x, compat_s
-0000db00: 7472 2928 7929 0a0a 2020 2020 2020 2020  tr)(y)..        
-0000db10: 7265 7475 726e 2073 656c 662e 5f63 6f6f  return self._coo
-0000db20: 7264 5f6e 616d 6573 203d 3d20 6f74 6865  rd_names == othe
-0000db30: 722e 5f63 6f6f 7264 5f6e 616d 6573 2061  r._coord_names a
-0000db40: 6e64 2075 7469 6c73 2e64 6963 745f 6571  nd utils.dict_eq
-0000db50: 7569 7628 0a20 2020 2020 2020 2020 2020  uiv(.           
-0000db60: 2073 656c 662e 5f76 6172 6961 626c 6573   self._variables
-0000db70: 2c20 6f74 6865 722e 5f76 6172 6961 626c  , other._variabl
-0000db80: 6573 2c20 636f 6d70 6174 3d63 6f6d 7061  es, compat=compa
-0000db90: 740a 2020 2020 2020 2020 290a 0a20 2020  t.        )..   
-0000dba0: 2064 6566 2062 726f 6164 6361 7374 5f65   def broadcast_e
-0000dbb0: 7175 616c 7328 7365 6c66 2c20 6f74 6865  quals(self, othe
-0000dbc0: 723a 2044 6174 6173 6574 2920 2d3e 2062  r: Dataset) -> b
-0000dbd0: 6f6f 6c3a 0a20 2020 2020 2020 2022 2222  ool:.        """
-0000dbe0: 5477 6f20 4461 7461 7365 7473 2061 7265  Two Datasets are
-0000dbf0: 2062 726f 6164 6361 7374 2065 7175 616c   broadcast equal
-0000dc00: 2069 6620 7468 6579 2061 7265 2065 7175   if they are equ
-0000dc10: 616c 2061 6674 6572 0a20 2020 2020 2020  al after.       
-0000dc20: 2062 726f 6164 6361 7374 696e 6720 616c   broadcasting al
-0000dc30: 6c20 7661 7269 6162 6c65 7320 6167 6169  l variables agai
-0000dc40: 6e73 7420 6561 6368 206f 7468 6572 2e0a  nst each other..
-0000dc50: 0a20 2020 2020 2020 2046 6f72 2065 7861  .        For exa
-0000dc60: 6d70 6c65 2c20 7661 7269 6162 6c65 7320  mple, variables 
-0000dc70: 7468 6174 2061 7265 2073 6361 6c61 7220  that are scalar 
-0000dc80: 696e 206f 6e65 2064 6174 6173 6574 2062  in one dataset b
-0000dc90: 7574 206e 6f6e 2d73 6361 6c61 7220 696e  ut non-scalar in
-0000dca0: 0a20 2020 2020 2020 2074 6865 206f 7468  .        the oth
-0000dcb0: 6572 2064 6174 6173 6574 2063 616e 2073  er dataset can s
-0000dcc0: 7469 6c6c 2062 6520 6272 6f61 6463 6173  till be broadcas
-0000dcd0: 7420 6571 7561 6c20 6966 2074 6865 2074  t equal if the t
-0000dce0: 6865 206e 6f6e 2d73 6361 6c61 720a 2020  he non-scalar.  
-0000dcf0: 2020 2020 2020 7661 7269 6162 6c65 2069        variable i
-0000dd00: 7320 6120 636f 6e73 7461 6e74 2e0a 0a20  s a constant... 
-0000dd10: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-0000dd20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0000dd30: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
-0000dd40: 2e65 7175 616c 730a 2020 2020 2020 2020  .equals.        
-0000dd50: 4461 7461 7365 742e 6964 656e 7469 6361  Dataset.identica
-0000dd60: 6c0a 2020 2020 2020 2020 2222 220a 2020  l.        """.  
-0000dd70: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-0000dd80: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000dd90: 6c66 2e5f 616c 6c5f 636f 6d70 6174 286f  lf._all_compat(o
-0000dda0: 7468 6572 2c20 2262 726f 6164 6361 7374  ther, "broadcast
-0000ddb0: 5f65 7175 616c 7322 290a 2020 2020 2020  _equals").      
-0000ddc0: 2020 6578 6365 7074 2028 5479 7065 4572    except (TypeEr
-0000ddd0: 726f 722c 2041 7474 7269 6275 7465 4572  ror, AttributeEr
-0000dde0: 726f 7229 3a0a 2020 2020 2020 2020 2020  ror):.          
-0000ddf0: 2020 7265 7475 726e 2046 616c 7365 0a0a    return False..
-0000de00: 2020 2020 6465 6620 6571 7561 6c73 2873      def equals(s
-0000de10: 656c 662c 206f 7468 6572 3a20 4461 7461  elf, other: Data
-0000de20: 7365 7429 202d 3e20 626f 6f6c 3a0a 2020  set) -> bool:.  
-0000de30: 2020 2020 2020 2222 2254 776f 2044 6174        """Two Dat
-0000de40: 6173 6574 7320 6172 6520 6571 7561 6c20  asets are equal 
-0000de50: 6966 2074 6865 7920 6861 7665 206d 6174  if they have mat
-0000de60: 6368 696e 6720 7661 7269 6162 6c65 7320  ching variables 
-0000de70: 616e 640a 2020 2020 2020 2020 636f 6f72  and.        coor
-0000de80: 6469 6e61 7465 732c 2061 6c6c 206f 6620  dinates, all of 
-0000de90: 7768 6963 6820 6172 6520 6571 7561 6c2e  which are equal.
-0000dea0: 0a0a 2020 2020 2020 2020 4461 7461 7365  ..        Datase
-0000deb0: 7473 2063 616e 2073 7469 6c6c 2062 6520  ts can still be 
-0000dec0: 6571 7561 6c20 286c 696b 6520 7061 6e64  equal (like pand
-0000ded0: 6173 206f 626a 6563 7473 2920 6966 2074  as objects) if t
-0000dee0: 6865 7920 6861 7665 204e 614e 0a20 2020  hey have NaN.   
-0000def0: 2020 2020 2076 616c 7565 7320 696e 2074       values in t
-0000df00: 6865 2073 616d 6520 6c6f 6361 7469 6f6e  he same location
-0000df10: 732e 0a0a 2020 2020 2020 2020 5468 6973  s...        This
-0000df20: 206d 6574 686f 6420 6973 206e 6563 6573   method is neces
-0000df30: 7361 7279 2062 6563 6175 7365 2060 7631  sary because `v1
-0000df40: 203d 3d20 7632 6020 666f 7220 6060 4461   == v2` for ``Da
-0000df50: 7461 7365 7460 600a 2020 2020 2020 2020  taset``.        
-0000df60: 646f 6573 2065 6c65 6d65 6e74 2d77 6973  does element-wis
-0000df70: 6520 636f 6d70 6172 6973 6f6e 7320 286c  e comparisons (l
-0000df80: 696b 6520 6e75 6d70 792e 6e64 6172 7261  ike numpy.ndarra
-0000df90: 7973 292e 0a0a 2020 2020 2020 2020 5365  ys)...        Se
-0000dfa0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-0000dfb0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0000dfc0: 4461 7461 7365 742e 6272 6f61 6463 6173  Dataset.broadcas
-0000dfd0: 745f 6571 7561 6c73 0a20 2020 2020 2020  t_equals.       
-0000dfe0: 2044 6174 6173 6574 2e69 6465 6e74 6963   Dataset.identic
-0000dff0: 616c 0a20 2020 2020 2020 2022 2222 0a20  al.        """. 
-0000e000: 2020 2020 2020 2074 7279 3a0a 2020 2020         try:.    
-0000e010: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000e020: 656c 662e 5f61 6c6c 5f63 6f6d 7061 7428  elf._all_compat(
-0000e030: 6f74 6865 722c 2022 6571 7561 6c73 2229  other, "equals")
-0000e040: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
-0000e050: 2854 7970 6545 7272 6f72 2c20 4174 7472  (TypeError, Attr
-0000e060: 6962 7574 6545 7272 6f72 293a 0a20 2020  ibuteError):.   
-0000e070: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-0000e080: 4661 6c73 650a 0a20 2020 2064 6566 2069  False..    def i
-0000e090: 6465 6e74 6963 616c 2873 656c 662c 206f  dentical(self, o
-0000e0a0: 7468 6572 3a20 4461 7461 7365 7429 202d  ther: Dataset) -
-0000e0b0: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
-0000e0c0: 2222 224c 696b 6520 6571 7561 6c73 2c20  """Like equals, 
-0000e0d0: 6275 7420 616c 736f 2063 6865 636b 7320  but also checks 
-0000e0e0: 616c 6c20 6461 7461 7365 7420 6174 7472  all dataset attr
-0000e0f0: 6962 7574 6573 2061 6e64 2074 6865 0a20  ibutes and the. 
-0000e100: 2020 2020 2020 2061 7474 7269 6275 7465         attribute
-0000e110: 7320 6f6e 2061 6c6c 2076 6172 6961 626c  s on all variabl
-0000e120: 6573 2061 6e64 2063 6f6f 7264 696e 6174  es and coordinat
-0000e130: 6573 2e0a 0a20 2020 2020 2020 2053 6565  es...        See
-0000e140: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-0000e150: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-0000e160: 6174 6173 6574 2e62 726f 6164 6361 7374  ataset.broadcast
-0000e170: 5f65 7175 616c 730a 2020 2020 2020 2020  _equals.        
-0000e180: 4461 7461 7365 742e 6571 7561 6c73 0a20  Dataset.equals. 
-0000e190: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000e1a0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0000e1b0: 2020 2020 7265 7475 726e 2075 7469 6c73      return utils
-0000e1c0: 2e64 6963 745f 6571 7569 7628 7365 6c66  .dict_equiv(self
-0000e1d0: 2e61 7474 7273 2c20 6f74 6865 722e 6174  .attrs, other.at
-0000e1e0: 7472 7329 2061 6e64 2073 656c 662e 5f61  trs) and self._a
-0000e1f0: 6c6c 5f63 6f6d 7061 7428 0a20 2020 2020  ll_compat(.     
-0000e200: 2020 2020 2020 2020 2020 206f 7468 6572             other
-0000e210: 2c20 2269 6465 6e74 6963 616c 220a 2020  , "identical".  
-0000e220: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000e230: 2020 2020 6578 6365 7074 2028 5479 7065      except (Type
-0000e240: 4572 726f 722c 2041 7474 7269 6275 7465  Error, Attribute
-0000e250: 4572 726f 7229 3a0a 2020 2020 2020 2020  Error):.        
-0000e260: 2020 2020 7265 7475 726e 2046 616c 7365      return False
-0000e270: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000e280: 2020 2020 6465 6620 696e 6465 7865 7328      def indexes(
-0000e290: 7365 6c66 2920 2d3e 2049 6e64 6578 6573  self) -> Indexes
-0000e2a0: 5b70 642e 496e 6465 785d 3a0a 2020 2020  [pd.Index]:.    
-0000e2b0: 2020 2020 2222 224d 6170 7069 6e67 206f      """Mapping o
-0000e2c0: 6620 7061 6e64 6173 2e49 6e64 6578 206f  f pandas.Index o
-0000e2d0: 626a 6563 7473 2075 7365 6420 666f 7220  bjects used for 
-0000e2e0: 6c61 6265 6c20 6261 7365 6420 696e 6465  label based inde
-0000e2f0: 7869 6e67 2e0a 0a20 2020 2020 2020 2052  xing...        R
-0000e300: 6169 7365 7320 616e 2065 7272 6f72 2069  aises an error i
-0000e310: 6620 7468 6973 2044 6174 6173 6574 2068  f this Dataset h
-0000e320: 6173 2069 6e64 6578 6573 2074 6861 7420  as indexes that 
-0000e330: 6361 6e6e 6f74 2062 6520 636f 6572 6365  cannot be coerce
-0000e340: 640a 2020 2020 2020 2020 746f 2070 616e  d.        to pan
-0000e350: 6461 732e 496e 6465 7820 6f62 6a65 6374  das.Index object
-0000e360: 732e 0a0a 2020 2020 2020 2020 5365 6520  s...        See 
-0000e370: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-0000e380: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
-0000e390: 7461 7365 742e 7869 6e64 6578 6573 0a0a  taset.xindexes..
-0000e3a0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0000e3b0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000e3c0: 7869 6e64 6578 6573 2e74 6f5f 7061 6e64  xindexes.to_pand
-0000e3d0: 6173 5f69 6e64 6578 6573 2829 0a0a 2020  as_indexes()..  
-0000e3e0: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000e3f0: 6465 6620 7869 6e64 6578 6573 2873 656c  def xindexes(sel
-0000e400: 6629 202d 3e20 496e 6465 7865 735b 496e  f) -> Indexes[In
-0000e410: 6465 785d 3a0a 2020 2020 2020 2020 2222  dex]:.        ""
-0000e420: 224d 6170 7069 6e67 206f 6620 7861 7272  "Mapping of xarr
-0000e430: 6179 2049 6e64 6578 206f 626a 6563 7473  ay Index objects
-0000e440: 2075 7365 6420 666f 7220 6c61 6265 6c20   used for label 
-0000e450: 6261 7365 6420 696e 6465 7869 6e67 2e22  based indexing."
-0000e460: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0000e470: 6e20 496e 6465 7865 7328 7365 6c66 2e5f  n Indexes(self._
-0000e480: 696e 6465 7865 732c 207b 6b3a 2073 656c  indexes, {k: sel
-0000e490: 662e 5f76 6172 6961 626c 6573 5b6b 5d20  f._variables[k] 
-0000e4a0: 666f 7220 6b20 696e 2073 656c 662e 5f69  for k in self._i
-0000e4b0: 6e64 6578 6573 7d29 0a0a 2020 2020 4070  ndexes})..    @p
-0000e4c0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-0000e4d0: 636f 6f72 6473 2873 656c 6629 202d 3e20  coords(self) -> 
-0000e4e0: 4461 7461 7365 7443 6f6f 7264 696e 6174  DatasetCoordinat
-0000e4f0: 6573 3a0a 2020 2020 2020 2020 2222 2244  es:.        """D
-0000e500: 6963 7469 6f6e 6172 7920 6f66 2078 6172  ictionary of xar
-0000e510: 7261 792e 4461 7461 4172 7261 7920 6f62  ray.DataArray ob
-0000e520: 6a65 6374 7320 636f 7272 6573 706f 6e64  jects correspond
-0000e530: 696e 6720 746f 2063 6f6f 7264 696e 6174  ing to coordinat
-0000e540: 650a 2020 2020 2020 2020 7661 7269 6162  e.        variab
-0000e550: 6c65 730a 2020 2020 2020 2020 2222 220a  les.        """.
-0000e560: 2020 2020 2020 2020 7265 7475 726e 2044          return D
-0000e570: 6174 6173 6574 436f 6f72 6469 6e61 7465  atasetCoordinate
-0000e580: 7328 7365 6c66 290a 0a20 2020 2040 7072  s(self)..    @pr
-0000e590: 6f70 6572 7479 0a20 2020 2064 6566 2064  operty.    def d
-0000e5a0: 6174 615f 7661 7273 2873 656c 6629 202d  ata_vars(self) -
-0000e5b0: 3e20 4461 7461 5661 7269 6162 6c65 733a  > DataVariables:
-0000e5c0: 0a20 2020 2020 2020 2022 2222 4469 6374  .        """Dict
-0000e5d0: 696f 6e61 7279 206f 6620 4461 7461 4172  ionary of DataAr
-0000e5e0: 7261 7920 6f62 6a65 6374 7320 636f 7272  ray objects corr
-0000e5f0: 6573 706f 6e64 696e 6720 746f 2064 6174  esponding to dat
-0000e600: 6120 7661 7269 6162 6c65 7322 2222 0a20  a variables""". 
-0000e610: 2020 2020 2020 2072 6574 7572 6e20 4461         return Da
-0000e620: 7461 5661 7269 6162 6c65 7328 7365 6c66  taVariables(self
-0000e630: 290a 0a20 2020 2064 6566 2073 6574 5f63  )..    def set_c
-0000e640: 6f6f 7264 7328 7365 6c66 3a20 545f 4461  oords(self: T_Da
-0000e650: 7461 7365 742c 206e 616d 6573 3a20 4861  taset, names: Ha
-0000e660: 7368 6162 6c65 207c 2049 7465 7261 626c  shable | Iterabl
-0000e670: 655b 4861 7368 6162 6c65 5d29 202d 3e20  e[Hashable]) -> 
-0000e680: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
-0000e690: 2020 2022 2222 4769 7665 6e20 6e61 6d65     """Given name
-0000e6a0: 7320 6f66 206f 6e65 206f 7220 6d6f 7265  s of one or more
-0000e6b0: 2076 6172 6961 626c 6573 2c20 7365 7420   variables, set 
-0000e6c0: 7468 656d 2061 7320 636f 6f72 6469 6e61  them as coordina
-0000e6d0: 7465 730a 0a20 2020 2020 2020 2050 6172  tes..        Par
-0000e6e0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0000e6f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0000e700: 2020 206e 616d 6573 203a 2068 6173 6861     names : hasha
-0000e710: 626c 6520 6f72 2069 7465 7261 626c 6520  ble or iterable 
-0000e720: 6f66 2068 6173 6861 626c 650a 2020 2020  of hashable.    
-0000e730: 2020 2020 2020 2020 4e61 6d65 2873 2920          Name(s) 
-0000e740: 6f66 2076 6172 6961 626c 6573 2069 6e20  of variables in 
-0000e750: 7468 6973 2064 6174 6173 6574 2074 6f20  this dataset to 
-0000e760: 636f 6e76 6572 7420 696e 746f 2063 6f6f  convert into coo
-0000e770: 7264 696e 6174 6573 2e0a 0a20 2020 2020  rdinates...     
-0000e780: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-0000e790: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-0000e7a0: 2020 2044 6174 6173 6574 0a0a 2020 2020     Dataset..    
-0000e7b0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-0000e7c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-0000e7d0: 2020 2020 2020 4461 7461 7365 742e 7377        Dataset.sw
-0000e7e0: 6170 5f64 696d 730a 2020 2020 2020 2020  ap_dims.        
-0000e7f0: 4461 7461 7365 742e 6173 7369 676e 5f63  Dataset.assign_c
-0000e800: 6f6f 7264 730a 2020 2020 2020 2020 2222  oords.        ""
-0000e810: 220a 2020 2020 2020 2020 2320 544f 444f  ".        # TODO
-0000e820: 3a20 616c 6c6f 7720 696e 7365 7274 696e  : allow insertin
-0000e830: 6720 6e65 7720 636f 6f72 6469 6e61 7465  g new coordinate
-0000e840: 7320 7769 7468 2074 6869 7320 6d65 7468  s with this meth
-0000e850: 6f64 2c20 6c69 6b65 0a20 2020 2020 2020  od, like.       
-0000e860: 2023 2044 6174 6146 7261 6d65 2e73 6574   # DataFrame.set
-0000e870: 5f69 6e64 6578 3f0a 2020 2020 2020 2020  _index?.        
-0000e880: 2320 6e62 2e20 6368 6563 6b20 696e 2073  # nb. check in s
-0000e890: 656c 662e 5f76 6172 6961 626c 6573 2c20  elf._variables, 
-0000e8a0: 6e6f 7420 7365 6c66 2e64 6174 615f 7661  not self.data_va
-0000e8b0: 7273 2074 6f20 696e 7375 7265 2074 6861  rs to insure tha
-0000e8c0: 7420 7468 650a 2020 2020 2020 2020 2320  t the.        # 
-0000e8d0: 6f70 6572 6174 696f 6e20 6973 2069 6465  operation is ide
-0000e8e0: 6d70 6f74 656e 740a 2020 2020 2020 2020  mpotent.        
-0000e8f0: 6966 2069 7369 6e73 7461 6e63 6528 6e61  if isinstance(na
-0000e900: 6d65 732c 2073 7472 2920 6f72 206e 6f74  mes, str) or not
-0000e910: 2069 7369 6e73 7461 6e63 6528 6e61 6d65   isinstance(name
-0000e920: 732c 2049 7465 7261 626c 6529 3a0a 2020  s, Iterable):.  
-0000e930: 2020 2020 2020 2020 2020 6e61 6d65 7320            names 
-0000e940: 3d20 5b6e 616d 6573 5d0a 2020 2020 2020  = [names].      
-0000e950: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0000e960: 2020 2020 6e61 6d65 7320 3d20 6c69 7374      names = list
-0000e970: 286e 616d 6573 290a 2020 2020 2020 2020  (names).        
-0000e980: 7365 6c66 2e5f 6173 7365 7274 5f61 6c6c  self._assert_all
-0000e990: 5f69 6e5f 6461 7461 7365 7428 6e61 6d65  _in_dataset(name
-0000e9a0: 7329 0a20 2020 2020 2020 206f 626a 203d  s).        obj =
-0000e9b0: 2073 656c 662e 636f 7079 2829 0a20 2020   self.copy().   
-0000e9c0: 2020 2020 206f 626a 2e5f 636f 6f72 645f       obj._coord_
-0000e9d0: 6e61 6d65 732e 7570 6461 7465 286e 616d  names.update(nam
-0000e9e0: 6573 290a 2020 2020 2020 2020 7265 7475  es).        retu
-0000e9f0: 726e 206f 626a 0a0a 2020 2020 6465 6620  rn obj..    def 
-0000ea00: 7265 7365 745f 636f 6f72 6473 280a 2020  reset_coords(.  
-0000ea10: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
-0000ea20: 7461 7365 742c 0a20 2020 2020 2020 206e  taset,.        n
-0000ea30: 616d 6573 3a20 4469 6d73 203d 204e 6f6e  ames: Dims = Non
-0000ea40: 652c 0a20 2020 2020 2020 2064 726f 703a  e,.        drop:
-0000ea50: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
-0000ea60: 2020 2029 202d 3e20 545f 4461 7461 7365     ) -> T_Datase
-0000ea70: 743a 0a20 2020 2020 2020 2022 2222 4769  t:.        """Gi
-0000ea80: 7665 6e20 6e61 6d65 7320 6f66 2063 6f6f  ven names of coo
-0000ea90: 7264 696e 6174 6573 2c20 7265 7365 7420  rdinates, reset 
-0000eaa0: 7468 656d 2074 6f20 6265 636f 6d65 2076  them to become v
-0000eab0: 6172 6961 626c 6573 0a0a 2020 2020 2020  ariables..      
-0000eac0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0000ead0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0000eae0: 2020 2020 2020 2020 6e61 6d65 7320 3a20          names : 
-0000eaf0: 7374 722c 2049 7465 7261 626c 6520 6f66  str, Iterable of
-0000eb00: 2048 6173 6861 626c 6520 6f72 204e 6f6e   Hashable or Non
-0000eb10: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
-0000eb20: 2020 2020 2020 2020 4e61 6d65 2873 2920          Name(s) 
-0000eb30: 6f66 206e 6f6e 2d69 6e64 6578 2063 6f6f  of non-index coo
-0000eb40: 7264 696e 6174 6573 2069 6e20 7468 6973  rdinates in this
-0000eb50: 2064 6174 6173 6574 2074 6f20 7265 7365   dataset to rese
-0000eb60: 7420 696e 746f 0a20 2020 2020 2020 2020  t into.         
-0000eb70: 2020 2076 6172 6961 626c 6573 2e20 4279     variables. By
-0000eb80: 2064 6566 6175 6c74 2c20 616c 6c20 6e6f   default, all no
-0000eb90: 6e2d 696e 6465 7820 636f 6f72 6469 6e61  n-index coordina
-0000eba0: 7465 7320 6172 6520 7265 7365 742e 0a20  tes are reset.. 
-0000ebb0: 2020 2020 2020 2064 726f 7020 3a20 626f         drop : bo
-0000ebc0: 6f6c 2c20 6465 6661 756c 743a 2046 616c  ol, default: Fal
-0000ebd0: 7365 0a20 2020 2020 2020 2020 2020 2049  se.            I
-0000ebe0: 6620 5472 7565 2c20 7265 6d6f 7665 2063  f True, remove c
-0000ebf0: 6f6f 7264 696e 6174 6573 2069 6e73 7465  oordinates inste
-0000ec00: 6164 206f 6620 636f 6e76 6572 7469 6e67  ad of converting
-0000ec10: 2074 6865 6d20 696e 746f 0a20 2020 2020   them into.     
-0000ec20: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-0000ec30: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-0000ec40: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-0000ec50: 2d2d 0a20 2020 2020 2020 2044 6174 6173  --.        Datas
-0000ec60: 6574 0a20 2020 2020 2020 2022 2222 0a20  et.        """. 
-0000ec70: 2020 2020 2020 2069 6620 6e61 6d65 7320         if names 
-0000ec80: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000ec90: 2020 2020 206e 616d 6573 203d 2073 656c       names = sel
-0000eca0: 662e 5f63 6f6f 7264 5f6e 616d 6573 202d  f._coord_names -
-0000ecb0: 2073 6574 2873 656c 662e 5f69 6e64 6578   set(self._index
-0000ecc0: 6573 290a 2020 2020 2020 2020 656c 7365  es).        else
-0000ecd0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-0000ece0: 2069 7369 6e73 7461 6e63 6528 6e61 6d65   isinstance(name
-0000ecf0: 732c 2073 7472 2920 6f72 206e 6f74 2069  s, str) or not i
-0000ed00: 7369 6e73 7461 6e63 6528 6e61 6d65 732c  sinstance(names,
-0000ed10: 2049 7465 7261 626c 6529 3a0a 2020 2020   Iterable):.    
-0000ed20: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-0000ed30: 7320 3d20 5b6e 616d 6573 5d0a 2020 2020  s = [names].    
-0000ed40: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0000ed50: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-0000ed60: 6d65 7320 3d20 6c69 7374 286e 616d 6573  mes = list(names
-0000ed70: 290a 2020 2020 2020 2020 2020 2020 7365  ).            se
-0000ed80: 6c66 2e5f 6173 7365 7274 5f61 6c6c 5f69  lf._assert_all_i
-0000ed90: 6e5f 6461 7461 7365 7428 6e61 6d65 7329  n_dataset(names)
-0000eda0: 0a20 2020 2020 2020 2020 2020 2062 6164  .            bad
-0000edb0: 5f63 6f6f 7264 7320 3d20 7365 7428 6e61  _coords = set(na
-0000edc0: 6d65 7329 2026 2073 6574 2873 656c 662e  mes) & set(self.
-0000edd0: 5f69 6e64 6578 6573 290a 2020 2020 2020  _indexes).      
-0000ede0: 2020 2020 2020 6966 2062 6164 5f63 6f6f        if bad_coo
-0000edf0: 7264 733a 0a20 2020 2020 2020 2020 2020  rds:.           
-0000ee00: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0000ee10: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-0000ee20: 2020 2020 2020 2020 2020 2066 2263 616e             f"can
-0000ee30: 6e6f 7420 7265 6d6f 7665 2069 6e64 6578  not remove index
-0000ee40: 2063 6f6f 7264 696e 6174 6573 2077 6974   coordinates wit
-0000ee50: 6820 7265 7365 745f 636f 6f72 6473 3a20  h reset_coords: 
-0000ee60: 7b62 6164 5f63 6f6f 7264 737d 220a 2020  {bad_coords}".  
-0000ee70: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0000ee80: 2020 2020 2020 2020 6f62 6a20 3d20 7365          obj = se
-0000ee90: 6c66 2e63 6f70 7928 290a 2020 2020 2020  lf.copy().      
-0000eea0: 2020 6f62 6a2e 5f63 6f6f 7264 5f6e 616d    obj._coord_nam
-0000eeb0: 6573 2e64 6966 6665 7265 6e63 655f 7570  es.difference_up
-0000eec0: 6461 7465 286e 616d 6573 290a 2020 2020  date(names).    
-0000eed0: 2020 2020 6966 2064 726f 703a 0a20 2020      if drop:.   
-0000eee0: 2020 2020 2020 2020 2066 6f72 206e 616d           for nam
-0000eef0: 6520 696e 206e 616d 6573 3a0a 2020 2020  e in names:.    
-0000ef00: 2020 2020 2020 2020 2020 2020 6465 6c20              del 
-0000ef10: 6f62 6a2e 5f76 6172 6961 626c 6573 5b6e  obj._variables[n
-0000ef20: 616d 655d 0a20 2020 2020 2020 2072 6574  ame].        ret
-0000ef30: 7572 6e20 6f62 6a0a 0a20 2020 2064 6566  urn obj..    def
-0000ef40: 2064 756d 705f 746f 5f73 746f 7265 2873   dump_to_store(s
-0000ef50: 656c 662c 2073 746f 7265 3a20 4162 7374  elf, store: Abst
-0000ef60: 7261 6374 4461 7461 5374 6f72 652c 202a  ractDataStore, *
-0000ef70: 2a6b 7761 7267 7329 202d 3e20 4e6f 6e65  *kwargs) -> None
-0000ef80: 3a0a 2020 2020 2020 2020 2222 2253 746f  :.        """Sto
-0000ef90: 7265 2064 6174 6173 6574 2063 6f6e 7465  re dataset conte
-0000efa0: 6e74 7320 746f 2061 2062 6163 6b65 6e64  nts to a backend
-0000efb0: 732e 2a44 6174 6153 746f 7265 206f 626a  s.*DataStore obj
-0000efc0: 6563 742e 2222 220a 2020 2020 2020 2020  ect.""".        
-0000efd0: 6672 6f6d 2078 6172 7261 792e 6261 636b  from xarray.back
-0000efe0: 656e 6473 2e61 7069 2069 6d70 6f72 7420  ends.api import 
-0000eff0: 6475 6d70 5f74 6f5f 7374 6f72 650a 0a20  dump_to_store.. 
-0000f000: 2020 2020 2020 2023 2054 4f44 4f3a 2072         # TODO: r
-0000f010: 656e 616d 6520 616e 642f 6f72 2063 6c65  ename and/or cle
-0000f020: 616e 7570 2074 6869 7320 6d65 7468 6f64  anup this method
-0000f030: 2074 6f20 6d61 6b65 2069 7420 6d6f 7265   to make it more
-0000f040: 2063 6f6e 7369 7374 656e 740a 2020 2020   consistent.    
-0000f050: 2020 2020 2320 7769 7468 2074 6f5f 6e65      # with to_ne
-0000f060: 7463 6466 2829 0a20 2020 2020 2020 2064  tcdf().        d
-0000f070: 756d 705f 746f 5f73 746f 7265 2873 656c  ump_to_store(sel
-0000f080: 662c 2073 746f 7265 2c20 2a2a 6b77 6172  f, store, **kwar
-0000f090: 6773 290a 0a20 2020 2023 2070 6174 683d  gs)..    # path=
-0000f0a0: 4e6f 6e65 2077 7269 7465 7320 746f 2062  None writes to b
-0000f0b0: 7974 6573 0a20 2020 2040 6f76 6572 6c6f  ytes.    @overlo
-0000f0c0: 6164 0a20 2020 2064 6566 2074 6f5f 6e65  ad.    def to_ne
-0000f0d0: 7463 6466 280a 2020 2020 2020 2020 7365  tcdf(.        se
-0000f0e0: 6c66 2c0a 2020 2020 2020 2020 7061 7468  lf,.        path
-0000f0f0: 3a20 4e6f 6e65 203d 204e 6f6e 652c 0a20  : None = None,. 
-0000f100: 2020 2020 2020 206d 6f64 653a 204c 6974         mode: Lit
-0000f110: 6572 616c 5b22 7722 2c20 2261 225d 203d  eral["w", "a"] =
-0000f120: 2022 7722 2c0a 2020 2020 2020 2020 666f   "w",.        fo
-0000f130: 726d 6174 3a20 545f 4e65 7463 6466 5479  rmat: T_NetcdfTy
-0000f140: 7065 7320 7c20 4e6f 6e65 203d 204e 6f6e  pes | None = Non
-0000f150: 652c 0a20 2020 2020 2020 2067 726f 7570  e,.        group
-0000f160: 3a20 7374 7220 7c20 4e6f 6e65 203d 204e  : str | None = N
-0000f170: 6f6e 652c 0a20 2020 2020 2020 2065 6e67  one,.        eng
-0000f180: 696e 653a 2054 5f4e 6574 6364 6645 6e67  ine: T_NetcdfEng
-0000f190: 696e 6520 7c20 4e6f 6e65 203d 204e 6f6e  ine | None = Non
-0000f1a0: 652c 0a20 2020 2020 2020 2065 6e63 6f64  e,.        encod
-0000f1b0: 696e 673a 204d 6170 7069 6e67 5b41 6e79  ing: Mapping[Any
-0000f1c0: 2c20 4d61 7070 696e 675b 7374 722c 2041  , Mapping[str, A
-0000f1d0: 6e79 5d5d 207c 204e 6f6e 6520 3d20 4e6f  ny]] | None = No
-0000f1e0: 6e65 2c0a 2020 2020 2020 2020 756e 6c69  ne,.        unli
-0000f1f0: 6d69 7465 645f 6469 6d73 3a20 4974 6572  mited_dims: Iter
-0000f200: 6162 6c65 5b48 6173 6861 626c 655d 207c  able[Hashable] |
-0000f210: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-0000f220: 2020 2020 2020 636f 6d70 7574 653a 2062        compute: b
-0000f230: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-0000f240: 2020 2020 696e 7661 6c69 645f 6e65 7463      invalid_netc
-0000f250: 6466 3a20 626f 6f6c 203d 2046 616c 7365  df: bool = False
-0000f260: 2c0a 2020 2020 2920 2d3e 2062 7974 6573  ,.    ) -> bytes
-0000f270: 3a0a 2020 2020 2020 2020 2e2e 2e0a 0a20  :.        ..... 
-0000f280: 2020 2023 2064 6566 6175 6c74 2072 6574     # default ret
-0000f290: 7572 6e20 4e6f 6e65 0a20 2020 2040 6f76  urn None.    @ov
-0000f2a0: 6572 6c6f 6164 0a20 2020 2064 6566 2074  erload.    def t
-0000f2b0: 6f5f 6e65 7463 6466 280a 2020 2020 2020  o_netcdf(.      
-0000f2c0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-0000f2d0: 7061 7468 3a20 7374 7220 7c20 5061 7468  path: str | Path
-0000f2e0: 4c69 6b65 2c0a 2020 2020 2020 2020 6d6f  Like,.        mo
-0000f2f0: 6465 3a20 4c69 7465 7261 6c5b 2277 222c  de: Literal["w",
-0000f300: 2022 6122 5d20 3d20 2277 222c 0a20 2020   "a"] = "w",.   
-0000f310: 2020 2020 2066 6f72 6d61 743a 2054 5f4e       format: T_N
-0000f320: 6574 6364 6654 7970 6573 207c 204e 6f6e  etcdfTypes | Non
-0000f330: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-0000f340: 2020 6772 6f75 703a 2073 7472 207c 204e    group: str | N
-0000f350: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-0000f360: 2020 2020 656e 6769 6e65 3a20 545f 4e65      engine: T_Ne
-0000f370: 7463 6466 456e 6769 6e65 207c 204e 6f6e  tcdfEngine | Non
-0000f380: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-0000f390: 2020 656e 636f 6469 6e67 3a20 4d61 7070    encoding: Mapp
-0000f3a0: 696e 675b 416e 792c 204d 6170 7069 6e67  ing[Any, Mapping
-0000f3b0: 5b73 7472 2c20 416e 795d 5d20 7c20 4e6f  [str, Any]] | No
-0000f3c0: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
-0000f3d0: 2020 2075 6e6c 696d 6974 6564 5f64 696d     unlimited_dim
-0000f3e0: 733a 2049 7465 7261 626c 655b 4861 7368  s: Iterable[Hash
-0000f3f0: 6162 6c65 5d20 7c20 4e6f 6e65 203d 204e  able] | None = N
-0000f400: 6f6e 652c 0a20 2020 2020 2020 2063 6f6d  one,.        com
-0000f410: 7075 7465 3a20 4c69 7465 7261 6c5b 5472  pute: Literal[Tr
-0000f420: 7565 5d20 3d20 5472 7565 2c0a 2020 2020  ue] = True,.    
-0000f430: 2020 2020 696e 7661 6c69 645f 6e65 7463      invalid_netc
-0000f440: 6466 3a20 626f 6f6c 203d 2046 616c 7365  df: bool = False
-0000f450: 2c0a 2020 2020 2920 2d3e 204e 6f6e 653a  ,.    ) -> None:
-0000f460: 0a20 2020 2020 2020 202e 2e2e 0a0a 2020  .        .....  
-0000f470: 2020 2320 636f 6d70 7574 653d 4661 6c73    # compute=Fals
-0000f480: 6520 7265 7475 726e 7320 6461 736b 2e44  e returns dask.D
-0000f490: 656c 6179 6564 0a20 2020 2040 6f76 6572  elayed.    @over
-0000f4a0: 6c6f 6164 0a20 2020 2064 6566 2074 6f5f  load.    def to_
-0000f4b0: 6e65 7463 6466 280a 2020 2020 2020 2020  netcdf(.        
-0000f4c0: 7365 6c66 2c0a 2020 2020 2020 2020 7061  self,.        pa
-0000f4d0: 7468 3a20 7374 7220 7c20 5061 7468 4c69  th: str | PathLi
-0000f4e0: 6b65 2c0a 2020 2020 2020 2020 6d6f 6465  ke,.        mode
-0000f4f0: 3a20 4c69 7465 7261 6c5b 2277 222c 2022  : Literal["w", "
-0000f500: 6122 5d20 3d20 2277 222c 0a20 2020 2020  a"] = "w",.     
-0000f510: 2020 2066 6f72 6d61 743a 2054 5f4e 6574     format: T_Net
-0000f520: 6364 6654 7970 6573 207c 204e 6f6e 6520  cdfTypes | None 
-0000f530: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000f540: 6772 6f75 703a 2073 7472 207c 204e 6f6e  group: str | Non
-0000f550: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-0000f560: 2020 656e 6769 6e65 3a20 545f 4e65 7463    engine: T_Netc
-0000f570: 6466 456e 6769 6e65 207c 204e 6f6e 6520  dfEngine | None 
-0000f580: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000f590: 656e 636f 6469 6e67 3a20 4d61 7070 696e  encoding: Mappin
-0000f5a0: 675b 416e 792c 204d 6170 7069 6e67 5b73  g[Any, Mapping[s
-0000f5b0: 7472 2c20 416e 795d 5d20 7c20 4e6f 6e65  tr, Any]] | None
-0000f5c0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0000f5d0: 2075 6e6c 696d 6974 6564 5f64 696d 733a   unlimited_dims:
-0000f5e0: 2049 7465 7261 626c 655b 4861 7368 6162   Iterable[Hashab
-0000f5f0: 6c65 5d20 7c20 4e6f 6e65 203d 204e 6f6e  le] | None = Non
-0000f600: 652c 0a20 2020 2020 2020 202a 2c0a 2020  e,.        *,.  
-0000f610: 2020 2020 2020 636f 6d70 7574 653a 204c        compute: L
-0000f620: 6974 6572 616c 5b46 616c 7365 5d2c 0a20  iteral[False],. 
-0000f630: 2020 2020 2020 2069 6e76 616c 6964 5f6e         invalid_n
-0000f640: 6574 6364 663a 2062 6f6f 6c20 3d20 4661  etcdf: bool = Fa
-0000f650: 6c73 652c 0a20 2020 2029 202d 3e20 4465  lse,.    ) -> De
-0000f660: 6c61 7965 643a 0a20 2020 2020 2020 202e  layed:.        .
-0000f670: 2e2e 0a0a 2020 2020 6465 6620 746f 5f6e  ....    def to_n
-0000f680: 6574 6364 6628 0a20 2020 2020 2020 2073  etcdf(.        s
-0000f690: 656c 662c 0a20 2020 2020 2020 2070 6174  elf,.        pat
-0000f6a0: 683a 2073 7472 207c 2050 6174 684c 696b  h: str | PathLik
-0000f6b0: 6520 7c20 4e6f 6e65 203d 204e 6f6e 652c  e | None = None,
-0000f6c0: 0a20 2020 2020 2020 206d 6f64 653a 204c  .        mode: L
-0000f6d0: 6974 6572 616c 5b22 7722 2c20 2261 225d  iteral["w", "a"]
-0000f6e0: 203d 2022 7722 2c0a 2020 2020 2020 2020   = "w",.        
-0000f6f0: 666f 726d 6174 3a20 545f 4e65 7463 6466  format: T_Netcdf
-0000f700: 5479 7065 7320 7c20 4e6f 6e65 203d 204e  Types | None = N
-0000f710: 6f6e 652c 0a20 2020 2020 2020 2067 726f  one,.        gro
-0000f720: 7570 3a20 7374 7220 7c20 4e6f 6e65 203d  up: str | None =
-0000f730: 204e 6f6e 652c 0a20 2020 2020 2020 2065   None,.        e
-0000f740: 6e67 696e 653a 2054 5f4e 6574 6364 6645  ngine: T_NetcdfE
-0000f750: 6e67 696e 6520 7c20 4e6f 6e65 203d 204e  ngine | None = N
-0000f760: 6f6e 652c 0a20 2020 2020 2020 2065 6e63  one,.        enc
-0000f770: 6f64 696e 673a 204d 6170 7069 6e67 5b41  oding: Mapping[A
-0000f780: 6e79 2c20 4d61 7070 696e 675b 7374 722c  ny, Mapping[str,
-0000f790: 2041 6e79 5d5d 207c 204e 6f6e 6520 3d20   Any]] | None = 
-0000f7a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 756e  None,.        un
-0000f7b0: 6c69 6d69 7465 645f 6469 6d73 3a20 4974  limited_dims: It
-0000f7c0: 6572 6162 6c65 5b48 6173 6861 626c 655d  erable[Hashable]
-0000f7d0: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
-0000f7e0: 2020 2020 2020 2020 636f 6d70 7574 653a          compute:
-0000f7f0: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
-0000f800: 2020 2020 2020 696e 7661 6c69 645f 6e65        invalid_ne
-0000f810: 7463 6466 3a20 626f 6f6c 203d 2046 616c  tcdf: bool = Fal
-0000f820: 7365 2c0a 2020 2020 2920 2d3e 2062 7974  se,.    ) -> byt
-0000f830: 6573 207c 2044 656c 6179 6564 207c 204e  es | Delayed | N
-0000f840: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
-0000f850: 5772 6974 6520 6461 7461 7365 7420 636f  Write dataset co
-0000f860: 6e74 656e 7473 2074 6f20 6120 6e65 7443  ntents to a netC
-0000f870: 4446 2066 696c 652e 0a0a 2020 2020 2020  DF file...      
-0000f880: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0000f890: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0000f8a0: 2020 2020 2020 2020 7061 7468 203a 2073          path : s
-0000f8b0: 7472 2c20 7061 7468 2d6c 696b 6520 6f72  tr, path-like or
-0000f8c0: 2066 696c 652d 6c69 6b65 2c20 6f70 7469   file-like, opti
-0000f8d0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0000f8e0: 2050 6174 6820 746f 2077 6869 6368 2074   Path to which t
-0000f8f0: 6f20 7361 7665 2074 6869 7320 6461 7461  o save this data
-0000f900: 7365 742e 2046 696c 652d 6c69 6b65 206f  set. File-like o
-0000f910: 626a 6563 7473 2061 7265 206f 6e6c 790a  bjects are only.
-0000f920: 2020 2020 2020 2020 2020 2020 7375 7070              supp
-0000f930: 6f72 7465 6420 6279 2074 6865 2073 6369  orted by the sci
-0000f940: 7079 2065 6e67 696e 652e 2049 6620 6e6f  py engine. If no
-0000f950: 2070 6174 6820 6973 2070 726f 7669 6465   path is provide
-0000f960: 642c 2074 6869 730a 2020 2020 2020 2020  d, this.        
-0000f970: 2020 2020 6675 6e63 7469 6f6e 2072 6574      function ret
-0000f980: 7572 6e73 2074 6865 2072 6573 756c 7469  urns the resulti
-0000f990: 6e67 206e 6574 4344 4620 6669 6c65 2061  ng netCDF file a
-0000f9a0: 7320 6279 7465 733b 2069 6e20 7468 6973  s bytes; in this
-0000f9b0: 2063 6173 652c 0a20 2020 2020 2020 2020   case,.         
-0000f9c0: 2020 2077 6520 6e65 6564 2074 6f20 7573     we need to us
-0000f9d0: 6520 7363 6970 792c 2077 6869 6368 2064  e scipy, which d
-0000f9e0: 6f65 7320 6e6f 7420 7375 7070 6f72 7420  oes not support 
-0000f9f0: 6e65 7443 4446 2076 6572 7369 6f6e 2034  netCDF version 4
-0000fa00: 2028 7468 650a 2020 2020 2020 2020 2020   (the.          
-0000fa10: 2020 6465 6661 756c 7420 666f 726d 6174    default format
-0000fa20: 2062 6563 6f6d 6573 204e 4554 4344 4633   becomes NETCDF3
-0000fa30: 5f36 3442 4954 292e 0a20 2020 2020 2020  _64BIT)..       
-0000fa40: 206d 6f64 6520 3a20 7b22 7722 2c20 2261   mode : {"w", "a
-0000fa50: 227d 2c20 6465 6661 756c 743a 2022 7722  "}, default: "w"
-0000fa60: 0a20 2020 2020 2020 2020 2020 2057 7269  .            Wri
-0000fa70: 7465 2028 2777 2729 206f 7220 6170 7065  te ('w') or appe
-0000fa80: 6e64 2028 2761 2729 206d 6f64 652e 2049  nd ('a') mode. I
-0000fa90: 6620 6d6f 6465 3d27 7727 2c20 616e 7920  f mode='w', any 
-0000faa0: 6578 6973 7469 6e67 2066 696c 6520 6174  existing file at
-0000fab0: 0a20 2020 2020 2020 2020 2020 2074 6869  .            thi
-0000fac0: 7320 6c6f 6361 7469 6f6e 2077 696c 6c20  s location will 
-0000fad0: 6265 206f 7665 7277 7269 7474 656e 2e20  be overwritten. 
-0000fae0: 4966 206d 6f64 653d 2761 272c 2065 7869  If mode='a', exi
-0000faf0: 7374 696e 6720 7661 7269 6162 6c65 730a  sting variables.
-0000fb00: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
-0000fb10: 2062 6520 6f76 6572 7772 6974 7465 6e2e   be overwritten.
-0000fb20: 0a20 2020 2020 2020 2066 6f72 6d61 7420  .        format 
-0000fb30: 3a20 7b22 4e45 5443 4446 3422 2c20 224e  : {"NETCDF4", "N
-0000fb40: 4554 4344 4634 5f43 4c41 5353 4943 222c  ETCDF4_CLASSIC",
-0000fb50: 2022 4e45 5443 4446 335f 3634 4249 5422   "NETCDF3_64BIT"
-0000fb60: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
-0000fb70: 2020 2020 2020 224e 4554 4344 4633 5f43        "NETCDF3_C
-0000fb80: 4c41 5353 4943 227d 2c20 6f70 7469 6f6e  LASSIC"}, option
-0000fb90: 616c 0a20 2020 2020 2020 2020 2020 2046  al.            F
-0000fba0: 696c 6520 666f 726d 6174 2066 6f72 2074  ile format for t
-0000fbb0: 6865 2072 6573 756c 7469 6e67 206e 6574  he resulting net
-0000fbc0: 4344 4620 6669 6c65 3a0a 0a20 2020 2020  CDF file:..     
-0000fbd0: 2020 2020 2020 202a 204e 4554 4344 4634         * NETCDF4
-0000fbe0: 3a20 4461 7461 2069 7320 7374 6f72 6564  : Data is stored
-0000fbf0: 2069 6e20 616e 2048 4446 3520 6669 6c65   in an HDF5 file
-0000fc00: 2c20 7573 696e 6720 6e65 7443 4446 3420  , using netCDF4 
-0000fc10: 4150 490a 2020 2020 2020 2020 2020 2020  API.            
-0000fc20: 2020 6665 6174 7572 6573 2e0a 2020 2020    features..    
-0000fc30: 2020 2020 2020 2020 2a20 4e45 5443 4446          * NETCDF
-0000fc40: 345f 434c 4153 5349 433a 2044 6174 6120  4_CLASSIC: Data 
-0000fc50: 6973 2073 746f 7265 6420 696e 2061 6e20  is stored in an 
-0000fc60: 4844 4635 2066 696c 652c 2075 7369 6e67  HDF5 file, using
-0000fc70: 206f 6e6c 790a 2020 2020 2020 2020 2020   only.          
-0000fc80: 2020 2020 6e65 7443 4446 2033 2063 6f6d      netCDF 3 com
-0000fc90: 7061 7469 626c 6520 4150 4920 6665 6174  patible API feat
-0000fca0: 7572 6573 2e0a 2020 2020 2020 2020 2020  ures..          
-0000fcb0: 2020 2a20 4e45 5443 4446 335f 3634 4249    * NETCDF3_64BI
-0000fcc0: 543a 2036 342d 6269 7420 6f66 6673 6574  T: 64-bit offset
-0000fcd0: 2076 6572 7369 6f6e 206f 6620 7468 6520   version of the 
-0000fce0: 6e65 7443 4446 2033 2066 696c 6520 666f  netCDF 3 file fo
-0000fcf0: 726d 6174 2c0a 2020 2020 2020 2020 2020  rmat,.          
-0000fd00: 2020 2020 7768 6963 6820 6675 6c6c 7920      which fully 
-0000fd10: 7375 7070 6f72 7473 2032 2b20 4742 2066  supports 2+ GB f
-0000fd20: 696c 6573 2c20 6275 7420 6973 206f 6e6c  iles, but is onl
-0000fd30: 7920 636f 6d70 6174 6962 6c65 2077 6974  y compatible wit
-0000fd40: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
-0000fd50: 636c 6965 6e74 7320 6c69 6e6b 6564 2061  clients linked a
-0000fd60: 6761 696e 7374 206e 6574 4344 4620 7665  gainst netCDF ve
-0000fd70: 7273 696f 6e20 332e 362e 3020 6f72 206c  rsion 3.6.0 or l
-0000fd80: 6174 6572 2e0a 2020 2020 2020 2020 2020  ater..          
-0000fd90: 2020 2a20 4e45 5443 4446 335f 434c 4153    * NETCDF3_CLAS
-0000fda0: 5349 433a 2054 6865 2063 6c61 7373 6963  SIC: The classic
-0000fdb0: 206e 6574 4344 4620 3320 6669 6c65 2066   netCDF 3 file f
-0000fdc0: 6f72 6d61 742e 2049 7420 646f 6573 206e  ormat. It does n
-0000fdd0: 6f74 0a20 2020 2020 2020 2020 2020 2020  ot.             
-0000fde0: 2068 616e 646c 6520 322b 2047 4220 6669   handle 2+ GB fi
-0000fdf0: 6c65 7320 7665 7279 2077 656c 6c2e 0a0a  les very well...
-0000fe00: 2020 2020 2020 2020 2020 2020 416c 6c20              All 
-0000fe10: 666f 726d 6174 7320 6172 6520 7375 7070  formats are supp
-0000fe20: 6f72 7465 6420 6279 2074 6865 206e 6574  orted by the net
-0000fe30: 4344 4634 2d70 7974 686f 6e20 6c69 6272  CDF4-python libr
-0000fe40: 6172 792e 0a20 2020 2020 2020 2020 2020  ary..           
-0000fe50: 2073 6369 7079 2e69 6f2e 6e65 7463 6466   scipy.io.netcdf
-0000fe60: 206f 6e6c 7920 7375 7070 6f72 7473 2074   only supports t
-0000fe70: 6865 206c 6173 7420 7477 6f20 666f 726d  he last two form
-0000fe80: 6174 732e 0a0a 2020 2020 2020 2020 2020  ats...          
-0000fe90: 2020 5468 6520 6465 6661 756c 7420 666f    The default fo
-0000fea0: 726d 6174 2069 7320 4e45 5443 4446 3420  rmat is NETCDF4 
-0000feb0: 6966 2079 6f75 2061 7265 2073 6176 696e  if you are savin
-0000fec0: 6720 6120 6669 6c65 2074 6f20 6469 736b  g a file to disk
-0000fed0: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-0000fee0: 2068 6176 6520 7468 6520 6e65 7443 4446   have the netCDF
-0000fef0: 342d 7079 7468 6f6e 206c 6962 7261 7279  4-python library
-0000ff00: 2061 7661 696c 6162 6c65 2e20 4f74 6865   available. Othe
-0000ff10: 7277 6973 652c 2078 6172 7261 7920 6661  rwise, xarray fa
-0000ff20: 6c6c 730a 2020 2020 2020 2020 2020 2020  lls.            
-0000ff30: 6261 636b 2074 6f20 7573 696e 6720 7363  back to using sc
-0000ff40: 6970 7920 746f 2077 7269 7465 206e 6574  ipy to write net
-0000ff50: 4344 4620 6669 6c65 7320 616e 6420 6465  CDF files and de
-0000ff60: 6661 756c 7473 2074 6f20 7468 650a 2020  faults to the.  
-0000ff70: 2020 2020 2020 2020 2020 4e45 5443 4446            NETCDF
-0000ff80: 335f 3634 4249 5420 666f 726d 6174 2028  3_64BIT format (
-0000ff90: 7363 6970 7920 646f 6573 206e 6f74 2073  scipy does not s
-0000ffa0: 7570 706f 7274 206e 6574 4344 4634 292e  upport netCDF4).
-0000ffb0: 0a20 2020 2020 2020 2067 726f 7570 203a  .        group :
-0000ffc0: 2073 7472 2c20 6f70 7469 6f6e 616c 0a20   str, optional. 
-0000ffd0: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
-0000ffe0: 746f 2074 6865 206e 6574 4344 4634 2067  to the netCDF4 g
-0000fff0: 726f 7570 2069 6e20 7468 6520 6769 7665  roup in the give
-00010000: 6e20 6669 6c65 2074 6f20 6f70 656e 2028  n file to open (
-00010010: 6f6e 6c79 2077 6f72 6b73 2066 6f72 0a20  only works for. 
-00010020: 2020 2020 2020 2020 2020 2066 6f72 6d61             forma
-00010030: 743d 274e 4554 4344 4634 2729 2e20 5468  t='NETCDF4'). Th
-00010040: 6520 6772 6f75 7028 7329 2077 696c 6c20  e group(s) will 
-00010050: 6265 2063 7265 6174 6564 2069 6620 6e65  be created if ne
-00010060: 6365 7373 6172 792e 0a20 2020 2020 2020  cessary..       
-00010070: 2065 6e67 696e 6520 3a20 7b22 6e65 7463   engine : {"netc
-00010080: 6466 3422 2c20 2273 6369 7079 222c 2022  df4", "scipy", "
-00010090: 6835 6e65 7463 6466 227d 2c20 6f70 7469  h5netcdf"}, opti
-000100a0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-000100b0: 2045 6e67 696e 6520 746f 2075 7365 2077   Engine to use w
-000100c0: 6865 6e20 7772 6974 696e 6720 6e65 7443  hen writing netC
-000100d0: 4446 2066 696c 6573 2e20 4966 206e 6f74  DF files. If not
-000100e0: 2070 726f 7669 6465 642c 2074 6865 0a20   provided, the. 
-000100f0: 2020 2020 2020 2020 2020 2064 6566 6175             defau
-00010100: 6c74 2065 6e67 696e 6520 6973 2063 686f  lt engine is cho
-00010110: 7365 6e20 6261 7365 6420 6f6e 2061 7661  sen based on ava
-00010120: 696c 6162 6c65 2064 6570 656e 6465 6e63  ilable dependenc
-00010130: 6965 732c 2077 6974 6820 610a 2020 2020  ies, with a.    
-00010140: 2020 2020 2020 2020 7072 6566 6572 656e          preferen
-00010150: 6365 2066 6f72 2027 6e65 7463 6466 3427  ce for 'netcdf4'
-00010160: 2069 6620 7772 6974 696e 6720 746f 2061   if writing to a
-00010170: 2066 696c 6520 6f6e 2064 6973 6b2e 0a20   file on disk.. 
-00010180: 2020 2020 2020 2065 6e63 6f64 696e 6720         encoding 
-00010190: 3a20 6469 6374 2c20 6f70 7469 6f6e 616c  : dict, optional
-000101a0: 0a20 2020 2020 2020 2020 2020 204e 6573  .            Nes
-000101b0: 7465 6420 6469 6374 696f 6e61 7279 2077  ted dictionary w
-000101c0: 6974 6820 7661 7269 6162 6c65 206e 616d  ith variable nam
-000101d0: 6573 2061 7320 6b65 7973 2061 6e64 2064  es as keys and d
-000101e0: 6963 7469 6f6e 6172 6965 7320 6f66 0a20  ictionaries of. 
-000101f0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-00010200: 626c 6520 7370 6563 6966 6963 2065 6e63  ble specific enc
-00010210: 6f64 696e 6773 2061 7320 7661 6c75 6573  odings as values
-00010220: 2c20 652e 672e 2c0a 2020 2020 2020 2020  , e.g.,.        
-00010230: 2020 2020 6060 7b22 6d79 5f76 6172 6961      ``{"my_varia
-00010240: 626c 6522 3a20 7b22 6474 7970 6522 3a20  ble": {"dtype": 
-00010250: 2269 6e74 3136 222c 2022 7363 616c 655f  "int16", "scale_
-00010260: 6661 6374 6f72 223a 2030 2e31 2c0a 2020  factor": 0.1,.  
-00010270: 2020 2020 2020 2020 2020 227a 6c69 6222            "zlib"
-00010280: 3a20 5472 7565 7d2c 202e 2e2e 7d60 600a  : True}, ...}``.
-00010290: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-000102a0: 2060 6835 6e65 7463 6466 6020 656e 6769   `h5netcdf` engi
-000102b0: 6e65 2073 7570 706f 7274 7320 626f 7468  ne supports both
-000102c0: 2074 6865 204e 6574 4344 4634 2d73 7479   the NetCDF4-sty
-000102d0: 6c65 2063 6f6d 7072 6573 7369 6f6e 0a20  le compression. 
-000102e0: 2020 2020 2020 2020 2020 2065 6e63 6f64             encod
-000102f0: 696e 6720 7061 7261 6d65 7465 7273 2060  ing parameters `
-00010300: 607b 227a 6c69 6222 3a20 5472 7565 2c20  `{"zlib": True, 
-00010310: 2263 6f6d 706c 6576 656c 223a 2039 7d60  "complevel": 9}`
-00010320: 6020 616e 6420 7468 6520 6835 7079 0a20  ` and the h5py. 
-00010330: 2020 2020 2020 2020 2020 206f 6e65 7320             ones 
-00010340: 6060 7b22 636f 6d70 7265 7373 696f 6e22  ``{"compression"
-00010350: 3a20 2267 7a69 7022 2c20 2263 6f6d 7072  : "gzip", "compr
-00010360: 6573 7369 6f6e 5f6f 7074 7322 3a20 397d  ession_opts": 9}
-00010370: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
-00010380: 5468 6973 2061 6c6c 6f77 7320 7573 696e  This allows usin
-00010390: 6720 616e 7920 636f 6d70 7265 7373 696f  g any compressio
-000103a0: 6e20 706c 7567 696e 2069 6e73 7461 6c6c  n plugin install
-000103b0: 6564 2069 6e20 7468 6520 4844 4635 0a20  ed in the HDF5. 
-000103c0: 2020 2020 2020 2020 2020 206c 6962 7261             libra
-000103d0: 7279 2c20 652e 672e 204c 5a46 2e0a 0a20  ry, e.g. LZF... 
-000103e0: 2020 2020 2020 2075 6e6c 696d 6974 6564         unlimited
-000103f0: 5f64 696d 7320 3a20 6974 6572 6162 6c65  _dims : iterable
-00010400: 206f 6620 6861 7368 6162 6c65 2c20 6f70   of hashable, op
-00010410: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00010420: 2020 2044 696d 656e 7369 6f6e 2873 2920     Dimension(s) 
-00010430: 7468 6174 2073 686f 756c 6420 6265 2073  that should be s
-00010440: 6572 6961 6c69 7a65 6420 6173 2075 6e6c  erialized as unl
-00010450: 696d 6974 6564 2064 696d 656e 7369 6f6e  imited dimension
-00010460: 732e 0a20 2020 2020 2020 2020 2020 2042  s..            B
-00010470: 7920 6465 6661 756c 742c 206e 6f20 6469  y default, no di
-00010480: 6d65 6e73 696f 6e73 2061 7265 2074 7265  mensions are tre
-00010490: 6174 6564 2061 7320 756e 6c69 6d69 7465  ated as unlimite
-000104a0: 6420 6469 6d65 6e73 696f 6e73 2e0a 2020  d dimensions..  
-000104b0: 2020 2020 2020 2020 2020 4e6f 7465 2074            Note t
-000104c0: 6861 7420 756e 6c69 6d69 7465 645f 6469  hat unlimited_di
-000104d0: 6d73 206d 6179 2061 6c73 6f20 6265 2073  ms may also be s
-000104e0: 6574 2076 6961 0a20 2020 2020 2020 2020  et via.         
-000104f0: 2020 2060 6064 6174 6173 6574 2e65 6e63     ``dataset.enc
-00010500: 6f64 696e 675b 2275 6e6c 696d 6974 6564  oding["unlimited
-00010510: 5f64 696d 7322 5d60 602e 0a20 2020 2020  _dims"]``..     
-00010520: 2020 2063 6f6d 7075 7465 3a20 626f 6f6c     compute: bool
-00010530: 2c20 6465 6661 756c 743a 2054 7275 650a  , default: True.
-00010540: 2020 2020 2020 2020 2020 2020 4966 2074              If t
-00010550: 7275 6520 636f 6d70 7574 6520 696d 6d65  rue compute imme
-00010560: 6469 6174 656c 792c 206f 7468 6572 7769  diately, otherwi
-00010570: 7365 2072 6574 7572 6e20 610a 2020 2020  se return a.    
-00010580: 2020 2020 2020 2020 6060 6461 736b 2e64          ``dask.d
-00010590: 656c 6179 6564 2e44 656c 6179 6564 6060  elayed.Delayed``
-000105a0: 206f 626a 6563 7420 7468 6174 2063 616e   object that can
-000105b0: 2062 6520 636f 6d70 7574 6564 206c 6174   be computed lat
-000105c0: 6572 2e0a 2020 2020 2020 2020 696e 7661  er..        inva
-000105d0: 6c69 645f 6e65 7463 6466 3a20 626f 6f6c  lid_netcdf: bool
-000105e0: 2c20 6465 6661 756c 743a 2046 616c 7365  , default: False
-000105f0: 0a20 2020 2020 2020 2020 2020 204f 6e6c  .            Onl
-00010600: 7920 7661 6c69 6420 616c 6f6e 6720 7769  y valid along wi
-00010610: 7468 2060 6065 6e67 696e 653d 2268 356e  th ``engine="h5n
-00010620: 6574 6364 6622 6060 2e20 4966 2054 7275  etcdf"``. If Tru
-00010630: 652c 2061 6c6c 6f77 2077 7269 7469 6e67  e, allow writing
-00010640: 0a20 2020 2020 2020 2020 2020 2068 6466  .            hdf
-00010650: 3520 6669 6c65 7320 7768 6963 6820 6172  5 files which ar
-00010660: 6520 696e 7661 6c69 6420 6e65 7463 6466  e invalid netcdf
-00010670: 2061 7320 6465 7363 7269 6265 6420 696e   as described in
-00010680: 0a20 2020 2020 2020 2020 2020 2068 7474  .            htt
-00010690: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-000106a0: 6835 6e65 7463 6466 2f68 356e 6574 6364  h5netcdf/h5netcd
-000106b0: 662e 0a0a 2020 2020 2020 2020 5265 7475  f...        Retu
-000106c0: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-000106d0: 2d2d 2d0a 2020 2020 2020 2020 2020 2020  ---.            
-000106e0: 2a20 6060 6279 7465 7360 6020 6966 2070  * ``bytes`` if p
-000106f0: 6174 6820 6973 204e 6f6e 650a 2020 2020  ath is None.    
-00010700: 2020 2020 2020 2020 2a20 6060 6461 736b          * ``dask
-00010710: 2e64 656c 6179 6564 2e44 656c 6179 6564  .delayed.Delayed
-00010720: 6060 2069 6620 636f 6d70 7574 6520 6973  `` if compute is
-00010730: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
-00010740: 2020 202a 204e 6f6e 6520 6f74 6865 7277     * None otherw
-00010750: 6973 650a 0a20 2020 2020 2020 2053 6565  ise..        See
-00010760: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00010770: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-00010780: 6174 6141 7272 6179 2e74 6f5f 6e65 7463  ataArray.to_netc
-00010790: 6466 0a20 2020 2020 2020 2022 2222 0a20  df.        """. 
-000107a0: 2020 2020 2020 2069 6620 656e 636f 6469         if encodi
-000107b0: 6e67 2069 7320 4e6f 6e65 3a0a 2020 2020  ng is None:.    
-000107c0: 2020 2020 2020 2020 656e 636f 6469 6e67          encoding
-000107d0: 203d 207b 7d0a 2020 2020 2020 2020 6672   = {}.        fr
-000107e0: 6f6d 2078 6172 7261 792e 6261 636b 656e  om xarray.backen
-000107f0: 6473 2e61 7069 2069 6d70 6f72 7420 746f  ds.api import to
-00010800: 5f6e 6574 6364 660a 0a20 2020 2020 2020  _netcdf..       
-00010810: 2072 6574 7572 6e20 746f 5f6e 6574 6364   return to_netcd
-00010820: 6628 2020 2320 7479 7065 3a20 6967 6e6f  f(  # type: igno
-00010830: 7265 2020 2320 6d79 7079 2063 616e 6e6f  re  # mypy canno
-00010840: 7420 7265 736f 6c76 6520 7468 6520 6f76  t resolve the ov
-00010850: 6572 6c6f 6164 733a 280a 2020 2020 2020  erloads:(.      
-00010860: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00010870: 2020 2020 2020 2020 7061 7468 2c0a 2020          path,.  
-00010880: 2020 2020 2020 2020 2020 6d6f 6465 3d6d            mode=m
-00010890: 6f64 652c 0a20 2020 2020 2020 2020 2020  ode,.           
-000108a0: 2066 6f72 6d61 743d 666f 726d 6174 2c0a   format=format,.
-000108b0: 2020 2020 2020 2020 2020 2020 6772 6f75              grou
-000108c0: 703d 6772 6f75 702c 0a20 2020 2020 2020  p=group,.       
-000108d0: 2020 2020 2065 6e67 696e 653d 656e 6769       engine=engi
-000108e0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
-000108f0: 656e 636f 6469 6e67 3d65 6e63 6f64 696e  encoding=encodin
-00010900: 672c 0a20 2020 2020 2020 2020 2020 2075  g,.            u
-00010910: 6e6c 696d 6974 6564 5f64 696d 733d 756e  nlimited_dims=un
-00010920: 6c69 6d69 7465 645f 6469 6d73 2c0a 2020  limited_dims,.  
-00010930: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
-00010940: 653d 636f 6d70 7574 652c 0a20 2020 2020  e=compute,.     
-00010950: 2020 2020 2020 206d 756c 7469 6669 6c65         multifile
-00010960: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00010970: 2020 2020 696e 7661 6c69 645f 6e65 7463      invalid_netc
-00010980: 6466 3d69 6e76 616c 6964 5f6e 6574 6364  df=invalid_netcd
-00010990: 662c 0a20 2020 2020 2020 2029 0a0a 2020  f,.        )..  
-000109a0: 2020 2320 636f 6d70 7574 653d 5472 7565    # compute=True
-000109b0: 2028 6465 6661 756c 7429 2072 6574 7572   (default) retur
-000109c0: 6e73 205a 6172 7253 746f 7265 0a20 2020  ns ZarrStore.   
-000109d0: 2040 6f76 6572 6c6f 6164 0a20 2020 2064   @overload.    d
-000109e0: 6566 2074 6f5f 7a61 7272 280a 2020 2020  ef to_zarr(.    
-000109f0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00010a00: 2020 7374 6f72 653a 204d 7574 6162 6c65    store: Mutable
-00010a10: 4d61 7070 696e 6720 7c20 7374 7220 7c20  Mapping | str | 
-00010a20: 5061 7468 4c69 6b65 5b73 7472 5d20 7c20  PathLike[str] | 
-00010a30: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-00010a40: 2020 2020 2063 6875 6e6b 5f73 746f 7265       chunk_store
-00010a50: 3a20 4d75 7461 626c 654d 6170 7069 6e67  : MutableMapping
-00010a60: 207c 2073 7472 207c 2050 6174 684c 696b   | str | PathLik
-00010a70: 6520 7c20 4e6f 6e65 203d 204e 6f6e 652c  e | None = None,
-00010a80: 0a20 2020 2020 2020 206d 6f64 653a 204c  .        mode: L
-00010a90: 6974 6572 616c 5b22 7722 2c20 2277 2d22  iteral["w", "w-"
-00010aa0: 2c20 2261 222c 2022 722b 222c 204e 6f6e  , "a", "r+", Non
-00010ab0: 655d 203d 204e 6f6e 652c 0a20 2020 2020  e] = None,.     
-00010ac0: 2020 2073 796e 6368 726f 6e69 7a65 723d     synchronizer=
-00010ad0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6772  None,.        gr
-00010ae0: 6f75 703a 2073 7472 207c 204e 6f6e 6520  oup: str | None 
-00010af0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00010b00: 656e 636f 6469 6e67 3a20 4d61 7070 696e  encoding: Mappin
-00010b10: 6720 7c20 4e6f 6e65 203d 204e 6f6e 652c  g | None = None,
-00010b20: 0a20 2020 2020 2020 2063 6f6d 7075 7465  .        compute
-00010b30: 3a20 4c69 7465 7261 6c5b 5472 7565 5d20  : Literal[True] 
-00010b40: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
-00010b50: 636f 6e73 6f6c 6964 6174 6564 3a20 626f  consolidated: bo
-00010b60: 6f6c 207c 204e 6f6e 6520 3d20 4e6f 6e65  ol | None = None
-00010b70: 2c0a 2020 2020 2020 2020 6170 7065 6e64  ,.        append
-00010b80: 5f64 696d 3a20 4861 7368 6162 6c65 207c  _dim: Hashable |
-00010b90: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-00010ba0: 2020 2020 2020 7265 6769 6f6e 3a20 4d61        region: Ma
-00010bb0: 7070 696e 675b 7374 722c 2073 6c69 6365  pping[str, slice
-00010bc0: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-00010bd0: 0a20 2020 2020 2020 2073 6166 655f 6368  .        safe_ch
-00010be0: 756e 6b73 3a20 626f 6f6c 203d 2054 7275  unks: bool = Tru
-00010bf0: 652c 0a20 2020 2020 2020 2073 746f 7261  e,.        stora
-00010c00: 6765 5f6f 7074 696f 6e73 3a20 6469 6374  ge_options: dict
-00010c10: 5b73 7472 2c20 7374 725d 207c 204e 6f6e  [str, str] | Non
-00010c20: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-00010c30: 2020 7a61 7272 5f76 6572 7369 6f6e 3a20    zarr_version: 
-00010c40: 696e 7420 7c20 4e6f 6e65 203d 204e 6f6e  int | None = Non
-00010c50: 652c 0a20 2020 2020 2020 2063 6875 6e6b  e,.        chunk
-00010c60: 6d61 6e61 6765 725f 7374 6f72 655f 6b77  manager_store_kw
-00010c70: 6172 6773 3a20 6469 6374 5b73 7472 2c20  args: dict[str, 
-00010c80: 416e 795d 207c 204e 6f6e 6520 3d20 4e6f  Any] | None = No
-00010c90: 6e65 2c0a 2020 2020 2920 2d3e 205a 6172  ne,.    ) -> Zar
-00010ca0: 7253 746f 7265 3a0a 2020 2020 2020 2020  rStore:.        
-00010cb0: 2e2e 2e0a 0a20 2020 2023 2063 6f6d 7075  .....    # compu
-00010cc0: 7465 3d46 616c 7365 2072 6574 7572 6e73  te=False returns
-00010cd0: 2064 6173 6b2e 4465 6c61 7965 640a 2020   dask.Delayed.  
-00010ce0: 2020 406f 7665 726c 6f61 640a 2020 2020    @overload.    
-00010cf0: 6465 6620 746f 5f7a 6172 7228 0a20 2020  def to_zarr(.   
-00010d00: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00010d10: 2020 2073 746f 7265 3a20 4d75 7461 626c     store: Mutabl
-00010d20: 654d 6170 7069 6e67 207c 2073 7472 207c  eMapping | str |
-00010d30: 2050 6174 684c 696b 655b 7374 725d 207c   PathLike[str] |
-00010d40: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-00010d50: 2020 2020 2020 6368 756e 6b5f 7374 6f72        chunk_stor
-00010d60: 653a 204d 7574 6162 6c65 4d61 7070 696e  e: MutableMappin
-00010d70: 6720 7c20 7374 7220 7c20 5061 7468 4c69  g | str | PathLi
-00010d80: 6b65 207c 204e 6f6e 6520 3d20 4e6f 6e65  ke | None = None
-00010d90: 2c0a 2020 2020 2020 2020 6d6f 6465 3a20  ,.        mode: 
-00010da0: 4c69 7465 7261 6c5b 2277 222c 2022 772d  Literal["w", "w-
-00010db0: 222c 2022 6122 2c20 2272 2b22 2c20 4e6f  ", "a", "r+", No
-00010dc0: 6e65 5d20 3d20 4e6f 6e65 2c0a 2020 2020  ne] = None,.    
-00010dd0: 2020 2020 7379 6e63 6872 6f6e 697a 6572      synchronizer
-00010de0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2067  =None,.        g
-00010df0: 726f 7570 3a20 7374 7220 7c20 4e6f 6e65  roup: str | None
-00010e00: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00010e10: 2065 6e63 6f64 696e 673a 204d 6170 7069   encoding: Mappi
-00010e20: 6e67 207c 204e 6f6e 6520 3d20 4e6f 6e65  ng | None = None
-00010e30: 2c0a 2020 2020 2020 2020 2a2c 0a20 2020  ,.        *,.   
-00010e40: 2020 2020 2063 6f6d 7075 7465 3a20 4c69       compute: Li
-00010e50: 7465 7261 6c5b 4661 6c73 655d 2c0a 2020  teral[False],.  
-00010e60: 2020 2020 2020 636f 6e73 6f6c 6964 6174        consolidat
-00010e70: 6564 3a20 626f 6f6c 207c 204e 6f6e 6520  ed: bool | None 
-00010e80: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00010e90: 6170 7065 6e64 5f64 696d 3a20 4861 7368  append_dim: Hash
-00010ea0: 6162 6c65 207c 204e 6f6e 6520 3d20 4e6f  able | None = No
-00010eb0: 6e65 2c0a 2020 2020 2020 2020 7265 6769  ne,.        regi
-00010ec0: 6f6e 3a20 4d61 7070 696e 675b 7374 722c  on: Mapping[str,
-00010ed0: 2073 6c69 6365 5d20 7c20 4e6f 6e65 203d   slice] | None =
-00010ee0: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
-00010ef0: 6166 655f 6368 756e 6b73 3a20 626f 6f6c  afe_chunks: bool
-00010f00: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-00010f10: 2073 746f 7261 6765 5f6f 7074 696f 6e73   storage_options
-00010f20: 3a20 6469 6374 5b73 7472 2c20 7374 725d  : dict[str, str]
-00010f30: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
-00010f40: 2020 2020 2020 2020 7a61 7272 5f76 6572          zarr_ver
-00010f50: 7369 6f6e 3a20 696e 7420 7c20 4e6f 6e65  sion: int | None
-00010f60: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00010f70: 2063 6875 6e6b 6d61 6e61 6765 725f 7374   chunkmanager_st
-00010f80: 6f72 655f 6b77 6172 6773 3a20 6469 6374  ore_kwargs: dict
-00010f90: 5b73 7472 2c20 416e 795d 207c 204e 6f6e  [str, Any] | Non
-00010fa0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2920  e = None,.    ) 
-00010fb0: 2d3e 2044 656c 6179 6564 3a0a 2020 2020  -> Delayed:.    
-00010fc0: 2020 2020 2e2e 2e0a 0a20 2020 2064 6566      .....    def
-00010fd0: 2074 6f5f 7a61 7272 280a 2020 2020 2020   to_zarr(.      
-00010fe0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00010ff0: 7374 6f72 653a 204d 7574 6162 6c65 4d61  store: MutableMa
-00011000: 7070 696e 6720 7c20 7374 7220 7c20 5061  pping | str | Pa
-00011010: 7468 4c69 6b65 5b73 7472 5d20 7c20 4e6f  thLike[str] | No
-00011020: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
-00011030: 2020 2063 6875 6e6b 5f73 746f 7265 3a20     chunk_store: 
-00011040: 4d75 7461 626c 654d 6170 7069 6e67 207c  MutableMapping |
-00011050: 2073 7472 207c 2050 6174 684c 696b 6520   str | PathLike 
-00011060: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00011070: 2020 2020 2020 206d 6f64 653a 204c 6974         mode: Lit
-00011080: 6572 616c 5b22 7722 2c20 2277 2d22 2c20  eral["w", "w-", 
-00011090: 2261 222c 2022 722b 222c 204e 6f6e 655d  "a", "r+", None]
-000110a0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000110b0: 2073 796e 6368 726f 6e69 7a65 723d 4e6f   synchronizer=No
-000110c0: 6e65 2c0a 2020 2020 2020 2020 6772 6f75  ne,.        grou
-000110d0: 703a 2073 7472 207c 204e 6f6e 6520 3d20  p: str | None = 
-000110e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 656e  None,.        en
-000110f0: 636f 6469 6e67 3a20 4d61 7070 696e 6720  coding: Mapping 
-00011100: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00011110: 2020 2020 2020 2063 6f6d 7075 7465 3a20         compute: 
-00011120: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-00011130: 2020 2020 2063 6f6e 736f 6c69 6461 7465       consolidate
-00011140: 643a 2062 6f6f 6c20 7c20 4e6f 6e65 203d  d: bool | None =
-00011150: 204e 6f6e 652c 0a20 2020 2020 2020 2061   None,.        a
-00011160: 7070 656e 645f 6469 6d3a 2048 6173 6861  ppend_dim: Hasha
-00011170: 626c 6520 7c20 4e6f 6e65 203d 204e 6f6e  ble | None = Non
-00011180: 652c 0a20 2020 2020 2020 2072 6567 696f  e,.        regio
-00011190: 6e3a 204d 6170 7069 6e67 5b73 7472 2c20  n: Mapping[str, 
-000111a0: 736c 6963 655d 207c 204e 6f6e 6520 3d20  slice] | None = 
-000111b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7361  None,.        sa
-000111c0: 6665 5f63 6875 6e6b 733a 2062 6f6f 6c20  fe_chunks: bool 
-000111d0: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
-000111e0: 7374 6f72 6167 655f 6f70 7469 6f6e 733a  storage_options:
-000111f0: 2064 6963 745b 7374 722c 2073 7472 5d20   dict[str, str] 
-00011200: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00011210: 2020 2020 2020 207a 6172 725f 7665 7273         zarr_vers
-00011220: 696f 6e3a 2069 6e74 207c 204e 6f6e 6520  ion: int | None 
-00011230: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00011240: 6368 756e 6b6d 616e 6167 6572 5f73 746f  chunkmanager_sto
-00011250: 7265 5f6b 7761 7267 733a 2064 6963 745b  re_kwargs: dict[
-00011260: 7374 722c 2041 6e79 5d20 7c20 4e6f 6e65  str, Any] | None
-00011270: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
-00011280: 3e20 5a61 7272 5374 6f72 6520 7c20 4465  > ZarrStore | De
-00011290: 6c61 7965 643a 0a20 2020 2020 2020 2022  layed:.        "
-000112a0: 2222 5772 6974 6520 6461 7461 7365 7420  ""Write dataset 
-000112b0: 636f 6e74 656e 7473 2074 6f20 6120 7a61  contents to a za
-000112c0: 7272 2067 726f 7570 2e0a 0a20 2020 2020  rr group...     
-000112d0: 2020 205a 6172 7220 6368 756e 6b73 2061     Zarr chunks a
-000112e0: 7265 2064 6574 6572 6d69 6e65 6420 696e  re determined in
-000112f0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2077   the following w
-00011300: 6179 3a0a 0a20 2020 2020 2020 202d 2046  ay:..        - F
-00011310: 726f 6d20 7468 6520 6060 6368 756e 6b73  rom the ``chunks
-00011320: 6060 2061 7474 7269 6275 7465 2069 6e20  `` attribute in 
-00011330: 6561 6368 2076 6172 6961 626c 6527 7320  each variable's 
-00011340: 6060 656e 636f 6469 6e67 6060 0a20 2020  ``encoding``.   
-00011350: 2020 2020 2020 2028 6361 6e20 6265 2073         (can be s
-00011360: 6574 2076 6961 2060 4461 7461 7365 742e  et via `Dataset.
-00011370: 6368 756e 6b60 292e 0a20 2020 2020 2020  chunk`)..       
-00011380: 202d 2049 6620 7468 6520 7661 7269 6162   - If the variab
-00011390: 6c65 2069 7320 6120 4461 736b 2061 7272  le is a Dask arr
-000113a0: 6179 2c20 6672 6f6d 2074 6865 2064 6173  ay, from the das
-000113b0: 6b20 6368 756e 6b73 0a20 2020 2020 2020  k chunks.       
-000113c0: 202d 2049 6620 6e65 6974 6865 7220 4461   - If neither Da
-000113d0: 736b 2063 6875 6e6b 7320 6e6f 7220 656e  sk chunks nor en
-000113e0: 636f 6469 6e67 2063 6875 6e6b 7320 6172  coding chunks ar
-000113f0: 6520 7072 6573 656e 742c 2063 6875 6e6b  e present, chunk
-00011400: 7320 7769 6c6c 0a20 2020 2020 2020 2020  s will.         
-00011410: 2062 6520 6465 7465 726d 696e 6564 2061   be determined a
-00011420: 7574 6f6d 6174 6963 616c 6c79 2062 7920  utomatically by 
-00011430: 5a61 7272 0a20 2020 2020 2020 202d 2049  Zarr.        - I
-00011440: 6620 626f 7468 2044 6173 6b20 6368 756e  f both Dask chun
-00011450: 6b73 2061 6e64 2065 6e63 6f64 696e 6720  ks and encoding 
-00011460: 6368 756e 6b73 2061 7265 2070 7265 7365  chunks are prese
-00011470: 6e74 2c20 656e 636f 6469 6e67 2063 6875  nt, encoding chu
-00011480: 6e6b 730a 2020 2020 2020 2020 2020 7769  nks.          wi
-00011490: 6c6c 2062 6520 7573 6564 2c20 7072 6f76  ll be used, prov
-000114a0: 6964 6564 2074 6861 7420 7468 6572 6520  ided that there 
-000114b0: 6973 2061 206d 616e 792d 746f 2d6f 6e65  is a many-to-one
-000114c0: 2072 656c 6174 696f 6e73 6869 7020 6265   relationship be
-000114d0: 7477 6565 6e0a 2020 2020 2020 2020 2020  tween.          
-000114e0: 656e 636f 6469 6e67 2063 6875 6e6b 7320  encoding chunks 
-000114f0: 616e 6420 6461 736b 2063 6875 6e6b 7320  and dask chunks 
-00011500: 2869 2e65 2e20 4461 736b 2063 6875 6e6b  (i.e. Dask chunk
-00011510: 7320 6172 6520 6269 6767 6572 2074 6861  s are bigger tha
-00011520: 6e20 616e 640a 2020 2020 2020 2020 2020  n and.          
-00011530: 6576 656e 6c79 2064 6976 6964 6520 656e  evenly divide en
-00011540: 636f 6469 6e67 2063 6875 6e6b 7329 3b20  coding chunks); 
-00011550: 6f74 6865 7277 6973 6520 7261 6973 6520  otherwise raise 
-00011560: 6120 6060 5661 6c75 6545 7272 6f72 6060  a ``ValueError``
-00011570: 2e0a 2020 2020 2020 2020 2020 5468 6973  ..          This
-00011580: 2072 6573 7472 6963 7469 6f6e 2065 6e73   restriction ens
-00011590: 7572 6573 2074 6861 7420 6e6f 2073 796e  ures that no syn
-000115a0: 6368 726f 6e69 7a61 7469 6f6e 202f 206c  chronization / l
-000115b0: 6f63 6b73 2061 7265 2072 6571 7569 7265  ocks are require
-000115c0: 640a 2020 2020 2020 2020 2020 7768 656e  d.          when
-000115d0: 2077 7269 7469 6e67 2e20 546f 2064 6973   writing. To dis
-000115e0: 6162 6c65 2074 6869 7320 7265 7374 7269  able this restri
-000115f0: 6374 696f 6e2c 2075 7365 2060 6073 6166  ction, use ``saf
-00011600: 655f 6368 756e 6b73 3d46 616c 7365 6060  e_chunks=False``
-00011610: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00011620: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00011630: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00011640: 2073 746f 7265 203a 204d 7574 6162 6c65   store : Mutable
-00011650: 4d61 7070 696e 672c 2073 7472 206f 7220  Mapping, str or 
-00011660: 7061 7468 2d6c 696b 652c 206f 7074 696f  path-like, optio
-00011670: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00011680: 5374 6f72 6520 6f72 2070 6174 6820 746f  Store or path to
-00011690: 2064 6972 6563 746f 7279 2069 6e20 6c6f   directory in lo
-000116a0: 6361 6c20 6f72 2072 656d 6f74 6520 6669  cal or remote fi
-000116b0: 6c65 2073 7973 7465 6d2e 0a20 2020 2020  le system..     
-000116c0: 2020 2063 6875 6e6b 5f73 746f 7265 203a     chunk_store :
-000116d0: 204d 7574 6162 6c65 4d61 7070 696e 672c   MutableMapping,
-000116e0: 2073 7472 206f 7220 7061 7468 2d6c 696b   str or path-lik
-000116f0: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
-00011700: 2020 2020 2020 2020 5374 6f72 6520 6f72          Store or
-00011710: 2070 6174 6820 746f 2064 6972 6563 746f   path to directo
-00011720: 7279 2069 6e20 6c6f 6361 6c20 6f72 2072  ry in local or r
-00011730: 656d 6f74 6520 6669 6c65 2073 7973 7465  emote file syste
-00011740: 6d20 6f6e 6c79 2066 6f72 205a 6172 720a  m only for Zarr.
-00011750: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00011760: 7920 6368 756e 6b73 2e20 5265 7175 6972  y chunks. Requir
-00011770: 6573 207a 6172 722d 7079 7468 6f6e 2076  es zarr-python v
-00011780: 322e 342e 3020 6f72 206c 6174 6572 2e0a  2.4.0 or later..
-00011790: 2020 2020 2020 2020 6d6f 6465 203a 207b          mode : {
-000117a0: 2277 222c 2022 772d 222c 2022 6122 2c20  "w", "w-", "a", 
-000117b0: 2272 2b22 2c20 4e6f 6e65 7d2c 206f 7074  "r+", None}, opt
-000117c0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-000117d0: 2020 5065 7273 6973 7465 6e63 6520 6d6f    Persistence mo
-000117e0: 6465 3a20 2277 2220 6d65 616e 7320 6372  de: "w" means cr
-000117f0: 6561 7465 2028 6f76 6572 7772 6974 6520  eate (overwrite 
-00011800: 6966 2065 7869 7374 7329 3b0a 2020 2020  if exists);.    
-00011810: 2020 2020 2020 2020 2277 2d22 206d 6561          "w-" mea
-00011820: 6e73 2063 7265 6174 6520 2866 6169 6c20  ns create (fail 
-00011830: 6966 2065 7869 7374 7329 3b0a 2020 2020  if exists);.    
-00011840: 2020 2020 2020 2020 2261 2220 6d65 616e          "a" mean
-00011850: 7320 6f76 6572 7269 6465 2065 7869 7374  s override exist
-00011860: 696e 6720 7661 7269 6162 6c65 7320 2863  ing variables (c
-00011870: 7265 6174 6520 6966 2064 6f65 7320 6e6f  reate if does no
-00011880: 7420 6578 6973 7429 3b0a 2020 2020 2020  t exist);.      
-00011890: 2020 2020 2020 2272 2b22 206d 6561 6e73        "r+" means
-000118a0: 206d 6f64 6966 7920 6578 6973 7469 6e67   modify existing
-000118b0: 2061 7272 6179 202a 7661 6c75 6573 2a20   array *values* 
-000118c0: 6f6e 6c79 2028 7261 6973 6520 616e 2065  only (raise an e
-000118d0: 7272 6f72 2069 660a 2020 2020 2020 2020  rror if.        
-000118e0: 2020 2020 616e 7920 6d65 7461 6461 7461      any metadata
-000118f0: 206f 7220 7368 6170 6573 2077 6f75 6c64   or shapes would
-00011900: 2063 6861 6e67 6529 2e0a 2020 2020 2020   change)..      
-00011910: 2020 2020 2020 5468 6520 6465 6661 756c        The defaul
-00011920: 7420 6d6f 6465 2069 7320 2261 2220 6966  t mode is "a" if
-00011930: 2060 6061 7070 656e 645f 6469 6d60 6020   ``append_dim`` 
-00011940: 6973 2073 6574 2e20 4f74 6865 7277 6973  is set. Otherwis
-00011950: 652c 2069 7420 6973 0a20 2020 2020 2020  e, it is.       
-00011960: 2020 2020 2022 722b 2220 6966 2060 6072       "r+" if ``r
-00011970: 6567 696f 6e60 6020 6973 2073 6574 2061  egion`` is set a
-00011980: 6e64 2060 6077 2d60 6020 6f74 6865 7277  nd ``w-`` otherw
-00011990: 6973 652e 0a20 2020 2020 2020 2073 796e  ise..        syn
-000119a0: 6368 726f 6e69 7a65 7220 3a20 6f62 6a65  chronizer : obje
-000119b0: 6374 2c20 6f70 7469 6f6e 616c 0a20 2020  ct, optional.   
-000119c0: 2020 2020 2020 2020 205a 6172 7220 6172           Zarr ar
-000119d0: 7261 7920 7379 6e63 6872 6f6e 697a 6572  ray synchronizer
-000119e0: 2e0a 2020 2020 2020 2020 6772 6f75 7020  ..        group 
-000119f0: 3a20 7374 722c 206f 7074 696f 6e61 6c0a  : str, optional.
-00011a00: 2020 2020 2020 2020 2020 2020 4772 6f75              Grou
-00011a10: 7020 7061 7468 2e20 2861 2e6b 2e61 2e20  p path. (a.k.a. 
-00011a20: 6070 6174 6860 2069 6e20 7a61 7272 2074  `path` in zarr t
-00011a30: 6572 6d69 6e6f 6c6f 6779 2e29 0a20 2020  erminology.).   
-00011a40: 2020 2020 2065 6e63 6f64 696e 6720 3a20       encoding : 
-00011a50: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
-00011a60: 2020 2020 2020 2020 2020 204e 6573 7465             Neste
-00011a70: 6420 6469 6374 696f 6e61 7279 2077 6974  d dictionary wit
-00011a80: 6820 7661 7269 6162 6c65 206e 616d 6573  h variable names
-00011a90: 2061 7320 6b65 7973 2061 6e64 2064 6963   as keys and dic
-00011aa0: 7469 6f6e 6172 6965 7320 6f66 0a20 2020  tionaries of.   
-00011ab0: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
-00011ac0: 6520 7370 6563 6966 6963 2065 6e63 6f64  e specific encod
-00011ad0: 696e 6773 2061 7320 7661 6c75 6573 2c20  ings as values, 
-00011ae0: 652e 672e 2c0a 2020 2020 2020 2020 2020  e.g.,.          
-00011af0: 2020 6060 7b22 6d79 5f76 6172 6961 626c    ``{"my_variabl
-00011b00: 6522 3a20 7b22 6474 7970 6522 3a20 2269  e": {"dtype": "i
-00011b10: 6e74 3136 222c 2022 7363 616c 655f 6661  nt16", "scale_fa
-00011b20: 6374 6f72 223a 2030 2e31 2c7d 2c20 2e2e  ctor": 0.1,}, ..
-00011b30: 2e7d 6060 0a20 2020 2020 2020 2063 6f6d  .}``.        com
-00011b40: 7075 7465 203a 2062 6f6f 6c2c 2064 6566  pute : bool, def
-00011b50: 6175 6c74 3a20 5472 7565 0a20 2020 2020  ault: True.     
-00011b60: 2020 2020 2020 2049 6620 5472 7565 2077         If True w
-00011b70: 7269 7465 2061 7272 6179 2064 6174 6120  rite array data 
-00011b80: 696d 6d65 6469 6174 656c 792c 206f 7468  immediately, oth
-00011b90: 6572 7769 7365 2072 6574 7572 6e20 610a  erwise return a.
-00011ba0: 2020 2020 2020 2020 2020 2020 6060 6461              ``da
-00011bb0: 736b 2e64 656c 6179 6564 2e44 656c 6179  sk.delayed.Delay
-00011bc0: 6564 6060 206f 626a 6563 7420 7468 6174  ed`` object that
-00011bd0: 2063 616e 2062 6520 636f 6d70 7574 6564   can be computed
-00011be0: 2074 6f20 7772 6974 650a 2020 2020 2020   to write.      
-00011bf0: 2020 2020 2020 6172 7261 7920 6461 7461        array data
-00011c00: 206c 6174 6572 2e20 4d65 7461 6461 7461   later. Metadata
-00011c10: 2069 7320 616c 7761 7973 2075 7064 6174   is always updat
-00011c20: 6564 2065 6167 6572 6c79 2e0a 2020 2020  ed eagerly..    
-00011c30: 2020 2020 636f 6e73 6f6c 6964 6174 6564      consolidated
-00011c40: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
-00011c50: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-00011c60: 2054 7275 652c 2061 7070 6c79 207a 6172   True, apply zar
-00011c70: 7227 7320 6063 6f6e 736f 6c69 6461 7465  r's `consolidate
-00011c80: 5f6d 6574 6164 6174 6160 2066 756e 6374  _metadata` funct
-00011c90: 696f 6e20 746f 2074 6865 2073 746f 7265  ion to the store
-00011ca0: 0a20 2020 2020 2020 2020 2020 2061 6674  .            aft
-00011cb0: 6572 2077 7269 7469 6e67 206d 6574 6164  er writing metad
-00011cc0: 6174 6120 616e 6420 7265 6164 2065 7869  ata and read exi
-00011cd0: 7374 696e 6720 7374 6f72 6573 2077 6974  sting stores wit
-00011ce0: 6820 636f 6e73 6f6c 6964 6174 6564 0a20  h consolidated. 
-00011cf0: 2020 2020 2020 2020 2020 206d 6574 6164             metad
-00011d00: 6174 613b 2069 6620 4661 6c73 652c 2064  ata; if False, d
-00011d10: 6f20 6e6f 742e 2054 6865 2064 6566 6175  o not. The defau
-00011d20: 6c74 2028 6063 6f6e 736f 6c69 6461 7465  lt (`consolidate
-00011d30: 643d 4e6f 6e65 6029 206d 6561 6e73 0a20  d=None`) means. 
-00011d40: 2020 2020 2020 2020 2020 2077 7269 7465             write
-00011d50: 2063 6f6e 736f 6c69 6461 7465 6420 6d65   consolidated me
-00011d60: 7461 6461 7461 2061 6e64 2061 7474 656d  tadata and attem
-00011d70: 7074 2074 6f20 7265 6164 2063 6f6e 736f  pt to read conso
-00011d80: 6c69 6461 7465 640a 2020 2020 2020 2020  lidated.        
-00011d90: 2020 2020 6d65 7461 6461 7461 2066 6f72      metadata for
-00011da0: 2065 7869 7374 696e 6720 7374 6f72 6573   existing stores
-00011db0: 2028 6661 6c6c 696e 6720 6261 636b 2074   (falling back t
-00011dc0: 6f20 6e6f 6e2d 636f 6e73 6f6c 6964 6174  o non-consolidat
-00011dd0: 6564 292e 0a0a 2020 2020 2020 2020 2020  ed)...          
-00011de0: 2020 5768 656e 2074 6865 2065 7870 6572    When the exper
-00011df0: 696d 656e 7461 6c20 6060 7a61 7272 5f76  imental ``zarr_v
-00011e00: 6572 7369 6f6e 3d33 6060 2c20 6060 636f  ersion=3``, ``co
-00011e10: 6e73 6f6c 6964 6174 6564 6060 206d 7573  nsolidated`` mus
-00011e20: 7420 6265 0a20 2020 2020 2020 2020 2020  t be.           
-00011e30: 2065 6974 6865 7220 6265 2060 604e 6f6e   either be ``Non
-00011e40: 6560 6020 6f72 2060 6046 616c 7365 6060  e`` or ``False``
-00011e50: 2e0a 2020 2020 2020 2020 6170 7065 6e64  ..        append
-00011e60: 5f64 696d 203a 2068 6173 6861 626c 652c  _dim : hashable,
-00011e70: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00011e80: 2020 2020 2020 4966 2073 6574 2c20 7468        If set, th
-00011e90: 6520 6469 6d65 6e73 696f 6e20 616c 6f6e  e dimension alon
-00011ea0: 6720 7768 6963 6820 7468 6520 6461 7461  g which the data
-00011eb0: 2077 696c 6c20 6265 2061 7070 656e 6465   will be appende
-00011ec0: 642e 2041 6c6c 0a20 2020 2020 2020 2020  d. All.         
-00011ed0: 2020 206f 7468 6572 2064 696d 656e 7369     other dimensi
-00011ee0: 6f6e 7320 6f6e 206f 7665 7272 6964 6465  ons on overridde
-00011ef0: 6e20 7661 7269 6162 6c65 7320 6d75 7374  n variables must
-00011f00: 2072 656d 6169 6e20 7468 6520 7361 6d65   remain the same
-00011f10: 2073 697a 652e 0a20 2020 2020 2020 2072   size..        r
-00011f20: 6567 696f 6e20 3a20 6469 6374 2c20 6f70  egion : dict, op
-00011f30: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00011f40: 2020 204f 7074 696f 6e61 6c20 6d61 7070     Optional mapp
-00011f50: 696e 6720 6672 6f6d 2064 696d 656e 7369  ing from dimensi
-00011f60: 6f6e 206e 616d 6573 2074 6f20 696e 7465  on names to inte
-00011f70: 6765 7220 736c 6963 6573 2061 6c6f 6e67  ger slices along
-00011f80: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00011f90: 6173 6574 2064 696d 656e 7369 6f6e 7320  aset dimensions 
-00011fa0: 746f 2069 6e64 6963 6174 6520 7468 6520  to indicate the 
-00011fb0: 7265 6769 6f6e 206f 6620 6578 6973 7469  region of existi
-00011fc0: 6e67 207a 6172 7220 6172 7261 7928 7329  ng zarr array(s)
-00011fd0: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
-00011fe0: 7768 6963 6820 746f 2077 7269 7465 2074  which to write t
-00011ff0: 6869 7320 6461 7461 7365 7427 7320 6461  his dataset's da
-00012000: 7461 2e20 466f 7220 6578 616d 706c 652c  ta. For example,
-00012010: 0a20 2020 2020 2020 2020 2020 2060 607b  .            ``{
-00012020: 2778 273a 2073 6c69 6365 2830 2c20 3130  'x': slice(0, 10
-00012030: 3030 292c 2027 7927 3a20 736c 6963 6528  00), 'y': slice(
-00012040: 3130 3030 302c 2031 3130 3030 297d 6060  10000, 11000)}``
-00012050: 2077 6f75 6c64 2069 6e64 6963 6174 650a   would indicate.
-00012060: 2020 2020 2020 2020 2020 2020 7468 6174              that
-00012070: 2076 616c 7565 7320 7368 6f75 6c64 2062   values should b
-00012080: 6520 7772 6974 7465 6e20 746f 2074 6865  e written to the
-00012090: 2072 6567 696f 6e20 6060 303a 3130 3030   region ``0:1000
-000120a0: 6060 2061 6c6f 6e67 2060 6078 6060 0a20  `` along ``x``. 
-000120b0: 2020 2020 2020 2020 2020 2061 6e64 2060             and `
-000120c0: 6031 3030 3030 3a31 3130 3030 6060 2061  `10000:11000`` a
-000120d0: 6c6f 6e67 2060 6079 6060 2e0a 0a20 2020  long ``y``...   
-000120e0: 2020 2020 2020 2020 2054 776f 2072 6573           Two res
-000120f0: 7472 6963 7469 6f6e 7320 6170 706c 7920  trictions apply 
-00012100: 746f 2074 6865 2075 7365 206f 6620 6060  to the use of ``
-00012110: 7265 6769 6f6e 6060 3a0a 0a20 2020 2020  region``:..     
-00012120: 2020 2020 2020 202d 2049 6620 6060 7265         - If ``re
-00012130: 6769 6f6e 6060 2069 7320 7365 742c 205f  gion`` is set, _
-00012140: 616c 6c5f 2076 6172 6961 626c 6573 2069  all_ variables i
-00012150: 6e20 6120 6461 7461 7365 7420 6d75 7374  n a dataset must
-00012160: 2068 6176 6520 6174 0a20 2020 2020 2020   have at.       
-00012170: 2020 2020 2020 206c 6561 7374 206f 6e65         least one
-00012180: 2064 696d 656e 7369 6f6e 2069 6e20 636f   dimension in co
-00012190: 6d6d 6f6e 2077 6974 6820 7468 6520 7265  mmon with the re
-000121a0: 6769 6f6e 2e20 4f74 6865 7220 7661 7269  gion. Other vari
-000121b0: 6162 6c65 730a 2020 2020 2020 2020 2020  ables.          
-000121c0: 2020 2020 7368 6f75 6c64 2062 6520 7772      should be wr
-000121d0: 6974 7465 6e20 696e 2061 2073 6570 6172  itten in a separ
-000121e0: 6174 6520 6361 6c6c 2074 6f20 6060 746f  ate call to ``to
-000121f0: 5f7a 6172 7228 2960 602e 0a20 2020 2020  _zarr()``..     
-00012200: 2020 2020 2020 202d 2044 696d 656e 7369         - Dimensi
-00012210: 6f6e 7320 6361 6e6e 6f74 2062 6520 696e  ons cannot be in
-00012220: 636c 7564 6564 2069 6e20 626f 7468 2060  cluded in both `
-00012230: 6072 6567 696f 6e60 6020 616e 640a 2020  `region`` and.  
-00012240: 2020 2020 2020 2020 2020 2020 6060 6170              ``ap
-00012250: 7065 6e64 5f64 696d 6060 2061 7420 7468  pend_dim`` at th
-00012260: 6520 7361 6d65 2074 696d 652e 2054 6f20  e same time. To 
-00012270: 6372 6561 7465 2065 6d70 7479 2061 7272  create empty arr
-00012280: 6179 7320 746f 2066 696c 6c0a 2020 2020  ays to fill.    
-00012290: 2020 2020 2020 2020 2020 696e 2077 6974            in wit
-000122a0: 6820 6060 7265 6769 6f6e 6060 2c20 7573  h ``region``, us
-000122b0: 6520 6120 7365 7061 7261 7465 2063 616c  e a separate cal
-000122c0: 6c20 746f 2060 6074 6f5f 7a61 7272 2829  l to ``to_zarr()
-000122d0: 6060 2077 6974 680a 2020 2020 2020 2020  `` with.        
-000122e0: 2020 2020 2020 6060 636f 6d70 7574 653d        ``compute=
-000122f0: 4661 6c73 6560 602e 2053 6565 2022 4170  False``. See "Ap
-00012300: 7065 6e64 696e 6720 746f 2065 7869 7374  pending to exist
-00012310: 696e 6720 5a61 7272 2073 746f 7265 7322  ing Zarr stores"
-00012320: 2069 6e0a 2020 2020 2020 2020 2020 2020   in.            
-00012330: 2020 7468 6520 7265 6665 7265 6e63 6520    the reference 
-00012340: 646f 6375 6d65 6e74 6174 696f 6e20 666f  documentation fo
-00012350: 7220 6675 6c6c 2064 6574 6169 6c73 2e0a  r full details..
-00012360: 2020 2020 2020 2020 7361 6665 5f63 6875          safe_chu
-00012370: 6e6b 7320 3a20 626f 6f6c 2c20 6465 6661  nks : bool, defa
-00012380: 756c 743a 2054 7275 650a 2020 2020 2020  ult: True.      
-00012390: 2020 2020 2020 4966 2054 7275 652c 206f        If True, o
-000123a0: 6e6c 7920 616c 6c6f 7720 7772 6974 6573  nly allow writes
-000123b0: 2074 6f20 7768 656e 2074 6865 7265 2069   to when there i
-000123c0: 7320 6120 6d61 6e79 2d74 6f2d 6f6e 6520  s a many-to-one 
-000123d0: 7265 6c61 7469 6f6e 7368 6970 0a20 2020  relationship.   
-000123e0: 2020 2020 2020 2020 2062 6574 7765 656e           between
-000123f0: 205a 6172 7220 6368 756e 6b73 2028 7370   Zarr chunks (sp
-00012400: 6563 6966 6965 6420 696e 2065 6e63 6f64  ecified in encod
-00012410: 696e 6729 2061 6e64 2044 6173 6b20 6368  ing) and Dask ch
-00012420: 756e 6b73 2e0a 2020 2020 2020 2020 2020  unks..          
-00012430: 2020 5365 7420 4661 6c73 6520 746f 206f    Set False to o
-00012440: 7665 7272 6964 6520 7468 6973 2072 6573  verride this res
-00012450: 7472 6963 7469 6f6e 3b20 686f 7765 7665  triction; howeve
-00012460: 722c 2064 6174 6120 6d61 7920 6265 636f  r, data may beco
-00012470: 6d65 2063 6f72 7275 7074 6564 0a20 2020  me corrupted.   
-00012480: 2020 2020 2020 2020 2069 6620 5a61 7272           if Zarr
-00012490: 2061 7272 6179 7320 6172 6520 7772 6974   arrays are writ
-000124a0: 7465 6e20 696e 2070 6172 616c 6c65 6c2e  ten in parallel.
-000124b0: 2054 6869 7320 6f70 7469 6f6e 206d 6179   This option may
-000124c0: 2062 6520 7573 6566 756c 2069 6e20 636f   be useful in co
-000124d0: 6d62 696e 6174 696f 6e0a 2020 2020 2020  mbination.      
-000124e0: 2020 2020 2020 7769 7468 2060 6063 6f6d        with ``com
-000124f0: 7075 7465 3d46 616c 7365 6060 2074 6f20  pute=False`` to 
-00012500: 696e 6974 6961 6c69 7a65 2061 205a 6172  initialize a Zar
-00012510: 7220 6672 6f6d 2061 6e20 6578 6973 7469  r from an existi
-00012520: 6e67 0a20 2020 2020 2020 2020 2020 2044  ng.            D
-00012530: 6174 6173 6574 2077 6974 6820 6172 6269  ataset with arbi
-00012540: 7472 6172 7920 6368 756e 6b20 7374 7275  trary chunk stru
-00012550: 6374 7572 652e 0a20 2020 2020 2020 2073  cture..        s
-00012560: 746f 7261 6765 5f6f 7074 696f 6e73 203a  torage_options :
-00012570: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
-00012580: 2020 2020 2020 2020 2020 2020 416e 7920              Any 
-00012590: 6164 6469 7469 6f6e 616c 2070 6172 616d  additional param
-000125a0: 6574 6572 7320 666f 7220 7468 6520 7374  eters for the st
-000125b0: 6f72 6167 6520 6261 636b 656e 6420 2869  orage backend (i
-000125c0: 676e 6f72 6564 2066 6f72 206c 6f63 616c  gnored for local
-000125d0: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
-000125e0: 6873 292e 0a20 2020 2020 2020 207a 6172  hs)..        zar
-000125f0: 725f 7665 7273 696f 6e20 3a20 696e 7420  r_version : int 
-00012600: 6f72 204e 6f6e 652c 206f 7074 696f 6e61  or None, optiona
-00012610: 6c0a 2020 2020 2020 2020 2020 2020 5468  l.            Th
-00012620: 6520 6465 7369 7265 6420 7a61 7272 2073  e desired zarr s
-00012630: 7065 6320 7665 7273 696f 6e20 746f 2074  pec version to t
-00012640: 6172 6765 7420 2863 7572 7265 6e74 6c79  arget (currently
-00012650: 2032 206f 7220 3329 2e20 5468 650a 2020   2 or 3). The.  
-00012660: 2020 2020 2020 2020 2020 6465 6661 756c            defaul
-00012670: 7420 6f66 204e 6f6e 6520 7769 6c6c 2061  t of None will a
-00012680: 7474 656d 7074 2074 6f20 6465 7465 726d  ttempt to determ
-00012690: 696e 6520 7468 6520 7a61 7272 2076 6572  ine the zarr ver
-000126a0: 7369 6f6e 2066 726f 6d0a 2020 2020 2020  sion from.      
-000126b0: 2020 2020 2020 6060 7374 6f72 6560 6020        ``store`` 
-000126c0: 7768 656e 2070 6f73 7369 626c 652c 206f  when possible, o
-000126d0: 7468 6572 7769 7365 2064 6566 6175 6c74  therwise default
-000126e0: 696e 6720 746f 2032 2e0a 2020 2020 2020  ing to 2..      
-000126f0: 2020 6368 756e 6b6d 616e 6167 6572 5f73    chunkmanager_s
-00012700: 746f 7265 5f6b 7761 7267 7320 3a20 6469  tore_kwargs : di
-00012710: 6374 2c20 6f70 7469 6f6e 616c 0a20 2020  ct, optional.   
-00012720: 2020 2020 2020 2020 2041 6464 6974 696f           Additio
-00012730: 6e61 6c20 6b65 7977 6f72 6420 6172 6775  nal keyword argu
-00012740: 6d65 6e74 7320 7061 7373 6564 206f 6e20  ments passed on 
-00012750: 746f 2074 6865 2060 4368 756e 6b4d 616e  to the `ChunkMan
-00012760: 6167 6572 2e73 746f 7265 6020 6d65 7468  ager.store` meth
-00012770: 6f64 2075 7365 6420 746f 2073 746f 7265  od used to store
-00012780: 0a20 2020 2020 2020 2020 2020 2063 6875  .            chu
-00012790: 6e6b 6564 2061 7272 6179 732e 2046 6f72  nked arrays. For
-000127a0: 2065 7861 6d70 6c65 2066 6f72 2061 2064   example for a d
-000127b0: 6173 6b20 6172 7261 7920 6164 6469 7469  ask array additi
-000127c0: 6f6e 616c 206b 7761 7267 7320 7769 6c6c  onal kwargs will
-000127d0: 2062 6520 7061 7373 6564 2065 7665 6e74   be passed event
-000127e0: 7561 6c6c 7920 746f 0a20 2020 2020 2020  ually to.       
-000127f0: 2020 2020 203a 7079 3a66 756e 633a 6064       :py:func:`d
-00012800: 6173 6b2e 6172 7261 792e 7374 6f72 6528  ask.array.store(
-00012810: 2960 2e20 4578 7065 7269 6d65 6e74 616c  )`. Experimental
-00012820: 2041 5049 2074 6861 7420 7368 6f75 6c64   API that should
-00012830: 206e 6f74 2062 6520 7265 6c69 6564 2075   not be relied u
-00012840: 706f 6e2e 0a0a 2020 2020 2020 2020 5265  pon...        Re
-00012850: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00012860: 2d2d 2d2d 2d0a 2020 2020 2020 2020 2020  -----.          
-00012870: 2020 2a20 6060 6461 736b 2e64 656c 6179    * ``dask.delay
-00012880: 6564 2e44 656c 6179 6564 6060 2069 6620  ed.Delayed`` if 
-00012890: 636f 6d70 7574 6520 6973 2046 616c 7365  compute is False
-000128a0: 0a20 2020 2020 2020 2020 2020 202a 205a  .            * Z
-000128b0: 6172 7253 746f 7265 206f 7468 6572 7769  arrStore otherwi
-000128c0: 7365 0a0a 2020 2020 2020 2020 5265 6665  se..        Refe
-000128d0: 7265 6e63 6573 0a20 2020 2020 2020 202d  rences.        -
-000128e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-000128f0: 2020 6874 7470 733a 2f2f 7a61 7272 2e72    https://zarr.r
-00012900: 6561 6474 6865 646f 6373 2e69 6f2f 0a0a  eadthedocs.io/..
-00012910: 2020 2020 2020 2020 4e6f 7465 730a 2020          Notes.  
-00012920: 2020 2020 2020 2d2d 2d2d 2d0a 2020 2020        -----.    
-00012930: 2020 2020 5a61 7272 2063 6875 6e6b 696e      Zarr chunkin
-00012940: 6720 6265 6861 7669 6f72 3a0a 2020 2020  g behavior:.    
-00012950: 2020 2020 2020 2020 4966 2063 6875 6e6b          If chunk
-00012960: 7320 6172 6520 666f 756e 6420 696e 2074  s are found in t
-00012970: 6865 2065 6e63 6f64 696e 6720 6172 6775  he encoding argu
-00012980: 6d65 6e74 206f 7220 6174 7472 6962 7574  ment or attribut
-00012990: 650a 2020 2020 2020 2020 2020 2020 636f  e.            co
-000129a0: 7272 6573 706f 6e64 696e 6720 746f 2061  rresponding to a
-000129b0: 6e79 2044 6174 6141 7272 6179 2c20 7468  ny DataArray, th
-000129c0: 6f73 6520 6368 756e 6b73 2061 7265 2075  ose chunks are u
-000129d0: 7365 642e 0a20 2020 2020 2020 2020 2020  sed..           
-000129e0: 2049 6620 6120 4461 7461 4172 7261 7920   If a DataArray 
-000129f0: 6973 2061 2064 6173 6b20 6172 7261 792c  is a dask array,
-00012a00: 2069 7420 6973 2077 7269 7474 656e 2077   it is written w
-00012a10: 6974 6820 7468 6f73 6520 6368 756e 6b73  ith those chunks
-00012a20: 2e0a 2020 2020 2020 2020 2020 2020 4966  ..            If
-00012a30: 206e 6f74 206f 7468 6572 2063 6875 6e6b   not other chunk
-00012a40: 7320 6172 6520 666f 756e 642c 205a 6172  s are found, Zar
-00012a50: 7220 7573 6573 2069 7473 206f 776e 2068  r uses its own h
-00012a60: 6575 7269 7374 6963 7320 746f 0a20 2020  euristics to.   
-00012a70: 2020 2020 2020 2020 2063 686f 6f73 6520           choose 
-00012a80: 6175 746f 6d61 7469 6320 6368 756e 6b20  automatic chunk 
-00012a90: 7369 7a65 732e 0a0a 2020 2020 2020 2020  sizes...        
-00012aa0: 656e 636f 6469 6e67 3a0a 2020 2020 2020  encoding:.      
-00012ab0: 2020 2020 2020 5468 6520 656e 636f 6469        The encodi
-00012ac0: 6e67 2061 7474 7269 6275 7465 2028 6966  ng attribute (if
-00012ad0: 2065 7869 7374 7329 206f 6620 7468 6520   exists) of the 
-00012ae0: 4461 7461 4172 7261 7928 7329 2077 696c  DataArray(s) wil
-00012af0: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
-00012b00: 2075 7365 642e 204f 7665 7272 6964 6520   used. Override 
-00012b10: 616e 7920 6578 6973 7469 6e67 2065 6e63  any existing enc
-00012b20: 6f64 696e 6773 2062 7920 7072 6f76 6964  odings by provid
-00012b30: 696e 6720 7468 6520 6060 656e 636f 6469  ing the ``encodi
-00012b40: 6e67 6060 206b 7761 7267 2e0a 0a20 2020  ng`` kwarg...   
-00012b50: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-00012b60: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-00012b70: 2020 2020 2020 203a 7265 663a 6069 6f2e         :ref:`io.
-00012b80: 7a61 7272 600a 2020 2020 2020 2020 2020  zarr`.          
-00012b90: 2020 5468 6520 492f 4f20 7573 6572 2067    The I/O user g
-00012ba0: 7569 6465 2c20 7769 7468 206d 6f72 6520  uide, with more 
-00012bb0: 6465 7461 696c 7320 616e 6420 6578 616d  details and exam
-00012bc0: 706c 6573 2e0a 2020 2020 2020 2020 2222  ples..        ""
-00012bd0: 220a 2020 2020 2020 2020 6672 6f6d 2078  ".        from x
-00012be0: 6172 7261 792e 6261 636b 656e 6473 2e61  array.backends.a
-00012bf0: 7069 2069 6d70 6f72 7420 746f 5f7a 6172  pi import to_zar
-00012c00: 720a 0a20 2020 2020 2020 2072 6574 7572  r..        retur
-00012c10: 6e20 746f 5f7a 6172 7228 2020 2320 7479  n to_zarr(  # ty
-00012c20: 7065 3a20 6967 6e6f 7265 5b63 616c 6c2d  pe: ignore[call-
-00012c30: 6f76 6572 6c6f 6164 2c6d 6973 635d 0a20  overload,misc]. 
-00012c40: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00012c50: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
-00012c60: 7265 3d73 746f 7265 2c0a 2020 2020 2020  re=store,.      
-00012c70: 2020 2020 2020 6368 756e 6b5f 7374 6f72        chunk_stor
-00012c80: 653d 6368 756e 6b5f 7374 6f72 652c 0a20  e=chunk_store,. 
-00012c90: 2020 2020 2020 2020 2020 2073 746f 7261             stora
-00012ca0: 6765 5f6f 7074 696f 6e73 3d73 746f 7261  ge_options=stora
-00012cb0: 6765 5f6f 7074 696f 6e73 2c0a 2020 2020  ge_options,.    
-00012cc0: 2020 2020 2020 2020 6d6f 6465 3d6d 6f64          mode=mod
-00012cd0: 652c 0a20 2020 2020 2020 2020 2020 2073  e,.            s
-00012ce0: 796e 6368 726f 6e69 7a65 723d 7379 6e63  ynchronizer=sync
-00012cf0: 6872 6f6e 697a 6572 2c0a 2020 2020 2020  hronizer,.      
-00012d00: 2020 2020 2020 6772 6f75 703d 6772 6f75        group=grou
-00012d10: 702c 0a20 2020 2020 2020 2020 2020 2065  p,.            e
-00012d20: 6e63 6f64 696e 673d 656e 636f 6469 6e67  ncoding=encoding
-00012d30: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
-00012d40: 6d70 7574 653d 636f 6d70 7574 652c 0a20  mpute=compute,. 
-00012d50: 2020 2020 2020 2020 2020 2063 6f6e 736f             conso
-00012d60: 6c69 6461 7465 643d 636f 6e73 6f6c 6964  lidated=consolid
-00012d70: 6174 6564 2c0a 2020 2020 2020 2020 2020  ated,.          
-00012d80: 2020 6170 7065 6e64 5f64 696d 3d61 7070    append_dim=app
-00012d90: 656e 645f 6469 6d2c 0a20 2020 2020 2020  end_dim,.       
-00012da0: 2020 2020 2072 6567 696f 6e3d 7265 6769       region=regi
-00012db0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-00012dc0: 7361 6665 5f63 6875 6e6b 733d 7361 6665  safe_chunks=safe
-00012dd0: 5f63 6875 6e6b 732c 0a20 2020 2020 2020  _chunks,.       
-00012de0: 2020 2020 207a 6172 725f 7665 7273 696f       zarr_versio
-00012df0: 6e3d 7a61 7272 5f76 6572 7369 6f6e 2c0a  n=zarr_version,.
-00012e00: 2020 2020 2020 2020 2020 2020 6368 756e              chun
-00012e10: 6b6d 616e 6167 6572 5f73 746f 7265 5f6b  kmanager_store_k
-00012e20: 7761 7267 733d 6368 756e 6b6d 616e 6167  wargs=chunkmanag
-00012e30: 6572 5f73 746f 7265 5f6b 7761 7267 732c  er_store_kwargs,
-00012e40: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00012e50: 6465 6620 5f5f 7265 7072 5f5f 2873 656c  def __repr__(sel
-00012e60: 6629 202d 3e20 7374 723a 0a20 2020 2020  f) -> str:.     
-00012e70: 2020 2072 6574 7572 6e20 666f 726d 6174     return format
-00012e80: 7469 6e67 2e64 6174 6173 6574 5f72 6570  ting.dataset_rep
-00012e90: 7228 7365 6c66 290a 0a20 2020 2064 6566  r(self)..    def
-00012ea0: 205f 7265 7072 5f68 746d 6c5f 2873 656c   _repr_html_(sel
-00012eb0: 6629 202d 3e20 7374 723a 0a20 2020 2020  f) -> str:.     
-00012ec0: 2020 2069 6620 4f50 5449 4f4e 535b 2264     if OPTIONS["d
-00012ed0: 6973 706c 6179 5f73 7479 6c65 225d 203d  isplay_style"] =
-00012ee0: 3d20 2274 6578 7422 3a0a 2020 2020 2020  = "text":.      
-00012ef0: 2020 2020 2020 7265 7475 726e 2066 223c        return f"<
-00012f00: 7072 653e 7b65 7363 6170 6528 7265 7072  pre>{escape(repr
-00012f10: 2873 656c 6629 297d 3c2f 7072 653e 220a  (self))}</pre>".
-00012f20: 2020 2020 2020 2020 7265 7475 726e 2066          return f
-00012f30: 6f72 6d61 7474 696e 675f 6874 6d6c 2e64  ormatting_html.d
-00012f40: 6174 6173 6574 5f72 6570 7228 7365 6c66  ataset_repr(self
-00012f50: 290a 0a20 2020 2064 6566 2069 6e66 6f28  )..    def info(
-00012f60: 7365 6c66 2c20 6275 663a 2049 4f20 7c20  self, buf: IO | 
-00012f70: 4e6f 6e65 203d 204e 6f6e 6529 202d 3e20  None = None) -> 
-00012f80: 4e6f 6e65 3a0a 2020 2020 2020 2020 2222  None:.        ""
-00012f90: 220a 2020 2020 2020 2020 436f 6e63 6973  ".        Concis
-00012fa0: 6520 7375 6d6d 6172 7920 6f66 2061 2044  e summary of a D
-00012fb0: 6174 6173 6574 2076 6172 6961 626c 6573  ataset variables
-00012fc0: 2061 6e64 2061 7474 7269 6275 7465 732e   and attributes.
-00012fd0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00012fe0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-00012ff0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00013000: 6275 6620 3a20 6669 6c65 2d6c 696b 652c  buf : file-like,
-00013010: 2064 6566 6175 6c74 3a20 7379 732e 7374   default: sys.st
-00013020: 646f 7574 0a20 2020 2020 2020 2020 2020  dout.           
-00013030: 2077 7269 7461 626c 6520 6275 6666 6572   writable buffer
-00013040: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-00013050: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-00013060: 2d2d 2d0a 2020 2020 2020 2020 7061 6e64  ---.        pand
-00013070: 6173 2e44 6174 6146 7261 6d65 2e61 7373  as.DataFrame.ass
-00013080: 6967 6e0a 2020 2020 2020 2020 6e63 6475  ign.        ncdu
-00013090: 6d70 203a 206e 6574 4344 4627 7320 6e63  mp : netCDF's nc
-000130a0: 6475 6d70 0a20 2020 2020 2020 2022 2222  dump.        """
-000130b0: 0a20 2020 2020 2020 2069 6620 6275 6620  .        if buf 
-000130c0: 6973 204e 6f6e 653a 2020 2320 7072 6167  is None:  # prag
-000130d0: 6d61 3a20 6e6f 2063 6f76 6572 0a20 2020  ma: no cover.   
-000130e0: 2020 2020 2020 2020 2062 7566 203d 2073           buf = s
-000130f0: 7973 2e73 7464 6f75 740a 0a20 2020 2020  ys.stdout..     
-00013100: 2020 206c 696e 6573 203d 205b 5d0a 2020     lines = [].  
-00013110: 2020 2020 2020 6c69 6e65 732e 6170 7065        lines.appe
-00013120: 6e64 2822 7861 7272 6179 2e44 6174 6173  nd("xarray.Datas
-00013130: 6574 207b 2229 0a20 2020 2020 2020 206c  et {").        l
-00013140: 696e 6573 2e61 7070 656e 6428 2264 696d  ines.append("dim
-00013150: 656e 7369 6f6e 733a 2229 0a20 2020 2020  ensions:").     
-00013160: 2020 2066 6f72 206e 616d 652c 2073 697a     for name, siz
-00013170: 6520 696e 2073 656c 662e 6469 6d73 2e69  e in self.dims.i
-00013180: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-00013190: 2020 2020 6c69 6e65 732e 6170 7065 6e64      lines.append
-000131a0: 2866 225c 747b 6e61 6d65 7d20 3d20 7b73  (f"\t{name} = {s
-000131b0: 697a 657d 203b 2229 0a20 2020 2020 2020  ize} ;").       
-000131c0: 206c 696e 6573 2e61 7070 656e 6428 225c   lines.append("\
-000131d0: 6e76 6172 6961 626c 6573 3a22 290a 2020  nvariables:").  
-000131e0: 2020 2020 2020 666f 7220 6e61 6d65 2c20        for name, 
-000131f0: 6461 2069 6e20 7365 6c66 2e76 6172 6961  da in self.varia
-00013200: 626c 6573 2e69 7465 6d73 2829 3a0a 2020  bles.items():.  
-00013210: 2020 2020 2020 2020 2020 6469 6d73 203d            dims =
-00013220: 2022 2c20 222e 6a6f 696e 286d 6170 2873   ", ".join(map(s
-00013230: 7472 2c20 6461 2e64 696d 7329 290a 2020  tr, da.dims)).  
-00013240: 2020 2020 2020 2020 2020 6c69 6e65 732e            lines.
-00013250: 6170 7065 6e64 2866 225c 747b 6461 2e64  append(f"\t{da.d
-00013260: 7479 7065 7d20 7b6e 616d 657d 287b 6469  type} {name}({di
-00013270: 6d73 7d29 203b 2229 0a20 2020 2020 2020  ms}) ;").       
-00013280: 2020 2020 2066 6f72 206b 2c20 7620 696e       for k, v in
-00013290: 2064 612e 6174 7472 732e 6974 656d 7328   da.attrs.items(
-000132a0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000132b0: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
-000132c0: 6622 5c74 5c74 7b6e 616d 657d 3a7b 6b7d  f"\t\t{name}:{k}
-000132d0: 203d 207b 767d 203b 2229 0a20 2020 2020   = {v} ;").     
-000132e0: 2020 206c 696e 6573 2e61 7070 656e 6428     lines.append(
-000132f0: 225c 6e2f 2f20 676c 6f62 616c 2061 7474  "\n// global att
-00013300: 7269 6275 7465 733a 2229 0a20 2020 2020  ributes:").     
-00013310: 2020 2066 6f72 206b 2c20 7620 696e 2073     for k, v in s
-00013320: 656c 662e 6174 7472 732e 6974 656d 7328  elf.attrs.items(
-00013330: 293a 0a20 2020 2020 2020 2020 2020 206c  ):.            l
-00013340: 696e 6573 2e61 7070 656e 6428 6622 5c74  ines.append(f"\t
-00013350: 3a7b 6b7d 203d 207b 767d 203b 2229 0a20  :{k} = {v} ;"). 
-00013360: 2020 2020 2020 206c 696e 6573 2e61 7070         lines.app
-00013370: 656e 6428 227d 2229 0a0a 2020 2020 2020  end("}")..      
-00013380: 2020 6275 662e 7772 6974 6528 225c 6e22    buf.write("\n"
-00013390: 2e6a 6f69 6e28 6c69 6e65 7329 290a 0a20  .join(lines)).. 
-000133a0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-000133b0: 2064 6566 2063 6875 6e6b 7328 7365 6c66   def chunks(self
-000133c0: 2920 2d3e 204d 6170 7069 6e67 5b48 6173  ) -> Mapping[Has
-000133d0: 6861 626c 652c 2074 7570 6c65 5b69 6e74  hable, tuple[int
-000133e0: 2c20 2e2e 2e5d 5d3a 0a20 2020 2020 2020  , ...]]:.       
-000133f0: 2022 2222 0a20 2020 2020 2020 204d 6170   """.        Map
-00013400: 7069 6e67 2066 726f 6d20 6469 6d65 6e73  ping from dimens
-00013410: 696f 6e20 6e61 6d65 7320 746f 2062 6c6f  ion names to blo
-00013420: 636b 206c 656e 6774 6873 2066 6f72 2074  ck lengths for t
-00013430: 6869 7320 6461 7461 7365 7427 7320 6461  his dataset's da
-00013440: 7461 2c20 6f72 204e 6f6e 6520 6966 0a20  ta, or None if. 
-00013450: 2020 2020 2020 2074 6865 2075 6e64 6572         the under
-00013460: 6c79 696e 6720 6461 7461 2069 7320 6e6f  lying data is no
-00013470: 7420 6120 6461 736b 2061 7272 6179 2e0a  t a dask array..
-00013480: 2020 2020 2020 2020 4361 6e6e 6f74 2062          Cannot b
-00013490: 6520 6d6f 6469 6669 6564 2064 6972 6563  e modified direc
-000134a0: 746c 792c 2062 7574 2063 616e 2062 6520  tly, but can be 
-000134b0: 6d6f 6469 6669 6564 2062 7920 6361 6c6c  modified by call
-000134c0: 696e 6720 2e63 6875 6e6b 2829 2e0a 0a20  ing .chunk()... 
-000134d0: 2020 2020 2020 2053 616d 6520 6173 2044         Same as D
-000134e0: 6174 6173 6574 2e63 6875 6e6b 7369 7a65  ataset.chunksize
-000134f0: 732c 2062 7574 206d 6169 6e74 6169 6e65  s, but maintaine
-00013500: 6420 666f 7220 6261 636b 7761 7264 7320  d for backwards 
-00013510: 636f 6d70 6174 6962 696c 6974 792e 0a0a  compatibility...
-00013520: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-00013530: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00013540: 2d0a 2020 2020 2020 2020 4461 7461 7365  -.        Datase
-00013550: 742e 6368 756e 6b0a 2020 2020 2020 2020  t.chunk.        
-00013560: 4461 7461 7365 742e 6368 756e 6b73 697a  Dataset.chunksiz
-00013570: 6573 0a20 2020 2020 2020 2078 6172 7261  es.        xarra
-00013580: 792e 756e 6966 795f 6368 756e 6b73 0a20  y.unify_chunks. 
-00013590: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-000135a0: 2020 2072 6574 7572 6e20 6765 745f 6368     return get_ch
-000135b0: 756e 6b73 697a 6573 2873 656c 662e 7661  unksizes(self.va
-000135c0: 7269 6162 6c65 732e 7661 6c75 6573 2829  riables.values()
-000135d0: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-000135e0: 0a20 2020 2064 6566 2063 6875 6e6b 7369  .    def chunksi
-000135f0: 7a65 7328 7365 6c66 2920 2d3e 204d 6170  zes(self) -> Map
-00013600: 7069 6e67 5b48 6173 6861 626c 652c 2074  ping[Hashable, t
-00013610: 7570 6c65 5b69 6e74 2c20 2e2e 2e5d 5d3a  uple[int, ...]]:
-00013620: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00013630: 2020 2020 204d 6170 7069 6e67 2066 726f       Mapping fro
-00013640: 6d20 6469 6d65 6e73 696f 6e20 6e61 6d65  m dimension name
-00013650: 7320 746f 2062 6c6f 636b 206c 656e 6774  s to block lengt
-00013660: 6873 2066 6f72 2074 6869 7320 6461 7461  hs for this data
-00013670: 7365 7427 7320 6461 7461 2c20 6f72 204e  set's data, or N
-00013680: 6f6e 6520 6966 0a20 2020 2020 2020 2074  one if.        t
-00013690: 6865 2075 6e64 6572 6c79 696e 6720 6461  he underlying da
-000136a0: 7461 2069 7320 6e6f 7420 6120 6461 736b  ta is not a dask
-000136b0: 2061 7272 6179 2e0a 2020 2020 2020 2020   array..        
-000136c0: 4361 6e6e 6f74 2062 6520 6d6f 6469 6669  Cannot be modifi
-000136d0: 6564 2064 6972 6563 746c 792c 2062 7574  ed directly, but
-000136e0: 2063 616e 2062 6520 6d6f 6469 6669 6564   can be modified
-000136f0: 2062 7920 6361 6c6c 696e 6720 2e63 6875   by calling .chu
-00013700: 6e6b 2829 2e0a 0a20 2020 2020 2020 2053  nk()...        S
-00013710: 616d 6520 6173 2044 6174 6173 6574 2e63  ame as Dataset.c
-00013720: 6875 6e6b 732e 0a0a 2020 2020 2020 2020  hunks...        
-00013730: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-00013740: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00013750: 2020 4461 7461 7365 742e 6368 756e 6b0a    Dataset.chunk.
-00013760: 2020 2020 2020 2020 4461 7461 7365 742e          Dataset.
-00013770: 6368 756e 6b73 0a20 2020 2020 2020 2078  chunks.        x
-00013780: 6172 7261 792e 756e 6966 795f 6368 756e  array.unify_chun
-00013790: 6b73 0a20 2020 2020 2020 2022 2222 0a20  ks.        """. 
-000137a0: 2020 2020 2020 2072 6574 7572 6e20 6765         return ge
-000137b0: 745f 6368 756e 6b73 697a 6573 2873 656c  t_chunksizes(sel
-000137c0: 662e 7661 7269 6162 6c65 732e 7661 6c75  f.variables.valu
-000137d0: 6573 2829 290a 0a20 2020 2064 6566 2063  es())..    def c
-000137e0: 6875 6e6b 280a 2020 2020 2020 2020 7365  hunk(.        se
-000137f0: 6c66 3a20 545f 4461 7461 7365 742c 0a20  lf: T_Dataset,. 
-00013800: 2020 2020 2020 2063 6875 6e6b 733a 2028         chunks: (
-00013810: 0a20 2020 2020 2020 2020 2020 2069 6e74  .            int
-00013820: 207c 204c 6974 6572 616c 5b22 6175 746f   | Literal["auto
-00013830: 225d 207c 204d 6170 7069 6e67 5b41 6e79  "] | Mapping[Any
-00013840: 2c20 4e6f 6e65 207c 2069 6e74 207c 2073  , None | int | s
-00013850: 7472 207c 2074 7570 6c65 5b69 6e74 2c20  tr | tuple[int, 
-00013860: 2e2e 2e5d 5d0a 2020 2020 2020 2020 2920  ...]].        ) 
-00013870: 3d20 7b7d 2c20 2023 207b 7d20 6576 656e  = {},  # {} even
-00013880: 2074 686f 7567 6820 6974 2773 2074 6563   though it's tec
-00013890: 686e 6963 616c 6c79 2075 6e73 6166 652c  hnically unsafe,
-000138a0: 2069 7320 6265 696e 6720 7573 6564 2069   is being used i
-000138b0: 6e74 656e 7469 6f6e 616c 6c79 2068 6572  ntentionally her
-000138c0: 6520 2823 3436 3637 290a 2020 2020 2020  e (#4667).      
-000138d0: 2020 6e61 6d65 5f70 7265 6669 783a 2073    name_prefix: s
-000138e0: 7472 203d 2022 7861 7272 6179 2d22 2c0a  tr = "xarray-",.
-000138f0: 2020 2020 2020 2020 746f 6b65 6e3a 2073          token: s
-00013900: 7472 207c 204e 6f6e 6520 3d20 4e6f 6e65  tr | None = None
-00013910: 2c0a 2020 2020 2020 2020 6c6f 636b 3a20  ,.        lock: 
-00013920: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
-00013930: 2020 2020 2020 696e 6c69 6e65 5f61 7272        inline_arr
-00013940: 6179 3a20 626f 6f6c 203d 2046 616c 7365  ay: bool = False
-00013950: 2c0a 2020 2020 2020 2020 6368 756e 6b65  ,.        chunke
-00013960: 645f 6172 7261 795f 7479 7065 3a20 7374  d_array_type: st
-00013970: 7220 7c20 4368 756e 6b4d 616e 6167 6572  r | ChunkManager
-00013980: 456e 7472 7970 6f69 6e74 207c 204e 6f6e  Entrypoint | Non
-00013990: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-000139a0: 2020 6672 6f6d 5f61 7272 6179 5f6b 7761    from_array_kwa
-000139b0: 7267 733d 4e6f 6e65 2c0a 2020 2020 2020  rgs=None,.      
-000139c0: 2020 2a2a 6368 756e 6b73 5f6b 7761 7267    **chunks_kwarg
-000139d0: 733a 204e 6f6e 6520 7c20 696e 7420 7c20  s: None | int | 
-000139e0: 7374 7220 7c20 7475 706c 655b 696e 742c  str | tuple[int,
-000139f0: 202e 2e2e 5d2c 0a20 2020 2029 202d 3e20   ...],.    ) -> 
-00013a00: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
-00013a10: 2020 2022 2222 436f 6572 6365 2061 6c6c     """Coerce all
-00013a20: 2061 7272 6179 7320 696e 2074 6869 7320   arrays in this 
-00013a30: 6461 7461 7365 7420 696e 746f 2064 6173  dataset into das
-00013a40: 6b20 6172 7261 7973 2077 6974 6820 7468  k arrays with th
-00013a50: 6520 6769 7665 6e0a 2020 2020 2020 2020  e given.        
-00013a60: 6368 756e 6b73 2e0a 0a20 2020 2020 2020  chunks...       
-00013a70: 204e 6f6e 2d64 6173 6b20 6172 7261 7973   Non-dask arrays
-00013a80: 2069 6e20 7468 6973 2064 6174 6173 6574   in this dataset
-00013a90: 2077 696c 6c20 6265 2063 6f6e 7665 7274   will be convert
-00013aa0: 6564 2074 6f20 6461 736b 2061 7272 6179  ed to dask array
-00013ab0: 732e 2044 6173 6b0a 2020 2020 2020 2020  s. Dask.        
-00013ac0: 6172 7261 7973 2077 696c 6c20 6265 2072  arrays will be r
-00013ad0: 6563 6875 6e6b 6564 2074 6f20 7468 6520  echunked to the 
-00013ae0: 6769 7665 6e20 6368 756e 6b20 7369 7a65  given chunk size
-00013af0: 732e 0a0a 2020 2020 2020 2020 4966 206e  s...        If n
-00013b00: 6569 7468 6572 2063 6875 6e6b 7320 6973  either chunks is
-00013b10: 206e 6f74 2070 726f 7669 6465 6420 666f   not provided fo
-00013b20: 7220 6f6e 6520 6f72 206d 6f72 6520 6469  r one or more di
-00013b30: 6d65 6e73 696f 6e73 2c20 6368 756e 6b0a  mensions, chunk.
-00013b40: 2020 2020 2020 2020 7369 7a65 7320 616c          sizes al
-00013b50: 6f6e 6720 7468 6174 2064 696d 656e 7369  ong that dimensi
-00013b60: 6f6e 2077 696c 6c20 6e6f 7420 6265 2075  on will not be u
-00013b70: 7064 6174 6564 3b20 6e6f 6e2d 6461 736b  pdated; non-dask
-00013b80: 2061 7272 6179 7320 7769 6c6c 2062 650a   arrays will be.
-00013b90: 2020 2020 2020 2020 636f 6e76 6572 7465          converte
-00013ba0: 6420 696e 746f 2064 6173 6b20 6172 7261  d into dask arra
-00013bb0: 7973 2077 6974 6820 6120 7369 6e67 6c65  ys with a single
-00013bc0: 2062 6c6f 636b 2e0a 0a20 2020 2020 2020   block...       
-00013bd0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00013be0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00013bf0: 2020 2020 2020 2063 6875 6e6b 7320 3a20         chunks : 
-00013c00: 696e 742c 2074 7570 6c65 206f 6620 696e  int, tuple of in
-00013c10: 742c 2022 6175 746f 2220 6f72 206d 6170  t, "auto" or map
-00013c20: 7069 6e67 206f 6620 6861 7368 6162 6c65  ping of hashable
-00013c30: 2074 6f20 696e 742c 206f 7074 696f 6e61   to int, optiona
-00013c40: 6c0a 2020 2020 2020 2020 2020 2020 4368  l.            Ch
-00013c50: 756e 6b20 7369 7a65 7320 616c 6f6e 6720  unk sizes along 
-00013c60: 6561 6368 2064 696d 656e 7369 6f6e 2c20  each dimension, 
-00013c70: 652e 672e 2c20 6060 3560 602c 2060 6022  e.g., ``5``, ``"
-00013c80: 6175 746f 2260 602c 206f 720a 2020 2020  auto"``, or.    
-00013c90: 2020 2020 2020 2020 6060 7b22 7822 3a20          ``{"x": 
-00013ca0: 352c 2022 7922 3a20 357d 6060 2e0a 2020  5, "y": 5}``..  
-00013cb0: 2020 2020 2020 6e61 6d65 5f70 7265 6669        name_prefi
-00013cc0: 7820 3a20 7374 722c 2064 6566 6175 6c74  x : str, default
-00013cd0: 3a20 2278 6172 7261 792d 220a 2020 2020  : "xarray-".    
-00013ce0: 2020 2020 2020 2020 5072 6566 6978 2066          Prefix f
-00013cf0: 6f72 2074 6865 206e 616d 6520 6f66 2061  or the name of a
-00013d00: 6e79 206e 6577 2064 6173 6b20 6172 7261  ny new dask arra
-00013d10: 7973 2e0a 2020 2020 2020 2020 746f 6b65  ys..        toke
-00013d20: 6e20 3a20 7374 722c 206f 7074 696f 6e61  n : str, optiona
-00013d30: 6c0a 2020 2020 2020 2020 2020 2020 546f  l.            To
-00013d40: 6b65 6e20 756e 6971 7565 6c79 2069 6465  ken uniquely ide
-00013d50: 6e74 6966 7969 6e67 2074 6869 7320 6461  ntifying this da
-00013d60: 7461 7365 742e 0a20 2020 2020 2020 206c  taset..        l
-00013d70: 6f63 6b20 3a20 626f 6f6c 2c20 6465 6661  ock : bool, defa
-00013d80: 756c 743a 2046 616c 7365 0a20 2020 2020  ult: False.     
-00013d90: 2020 2020 2020 2050 6173 7365 6420 6f6e         Passed on
-00013da0: 2074 6f20 3a70 793a 6675 6e63 3a60 6461   to :py:func:`da
-00013db0: 736b 2e61 7272 6179 2e66 726f 6d5f 6172  sk.array.from_ar
-00013dc0: 7261 7960 2c20 6966 2074 6865 2061 7272  ray`, if the arr
-00013dd0: 6179 2069 7320 6e6f 740a 2020 2020 2020  ay is not.      
-00013de0: 2020 2020 2020 616c 7265 6164 7920 6173        already as
-00013df0: 2064 6173 6b20 6172 7261 792e 0a20 2020   dask array..   
-00013e00: 2020 2020 2069 6e6c 696e 655f 6172 7261       inline_arra
-00013e10: 793a 2062 6f6f 6c2c 2064 6566 6175 6c74  y: bool, default
-00013e20: 3a20 4661 6c73 650a 2020 2020 2020 2020  : False.        
-00013e30: 2020 2020 5061 7373 6564 206f 6e20 746f      Passed on to
-00013e40: 203a 7079 3a66 756e 633a 6064 6173 6b2e   :py:func:`dask.
-00013e50: 6172 7261 792e 6672 6f6d 5f61 7272 6179  array.from_array
-00013e60: 602c 2069 6620 7468 6520 6172 7261 7920  `, if the array 
-00013e70: 6973 206e 6f74 0a20 2020 2020 2020 2020  is not.         
-00013e80: 2020 2061 6c72 6561 6479 2061 7320 6461     already as da
-00013e90: 736b 2061 7272 6179 2e0a 2020 2020 2020  sk array..      
-00013ea0: 2020 6368 756e 6b65 645f 6172 7261 795f    chunked_array_
-00013eb0: 7479 7065 3a20 7374 722c 206f 7074 696f  type: str, optio
-00013ec0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-00013ed0: 5768 6963 6820 6368 756e 6b65 6420 6172  Which chunked ar
-00013ee0: 7261 7920 7479 7065 2074 6f20 636f 6572  ray type to coer
-00013ef0: 6365 2074 6869 7320 6461 7461 7365 7473  ce this datasets
-00013f00: 2720 6172 7261 7973 2074 6f2e 0a20 2020  ' arrays to..   
-00013f10: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
-00013f20: 7320 746f 2027 6461 736b 2720 6966 2069  s to 'dask' if i
-00013f30: 6e73 7461 6c6c 6564 2c20 656c 7365 2077  nstalled, else w
-00013f40: 6861 7465 7665 7220 6973 2072 6567 6973  hatever is regis
-00013f50: 7465 7265 6420 7669 6120 7468 6520 6043  tered via the `C
-00013f60: 6875 6e6b 4d61 6e61 6765 7245 6e65 7472  hunkManagerEnetr
-00013f70: 7950 6f69 6e74 6020 7379 7374 656d 2e0a  yPoint` system..
-00013f80: 2020 2020 2020 2020 2020 2020 4578 7065              Expe
-00013f90: 7269 6d65 6e74 616c 2041 5049 2074 6861  rimental API tha
-00013fa0: 7420 7368 6f75 6c64 206e 6f74 2062 6520  t should not be 
-00013fb0: 7265 6c69 6564 2075 706f 6e2e 0a20 2020  relied upon..   
-00013fc0: 2020 2020 2066 726f 6d5f 6172 7261 795f       from_array_
-00013fd0: 6b77 6172 6773 3a20 6469 6374 2c20 6f70  kwargs: dict, op
-00013fe0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00013ff0: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
-00014000: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
-00014010: 7061 7373 6564 206f 6e20 746f 2074 6865  passed on to the
-00014020: 2060 4368 756e 6b4d 616e 6167 6572 456e   `ChunkManagerEn
-00014030: 7472 7970 6f69 6e74 2e66 726f 6d5f 6172  trypoint.from_ar
-00014040: 7261 7960 206d 6574 686f 6420 7573 6564  ray` method used
-00014050: 2074 6f20 6372 6561 7465 0a20 2020 2020   to create.     
-00014060: 2020 2020 2020 2063 6875 6e6b 6564 2061         chunked a
-00014070: 7272 6179 732c 2076 6961 2077 6869 6368  rrays, via which
-00014080: 6576 6572 2063 6875 6e6b 206d 616e 6167  ever chunk manag
-00014090: 6572 2069 7320 7370 6563 6966 6965 6420  er is specified 
-000140a0: 7468 726f 7567 6820 7468 6520 6063 6875  through the `chu
-000140b0: 6e6b 6564 5f61 7272 6179 5f74 7970 6560  nked_array_type`
-000140c0: 206b 7761 7267 2e0a 2020 2020 2020 2020   kwarg..        
-000140d0: 2020 2020 466f 7220 6578 616d 706c 652c      For example,
-000140e0: 2077 6974 6820 6461 736b 2061 7320 7468   with dask as th
-000140f0: 6520 6465 6661 756c 7420 6368 756e 6b65  e default chunke
-00014100: 6420 6172 7261 7920 7479 7065 2c20 7468  d array type, th
-00014110: 6973 206d 6574 686f 6420 776f 756c 6420  is method would 
-00014120: 7061 7373 2061 6464 6974 696f 6e61 6c20  pass additional 
-00014130: 6b77 6172 6773 0a20 2020 2020 2020 2020  kwargs.         
-00014140: 2020 2074 6f20 3a70 793a 6675 6e63 3a60     to :py:func:`
-00014150: 6461 736b 2e61 7272 6179 2e66 726f 6d5f  dask.array.from_
-00014160: 6172 7261 7960 2e20 4578 7065 7269 6d65  array`. Experime
-00014170: 6e74 616c 2041 5049 2074 6861 7420 7368  ntal API that sh
-00014180: 6f75 6c64 206e 6f74 2062 6520 7265 6c69  ould not be reli
-00014190: 6564 2075 706f 6e2e 0a20 2020 2020 2020  ed upon..       
-000141a0: 202a 2a63 6875 6e6b 735f 6b77 6172 6773   **chunks_kwargs
-000141b0: 203a 207b 6469 6d3a 2063 6875 6e6b 732c   : {dim: chunks,
-000141c0: 202e 2e2e 7d2c 206f 7074 696f 6e61 6c0a   ...}, optional.
-000141d0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-000141e0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-000141f0: 7320 666f 726d 206f 6620 6060 6368 756e  s form of ``chun
-00014200: 6b73 6060 2e0a 2020 2020 2020 2020 2020  ks``..          
-00014210: 2020 4f6e 6520 6f66 2063 6875 6e6b 7320    One of chunks 
-00014220: 6f72 2063 6875 6e6b 735f 6b77 6172 6773  or chunks_kwargs
-00014230: 206d 7573 7420 6265 2070 726f 7669 6465   must be provide
-00014240: 640a 0a20 2020 2020 2020 2052 6574 7572  d..        Retur
-00014250: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-00014260: 2d2d 0a20 2020 2020 2020 2063 6875 6e6b  --.        chunk
-00014270: 6564 203a 2078 6172 7261 792e 4461 7461  ed : xarray.Data
-00014280: 7365 740a 0a20 2020 2020 2020 2053 6565  set..        See
-00014290: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-000142a0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-000142b0: 6174 6173 6574 2e63 6875 6e6b 730a 2020  ataset.chunks.  
-000142c0: 2020 2020 2020 4461 7461 7365 742e 6368        Dataset.ch
-000142d0: 756e 6b73 697a 6573 0a20 2020 2020 2020  unksizes.       
-000142e0: 2078 6172 7261 792e 756e 6966 795f 6368   xarray.unify_ch
-000142f0: 756e 6b73 0a20 2020 2020 2020 2064 6173  unks.        das
-00014300: 6b2e 6172 7261 792e 6672 6f6d 5f61 7272  k.array.from_arr
-00014310: 6179 0a20 2020 2020 2020 2022 2222 0a20  ay.        """. 
-00014320: 2020 2020 2020 2069 6620 6368 756e 6b73         if chunks
-00014330: 2069 7320 4e6f 6e65 2061 6e64 2063 6875   is None and chu
-00014340: 6e6b 735f 6b77 6172 6773 2069 7320 4e6f  nks_kwargs is No
-00014350: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00014360: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
-00014370: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00014380: 4e6f 6e65 2076 616c 7565 2066 6f72 2027  None value for '
-00014390: 6368 756e 6b73 2720 6973 2064 6570 7265  chunks' is depre
-000143a0: 6361 7465 642e 2022 0a20 2020 2020 2020  cated. ".       
-000143b0: 2020 2020 2020 2020 2022 4974 2077 696c           "It wil
-000143c0: 6c20 7261 6973 6520 616e 2065 7272 6f72  l raise an error
-000143d0: 2069 6e20 7468 6520 6675 7475 7265 2e20   in the future. 
-000143e0: 5573 6520 696e 7374 6561 6420 277b 7d27  Use instead '{}'
-000143f0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-00014400: 2020 2063 6174 6567 6f72 793d 4675 7475     category=Futu
-00014410: 7265 5761 726e 696e 672c 0a20 2020 2020  reWarning,.     
-00014420: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00014430: 2020 2020 2063 6875 6e6b 7320 3d20 7b7d       chunks = {}
-00014440: 0a0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-00014450: 6e73 7461 6e63 6528 6368 756e 6b73 2c20  nstance(chunks, 
-00014460: 284e 756d 6265 722c 2073 7472 2c20 696e  (Number, str, in
-00014470: 7429 293a 0a20 2020 2020 2020 2020 2020  t)):.           
-00014480: 2063 6875 6e6b 7320 3d20 6469 6374 2e66   chunks = dict.f
-00014490: 726f 6d6b 6579 7328 7365 6c66 2e64 696d  romkeys(self.dim
-000144a0: 732c 2063 6875 6e6b 7329 0a20 2020 2020  s, chunks).     
-000144b0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000144c0: 2020 2020 2063 6875 6e6b 7320 3d20 6569       chunks = ei
-000144d0: 7468 6572 5f64 6963 745f 6f72 5f6b 7761  ther_dict_or_kwa
-000144e0: 7267 7328 6368 756e 6b73 2c20 6368 756e  rgs(chunks, chun
-000144f0: 6b73 5f6b 7761 7267 732c 2022 6368 756e  ks_kwargs, "chun
-00014500: 6b22 290a 0a20 2020 2020 2020 2062 6164  k")..        bad
-00014510: 5f64 696d 7320 3d20 6368 756e 6b73 2e6b  _dims = chunks.k
-00014520: 6579 7328 2920 2d20 7365 6c66 2e64 696d  eys() - self.dim
-00014530: 732e 6b65 7973 2829 0a20 2020 2020 2020  s.keys().       
-00014540: 2069 6620 6261 645f 6469 6d73 3a0a 2020   if bad_dims:.  
-00014550: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00014560: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00014570: 2020 2020 2020 2020 2020 2020 6622 736f              f"so
-00014580: 6d65 2063 6875 6e6b 7320 6b65 7973 2061  me chunks keys a
-00014590: 7265 206e 6f74 2064 696d 656e 7369 6f6e  re not dimension
-000145a0: 7320 6f6e 2074 6869 7320 6f62 6a65 6374  s on this object
-000145b0: 3a20 7b62 6164 5f64 696d 737d 220a 2020  : {bad_dims}".  
-000145c0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-000145d0: 2020 2020 2063 6875 6e6b 6d61 6e61 6765       chunkmanage
-000145e0: 7220 3d20 6775 6573 735f 6368 756e 6b6d  r = guess_chunkm
-000145f0: 616e 6167 6572 2863 6875 6e6b 6564 5f61  anager(chunked_a
-00014600: 7272 6179 5f74 7970 6529 0a20 2020 2020  rray_type).     
-00014610: 2020 2069 6620 6672 6f6d 5f61 7272 6179     if from_array
-00014620: 5f6b 7761 7267 7320 6973 204e 6f6e 653a  _kwargs is None:
-00014630: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
-00014640: 6d5f 6172 7261 795f 6b77 6172 6773 203d  m_array_kwargs =
-00014650: 207b 7d0a 0a20 2020 2020 2020 2076 6172   {}..        var
-00014660: 6961 626c 6573 203d 207b 0a20 2020 2020  iables = {.     
-00014670: 2020 2020 2020 206b 3a20 5f6d 6179 6265         k: _maybe
-00014680: 5f63 6875 6e6b 280a 2020 2020 2020 2020  _chunk(.        
-00014690: 2020 2020 2020 2020 6b2c 0a20 2020 2020          k,.     
-000146a0: 2020 2020 2020 2020 2020 2076 2c0a 2020             v,.  
-000146b0: 2020 2020 2020 2020 2020 2020 2020 6368                ch
-000146c0: 756e 6b73 2c0a 2020 2020 2020 2020 2020  unks,.          
-000146d0: 2020 2020 2020 746f 6b65 6e2c 0a20 2020        token,.   
-000146e0: 2020 2020 2020 2020 2020 2020 206c 6f63               loc
-000146f0: 6b2c 0a20 2020 2020 2020 2020 2020 2020  k,.             
-00014700: 2020 206e 616d 655f 7072 6566 6978 2c0a     name_prefix,.
-00014710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014720: 696e 6c69 6e65 5f61 7272 6179 3d69 6e6c  inline_array=inl
-00014730: 696e 655f 6172 7261 792c 0a20 2020 2020  ine_array,.     
-00014740: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
-00014750: 6564 5f61 7272 6179 5f74 7970 653d 6368  ed_array_type=ch
-00014760: 756e 6b6d 616e 6167 6572 2c0a 2020 2020  unkmanager,.    
-00014770: 2020 2020 2020 2020 2020 2020 6672 6f6d              from
-00014780: 5f61 7272 6179 5f6b 7761 7267 733d 6672  _array_kwargs=fr
-00014790: 6f6d 5f61 7272 6179 5f6b 7761 7267 732e  om_array_kwargs.
-000147a0: 636f 7079 2829 2c0a 2020 2020 2020 2020  copy(),.        
-000147b0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-000147c0: 2020 666f 7220 6b2c 2076 2069 6e20 7365    for k, v in se
-000147d0: 6c66 2e76 6172 6961 626c 6573 2e69 7465  lf.variables.ite
-000147e0: 6d73 2829 0a20 2020 2020 2020 207d 0a20  ms().        }. 
-000147f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00014800: 6c66 2e5f 7265 706c 6163 6528 7661 7269  lf._replace(vari
-00014810: 6162 6c65 7329 0a0a 2020 2020 6465 6620  ables)..    def 
-00014820: 5f76 616c 6964 6174 655f 696e 6465 7865  _validate_indexe
-00014830: 7273 280a 2020 2020 2020 2020 7365 6c66  rs(.        self
-00014840: 2c20 696e 6465 7865 7273 3a20 4d61 7070  , indexers: Mapp
-00014850: 696e 675b 416e 792c 2041 6e79 5d2c 206d  ing[Any, Any], m
-00014860: 6973 7369 6e67 5f64 696d 733a 2045 7272  issing_dims: Err
-00014870: 6f72 4f70 7469 6f6e 7357 6974 6857 6172  orOptionsWithWar
-00014880: 6e20 3d20 2272 6169 7365 220a 2020 2020  n = "raise".    
-00014890: 2920 2d3e 2049 7465 7261 746f 725b 7475  ) -> Iterator[tu
-000148a0: 706c 655b 4861 7368 6162 6c65 2c20 696e  ple[Hashable, in
-000148b0: 7420 7c20 736c 6963 6520 7c20 6e70 2e6e  t | slice | np.n
-000148c0: 6461 7272 6179 207c 2056 6172 6961 626c  darray | Variabl
-000148d0: 655d 5d3a 0a20 2020 2020 2020 2022 2222  e]]:.        """
-000148e0: 4865 7265 2077 6520 6d61 6b65 2073 7572  Here we make sur
-000148f0: 650a 2020 2020 2020 2020 2b20 696e 6465  e.        + inde
-00014900: 7865 7220 6861 7320 6120 7661 6c69 6420  xer has a valid 
-00014910: 6b65 7973 0a20 2020 2020 2020 202b 2069  keys.        + i
-00014920: 6e64 6578 6572 2069 7320 696e 2061 2076  ndexer is in a v
-00014930: 616c 6964 2064 6174 6120 7479 7065 0a20  alid data type. 
-00014940: 2020 2020 2020 202b 2073 7472 696e 6720         + string 
-00014950: 696e 6465 7865 7273 2061 7265 2063 6173  indexers are cas
-00014960: 7420 746f 2074 6865 2061 7070 726f 7072  t to the appropr
-00014970: 6961 7465 2064 6174 6520 7479 7065 2069  iate date type i
-00014980: 6620 7468 650a 2020 2020 2020 2020 2020  f the.          
-00014990: 6173 736f 6369 6174 6564 2069 6e64 6578  associated index
-000149a0: 2069 7320 6120 4461 7465 7469 6d65 496e   is a DatetimeIn
-000149b0: 6465 7820 6f72 2043 4654 696d 6549 6e64  dex or CFTimeInd
-000149c0: 6578 0a20 2020 2020 2020 2022 2222 0a20  ex.        """. 
-000149d0: 2020 2020 2020 2066 726f 6d20 7861 7272         from xarr
-000149e0: 6179 2e63 6f64 696e 672e 6366 7469 6d65  ay.coding.cftime
-000149f0: 696e 6465 7820 696d 706f 7274 2043 4654  index import CFT
-00014a00: 696d 6549 6e64 6578 0a20 2020 2020 2020  imeIndex.       
-00014a10: 2066 726f 6d20 7861 7272 6179 2e63 6f72   from xarray.cor
-00014a20: 652e 6461 7461 6172 7261 7920 696d 706f  e.dataarray impo
-00014a30: 7274 2044 6174 6141 7272 6179 0a0a 2020  rt DataArray..  
-00014a40: 2020 2020 2020 696e 6465 7865 7273 203d        indexers =
-00014a50: 2064 726f 705f 6469 6d73 5f66 726f 6d5f   drop_dims_from_
-00014a60: 696e 6465 7865 7273 2869 6e64 6578 6572  indexers(indexer
-00014a70: 732c 2073 656c 662e 6469 6d73 2c20 6d69  s, self.dims, mi
-00014a80: 7373 696e 675f 6469 6d73 290a 0a20 2020  ssing_dims)..   
-00014a90: 2020 2020 2023 2061 6c6c 2069 6e64 6578       # all index
-00014aa0: 6572 7320 7368 6f75 6c64 2062 6520 696e  ers should be in
-00014ab0: 742c 2073 6c69 6365 2c20 6e70 2e6e 6461  t, slice, np.nda
-00014ac0: 7272 6179 732c 206f 7220 5661 7269 6162  rrays, or Variab
-00014ad0: 6c65 0a20 2020 2020 2020 2066 6f72 206b  le.        for k
-00014ae0: 2c20 7620 696e 2069 6e64 6578 6572 732e  , v in indexers.
-00014af0: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-00014b00: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00014b10: 6365 2876 2c20 2869 6e74 2c20 736c 6963  ce(v, (int, slic
-00014b20: 652c 2056 6172 6961 626c 6529 293a 0a20  e, Variable)):. 
-00014b30: 2020 2020 2020 2020 2020 2020 2020 2079                 y
-00014b40: 6965 6c64 206b 2c20 760a 2020 2020 2020  ield k, v.      
-00014b50: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00014b60: 7461 6e63 6528 762c 2044 6174 6141 7272  tance(v, DataArr
-00014b70: 6179 293a 0a20 2020 2020 2020 2020 2020  ay):.           
-00014b80: 2020 2020 2079 6965 6c64 206b 2c20 762e       yield k, v.
-00014b90: 7661 7269 6162 6c65 0a20 2020 2020 2020  variable.       
-00014ba0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00014bb0: 616e 6365 2876 2c20 7475 706c 6529 3a0a  ance(v, tuple):.
-00014bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014bd0: 7969 656c 6420 6b2c 2061 735f 7661 7269  yield k, as_vari
-00014be0: 6162 6c65 2876 290a 2020 2020 2020 2020  able(v).        
-00014bf0: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
-00014c00: 6e63 6528 762c 2044 6174 6173 6574 293a  nce(v, Dataset):
-00014c10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014c20: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00014c30: 2822 6361 6e6e 6f74 2075 7365 2061 2044  ("cannot use a D
-00014c40: 6174 6173 6574 2061 7320 616e 2069 6e64  ataset as an ind
-00014c50: 6578 6572 2229 0a20 2020 2020 2020 2020  exer").         
-00014c60: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-00014c70: 6365 2876 2c20 5365 7175 656e 6365 2920  ce(v, Sequence) 
-00014c80: 616e 6420 6c65 6e28 7629 203d 3d20 303a  and len(v) == 0:
-00014c90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ca0: 2079 6965 6c64 206b 2c20 6e70 2e65 6d70   yield k, np.emp
-00014cb0: 7479 2828 302c 292c 2064 7479 7065 3d22  ty((0,), dtype="
-00014cc0: 696e 7436 3422 290a 2020 2020 2020 2020  int64").        
-00014cd0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00014ce0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00014cf0: 2069 735f 6475 636b 5f61 7272 6179 2876   is_duck_array(v
-00014d00: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00014d10: 2020 2020 2020 2076 203d 206e 702e 6173         v = np.as
-00014d20: 6172 7261 7928 7629 0a0a 2020 2020 2020  array(v)..      
-00014d30: 2020 2020 2020 2020 2020 6966 2076 2e64            if v.d
-00014d40: 7479 7065 2e6b 696e 6420 696e 2022 5553  type.kind in "US
-00014d50: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
-00014d60: 2020 2020 2020 2069 6e64 6578 203d 2073         index = s
-00014d70: 656c 662e 5f69 6e64 6578 6573 5b6b 5d2e  elf._indexes[k].
-00014d80: 746f 5f70 616e 6461 735f 696e 6465 7828  to_pandas_index(
-00014d90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00014da0: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-00014db0: 6e63 6528 696e 6465 782c 2070 642e 4461  nce(index, pd.Da
-00014dc0: 7465 7469 6d65 496e 6465 7829 3a0a 2020  tetimeIndex):.  
-00014dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014de0: 2020 2020 2020 7620 3d20 6475 636b 5f61        v = duck_a
-00014df0: 7272 6179 5f6f 7073 2e61 7374 7970 6528  rray_ops.astype(
-00014e00: 762c 2064 7479 7065 3d22 6461 7465 7469  v, dtype="dateti
-00014e10: 6d65 3634 5b6e 735d 2229 0a20 2020 2020  me64[ns]").     
-00014e20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00014e30: 6c69 6620 6973 696e 7374 616e 6365 2869  lif isinstance(i
-00014e40: 6e64 6578 2c20 4346 5469 6d65 496e 6465  ndex, CFTimeInde
-00014e50: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
-00014e60: 2020 2020 2020 2020 2020 2020 7620 3d20              v = 
-00014e70: 5f70 6172 7365 5f61 7272 6179 5f6f 665f  _parse_array_of_
-00014e80: 6366 7469 6d65 5f73 7472 696e 6773 2876  cftime_strings(v
-00014e90: 2c20 696e 6465 782e 6461 7465 5f74 7970  , index.date_typ
-00014ea0: 6529 0a0a 2020 2020 2020 2020 2020 2020  e)..            
-00014eb0: 2020 2020 6966 2076 2e6e 6469 6d20 3e20      if v.ndim > 
-00014ec0: 313a 0a20 2020 2020 2020 2020 2020 2020  1:.             
-00014ed0: 2020 2020 2020 2072 6169 7365 2049 6e64         raise Ind
-00014ee0: 6578 4572 726f 7228 0a20 2020 2020 2020  exError(.       
-00014ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f00: 2022 556e 6c61 6265 6c65 6420 6d75 6c74   "Unlabeled mult
-00014f10: 692d 6469 6d65 6e73 696f 6e61 6c20 6172  i-dimensional ar
-00014f20: 7261 7920 6361 6e6e 6f74 2062 6520 220a  ray cannot be ".
-00014f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f40: 2020 2020 2020 2020 2275 7365 6420 666f          "used fo
-00014f50: 7220 696e 6465 7869 6e67 3a20 7b7d 222e  r indexing: {}".
-00014f60: 666f 726d 6174 286b 290a 2020 2020 2020  format(k).      
-00014f70: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-00014f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014f90: 7969 656c 6420 6b2c 2076 0a0a 2020 2020  yield k, v..    
-00014fa0: 6465 6620 5f76 616c 6964 6174 655f 696e  def _validate_in
-00014fb0: 7465 7270 5f69 6e64 6578 6572 7328 0a20  terp_indexers(. 
-00014fc0: 2020 2020 2020 2073 656c 662c 2069 6e64         self, ind
-00014fd0: 6578 6572 733a 204d 6170 7069 6e67 5b41  exers: Mapping[A
-00014fe0: 6e79 2c20 416e 795d 0a20 2020 2029 202d  ny, Any].    ) -
-00014ff0: 3e20 4974 6572 6174 6f72 5b74 7570 6c65  > Iterator[tuple
-00015000: 5b48 6173 6861 626c 652c 2056 6172 6961  [Hashable, Varia
-00015010: 626c 655d 5d3a 0a20 2020 2020 2020 2022  ble]]:.        "
-00015020: 2222 5661 7269 616e 7420 6f66 205f 7661  ""Variant of _va
-00015030: 6c69 6461 7465 5f69 6e64 6578 6572 7320  lidate_indexers 
-00015040: 746f 2062 6520 7573 6564 2066 6f72 2069  to be used for i
-00015050: 6e74 6572 706f 6c61 7469 6f6e 2222 220a  nterpolation""".
-00015060: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
-00015070: 2069 6e20 7365 6c66 2e5f 7661 6c69 6461   in self._valida
-00015080: 7465 5f69 6e64 6578 6572 7328 696e 6465  te_indexers(inde
-00015090: 7865 7273 293a 0a20 2020 2020 2020 2020  xers):.         
-000150a0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-000150b0: 2876 2c20 5661 7269 6162 6c65 293a 0a20  (v, Variable):. 
-000150c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000150d0: 6620 762e 6e64 696d 203d 3d20 313a 0a20  f v.ndim == 1:. 
-000150e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000150f0: 2020 2079 6965 6c64 206b 2c20 762e 746f     yield k, v.to
-00015100: 5f69 6e64 6578 5f76 6172 6961 626c 6528  _index_variable(
-00015110: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00015120: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00015130: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
-00015140: 6420 6b2c 2076 0a20 2020 2020 2020 2020  d k, v.         
-00015150: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-00015160: 6365 2876 2c20 696e 7429 3a0a 2020 2020  ce(v, int):.    
-00015170: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
-00015180: 6420 6b2c 2056 6172 6961 626c 6528 2829  d k, Variable(()
-00015190: 2c20 762c 2061 7474 7273 3d73 656c 662e  , v, attrs=self.
-000151a0: 636f 6f72 6473 5b6b 5d2e 6174 7472 7329  coords[k].attrs)
-000151b0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-000151c0: 6620 6973 696e 7374 616e 6365 2876 2c20  f isinstance(v, 
-000151d0: 6e70 2e6e 6461 7272 6179 293a 0a20 2020  np.ndarray):.   
-000151e0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000151f0: 762e 6e64 696d 203d 3d20 303a 0a20 2020  v.ndim == 0:.   
-00015200: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015210: 2079 6965 6c64 206b 2c20 5661 7269 6162   yield k, Variab
-00015220: 6c65 2828 292c 2076 2c20 6174 7472 733d  le((), v, attrs=
-00015230: 7365 6c66 2e63 6f6f 7264 735b 6b5d 2e61  self.coords[k].a
-00015240: 7474 7273 290a 2020 2020 2020 2020 2020  ttrs).          
-00015250: 2020 2020 2020 656c 6966 2076 2e6e 6469        elif v.ndi
-00015260: 6d20 3d3d 2031 3a0a 2020 2020 2020 2020  m == 1:.        
-00015270: 2020 2020 2020 2020 2020 2020 7969 656c              yiel
-00015280: 6420 6b2c 2049 6e64 6578 5661 7269 6162  d k, IndexVariab
-00015290: 6c65 2828 6b2c 292c 2076 2c20 6174 7472  le((k,), v, attr
-000152a0: 733d 7365 6c66 2e63 6f6f 7264 735b 6b5d  s=self.coords[k]
-000152b0: 2e61 7474 7273 290a 2020 2020 2020 2020  .attrs).        
-000152c0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-000152d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000152e0: 2020 7261 6973 6520 4173 7365 7274 696f    raise Assertio
-000152f0: 6e45 7272 6f72 2829 2020 2320 416c 7265  nError()  # Alre
-00015300: 6164 7920 7465 7374 6564 2062 7920 5f76  ady tested by _v
-00015310: 616c 6964 6174 655f 696e 6465 7865 7273  alidate_indexers
-00015320: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00015330: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00015340: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00015350: 6f72 2874 7970 6528 7629 290a 0a20 2020  or(type(v))..   
-00015360: 2064 6566 205f 6765 745f 696e 6465 7865   def _get_indexe
-00015370: 7273 5f63 6f6f 7264 735f 616e 645f 696e  rs_coords_and_in
-00015380: 6465 7865 7328 7365 6c66 2c20 696e 6465  dexes(self, inde
-00015390: 7865 7273 293a 0a20 2020 2020 2020 2022  xers):.        "
-000153a0: 2222 4578 7472 6163 7420 636f 6f72 6469  ""Extract coordi
-000153b0: 6e61 7465 7320 616e 6420 696e 6465 7865  nates and indexe
-000153c0: 7320 6672 6f6d 2069 6e64 6578 6572 732e  s from indexers.
-000153d0: 0a0a 2020 2020 2020 2020 4f6e 6c79 2063  ..        Only c
-000153e0: 6f6f 7264 696e 6174 6520 7769 7468 2061  oordinate with a
-000153f0: 206e 616d 6520 6469 6666 6572 656e 7420   name different 
-00015400: 6672 6f6d 2061 6e79 206f 6620 7365 6c66  from any of self
-00015410: 2e76 6172 6961 626c 6573 2077 696c 6c0a  .variables will.
-00015420: 2020 2020 2020 2020 6265 2061 7474 6163          be attac
-00015430: 6865 642e 0a20 2020 2020 2020 2022 2222  hed..        """
-00015440: 0a20 2020 2020 2020 2066 726f 6d20 7861  .        from xa
-00015450: 7272 6179 2e63 6f72 652e 6461 7461 6172  rray.core.dataar
-00015460: 7261 7920 696d 706f 7274 2044 6174 6141  ray import DataA
-00015470: 7272 6179 0a0a 2020 2020 2020 2020 636f  rray..        co
-00015480: 6f72 6473 5f6c 6973 7420 3d20 5b5d 0a20  ords_list = []. 
-00015490: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
-000154a0: 696e 2069 6e64 6578 6572 732e 6974 656d  in indexers.item
-000154b0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-000154c0: 2069 6620 6973 696e 7374 616e 6365 2876   if isinstance(v
-000154d0: 2c20 4461 7461 4172 7261 7929 3a0a 2020  , DataArray):.  
-000154e0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000154f0: 2076 2e64 7479 7065 2e6b 696e 6420 3d3d   v.dtype.kind ==
-00015500: 2022 6222 3a0a 2020 2020 2020 2020 2020   "b":.          
-00015510: 2020 2020 2020 2020 2020 6966 2076 2e6e            if v.n
-00015520: 6469 6d20 213d 2031 3a20 2023 2077 6520  dim != 1:  # we 
-00015530: 6f6e 6c79 2073 7570 706f 7274 2031 2d64  only support 1-d
-00015540: 2062 6f6f 6c65 616e 2061 7272 6179 0a20   boolean array. 
-00015550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015560: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00015570: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-00015580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015590: 2020 2020 2022 7b3a 647d 642d 626f 6f6c       "{:d}d-bool
-000155a0: 6561 6e20 6172 7261 7920 6973 2075 7365  ean array is use
-000155b0: 6420 666f 7220 696e 6465 7869 6e67 2061  d for indexing a
-000155c0: 6c6f 6e67 2022 0a20 2020 2020 2020 2020  long ".         
-000155d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000155e0: 2020 2022 6469 6d65 6e73 696f 6e20 7b21     "dimension {!
-000155f0: 727d 2c20 6275 7420 6f6e 6c79 2031 6420  r}, but only 1d 
-00015600: 626f 6f6c 6561 6e20 6172 7261 7973 2061  boolean arrays a
-00015610: 7265 2022 0a20 2020 2020 2020 2020 2020  re ".           
-00015620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015630: 2022 7375 7070 6f72 7465 642e 222e 666f   "supported.".fo
-00015640: 726d 6174 2876 2e6e 6469 6d2c 206b 290a  rmat(v.ndim, k).
-00015650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015660: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00015670: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00015680: 4d61 6b65 2073 7572 6520 696e 2063 6173  Make sure in cas
-00015690: 6520 6f66 2062 6f6f 6c65 616e 2044 6174  e of boolean Dat
-000156a0: 6141 7272 6179 2c20 6974 730a 2020 2020  aArray, its.    
-000156b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000156c0: 2320 636f 6f72 6469 6e61 7465 2061 6c73  # coordinate als
-000156d0: 6f20 7368 6f75 6c64 2062 6520 696e 6465  o should be inde
-000156e0: 7865 642e 0a20 2020 2020 2020 2020 2020  xed..           
-000156f0: 2020 2020 2020 2020 2076 5f63 6f6f 7264           v_coord
-00015700: 7320 3d20 765b 762e 7661 6c75 6573 2e6e  s = v[v.values.n
-00015710: 6f6e 7a65 726f 2829 5b30 5d5d 2e63 6f6f  onzero()[0]].coo
-00015720: 7264 730a 2020 2020 2020 2020 2020 2020  rds.            
-00015730: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00015740: 2020 2020 2020 2020 2020 2020 2020 765f                v_
-00015750: 636f 6f72 6473 203d 2076 2e63 6f6f 7264  coords = v.coord
-00015760: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00015770: 2020 636f 6f72 6473 5f6c 6973 742e 6170    coords_list.ap
-00015780: 7065 6e64 2876 5f63 6f6f 7264 7329 0a0a  pend(v_coords)..
-00015790: 2020 2020 2020 2020 2320 7765 2064 6f6e          # we don
-000157a0: 2774 206e 6565 6420 746f 2063 616c 6c20  't need to call 
-000157b0: 616c 6967 6e28 2920 6578 706c 6963 6974  align() explicit
-000157c0: 6c79 206f 7220 6368 6563 6b20 696e 6465  ly or check inde
-000157d0: 7865 7320 666f 720a 2020 2020 2020 2020  xes for.        
-000157e0: 2320 616c 6967 6e6d 656e 742c 2062 6563  # alignment, bec
-000157f0: 6175 7365 206d 6572 6765 5f76 6172 6961  ause merge_varia
-00015800: 626c 6573 2061 6c72 6561 6479 2063 6865  bles already che
-00015810: 636b 7320 666f 7220 6578 6163 7420 616c  cks for exact al
-00015820: 6967 6e6d 656e 740a 2020 2020 2020 2020  ignment.        
-00015830: 2320 6265 7477 6565 6e20 6469 6d65 6e73  # between dimens
-00015840: 696f 6e20 636f 6f72 6469 6e61 7465 730a  ion coordinates.
-00015850: 2020 2020 2020 2020 636f 6f72 6473 2c20          coords, 
-00015860: 696e 6465 7865 7320 3d20 6d65 7267 655f  indexes = merge_
-00015870: 636f 6f72 6469 6e61 7465 735f 7769 7468  coordinates_with
-00015880: 6f75 745f 616c 6967 6e28 636f 6f72 6473  out_align(coords
-00015890: 5f6c 6973 7429 0a20 2020 2020 2020 2061  _list).        a
-000158a0: 7373 6572 745f 636f 6f72 6469 6e61 7465  ssert_coordinate
-000158b0: 5f63 6f6e 7369 7374 656e 7428 7365 6c66  _consistent(self
-000158c0: 2c20 636f 6f72 6473 290a 0a20 2020 2020  , coords)..     
-000158d0: 2020 2023 2073 696c 656e 746c 7920 6472     # silently dr
-000158e0: 6f70 2074 6865 2063 6f6e 666c 6963 7465  op the conflicte
-000158f0: 6420 7661 7269 6162 6c65 732e 0a20 2020  d variables..   
-00015900: 2020 2020 2061 7474 6163 6865 645f 636f       attached_co
-00015910: 6f72 6473 203d 207b 6b3a 2076 2066 6f72  ords = {k: v for
-00015920: 206b 2c20 7620 696e 2063 6f6f 7264 732e   k, v in coords.
-00015930: 6974 656d 7328 2920 6966 206b 206e 6f74  items() if k not
-00015940: 2069 6e20 7365 6c66 2e5f 7661 7269 6162   in self._variab
-00015950: 6c65 737d 0a20 2020 2020 2020 2061 7474  les}.        att
-00015960: 6163 6865 645f 696e 6465 7865 7320 3d20  ached_indexes = 
-00015970: 7b0a 2020 2020 2020 2020 2020 2020 6b3a  {.            k:
-00015980: 2076 2066 6f72 206b 2c20 7620 696e 2069   v for k, v in i
-00015990: 6e64 6578 6573 2e69 7465 6d73 2829 2069  ndexes.items() i
-000159a0: 6620 6b20 6e6f 7420 696e 2073 656c 662e  f k not in self.
-000159b0: 5f76 6172 6961 626c 6573 0a20 2020 2020  _variables.     
-000159c0: 2020 207d 0a20 2020 2020 2020 2072 6574     }.        ret
-000159d0: 7572 6e20 6174 7461 6368 6564 5f63 6f6f  urn attached_coo
-000159e0: 7264 732c 2061 7474 6163 6865 645f 696e  rds, attached_in
-000159f0: 6465 7865 730a 0a20 2020 2064 6566 2069  dexes..    def i
-00015a00: 7365 6c28 0a20 2020 2020 2020 2073 656c  sel(.        sel
-00015a10: 663a 2054 5f44 6174 6173 6574 2c0a 2020  f: T_Dataset,.  
-00015a20: 2020 2020 2020 696e 6465 7865 7273 3a20        indexers: 
-00015a30: 4d61 7070 696e 675b 416e 792c 2041 6e79  Mapping[Any, Any
-00015a40: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-00015a50: 0a20 2020 2020 2020 2064 726f 703a 2062  .        drop: b
-00015a60: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00015a70: 2020 2020 206d 6973 7369 6e67 5f64 696d       missing_dim
-00015a80: 733a 2045 7272 6f72 4f70 7469 6f6e 7357  s: ErrorOptionsW
-00015a90: 6974 6857 6172 6e20 3d20 2272 6169 7365  ithWarn = "raise
-00015aa0: 222c 0a20 2020 2020 2020 202a 2a69 6e64  ",.        **ind
-00015ab0: 6578 6572 735f 6b77 6172 6773 3a20 416e  exers_kwargs: An
-00015ac0: 792c 0a20 2020 2029 202d 3e20 545f 4461  y,.    ) -> T_Da
-00015ad0: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-00015ae0: 2222 5265 7475 726e 7320 6120 6e65 7720  ""Returns a new 
-00015af0: 6461 7461 7365 7420 7769 7468 2065 6163  dataset with eac
-00015b00: 6820 6172 7261 7920 696e 6465 7865 6420  h array indexed 
-00015b10: 616c 6f6e 6720 7468 6520 7370 6563 6966  along the specif
-00015b20: 6965 640a 2020 2020 2020 2020 6469 6d65  ied.        dime
-00015b30: 6e73 696f 6e28 7329 2e0a 0a20 2020 2020  nsion(s)...     
-00015b40: 2020 2054 6869 7320 6d65 7468 6f64 2073     This method s
-00015b50: 656c 6563 7473 2076 616c 7565 7320 6672  elects values fr
-00015b60: 6f6d 2065 6163 6820 6172 7261 7920 7573  om each array us
-00015b70: 696e 6720 6974 7320 605f 5f67 6574 6974  ing its `__getit
-00015b80: 656d 5f5f 600a 2020 2020 2020 2020 6d65  em__`.        me
-00015b90: 7468 6f64 2c20 6578 6365 7074 2074 6869  thod, except thi
-00015ba0: 7320 6d65 7468 6f64 2064 6f65 7320 6e6f  s method does no
-00015bb0: 7420 7265 7175 6972 6520 6b6e 6f77 696e  t require knowin
-00015bc0: 6720 7468 6520 6f72 6465 7220 6f66 0a20  g the order of. 
-00015bd0: 2020 2020 2020 2065 6163 6820 6172 7261         each arra
-00015be0: 7927 7320 6469 6d65 6e73 696f 6e73 2e0a  y's dimensions..
-00015bf0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00015c00: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-00015c10: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
-00015c20: 6e64 6578 6572 7320 3a20 6469 6374 2c20  ndexers : dict, 
-00015c30: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00015c40: 2020 2020 2041 2064 6963 7420 7769 7468       A dict with
-00015c50: 206b 6579 7320 6d61 7463 6869 6e67 2064   keys matching d
-00015c60: 696d 656e 7369 6f6e 7320 616e 6420 7661  imensions and va
-00015c70: 6c75 6573 2067 6976 656e 0a20 2020 2020  lues given.     
-00015c80: 2020 2020 2020 2062 7920 696e 7465 6765         by intege
-00015c90: 7273 2c20 736c 6963 6520 6f62 6a65 6374  rs, slice object
-00015ca0: 7320 6f72 2061 7272 6179 732e 0a20 2020  s or arrays..   
-00015cb0: 2020 2020 2020 2020 2069 6e64 6578 6572           indexer
-00015cc0: 2063 616e 2062 6520 6120 696e 7465 6765   can be a intege
-00015cd0: 722c 2073 6c69 6365 2c20 6172 7261 792d  r, slice, array-
-00015ce0: 6c69 6b65 206f 7220 4461 7461 4172 7261  like or DataArra
-00015cf0: 792e 0a20 2020 2020 2020 2020 2020 2049  y..            I
-00015d00: 6620 4461 7461 4172 7261 7973 2061 7265  f DataArrays are
-00015d10: 2070 6173 7365 6420 6173 2069 6e64 6578   passed as index
-00015d20: 6572 732c 2078 6172 7261 792d 7374 796c  ers, xarray-styl
-00015d30: 6520 696e 6465 7869 6e67 2077 696c 6c20  e indexing will 
-00015d40: 6265 0a20 2020 2020 2020 2020 2020 2063  be.            c
-00015d50: 6172 7269 6564 206f 7574 2e20 5365 6520  arried out. See 
-00015d60: 3a72 6566 3a60 696e 6465 7869 6e67 6020  :ref:`indexing` 
-00015d70: 666f 7220 7468 6520 6465 7461 696c 732e  for the details.
-00015d80: 0a20 2020 2020 2020 2020 2020 204f 6e65  .            One
-00015d90: 206f 6620 696e 6465 7865 7273 206f 7220   of indexers or 
-00015da0: 696e 6465 7865 7273 5f6b 7761 7267 7320  indexers_kwargs 
-00015db0: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
-00015dc0: 2e0a 2020 2020 2020 2020 6472 6f70 203a  ..        drop :
-00015dd0: 2062 6f6f 6c2c 2064 6566 6175 6c74 3a20   bool, default: 
-00015de0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00015df0: 2020 4966 2060 6064 726f 703d 5472 7565    If ``drop=True
-00015e00: 6060 2c20 6472 6f70 2063 6f6f 7264 696e  ``, drop coordin
-00015e10: 6174 6573 2076 6172 6961 626c 6573 2069  ates variables i
-00015e20: 6e64 6578 6564 2062 7920 696e 7465 6765  ndexed by intege
-00015e30: 7273 0a20 2020 2020 2020 2020 2020 2069  rs.            i
-00015e40: 6e73 7465 6164 206f 6620 6d61 6b69 6e67  nstead of making
-00015e50: 2074 6865 6d20 7363 616c 6172 2e0a 2020   them scalar..  
-00015e60: 2020 2020 2020 6d69 7373 696e 675f 6469        missing_di
-00015e70: 6d73 203a 207b 2272 6169 7365 222c 2022  ms : {"raise", "
-00015e80: 7761 726e 222c 2022 6967 6e6f 7265 227d  warn", "ignore"}
-00015e90: 2c20 6465 6661 756c 743a 2022 7261 6973  , default: "rais
-00015ea0: 6522 0a20 2020 2020 2020 2020 2020 2057  e".            W
-00015eb0: 6861 7420 746f 2064 6f20 6966 2064 696d  hat to do if dim
-00015ec0: 656e 7369 6f6e 7320 7468 6174 2073 686f  ensions that sho
-00015ed0: 756c 6420 6265 2073 656c 6563 7465 6420  uld be selected 
-00015ee0: 6672 6f6d 2061 7265 206e 6f74 2070 7265  from are not pre
-00015ef0: 7365 6e74 2069 6e20 7468 650a 2020 2020  sent in the.    
-00015f00: 2020 2020 2020 2020 4461 7461 7365 743a          Dataset:
-00015f10: 0a20 2020 2020 2020 2020 2020 202d 2022  .            - "
-00015f20: 7261 6973 6522 3a20 7261 6973 6520 616e  raise": raise an
-00015f30: 2065 7863 6570 7469 6f6e 0a20 2020 2020   exception.     
-00015f40: 2020 2020 2020 202d 2022 7761 726e 223a         - "warn":
-00015f50: 2072 6169 7365 2061 2077 6172 6e69 6e67   raise a warning
-00015f60: 2c20 616e 6420 6967 6e6f 7265 2074 6865  , and ignore the
-00015f70: 206d 6973 7369 6e67 2064 696d 656e 7369   missing dimensi
-00015f80: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
-00015f90: 2d20 2269 676e 6f72 6522 3a20 6967 6e6f  - "ignore": igno
-00015fa0: 7265 2074 6865 206d 6973 7369 6e67 2064  re the missing d
-00015fb0: 696d 656e 7369 6f6e 730a 0a20 2020 2020  imensions..     
-00015fc0: 2020 202a 2a69 6e64 6578 6572 735f 6b77     **indexers_kw
-00015fd0: 6172 6773 203a 207b 6469 6d3a 2069 6e64  args : {dim: ind
-00015fe0: 6578 6572 2c20 2e2e 2e7d 2c20 6f70 7469  exer, ...}, opti
-00015ff0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00016000: 2054 6865 206b 6579 776f 7264 2061 7267   The keyword arg
-00016010: 756d 656e 7473 2066 6f72 6d20 6f66 2060  uments form of `
-00016020: 6069 6e64 6578 6572 7360 602e 0a20 2020  `indexers``..   
-00016030: 2020 2020 2020 2020 204f 6e65 206f 6620           One of 
-00016040: 696e 6465 7865 7273 206f 7220 696e 6465  indexers or inde
-00016050: 7865 7273 5f6b 7761 7267 7320 6d75 7374  xers_kwargs must
-00016060: 2062 6520 7072 6f76 6964 6564 2e0a 0a20   be provided... 
-00016070: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00016080: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-00016090: 2020 2020 2020 206f 626a 203a 2044 6174         obj : Dat
-000160a0: 6173 6574 0a20 2020 2020 2020 2020 2020  aset.           
-000160b0: 2041 206e 6577 2044 6174 6173 6574 2077   A new Dataset w
-000160c0: 6974 6820 7468 6520 7361 6d65 2063 6f6e  ith the same con
-000160d0: 7465 6e74 7320 6173 2074 6869 7320 6461  tents as this da
-000160e0: 7461 7365 742c 2065 7863 6570 7420 6561  taset, except ea
-000160f0: 6368 0a20 2020 2020 2020 2020 2020 2061  ch.            a
-00016100: 7272 6179 2061 6e64 2064 696d 656e 7369  rray and dimensi
-00016110: 6f6e 2069 7320 696e 6465 7865 6420 6279  on is indexed by
-00016120: 2074 6865 2061 7070 726f 7072 6961 7465   the appropriate
-00016130: 2069 6e64 6578 6572 732e 0a20 2020 2020   indexers..     
-00016140: 2020 2020 2020 2049 6620 696e 6465 7865         If indexe
-00016150: 7220 4461 7461 4172 7261 7973 2068 6176  r DataArrays hav
-00016160: 6520 636f 6f72 6469 6e61 7465 7320 7468  e coordinates th
-00016170: 6174 2064 6f20 6e6f 7420 636f 6e66 6c69  at do not confli
-00016180: 6374 2077 6974 680a 2020 2020 2020 2020  ct with.        
-00016190: 2020 2020 7468 6973 206f 626a 6563 742c      this object,
-000161a0: 2074 6865 6e20 7468 6573 6520 636f 6f72   then these coor
-000161b0: 6469 6e61 7465 7320 7769 6c6c 2062 6520  dinates will be 
-000161c0: 6174 7461 6368 6564 2e0a 2020 2020 2020  attached..      
-000161d0: 2020 2020 2020 496e 2067 656e 6572 616c        In general
-000161e0: 2c20 6561 6368 2061 7272 6179 2773 2064  , each array's d
-000161f0: 6174 6120 7769 6c6c 2062 6520 6120 7669  ata will be a vi
-00016200: 6577 206f 6620 7468 6520 6172 7261 7927  ew of the array'
-00016210: 7320 6461 7461 0a20 2020 2020 2020 2020  s data.         
-00016220: 2020 2069 6e20 7468 6973 2064 6174 6173     in this datas
-00016230: 6574 2c20 756e 6c65 7373 2076 6563 746f  et, unless vecto
-00016240: 7269 7a65 6420 696e 6465 7869 6e67 2077  rized indexing w
-00016250: 6173 2074 7269 6767 6572 6564 2062 7920  as triggered by 
-00016260: 7573 696e 670a 2020 2020 2020 2020 2020  using.          
-00016270: 2020 616e 2061 7272 6179 2069 6e64 6578    an array index
-00016280: 6572 2c20 696e 2077 6869 6368 2063 6173  er, in which cas
-00016290: 6520 7468 6520 6461 7461 2077 696c 6c20  e the data will 
-000162a0: 6265 2061 2063 6f70 792e 0a0a 2020 2020  be a copy...    
-000162b0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
-000162c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-000162d0: 2020 2020 2020 4461 7461 7365 742e 7365        Dataset.se
-000162e0: 6c0a 2020 2020 2020 2020 4461 7461 4172  l.        DataAr
-000162f0: 7261 792e 6973 656c 0a20 2020 2020 2020  ray.isel.       
-00016300: 2022 2222 0a20 2020 2020 2020 2069 6e64   """.        ind
-00016310: 6578 6572 7320 3d20 6569 7468 6572 5f64  exers = either_d
-00016320: 6963 745f 6f72 5f6b 7761 7267 7328 696e  ict_or_kwargs(in
-00016330: 6465 7865 7273 2c20 696e 6465 7865 7273  dexers, indexers
-00016340: 5f6b 7761 7267 732c 2022 6973 656c 2229  _kwargs, "isel")
-00016350: 0a20 2020 2020 2020 2069 6620 616e 7928  .        if any(
-00016360: 6973 5f66 616e 6379 5f69 6e64 6578 6572  is_fancy_indexer
-00016370: 2869 6478 2920 666f 7220 6964 7820 696e  (idx) for idx in
-00016380: 2069 6e64 6578 6572 732e 7661 6c75 6573   indexers.values
-00016390: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
-000163a0: 2072 6574 7572 6e20 7365 6c66 2e5f 6973   return self._is
-000163b0: 656c 5f66 616e 6379 2869 6e64 6578 6572  el_fancy(indexer
-000163c0: 732c 2064 726f 703d 6472 6f70 2c20 6d69  s, drop=drop, mi
-000163d0: 7373 696e 675f 6469 6d73 3d6d 6973 7369  ssing_dims=missi
-000163e0: 6e67 5f64 696d 7329 0a0a 2020 2020 2020  ng_dims)..      
-000163f0: 2020 2320 4d75 6368 2066 6173 7465 7220    # Much faster 
-00016400: 616c 676f 7269 7468 6d20 666f 7220 7768  algorithm for wh
-00016410: 656e 2061 6c6c 2069 6e64 6578 6572 7320  en all indexers 
-00016420: 6172 6520 696e 7473 2c20 736c 6963 6573  are ints, slices
-00016430: 2c20 6f6e 652d 6469 6d65 6e73 696f 6e61  , one-dimensiona
-00016440: 6c0a 2020 2020 2020 2020 2320 6c69 7374  l.        # list
-00016450: 732c 206f 7220 7a65 726f 206f 7220 6f6e  s, or zero or on
-00016460: 652d 6469 6d65 6e73 696f 6e61 6c20 6e70  e-dimensional np
-00016470: 2e6e 6461 7272 6179 2773 0a20 2020 2020  .ndarray's.     
-00016480: 2020 2069 6e64 6578 6572 7320 3d20 6472     indexers = dr
-00016490: 6f70 5f64 696d 735f 6672 6f6d 5f69 6e64  op_dims_from_ind
-000164a0: 6578 6572 7328 696e 6465 7865 7273 2c20  exers(indexers, 
-000164b0: 7365 6c66 2e64 696d 732c 206d 6973 7369  self.dims, missi
-000164c0: 6e67 5f64 696d 7329 0a0a 2020 2020 2020  ng_dims)..      
-000164d0: 2020 7661 7269 6162 6c65 7320 3d20 7b7d    variables = {}
-000164e0: 0a20 2020 2020 2020 2064 696d 733a 2064  .        dims: d
-000164f0: 6963 745b 4861 7368 6162 6c65 2c20 696e  ict[Hashable, in
-00016500: 745d 203d 207b 7d0a 2020 2020 2020 2020  t] = {}.        
-00016510: 636f 6f72 645f 6e61 6d65 7320 3d20 7365  coord_names = se
-00016520: 6c66 2e5f 636f 6f72 645f 6e61 6d65 732e  lf._coord_names.
-00016530: 636f 7079 2829 0a0a 2020 2020 2020 2020  copy()..        
-00016540: 696e 6465 7865 732c 2069 6e64 6578 5f76  indexes, index_v
-00016550: 6172 6961 626c 6573 203d 2069 7365 6c5f  ariables = isel_
-00016560: 696e 6465 7865 7328 7365 6c66 2e78 696e  indexes(self.xin
-00016570: 6465 7865 732c 2069 6e64 6578 6572 7329  dexes, indexers)
-00016580: 0a0a 2020 2020 2020 2020 666f 7220 6e61  ..        for na
-00016590: 6d65 2c20 7661 7220 696e 2073 656c 662e  me, var in self.
-000165a0: 5f76 6172 6961 626c 6573 2e69 7465 6d73  _variables.items
-000165b0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-000165c0: 2320 7072 6573 6572 7665 2076 6172 6961  # preserve varia
-000165d0: 626c 6520 6f72 6465 720a 2020 2020 2020  ble order.      
-000165e0: 2020 2020 2020 6966 206e 616d 6520 696e        if name in
-000165f0: 2069 6e64 6578 5f76 6172 6961 626c 6573   index_variables
-00016600: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00016610: 2020 7661 7220 3d20 696e 6465 785f 7661    var = index_va
-00016620: 7269 6162 6c65 735b 6e61 6d65 5d0a 2020  riables[name].  
-00016630: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00016640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016650: 7661 725f 696e 6465 7865 7273 203d 207b  var_indexers = {
-00016660: 6b3a 2076 2066 6f72 206b 2c20 7620 696e  k: v for k, v in
-00016670: 2069 6e64 6578 6572 732e 6974 656d 7328   indexers.items(
-00016680: 2920 6966 206b 2069 6e20 7661 722e 6469  ) if k in var.di
-00016690: 6d73 7d0a 2020 2020 2020 2020 2020 2020  ms}.            
-000166a0: 2020 2020 6966 2076 6172 5f69 6e64 6578      if var_index
-000166b0: 6572 733a 0a20 2020 2020 2020 2020 2020  ers:.           
-000166c0: 2020 2020 2020 2020 2076 6172 203d 2076           var = v
-000166d0: 6172 2e69 7365 6c28 7661 725f 696e 6465  ar.isel(var_inde
-000166e0: 7865 7273 290a 2020 2020 2020 2020 2020  xers).          
-000166f0: 2020 2020 2020 2020 2020 6966 2064 726f            if dro
-00016700: 7020 616e 6420 7661 722e 6e64 696d 203d  p and var.ndim =
-00016710: 3d20 3020 616e 6420 6e61 6d65 2069 6e20  = 0 and name in 
-00016720: 636f 6f72 645f 6e61 6d65 733a 0a20 2020  coord_names:.   
-00016730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016740: 2020 2020 2063 6f6f 7264 5f6e 616d 6573       coord_names
-00016750: 2e72 656d 6f76 6528 6e61 6d65 290a 2020  .remove(name).  
-00016760: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016770: 2020 2020 2020 636f 6e74 696e 7565 0a20        continue. 
-00016780: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-00016790: 626c 6573 5b6e 616d 655d 203d 2076 6172  bles[name] = var
-000167a0: 0a20 2020 2020 2020 2020 2020 2064 696d  .            dim
-000167b0: 732e 7570 6461 7465 287a 6970 2876 6172  s.update(zip(var
-000167c0: 2e64 696d 732c 2076 6172 2e73 6861 7065  .dims, var.shape
-000167d0: 2929 0a0a 2020 2020 2020 2020 7265 7475  ))..        retu
-000167e0: 726e 2073 656c 662e 5f63 6f6e 7374 7275  rn self._constru
-000167f0: 6374 5f64 6972 6563 7428 0a20 2020 2020  ct_direct(.     
-00016800: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-00016810: 3d76 6172 6961 626c 6573 2c0a 2020 2020  =variables,.    
-00016820: 2020 2020 2020 2020 636f 6f72 645f 6e61          coord_na
-00016830: 6d65 733d 636f 6f72 645f 6e61 6d65 732c  mes=coord_names,
-00016840: 0a20 2020 2020 2020 2020 2020 2064 696d  .            dim
-00016850: 733d 6469 6d73 2c0a 2020 2020 2020 2020  s=dims,.        
-00016860: 2020 2020 6174 7472 733d 7365 6c66 2e5f      attrs=self._
-00016870: 6174 7472 732c 0a20 2020 2020 2020 2020  attrs,.         
-00016880: 2020 2069 6e64 6578 6573 3d69 6e64 6578     indexes=index
-00016890: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-000168a0: 656e 636f 6469 6e67 3d73 656c 662e 5f65  encoding=self._e
-000168b0: 6e63 6f64 696e 672c 0a20 2020 2020 2020  ncoding,.       
-000168c0: 2020 2020 2063 6c6f 7365 3d73 656c 662e       close=self.
-000168d0: 5f63 6c6f 7365 2c0a 2020 2020 2020 2020  _close,.        
-000168e0: 290a 0a20 2020 2064 6566 205f 6973 656c  )..    def _isel
-000168f0: 5f66 616e 6379 280a 2020 2020 2020 2020  _fancy(.        
-00016900: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
-00016910: 0a20 2020 2020 2020 2069 6e64 6578 6572  .        indexer
-00016920: 733a 204d 6170 7069 6e67 5b41 6e79 2c20  s: Mapping[Any, 
-00016930: 416e 795d 2c0a 2020 2020 2020 2020 2a2c  Any],.        *,
-00016940: 0a20 2020 2020 2020 2064 726f 703a 2062  .        drop: b
-00016950: 6f6f 6c2c 0a20 2020 2020 2020 206d 6973  ool,.        mis
-00016960: 7369 6e67 5f64 696d 733a 2045 7272 6f72  sing_dims: Error
-00016970: 4f70 7469 6f6e 7357 6974 6857 6172 6e20  OptionsWithWarn 
-00016980: 3d20 2272 6169 7365 222c 0a20 2020 2029  = "raise",.    )
-00016990: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
-000169a0: 2020 2020 2020 2076 616c 6964 5f69 6e64         valid_ind
-000169b0: 6578 6572 7320 3d20 6469 6374 2873 656c  exers = dict(sel
-000169c0: 662e 5f76 616c 6964 6174 655f 696e 6465  f._validate_inde
-000169d0: 7865 7273 2869 6e64 6578 6572 732c 206d  xers(indexers, m
-000169e0: 6973 7369 6e67 5f64 696d 7329 290a 0a20  issing_dims)).. 
-000169f0: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-00016a00: 3a20 6469 6374 5b48 6173 6861 626c 652c  : dict[Hashable,
-00016a10: 2056 6172 6961 626c 655d 203d 207b 7d0a   Variable] = {}.
-00016a20: 2020 2020 2020 2020 696e 6465 7865 732c          indexes,
-00016a30: 2069 6e64 6578 5f76 6172 6961 626c 6573   index_variables
-00016a40: 203d 2069 7365 6c5f 696e 6465 7865 7328   = isel_indexes(
-00016a50: 7365 6c66 2e78 696e 6465 7865 732c 2076  self.xindexes, v
-00016a60: 616c 6964 5f69 6e64 6578 6572 7329 0a0a  alid_indexers)..
-00016a70: 2020 2020 2020 2020 666f 7220 6e61 6d65          for name
-00016a80: 2c20 7661 7220 696e 2073 656c 662e 7661  , var in self.va
-00016a90: 7269 6162 6c65 732e 6974 656d 7328 293a  riables.items():
-00016aa0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00016ab0: 6e61 6d65 2069 6e20 696e 6465 785f 7661  name in index_va
-00016ac0: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
-00016ad0: 2020 2020 2020 2020 206e 6577 5f76 6172           new_var
-00016ae0: 203d 2069 6e64 6578 5f76 6172 6961 626c   = index_variabl
-00016af0: 6573 5b6e 616d 655d 0a20 2020 2020 2020  es[name].       
-00016b00: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00016b10: 2020 2020 2020 2020 2020 2076 6172 5f69             var_i
-00016b20: 6e64 6578 6572 7320 3d20 7b0a 2020 2020  ndexers = {.    
-00016b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b40: 6b3a 2076 2066 6f72 206b 2c20 7620 696e  k: v for k, v in
-00016b50: 2076 616c 6964 5f69 6e64 6578 6572 732e   valid_indexers.
-00016b60: 6974 656d 7328 2920 6966 206b 2069 6e20  items() if k in 
-00016b70: 7661 722e 6469 6d73 0a20 2020 2020 2020  var.dims.       
-00016b80: 2020 2020 2020 2020 207d 0a20 2020 2020           }.     
-00016b90: 2020 2020 2020 2020 2020 2069 6620 7661             if va
-00016ba0: 725f 696e 6465 7865 7273 3a0a 2020 2020  r_indexers:.    
-00016bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016bc0: 6e65 775f 7661 7220 3d20 7661 722e 6973  new_var = var.is
-00016bd0: 656c 2869 6e64 6578 6572 733d 7661 725f  el(indexers=var_
-00016be0: 696e 6465 7865 7273 290a 2020 2020 2020  indexers).      
-00016bf0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00016c00: 6472 6f70 2073 6361 6c61 7220 636f 6f72  drop scalar coor
-00016c10: 6469 6e61 7465 730a 2020 2020 2020 2020  dinates.        
-00016c20: 2020 2020 2020 2020 2020 2020 2320 6874              # ht
-00016c30: 7470 733a 2f2f 6769 7468 7562 2e63 6f6d  tps://github.com
-00016c40: 2f70 7964 6174 612f 7861 7272 6179 2f69  /pydata/xarray/i
-00016c50: 7373 7565 732f 3635 3534 0a20 2020 2020  ssues/6554.     
-00016c60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00016c70: 6620 6e61 6d65 2069 6e20 7365 6c66 2e63  f name in self.c
-00016c80: 6f6f 7264 7320 616e 6420 6472 6f70 2061  oords and drop a
-00016c90: 6e64 206e 6577 5f76 6172 2e6e 6469 6d20  nd new_var.ndim 
-00016ca0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00016cb0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00016cc0: 6e74 696e 7565 0a20 2020 2020 2020 2020  ntinue.         
-00016cd0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00016ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016cf0: 206e 6577 5f76 6172 203d 2076 6172 2e63   new_var = var.c
-00016d00: 6f70 7928 6465 6570 3d46 616c 7365 290a  opy(deep=False).
-00016d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d20: 6966 206e 616d 6520 6e6f 7420 696e 2069  if name not in i
-00016d30: 6e64 6578 6573 3a0a 2020 2020 2020 2020  ndexes:.        
-00016d40: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00016d50: 7661 7220 3d20 6e65 775f 7661 722e 746f  var = new_var.to
-00016d60: 5f62 6173 655f 7661 7269 6162 6c65 2829  _base_variable()
-00016d70: 0a20 2020 2020 2020 2020 2020 2076 6172  .            var
-00016d80: 6961 626c 6573 5b6e 616d 655d 203d 206e  iables[name] = n
-00016d90: 6577 5f76 6172 0a0a 2020 2020 2020 2020  ew_var..        
-00016da0: 636f 6f72 645f 6e61 6d65 7320 3d20 7365  coord_names = se
-00016db0: 6c66 2e5f 636f 6f72 645f 6e61 6d65 7320  lf._coord_names 
-00016dc0: 2620 7661 7269 6162 6c65 732e 6b65 7973  & variables.keys
-00016dd0: 2829 0a20 2020 2020 2020 2073 656c 6563  ().        selec
-00016de0: 7465 6420 3d20 7365 6c66 2e5f 7265 706c  ted = self._repl
-00016df0: 6163 655f 7769 7468 5f6e 6577 5f64 696d  ace_with_new_dim
-00016e00: 7328 7661 7269 6162 6c65 732c 2063 6f6f  s(variables, coo
-00016e10: 7264 5f6e 616d 6573 2c20 696e 6465 7865  rd_names, indexe
-00016e20: 7329 0a0a 2020 2020 2020 2020 2320 4578  s)..        # Ex
-00016e30: 7472 6163 7420 636f 6f72 6469 6e61 7465  tract coordinate
-00016e40: 7320 6672 6f6d 2069 6e64 6578 6572 730a  s from indexers.
-00016e50: 2020 2020 2020 2020 636f 6f72 645f 7661          coord_va
-00016e60: 7273 2c20 6e65 775f 696e 6465 7865 7320  rs, new_indexes 
-00016e70: 3d20 7365 6c65 6374 6564 2e5f 6765 745f  = selected._get_
-00016e80: 696e 6465 7865 7273 5f63 6f6f 7264 735f  indexers_coords_
-00016e90: 616e 645f 696e 6465 7865 7328 696e 6465  and_indexes(inde
-00016ea0: 7865 7273 290a 2020 2020 2020 2020 7661  xers).        va
-00016eb0: 7269 6162 6c65 732e 7570 6461 7465 2863  riables.update(c
-00016ec0: 6f6f 7264 5f76 6172 7329 0a20 2020 2020  oord_vars).     
-00016ed0: 2020 2069 6e64 6578 6573 2e75 7064 6174     indexes.updat
-00016ee0: 6528 6e65 775f 696e 6465 7865 7329 0a20  e(new_indexes). 
-00016ef0: 2020 2020 2020 2063 6f6f 7264 5f6e 616d         coord_nam
-00016f00: 6573 203d 2073 656c 662e 5f63 6f6f 7264  es = self._coord
-00016f10: 5f6e 616d 6573 2026 2076 6172 6961 626c  _names & variabl
-00016f20: 6573 2e6b 6579 7328 2920 7c20 636f 6f72  es.keys() | coor
-00016f30: 645f 7661 7273 2e6b 6579 7328 290a 2020  d_vars.keys().  
-00016f40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00016f50: 662e 5f72 6570 6c61 6365 5f77 6974 685f  f._replace_with_
-00016f60: 6e65 775f 6469 6d73 2876 6172 6961 626c  new_dims(variabl
-00016f70: 6573 2c20 636f 6f72 645f 6e61 6d65 732c  es, coord_names,
-00016f80: 2069 6e64 6578 6573 3d69 6e64 6578 6573   indexes=indexes
-00016f90: 290a 0a20 2020 2064 6566 2073 656c 280a  )..    def sel(.
-00016fa0: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
-00016fb0: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
-00016fc0: 2069 6e64 6578 6572 733a 204d 6170 7069   indexers: Mappi
-00016fd0: 6e67 5b41 6e79 2c20 416e 795d 207c 204e  ng[Any, Any] | N
-00016fe0: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-00016ff0: 2020 2020 6d65 7468 6f64 3a20 7374 7220      method: str 
-00017000: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00017010: 2020 2020 2020 2074 6f6c 6572 616e 6365         tolerance
-00017020: 3a20 696e 7420 7c20 666c 6f61 7420 7c20  : int | float | 
-00017030: 4974 6572 6162 6c65 5b69 6e74 207c 2066  Iterable[int | f
-00017040: 6c6f 6174 5d20 7c20 4e6f 6e65 203d 204e  loat] | None = N
-00017050: 6f6e 652c 0a20 2020 2020 2020 2064 726f  one,.        dro
-00017060: 703a 2062 6f6f 6c20 3d20 4661 6c73 652c  p: bool = False,
-00017070: 0a20 2020 2020 2020 202a 2a69 6e64 6578  .        **index
-00017080: 6572 735f 6b77 6172 6773 3a20 416e 792c  ers_kwargs: Any,
-00017090: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
-000170a0: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
-000170b0: 5265 7475 726e 7320 6120 6e65 7720 6461  Returns a new da
-000170c0: 7461 7365 7420 7769 7468 2065 6163 6820  taset with each 
-000170d0: 6172 7261 7920 696e 6465 7865 6420 6279  array indexed by
-000170e0: 2074 6963 6b20 6c61 6265 6c73 0a20 2020   tick labels.   
-000170f0: 2020 2020 2061 6c6f 6e67 2074 6865 2073       along the s
-00017100: 7065 6369 6669 6564 2064 696d 656e 7369  pecified dimensi
-00017110: 6f6e 2873 292e 0a0a 2020 2020 2020 2020  on(s)...        
-00017120: 496e 2063 6f6e 7472 6173 7420 746f 2060  In contrast to `
-00017130: 4461 7461 7365 742e 6973 656c 602c 2069  Dataset.isel`, i
-00017140: 6e64 6578 6572 7320 666f 7220 7468 6973  ndexers for this
-00017150: 206d 6574 686f 6420 7368 6f75 6c64 2075   method should u
-00017160: 7365 0a20 2020 2020 2020 206c 6162 656c  se.        label
-00017170: 7320 696e 7374 6561 6420 6f66 2069 6e74  s instead of int
-00017180: 6567 6572 732e 0a0a 2020 2020 2020 2020  egers...        
-00017190: 556e 6465 7220 7468 6520 686f 6f64 2c20  Under the hood, 
-000171a0: 7468 6973 206d 6574 686f 6420 6973 2070  this method is p
-000171b0: 6f77 6572 6564 2062 7920 7573 696e 6720  owered by using 
-000171c0: 7061 6e64 6173 2773 2070 6f77 6572 6675  pandas's powerfu
-000171d0: 6c20 496e 6465 780a 2020 2020 2020 2020  l Index.        
-000171e0: 6f62 6a65 6374 732e 2054 6869 7320 6d61  objects. This ma
-000171f0: 6b65 7320 6c61 6265 6c20 6261 7365 6420  kes label based 
-00017200: 696e 6465 7869 6e67 2065 7373 656e 7469  indexing essenti
-00017210: 616c 6c79 206a 7573 7420 6173 2066 6173  ally just as fas
-00017220: 7420 6173 0a20 2020 2020 2020 2075 7369  t as.        usi
-00017230: 6e67 2069 6e74 6567 6572 2069 6e64 6578  ng integer index
-00017240: 696e 672e 0a0a 2020 2020 2020 2020 4974  ing...        It
-00017250: 2061 6c73 6f20 6d65 616e 7320 7468 6973   also means this
-00017260: 206d 6574 686f 6420 7573 6573 2070 616e   method uses pan
-00017270: 6461 7327 7320 2877 656c 6c20 646f 6375  das's (well docu
-00017280: 6d65 6e74 6564 2920 6c6f 6769 6320 666f  mented) logic fo
-00017290: 720a 2020 2020 2020 2020 696e 6465 7869  r.        indexi
-000172a0: 6e67 2e20 5468 6973 206d 6561 6e73 2079  ng. This means y
-000172b0: 6f75 2063 616e 2075 7365 2073 7472 696e  ou can use strin
-000172c0: 6720 7368 6f72 7463 7574 7320 666f 7220  g shortcuts for 
-000172d0: 6461 7465 7469 6d65 2069 6e64 6578 6573  datetime indexes
-000172e0: 0a20 2020 2020 2020 2028 652e 672e 2c20  .        (e.g., 
-000172f0: 2732 3030 302d 3031 2720 746f 2073 656c  '2000-01' to sel
-00017300: 6563 7420 616c 6c20 7661 6c75 6573 2069  ect all values i
-00017310: 6e20 4a61 6e75 6172 7920 3230 3030 292e  n January 2000).
-00017320: 2049 7420 616c 736f 206d 6561 6e73 0a20   It also means. 
-00017330: 2020 2020 2020 2074 6861 7420 736c 6963         that slic
-00017340: 6573 2061 7265 2074 7265 6174 6564 2061  es are treated a
-00017350: 7320 696e 636c 7573 6976 6520 6f66 2062  s inclusive of b
-00017360: 6f74 6820 7468 6520 7374 6172 7420 616e  oth the start an
-00017370: 6420 7374 6f70 2076 616c 7565 732c 0a20  d stop values,. 
-00017380: 2020 2020 2020 2075 6e6c 696b 6520 6e6f         unlike no
-00017390: 726d 616c 2050 7974 686f 6e20 696e 6465  rmal Python inde
-000173a0: 7869 6e67 2e0a 0a20 2020 2020 2020 2050  xing...        P
-000173b0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-000173c0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-000173d0: 2020 2020 2069 6e64 6578 6572 7320 3a20       indexers : 
-000173e0: 6469 6374 2c20 6f70 7469 6f6e 616c 0a20  dict, optional. 
-000173f0: 2020 2020 2020 2020 2020 2041 2064 6963             A dic
-00017400: 7420 7769 7468 206b 6579 7320 6d61 7463  t with keys matc
-00017410: 6869 6e67 2064 696d 656e 7369 6f6e 7320  hing dimensions 
-00017420: 616e 6420 7661 6c75 6573 2067 6976 656e  and values given
-00017430: 0a20 2020 2020 2020 2020 2020 2062 7920  .            by 
-00017440: 7363 616c 6172 732c 2073 6c69 6365 7320  scalars, slices 
-00017450: 6f72 2061 7272 6179 7320 6f66 2074 6963  or arrays of tic
-00017460: 6b20 6c61 6265 6c73 2e20 466f 7220 6469  k labels. For di
-00017470: 6d65 6e73 696f 6e73 2077 6974 680a 2020  mensions with.  
-00017480: 2020 2020 2020 2020 2020 6d75 6c74 692d            multi-
-00017490: 696e 6465 782c 2074 6865 2069 6e64 6578  index, the index
-000174a0: 6572 206d 6179 2061 6c73 6f20 6265 2061  er may also be a
-000174b0: 2064 6963 742d 6c69 6b65 206f 626a 6563   dict-like objec
-000174c0: 7420 7769 7468 206b 6579 730a 2020 2020  t with keys.    
-000174d0: 2020 2020 2020 2020 6d61 7463 6869 6e67          matching
-000174e0: 2069 6e64 6578 206c 6576 656c 206e 616d   index level nam
-000174f0: 6573 2e0a 2020 2020 2020 2020 2020 2020  es..            
-00017500: 4966 2044 6174 6141 7272 6179 7320 6172  If DataArrays ar
-00017510: 6520 7061 7373 6564 2061 7320 696e 6465  e passed as inde
-00017520: 7865 7273 2c20 7861 7272 6179 2d73 7479  xers, xarray-sty
-00017530: 6c65 2069 6e64 6578 696e 6720 7769 6c6c  le indexing will
-00017540: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
-00017550: 6361 7272 6965 6420 6f75 742e 2053 6565  carried out. See
-00017560: 203a 7265 663a 6069 6e64 6578 696e 6760   :ref:`indexing`
-00017570: 2066 6f72 2074 6865 2064 6574 6169 6c73   for the details
-00017580: 2e0a 2020 2020 2020 2020 2020 2020 4f6e  ..            On
-00017590: 6520 6f66 2069 6e64 6578 6572 7320 6f72  e of indexers or
-000175a0: 2069 6e64 6578 6572 735f 6b77 6172 6773   indexers_kwargs
-000175b0: 206d 7573 7420 6265 2070 726f 7669 6465   must be provide
-000175c0: 642e 0a20 2020 2020 2020 206d 6574 686f  d..        metho
-000175d0: 6420 3a20 7b4e 6f6e 652c 2022 6e65 6172  d : {None, "near
-000175e0: 6573 7422 2c20 2270 6164 222c 2022 6666  est", "pad", "ff
-000175f0: 696c 6c22 2c20 2262 6163 6b66 696c 6c22  ill", "backfill"
-00017600: 2c20 2262 6669 6c6c 227d 2c20 6f70 7469  , "bfill"}, opti
-00017610: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00017620: 204d 6574 686f 6420 746f 2075 7365 2066   Method to use f
-00017630: 6f72 2069 6e65 7861 6374 206d 6174 6368  or inexact match
-00017640: 6573 3a0a 0a20 2020 2020 2020 2020 2020  es:..           
-00017650: 202a 204e 6f6e 6520 2864 6566 6175 6c74   * None (default
-00017660: 293a 206f 6e6c 7920 6578 6163 7420 6d61  ): only exact ma
-00017670: 7463 6865 730a 2020 2020 2020 2020 2020  tches.          
-00017680: 2020 2a20 7061 6420 2f20 6666 696c 6c3a    * pad / ffill:
-00017690: 2070 726f 7061 6761 7465 206c 6173 7420   propagate last 
-000176a0: 7661 6c69 6420 696e 6465 7820 7661 6c75  valid index valu
-000176b0: 6520 666f 7277 6172 640a 2020 2020 2020  e forward.      
-000176c0: 2020 2020 2020 2a20 6261 636b 6669 6c6c        * backfill
-000176d0: 202f 2062 6669 6c6c 3a20 7072 6f70 6167   / bfill: propag
-000176e0: 6174 6520 6e65 7874 2076 616c 6964 2069  ate next valid i
-000176f0: 6e64 6578 2076 616c 7565 2062 6163 6b77  ndex value backw
-00017700: 6172 640a 2020 2020 2020 2020 2020 2020  ard.            
-00017710: 2a20 6e65 6172 6573 743a 2075 7365 206e  * nearest: use n
-00017720: 6561 7265 7374 2076 616c 6964 2069 6e64  earest valid ind
-00017730: 6578 2076 616c 7565 0a20 2020 2020 2020  ex value.       
-00017740: 2074 6f6c 6572 616e 6365 203a 206f 7074   tolerance : opt
-00017750: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00017760: 2020 4d61 7869 6d75 6d20 6469 7374 616e    Maximum distan
-00017770: 6365 2062 6574 7765 656e 206f 7269 6769  ce between origi
-00017780: 6e61 6c20 616e 6420 6e65 7720 6c61 6265  nal and new labe
-00017790: 6c73 2066 6f72 2069 6e65 7861 6374 0a20  ls for inexact. 
-000177a0: 2020 2020 2020 2020 2020 206d 6174 6368             match
-000177b0: 6573 2e20 5468 6520 7661 6c75 6573 206f  es. The values o
-000177c0: 6620 7468 6520 696e 6465 7820 6174 2074  f the index at t
-000177d0: 6865 206d 6174 6368 696e 6720 6c6f 6361  he matching loca
-000177e0: 7469 6f6e 7320 6d75 7374 0a20 2020 2020  tions must.     
-000177f0: 2020 2020 2020 2073 6174 6973 6679 2074         satisfy t
-00017800: 6865 2065 7175 6174 696f 6e20 6060 6162  he equation ``ab
-00017810: 7328 696e 6465 785b 696e 6465 7865 725d  s(index[indexer]
-00017820: 202d 2074 6172 6765 7429 203c 3d20 746f   - target) <= to
-00017830: 6c65 7261 6e63 6560 602e 0a20 2020 2020  lerance``..     
-00017840: 2020 2064 726f 7020 3a20 626f 6f6c 2c20     drop : bool, 
-00017850: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00017860: 2020 2020 2049 6620 6060 6472 6f70 3d54       If ``drop=T
-00017870: 7275 6560 602c 2064 726f 7020 636f 6f72  rue``, drop coor
-00017880: 6469 6e61 7465 7320 7661 7269 6162 6c65  dinates variable
-00017890: 7320 696e 2060 696e 6465 7865 7273 6020  s in `indexers` 
-000178a0: 696e 7374 6561 640a 2020 2020 2020 2020  instead.        
-000178b0: 2020 2020 6f66 206d 616b 696e 6720 7468      of making th
-000178c0: 656d 2073 6361 6c61 722e 0a20 2020 2020  em scalar..     
-000178d0: 2020 202a 2a69 6e64 6578 6572 735f 6b77     **indexers_kw
-000178e0: 6172 6773 203a 207b 6469 6d3a 2069 6e64  args : {dim: ind
-000178f0: 6578 6572 2c20 2e2e 2e7d 2c20 6f70 7469  exer, ...}, opti
-00017900: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00017910: 2054 6865 206b 6579 776f 7264 2061 7267   The keyword arg
-00017920: 756d 656e 7473 2066 6f72 6d20 6f66 2060  uments form of `
-00017930: 6069 6e64 6578 6572 7360 602e 0a20 2020  `indexers``..   
-00017940: 2020 2020 2020 2020 204f 6e65 206f 6620           One of 
-00017950: 696e 6465 7865 7273 206f 7220 696e 6465  indexers or inde
-00017960: 7865 7273 5f6b 7761 7267 7320 6d75 7374  xers_kwargs must
-00017970: 2062 6520 7072 6f76 6964 6564 2e0a 0a20   be provided... 
-00017980: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00017990: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-000179a0: 2020 2020 2020 206f 626a 203a 2044 6174         obj : Dat
-000179b0: 6173 6574 0a20 2020 2020 2020 2020 2020  aset.           
-000179c0: 2041 206e 6577 2044 6174 6173 6574 2077   A new Dataset w
-000179d0: 6974 6820 7468 6520 7361 6d65 2063 6f6e  ith the same con
-000179e0: 7465 6e74 7320 6173 2074 6869 7320 6461  tents as this da
-000179f0: 7461 7365 742c 2065 7863 6570 7420 6561  taset, except ea
-00017a00: 6368 0a20 2020 2020 2020 2020 2020 2076  ch.            v
-00017a10: 6172 6961 626c 6520 616e 6420 6469 6d65  ariable and dime
-00017a20: 6e73 696f 6e20 6973 2069 6e64 6578 6564  nsion is indexed
-00017a30: 2062 7920 7468 6520 6170 7072 6f70 7269   by the appropri
-00017a40: 6174 6520 696e 6465 7865 7273 2e0a 2020  ate indexers..  
-00017a50: 2020 2020 2020 2020 2020 4966 2069 6e64            If ind
-00017a60: 6578 6572 2044 6174 6141 7272 6179 7320  exer DataArrays 
-00017a70: 6861 7665 2063 6f6f 7264 696e 6174 6573  have coordinates
-00017a80: 2074 6861 7420 646f 206e 6f74 2063 6f6e   that do not con
-00017a90: 666c 6963 7420 7769 7468 0a20 2020 2020  flict with.     
-00017aa0: 2020 2020 2020 2074 6869 7320 6f62 6a65         this obje
-00017ab0: 6374 2c20 7468 656e 2074 6865 7365 2063  ct, then these c
-00017ac0: 6f6f 7264 696e 6174 6573 2077 696c 6c20  oordinates will 
-00017ad0: 6265 2061 7474 6163 6865 642e 0a20 2020  be attached..   
-00017ae0: 2020 2020 2020 2020 2049 6e20 6765 6e65           In gene
-00017af0: 7261 6c2c 2065 6163 6820 6172 7261 7927  ral, each array'
-00017b00: 7320 6461 7461 2077 696c 6c20 6265 2061  s data will be a
-00017b10: 2076 6965 7720 6f66 2074 6865 2061 7272   view of the arr
-00017b20: 6179 2773 2064 6174 610a 2020 2020 2020  ay's data.      
-00017b30: 2020 2020 2020 696e 2074 6869 7320 6461        in this da
-00017b40: 7461 7365 742c 2075 6e6c 6573 7320 7665  taset, unless ve
-00017b50: 6374 6f72 697a 6564 2069 6e64 6578 696e  ctorized indexin
-00017b60: 6720 7761 7320 7472 6967 6765 7265 6420  g was triggered 
-00017b70: 6279 2075 7369 6e67 0a20 2020 2020 2020  by using.       
-00017b80: 2020 2020 2061 6e20 6172 7261 7920 696e       an array in
-00017b90: 6465 7865 722c 2069 6e20 7768 6963 6820  dexer, in which 
-00017ba0: 6361 7365 2074 6865 2064 6174 6120 7769  case the data wi
-00017bb0: 6c6c 2062 6520 6120 636f 7079 2e0a 0a20  ll be a copy... 
-00017bc0: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-00017bd0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00017be0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
-00017bf0: 2e69 7365 6c0a 2020 2020 2020 2020 4461  .isel.        Da
-00017c00: 7461 4172 7261 792e 7365 6c0a 2020 2020  taArray.sel.    
-00017c10: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00017c20: 696e 6465 7865 7273 203d 2065 6974 6865  indexers = eithe
-00017c30: 725f 6469 6374 5f6f 725f 6b77 6172 6773  r_dict_or_kwargs
-00017c40: 2869 6e64 6578 6572 732c 2069 6e64 6578  (indexers, index
-00017c50: 6572 735f 6b77 6172 6773 2c20 2273 656c  ers_kwargs, "sel
-00017c60: 2229 0a20 2020 2020 2020 2071 7565 7279  ").        query
-00017c70: 5f72 6573 756c 7473 203d 206d 6170 5f69  _results = map_i
-00017c80: 6e64 6578 5f71 7565 7269 6573 280a 2020  ndex_queries(.  
-00017c90: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
-00017ca0: 696e 6465 7865 7273 3d69 6e64 6578 6572  indexers=indexer
-00017cb0: 732c 206d 6574 686f 643d 6d65 7468 6f64  s, method=method
-00017cc0: 2c20 746f 6c65 7261 6e63 653d 746f 6c65  , tolerance=tole
-00017cd0: 7261 6e63 650a 2020 2020 2020 2020 290a  rance.        ).
-00017ce0: 0a20 2020 2020 2020 2069 6620 6472 6f70  .        if drop
-00017cf0: 3a0a 2020 2020 2020 2020 2020 2020 6e6f  :.            no
-00017d00: 5f73 6361 6c61 725f 7661 7269 6162 6c65  _scalar_variable
-00017d10: 7320 3d20 7b7d 0a20 2020 2020 2020 2020  s = {}.         
-00017d20: 2020 2066 6f72 206b 2c20 7620 696e 2071     for k, v in q
-00017d30: 7565 7279 5f72 6573 756c 7473 2e76 6172  uery_results.var
-00017d40: 6961 626c 6573 2e69 7465 6d73 2829 3a0a  iables.items():.
-00017d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017d60: 6966 2076 2e64 696d 733a 0a20 2020 2020  if v.dims:.     
-00017d70: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00017d80: 6f5f 7363 616c 6172 5f76 6172 6961 626c  o_scalar_variabl
-00017d90: 6573 5b6b 5d20 3d20 760a 2020 2020 2020  es[k] = v.      
-00017da0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00017db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017dc0: 2020 2020 6966 206b 2069 6e20 7365 6c66      if k in self
-00017dd0: 2e5f 636f 6f72 645f 6e61 6d65 733a 0a20  ._coord_names:. 
-00017de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017df0: 2020 2020 2020 2071 7565 7279 5f72 6573         query_res
-00017e00: 756c 7473 2e64 726f 705f 636f 6f72 6473  ults.drop_coords
-00017e10: 2e61 7070 656e 6428 6b29 0a20 2020 2020  .append(k).     
-00017e20: 2020 2020 2020 2071 7565 7279 5f72 6573         query_res
-00017e30: 756c 7473 2e76 6172 6961 626c 6573 203d  ults.variables =
-00017e40: 206e 6f5f 7363 616c 6172 5f76 6172 6961   no_scalar_varia
-00017e50: 626c 6573 0a0a 2020 2020 2020 2020 7265  bles..        re
-00017e60: 7375 6c74 203d 2073 656c 662e 6973 656c  sult = self.isel
-00017e70: 2869 6e64 6578 6572 733d 7175 6572 795f  (indexers=query_
-00017e80: 7265 7375 6c74 732e 6469 6d5f 696e 6465  results.dim_inde
-00017e90: 7865 7273 2c20 6472 6f70 3d64 726f 7029  xers, drop=drop)
-00017ea0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00017eb0: 7265 7375 6c74 2e5f 6f76 6572 7772 6974  result._overwrit
-00017ec0: 655f 696e 6465 7865 7328 2a71 7565 7279  e_indexes(*query
-00017ed0: 5f72 6573 756c 7473 2e61 735f 7475 706c  _results.as_tupl
-00017ee0: 6528 295b 313a 5d29 0a0a 2020 2020 6465  e()[1:])..    de
-00017ef0: 6620 6865 6164 280a 2020 2020 2020 2020  f head(.        
-00017f00: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
-00017f10: 0a20 2020 2020 2020 2069 6e64 6578 6572  .        indexer
-00017f20: 733a 204d 6170 7069 6e67 5b41 6e79 2c20  s: Mapping[Any, 
-00017f30: 696e 745d 207c 2069 6e74 207c 204e 6f6e  int] | int | Non
-00017f40: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-00017f50: 2020 2a2a 696e 6465 7865 7273 5f6b 7761    **indexers_kwa
-00017f60: 7267 733a 2041 6e79 2c0a 2020 2020 2920  rgs: Any,.    ) 
-00017f70: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-00017f80: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
-00017f90: 2061 206e 6577 2064 6174 6173 6574 2077   a new dataset w
-00017fa0: 6974 6820 7468 6520 6669 7273 7420 606e  ith the first `n
-00017fb0: 6020 7661 6c75 6573 206f 6620 6561 6368  ` values of each
-00017fc0: 2061 7272 6179 0a20 2020 2020 2020 2066   array.        f
-00017fd0: 6f72 2074 6865 2073 7065 6369 6669 6564  or the specified
-00017fe0: 2064 696d 656e 7369 6f6e 2873 292e 0a0a   dimension(s)...
-00017ff0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00018000: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00018010: 2d2d 2d2d 2d0a 2020 2020 2020 2020 696e  -----.        in
-00018020: 6465 7865 7273 203a 2064 6963 7420 6f72  dexers : dict or
-00018030: 2069 6e74 2c20 6465 6661 756c 743a 2035   int, default: 5
-00018040: 0a20 2020 2020 2020 2020 2020 2041 2064  .            A d
-00018050: 6963 7420 7769 7468 206b 6579 7320 6d61  ict with keys ma
-00018060: 7463 6869 6e67 2064 696d 656e 7369 6f6e  tching dimension
-00018070: 7320 616e 6420 696e 7465 6765 7220 7661  s and integer va
-00018080: 6c75 6573 2060 6e60 0a20 2020 2020 2020  lues `n`.       
-00018090: 2020 2020 206f 7220 6120 7369 6e67 6c65       or a single
-000180a0: 2069 6e74 6567 6572 2060 6e60 2061 7070   integer `n` app
-000180b0: 6c69 6564 206f 7665 7220 616c 6c20 6469  lied over all di
-000180c0: 6d65 6e73 696f 6e73 2e0a 2020 2020 2020  mensions..      
-000180d0: 2020 2020 2020 4f6e 6520 6f66 2069 6e64        One of ind
-000180e0: 6578 6572 7320 6f72 2069 6e64 6578 6572  exers or indexer
-000180f0: 735f 6b77 6172 6773 206d 7573 7420 6265  s_kwargs must be
-00018100: 2070 726f 7669 6465 642e 0a20 2020 2020   provided..     
-00018110: 2020 202a 2a69 6e64 6578 6572 735f 6b77     **indexers_kw
-00018120: 6172 6773 203a 207b 6469 6d3a 206e 2c20  args : {dim: n, 
-00018130: 2e2e 2e7d 2c20 6f70 7469 6f6e 616c 0a20  ...}, optional. 
-00018140: 2020 2020 2020 2020 2020 2054 6865 206b             The k
-00018150: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
-00018160: 2066 6f72 6d20 6f66 2060 6069 6e64 6578   form of ``index
-00018170: 6572 7360 602e 0a20 2020 2020 2020 2020  ers``..         
-00018180: 2020 204f 6e65 206f 6620 696e 6465 7865     One of indexe
-00018190: 7273 206f 7220 696e 6465 7865 7273 5f6b  rs or indexers_k
-000181a0: 7761 7267 7320 6d75 7374 2062 6520 7072  wargs must be pr
-000181b0: 6f76 6964 6564 2e0a 0a20 2020 2020 2020  ovided...       
-000181c0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-000181d0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-000181e0: 2020 2044 6174 6173 6574 2e74 6169 6c0a     Dataset.tail.
-000181f0: 2020 2020 2020 2020 4461 7461 7365 742e          Dataset.
-00018200: 7468 696e 0a20 2020 2020 2020 2044 6174  thin.        Dat
-00018210: 6141 7272 6179 2e68 6561 640a 2020 2020  aArray.head.    
-00018220: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00018230: 6966 206e 6f74 2069 6e64 6578 6572 735f  if not indexers_
-00018240: 6b77 6172 6773 3a0a 2020 2020 2020 2020  kwargs:.        
-00018250: 2020 2020 6966 2069 6e64 6578 6572 7320      if indexers 
-00018260: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00018270: 2020 2020 2020 2020 2069 6e64 6578 6572           indexer
-00018280: 7320 3d20 350a 2020 2020 2020 2020 2020  s = 5.          
-00018290: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-000182a0: 6e63 6528 696e 6465 7865 7273 2c20 696e  nce(indexers, in
-000182b0: 7429 2061 6e64 206e 6f74 2069 735f 6469  t) and not is_di
-000182c0: 6374 5f6c 696b 6528 696e 6465 7865 7273  ct_like(indexers
-000182d0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000182e0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-000182f0: 6f72 2822 696e 6465 7865 7273 206d 7573  or("indexers mus
-00018300: 7420 6265 2065 6974 6865 7220 6469 6374  t be either dict
-00018310: 2d6c 696b 6520 6f72 2061 2073 696e 676c  -like or a singl
-00018320: 6520 696e 7465 6765 7222 290a 2020 2020  e integer").    
-00018330: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00018340: 6528 696e 6465 7865 7273 2c20 696e 7429  e(indexers, int)
-00018350: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-00018360: 6465 7865 7273 203d 207b 6469 6d3a 2069  dexers = {dim: i
-00018370: 6e64 6578 6572 7320 666f 7220 6469 6d20  ndexers for dim 
-00018380: 696e 2073 656c 662e 6469 6d73 7d0a 2020  in self.dims}.  
-00018390: 2020 2020 2020 696e 6465 7865 7273 203d        indexers =
-000183a0: 2065 6974 6865 725f 6469 6374 5f6f 725f   either_dict_or_
-000183b0: 6b77 6172 6773 2869 6e64 6578 6572 732c  kwargs(indexers,
-000183c0: 2069 6e64 6578 6572 735f 6b77 6172 6773   indexers_kwargs
-000183d0: 2c20 2268 6561 6422 290a 2020 2020 2020  , "head").      
-000183e0: 2020 666f 7220 6b2c 2076 2069 6e20 696e    for k, v in in
-000183f0: 6465 7865 7273 2e69 7465 6d73 2829 3a0a  dexers.items():.
-00018400: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-00018410: 6f74 2069 7369 6e73 7461 6e63 6528 762c  ot isinstance(v,
-00018420: 2069 6e74 293a 0a20 2020 2020 2020 2020   int):.         
-00018430: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00018440: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00018450: 2020 2020 2020 2020 2020 2020 2265 7870              "exp
-00018460: 6563 7465 6420 696e 7465 6765 7220 7479  ected integer ty
-00018470: 7065 2069 6e64 6578 6572 2066 6f72 2022  pe indexer for "
-00018480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018490: 2020 2020 2066 2264 696d 656e 7369 6f6e       f"dimension
-000184a0: 207b 6b21 727d 2c20 666f 756e 6420 7b74   {k!r}, found {t
-000184b0: 7970 6528 7629 2172 7d22 0a20 2020 2020  ype(v)!r}".     
-000184c0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-000184d0: 2020 2020 2020 2020 2065 6c69 6620 7620           elif v 
-000184e0: 3c20 303a 0a20 2020 2020 2020 2020 2020  < 0:.           
-000184f0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00018500: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00018510: 2020 2020 2020 2020 2020 2022 6578 7065             "expe
-00018520: 6374 6564 2070 6f73 6974 6976 6520 696e  cted positive in
-00018530: 7465 6765 7220 6173 2069 6e64 6578 6572  teger as indexer
-00018540: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00018550: 2020 2020 2020 2066 2266 6f72 2064 696d         f"for dim
-00018560: 656e 7369 6f6e 207b 6b21 727d 2c20 666f  ension {k!r}, fo
-00018570: 756e 6420 7b76 7d22 0a20 2020 2020 2020  und {v}".       
-00018580: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00018590: 2020 2069 6e64 6578 6572 735f 736c 6963     indexers_slic
-000185a0: 6573 203d 207b 6b3a 2073 6c69 6365 2876  es = {k: slice(v
-000185b0: 616c 2920 666f 7220 6b2c 2076 616c 2069  al) for k, val i
-000185c0: 6e20 696e 6465 7865 7273 2e69 7465 6d73  n indexers.items
-000185d0: 2829 7d0a 2020 2020 2020 2020 7265 7475  ()}.        retu
-000185e0: 726e 2073 656c 662e 6973 656c 2869 6e64  rn self.isel(ind
-000185f0: 6578 6572 735f 736c 6963 6573 290a 0a20  exers_slices).. 
-00018600: 2020 2064 6566 2074 6169 6c28 0a20 2020     def tail(.   
-00018610: 2020 2020 2073 656c 663a 2054 5f44 6174       self: T_Dat
-00018620: 6173 6574 2c0a 2020 2020 2020 2020 696e  aset,.        in
-00018630: 6465 7865 7273 3a20 4d61 7070 696e 675b  dexers: Mapping[
-00018640: 416e 792c 2069 6e74 5d20 7c20 696e 7420  Any, int] | int 
-00018650: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00018660: 2020 2020 2020 202a 2a69 6e64 6578 6572         **indexer
-00018670: 735f 6b77 6172 6773 3a20 416e 792c 0a20  s_kwargs: Any,. 
-00018680: 2020 2029 202d 3e20 545f 4461 7461 7365     ) -> T_Datase
-00018690: 743a 0a20 2020 2020 2020 2022 2222 5265  t:.        """Re
-000186a0: 7475 726e 7320 6120 6e65 7720 6461 7461  turns a new data
-000186b0: 7365 7420 7769 7468 2074 6865 206c 6173  set with the las
-000186c0: 7420 606e 6020 7661 6c75 6573 206f 6620  t `n` values of 
-000186d0: 6561 6368 2061 7272 6179 0a20 2020 2020  each array.     
-000186e0: 2020 2066 6f72 2074 6865 2073 7065 6369     for the speci
-000186f0: 6669 6564 2064 696d 656e 7369 6f6e 2873  fied dimension(s
-00018700: 292e 0a0a 2020 2020 2020 2020 5061 7261  )...        Para
-00018710: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00018720: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00018730: 2020 696e 6465 7865 7273 203a 2064 6963    indexers : dic
-00018740: 7420 6f72 2069 6e74 2c20 6465 6661 756c  t or int, defaul
-00018750: 743a 2035 0a20 2020 2020 2020 2020 2020  t: 5.           
-00018760: 2041 2064 6963 7420 7769 7468 206b 6579   A dict with key
-00018770: 7320 6d61 7463 6869 6e67 2064 696d 656e  s matching dimen
-00018780: 7369 6f6e 7320 616e 6420 696e 7465 6765  sions and intege
-00018790: 7220 7661 6c75 6573 2060 6e60 0a20 2020  r values `n`.   
-000187a0: 2020 2020 2020 2020 206f 7220 6120 7369           or a si
-000187b0: 6e67 6c65 2069 6e74 6567 6572 2060 6e60  ngle integer `n`
-000187c0: 2061 7070 6c69 6564 206f 7665 7220 616c   applied over al
-000187d0: 6c20 6469 6d65 6e73 696f 6e73 2e0a 2020  l dimensions..  
-000187e0: 2020 2020 2020 2020 2020 4f6e 6520 6f66            One of
-000187f0: 2069 6e64 6578 6572 7320 6f72 2069 6e64   indexers or ind
-00018800: 6578 6572 735f 6b77 6172 6773 206d 7573  exers_kwargs mus
-00018810: 7420 6265 2070 726f 7669 6465 642e 0a20  t be provided.. 
-00018820: 2020 2020 2020 202a 2a69 6e64 6578 6572         **indexer
-00018830: 735f 6b77 6172 6773 203a 207b 6469 6d3a  s_kwargs : {dim:
-00018840: 206e 2c20 2e2e 2e7d 2c20 6f70 7469 6f6e   n, ...}, option
-00018850: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
-00018860: 6865 206b 6579 776f 7264 2061 7267 756d  he keyword argum
-00018870: 656e 7473 2066 6f72 6d20 6f66 2060 6069  ents form of ``i
-00018880: 6e64 6578 6572 7360 602e 0a20 2020 2020  ndexers``..     
-00018890: 2020 2020 2020 204f 6e65 206f 6620 696e         One of in
-000188a0: 6465 7865 7273 206f 7220 696e 6465 7865  dexers or indexe
-000188b0: 7273 5f6b 7761 7267 7320 6d75 7374 2062  rs_kwargs must b
-000188c0: 6520 7072 6f76 6964 6564 2e0a 0a20 2020  e provided...   
-000188d0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-000188e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-000188f0: 2020 2020 2020 2044 6174 6173 6574 2e68         Dataset.h
-00018900: 6561 640a 2020 2020 2020 2020 4461 7461  ead.        Data
-00018910: 7365 742e 7468 696e 0a20 2020 2020 2020  set.thin.       
-00018920: 2044 6174 6141 7272 6179 2e74 6169 6c0a   DataArray.tail.
-00018930: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00018940: 2020 2020 6966 206e 6f74 2069 6e64 6578      if not index
-00018950: 6572 735f 6b77 6172 6773 3a0a 2020 2020  ers_kwargs:.    
-00018960: 2020 2020 2020 2020 6966 2069 6e64 6578          if index
-00018970: 6572 7320 6973 204e 6f6e 653a 0a20 2020  ers is None:.   
-00018980: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-00018990: 6578 6572 7320 3d20 350a 2020 2020 2020  exers = 5.      
-000189a0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-000189b0: 6e73 7461 6e63 6528 696e 6465 7865 7273  nstance(indexers
-000189c0: 2c20 696e 7429 2061 6e64 206e 6f74 2069  , int) and not i
-000189d0: 735f 6469 6374 5f6c 696b 6528 696e 6465  s_dict_like(inde
-000189e0: 7865 7273 293a 0a20 2020 2020 2020 2020  xers):.         
-000189f0: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
-00018a00: 6545 7272 6f72 2822 696e 6465 7865 7273  eError("indexers
-00018a10: 206d 7573 7420 6265 2065 6974 6865 7220   must be either 
-00018a20: 6469 6374 2d6c 696b 6520 6f72 2061 2073  dict-like or a s
-00018a30: 696e 676c 6520 696e 7465 6765 7222 290a  ingle integer").
-00018a40: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00018a50: 7461 6e63 6528 696e 6465 7865 7273 2c20  tance(indexers, 
-00018a60: 696e 7429 3a0a 2020 2020 2020 2020 2020  int):.          
-00018a70: 2020 696e 6465 7865 7273 203d 207b 6469    indexers = {di
-00018a80: 6d3a 2069 6e64 6578 6572 7320 666f 7220  m: indexers for 
-00018a90: 6469 6d20 696e 2073 656c 662e 6469 6d73  dim in self.dims
-00018aa0: 7d0a 2020 2020 2020 2020 696e 6465 7865  }.        indexe
-00018ab0: 7273 203d 2065 6974 6865 725f 6469 6374  rs = either_dict
-00018ac0: 5f6f 725f 6b77 6172 6773 2869 6e64 6578  _or_kwargs(index
-00018ad0: 6572 732c 2069 6e64 6578 6572 735f 6b77  ers, indexers_kw
-00018ae0: 6172 6773 2c20 2274 6169 6c22 290a 2020  args, "tail").  
-00018af0: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
-00018b00: 6e20 696e 6465 7865 7273 2e69 7465 6d73  n indexers.items
-00018b10: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00018b20: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-00018b30: 6528 762c 2069 6e74 293a 0a20 2020 2020  e(v, int):.     
-00018b40: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00018b50: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
-00018b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018b70: 2265 7870 6563 7465 6420 696e 7465 6765  "expected intege
-00018b80: 7220 7479 7065 2069 6e64 6578 6572 2066  r type indexer f
-00018b90: 6f72 2022 0a20 2020 2020 2020 2020 2020  or ".           
-00018ba0: 2020 2020 2020 2020 2066 2264 696d 656e           f"dimen
-00018bb0: 7369 6f6e 207b 6b21 727d 2c20 666f 756e  sion {k!r}, foun
-00018bc0: 6420 7b74 7970 6528 7629 2172 7d22 0a20  d {type(v)!r}". 
-00018bd0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00018be0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00018bf0: 6620 7620 3c20 303a 0a20 2020 2020 2020  f v < 0:.       
-00018c00: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-00018c10: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-00018c20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00018c30: 6578 7065 6374 6564 2070 6f73 6974 6976  expected positiv
-00018c40: 6520 696e 7465 6765 7220 6173 2069 6e64  e integer as ind
-00018c50: 6578 6572 2022 0a20 2020 2020 2020 2020  exer ".         
-00018c60: 2020 2020 2020 2020 2020 2066 2266 6f72             f"for
-00018c70: 2064 696d 656e 7369 6f6e 207b 6b21 727d   dimension {k!r}
-00018c80: 2c20 666f 756e 6420 7b76 7d22 0a20 2020  , found {v}".   
-00018c90: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00018ca0: 2020 2020 2020 2069 6e64 6578 6572 735f         indexers_
-00018cb0: 736c 6963 6573 203d 207b 0a20 2020 2020  slices = {.     
-00018cc0: 2020 2020 2020 206b 3a20 736c 6963 6528         k: slice(
-00018cd0: 2d76 616c 2c20 4e6f 6e65 2920 6966 2076  -val, None) if v
-00018ce0: 616c 2021 3d20 3020 656c 7365 2073 6c69  al != 0 else sli
-00018cf0: 6365 2876 616c 290a 2020 2020 2020 2020  ce(val).        
-00018d00: 2020 2020 666f 7220 6b2c 2076 616c 2069      for k, val i
-00018d10: 6e20 696e 6465 7865 7273 2e69 7465 6d73  n indexers.items
-00018d20: 2829 0a20 2020 2020 2020 207d 0a20 2020  ().        }.   
-00018d30: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00018d40: 2e69 7365 6c28 696e 6465 7865 7273 5f73  .isel(indexers_s
-00018d50: 6c69 6365 7329 0a0a 2020 2020 6465 6620  lices)..    def 
-00018d60: 7468 696e 280a 2020 2020 2020 2020 7365  thin(.        se
-00018d70: 6c66 3a20 545f 4461 7461 7365 742c 0a20  lf: T_Dataset,. 
-00018d80: 2020 2020 2020 2069 6e64 6578 6572 733a         indexers:
-00018d90: 204d 6170 7069 6e67 5b41 6e79 2c20 696e   Mapping[Any, in
-00018da0: 745d 207c 2069 6e74 207c 204e 6f6e 6520  t] | int | None 
-00018db0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00018dc0: 2a2a 696e 6465 7865 7273 5f6b 7761 7267  **indexers_kwarg
-00018dd0: 733a 2041 6e79 2c0a 2020 2020 2920 2d3e  s: Any,.    ) ->
-00018de0: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
-00018df0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
-00018e00: 206e 6577 2064 6174 6173 6574 2077 6974   new dataset wit
-00018e10: 6820 6561 6368 2061 7272 6179 2069 6e64  h each array ind
-00018e20: 6578 6564 2061 6c6f 6e67 2065 7665 7279  exed along every
-00018e30: 2060 6e60 2d74 680a 2020 2020 2020 2020   `n`-th.        
-00018e40: 7661 6c75 6520 666f 7220 7468 6520 7370  value for the sp
-00018e50: 6563 6966 6965 6420 6469 6d65 6e73 696f  ecified dimensio
-00018e60: 6e28 7329 0a0a 2020 2020 2020 2020 5061  n(s)..        Pa
-00018e70: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00018e80: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00018e90: 2020 2020 696e 6465 7865 7273 203a 2064      indexers : d
-00018ea0: 6963 7420 6f72 2069 6e74 0a20 2020 2020  ict or int.     
-00018eb0: 2020 2020 2020 2041 2064 6963 7420 7769         A dict wi
-00018ec0: 7468 206b 6579 7320 6d61 7463 6869 6e67  th keys matching
-00018ed0: 2064 696d 656e 7369 6f6e 7320 616e 6420   dimensions and 
-00018ee0: 696e 7465 6765 7220 7661 6c75 6573 2060  integer values `
-00018ef0: 6e60 0a20 2020 2020 2020 2020 2020 206f  n`.            o
-00018f00: 7220 6120 7369 6e67 6c65 2069 6e74 6567  r a single integ
-00018f10: 6572 2060 6e60 2061 7070 6c69 6564 206f  er `n` applied o
-00018f20: 7665 7220 616c 6c20 6469 6d65 6e73 696f  ver all dimensio
-00018f30: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
-00018f40: 4f6e 6520 6f66 2069 6e64 6578 6572 7320  One of indexers 
-00018f50: 6f72 2069 6e64 6578 6572 735f 6b77 6172  or indexers_kwar
-00018f60: 6773 206d 7573 7420 6265 2070 726f 7669  gs must be provi
-00018f70: 6465 642e 0a20 2020 2020 2020 202a 2a69  ded..        **i
-00018f80: 6e64 6578 6572 735f 6b77 6172 6773 203a  ndexers_kwargs :
-00018f90: 207b 6469 6d3a 206e 2c20 2e2e 2e7d 2c20   {dim: n, ...}, 
-00018fa0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00018fb0: 2020 2020 2054 6865 206b 6579 776f 7264       The keyword
-00018fc0: 2061 7267 756d 656e 7473 2066 6f72 6d20   arguments form 
-00018fd0: 6f66 2060 6069 6e64 6578 6572 7360 602e  of ``indexers``.
-00018fe0: 0a20 2020 2020 2020 2020 2020 204f 6e65  .            One
-00018ff0: 206f 6620 696e 6465 7865 7273 206f 7220   of indexers or 
-00019000: 696e 6465 7865 7273 5f6b 7761 7267 7320  indexers_kwargs 
-00019010: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
-00019020: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
-00019030: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-00019040: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-00019050: 2078 5f61 7272 203d 206e 702e 6172 616e   x_arr = np.aran
-00019060: 6765 2830 2c20 3236 290a 2020 2020 2020  ge(0, 26).      
-00019070: 2020 3e3e 3e20 785f 6172 720a 2020 2020    >>> x_arr.    
-00019080: 2020 2020 6172 7261 7928 5b20 302c 2020      array([ 0,  
-00019090: 312c 2020 322c 2020 332c 2020 342c 2020  1,  2,  3,  4,  
-000190a0: 352c 2020 362c 2020 372c 2020 382c 2020  5,  6,  7,  8,  
-000190b0: 392c 2031 302c 2031 312c 2031 322c 2031  9, 10, 11, 12, 1
-000190c0: 332c 2031 342c 2031 352c 2031 362c 0a20  3, 14, 15, 16,. 
-000190d0: 2020 2020 2020 2020 2020 2020 2020 3137                17
-000190e0: 2c20 3138 2c20 3139 2c20 3230 2c20 3231  , 18, 19, 20, 21
-000190f0: 2c20 3232 2c20 3233 2c20 3234 2c20 3235  , 22, 23, 24, 25
-00019100: 5d29 0a20 2020 2020 2020 203e 3e3e 2078  ]).        >>> x
-00019110: 203d 2078 722e 4461 7461 4172 7261 7928   = xr.DataArray(
-00019120: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00019130: 206e 702e 7265 7368 6170 6528 785f 6172   np.reshape(x_ar
-00019140: 722c 2028 322c 2031 3329 292c 0a20 2020  r, (2, 13)),.   
-00019150: 2020 2020 202e 2e2e 2020 2020 2064 696d       ...     dim
-00019160: 733d 2822 7822 2c20 2279 2229 2c0a 2020  s=("x", "y"),.  
-00019170: 2020 2020 2020 2e2e 2e20 2020 2020 636f        ...     co
-00019180: 6f72 6473 3d7b 2278 223a 205b 302c 2031  ords={"x": [0, 1
-00019190: 5d2c 2022 7922 3a20 6e70 2e61 7261 6e67  ], "y": np.arang
-000191a0: 6528 302c 2031 3329 7d2c 0a20 2020 2020  e(0, 13)},.     
-000191b0: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
-000191c0: 203e 3e3e 2078 5f64 7320 3d20 7872 2e44   >>> x_ds = xr.D
-000191d0: 6174 6173 6574 287b 2266 6f6f 223a 2078  ataset({"foo": x
-000191e0: 7d29 0a20 2020 2020 2020 203e 3e3e 2078  }).        >>> x
-000191f0: 5f64 730a 2020 2020 2020 2020 3c78 6172  _ds.        <xar
-00019200: 7261 792e 4461 7461 7365 743e 0a20 2020  ray.Dataset>.   
-00019210: 2020 2020 2044 696d 656e 7369 6f6e 733a       Dimensions:
-00019220: 2020 2878 3a20 322c 2079 3a20 3133 290a    (x: 2, y: 13).
-00019230: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
-00019240: 7465 733a 0a20 2020 2020 2020 2020 202a  tes:.          *
-00019250: 2078 2020 2020 2020 2020 2878 2920 696e   x        (x) in
-00019260: 7436 3420 3020 310a 2020 2020 2020 2020  t64 0 1.        
-00019270: 2020 2a20 7920 2020 2020 2020 2028 7929    * y        (y)
-00019280: 2069 6e74 3634 2030 2031 2032 2033 2034   int64 0 1 2 3 4
-00019290: 2035 2036 2037 2038 2039 2031 3020 3131   5 6 7 8 9 10 11
-000192a0: 2031 320a 2020 2020 2020 2020 4461 7461   12.        Data
-000192b0: 2076 6172 6961 626c 6573 3a0a 2020 2020   variables:.    
-000192c0: 2020 2020 2020 2020 666f 6f20 2020 2020          foo     
-000192d0: 2028 782c 2079 2920 696e 7436 3420 3020   (x, y) int64 0 
-000192e0: 3120 3220 3320 3420 3520 3620 3720 3820  1 2 3 4 5 6 7 8 
-000192f0: 3920 2e2e 2e20 3136 2031 3720 3138 2031  9 ... 16 17 18 1
-00019300: 3920 3230 2032 3120 3232 2032 3320 3234  9 20 21 22 23 24
-00019310: 2032 350a 0a20 2020 2020 2020 203e 3e3e   25..        >>>
-00019320: 2078 5f64 732e 7468 696e 2833 290a 2020   x_ds.thin(3).  
-00019330: 2020 2020 2020 3c78 6172 7261 792e 4461        <xarray.Da
-00019340: 7461 7365 743e 0a20 2020 2020 2020 2044  taset>.        D
-00019350: 696d 656e 7369 6f6e 733a 2020 2878 3a20  imensions:  (x: 
-00019360: 312c 2079 3a20 3529 0a20 2020 2020 2020  1, y: 5).       
-00019370: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
-00019380: 2020 2020 2020 2020 2a20 7820 2020 2020          * x     
-00019390: 2020 2028 7829 2069 6e74 3634 2030 0a20     (x) int64 0. 
-000193a0: 2020 2020 2020 2020 202a 2079 2020 2020           * y    
-000193b0: 2020 2020 2879 2920 696e 7436 3420 3020      (y) int64 0 
-000193c0: 3320 3620 3920 3132 0a20 2020 2020 2020  3 6 9 12.       
-000193d0: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
-000193e0: 0a20 2020 2020 2020 2020 2020 2066 6f6f  .            foo
-000193f0: 2020 2020 2020 2878 2c20 7929 2069 6e74        (x, y) int
-00019400: 3634 2030 2033 2036 2039 2031 320a 2020  64 0 3 6 9 12.  
-00019410: 2020 2020 2020 3e3e 3e20 782e 7468 696e        >>> x.thin
-00019420: 287b 2278 223a 2032 2c20 2279 223a 2035  ({"x": 2, "y": 5
-00019430: 7d29 0a20 2020 2020 2020 203c 7861 7272  }).        <xarr
-00019440: 6179 2e44 6174 6141 7272 6179 2028 783a  ay.DataArray (x:
-00019450: 2031 2c20 793a 2033 293e 0a20 2020 2020   1, y: 3)>.     
-00019460: 2020 2061 7272 6179 285b 5b20 302c 2020     array([[ 0,  
-00019470: 352c 2031 305d 5d29 0a20 2020 2020 2020  5, 10]]).       
-00019480: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
-00019490: 2020 2020 2020 2020 2a20 7820 2020 2020          * x     
-000194a0: 2020 2028 7829 2069 6e74 3634 2030 0a20     (x) int64 0. 
-000194b0: 2020 2020 2020 2020 202a 2079 2020 2020           * y    
-000194c0: 2020 2020 2879 2920 696e 7436 3420 3020      (y) int64 0 
-000194d0: 3520 3130 0a0a 2020 2020 2020 2020 5365  5 10..        Se
-000194e0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-000194f0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00019500: 4461 7461 7365 742e 6865 6164 0a20 2020  Dataset.head.   
-00019510: 2020 2020 2044 6174 6173 6574 2e74 6169       Dataset.tai
-00019520: 6c0a 2020 2020 2020 2020 4461 7461 4172  l.        DataAr
-00019530: 7261 792e 7468 696e 0a20 2020 2020 2020  ray.thin.       
-00019540: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-00019550: 280a 2020 2020 2020 2020 2020 2020 6e6f  (.            no
-00019560: 7420 696e 6465 7865 7273 5f6b 7761 7267  t indexers_kwarg
-00019570: 730a 2020 2020 2020 2020 2020 2020 616e  s.            an
-00019580: 6420 6e6f 7420 6973 696e 7374 616e 6365  d not isinstance
-00019590: 2869 6e64 6578 6572 732c 2069 6e74 290a  (indexers, int).
-000195a0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-000195b0: 6e6f 7420 6973 5f64 6963 745f 6c69 6b65  not is_dict_like
-000195c0: 2869 6e64 6578 6572 7329 0a20 2020 2020  (indexers).     
-000195d0: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-000195e0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-000195f0: 7228 2269 6e64 6578 6572 7320 6d75 7374  r("indexers must
-00019600: 2062 6520 6569 7468 6572 2064 6963 742d   be either dict-
-00019610: 6c69 6b65 206f 7220 6120 7369 6e67 6c65  like or a single
-00019620: 2069 6e74 6567 6572 2229 0a20 2020 2020   integer").     
-00019630: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00019640: 2869 6e64 6578 6572 732c 2069 6e74 293a  (indexers, int):
-00019650: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
-00019660: 6578 6572 7320 3d20 7b64 696d 3a20 696e  exers = {dim: in
-00019670: 6465 7865 7273 2066 6f72 2064 696d 2069  dexers for dim i
-00019680: 6e20 7365 6c66 2e64 696d 737d 0a20 2020  n self.dims}.   
-00019690: 2020 2020 2069 6e64 6578 6572 7320 3d20       indexers = 
-000196a0: 6569 7468 6572 5f64 6963 745f 6f72 5f6b  either_dict_or_k
-000196b0: 7761 7267 7328 696e 6465 7865 7273 2c20  wargs(indexers, 
-000196c0: 696e 6465 7865 7273 5f6b 7761 7267 732c  indexers_kwargs,
-000196d0: 2022 7468 696e 2229 0a20 2020 2020 2020   "thin").       
-000196e0: 2066 6f72 206b 2c20 7620 696e 2069 6e64   for k, v in ind
-000196f0: 6578 6572 732e 6974 656d 7328 293a 0a20  exers.items():. 
-00019700: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-00019710: 7420 6973 696e 7374 616e 6365 2876 2c20  t isinstance(v, 
-00019720: 696e 7429 3a0a 2020 2020 2020 2020 2020  int):.          
-00019730: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00019740: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00019750: 2020 2020 2020 2020 2020 2022 6578 7065             "expe
-00019760: 6374 6564 2069 6e74 6567 6572 2074 7970  cted integer typ
-00019770: 6520 696e 6465 7865 7220 666f 7220 220a  e indexer for ".
-00019780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019790: 2020 2020 6622 6469 6d65 6e73 696f 6e20      f"dimension 
-000197a0: 7b6b 2172 7d2c 2066 6f75 6e64 207b 7479  {k!r}, found {ty
-000197b0: 7065 2876 2921 727d 220a 2020 2020 2020  pe(v)!r}".      
-000197c0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000197d0: 2020 2020 2020 2020 656c 6966 2076 203c          elif v <
-000197e0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-000197f0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00019800: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00019810: 2020 2020 2020 2020 2020 2265 7870 6563            "expec
-00019820: 7465 6420 706f 7369 7469 7665 2069 6e74  ted positive int
-00019830: 6567 6572 2061 7320 696e 6465 7865 7220  eger as indexer 
-00019840: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00019850: 2020 2020 2020 6622 666f 7220 6469 6d65        f"for dime
-00019860: 6e73 696f 6e20 7b6b 2172 7d2c 2066 6f75  nsion {k!r}, fou
-00019870: 6e64 207b 767d 220a 2020 2020 2020 2020  nd {v}".        
-00019880: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00019890: 2020 2020 2020 656c 6966 2076 203d 3d20        elif v == 
-000198a0: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
-000198b0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000198c0: 726f 7228 2273 7465 7020 6361 6e6e 6f74  ror("step cannot
-000198d0: 2062 6520 7a65 726f 2229 0a20 2020 2020   be zero").     
-000198e0: 2020 2069 6e64 6578 6572 735f 736c 6963     indexers_slic
-000198f0: 6573 203d 207b 6b3a 2073 6c69 6365 284e  es = {k: slice(N
-00019900: 6f6e 652c 204e 6f6e 652c 2076 616c 2920  one, None, val) 
-00019910: 666f 7220 6b2c 2076 616c 2069 6e20 696e  for k, val in in
-00019920: 6465 7865 7273 2e69 7465 6d73 2829 7d0a  dexers.items()}.
-00019930: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00019940: 656c 662e 6973 656c 2869 6e64 6578 6572  elf.isel(indexer
-00019950: 735f 736c 6963 6573 290a 0a20 2020 2064  s_slices)..    d
-00019960: 6566 2062 726f 6164 6361 7374 5f6c 696b  ef broadcast_lik
-00019970: 6528 0a20 2020 2020 2020 2073 656c 663a  e(.        self:
-00019980: 2054 5f44 6174 6173 6574 2c0a 2020 2020   T_Dataset,.    
-00019990: 2020 2020 6f74 6865 723a 2044 6174 6173      other: Datas
-000199a0: 6574 207c 2044 6174 6141 7272 6179 2c0a  et | DataArray,.
-000199b0: 2020 2020 2020 2020 6578 636c 7564 653a          exclude:
-000199c0: 2049 7465 7261 626c 655b 4861 7368 6162   Iterable[Hashab
-000199d0: 6c65 5d20 7c20 4e6f 6e65 203d 204e 6f6e  le] | None = Non
-000199e0: 652c 0a20 2020 2029 202d 3e20 545f 4461  e,.    ) -> T_Da
-000199f0: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-00019a00: 2222 4272 6f61 6463 6173 7420 7468 6973  ""Broadcast this
-00019a10: 2044 6174 6141 7272 6179 2061 6761 696e   DataArray again
-00019a20: 7374 2061 6e6f 7468 6572 2044 6174 6173  st another Datas
-00019a30: 6574 206f 7220 4461 7461 4172 7261 792e  et or DataArray.
-00019a40: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
-00019a50: 2065 7175 6976 616c 656e 7420 746f 2078   equivalent to x
-00019a60: 722e 6272 6f61 6463 6173 7428 6f74 6865  r.broadcast(othe
-00019a70: 722c 2073 656c 6629 5b31 5d0a 0a20 2020  r, self)[1]..   
-00019a80: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00019a90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00019aa0: 2d2d 0a20 2020 2020 2020 206f 7468 6572  --.        other
-00019ab0: 203a 2044 6174 6173 6574 206f 7220 4461   : Dataset or Da
-00019ac0: 7461 4172 7261 790a 2020 2020 2020 2020  taArray.        
-00019ad0: 2020 2020 4f62 6a65 6374 2061 6761 696e      Object again
-00019ae0: 7374 2077 6869 6368 2074 6f20 6272 6f61  st which to broa
-00019af0: 6463 6173 7420 7468 6973 2061 7272 6179  dcast this array
-00019b00: 2e0a 2020 2020 2020 2020 6578 636c 7564  ..        exclud
-00019b10: 6520 3a20 6974 6572 6162 6c65 206f 6620  e : iterable of 
-00019b20: 6861 7368 6162 6c65 2c20 6f70 7469 6f6e  hashable, option
-00019b30: 616c 0a20 2020 2020 2020 2020 2020 2044  al.            D
-00019b40: 696d 656e 7369 6f6e 7320 7468 6174 206d  imensions that m
-00019b50: 7573 7420 6e6f 7420 6265 2062 726f 6164  ust not be broad
-00019b60: 6361 7374 6564 0a0a 2020 2020 2020 2020  casted..        
-00019b70: 2222 220a 2020 2020 2020 2020 6966 2065  """.        if e
-00019b80: 7863 6c75 6465 2069 7320 4e6f 6e65 3a0a  xclude is None:.
-00019b90: 2020 2020 2020 2020 2020 2020 6578 636c              excl
-00019ba0: 7564 6520 3d20 7365 7428 290a 2020 2020  ude = set().    
-00019bb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00019bc0: 2020 2020 2020 6578 636c 7564 6520 3d20        exclude = 
-00019bd0: 7365 7428 6578 636c 7564 6529 0a20 2020  set(exclude).   
-00019be0: 2020 2020 2061 7267 7320 3d20 616c 6967       args = alig
-00019bf0: 6e28 6f74 6865 722c 2073 656c 662c 206a  n(other, self, j
-00019c00: 6f69 6e3d 226f 7574 6572 222c 2063 6f70  oin="outer", cop
-00019c10: 793d 4661 6c73 652c 2065 7863 6c75 6465  y=False, exclude
-00019c20: 3d65 7863 6c75 6465 290a 0a20 2020 2020  =exclude)..     
-00019c30: 2020 2064 696d 735f 6d61 702c 2063 6f6d     dims_map, com
-00019c40: 6d6f 6e5f 636f 6f72 6473 203d 205f 6765  mon_coords = _ge
-00019c50: 745f 6272 6f61 6463 6173 745f 6469 6d73  t_broadcast_dims
-00019c60: 5f6d 6170 5f63 6f6d 6d6f 6e5f 636f 6f72  _map_common_coor
-00019c70: 6473 2861 7267 732c 2065 7863 6c75 6465  ds(args, exclude
-00019c80: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00019c90: 6e20 5f62 726f 6164 6361 7374 5f68 656c  n _broadcast_hel
-00019ca0: 7065 7228 0a20 2020 2020 2020 2020 2020  per(.           
-00019cb0: 2063 6173 7428 2254 5f44 6174 6173 6574   cast("T_Dataset
-00019cc0: 222c 2061 7267 735b 315d 292c 2065 7863  ", args[1]), exc
-00019cd0: 6c75 6465 2c20 6469 6d73 5f6d 6170 2c20  lude, dims_map, 
-00019ce0: 636f 6d6d 6f6e 5f63 6f6f 7264 730a 2020  common_coords.  
-00019cf0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00019d00: 205f 7265 696e 6465 785f 6361 6c6c 6261   _reindex_callba
-00019d10: 636b 280a 2020 2020 2020 2020 7365 6c66  ck(.        self
-00019d20: 2c0a 2020 2020 2020 2020 616c 6967 6e65  ,.        aligne
-00019d30: 723a 2061 6c69 676e 6d65 6e74 2e41 6c69  r: alignment.Ali
-00019d40: 676e 6572 2c0a 2020 2020 2020 2020 6469  gner,.        di
-00019d50: 6d5f 706f 735f 696e 6465 7865 7273 3a20  m_pos_indexers: 
-00019d60: 6469 6374 5b48 6173 6861 626c 652c 2041  dict[Hashable, A
-00019d70: 6e79 5d2c 0a20 2020 2020 2020 2076 6172  ny],.        var
-00019d80: 6961 626c 6573 3a20 6469 6374 5b48 6173  iables: dict[Has
-00019d90: 6861 626c 652c 2056 6172 6961 626c 655d  hable, Variable]
-00019da0: 2c0a 2020 2020 2020 2020 696e 6465 7865  ,.        indexe
-00019db0: 733a 2064 6963 745b 4861 7368 6162 6c65  s: dict[Hashable
-00019dc0: 2c20 496e 6465 785d 2c0a 2020 2020 2020  , Index],.      
-00019dd0: 2020 6669 6c6c 5f76 616c 7565 3a20 416e    fill_value: An
-00019de0: 792c 0a20 2020 2020 2020 2065 7863 6c75  y,.        exclu
-00019df0: 6465 5f64 696d 733a 2066 726f 7a65 6e73  de_dims: frozens
-00019e00: 6574 5b48 6173 6861 626c 655d 2c0a 2020  et[Hashable],.  
-00019e10: 2020 2020 2020 6578 636c 7564 655f 7661        exclude_va
-00019e20: 7273 3a20 6672 6f7a 656e 7365 745b 4861  rs: frozenset[Ha
-00019e30: 7368 6162 6c65 5d2c 0a20 2020 2029 202d  shable],.    ) -
-00019e40: 3e20 4461 7461 7365 743a 0a20 2020 2020  > Dataset:.     
-00019e50: 2020 2022 2222 4361 6c6c 6261 636b 2063     """Callback c
-00019e60: 616c 6c65 6420 6672 6f6d 2060 6041 6c69  alled from ``Ali
-00019e70: 676e 6572 6060 2074 6f20 6372 6561 7465  gner`` to create
-00019e80: 2061 206e 6577 2072 6569 6e64 6578 6564   a new reindexed
-00019e90: 2044 6174 6173 6574 2e22 2222 0a0a 2020   Dataset."""..  
-00019ea0: 2020 2020 2020 6e65 775f 7661 7269 6162        new_variab
-00019eb0: 6c65 7320 3d20 7661 7269 6162 6c65 732e  les = variables.
-00019ec0: 636f 7079 2829 0a20 2020 2020 2020 206e  copy().        n
-00019ed0: 6577 5f69 6e64 6578 6573 203d 2069 6e64  ew_indexes = ind
-00019ee0: 6578 6573 2e63 6f70 7928 290a 0a20 2020  exes.copy()..   
-00019ef0: 2020 2020 2023 2072 652d 6173 7369 676e       # re-assign
-00019f00: 2076 6172 6961 626c 6520 6d65 7461 6461   variable metada
-00019f10: 7461 0a20 2020 2020 2020 2066 6f72 206e  ta.        for n
-00019f20: 616d 652c 206e 6577 5f76 6172 2069 6e20  ame, new_var in 
-00019f30: 6e65 775f 7661 7269 6162 6c65 732e 6974  new_variables.it
-00019f40: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-00019f50: 2020 2076 6172 203d 2073 656c 662e 5f76     var = self._v
-00019f60: 6172 6961 626c 6573 2e67 6574 286e 616d  ariables.get(nam
-00019f70: 6529 0a20 2020 2020 2020 2020 2020 2069  e).            i
-00019f80: 6620 7661 7220 6973 206e 6f74 204e 6f6e  f var is not Non
-00019f90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00019fa0: 2020 206e 6577 5f76 6172 2e61 7474 7273     new_var.attrs
-00019fb0: 203d 2076 6172 2e61 7474 7273 0a20 2020   = var.attrs.   
-00019fc0: 2020 2020 2020 2020 2020 2020 206e 6577               new
-00019fd0: 5f76 6172 2e65 6e63 6f64 696e 6720 3d20  _var.encoding = 
-00019fe0: 7661 722e 656e 636f 6469 6e67 0a0a 2020  var.encoding..  
-00019ff0: 2020 2020 2020 2320 7061 7373 2074 6872        # pass thr
-0001a000: 6f75 6768 2069 6e64 6578 6573 2066 726f  ough indexes fro
-0001a010: 6d20 6578 636c 7564 6564 2064 696d 656e  m excluded dimen
-0001a020: 7369 6f6e 730a 2020 2020 2020 2020 2320  sions.        # 
-0001a030: 6e6f 2065 7874 7261 2063 6865 636b 206e  no extra check n
-0001a040: 6565 6465 6420 666f 7220 6d75 6c74 692d  eeded for multi-
-0001a050: 636f 6f72 6469 6e61 7465 2069 6e64 6578  coordinate index
-0001a060: 6573 2c20 706f 7465 6e74 6961 6c20 636f  es, potential co
-0001a070: 6e66 6c69 6374 730a 2020 2020 2020 2020  nflicts.        
-0001a080: 2320 7368 6f75 6c64 2061 6c72 6561 6479  # should already
-0001a090: 2068 6176 6520 6265 656e 2064 6574 6563   have been detec
-0001a0a0: 7465 6420 7768 656e 2061 6c69 676e 696e  ted when alignin
-0001a0b0: 6720 7468 6520 696e 6465 7865 730a 2020  g the indexes.  
-0001a0c0: 2020 2020 2020 666f 7220 6e61 6d65 2c20        for name, 
-0001a0d0: 6964 7820 696e 2073 656c 662e 5f69 6e64  idx in self._ind
-0001a0e0: 6578 6573 2e69 7465 6d73 2829 3a0a 2020  exes.items():.  
-0001a0f0: 2020 2020 2020 2020 2020 7661 7220 3d20            var = 
-0001a100: 7365 6c66 2e5f 7661 7269 6162 6c65 735b  self._variables[
-0001a110: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
-0001a120: 2020 6966 2073 6574 2876 6172 2e64 696d    if set(var.dim
-0001a130: 7329 203c 3d20 6578 636c 7564 655f 6469  s) <= exclude_di
-0001a140: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
-0001a150: 2020 2020 6e65 775f 696e 6465 7865 735b      new_indexes[
-0001a160: 6e61 6d65 5d20 3d20 6964 780a 2020 2020  name] = idx.    
-0001a170: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-0001a180: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
-0001a190: 3d20 7661 720a 0a20 2020 2020 2020 2069  = var..        i
-0001a1a0: 6620 6e6f 7420 6469 6d5f 706f 735f 696e  f not dim_pos_in
-0001a1b0: 6465 7865 7273 3a0a 2020 2020 2020 2020  dexers:.        
-0001a1c0: 2020 2020 2320 6661 7374 2070 6174 6820      # fast path 
-0001a1d0: 666f 7220 6e6f 2072 6569 6e64 6578 696e  for no reindexin
-0001a1e0: 6720 6e65 6365 7373 6172 790a 2020 2020  g necessary.    
-0001a1f0: 2020 2020 2020 2020 6966 2073 6574 286e          if set(n
-0001a200: 6577 5f69 6e64 6578 6573 2920 2d20 7365  ew_indexes) - se
-0001a210: 7428 7365 6c66 2e5f 696e 6465 7865 7329  t(self._indexes)
-0001a220: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001a230: 2020 2320 7468 6973 206f 6e6c 7920 6164    # this only ad
-0001a240: 6473 206e 6577 2069 6e64 6578 6573 2061  ds new indexes a
-0001a250: 6e64 2074 6865 6972 2063 6f6f 7264 696e  nd their coordin
-0001a260: 6174 6520 7661 7269 6162 6c65 730a 2020  ate variables.  
-0001a270: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001a280: 696e 6465 7865 6420 3d20 7365 6c66 2e5f  indexed = self._
-0001a290: 6f76 6572 7772 6974 655f 696e 6465 7865  overwrite_indexe
-0001a2a0: 7328 6e65 775f 696e 6465 7865 732c 206e  s(new_indexes, n
-0001a2b0: 6577 5f76 6172 6961 626c 6573 290a 2020  ew_variables).  
-0001a2c0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0001a2d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a2e0: 7265 696e 6465 7865 6420 3d20 7365 6c66  reindexed = self
-0001a2f0: 2e63 6f70 7928 6465 6570 3d61 6c69 676e  .copy(deep=align
-0001a300: 6572 2e63 6f70 7929 0a20 2020 2020 2020  er.copy).       
-0001a310: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0001a320: 2020 2074 6f5f 7265 696e 6465 7820 3d20     to_reindex = 
-0001a330: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
-0001a340: 2020 6b3a 2076 0a20 2020 2020 2020 2020    k: v.         
-0001a350: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
-0001a360: 696e 2073 656c 662e 7661 7269 6162 6c65  in self.variable
-0001a370: 732e 6974 656d 7328 290a 2020 2020 2020  s.items().      
-0001a380: 2020 2020 2020 2020 2020 6966 206b 206e            if k n
-0001a390: 6f74 2069 6e20 7661 7269 6162 6c65 7320  ot in variables 
-0001a3a0: 616e 6420 6b20 6e6f 7420 696e 2065 7863  and k not in exc
-0001a3b0: 6c75 6465 5f76 6172 730a 2020 2020 2020  lude_vars.      
-0001a3c0: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
-0001a3d0: 2020 2020 7265 696e 6465 7865 645f 7661      reindexed_va
-0001a3e0: 7273 203d 2061 6c69 676e 6d65 6e74 2e72  rs = alignment.r
-0001a3f0: 6569 6e64 6578 5f76 6172 6961 626c 6573  eindex_variables
-0001a400: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001a410: 2020 746f 5f72 6569 6e64 6578 2c0a 2020    to_reindex,.  
-0001a420: 2020 2020 2020 2020 2020 2020 2020 6469                di
-0001a430: 6d5f 706f 735f 696e 6465 7865 7273 2c0a  m_pos_indexers,.
-0001a440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a450: 636f 7079 3d61 6c69 676e 6572 2e63 6f70  copy=aligner.cop
-0001a460: 792c 0a20 2020 2020 2020 2020 2020 2020  y,.             
-0001a470: 2020 2066 696c 6c5f 7661 6c75 653d 6669     fill_value=fi
-0001a480: 6c6c 5f76 616c 7565 2c0a 2020 2020 2020  ll_value,.      
-0001a490: 2020 2020 2020 2020 2020 7370 6172 7365            sparse
-0001a4a0: 3d61 6c69 676e 6572 2e73 7061 7273 652c  =aligner.sparse,
-0001a4b0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0001a4c0: 2020 2020 2020 2020 2020 206e 6577 5f76             new_v
-0001a4d0: 6172 6961 626c 6573 2e75 7064 6174 6528  ariables.update(
-0001a4e0: 7265 696e 6465 7865 645f 7661 7273 290a  reindexed_vars).
-0001a4f0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-0001a500: 636f 6f72 645f 6e61 6d65 7320 3d20 7365  coord_names = se
-0001a510: 6c66 2e5f 636f 6f72 645f 6e61 6d65 7320  lf._coord_names 
-0001a520: 7c20 7365 7428 6e65 775f 696e 6465 7865  | set(new_indexe
-0001a530: 7329 0a20 2020 2020 2020 2020 2020 2072  s).            r
-0001a540: 6569 6e64 6578 6564 203d 2073 656c 662e  eindexed = self.
-0001a550: 5f72 6570 6c61 6365 5f77 6974 685f 6e65  _replace_with_ne
-0001a560: 775f 6469 6d73 280a 2020 2020 2020 2020  w_dims(.        
-0001a570: 2020 2020 2020 2020 6e65 775f 7661 7269          new_vari
-0001a580: 6162 6c65 732c 206e 6577 5f63 6f6f 7264  ables, new_coord
-0001a590: 5f6e 616d 6573 2c20 696e 6465 7865 733d  _names, indexes=
-0001a5a0: 6e65 775f 696e 6465 7865 730a 2020 2020  new_indexes.    
-0001a5b0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-0001a5c0: 2020 2072 6574 7572 6e20 7265 696e 6465     return reinde
-0001a5d0: 7865 640a 0a20 2020 2064 6566 2072 6569  xed..    def rei
-0001a5e0: 6e64 6578 5f6c 696b 6528 0a20 2020 2020  ndex_like(.     
-0001a5f0: 2020 2073 656c 663a 2054 5f44 6174 6173     self: T_Datas
-0001a600: 6574 2c0a 2020 2020 2020 2020 6f74 6865  et,.        othe
-0001a610: 723a 2044 6174 6173 6574 207c 2044 6174  r: Dataset | Dat
-0001a620: 6141 7272 6179 2c0a 2020 2020 2020 2020  aArray,.        
-0001a630: 6d65 7468 6f64 3a20 5265 696e 6465 784d  method: ReindexM
-0001a640: 6574 686f 644f 7074 696f 6e73 203d 204e  ethodOptions = N
-0001a650: 6f6e 652c 0a20 2020 2020 2020 2074 6f6c  one,.        tol
-0001a660: 6572 616e 6365 3a20 696e 7420 7c20 666c  erance: int | fl
-0001a670: 6f61 7420 7c20 4974 6572 6162 6c65 5b69  oat | Iterable[i
-0001a680: 6e74 207c 2066 6c6f 6174 5d20 7c20 4e6f  nt | float] | No
-0001a690: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
-0001a6a0: 2020 2063 6f70 793a 2062 6f6f 6c20 3d20     copy: bool = 
-0001a6b0: 5472 7565 2c0a 2020 2020 2020 2020 6669  True,.        fi
-0001a6c0: 6c6c 5f76 616c 7565 3a20 416e 7920 3d20  ll_value: Any = 
-0001a6d0: 7872 6474 7970 6573 2e4e 412c 0a20 2020  xrdtypes.NA,.   
-0001a6e0: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
-0001a6f0: 0a20 2020 2020 2020 2022 2222 436f 6e66  .        """Conf
-0001a700: 6f72 6d20 7468 6973 206f 626a 6563 7420  orm this object 
-0001a710: 6f6e 746f 2074 6865 2069 6e64 6578 6573  onto the indexes
-0001a720: 206f 6620 616e 6f74 6865 7220 6f62 6a65   of another obje
-0001a730: 6374 2c20 6669 6c6c 696e 6720 696e 0a20  ct, filling in. 
-0001a740: 2020 2020 2020 206d 6973 7369 6e67 2076         missing v
-0001a750: 616c 7565 7320 7769 7468 2060 6066 696c  alues with ``fil
-0001a760: 6c5f 7661 6c75 6560 602e 2054 6865 2064  l_value``. The d
-0001a770: 6566 6175 6c74 2066 696c 6c20 7661 6c75  efault fill valu
-0001a780: 6520 6973 204e 614e 2e0a 0a20 2020 2020  e is NaN...     
-0001a790: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0001a7a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0001a7b0: 0a20 2020 2020 2020 206f 7468 6572 203a  .        other :
-0001a7c0: 2044 6174 6173 6574 206f 7220 4461 7461   Dataset or Data
-0001a7d0: 4172 7261 790a 2020 2020 2020 2020 2020  Array.          
-0001a7e0: 2020 4f62 6a65 6374 2077 6974 6820 616e    Object with an
-0001a7f0: 2027 696e 6465 7865 7327 2061 7474 7269   'indexes' attri
-0001a800: 6275 7465 2067 6976 696e 6720 6120 6d61  bute giving a ma
-0001a810: 7070 696e 6720 6672 6f6d 2064 696d 656e  pping from dimen
-0001a820: 7369 6f6e 0a20 2020 2020 2020 2020 2020  sion.           
-0001a830: 206e 616d 6573 2074 6f20 7061 6e64 6173   names to pandas
-0001a840: 2e49 6e64 6578 206f 626a 6563 7473 2c20  .Index objects, 
-0001a850: 7768 6963 6820 7072 6f76 6964 6573 2063  which provides c
-0001a860: 6f6f 7264 696e 6174 6573 2075 706f 6e0a  oordinates upon.
-0001a870: 2020 2020 2020 2020 2020 2020 7768 6963              whic
-0001a880: 6820 746f 2069 6e64 6578 2074 6865 2076  h to index the v
-0001a890: 6172 6961 626c 6573 2069 6e20 7468 6973  ariables in this
-0001a8a0: 2064 6174 6173 6574 2e20 5468 6520 696e   dataset. The in
-0001a8b0: 6465 7865 7320 6f6e 2074 6869 730a 2020  dexes on this.  
-0001a8c0: 2020 2020 2020 2020 2020 6f74 6865 7220            other 
-0001a8d0: 6f62 6a65 6374 206e 6565 6420 6e6f 7420  object need not 
-0001a8e0: 6265 2074 6865 2073 616d 6520 6173 2074  be the same as t
-0001a8f0: 6865 2069 6e64 6578 6573 206f 6e20 7468  he indexes on th
-0001a900: 6973 0a20 2020 2020 2020 2020 2020 2064  is.            d
-0001a910: 6174 6173 6574 2e20 416e 7920 6d69 732d  ataset. Any mis-
-0001a920: 6d61 7463 6865 6420 696e 6465 7820 7661  matched index va
-0001a930: 6c75 6573 2077 696c 6c20 6265 2066 696c  lues will be fil
-0001a940: 6c65 6420 696e 2077 6974 680a 2020 2020  led in with.    
-0001a950: 2020 2020 2020 2020 4e61 4e2c 2061 6e64          NaN, and
-0001a960: 2061 6e79 206d 6973 2d6d 6174 6368 6564   any mis-matched
-0001a970: 2064 696d 656e 7369 6f6e 206e 616d 6573   dimension names
-0001a980: 2077 696c 6c20 7369 6d70 6c79 2062 6520   will simply be 
-0001a990: 6967 6e6f 7265 642e 0a20 2020 2020 2020  ignored..       
-0001a9a0: 206d 6574 686f 6420 3a20 7b4e 6f6e 652c   method : {None,
-0001a9b0: 2022 6e65 6172 6573 7422 2c20 2270 6164   "nearest", "pad
-0001a9c0: 222c 2022 6666 696c 6c22 2c20 2262 6163  ", "ffill", "bac
-0001a9d0: 6b66 696c 6c22 2c20 2262 6669 6c6c 222c  kfill", "bfill",
-0001a9e0: 204e 6f6e 657d 2c20 6f70 7469 6f6e 616c   None}, optional
-0001a9f0: 0a20 2020 2020 2020 2020 2020 204d 6574  .            Met
-0001aa00: 686f 6420 746f 2075 7365 2066 6f72 2066  hod to use for f
-0001aa10: 696c 6c69 6e67 2069 6e64 6578 2076 616c  illing index val
-0001aa20: 7565 7320 6672 6f6d 206f 7468 6572 206e  ues from other n
-0001aa30: 6f74 2066 6f75 6e64 2069 6e20 7468 6973  ot found in this
-0001aa40: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-0001aa50: 6173 6574 3a0a 0a20 2020 2020 2020 2020  aset:..         
-0001aa60: 2020 202d 204e 6f6e 6520 2864 6566 6175     - None (defau
-0001aa70: 6c74 293a 2064 6f6e 2774 2066 696c 6c20  lt): don't fill 
-0001aa80: 6761 7073 0a20 2020 2020 2020 2020 2020  gaps.           
-0001aa90: 202d 2022 7061 6422 202f 2022 6666 696c   - "pad" / "ffil
-0001aaa0: 6c22 3a20 7072 6f70 6167 6174 6520 6c61  l": propagate la
-0001aab0: 7374 2076 616c 6964 2069 6e64 6578 2076  st valid index v
-0001aac0: 616c 7565 2066 6f72 7761 7264 0a20 2020  alue forward.   
-0001aad0: 2020 2020 2020 2020 202d 2022 6261 636b           - "back
-0001aae0: 6669 6c6c 2220 2f20 2262 6669 6c6c 223a  fill" / "bfill":
-0001aaf0: 2070 726f 7061 6761 7465 206e 6578 7420   propagate next 
-0001ab00: 7661 6c69 6420 696e 6465 7820 7661 6c75  valid index valu
-0001ab10: 6520 6261 636b 7761 7264 0a20 2020 2020  e backward.     
-0001ab20: 2020 2020 2020 202d 2022 6e65 6172 6573         - "neares
-0001ab30: 7422 3a20 7573 6520 6e65 6172 6573 7420  t": use nearest 
-0001ab40: 7661 6c69 6420 696e 6465 7820 7661 6c75  valid index valu
-0001ab50: 650a 0a20 2020 2020 2020 2074 6f6c 6572  e..        toler
-0001ab60: 616e 6365 203a 206f 7074 696f 6e61 6c0a  ance : optional.
-0001ab70: 2020 2020 2020 2020 2020 2020 4d61 7869              Maxi
-0001ab80: 6d75 6d20 6469 7374 616e 6365 2062 6574  mum distance bet
-0001ab90: 7765 656e 206f 7269 6769 6e61 6c20 616e  ween original an
-0001aba0: 6420 6e65 7720 6c61 6265 6c73 2066 6f72  d new labels for
-0001abb0: 2069 6e65 7861 6374 0a20 2020 2020 2020   inexact.       
-0001abc0: 2020 2020 206d 6174 6368 6573 2e20 5468       matches. Th
-0001abd0: 6520 7661 6c75 6573 206f 6620 7468 6520  e values of the 
-0001abe0: 696e 6465 7820 6174 2074 6865 206d 6174  index at the mat
-0001abf0: 6368 696e 6720 6c6f 6361 7469 6f6e 7320  ching locations 
-0001ac00: 6d75 7374 0a20 2020 2020 2020 2020 2020  must.           
-0001ac10: 2073 6174 6973 6679 2074 6865 2065 7175   satisfy the equ
-0001ac20: 6174 696f 6e20 6060 6162 7328 696e 6465  ation ``abs(inde
-0001ac30: 785b 696e 6465 7865 725d 202d 2074 6172  x[indexer] - tar
-0001ac40: 6765 7429 203c 3d20 746f 6c65 7261 6e63  get) <= toleranc
-0001ac50: 6560 602e 0a20 2020 2020 2020 2020 2020  e``..           
-0001ac60: 2054 6f6c 6572 616e 6365 206d 6179 2062   Tolerance may b
-0001ac70: 6520 6120 7363 616c 6172 2076 616c 7565  e a scalar value
-0001ac80: 2c20 7768 6963 6820 6170 706c 6965 7320  , which applies 
-0001ac90: 7468 6520 7361 6d65 2074 6f6c 6572 616e  the same toleran
-0001aca0: 6365 0a20 2020 2020 2020 2020 2020 2074  ce.            t
-0001acb0: 6f20 616c 6c20 7661 6c75 6573 2c20 6f72  o all values, or
-0001acc0: 206c 6973 742d 6c69 6b65 2c20 7768 6963   list-like, whic
-0001acd0: 6820 6170 706c 6965 7320 7661 7269 6162  h applies variab
-0001ace0: 6c65 2074 6f6c 6572 616e 6365 2070 6572  le tolerance per
-0001acf0: 0a20 2020 2020 2020 2020 2020 2065 6c65  .            ele
-0001ad00: 6d65 6e74 2e20 4c69 7374 2d6c 696b 6520  ment. List-like 
-0001ad10: 6d75 7374 2062 6520 7468 6520 7361 6d65  must be the same
-0001ad20: 2073 697a 6520 6173 2074 6865 2069 6e64   size as the ind
-0001ad30: 6578 2061 6e64 2069 7473 2064 7479 7065  ex and its dtype
-0001ad40: 0a20 2020 2020 2020 2020 2020 206d 7573  .            mus
-0001ad50: 7420 6578 6163 746c 7920 6d61 7463 6820  t exactly match 
-0001ad60: 7468 6520 696e 6465 78e2 8099 7320 7479  the index...s ty
-0001ad70: 7065 2e0a 2020 2020 2020 2020 636f 7079  pe..        copy
-0001ad80: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
-0001ad90: 3a20 5472 7565 0a20 2020 2020 2020 2020  : True.         
-0001ada0: 2020 2049 6620 6060 636f 7079 3d54 7275     If ``copy=Tru
-0001adb0: 6560 602c 2064 6174 6120 696e 2074 6865  e``, data in the
-0001adc0: 2072 6574 7572 6e20 7661 6c75 6520 6973   return value is
-0001add0: 2061 6c77 6179 7320 636f 7069 6564 2e20   always copied. 
-0001ade0: 4966 0a20 2020 2020 2020 2020 2020 2060  If.            `
-0001adf0: 6063 6f70 793d 4661 6c73 6560 6020 616e  `copy=False`` an
-0001ae00: 6420 7265 696e 6465 7869 6e67 2069 7320  d reindexing is 
-0001ae10: 756e 6e65 6365 7373 6172 792c 206f 7220  unnecessary, or 
-0001ae20: 6361 6e20 6265 2070 6572 666f 726d 6564  can be performed
-0001ae30: 0a20 2020 2020 2020 2020 2020 2077 6974  .            wit
-0001ae40: 6820 6f6e 6c79 2073 6c69 6365 206f 7065  h only slice ope
-0001ae50: 7261 7469 6f6e 732c 2074 6865 6e20 7468  rations, then th
-0001ae60: 6520 6f75 7470 7574 206d 6179 2073 6861  e output may sha
-0001ae70: 7265 206d 656d 6f72 7920 7769 7468 0a20  re memory with. 
-0001ae80: 2020 2020 2020 2020 2020 2074 6865 2069             the i
-0001ae90: 6e70 7574 2e20 496e 2065 6974 6865 7220  nput. In either 
-0001aea0: 6361 7365 2c20 6120 6e65 7720 7861 7272  case, a new xarr
-0001aeb0: 6179 206f 626a 6563 7420 6973 2061 6c77  ay object is alw
-0001aec0: 6179 7320 7265 7475 726e 6564 2e0a 2020  ays returned..  
-0001aed0: 2020 2020 2020 6669 6c6c 5f76 616c 7565        fill_value
-0001aee0: 203a 2073 6361 6c61 7220 6f72 2064 6963   : scalar or dic
-0001aef0: 742d 6c69 6b65 2c20 6f70 7469 6f6e 616c  t-like, optional
-0001af00: 0a20 2020 2020 2020 2020 2020 2056 616c  .            Val
-0001af10: 7565 2074 6f20 7573 6520 666f 7220 6e65  ue to use for ne
-0001af20: 776c 7920 6d69 7373 696e 6720 7661 6c75  wly missing valu
-0001af30: 6573 2e20 4966 2061 2064 6963 742d 6c69  es. If a dict-li
-0001af40: 6b65 206d 6170 730a 2020 2020 2020 2020  ke maps.        
-0001af50: 2020 2020 7661 7269 6162 6c65 206e 616d      variable nam
-0001af60: 6573 2074 6f20 6669 6c6c 2076 616c 7565  es to fill value
-0001af70: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
-0001af80: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-0001af90: 2d2d 2d0a 2020 2020 2020 2020 7265 696e  ---.        rein
-0001afa0: 6465 7865 6420 3a20 4461 7461 7365 740a  dexed : Dataset.
-0001afb0: 2020 2020 2020 2020 2020 2020 416e 6f74              Anot
-0001afc0: 6865 7220 6461 7461 7365 742c 2077 6974  her dataset, wit
-0001afd0: 6820 7468 6973 2064 6174 6173 6574 2773  h this dataset's
-0001afe0: 2064 6174 6120 6275 7420 636f 6f72 6469   data but coordi
-0001aff0: 6e61 7465 7320 6672 6f6d 2074 6865 0a20  nates from the. 
-0001b000: 2020 2020 2020 2020 2020 206f 7468 6572             other
-0001b010: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
-0001b020: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-0001b030: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0001b040: 2020 2020 4461 7461 7365 742e 7265 696e      Dataset.rein
-0001b050: 6465 780a 2020 2020 2020 2020 616c 6967  dex.        alig
-0001b060: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
-0001b070: 2020 2020 2020 7265 7475 726e 2061 6c69        return ali
-0001b080: 676e 6d65 6e74 2e72 6569 6e64 6578 5f6c  gnment.reindex_l
-0001b090: 696b 6528 0a20 2020 2020 2020 2020 2020  ike(.           
-0001b0a0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-0001b0b0: 2020 206f 7468 6572 3d6f 7468 6572 2c0a     other=other,.
-0001b0c0: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
-0001b0d0: 6f64 3d6d 6574 686f 642c 0a20 2020 2020  od=method,.     
-0001b0e0: 2020 2020 2020 2074 6f6c 6572 616e 6365         tolerance
-0001b0f0: 3d74 6f6c 6572 616e 6365 2c0a 2020 2020  =tolerance,.    
-0001b100: 2020 2020 2020 2020 636f 7079 3d63 6f70          copy=cop
-0001b110: 792c 0a20 2020 2020 2020 2020 2020 2066  y,.            f
-0001b120: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
-0001b130: 616c 7565 2c0a 2020 2020 2020 2020 290a  alue,.        ).
-0001b140: 0a20 2020 2064 6566 2072 6569 6e64 6578  .    def reindex
-0001b150: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
-0001b160: 545f 4461 7461 7365 742c 0a20 2020 2020  T_Dataset,.     
-0001b170: 2020 2069 6e64 6578 6572 733a 204d 6170     indexers: Map
-0001b180: 7069 6e67 5b41 6e79 2c20 416e 795d 207c  ping[Any, Any] |
-0001b190: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-0001b1a0: 2020 2020 2020 6d65 7468 6f64 3a20 5265        method: Re
-0001b1b0: 696e 6465 784d 6574 686f 644f 7074 696f  indexMethodOptio
-0001b1c0: 6e73 203d 204e 6f6e 652c 0a20 2020 2020  ns = None,.     
-0001b1d0: 2020 2074 6f6c 6572 616e 6365 3a20 696e     tolerance: in
-0001b1e0: 7420 7c20 666c 6f61 7420 7c20 4974 6572  t | float | Iter
-0001b1f0: 6162 6c65 5b69 6e74 207c 2066 6c6f 6174  able[int | float
-0001b200: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-0001b210: 0a20 2020 2020 2020 2063 6f70 793a 2062  .        copy: b
-0001b220: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
-0001b230: 2020 2020 6669 6c6c 5f76 616c 7565 3a20      fill_value: 
-0001b240: 416e 7920 3d20 7872 6474 7970 6573 2e4e  Any = xrdtypes.N
-0001b250: 412c 0a20 2020 2020 2020 202a 2a69 6e64  A,.        **ind
-0001b260: 6578 6572 735f 6b77 6172 6773 3a20 416e  exers_kwargs: An
-0001b270: 792c 0a20 2020 2029 202d 3e20 545f 4461  y,.    ) -> T_Da
-0001b280: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-0001b290: 2222 436f 6e66 6f72 6d20 7468 6973 206f  ""Conform this o
-0001b2a0: 626a 6563 7420 6f6e 746f 2061 206e 6577  bject onto a new
-0001b2b0: 2073 6574 206f 6620 696e 6465 7865 732c   set of indexes,
-0001b2c0: 2066 696c 6c69 6e67 2069 6e0a 2020 2020   filling in.    
-0001b2d0: 2020 2020 6d69 7373 696e 6720 7661 6c75      missing valu
-0001b2e0: 6573 2077 6974 6820 6060 6669 6c6c 5f76  es with ``fill_v
-0001b2f0: 616c 7565 6060 2e20 5468 6520 6465 6661  alue``. The defa
-0001b300: 756c 7420 6669 6c6c 2076 616c 7565 2069  ult fill value i
-0001b310: 7320 4e61 4e2e 0a0a 2020 2020 2020 2020  s NaN...        
-0001b320: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-0001b330: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0001b340: 2020 2020 2020 696e 6465 7865 7273 203a        indexers :
-0001b350: 2064 6963 742c 206f 7074 696f 6e61 6c0a   dict, optional.
-0001b360: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
-0001b370: 696f 6e61 7279 2077 6974 6820 6b65 7973  ionary with keys
-0001b380: 2067 6976 656e 2062 7920 6469 6d65 6e73   given by dimens
-0001b390: 696f 6e20 6e61 6d65 7320 616e 6420 7661  ion names and va
-0001b3a0: 6c75 6573 2067 6976 656e 2062 790a 2020  lues given by.  
-0001b3b0: 2020 2020 2020 2020 2020 6172 7261 7973            arrays
-0001b3c0: 206f 6620 636f 6f72 6469 6e61 7465 7320   of coordinates 
-0001b3d0: 7469 636b 206c 6162 656c 732e 2041 6e79  tick labels. Any
-0001b3e0: 206d 6973 2d6d 6174 6368 6564 2063 6f6f   mis-matched coo
-0001b3f0: 7264 696e 6174 650a 2020 2020 2020 2020  rdinate.        
-0001b400: 2020 2020 7661 6c75 6573 2077 696c 6c20      values will 
-0001b410: 6265 2066 696c 6c65 6420 696e 2077 6974  be filled in wit
-0001b420: 6820 4e61 4e2c 2061 6e64 2061 6e79 206d  h NaN, and any m
-0001b430: 6973 2d6d 6174 6368 6564 2064 696d 656e  is-matched dimen
-0001b440: 7369 6f6e 0a20 2020 2020 2020 2020 2020  sion.           
-0001b450: 206e 616d 6573 2077 696c 6c20 7369 6d70   names will simp
-0001b460: 6c79 2062 6520 6967 6e6f 7265 642e 0a20  ly be ignored.. 
-0001b470: 2020 2020 2020 2020 2020 204f 6e65 206f             One o
-0001b480: 6620 696e 6465 7865 7273 206f 7220 696e  f indexers or in
-0001b490: 6465 7865 7273 5f6b 7761 7267 7320 6d75  dexers_kwargs mu
-0001b4a0: 7374 2062 6520 7072 6f76 6964 6564 2e0a  st be provided..
-0001b4b0: 2020 2020 2020 2020 6d65 7468 6f64 203a          method :
-0001b4c0: 207b 4e6f 6e65 2c20 226e 6561 7265 7374   {None, "nearest
-0001b4d0: 222c 2022 7061 6422 2c20 2266 6669 6c6c  ", "pad", "ffill
-0001b4e0: 222c 2022 6261 636b 6669 6c6c 222c 2022  ", "backfill", "
-0001b4f0: 6266 696c 6c22 2c20 4e6f 6e65 7d2c 206f  bfill", None}, o
-0001b500: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0001b510: 2020 2020 4d65 7468 6f64 2074 6f20 7573      Method to us
-0001b520: 6520 666f 7220 6669 6c6c 696e 6720 696e  e for filling in
-0001b530: 6465 7820 7661 6c75 6573 2069 6e20 6060  dex values in ``
-0001b540: 696e 6465 7865 7273 6060 206e 6f74 2066  indexers`` not f
-0001b550: 6f75 6e64 2069 6e0a 2020 2020 2020 2020  ound in.        
-0001b560: 2020 2020 7468 6973 2064 6174 6173 6574      this dataset
-0001b570: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
-0001b580: 204e 6f6e 6520 2864 6566 6175 6c74 293a   None (default):
-0001b590: 2064 6f6e 2774 2066 696c 6c20 6761 7073   don't fill gaps
-0001b5a0: 0a20 2020 2020 2020 2020 2020 202d 2022  .            - "
-0001b5b0: 7061 6422 202f 2022 6666 696c 6c22 3a20  pad" / "ffill": 
-0001b5c0: 7072 6f70 6167 6174 6520 6c61 7374 2076  propagate last v
-0001b5d0: 616c 6964 2069 6e64 6578 2076 616c 7565  alid index value
-0001b5e0: 2066 6f72 7761 7264 0a20 2020 2020 2020   forward.       
-0001b5f0: 2020 2020 202d 2022 6261 636b 6669 6c6c       - "backfill
-0001b600: 2220 2f20 2262 6669 6c6c 223a 2070 726f  " / "bfill": pro
-0001b610: 7061 6761 7465 206e 6578 7420 7661 6c69  pagate next vali
-0001b620: 6420 696e 6465 7820 7661 6c75 6520 6261  d index value ba
-0001b630: 636b 7761 7264 0a20 2020 2020 2020 2020  ckward.         
-0001b640: 2020 202d 2022 6e65 6172 6573 7422 3a20     - "nearest": 
-0001b650: 7573 6520 6e65 6172 6573 7420 7661 6c69  use nearest vali
-0001b660: 6420 696e 6465 7820 7661 6c75 650a 0a20  d index value.. 
-0001b670: 2020 2020 2020 2074 6f6c 6572 616e 6365         tolerance
-0001b680: 203a 206f 7074 696f 6e61 6c0a 2020 2020   : optional.    
-0001b690: 2020 2020 2020 2020 4d61 7869 6d75 6d20          Maximum 
-0001b6a0: 6469 7374 616e 6365 2062 6574 7765 656e  distance between
-0001b6b0: 206f 7269 6769 6e61 6c20 616e 6420 6e65   original and ne
-0001b6c0: 7720 6c61 6265 6c73 2066 6f72 2069 6e65  w labels for ine
-0001b6d0: 7861 6374 0a20 2020 2020 2020 2020 2020  xact.           
-0001b6e0: 206d 6174 6368 6573 2e20 5468 6520 7661   matches. The va
-0001b6f0: 6c75 6573 206f 6620 7468 6520 696e 6465  lues of the inde
-0001b700: 7820 6174 2074 6865 206d 6174 6368 696e  x at the matchin
-0001b710: 6720 6c6f 6361 7469 6f6e 7320 6d75 7374  g locations must
-0001b720: 0a20 2020 2020 2020 2020 2020 2073 6174  .            sat
-0001b730: 6973 6679 2074 6865 2065 7175 6174 696f  isfy the equatio
-0001b740: 6e20 6060 6162 7328 696e 6465 785b 696e  n ``abs(index[in
-0001b750: 6465 7865 725d 202d 2074 6172 6765 7429  dexer] - target)
-0001b760: 203c 3d20 746f 6c65 7261 6e63 6560 602e   <= tolerance``.
-0001b770: 0a20 2020 2020 2020 2020 2020 2054 6f6c  .            Tol
-0001b780: 6572 616e 6365 206d 6179 2062 6520 6120  erance may be a 
-0001b790: 7363 616c 6172 2076 616c 7565 2c20 7768  scalar value, wh
-0001b7a0: 6963 6820 6170 706c 6965 7320 7468 6520  ich applies the 
-0001b7b0: 7361 6d65 2074 6f6c 6572 616e 6365 0a20  same tolerance. 
-0001b7c0: 2020 2020 2020 2020 2020 2074 6f20 616c             to al
-0001b7d0: 6c20 7661 6c75 6573 2c20 6f72 206c 6973  l values, or lis
-0001b7e0: 742d 6c69 6b65 2c20 7768 6963 6820 6170  t-like, which ap
-0001b7f0: 706c 6965 7320 7661 7269 6162 6c65 2074  plies variable t
-0001b800: 6f6c 6572 616e 6365 2070 6572 0a20 2020  olerance per.   
-0001b810: 2020 2020 2020 2020 2065 6c65 6d65 6e74           element
-0001b820: 2e20 4c69 7374 2d6c 696b 6520 6d75 7374  . List-like must
-0001b830: 2062 6520 7468 6520 7361 6d65 2073 697a   be the same siz
-0001b840: 6520 6173 2074 6865 2069 6e64 6578 2061  e as the index a
-0001b850: 6e64 2069 7473 2064 7479 7065 0a20 2020  nd its dtype.   
-0001b860: 2020 2020 2020 2020 206d 7573 7420 6578           must ex
-0001b870: 6163 746c 7920 6d61 7463 6820 7468 6520  actly match the 
-0001b880: 696e 6465 78e2 8099 7320 7479 7065 2e0a  index...s type..
-0001b890: 2020 2020 2020 2020 636f 7079 203a 2062          copy : b
-0001b8a0: 6f6f 6c2c 2064 6566 6175 6c74 3a20 5472  ool, default: Tr
-0001b8b0: 7565 0a20 2020 2020 2020 2020 2020 2049  ue.            I
-0001b8c0: 6620 6060 636f 7079 3d54 7275 6560 602c  f ``copy=True``,
-0001b8d0: 2064 6174 6120 696e 2074 6865 2072 6574   data in the ret
-0001b8e0: 7572 6e20 7661 6c75 6520 6973 2061 6c77  urn value is alw
-0001b8f0: 6179 7320 636f 7069 6564 2e20 4966 0a20  ays copied. If. 
-0001b900: 2020 2020 2020 2020 2020 2060 6063 6f70             ``cop
-0001b910: 793d 4661 6c73 6560 6020 616e 6420 7265  y=False`` and re
-0001b920: 696e 6465 7869 6e67 2069 7320 756e 6e65  indexing is unne
-0001b930: 6365 7373 6172 792c 206f 7220 6361 6e20  cessary, or can 
-0001b940: 6265 2070 6572 666f 726d 6564 0a20 2020  be performed.   
-0001b950: 2020 2020 2020 2020 2077 6974 6820 6f6e           with on
-0001b960: 6c79 2073 6c69 6365 206f 7065 7261 7469  ly slice operati
-0001b970: 6f6e 732c 2074 6865 6e20 7468 6520 6f75  ons, then the ou
-0001b980: 7470 7574 206d 6179 2073 6861 7265 206d  tput may share m
-0001b990: 656d 6f72 7920 7769 7468 0a20 2020 2020  emory with.     
-0001b9a0: 2020 2020 2020 2074 6865 2069 6e70 7574         the input
-0001b9b0: 2e20 496e 2065 6974 6865 7220 6361 7365  . In either case
-0001b9c0: 2c20 6120 6e65 7720 7861 7272 6179 206f  , a new xarray o
-0001b9d0: 626a 6563 7420 6973 2061 6c77 6179 7320  bject is always 
-0001b9e0: 7265 7475 726e 6564 2e0a 2020 2020 2020  returned..      
-0001b9f0: 2020 6669 6c6c 5f76 616c 7565 203a 2073    fill_value : s
-0001ba00: 6361 6c61 7220 6f72 2064 6963 742d 6c69  calar or dict-li
-0001ba10: 6b65 2c20 6f70 7469 6f6e 616c 0a20 2020  ke, optional.   
-0001ba20: 2020 2020 2020 2020 2056 616c 7565 2074           Value t
-0001ba30: 6f20 7573 6520 666f 7220 6e65 776c 7920  o use for newly 
-0001ba40: 6d69 7373 696e 6720 7661 6c75 6573 2e20  missing values. 
-0001ba50: 4966 2061 2064 6963 742d 6c69 6b65 2c0a  If a dict-like,.
-0001ba60: 2020 2020 2020 2020 2020 2020 6d61 7073              maps
-0001ba70: 2076 6172 6961 626c 6520 6e61 6d65 7320   variable names 
-0001ba80: 2869 6e63 6c75 6469 6e67 2063 6f6f 7264  (including coord
-0001ba90: 696e 6174 6573 2920 746f 2066 696c 6c20  inates) to fill 
-0001baa0: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
-0001bab0: 7370 6172 7365 203a 2062 6f6f 6c2c 2064  sparse : bool, d
-0001bac0: 6566 6175 6c74 3a20 4661 6c73 650a 2020  efault: False.  
-0001bad0: 2020 2020 2020 2020 2020 7573 6520 7370            use sp
-0001bae0: 6172 7365 2d61 7272 6179 2e0a 2020 2020  arse-array..    
-0001baf0: 2020 2020 2a2a 696e 6465 7865 7273 5f6b      **indexers_k
-0001bb00: 7761 7267 7320 3a20 7b64 696d 3a20 696e  wargs : {dim: in
-0001bb10: 6465 7865 722c 202e 2e2e 7d2c 206f 7074  dexer, ...}, opt
-0001bb20: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0001bb30: 2020 4b65 7977 6f72 6420 6172 6775 6d65    Keyword argume
-0001bb40: 6e74 7320 696e 2074 6865 2073 616d 6520  nts in the same 
-0001bb50: 666f 726d 2061 7320 6060 696e 6465 7865  form as ``indexe
-0001bb60: 7273 6060 2e0a 2020 2020 2020 2020 2020  rs``..          
-0001bb70: 2020 4f6e 6520 6f66 2069 6e64 6578 6572    One of indexer
-0001bb80: 7320 6f72 2069 6e64 6578 6572 735f 6b77  s or indexers_kw
-0001bb90: 6172 6773 206d 7573 7420 6265 2070 726f  args must be pro
-0001bba0: 7669 6465 642e 0a0a 2020 2020 2020 2020  vided...        
-0001bbb0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0001bbc0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001bbd0: 7265 696e 6465 7865 6420 3a20 4461 7461  reindexed : Data
-0001bbe0: 7365 740a 2020 2020 2020 2020 2020 2020  set.            
-0001bbf0: 416e 6f74 6865 7220 6461 7461 7365 742c  Another dataset,
-0001bc00: 2077 6974 6820 7468 6973 2064 6174 6173   with this datas
-0001bc10: 6574 2773 2064 6174 6120 6275 7420 7265  et's data but re
-0001bc20: 706c 6163 6564 2063 6f6f 7264 696e 6174  placed coordinat
-0001bc30: 6573 2e0a 0a20 2020 2020 2020 2053 6565  es...        See
-0001bc40: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-0001bc50: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-0001bc60: 6174 6173 6574 2e72 6569 6e64 6578 5f6c  ataset.reindex_l
-0001bc70: 696b 650a 2020 2020 2020 2020 616c 6967  ike.        alig
-0001bc80: 6e0a 2020 2020 2020 2020 7061 6e64 6173  n.        pandas
-0001bc90: 2e49 6e64 6578 2e67 6574 5f69 6e64 6578  .Index.get_index
-0001bca0: 6572 0a0a 2020 2020 2020 2020 4578 616d  er..        Exam
-0001bcb0: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-0001bcc0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4372  -----.        Cr
-0001bcd0: 6561 7465 2061 2064 6174 6173 6574 2077  eate a dataset w
-0001bce0: 6974 6820 736f 6d65 2066 6963 7469 6f6e  ith some fiction
-0001bcf0: 616c 2064 6174 612e 0a0a 2020 2020 2020  al data...      
-0001bd00: 2020 3e3e 3e20 7820 3d20 7872 2e44 6174    >>> x = xr.Dat
-0001bd10: 6173 6574 280a 2020 2020 2020 2020 2e2e  aset(.        ..
-0001bd20: 2e20 2020 2020 7b0a 2020 2020 2020 2020  .     {.        
-0001bd30: 2e2e 2e20 2020 2020 2020 2020 2274 656d  ...         "tem
-0001bd40: 7065 7261 7475 7265 223a 2028 2273 7461  perature": ("sta
-0001bd50: 7469 6f6e 222c 2032 3020 2a20 6e70 2e72  tion", 20 * np.r
-0001bd60: 616e 646f 6d2e 7261 6e64 2834 2929 2c0a  andom.rand(4)),.
-0001bd70: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001bd80: 2020 2020 2270 7265 7373 7572 6522 3a20      "pressure": 
-0001bd90: 2822 7374 6174 696f 6e22 2c20 3530 3020  ("station", 500 
-0001bda0: 2a20 6e70 2e72 616e 646f 6d2e 7261 6e64  * np.random.rand
-0001bdb0: 2834 2929 2c0a 2020 2020 2020 2020 2e2e  (4)),.        ..
-0001bdc0: 2e20 2020 2020 7d2c 0a20 2020 2020 2020  .     },.       
-0001bdd0: 202e 2e2e 2020 2020 2063 6f6f 7264 733d   ...     coords=
-0001bde0: 7b22 7374 6174 696f 6e22 3a20 5b22 626f  {"station": ["bo
-0001bdf0: 7374 6f6e 222c 2022 6e79 6322 2c20 2273  ston", "nyc", "s
-0001be00: 6561 7474 6c65 222c 2022 6465 6e76 6572  eattle", "denver
-0001be10: 225d 7d2c 0a20 2020 2020 2020 202e 2e2e  "]},.        ...
-0001be20: 2029 0a20 2020 2020 2020 203e 3e3e 2078   ).        >>> x
-0001be30: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
-0001be40: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
-0001be50: 2020 4469 6d65 6e73 696f 6e73 3a20 2020    Dimensions:   
-0001be60: 2020 2028 7374 6174 696f 6e3a 2034 290a     (station: 4).
-0001be70: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
-0001be80: 7465 733a 0a20 2020 2020 2020 2020 202a  tes:.          *
-0001be90: 2073 7461 7469 6f6e 2020 2020 2020 2873   station      (s
-0001bea0: 7461 7469 6f6e 2920 3c55 3720 2762 6f73  tation) <U7 'bos
-0001beb0: 746f 6e27 2027 6e79 6327 2027 7365 6174  ton' 'nyc' 'seat
-0001bec0: 746c 6527 2027 6465 6e76 6572 270a 2020  tle' 'denver'.  
-0001bed0: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
-0001bee0: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
-0001bef0: 2020 7465 6d70 6572 6174 7572 6520 2028    temperature  (
-0001bf00: 7374 6174 696f 6e29 2066 6c6f 6174 3634  station) float64
-0001bf10: 2031 302e 3938 2031 342e 3320 3132 2e30   10.98 14.3 12.0
-0001bf20: 3620 3130 2e39 0a20 2020 2020 2020 2020  6 10.9.         
-0001bf30: 2020 2070 7265 7373 7572 6520 2020 2020     pressure     
-0001bf40: 2873 7461 7469 6f6e 2920 666c 6f61 7436  (station) float6
-0001bf50: 3420 3231 312e 3820 3332 322e 3920 3231  4 211.8 322.9 21
-0001bf60: 382e 3820 3434 352e 390a 2020 2020 2020  8.8 445.9.      
-0001bf70: 2020 3e3e 3e20 782e 696e 6465 7865 730a    >>> x.indexes.
-0001bf80: 2020 2020 2020 2020 496e 6465 7865 733a          Indexes:
-0001bf90: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
-0001bfa0: 7469 6f6e 2020 496e 6465 7828 5b27 626f  tion  Index(['bo
-0001bfb0: 7374 6f6e 272c 2027 6e79 6327 2c20 2773  ston', 'nyc', 's
-0001bfc0: 6561 7474 6c65 272c 2027 6465 6e76 6572  eattle', 'denver
-0001bfd0: 275d 2c20 6474 7970 653d 276f 626a 6563  '], dtype='objec
-0001bfe0: 7427 2c20 6e61 6d65 3d27 7374 6174 696f  t', name='statio
-0001bff0: 6e27 290a 0a20 2020 2020 2020 2043 7265  n')..        Cre
-0001c000: 6174 6520 6120 6e65 7720 696e 6465 7820  ate a new index 
-0001c010: 616e 6420 7265 696e 6465 7820 7468 6520  and reindex the 
-0001c020: 6461 7461 7365 742e 2042 7920 6465 6661  dataset. By defa
-0001c030: 756c 7420 7661 6c75 6573 2069 6e20 7468  ult values in th
-0001c040: 6520 6e65 7720 696e 6465 7820 7468 6174  e new index that
-0001c050: 0a20 2020 2020 2020 2064 6f20 6e6f 7420  .        do not 
-0001c060: 6861 7665 2063 6f72 7265 7370 6f6e 6469  have correspondi
-0001c070: 6e67 2072 6563 6f72 6473 2069 6e20 7468  ng records in th
-0001c080: 6520 6461 7461 7365 7420 6172 6520 6173  e dataset are as
-0001c090: 7369 676e 6564 2060 4e61 4e60 2e0a 0a20  signed `NaN`... 
-0001c0a0: 2020 2020 2020 203e 3e3e 206e 6577 5f69         >>> new_i
-0001c0b0: 6e64 6578 203d 205b 2262 6f73 746f 6e22  ndex = ["boston"
-0001c0c0: 2c20 2261 7573 7469 6e22 2c20 2273 6561  , "austin", "sea
-0001c0d0: 7474 6c65 222c 2022 6c69 6e63 6f6c 6e22  ttle", "lincoln"
-0001c0e0: 5d0a 2020 2020 2020 2020 3e3e 3e20 782e  ].        >>> x.
-0001c0f0: 7265 696e 6465 7828 7b22 7374 6174 696f  reindex({"statio
-0001c100: 6e22 3a20 6e65 775f 696e 6465 787d 290a  n": new_index}).
-0001c110: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
-0001c120: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
-0001c130: 2044 696d 656e 7369 6f6e 733a 2020 2020   Dimensions:    
-0001c140: 2020 2873 7461 7469 6f6e 3a20 3429 0a20    (station: 4). 
-0001c150: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
-0001c160: 6573 3a0a 2020 2020 2020 2020 2020 2a20  es:.          * 
-0001c170: 7374 6174 696f 6e20 2020 2020 2028 7374  station      (st
-0001c180: 6174 696f 6e29 203c 5537 2027 626f 7374  ation) <U7 'bost
-0001c190: 6f6e 2720 2761 7573 7469 6e27 2027 7365  on' 'austin' 'se
-0001c1a0: 6174 746c 6527 2027 6c69 6e63 6f6c 6e27  attle' 'lincoln'
-0001c1b0: 0a20 2020 2020 2020 2044 6174 6120 7661  .        Data va
-0001c1c0: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
-0001c1d0: 2020 2020 2074 656d 7065 7261 7475 7265       temperature
-0001c1e0: 2020 2873 7461 7469 6f6e 2920 666c 6f61    (station) floa
-0001c1f0: 7436 3420 3130 2e39 3820 6e61 6e20 3132  t64 10.98 nan 12
-0001c200: 2e30 3620 6e61 6e0a 2020 2020 2020 2020  .06 nan.        
-0001c210: 2020 2020 7072 6573 7375 7265 2020 2020      pressure    
-0001c220: 2028 7374 6174 696f 6e29 2066 6c6f 6174   (station) float
-0001c230: 3634 2032 3131 2e38 206e 616e 2032 3138  64 211.8 nan 218
-0001c240: 2e38 206e 616e 0a0a 2020 2020 2020 2020  .8 nan..        
-0001c250: 5765 2063 616e 2066 696c 6c20 696e 2074  We can fill in t
-0001c260: 6865 206d 6973 7369 6e67 2076 616c 7565  he missing value
-0001c270: 7320 6279 2070 6173 7369 6e67 2061 2076  s by passing a v
-0001c280: 616c 7565 2074 6f20 7468 6520 6b65 7977  alue to the keyw
-0001c290: 6f72 6420 6066 696c 6c5f 7661 6c75 6560  ord `fill_value`
-0001c2a0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2078  ...        >>> x
-0001c2b0: 2e72 6569 6e64 6578 287b 2273 7461 7469  .reindex({"stati
-0001c2c0: 6f6e 223a 206e 6577 5f69 6e64 6578 7d2c  on": new_index},
-0001c2d0: 2066 696c 6c5f 7661 6c75 653d 3029 0a20   fill_value=0). 
-0001c2e0: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
-0001c2f0: 6174 6173 6574 3e0a 2020 2020 2020 2020  ataset>.        
-0001c300: 4469 6d65 6e73 696f 6e73 3a20 2020 2020  Dimensions:     
-0001c310: 2028 7374 6174 696f 6e3a 2034 290a 2020   (station: 4).  
-0001c320: 2020 2020 2020 436f 6f72 6469 6e61 7465        Coordinate
-0001c330: 733a 0a20 2020 2020 2020 2020 202a 2073  s:.          * s
-0001c340: 7461 7469 6f6e 2020 2020 2020 2873 7461  tation      (sta
-0001c350: 7469 6f6e 2920 3c55 3720 2762 6f73 746f  tion) <U7 'bosto
-0001c360: 6e27 2027 6175 7374 696e 2720 2773 6561  n' 'austin' 'sea
-0001c370: 7474 6c65 2720 276c 696e 636f 6c6e 270a  ttle' 'lincoln'.
-0001c380: 2020 2020 2020 2020 4461 7461 2076 6172          Data var
-0001c390: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
-0001c3a0: 2020 2020 7465 6d70 6572 6174 7572 6520      temperature 
-0001c3b0: 2028 7374 6174 696f 6e29 2066 6c6f 6174   (station) float
-0001c3c0: 3634 2031 302e 3938 2030 2e30 2031 322e  64 10.98 0.0 12.
-0001c3d0: 3036 2030 2e30 0a20 2020 2020 2020 2020  06 0.0.         
-0001c3e0: 2020 2070 7265 7373 7572 6520 2020 2020     pressure     
-0001c3f0: 2873 7461 7469 6f6e 2920 666c 6f61 7436  (station) float6
-0001c400: 3420 3231 312e 3820 302e 3020 3231 382e  4 211.8 0.0 218.
-0001c410: 3820 302e 300a 0a20 2020 2020 2020 2057  8 0.0..        W
-0001c420: 6520 6361 6e20 616c 736f 2075 7365 2064  e can also use d
-0001c430: 6966 6665 7265 6e74 2066 696c 6c20 7661  ifferent fill va
-0001c440: 6c75 6573 2066 6f72 2065 6163 6820 7661  lues for each va
-0001c450: 7269 6162 6c65 2e0a 0a20 2020 2020 2020  riable...       
-0001c460: 203e 3e3e 2078 2e72 6569 6e64 6578 280a   >>> x.reindex(.
-0001c470: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001c480: 7b22 7374 6174 696f 6e22 3a20 6e65 775f  {"station": new_
-0001c490: 696e 6465 787d 2c20 6669 6c6c 5f76 616c  index}, fill_val
-0001c4a0: 7565 3d7b 2274 656d 7065 7261 7475 7265  ue={"temperature
-0001c4b0: 223a 2030 2c20 2270 7265 7373 7572 6522  ": 0, "pressure"
-0001c4c0: 3a20 3130 307d 0a20 2020 2020 2020 202e  : 100}.        .
-0001c4d0: 2e2e 2029 0a20 2020 2020 2020 203c 7861  .. ).        <xa
-0001c4e0: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
-0001c4f0: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
-0001c500: 3a20 2020 2020 2028 7374 6174 696f 6e3a  :      (station:
-0001c510: 2034 290a 2020 2020 2020 2020 436f 6f72   4).        Coor
-0001c520: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
-0001c530: 2020 202a 2073 7461 7469 6f6e 2020 2020     * station    
-0001c540: 2020 2873 7461 7469 6f6e 2920 3c55 3720    (station) <U7 
-0001c550: 2762 6f73 746f 6e27 2027 6175 7374 696e  'boston' 'austin
-0001c560: 2720 2773 6561 7474 6c65 2720 276c 696e  ' 'seattle' 'lin
-0001c570: 636f 6c6e 270a 2020 2020 2020 2020 4461  coln'.        Da
-0001c580: 7461 2076 6172 6961 626c 6573 3a0a 2020  ta variables:.  
-0001c590: 2020 2020 2020 2020 2020 7465 6d70 6572            temper
-0001c5a0: 6174 7572 6520 2028 7374 6174 696f 6e29  ature  (station)
-0001c5b0: 2066 6c6f 6174 3634 2031 302e 3938 2030   float64 10.98 0
-0001c5c0: 2e30 2031 322e 3036 2030 2e30 0a20 2020  .0 12.06 0.0.   
-0001c5d0: 2020 2020 2020 2020 2070 7265 7373 7572           pressur
-0001c5e0: 6520 2020 2020 2873 7461 7469 6f6e 2920  e     (station) 
-0001c5f0: 666c 6f61 7436 3420 3231 312e 3820 3130  float64 211.8 10
-0001c600: 302e 3020 3231 382e 3820 3130 302e 300a  0.0 218.8 100.0.
-0001c610: 0a20 2020 2020 2020 2042 6563 6175 7365  .        Because
-0001c620: 2074 6865 2069 6e64 6578 2069 7320 6e6f   the index is no
-0001c630: 7420 6d6f 6e6f 746f 6e69 6361 6c6c 7920  t monotonically 
-0001c640: 696e 6372 6561 7369 6e67 206f 7220 6465  increasing or de
-0001c650: 6372 6561 7369 6e67 2c20 7765 2063 616e  creasing, we can
-0001c660: 6e6f 7420 7573 6520 6172 6775 6d65 6e74  not use argument
-0001c670: 730a 2020 2020 2020 2020 746f 2074 6865  s.        to the
-0001c680: 206b 6579 776f 7264 206d 6574 686f 6420   keyword method 
-0001c690: 746f 2066 696c 6c20 7468 6520 604e 614e  to fill the `NaN
-0001c6a0: 6020 7661 6c75 6573 2e0a 0a20 2020 2020  ` values...     
-0001c6b0: 2020 203e 3e3e 2078 2e72 6569 6e64 6578     >>> x.reindex
-0001c6c0: 287b 2273 7461 7469 6f6e 223a 206e 6577  ({"station": new
-0001c6d0: 5f69 6e64 6578 7d2c 206d 6574 686f 643d  _index}, method=
-0001c6e0: 226e 6561 7265 7374 2229 0a20 2020 2020  "nearest").     
-0001c6f0: 2020 2054 7261 6365 6261 636b 2028 6d6f     Traceback (mo
-0001c700: 7374 2072 6563 656e 7420 6361 6c6c 206c  st recent call l
-0001c710: 6173 7429 3a0a 2020 2020 2020 2020 2e2e  ast):.        ..
-0001c720: 2e0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-0001c730: 6973 6520 5661 6c75 6545 7272 6f72 2827  ise ValueError('
-0001c740: 696e 6465 7820 6d75 7374 2062 6520 6d6f  index must be mo
-0001c750: 6e6f 746f 6e69 6320 696e 6372 6561 7369  notonic increasi
-0001c760: 6e67 206f 7220 6465 6372 6561 7369 6e67  ng or decreasing
-0001c770: 2729 0a20 2020 2020 2020 2056 616c 7565  ').        Value
-0001c780: 4572 726f 723a 2069 6e64 6578 206d 7573  Error: index mus
-0001c790: 7420 6265 206d 6f6e 6f74 6f6e 6963 2069  t be monotonic i
-0001c7a0: 6e63 7265 6173 696e 6720 6f72 2064 6563  ncreasing or dec
-0001c7b0: 7265 6173 696e 670a 0a20 2020 2020 2020  reasing..       
-0001c7c0: 2054 6f20 6675 7274 6865 7220 696c 6c75   To further illu
-0001c7d0: 7374 7261 7465 2074 6865 2066 696c 6c69  strate the filli
-0001c7e0: 6e67 2066 756e 6374 696f 6e61 6c69 7479  ng functionality
-0001c7f0: 2069 6e20 7265 696e 6465 782c 2077 6520   in reindex, we 
-0001c800: 7769 6c6c 2063 7265 6174 6520 610a 2020  will create a.  
-0001c810: 2020 2020 2020 6461 7461 7365 7420 7769        dataset wi
-0001c820: 7468 2061 206d 6f6e 6f74 6f6e 6963 616c  th a monotonical
-0001c830: 6c79 2069 6e63 7265 6173 696e 6720 696e  ly increasing in
-0001c840: 6465 7820 2866 6f72 2065 7861 6d70 6c65  dex (for example
-0001c850: 2c20 6120 7365 7175 656e 6365 206f 6620  , a sequence of 
-0001c860: 6461 7465 7329 2e0a 0a20 2020 2020 2020  dates)...       
-0001c870: 203e 3e3e 2078 3220 3d20 7872 2e44 6174   >>> x2 = xr.Dat
-0001c880: 6173 6574 280a 2020 2020 2020 2020 2e2e  aset(.        ..
-0001c890: 2e20 2020 2020 7b0a 2020 2020 2020 2020  .     {.        
-0001c8a0: 2e2e 2e20 2020 2020 2020 2020 2274 656d  ...         "tem
-0001c8b0: 7065 7261 7475 7265 223a 2028 0a20 2020  perature": (.   
-0001c8c0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0001c8d0: 2020 2020 2022 7469 6d65 222c 0a20 2020       "time",.   
-0001c8e0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0001c8f0: 2020 2020 205b 3135 2e35 372c 2031 322e       [15.57, 12.
-0001c900: 3737 2c20 6e70 2e6e 616e 2c20 302e 3330  77, np.nan, 0.30
-0001c910: 3831 2c20 3136 2e35 392c 2031 352e 3132  81, 16.59, 15.12
-0001c920: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-0001c930: 2020 2020 2020 2029 2c0a 2020 2020 2020         ),.      
-0001c940: 2020 2e2e 2e20 2020 2020 2020 2020 2270    ...         "p
-0001c950: 7265 7373 7572 6522 3a20 2822 7469 6d65  ressure": ("time
-0001c960: 222c 2035 3030 202a 206e 702e 7261 6e64  ", 500 * np.rand
-0001c970: 6f6d 2e72 616e 6428 3629 292c 0a20 2020  om.rand(6)),.   
-0001c980: 2020 2020 202e 2e2e 2020 2020 207d 2c0a       ...     },.
+0000d490: 2320 6368 6563 6b20 636f 6e73 6973 7465  # check consiste
+0000d4a0: 6e63 7920 6f66 2064 696d 656e 7369 6f6e  ncy of dimension
+0000d4b0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+0000d4c0: 2020 666f 7220 6469 6d20 696e 2076 616c    for dim in val
+0000d4d0: 2e64 696d 733a 0a20 2020 2020 2020 2020  .dims:.         
+0000d4e0: 2020 2020 2020 2020 2020 2069 6620 6469             if di
+0000d4f0: 6d20 6e6f 7420 696e 2076 6172 5f6b 2e64  m not in var_k.d
+0000d500: 696d 733a 0a20 2020 2020 2020 2020 2020  ims:.           
+0000d510: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000d520: 7365 204b 6579 4572 726f 7228 0a20 2020  se KeyError(.   
+0000d530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d540: 2020 2020 2020 2020 2066 2256 6172 6961           f"Varia
+0000d550: 626c 6520 277b 6e61 6d65 7d27 3a20 6469  ble '{name}': di
+0000d560: 6d65 6e73 696f 6e20 277b 6469 6d7d 2720  mension '{dim}' 
+0000d570: 6170 7065 6172 7320 696e 206e 6577 2076  appears in new v
+0000d580: 616c 7565 7320 220a 2020 2020 2020 2020  alues ".        
+0000d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5a0: 2020 2020 6622 6275 7420 6e6f 7420 696e      f"but not in
+0000d5b0: 2074 6865 2069 6e64 6578 6564 206f 7269   the indexed ori
+0000d5c0: 6769 6e61 6c20 6461 7461 220a 2020 2020  ginal data".    
+0000d5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5e0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+0000d5f0: 2020 2020 2020 6469 6d73 203d 2074 7570        dims = tup
+0000d600: 6c65 2864 696d 2066 6f72 2064 696d 2069  le(dim for dim i
+0000d610: 6e20 7661 725f 6b2e 6469 6d73 2069 6620  n var_k.dims if 
+0000d620: 6469 6d20 696e 2076 616c 2e64 696d 7329  dim in val.dims)
+0000d630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d640: 2069 6620 6469 6d73 2021 3d20 7661 6c2e   if dims != val.
+0000d650: 6469 6d73 3a0a 2020 2020 2020 2020 2020  dims:.          
+0000d660: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+0000d670: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+0000d680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d690: 2020 2020 6622 5661 7269 6162 6c65 2027      f"Variable '
+0000d6a0: 7b6e 616d 657d 273a 2064 696d 656e 7369  {name}': dimensi
+0000d6b0: 6f6e 206f 7264 6572 2064 6966 6665 7273  on order differs
+0000d6c0: 2062 6574 7765 656e 220a 2020 2020 2020   between".      
+0000d6d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d6e0: 2020 6622 206f 7269 6769 6e61 6c20 616e    f" original an
+0000d6f0: 6420 6e65 7720 6461 7461 3a5c 6e7b 6469  d new data:\n{di
+0000d700: 6d73 7d5c 6e76 732e 5c6e 7b76 616c 2e64  ms}\nvs.\n{val.d
+0000d710: 696d 737d 220a 2020 2020 2020 2020 2020  ims}".          
+0000d720: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000d730: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0000d740: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0000d750: 6c20 3d20 6e70 2e61 7272 6179 2876 616c  l = np.array(val
+0000d760: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+0000d770: 2074 7970 6520 636f 6e76 6572 7369 6f6e   type conversion
+0000d780: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+0000d790: 5f76 616c 7565 5b6e 616d 655d 203d 2064  _value[name] = d
+0000d7a0: 7563 6b5f 6172 7261 795f 6f70 732e 6173  uck_array_ops.as
+0000d7b0: 7479 7065 2876 616c 2c20 6474 7970 653d  type(val, dtype=
+0000d7c0: 7661 725f 6b2e 6474 7970 652c 2063 6f70  var_k.dtype, cop
+0000d7d0: 793d 4661 6c73 6529 0a0a 2020 2020 2020  y=False)..      
+0000d7e0: 2020 2320 6368 6563 6b20 636f 6e73 6973    # check consis
+0000d7f0: 7465 6e63 7920 6f66 2064 696d 656e 7369  tency of dimensi
+0000d800: 6f6e 2073 697a 6573 2061 6e64 2064 696d  on sizes and dim
+0000d810: 656e 7369 6f6e 2063 6f6f 7264 696e 6174  ension coordinat
+0000d820: 6573 0a20 2020 2020 2020 2069 6620 6973  es.        if is
+0000d830: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
+0000d840: 4461 7461 4172 7261 7929 206f 7220 6973  DataArray) or is
+0000d850: 696e 7374 616e 6365 2876 616c 7565 2c20  instance(value, 
+0000d860: 4461 7461 7365 7429 3a0a 2020 2020 2020  Dataset):.      
+0000d870: 2020 2020 2020 616c 6967 6e28 7365 6c66        align(self
+0000d880: 5b6b 6579 5d2c 2076 616c 7565 2c20 6a6f  [key], value, jo
+0000d890: 696e 3d22 6578 6163 7422 2c20 636f 7079  in="exact", copy
+0000d8a0: 3d46 616c 7365 290a 0a20 2020 2020 2020  =False)..       
+0000d8b0: 2072 6574 7572 6e20 6e65 775f 7661 6c75   return new_valu
+0000d8c0: 650a 0a20 2020 2064 6566 205f 5f64 656c  e..    def __del
+0000d8d0: 6974 656d 5f5f 2873 656c 662c 206b 6579  item__(self, key
+0000d8e0: 3a20 4861 7368 6162 6c65 2920 2d3e 204e  : Hashable) -> N
+0000d8f0: 6f6e 653a 0a20 2020 2020 2020 2022 2222  one:.        """
+0000d900: 5265 6d6f 7665 2061 2076 6172 6961 626c  Remove a variabl
+0000d910: 6520 6672 6f6d 2074 6869 7320 6461 7461  e from this data
+0000d920: 7365 742e 2222 220a 2020 2020 2020 2020  set.""".        
+0000d930: 6173 7365 7274 5f6e 6f5f 696e 6465 785f  assert_no_index_
+0000d940: 636f 7272 7570 7465 6428 7365 6c66 2e78  corrupted(self.x
+0000d950: 696e 6465 7865 732c 207b 6b65 797d 290a  indexes, {key}).
+0000d960: 0a20 2020 2020 2020 2069 6620 6b65 7920  .        if key 
+0000d970: 696e 2073 656c 662e 5f69 6e64 6578 6573  in self._indexes
+0000d980: 3a0a 2020 2020 2020 2020 2020 2020 6465  :.            de
+0000d990: 6c20 7365 6c66 2e5f 696e 6465 7865 735b  l self._indexes[
+0000d9a0: 6b65 795d 0a20 2020 2020 2020 2064 656c  key].        del
+0000d9b0: 2073 656c 662e 5f76 6172 6961 626c 6573   self._variables
+0000d9c0: 5b6b 6579 5d0a 2020 2020 2020 2020 7365  [key].        se
+0000d9d0: 6c66 2e5f 636f 6f72 645f 6e61 6d65 732e  lf._coord_names.
+0000d9e0: 6469 7363 6172 6428 6b65 7929 0a20 2020  discard(key).   
+0000d9f0: 2020 2020 2073 656c 662e 5f64 696d 7320       self._dims 
+0000da00: 3d20 6361 6c63 756c 6174 655f 6469 6d65  = calculate_dime
+0000da10: 6e73 696f 6e73 2873 656c 662e 5f76 6172  nsions(self._var
+0000da20: 6961 626c 6573 290a 0a20 2020 2023 206d  iables)..    # m
+0000da30: 7574 6162 6c65 206f 626a 6563 7473 2073  utable objects s
+0000da40: 686f 756c 6420 6e6f 7420 6265 2068 6173  hould not be has
+0000da50: 6861 626c 650a 2020 2020 2320 6874 7470  hable.    # http
+0000da60: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f70  s://github.com/p
+0000da70: 7974 686f 6e2f 6d79 7079 2f69 7373 7565  ython/mypy/issue
+0000da80: 732f 3432 3636 0a20 2020 205f 5f68 6173  s/4266.    __has
+0000da90: 685f 5f20 3d20 4e6f 6e65 2020 2320 7479  h__ = None  # ty
+0000daa0: 7065 3a20 6967 6e6f 7265 5b61 7373 6967  pe: ignore[assig
+0000dab0: 6e6d 656e 745d 0a0a 2020 2020 6465 6620  nment]..    def 
+0000dac0: 5f61 6c6c 5f63 6f6d 7061 7428 7365 6c66  _all_compat(self
+0000dad0: 2c20 6f74 6865 723a 2044 6174 6173 6574  , other: Dataset
+0000dae0: 2c20 636f 6d70 6174 5f73 7472 3a20 7374  , compat_str: st
+0000daf0: 7229 202d 3e20 626f 6f6c 3a0a 2020 2020  r) -> bool:.    
+0000db00: 2020 2020 2222 2248 656c 7065 7220 6675      """Helper fu
+0000db10: 6e63 7469 6f6e 2066 6f72 2065 7175 616c  nction for equal
+0000db20: 7320 616e 6420 6964 656e 7469 6361 6c22  s and identical"
+0000db30: 2222 0a0a 2020 2020 2020 2020 2320 736f  ""..        # so
+0000db40: 6d65 2073 746f 7265 7320 2865 2e67 2e2c  me stores (e.g.,
+0000db50: 2073 6369 7079 2920 646f 206e 6f74 2073   scipy) do not s
+0000db60: 6565 6d20 746f 2070 7265 7365 7276 6520  eem to preserve 
+0000db70: 6f72 6465 722c 2073 6f20 646f 6e27 740a  order, so don't.
+0000db80: 2020 2020 2020 2020 2320 7265 7175 6972          # requir
+0000db90: 6520 6d61 7463 6869 6e67 206f 7264 6572  e matching order
+0000dba0: 2066 6f72 2065 7175 616c 6974 790a 2020   for equality.  
+0000dbb0: 2020 2020 2020 6465 6620 636f 6d70 6174        def compat
+0000dbc0: 2878 3a20 5661 7269 6162 6c65 2c20 793a  (x: Variable, y:
+0000dbd0: 2056 6172 6961 626c 6529 202d 3e20 626f   Variable) -> bo
+0000dbe0: 6f6c 3a0a 2020 2020 2020 2020 2020 2020  ol:.            
+0000dbf0: 7265 7475 726e 2067 6574 6174 7472 2878  return getattr(x
+0000dc00: 2c20 636f 6d70 6174 5f73 7472 2928 7929  , compat_str)(y)
+0000dc10: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000dc20: 2073 656c 662e 5f63 6f6f 7264 5f6e 616d   self._coord_nam
+0000dc30: 6573 203d 3d20 6f74 6865 722e 5f63 6f6f  es == other._coo
+0000dc40: 7264 5f6e 616d 6573 2061 6e64 2075 7469  rd_names and uti
+0000dc50: 6c73 2e64 6963 745f 6571 7569 7628 0a20  ls.dict_equiv(. 
+0000dc60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+0000dc70: 5f76 6172 6961 626c 6573 2c20 6f74 6865  _variables, othe
+0000dc80: 722e 5f76 6172 6961 626c 6573 2c20 636f  r._variables, co
+0000dc90: 6d70 6174 3d63 6f6d 7061 740a 2020 2020  mpat=compat.    
+0000dca0: 2020 2020 290a 0a20 2020 2064 6566 2062      )..    def b
+0000dcb0: 726f 6164 6361 7374 5f65 7175 616c 7328  roadcast_equals(
+0000dcc0: 7365 6c66 2c20 6f74 6865 723a 2044 6174  self, other: Dat
+0000dcd0: 6173 6574 2920 2d3e 2062 6f6f 6c3a 0a20  aset) -> bool:. 
+0000dce0: 2020 2020 2020 2022 2222 5477 6f20 4461         """Two Da
+0000dcf0: 7461 7365 7473 2061 7265 2062 726f 6164  tasets are broad
+0000dd00: 6361 7374 2065 7175 616c 2069 6620 7468  cast equal if th
+0000dd10: 6579 2061 7265 2065 7175 616c 2061 6674  ey are equal aft
+0000dd20: 6572 0a20 2020 2020 2020 2062 726f 6164  er.        broad
+0000dd30: 6361 7374 696e 6720 616c 6c20 7661 7269  casting all vari
+0000dd40: 6162 6c65 7320 6167 6169 6e73 7420 6561  ables against ea
+0000dd50: 6368 206f 7468 6572 2e0a 0a20 2020 2020  ch other...     
+0000dd60: 2020 2046 6f72 2065 7861 6d70 6c65 2c20     For example, 
+0000dd70: 7661 7269 6162 6c65 7320 7468 6174 2061  variables that a
+0000dd80: 7265 2073 6361 6c61 7220 696e 206f 6e65  re scalar in one
+0000dd90: 2064 6174 6173 6574 2062 7574 206e 6f6e   dataset but non
+0000dda0: 2d73 6361 6c61 7220 696e 0a20 2020 2020  -scalar in.     
+0000ddb0: 2020 2074 6865 206f 7468 6572 2064 6174     the other dat
+0000ddc0: 6173 6574 2063 616e 2073 7469 6c6c 2062  aset can still b
+0000ddd0: 6520 6272 6f61 6463 6173 7420 6571 7561  e broadcast equa
+0000dde0: 6c20 6966 2074 6865 2074 6865 206e 6f6e  l if the the non
+0000ddf0: 2d73 6361 6c61 720a 2020 2020 2020 2020  -scalar.        
+0000de00: 7661 7269 6162 6c65 2069 7320 6120 636f  variable is a co
+0000de10: 6e73 7461 6e74 2e0a 0a20 2020 2020 2020  nstant...       
+0000de20: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+0000de30: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+0000de40: 2020 2044 6174 6173 6574 2e65 7175 616c     Dataset.equal
+0000de50: 730a 2020 2020 2020 2020 4461 7461 7365  s.        Datase
+0000de60: 742e 6964 656e 7469 6361 6c0a 2020 2020  t.identical.    
+0000de70: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0000de80: 7472 793a 0a20 2020 2020 2020 2020 2020  try:.           
+0000de90: 2072 6574 7572 6e20 7365 6c66 2e5f 616c   return self._al
+0000dea0: 6c5f 636f 6d70 6174 286f 7468 6572 2c20  l_compat(other, 
+0000deb0: 2262 726f 6164 6361 7374 5f65 7175 616c  "broadcast_equal
+0000dec0: 7322 290a 2020 2020 2020 2020 6578 6365  s").        exce
+0000ded0: 7074 2028 5479 7065 4572 726f 722c 2041  pt (TypeError, A
+0000dee0: 7474 7269 6275 7465 4572 726f 7229 3a0a  ttributeError):.
+0000def0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0000df00: 726e 2046 616c 7365 0a0a 2020 2020 6465  rn False..    de
+0000df10: 6620 6571 7561 6c73 2873 656c 662c 206f  f equals(self, o
+0000df20: 7468 6572 3a20 4461 7461 7365 7429 202d  ther: Dataset) -
+0000df30: 3e20 626f 6f6c 3a0a 2020 2020 2020 2020  > bool:.        
+0000df40: 2222 2254 776f 2044 6174 6173 6574 7320  """Two Datasets 
+0000df50: 6172 6520 6571 7561 6c20 6966 2074 6865  are equal if the
+0000df60: 7920 6861 7665 206d 6174 6368 696e 6720  y have matching 
+0000df70: 7661 7269 6162 6c65 7320 616e 640a 2020  variables and.  
+0000df80: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+0000df90: 732c 2061 6c6c 206f 6620 7768 6963 6820  s, all of which 
+0000dfa0: 6172 6520 6571 7561 6c2e 0a0a 2020 2020  are equal...    
+0000dfb0: 2020 2020 4461 7461 7365 7473 2063 616e      Datasets can
+0000dfc0: 2073 7469 6c6c 2062 6520 6571 7561 6c20   still be equal 
+0000dfd0: 286c 696b 6520 7061 6e64 6173 206f 626a  (like pandas obj
+0000dfe0: 6563 7473 2920 6966 2074 6865 7920 6861  ects) if they ha
+0000dff0: 7665 204e 614e 0a20 2020 2020 2020 2076  ve NaN.        v
+0000e000: 616c 7565 7320 696e 2074 6865 2073 616d  alues in the sam
+0000e010: 6520 6c6f 6361 7469 6f6e 732e 0a0a 2020  e locations...  
+0000e020: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+0000e030: 6420 6973 206e 6563 6573 7361 7279 2062  d is necessary b
+0000e040: 6563 6175 7365 2060 7631 203d 3d20 7632  ecause `v1 == v2
+0000e050: 6020 666f 7220 6060 4461 7461 7365 7460  ` for ``Dataset`
+0000e060: 600a 2020 2020 2020 2020 646f 6573 2065  `.        does e
+0000e070: 6c65 6d65 6e74 2d77 6973 6520 636f 6d70  lement-wise comp
+0000e080: 6172 6973 6f6e 7320 286c 696b 6520 6e75  arisons (like nu
+0000e090: 6d70 792e 6e64 6172 7261 7973 292e 0a0a  mpy.ndarrays)...
+0000e0a0: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+0000e0b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0000e0c0: 2d0a 2020 2020 2020 2020 4461 7461 7365  -.        Datase
+0000e0d0: 742e 6272 6f61 6463 6173 745f 6571 7561  t.broadcast_equa
+0000e0e0: 6c73 0a20 2020 2020 2020 2044 6174 6173  ls.        Datas
+0000e0f0: 6574 2e69 6465 6e74 6963 616c 0a20 2020  et.identical.   
+0000e100: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000e110: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+0000e120: 2020 7265 7475 726e 2073 656c 662e 5f61    return self._a
+0000e130: 6c6c 5f63 6f6d 7061 7428 6f74 6865 722c  ll_compat(other,
+0000e140: 2022 6571 7561 6c73 2229 0a20 2020 2020   "equals").     
+0000e150: 2020 2065 7863 6570 7420 2854 7970 6545     except (TypeE
+0000e160: 7272 6f72 2c20 4174 7472 6962 7574 6545  rror, AttributeE
+0000e170: 7272 6f72 293a 0a20 2020 2020 2020 2020  rror):.         
+0000e180: 2020 2072 6574 7572 6e20 4661 6c73 650a     return False.
+0000e190: 0a20 2020 2064 6566 2069 6465 6e74 6963  .    def identic
+0000e1a0: 616c 2873 656c 662c 206f 7468 6572 3a20  al(self, other: 
+0000e1b0: 4461 7461 7365 7429 202d 3e20 626f 6f6c  Dataset) -> bool
+0000e1c0: 3a0a 2020 2020 2020 2020 2222 224c 696b  :.        """Lik
+0000e1d0: 6520 6571 7561 6c73 2c20 6275 7420 616c  e equals, but al
+0000e1e0: 736f 2063 6865 636b 7320 616c 6c20 6461  so checks all da
+0000e1f0: 7461 7365 7420 6174 7472 6962 7574 6573  taset attributes
+0000e200: 2061 6e64 2074 6865 0a20 2020 2020 2020   and the.       
+0000e210: 2061 7474 7269 6275 7465 7320 6f6e 2061   attributes on a
+0000e220: 6c6c 2076 6172 6961 626c 6573 2061 6e64  ll variables and
+0000e230: 2063 6f6f 7264 696e 6174 6573 2e0a 0a20   coordinates... 
+0000e240: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+0000e250: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000e260: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
+0000e270: 2e62 726f 6164 6361 7374 5f65 7175 616c  .broadcast_equal
+0000e280: 730a 2020 2020 2020 2020 4461 7461 7365  s.        Datase
+0000e290: 742e 6571 7561 6c73 0a20 2020 2020 2020  t.equals.       
+0000e2a0: 2022 2222 0a20 2020 2020 2020 2074 7279   """.        try
+0000e2b0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000e2c0: 7475 726e 2075 7469 6c73 2e64 6963 745f  turn utils.dict_
+0000e2d0: 6571 7569 7628 7365 6c66 2e61 7474 7273  equiv(self.attrs
+0000e2e0: 2c20 6f74 6865 722e 6174 7472 7329 2061  , other.attrs) a
+0000e2f0: 6e64 2073 656c 662e 5f61 6c6c 5f63 6f6d  nd self._all_com
+0000e300: 7061 7428 0a20 2020 2020 2020 2020 2020  pat(.           
+0000e310: 2020 2020 206f 7468 6572 2c20 2269 6465       other, "ide
+0000e320: 6e74 6963 616c 220a 2020 2020 2020 2020  ntical".        
+0000e330: 2020 2020 290a 2020 2020 2020 2020 6578      ).        ex
+0000e340: 6365 7074 2028 5479 7065 4572 726f 722c  cept (TypeError,
+0000e350: 2041 7474 7269 6275 7465 4572 726f 7229   AttributeError)
+0000e360: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
+0000e370: 7475 726e 2046 616c 7365 0a0a 2020 2020  turn False..    
+0000e380: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000e390: 6620 696e 6465 7865 7328 7365 6c66 2920  f indexes(self) 
+0000e3a0: 2d3e 2049 6e64 6578 6573 5b70 642e 496e  -> Indexes[pd.In
+0000e3b0: 6465 785d 3a0a 2020 2020 2020 2020 2222  dex]:.        ""
+0000e3c0: 224d 6170 7069 6e67 206f 6620 7061 6e64  "Mapping of pand
+0000e3d0: 6173 2e49 6e64 6578 206f 626a 6563 7473  as.Index objects
+0000e3e0: 2075 7365 6420 666f 7220 6c61 6265 6c20   used for label 
+0000e3f0: 6261 7365 6420 696e 6465 7869 6e67 2e0a  based indexing..
+0000e400: 0a20 2020 2020 2020 2052 6169 7365 7320  .        Raises 
+0000e410: 616e 2065 7272 6f72 2069 6620 7468 6973  an error if this
+0000e420: 2044 6174 6173 6574 2068 6173 2069 6e64   Dataset has ind
+0000e430: 6578 6573 2074 6861 7420 6361 6e6e 6f74  exes that cannot
+0000e440: 2062 6520 636f 6572 6365 640a 2020 2020   be coerced.    
+0000e450: 2020 2020 746f 2070 616e 6461 732e 496e      to pandas.In
+0000e460: 6465 7820 6f62 6a65 6374 732e 0a0a 2020  dex objects...  
+0000e470: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
+0000e480: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+0000e490: 2020 2020 2020 2020 4461 7461 7365 742e          Dataset.
+0000e4a0: 7869 6e64 6578 6573 0a0a 2020 2020 2020  xindexes..      
+0000e4b0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+0000e4c0: 7475 726e 2073 656c 662e 7869 6e64 6578  turn self.xindex
+0000e4d0: 6573 2e74 6f5f 7061 6e64 6173 5f69 6e64  es.to_pandas_ind
+0000e4e0: 6578 6573 2829 0a0a 2020 2020 4070 726f  exes()..    @pro
+0000e4f0: 7065 7274 790a 2020 2020 6465 6620 7869  perty.    def xi
+0000e500: 6e64 6578 6573 2873 656c 6629 202d 3e20  ndexes(self) -> 
+0000e510: 496e 6465 7865 735b 496e 6465 785d 3a0a  Indexes[Index]:.
+0000e520: 2020 2020 2020 2020 2222 224d 6170 7069          """Mappi
+0000e530: 6e67 206f 6620 7861 7272 6179 2049 6e64  ng of xarray Ind
+0000e540: 6578 206f 626a 6563 7473 2075 7365 6420  ex objects used 
+0000e550: 666f 7220 6c61 6265 6c20 6261 7365 6420  for label based 
+0000e560: 696e 6465 7869 6e67 2e22 2222 0a20 2020  indexing.""".   
+0000e570: 2020 2020 2072 6574 7572 6e20 496e 6465       return Inde
+0000e580: 7865 7328 7365 6c66 2e5f 696e 6465 7865  xes(self._indexe
+0000e590: 732c 207b 6b3a 2073 656c 662e 5f76 6172  s, {k: self._var
+0000e5a0: 6961 626c 6573 5b6b 5d20 666f 7220 6b20  iables[k] for k 
+0000e5b0: 696e 2073 656c 662e 5f69 6e64 6578 6573  in self._indexes
+0000e5c0: 7d29 0a0a 2020 2020 4070 726f 7065 7274  })..    @propert
+0000e5d0: 790a 2020 2020 6465 6620 636f 6f72 6473  y.    def coords
+0000e5e0: 2873 656c 6629 202d 3e20 4461 7461 7365  (self) -> Datase
+0000e5f0: 7443 6f6f 7264 696e 6174 6573 3a0a 2020  tCoordinates:.  
+0000e600: 2020 2020 2020 2222 2244 6963 7469 6f6e        """Diction
+0000e610: 6172 7920 6f66 2078 6172 7261 792e 4461  ary of xarray.Da
+0000e620: 7461 4172 7261 7920 6f62 6a65 6374 7320  taArray objects 
+0000e630: 636f 7272 6573 706f 6e64 696e 6720 746f  corresponding to
+0000e640: 2063 6f6f 7264 696e 6174 650a 2020 2020   coordinate.    
+0000e650: 2020 2020 7661 7269 6162 6c65 730a 2020      variables.  
+0000e660: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000e670: 2020 7265 7475 726e 2044 6174 6173 6574    return Dataset
+0000e680: 436f 6f72 6469 6e61 7465 7328 7365 6c66  Coordinates(self
+0000e690: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
+0000e6a0: 0a20 2020 2064 6566 2064 6174 615f 7661  .    def data_va
+0000e6b0: 7273 2873 656c 6629 202d 3e20 4461 7461  rs(self) -> Data
+0000e6c0: 5661 7269 6162 6c65 733a 0a20 2020 2020  Variables:.     
+0000e6d0: 2020 2022 2222 4469 6374 696f 6e61 7279     """Dictionary
+0000e6e0: 206f 6620 4461 7461 4172 7261 7920 6f62   of DataArray ob
+0000e6f0: 6a65 6374 7320 636f 7272 6573 706f 6e64  jects correspond
+0000e700: 696e 6720 746f 2064 6174 6120 7661 7269  ing to data vari
+0000e710: 6162 6c65 7322 2222 0a20 2020 2020 2020  ables""".       
+0000e720: 2072 6574 7572 6e20 4461 7461 5661 7269   return DataVari
+0000e730: 6162 6c65 7328 7365 6c66 290a 0a20 2020  ables(self)..   
+0000e740: 2064 6566 2073 6574 5f63 6f6f 7264 7328   def set_coords(
+0000e750: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+0000e760: 206e 616d 6573 3a20 4861 7368 6162 6c65   names: Hashable
+0000e770: 207c 2049 7465 7261 626c 655b 4861 7368   | Iterable[Hash
+0000e780: 6162 6c65 5d29 202d 3e20 545f 4461 7461  able]) -> T_Data
+0000e790: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+0000e7a0: 4769 7665 6e20 6e61 6d65 7320 6f66 206f  Given names of o
+0000e7b0: 6e65 206f 7220 6d6f 7265 2076 6172 6961  ne or more varia
+0000e7c0: 626c 6573 2c20 7365 7420 7468 656d 2061  bles, set them a
+0000e7d0: 7320 636f 6f72 6469 6e61 7465 730a 0a20  s coordinates.. 
+0000e7e0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0000e7f0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0000e800: 2d2d 2d2d 0a20 2020 2020 2020 206e 616d  ----.        nam
+0000e810: 6573 203a 2068 6173 6861 626c 6520 6f72  es : hashable or
+0000e820: 2069 7465 7261 626c 6520 6f66 2068 6173   iterable of has
+0000e830: 6861 626c 650a 2020 2020 2020 2020 2020  hable.          
+0000e840: 2020 4e61 6d65 2873 2920 6f66 2076 6172    Name(s) of var
+0000e850: 6961 626c 6573 2069 6e20 7468 6973 2064  iables in this d
+0000e860: 6174 6173 6574 2074 6f20 636f 6e76 6572  ataset to conver
+0000e870: 7420 696e 746f 2063 6f6f 7264 696e 6174  t into coordinat
+0000e880: 6573 2e0a 0a20 2020 2020 2020 2052 6574  es...        Ret
+0000e890: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+0000e8a0: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
+0000e8b0: 6173 6574 0a0a 2020 2020 2020 2020 5365  aset..        Se
+0000e8c0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+0000e8d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0000e8e0: 4461 7461 7365 742e 7377 6170 5f64 696d  Dataset.swap_dim
+0000e8f0: 730a 2020 2020 2020 2020 4461 7461 7365  s.        Datase
+0000e900: 742e 6173 7369 676e 5f63 6f6f 7264 730a  t.assign_coords.
+0000e910: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0000e920: 2020 2020 2320 544f 444f 3a20 616c 6c6f      # TODO: allo
+0000e930: 7720 696e 7365 7274 696e 6720 6e65 7720  w inserting new 
+0000e940: 636f 6f72 6469 6e61 7465 7320 7769 7468  coordinates with
+0000e950: 2074 6869 7320 6d65 7468 6f64 2c20 6c69   this method, li
+0000e960: 6b65 0a20 2020 2020 2020 2023 2044 6174  ke.        # Dat
+0000e970: 6146 7261 6d65 2e73 6574 5f69 6e64 6578  aFrame.set_index
+0000e980: 3f0a 2020 2020 2020 2020 2320 6e62 2e20  ?.        # nb. 
+0000e990: 6368 6563 6b20 696e 2073 656c 662e 5f76  check in self._v
+0000e9a0: 6172 6961 626c 6573 2c20 6e6f 7420 7365  ariables, not se
+0000e9b0: 6c66 2e64 6174 615f 7661 7273 2074 6f20  lf.data_vars to 
+0000e9c0: 696e 7375 7265 2074 6861 7420 7468 650a  insure that the.
+0000e9d0: 2020 2020 2020 2020 2320 6f70 6572 6174          # operat
+0000e9e0: 696f 6e20 6973 2069 6465 6d70 6f74 656e  ion is idempoten
+0000e9f0: 740a 2020 2020 2020 2020 6966 2069 7369  t.        if isi
+0000ea00: 6e73 7461 6e63 6528 6e61 6d65 732c 2073  nstance(names, s
+0000ea10: 7472 2920 6f72 206e 6f74 2069 7369 6e73  tr) or not isins
+0000ea20: 7461 6e63 6528 6e61 6d65 732c 2049 7465  tance(names, Ite
+0000ea30: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
+0000ea40: 2020 2020 6e61 6d65 7320 3d20 5b6e 616d      names = [nam
+0000ea50: 6573 5d0a 2020 2020 2020 2020 656c 7365  es].        else
+0000ea60: 3a0a 2020 2020 2020 2020 2020 2020 6e61  :.            na
+0000ea70: 6d65 7320 3d20 6c69 7374 286e 616d 6573  mes = list(names
+0000ea80: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
+0000ea90: 6173 7365 7274 5f61 6c6c 5f69 6e5f 6461  assert_all_in_da
+0000eaa0: 7461 7365 7428 6e61 6d65 7329 0a20 2020  taset(names).   
+0000eab0: 2020 2020 206f 626a 203d 2073 656c 662e       obj = self.
+0000eac0: 636f 7079 2829 0a20 2020 2020 2020 206f  copy().        o
+0000ead0: 626a 2e5f 636f 6f72 645f 6e61 6d65 732e  bj._coord_names.
+0000eae0: 7570 6461 7465 286e 616d 6573 290a 2020  update(names).  
+0000eaf0: 2020 2020 2020 7265 7475 726e 206f 626a        return obj
+0000eb00: 0a0a 2020 2020 6465 6620 7265 7365 745f  ..    def reset_
+0000eb10: 636f 6f72 6473 280a 2020 2020 2020 2020  coords(.        
+0000eb20: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+0000eb30: 0a20 2020 2020 2020 206e 616d 6573 3a20  .        names: 
+0000eb40: 4469 6d73 203d 204e 6f6e 652c 0a20 2020  Dims = None,.   
+0000eb50: 2020 2020 2064 726f 703a 2062 6f6f 6c20       drop: bool 
+0000eb60: 3d20 4661 6c73 652c 0a20 2020 2029 202d  = False,.    ) -
+0000eb70: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
+0000eb80: 2020 2020 2022 2222 4769 7665 6e20 6e61       """Given na
+0000eb90: 6d65 7320 6f66 2063 6f6f 7264 696e 6174  mes of coordinat
+0000eba0: 6573 2c20 7265 7365 7420 7468 656d 2074  es, reset them t
+0000ebb0: 6f20 6265 636f 6d65 2076 6172 6961 626c  o become variabl
+0000ebc0: 6573 0a0a 2020 2020 2020 2020 5061 7261  es..        Para
+0000ebd0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0000ebe0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000ebf0: 2020 6e61 6d65 7320 3a20 7374 722c 2049    names : str, I
+0000ec00: 7465 7261 626c 6520 6f66 2048 6173 6861  terable of Hasha
+0000ec10: 626c 6520 6f72 204e 6f6e 652c 206f 7074  ble or None, opt
+0000ec20: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0000ec30: 2020 4e61 6d65 2873 2920 6f66 206e 6f6e    Name(s) of non
+0000ec40: 2d69 6e64 6578 2063 6f6f 7264 696e 6174  -index coordinat
+0000ec50: 6573 2069 6e20 7468 6973 2064 6174 6173  es in this datas
+0000ec60: 6574 2074 6f20 7265 7365 7420 696e 746f  et to reset into
+0000ec70: 0a20 2020 2020 2020 2020 2020 2076 6172  .            var
+0000ec80: 6961 626c 6573 2e20 4279 2064 6566 6175  iables. By defau
+0000ec90: 6c74 2c20 616c 6c20 6e6f 6e2d 696e 6465  lt, all non-inde
+0000eca0: 7820 636f 6f72 6469 6e61 7465 7320 6172  x coordinates ar
+0000ecb0: 6520 7265 7365 742e 0a20 2020 2020 2020  e reset..       
+0000ecc0: 2064 726f 7020 3a20 626f 6f6c 2c20 6465   drop : bool, de
+0000ecd0: 6661 756c 743a 2046 616c 7365 0a20 2020  fault: False.   
+0000ece0: 2020 2020 2020 2020 2049 6620 5472 7565           If True
+0000ecf0: 2c20 7265 6d6f 7665 2063 6f6f 7264 696e  , remove coordin
+0000ed00: 6174 6573 2069 6e73 7465 6164 206f 6620  ates instead of 
+0000ed10: 636f 6e76 6572 7469 6e67 2074 6865 6d20  converting them 
+0000ed20: 696e 746f 0a20 2020 2020 2020 2020 2020  into.           
+0000ed30: 2076 6172 6961 626c 6573 2e0a 0a20 2020   variables...   
+0000ed40: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+0000ed50: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+0000ed60: 2020 2020 2044 6174 6173 6574 0a20 2020       Dataset.   
+0000ed70: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000ed80: 2069 6620 6e61 6d65 7320 6973 204e 6f6e   if names is Non
+0000ed90: 653a 0a20 2020 2020 2020 2020 2020 206e  e:.            n
+0000eda0: 616d 6573 203d 2073 656c 662e 5f63 6f6f  ames = self._coo
+0000edb0: 7264 5f6e 616d 6573 202d 2073 6574 2873  rd_names - set(s
+0000edc0: 656c 662e 5f69 6e64 6578 6573 290a 2020  elf._indexes).  
+0000edd0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000ede0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
+0000edf0: 7461 6e63 6528 6e61 6d65 732c 2073 7472  tance(names, str
+0000ee00: 2920 6f72 206e 6f74 2069 7369 6e73 7461  ) or not isinsta
+0000ee10: 6e63 6528 6e61 6d65 732c 2049 7465 7261  nce(names, Itera
+0000ee20: 626c 6529 3a0a 2020 2020 2020 2020 2020  ble):.          
+0000ee30: 2020 2020 2020 6e61 6d65 7320 3d20 5b6e        names = [n
+0000ee40: 616d 6573 5d0a 2020 2020 2020 2020 2020  ames].          
+0000ee50: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0000ee60: 2020 2020 2020 2020 6e61 6d65 7320 3d20          names = 
+0000ee70: 6c69 7374 286e 616d 6573 290a 2020 2020  list(names).    
+0000ee80: 2020 2020 2020 2020 7365 6c66 2e5f 6173          self._as
+0000ee90: 7365 7274 5f61 6c6c 5f69 6e5f 6461 7461  sert_all_in_data
+0000eea0: 7365 7428 6e61 6d65 7329 0a20 2020 2020  set(names).     
+0000eeb0: 2020 2020 2020 2062 6164 5f63 6f6f 7264         bad_coord
+0000eec0: 7320 3d20 7365 7428 6e61 6d65 7329 2026  s = set(names) &
+0000eed0: 2073 6574 2873 656c 662e 5f69 6e64 6578   set(self._index
+0000eee0: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+0000eef0: 6966 2062 6164 5f63 6f6f 7264 733a 0a20  if bad_coords:. 
+0000ef00: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0000ef10: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0000ef20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ef30: 2020 2020 2066 2263 616e 6e6f 7420 7265       f"cannot re
+0000ef40: 6d6f 7665 2069 6e64 6578 2063 6f6f 7264  move index coord
+0000ef50: 696e 6174 6573 2077 6974 6820 7265 7365  inates with rese
+0000ef60: 745f 636f 6f72 6473 3a20 7b62 6164 5f63  t_coords: {bad_c
+0000ef70: 6f6f 7264 737d 220a 2020 2020 2020 2020  oords}".        
+0000ef80: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000ef90: 2020 6f62 6a20 3d20 7365 6c66 2e63 6f70    obj = self.cop
+0000efa0: 7928 290a 2020 2020 2020 2020 6f62 6a2e  y().        obj.
+0000efb0: 5f63 6f6f 7264 5f6e 616d 6573 2e64 6966  _coord_names.dif
+0000efc0: 6665 7265 6e63 655f 7570 6461 7465 286e  ference_update(n
+0000efd0: 616d 6573 290a 2020 2020 2020 2020 6966  ames).        if
+0000efe0: 2064 726f 703a 0a20 2020 2020 2020 2020   drop:.         
+0000eff0: 2020 2066 6f72 206e 616d 6520 696e 206e     for name in n
+0000f000: 616d 6573 3a0a 2020 2020 2020 2020 2020  ames:.          
+0000f010: 2020 2020 2020 6465 6c20 6f62 6a2e 5f76        del obj._v
+0000f020: 6172 6961 626c 6573 5b6e 616d 655d 0a20  ariables[name]. 
+0000f030: 2020 2020 2020 2072 6574 7572 6e20 6f62         return ob
+0000f040: 6a0a 0a20 2020 2064 6566 2064 756d 705f  j..    def dump_
+0000f050: 746f 5f73 746f 7265 2873 656c 662c 2073  to_store(self, s
+0000f060: 746f 7265 3a20 4162 7374 7261 6374 4461  tore: AbstractDa
+0000f070: 7461 5374 6f72 652c 202a 2a6b 7761 7267  taStore, **kwarg
+0000f080: 7329 202d 3e20 4e6f 6e65 3a0a 2020 2020  s) -> None:.    
+0000f090: 2020 2020 2222 2253 746f 7265 2064 6174      """Store dat
+0000f0a0: 6173 6574 2063 6f6e 7465 6e74 7320 746f  aset contents to
+0000f0b0: 2061 2062 6163 6b65 6e64 732e 2a44 6174   a backends.*Dat
+0000f0c0: 6153 746f 7265 206f 626a 6563 742e 2222  aStore object.""
+0000f0d0: 220a 2020 2020 2020 2020 6672 6f6d 2078  ".        from x
+0000f0e0: 6172 7261 792e 6261 636b 656e 6473 2e61  array.backends.a
+0000f0f0: 7069 2069 6d70 6f72 7420 6475 6d70 5f74  pi import dump_t
+0000f100: 6f5f 7374 6f72 650a 0a20 2020 2020 2020  o_store..       
+0000f110: 2023 2054 4f44 4f3a 2072 656e 616d 6520   # TODO: rename 
+0000f120: 616e 642f 6f72 2063 6c65 616e 7570 2074  and/or cleanup t
+0000f130: 6869 7320 6d65 7468 6f64 2074 6f20 6d61  his method to ma
+0000f140: 6b65 2069 7420 6d6f 7265 2063 6f6e 7369  ke it more consi
+0000f150: 7374 656e 740a 2020 2020 2020 2020 2320  stent.        # 
+0000f160: 7769 7468 2074 6f5f 6e65 7463 6466 2829  with to_netcdf()
+0000f170: 0a20 2020 2020 2020 2064 756d 705f 746f  .        dump_to
+0000f180: 5f73 746f 7265 2873 656c 662c 2073 746f  _store(self, sto
+0000f190: 7265 2c20 2a2a 6b77 6172 6773 290a 0a20  re, **kwargs).. 
+0000f1a0: 2020 2023 2070 6174 683d 4e6f 6e65 2077     # path=None w
+0000f1b0: 7269 7465 7320 746f 2062 7974 6573 0a20  rites to bytes. 
+0000f1c0: 2020 2040 6f76 6572 6c6f 6164 0a20 2020     @overload.   
+0000f1d0: 2064 6566 2074 6f5f 6e65 7463 6466 280a   def to_netcdf(.
+0000f1e0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000f1f0: 2020 2020 2020 7061 7468 3a20 4e6f 6e65        path: None
+0000f200: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000f210: 206d 6f64 653a 204c 6974 6572 616c 5b22   mode: Literal["
+0000f220: 7722 2c20 2261 225d 203d 2022 7722 2c0a  w", "a"] = "w",.
+0000f230: 2020 2020 2020 2020 666f 726d 6174 3a20          format: 
+0000f240: 545f 4e65 7463 6466 5479 7065 7320 7c20  T_NetcdfTypes | 
+0000f250: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+0000f260: 2020 2020 2067 726f 7570 3a20 7374 7220       group: str 
+0000f270: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+0000f280: 2020 2020 2020 2065 6e67 696e 653a 2054         engine: T
+0000f290: 5f4e 6574 6364 6645 6e67 696e 6520 7c20  _NetcdfEngine | 
+0000f2a0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+0000f2b0: 2020 2020 2065 6e63 6f64 696e 673a 204d       encoding: M
+0000f2c0: 6170 7069 6e67 5b41 6e79 2c20 4d61 7070  apping[Any, Mapp
+0000f2d0: 696e 675b 7374 722c 2041 6e79 5d5d 207c  ing[str, Any]] |
+0000f2e0: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+0000f2f0: 2020 2020 2020 756e 6c69 6d69 7465 645f        unlimited_
+0000f300: 6469 6d73 3a20 4974 6572 6162 6c65 5b48  dims: Iterable[H
+0000f310: 6173 6861 626c 655d 207c 204e 6f6e 6520  ashable] | None 
+0000f320: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0000f330: 636f 6d70 7574 653a 2062 6f6f 6c20 3d20  compute: bool = 
+0000f340: 5472 7565 2c0a 2020 2020 2020 2020 696e  True,.        in
+0000f350: 7661 6c69 645f 6e65 7463 6466 3a20 626f  valid_netcdf: bo
+0000f360: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+0000f370: 2920 2d3e 2062 7974 6573 3a0a 2020 2020  ) -> bytes:.    
+0000f380: 2020 2020 2e2e 2e0a 0a20 2020 2023 2064      .....    # d
+0000f390: 6566 6175 6c74 2072 6574 7572 6e20 4e6f  efault return No
+0000f3a0: 6e65 0a20 2020 2040 6f76 6572 6c6f 6164  ne.    @overload
+0000f3b0: 0a20 2020 2064 6566 2074 6f5f 6e65 7463  .    def to_netc
+0000f3c0: 6466 280a 2020 2020 2020 2020 7365 6c66  df(.        self
+0000f3d0: 2c0a 2020 2020 2020 2020 7061 7468 3a20  ,.        path: 
+0000f3e0: 7374 7220 7c20 5061 7468 4c69 6b65 2c0a  str | PathLike,.
+0000f3f0: 2020 2020 2020 2020 6d6f 6465 3a20 4c69          mode: Li
+0000f400: 7465 7261 6c5b 2277 222c 2022 6122 5d20  teral["w", "a"] 
+0000f410: 3d20 2277 222c 0a20 2020 2020 2020 2066  = "w",.        f
+0000f420: 6f72 6d61 743a 2054 5f4e 6574 6364 6654  ormat: T_NetcdfT
+0000f430: 7970 6573 207c 204e 6f6e 6520 3d20 4e6f  ypes | None = No
+0000f440: 6e65 2c0a 2020 2020 2020 2020 6772 6f75  ne,.        grou
+0000f450: 703a 2073 7472 207c 204e 6f6e 6520 3d20  p: str | None = 
+0000f460: 4e6f 6e65 2c0a 2020 2020 2020 2020 656e  None,.        en
+0000f470: 6769 6e65 3a20 545f 4e65 7463 6466 456e  gine: T_NetcdfEn
+0000f480: 6769 6e65 207c 204e 6f6e 6520 3d20 4e6f  gine | None = No
+0000f490: 6e65 2c0a 2020 2020 2020 2020 656e 636f  ne,.        enco
+0000f4a0: 6469 6e67 3a20 4d61 7070 696e 675b 416e  ding: Mapping[An
+0000f4b0: 792c 204d 6170 7069 6e67 5b73 7472 2c20  y, Mapping[str, 
+0000f4c0: 416e 795d 5d20 7c20 4e6f 6e65 203d 204e  Any]] | None = N
+0000f4d0: 6f6e 652c 0a20 2020 2020 2020 2075 6e6c  one,.        unl
+0000f4e0: 696d 6974 6564 5f64 696d 733a 2049 7465  imited_dims: Ite
+0000f4f0: 7261 626c 655b 4861 7368 6162 6c65 5d20  rable[Hashable] 
+0000f500: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+0000f510: 2020 2020 2020 2063 6f6d 7075 7465 3a20         compute: 
+0000f520: 4c69 7465 7261 6c5b 5472 7565 5d20 3d20  Literal[True] = 
+0000f530: 5472 7565 2c0a 2020 2020 2020 2020 696e  True,.        in
+0000f540: 7661 6c69 645f 6e65 7463 6466 3a20 626f  valid_netcdf: bo
+0000f550: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+0000f560: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
+0000f570: 2020 202e 2e2e 0a0a 2020 2020 2320 636f     .....    # co
+0000f580: 6d70 7574 653d 4661 6c73 6520 7265 7475  mpute=False retu
+0000f590: 726e 7320 6461 736b 2e44 656c 6179 6564  rns dask.Delayed
+0000f5a0: 0a20 2020 2040 6f76 6572 6c6f 6164 0a20  .    @overload. 
+0000f5b0: 2020 2064 6566 2074 6f5f 6e65 7463 6466     def to_netcdf
+0000f5c0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000f5d0: 2020 2020 2020 2020 7061 7468 3a20 7374          path: st
+0000f5e0: 7220 7c20 5061 7468 4c69 6b65 2c0a 2020  r | PathLike,.  
+0000f5f0: 2020 2020 2020 6d6f 6465 3a20 4c69 7465        mode: Lite
+0000f600: 7261 6c5b 2277 222c 2022 6122 5d20 3d20  ral["w", "a"] = 
+0000f610: 2277 222c 0a20 2020 2020 2020 2066 6f72  "w",.        for
+0000f620: 6d61 743a 2054 5f4e 6574 6364 6654 7970  mat: T_NetcdfTyp
+0000f630: 6573 207c 204e 6f6e 6520 3d20 4e6f 6e65  es | None = None
+0000f640: 2c0a 2020 2020 2020 2020 6772 6f75 703a  ,.        group:
+0000f650: 2073 7472 207c 204e 6f6e 6520 3d20 4e6f   str | None = No
+0000f660: 6e65 2c0a 2020 2020 2020 2020 656e 6769  ne,.        engi
+0000f670: 6e65 3a20 545f 4e65 7463 6466 456e 6769  ne: T_NetcdfEngi
+0000f680: 6e65 207c 204e 6f6e 6520 3d20 4e6f 6e65  ne | None = None
+0000f690: 2c0a 2020 2020 2020 2020 656e 636f 6469  ,.        encodi
+0000f6a0: 6e67 3a20 4d61 7070 696e 675b 416e 792c  ng: Mapping[Any,
+0000f6b0: 204d 6170 7069 6e67 5b73 7472 2c20 416e   Mapping[str, An
+0000f6c0: 795d 5d20 7c20 4e6f 6e65 203d 204e 6f6e  y]] | None = Non
+0000f6d0: 652c 0a20 2020 2020 2020 2075 6e6c 696d  e,.        unlim
+0000f6e0: 6974 6564 5f64 696d 733a 2049 7465 7261  ited_dims: Itera
+0000f6f0: 626c 655b 4861 7368 6162 6c65 5d20 7c20  ble[Hashable] | 
+0000f700: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+0000f710: 2020 2020 202a 2c0a 2020 2020 2020 2020       *,.        
+0000f720: 636f 6d70 7574 653a 204c 6974 6572 616c  compute: Literal
+0000f730: 5b46 616c 7365 5d2c 0a20 2020 2020 2020  [False],.       
+0000f740: 2069 6e76 616c 6964 5f6e 6574 6364 663a   invalid_netcdf:
+0000f750: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+0000f760: 2020 2029 202d 3e20 4465 6c61 7965 643a     ) -> Delayed:
+0000f770: 0a20 2020 2020 2020 202e 2e2e 0a0a 2020  .        .....  
+0000f780: 2020 6465 6620 746f 5f6e 6574 6364 6628    def to_netcdf(
+0000f790: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+0000f7a0: 2020 2020 2020 2070 6174 683a 2073 7472         path: str
+0000f7b0: 207c 2050 6174 684c 696b 6520 7c20 4e6f   | PathLike | No
+0000f7c0: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+0000f7d0: 2020 206d 6f64 653a 204c 6974 6572 616c     mode: Literal
+0000f7e0: 5b22 7722 2c20 2261 225d 203d 2022 7722  ["w", "a"] = "w"
+0000f7f0: 2c0a 2020 2020 2020 2020 666f 726d 6174  ,.        format
+0000f800: 3a20 545f 4e65 7463 6466 5479 7065 7320  : T_NetcdfTypes 
+0000f810: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+0000f820: 2020 2020 2020 2067 726f 7570 3a20 7374         group: st
+0000f830: 7220 7c20 4e6f 6e65 203d 204e 6f6e 652c  r | None = None,
+0000f840: 0a20 2020 2020 2020 2065 6e67 696e 653a  .        engine:
+0000f850: 2054 5f4e 6574 6364 6645 6e67 696e 6520   T_NetcdfEngine 
+0000f860: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+0000f870: 2020 2020 2020 2065 6e63 6f64 696e 673a         encoding:
+0000f880: 204d 6170 7069 6e67 5b41 6e79 2c20 4d61   Mapping[Any, Ma
+0000f890: 7070 696e 675b 7374 722c 2041 6e79 5d5d  pping[str, Any]]
+0000f8a0: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
+0000f8b0: 2020 2020 2020 2020 756e 6c69 6d69 7465          unlimite
+0000f8c0: 645f 6469 6d73 3a20 4974 6572 6162 6c65  d_dims: Iterable
+0000f8d0: 5b48 6173 6861 626c 655d 207c 204e 6f6e  [Hashable] | Non
+0000f8e0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+0000f8f0: 2020 636f 6d70 7574 653a 2062 6f6f 6c20    compute: bool 
+0000f900: 3d20 5472 7565 2c0a 2020 2020 2020 2020  = True,.        
+0000f910: 696e 7661 6c69 645f 6e65 7463 6466 3a20  invalid_netcdf: 
+0000f920: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+0000f930: 2020 2920 2d3e 2062 7974 6573 207c 2044    ) -> bytes | D
+0000f940: 656c 6179 6564 207c 204e 6f6e 653a 0a20  elayed | None:. 
+0000f950: 2020 2020 2020 2022 2222 5772 6974 6520         """Write 
+0000f960: 6461 7461 7365 7420 636f 6e74 656e 7473  dataset contents
+0000f970: 2074 6f20 6120 6e65 7443 4446 2066 696c   to a netCDF fil
+0000f980: 652e 0a0a 2020 2020 2020 2020 5061 7261  e...        Para
+0000f990: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0000f9a0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0000f9b0: 2020 7061 7468 203a 2073 7472 2c20 7061    path : str, pa
+0000f9c0: 7468 2d6c 696b 6520 6f72 2066 696c 652d  th-like or file-
+0000f9d0: 6c69 6b65 2c20 6f70 7469 6f6e 616c 0a20  like, optional. 
+0000f9e0: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
+0000f9f0: 746f 2077 6869 6368 2074 6f20 7361 7665  to which to save
+0000fa00: 2074 6869 7320 6461 7461 7365 742e 2046   this dataset. F
+0000fa10: 696c 652d 6c69 6b65 206f 626a 6563 7473  ile-like objects
+0000fa20: 2061 7265 206f 6e6c 790a 2020 2020 2020   are only.      
+0000fa30: 2020 2020 2020 7375 7070 6f72 7465 6420        supported 
+0000fa40: 6279 2074 6865 2073 6369 7079 2065 6e67  by the scipy eng
+0000fa50: 696e 652e 2049 6620 6e6f 2070 6174 6820  ine. If no path 
+0000fa60: 6973 2070 726f 7669 6465 642c 2074 6869  is provided, thi
+0000fa70: 730a 2020 2020 2020 2020 2020 2020 6675  s.            fu
+0000fa80: 6e63 7469 6f6e 2072 6574 7572 6e73 2074  nction returns t
+0000fa90: 6865 2072 6573 756c 7469 6e67 206e 6574  he resulting net
+0000faa0: 4344 4620 6669 6c65 2061 7320 6279 7465  CDF file as byte
+0000fab0: 733b 2069 6e20 7468 6973 2063 6173 652c  s; in this case,
+0000fac0: 0a20 2020 2020 2020 2020 2020 2077 6520  .            we 
+0000fad0: 6e65 6564 2074 6f20 7573 6520 7363 6970  need to use scip
+0000fae0: 792c 2077 6869 6368 2064 6f65 7320 6e6f  y, which does no
+0000faf0: 7420 7375 7070 6f72 7420 6e65 7443 4446  t support netCDF
+0000fb00: 2076 6572 7369 6f6e 2034 2028 7468 650a   version 4 (the.
+0000fb10: 2020 2020 2020 2020 2020 2020 6465 6661              defa
+0000fb20: 756c 7420 666f 726d 6174 2062 6563 6f6d  ult format becom
+0000fb30: 6573 204e 4554 4344 4633 5f36 3442 4954  es NETCDF3_64BIT
+0000fb40: 292e 0a20 2020 2020 2020 206d 6f64 6520  )..        mode 
+0000fb50: 3a20 7b22 7722 2c20 2261 227d 2c20 6465  : {"w", "a"}, de
+0000fb60: 6661 756c 743a 2022 7722 0a20 2020 2020  fault: "w".     
+0000fb70: 2020 2020 2020 2057 7269 7465 2028 2777         Write ('w
+0000fb80: 2729 206f 7220 6170 7065 6e64 2028 2761  ') or append ('a
+0000fb90: 2729 206d 6f64 652e 2049 6620 6d6f 6465  ') mode. If mode
+0000fba0: 3d27 7727 2c20 616e 7920 6578 6973 7469  ='w', any existi
+0000fbb0: 6e67 2066 696c 6520 6174 0a20 2020 2020  ng file at.     
+0000fbc0: 2020 2020 2020 2074 6869 7320 6c6f 6361         this loca
+0000fbd0: 7469 6f6e 2077 696c 6c20 6265 206f 7665  tion will be ove
+0000fbe0: 7277 7269 7474 656e 2e20 4966 206d 6f64  rwritten. If mod
+0000fbf0: 653d 2761 272c 2065 7869 7374 696e 6720  e='a', existing 
+0000fc00: 7661 7269 6162 6c65 730a 2020 2020 2020  variables.      
+0000fc10: 2020 2020 2020 7769 6c6c 2062 6520 6f76        will be ov
+0000fc20: 6572 7772 6974 7465 6e2e 0a20 2020 2020  erwritten..     
+0000fc30: 2020 2066 6f72 6d61 7420 3a20 7b22 4e45     format : {"NE
+0000fc40: 5443 4446 3422 2c20 224e 4554 4344 4634  TCDF4", "NETCDF4
+0000fc50: 5f43 4c41 5353 4943 222c 2022 4e45 5443  _CLASSIC", "NETC
+0000fc60: 4446 335f 3634 4249 5422 2c20 5c0a 2020  DF3_64BIT", \.  
+0000fc70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000fc80: 224e 4554 4344 4633 5f43 4c41 5353 4943  "NETCDF3_CLASSIC
+0000fc90: 227d 2c20 6f70 7469 6f6e 616c 0a20 2020  "}, optional.   
+0000fca0: 2020 2020 2020 2020 2046 696c 6520 666f           File fo
+0000fcb0: 726d 6174 2066 6f72 2074 6865 2072 6573  rmat for the res
+0000fcc0: 756c 7469 6e67 206e 6574 4344 4620 6669  ulting netCDF fi
+0000fcd0: 6c65 3a0a 0a20 2020 2020 2020 2020 2020  le:..           
+0000fce0: 202a 204e 4554 4344 4634 3a20 4461 7461   * NETCDF4: Data
+0000fcf0: 2069 7320 7374 6f72 6564 2069 6e20 616e   is stored in an
+0000fd00: 2048 4446 3520 6669 6c65 2c20 7573 696e   HDF5 file, usin
+0000fd10: 6720 6e65 7443 4446 3420 4150 490a 2020  g netCDF4 API.  
+0000fd20: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+0000fd30: 7572 6573 2e0a 2020 2020 2020 2020 2020  ures..          
+0000fd40: 2020 2a20 4e45 5443 4446 345f 434c 4153    * NETCDF4_CLAS
+0000fd50: 5349 433a 2044 6174 6120 6973 2073 746f  SIC: Data is sto
+0000fd60: 7265 6420 696e 2061 6e20 4844 4635 2066  red in an HDF5 f
+0000fd70: 696c 652c 2075 7369 6e67 206f 6e6c 790a  ile, using only.
+0000fd80: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+0000fd90: 7443 4446 2033 2063 6f6d 7061 7469 626c  tCDF 3 compatibl
+0000fda0: 6520 4150 4920 6665 6174 7572 6573 2e0a  e API features..
+0000fdb0: 2020 2020 2020 2020 2020 2020 2a20 4e45              * NE
+0000fdc0: 5443 4446 335f 3634 4249 543a 2036 342d  TCDF3_64BIT: 64-
+0000fdd0: 6269 7420 6f66 6673 6574 2076 6572 7369  bit offset versi
+0000fde0: 6f6e 206f 6620 7468 6520 6e65 7443 4446  on of the netCDF
+0000fdf0: 2033 2066 696c 6520 666f 726d 6174 2c0a   3 file format,.
+0000fe00: 2020 2020 2020 2020 2020 2020 2020 7768                wh
+0000fe10: 6963 6820 6675 6c6c 7920 7375 7070 6f72  ich fully suppor
+0000fe20: 7473 2032 2b20 4742 2066 696c 6573 2c20  ts 2+ GB files, 
+0000fe30: 6275 7420 6973 206f 6e6c 7920 636f 6d70  but is only comp
+0000fe40: 6174 6962 6c65 2077 6974 680a 2020 2020  atible with.    
+0000fe50: 2020 2020 2020 2020 2020 636c 6965 6e74            client
+0000fe60: 7320 6c69 6e6b 6564 2061 6761 696e 7374  s linked against
+0000fe70: 206e 6574 4344 4620 7665 7273 696f 6e20   netCDF version 
+0000fe80: 332e 362e 3020 6f72 206c 6174 6572 2e0a  3.6.0 or later..
+0000fe90: 2020 2020 2020 2020 2020 2020 2a20 4e45              * NE
+0000fea0: 5443 4446 335f 434c 4153 5349 433a 2054  TCDF3_CLASSIC: T
+0000feb0: 6865 2063 6c61 7373 6963 206e 6574 4344  he classic netCD
+0000fec0: 4620 3320 6669 6c65 2066 6f72 6d61 742e  F 3 file format.
+0000fed0: 2049 7420 646f 6573 206e 6f74 0a20 2020   It does not.   
+0000fee0: 2020 2020 2020 2020 2020 2068 616e 646c             handl
+0000fef0: 6520 322b 2047 4220 6669 6c65 7320 7665  e 2+ GB files ve
+0000ff00: 7279 2077 656c 6c2e 0a0a 2020 2020 2020  ry well...      
+0000ff10: 2020 2020 2020 416c 6c20 666f 726d 6174        All format
+0000ff20: 7320 6172 6520 7375 7070 6f72 7465 6420  s are supported 
+0000ff30: 6279 2074 6865 206e 6574 4344 4634 2d70  by the netCDF4-p
+0000ff40: 7974 686f 6e20 6c69 6272 6172 792e 0a20  ython library.. 
+0000ff50: 2020 2020 2020 2020 2020 2073 6369 7079             scipy
+0000ff60: 2e69 6f2e 6e65 7463 6466 206f 6e6c 7920  .io.netcdf only 
+0000ff70: 7375 7070 6f72 7473 2074 6865 206c 6173  supports the las
+0000ff80: 7420 7477 6f20 666f 726d 6174 732e 0a0a  t two formats...
+0000ff90: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+0000ffa0: 6465 6661 756c 7420 666f 726d 6174 2069  default format i
+0000ffb0: 7320 4e45 5443 4446 3420 6966 2079 6f75  s NETCDF4 if you
+0000ffc0: 2061 7265 2073 6176 696e 6720 6120 6669   are saving a fi
+0000ffd0: 6c65 2074 6f20 6469 736b 2061 6e64 0a20  le to disk and. 
+0000ffe0: 2020 2020 2020 2020 2020 2068 6176 6520             have 
+0000fff0: 7468 6520 6e65 7443 4446 342d 7079 7468  the netCDF4-pyth
+00010000: 6f6e 206c 6962 7261 7279 2061 7661 696c  on library avail
+00010010: 6162 6c65 2e20 4f74 6865 7277 6973 652c  able. Otherwise,
+00010020: 2078 6172 7261 7920 6661 6c6c 730a 2020   xarray falls.  
+00010030: 2020 2020 2020 2020 2020 6261 636b 2074            back t
+00010040: 6f20 7573 696e 6720 7363 6970 7920 746f  o using scipy to
+00010050: 2077 7269 7465 206e 6574 4344 4620 6669   write netCDF fi
+00010060: 6c65 7320 616e 6420 6465 6661 756c 7473  les and defaults
+00010070: 2074 6f20 7468 650a 2020 2020 2020 2020   to the.        
+00010080: 2020 2020 4e45 5443 4446 335f 3634 4249      NETCDF3_64BI
+00010090: 5420 666f 726d 6174 2028 7363 6970 7920  T format (scipy 
+000100a0: 646f 6573 206e 6f74 2073 7570 706f 7274  does not support
+000100b0: 206e 6574 4344 4634 292e 0a20 2020 2020   netCDF4)..     
+000100c0: 2020 2067 726f 7570 203a 2073 7472 2c20     group : str, 
+000100d0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+000100e0: 2020 2020 2050 6174 6820 746f 2074 6865       Path to the
+000100f0: 206e 6574 4344 4634 2067 726f 7570 2069   netCDF4 group i
+00010100: 6e20 7468 6520 6769 7665 6e20 6669 6c65  n the given file
+00010110: 2074 6f20 6f70 656e 2028 6f6e 6c79 2077   to open (only w
+00010120: 6f72 6b73 2066 6f72 0a20 2020 2020 2020  orks for.       
+00010130: 2020 2020 2066 6f72 6d61 743d 274e 4554       format='NET
+00010140: 4344 4634 2729 2e20 5468 6520 6772 6f75  CDF4'). The grou
+00010150: 7028 7329 2077 696c 6c20 6265 2063 7265  p(s) will be cre
+00010160: 6174 6564 2069 6620 6e65 6365 7373 6172  ated if necessar
+00010170: 792e 0a20 2020 2020 2020 2065 6e67 696e  y..        engin
+00010180: 6520 3a20 7b22 6e65 7463 6466 3422 2c20  e : {"netcdf4", 
+00010190: 2273 6369 7079 222c 2022 6835 6e65 7463  "scipy", "h5netc
+000101a0: 6466 227d 2c20 6f70 7469 6f6e 616c 0a20  df"}, optional. 
+000101b0: 2020 2020 2020 2020 2020 2045 6e67 696e             Engin
+000101c0: 6520 746f 2075 7365 2077 6865 6e20 7772  e to use when wr
+000101d0: 6974 696e 6720 6e65 7443 4446 2066 696c  iting netCDF fil
+000101e0: 6573 2e20 4966 206e 6f74 2070 726f 7669  es. If not provi
+000101f0: 6465 642c 2074 6865 0a20 2020 2020 2020  ded, the.       
+00010200: 2020 2020 2064 6566 6175 6c74 2065 6e67       default eng
+00010210: 696e 6520 6973 2063 686f 7365 6e20 6261  ine is chosen ba
+00010220: 7365 6420 6f6e 2061 7661 696c 6162 6c65  sed on available
+00010230: 2064 6570 656e 6465 6e63 6965 732c 2077   dependencies, w
+00010240: 6974 6820 610a 2020 2020 2020 2020 2020  ith a.          
+00010250: 2020 7072 6566 6572 656e 6365 2066 6f72    preference for
+00010260: 2027 6e65 7463 6466 3427 2069 6620 7772   'netcdf4' if wr
+00010270: 6974 696e 6720 746f 2061 2066 696c 6520  iting to a file 
+00010280: 6f6e 2064 6973 6b2e 0a20 2020 2020 2020  on disk..       
+00010290: 2065 6e63 6f64 696e 6720 3a20 6469 6374   encoding : dict
+000102a0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+000102b0: 2020 2020 2020 204e 6573 7465 6420 6469         Nested di
+000102c0: 6374 696f 6e61 7279 2077 6974 6820 7661  ctionary with va
+000102d0: 7269 6162 6c65 206e 616d 6573 2061 7320  riable names as 
+000102e0: 6b65 7973 2061 6e64 2064 6963 7469 6f6e  keys and diction
+000102f0: 6172 6965 7320 6f66 0a20 2020 2020 2020  aries of.       
+00010300: 2020 2020 2076 6172 6961 626c 6520 7370       variable sp
+00010310: 6563 6966 6963 2065 6e63 6f64 696e 6773  ecific encodings
+00010320: 2061 7320 7661 6c75 6573 2c20 652e 672e   as values, e.g.
+00010330: 2c0a 2020 2020 2020 2020 2020 2020 6060  ,.            ``
+00010340: 7b22 6d79 5f76 6172 6961 626c 6522 3a20  {"my_variable": 
+00010350: 7b22 6474 7970 6522 3a20 2269 6e74 3136  {"dtype": "int16
+00010360: 222c 2022 7363 616c 655f 6661 6374 6f72  ", "scale_factor
+00010370: 223a 2030 2e31 2c0a 2020 2020 2020 2020  ": 0.1,.        
+00010380: 2020 2020 227a 6c69 6222 3a20 5472 7565      "zlib": True
+00010390: 7d2c 202e 2e2e 7d60 600a 0a20 2020 2020  }, ...}``..     
+000103a0: 2020 2020 2020 2054 6865 2060 6835 6e65         The `h5ne
+000103b0: 7463 6466 6020 656e 6769 6e65 2073 7570  tcdf` engine sup
+000103c0: 706f 7274 7320 626f 7468 2074 6865 204e  ports both the N
+000103d0: 6574 4344 4634 2d73 7479 6c65 2063 6f6d  etCDF4-style com
+000103e0: 7072 6573 7369 6f6e 0a20 2020 2020 2020  pression.       
+000103f0: 2020 2020 2065 6e63 6f64 696e 6720 7061       encoding pa
+00010400: 7261 6d65 7465 7273 2060 607b 227a 6c69  rameters ``{"zli
+00010410: 6222 3a20 5472 7565 2c20 2263 6f6d 706c  b": True, "compl
+00010420: 6576 656c 223a 2039 7d60 6020 616e 6420  evel": 9}`` and 
+00010430: 7468 6520 6835 7079 0a20 2020 2020 2020  the h5py.       
+00010440: 2020 2020 206f 6e65 7320 6060 7b22 636f       ones ``{"co
+00010450: 6d70 7265 7373 696f 6e22 3a20 2267 7a69  mpression": "gzi
+00010460: 7022 2c20 2263 6f6d 7072 6573 7369 6f6e  p", "compression
+00010470: 5f6f 7074 7322 3a20 397d 6060 2e0a 2020  _opts": 9}``..  
+00010480: 2020 2020 2020 2020 2020 5468 6973 2061            This a
+00010490: 6c6c 6f77 7320 7573 696e 6720 616e 7920  llows using any 
+000104a0: 636f 6d70 7265 7373 696f 6e20 706c 7567  compression plug
+000104b0: 696e 2069 6e73 7461 6c6c 6564 2069 6e20  in installed in 
+000104c0: 7468 6520 4844 4635 0a20 2020 2020 2020  the HDF5.       
+000104d0: 2020 2020 206c 6962 7261 7279 2c20 652e       library, e.
+000104e0: 672e 204c 5a46 2e0a 0a20 2020 2020 2020  g. LZF...       
+000104f0: 2075 6e6c 696d 6974 6564 5f64 696d 7320   unlimited_dims 
+00010500: 3a20 6974 6572 6162 6c65 206f 6620 6861  : iterable of ha
+00010510: 7368 6162 6c65 2c20 6f70 7469 6f6e 616c  shable, optional
+00010520: 0a20 2020 2020 2020 2020 2020 2044 696d  .            Dim
+00010530: 656e 7369 6f6e 2873 2920 7468 6174 2073  ension(s) that s
+00010540: 686f 756c 6420 6265 2073 6572 6961 6c69  hould be seriali
+00010550: 7a65 6420 6173 2075 6e6c 696d 6974 6564  zed as unlimited
+00010560: 2064 696d 656e 7369 6f6e 732e 0a20 2020   dimensions..   
+00010570: 2020 2020 2020 2020 2042 7920 6465 6661           By defa
+00010580: 756c 742c 206e 6f20 6469 6d65 6e73 696f  ult, no dimensio
+00010590: 6e73 2061 7265 2074 7265 6174 6564 2061  ns are treated a
+000105a0: 7320 756e 6c69 6d69 7465 6420 6469 6d65  s unlimited dime
+000105b0: 6e73 696f 6e73 2e0a 2020 2020 2020 2020  nsions..        
+000105c0: 2020 2020 4e6f 7465 2074 6861 7420 756e      Note that un
+000105d0: 6c69 6d69 7465 645f 6469 6d73 206d 6179  limited_dims may
+000105e0: 2061 6c73 6f20 6265 2073 6574 2076 6961   also be set via
+000105f0: 0a20 2020 2020 2020 2020 2020 2060 6064  .            ``d
+00010600: 6174 6173 6574 2e65 6e63 6f64 696e 675b  ataset.encoding[
+00010610: 2275 6e6c 696d 6974 6564 5f64 696d 7322  "unlimited_dims"
+00010620: 5d60 602e 0a20 2020 2020 2020 2063 6f6d  ]``..        com
+00010630: 7075 7465 3a20 626f 6f6c 2c20 6465 6661  pute: bool, defa
+00010640: 756c 743a 2054 7275 650a 2020 2020 2020  ult: True.      
+00010650: 2020 2020 2020 4966 2074 7275 6520 636f        If true co
+00010660: 6d70 7574 6520 696d 6d65 6469 6174 656c  mpute immediatel
+00010670: 792c 206f 7468 6572 7769 7365 2072 6574  y, otherwise ret
+00010680: 7572 6e20 610a 2020 2020 2020 2020 2020  urn a.          
+00010690: 2020 6060 6461 736b 2e64 656c 6179 6564    ``dask.delayed
+000106a0: 2e44 656c 6179 6564 6060 206f 626a 6563  .Delayed`` objec
+000106b0: 7420 7468 6174 2063 616e 2062 6520 636f  t that can be co
+000106c0: 6d70 7574 6564 206c 6174 6572 2e0a 2020  mputed later..  
+000106d0: 2020 2020 2020 696e 7661 6c69 645f 6e65        invalid_ne
+000106e0: 7463 6466 3a20 626f 6f6c 2c20 6465 6661  tcdf: bool, defa
+000106f0: 756c 743a 2046 616c 7365 0a20 2020 2020  ult: False.     
+00010700: 2020 2020 2020 204f 6e6c 7920 7661 6c69         Only vali
+00010710: 6420 616c 6f6e 6720 7769 7468 2060 6065  d along with ``e
+00010720: 6e67 696e 653d 2268 356e 6574 6364 6622  ngine="h5netcdf"
+00010730: 6060 2e20 4966 2054 7275 652c 2061 6c6c  ``. If True, all
+00010740: 6f77 2077 7269 7469 6e67 0a20 2020 2020  ow writing.     
+00010750: 2020 2020 2020 2068 6466 3520 6669 6c65         hdf5 file
+00010760: 7320 7768 6963 6820 6172 6520 696e 7661  s which are inva
+00010770: 6c69 6420 6e65 7463 6466 2061 7320 6465  lid netcdf as de
+00010780: 7363 7269 6265 6420 696e 0a20 2020 2020  scribed in.     
+00010790: 2020 2020 2020 2068 7474 7073 3a2f 2f67         https://g
+000107a0: 6974 6875 622e 636f 6d2f 6835 6e65 7463  ithub.com/h5netc
+000107b0: 6466 2f68 356e 6574 6364 662e 0a0a 2020  df/h5netcdf...  
+000107c0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+000107d0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+000107e0: 2020 2020 2020 2020 2020 2a20 6060 6279            * ``by
+000107f0: 7465 7360 6020 6966 2070 6174 6820 6973  tes`` if path is
+00010800: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00010810: 2020 2a20 6060 6461 736b 2e64 656c 6179    * ``dask.delay
+00010820: 6564 2e44 656c 6179 6564 6060 2069 6620  ed.Delayed`` if 
+00010830: 636f 6d70 7574 6520 6973 2046 616c 7365  compute is False
+00010840: 0a20 2020 2020 2020 2020 2020 202a 204e  .            * N
+00010850: 6f6e 6520 6f74 6865 7277 6973 650a 0a20  one otherwise.. 
+00010860: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00010870: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00010880: 0a20 2020 2020 2020 2044 6174 6141 7272  .        DataArr
+00010890: 6179 2e74 6f5f 6e65 7463 6466 0a20 2020  ay.to_netcdf.   
+000108a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000108b0: 2069 6620 656e 636f 6469 6e67 2069 7320   if encoding is 
+000108c0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+000108d0: 2020 656e 636f 6469 6e67 203d 207b 7d0a    encoding = {}.
+000108e0: 2020 2020 2020 2020 6672 6f6d 2078 6172          from xar
+000108f0: 7261 792e 6261 636b 656e 6473 2e61 7069  ray.backends.api
+00010900: 2069 6d70 6f72 7420 746f 5f6e 6574 6364   import to_netcd
+00010910: 660a 0a20 2020 2020 2020 2072 6574 7572  f..        retur
+00010920: 6e20 746f 5f6e 6574 6364 6628 2020 2320  n to_netcdf(  # 
+00010930: 7479 7065 3a20 6967 6e6f 7265 2020 2320  type: ignore  # 
+00010940: 6d79 7079 2063 616e 6e6f 7420 7265 736f  mypy cannot reso
+00010950: 6c76 6520 7468 6520 6f76 6572 6c6f 6164  lve the overload
+00010960: 733a 280a 2020 2020 2020 2020 2020 2020  s:(.            
+00010970: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+00010980: 2020 7061 7468 2c0a 2020 2020 2020 2020    path,.        
+00010990: 2020 2020 6d6f 6465 3d6d 6f64 652c 0a20      mode=mode,. 
+000109a0: 2020 2020 2020 2020 2020 2066 6f72 6d61             forma
+000109b0: 743d 666f 726d 6174 2c0a 2020 2020 2020  t=format,.      
+000109c0: 2020 2020 2020 6772 6f75 703d 6772 6f75        group=grou
+000109d0: 702c 0a20 2020 2020 2020 2020 2020 2065  p,.            e
+000109e0: 6e67 696e 653d 656e 6769 6e65 2c0a 2020  ngine=engine,.  
+000109f0: 2020 2020 2020 2020 2020 656e 636f 6469            encodi
+00010a00: 6e67 3d65 6e63 6f64 696e 672c 0a20 2020  ng=encoding,.   
+00010a10: 2020 2020 2020 2020 2075 6e6c 696d 6974           unlimit
+00010a20: 6564 5f64 696d 733d 756e 6c69 6d69 7465  ed_dims=unlimite
+00010a30: 645f 6469 6d73 2c0a 2020 2020 2020 2020  d_dims,.        
+00010a40: 2020 2020 636f 6d70 7574 653d 636f 6d70      compute=comp
+00010a50: 7574 652c 0a20 2020 2020 2020 2020 2020  ute,.           
+00010a60: 206d 756c 7469 6669 6c65 3d46 616c 7365   multifile=False
+00010a70: 2c0a 2020 2020 2020 2020 2020 2020 696e  ,.            in
+00010a80: 7661 6c69 645f 6e65 7463 6466 3d69 6e76  valid_netcdf=inv
+00010a90: 616c 6964 5f6e 6574 6364 662c 0a20 2020  alid_netcdf,.   
+00010aa0: 2020 2020 2029 0a0a 2020 2020 2320 636f       )..    # co
+00010ab0: 6d70 7574 653d 5472 7565 2028 6465 6661  mpute=True (defa
+00010ac0: 756c 7429 2072 6574 7572 6e73 205a 6172  ult) returns Zar
+00010ad0: 7253 746f 7265 0a20 2020 2040 6f76 6572  rStore.    @over
+00010ae0: 6c6f 6164 0a20 2020 2064 6566 2074 6f5f  load.    def to_
+00010af0: 7a61 7272 280a 2020 2020 2020 2020 7365  zarr(.        se
+00010b00: 6c66 2c0a 2020 2020 2020 2020 7374 6f72  lf,.        stor
+00010b10: 653a 204d 7574 6162 6c65 4d61 7070 696e  e: MutableMappin
+00010b20: 6720 7c20 7374 7220 7c20 5061 7468 4c69  g | str | PathLi
+00010b30: 6b65 5b73 7472 5d20 7c20 4e6f 6e65 203d  ke[str] | None =
+00010b40: 204e 6f6e 652c 0a20 2020 2020 2020 2063   None,.        c
+00010b50: 6875 6e6b 5f73 746f 7265 3a20 4d75 7461  hunk_store: Muta
+00010b60: 626c 654d 6170 7069 6e67 207c 2073 7472  bleMapping | str
+00010b70: 207c 2050 6174 684c 696b 6520 7c20 4e6f   | PathLike | No
+00010b80: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+00010b90: 2020 206d 6f64 653a 204c 6974 6572 616c     mode: Literal
+00010ba0: 5b22 7722 2c20 2277 2d22 2c20 2261 222c  ["w", "w-", "a",
+00010bb0: 2022 722b 222c 204e 6f6e 655d 203d 204e   "r+", None] = N
+00010bc0: 6f6e 652c 0a20 2020 2020 2020 2073 796e  one,.        syn
+00010bd0: 6368 726f 6e69 7a65 723d 4e6f 6e65 2c0a  chronizer=None,.
+00010be0: 2020 2020 2020 2020 6772 6f75 703a 2073          group: s
+00010bf0: 7472 207c 204e 6f6e 6520 3d20 4e6f 6e65  tr | None = None
+00010c00: 2c0a 2020 2020 2020 2020 656e 636f 6469  ,.        encodi
+00010c10: 6e67 3a20 4d61 7070 696e 6720 7c20 4e6f  ng: Mapping | No
+00010c20: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+00010c30: 2020 2063 6f6d 7075 7465 3a20 4c69 7465     compute: Lite
+00010c40: 7261 6c5b 5472 7565 5d20 3d20 5472 7565  ral[True] = True
+00010c50: 2c0a 2020 2020 2020 2020 636f 6e73 6f6c  ,.        consol
+00010c60: 6964 6174 6564 3a20 626f 6f6c 207c 204e  idated: bool | N
+00010c70: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+00010c80: 2020 2020 6170 7065 6e64 5f64 696d 3a20      append_dim: 
+00010c90: 4861 7368 6162 6c65 207c 204e 6f6e 6520  Hashable | None 
+00010ca0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00010cb0: 7265 6769 6f6e 3a20 4d61 7070 696e 675b  region: Mapping[
+00010cc0: 7374 722c 2073 6c69 6365 5d20 7c20 4e6f  str, slice] | No
+00010cd0: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+00010ce0: 2020 2073 6166 655f 6368 756e 6b73 3a20     safe_chunks: 
+00010cf0: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
+00010d00: 2020 2020 2073 746f 7261 6765 5f6f 7074       storage_opt
+00010d10: 696f 6e73 3a20 6469 6374 5b73 7472 2c20  ions: dict[str, 
+00010d20: 7374 725d 207c 204e 6f6e 6520 3d20 4e6f  str] | None = No
+00010d30: 6e65 2c0a 2020 2020 2020 2020 7a61 7272  ne,.        zarr
+00010d40: 5f76 6572 7369 6f6e 3a20 696e 7420 7c20  _version: int | 
+00010d50: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+00010d60: 2020 2020 2063 6875 6e6b 6d61 6e61 6765       chunkmanage
+00010d70: 725f 7374 6f72 655f 6b77 6172 6773 3a20  r_store_kwargs: 
+00010d80: 6469 6374 5b73 7472 2c20 416e 795d 207c  dict[str, Any] |
+00010d90: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+00010da0: 2020 2920 2d3e 205a 6172 7253 746f 7265    ) -> ZarrStore
+00010db0: 3a0a 2020 2020 2020 2020 2e2e 2e0a 0a20  :.        ..... 
+00010dc0: 2020 2023 2063 6f6d 7075 7465 3d46 616c     # compute=Fal
+00010dd0: 7365 2072 6574 7572 6e73 2064 6173 6b2e  se returns dask.
+00010de0: 4465 6c61 7965 640a 2020 2020 406f 7665  Delayed.    @ove
+00010df0: 726c 6f61 640a 2020 2020 6465 6620 746f  rload.    def to
+00010e00: 5f7a 6172 7228 0a20 2020 2020 2020 2073  _zarr(.        s
+00010e10: 656c 662c 0a20 2020 2020 2020 2073 746f  elf,.        sto
+00010e20: 7265 3a20 4d75 7461 626c 654d 6170 7069  re: MutableMappi
+00010e30: 6e67 207c 2073 7472 207c 2050 6174 684c  ng | str | PathL
+00010e40: 696b 655b 7374 725d 207c 204e 6f6e 6520  ike[str] | None 
+00010e50: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00010e60: 6368 756e 6b5f 7374 6f72 653a 204d 7574  chunk_store: Mut
+00010e70: 6162 6c65 4d61 7070 696e 6720 7c20 7374  ableMapping | st
+00010e80: 7220 7c20 5061 7468 4c69 6b65 207c 204e  r | PathLike | N
+00010e90: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+00010ea0: 2020 2020 6d6f 6465 3a20 4c69 7465 7261      mode: Litera
+00010eb0: 6c5b 2277 222c 2022 772d 222c 2022 6122  l["w", "w-", "a"
+00010ec0: 2c20 2272 2b22 2c20 4e6f 6e65 5d20 3d20  , "r+", None] = 
+00010ed0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7379  None,.        sy
+00010ee0: 6e63 6872 6f6e 697a 6572 3d4e 6f6e 652c  nchronizer=None,
+00010ef0: 0a20 2020 2020 2020 2067 726f 7570 3a20  .        group: 
+00010f00: 7374 7220 7c20 4e6f 6e65 203d 204e 6f6e  str | None = Non
+00010f10: 652c 0a20 2020 2020 2020 2065 6e63 6f64  e,.        encod
+00010f20: 696e 673a 204d 6170 7069 6e67 207c 204e  ing: Mapping | N
+00010f30: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+00010f40: 2020 2020 2a2c 0a20 2020 2020 2020 2063      *,.        c
+00010f50: 6f6d 7075 7465 3a20 4c69 7465 7261 6c5b  ompute: Literal[
+00010f60: 4661 6c73 655d 2c0a 2020 2020 2020 2020  False],.        
+00010f70: 636f 6e73 6f6c 6964 6174 6564 3a20 626f  consolidated: bo
+00010f80: 6f6c 207c 204e 6f6e 6520 3d20 4e6f 6e65  ol | None = None
+00010f90: 2c0a 2020 2020 2020 2020 6170 7065 6e64  ,.        append
+00010fa0: 5f64 696d 3a20 4861 7368 6162 6c65 207c  _dim: Hashable |
+00010fb0: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+00010fc0: 2020 2020 2020 7265 6769 6f6e 3a20 4d61        region: Ma
+00010fd0: 7070 696e 675b 7374 722c 2073 6c69 6365  pping[str, slice
+00010fe0: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
+00010ff0: 0a20 2020 2020 2020 2073 6166 655f 6368  .        safe_ch
+00011000: 756e 6b73 3a20 626f 6f6c 203d 2054 7275  unks: bool = Tru
+00011010: 652c 0a20 2020 2020 2020 2073 746f 7261  e,.        stora
+00011020: 6765 5f6f 7074 696f 6e73 3a20 6469 6374  ge_options: dict
+00011030: 5b73 7472 2c20 7374 725d 207c 204e 6f6e  [str, str] | Non
+00011040: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+00011050: 2020 7a61 7272 5f76 6572 7369 6f6e 3a20    zarr_version: 
+00011060: 696e 7420 7c20 4e6f 6e65 203d 204e 6f6e  int | None = Non
+00011070: 652c 0a20 2020 2020 2020 2063 6875 6e6b  e,.        chunk
+00011080: 6d61 6e61 6765 725f 7374 6f72 655f 6b77  manager_store_kw
+00011090: 6172 6773 3a20 6469 6374 5b73 7472 2c20  args: dict[str, 
+000110a0: 416e 795d 207c 204e 6f6e 6520 3d20 4e6f  Any] | None = No
+000110b0: 6e65 2c0a 2020 2020 2920 2d3e 2044 656c  ne,.    ) -> Del
+000110c0: 6179 6564 3a0a 2020 2020 2020 2020 2e2e  ayed:.        ..
+000110d0: 2e0a 0a20 2020 2064 6566 2074 6f5f 7a61  ...    def to_za
+000110e0: 7272 280a 2020 2020 2020 2020 7365 6c66  rr(.        self
+000110f0: 2c0a 2020 2020 2020 2020 7374 6f72 653a  ,.        store:
+00011100: 204d 7574 6162 6c65 4d61 7070 696e 6720   MutableMapping 
+00011110: 7c20 7374 7220 7c20 5061 7468 4c69 6b65  | str | PathLike
+00011120: 5b73 7472 5d20 7c20 4e6f 6e65 203d 204e  [str] | None = N
+00011130: 6f6e 652c 0a20 2020 2020 2020 2063 6875  one,.        chu
+00011140: 6e6b 5f73 746f 7265 3a20 4d75 7461 626c  nk_store: Mutabl
+00011150: 654d 6170 7069 6e67 207c 2073 7472 207c  eMapping | str |
+00011160: 2050 6174 684c 696b 6520 7c20 4e6f 6e65   PathLike | None
+00011170: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00011180: 206d 6f64 653a 204c 6974 6572 616c 5b22   mode: Literal["
+00011190: 7722 2c20 2277 2d22 2c20 2261 222c 2022  w", "w-", "a", "
+000111a0: 722b 222c 204e 6f6e 655d 203d 204e 6f6e  r+", None] = Non
+000111b0: 652c 0a20 2020 2020 2020 2073 796e 6368  e,.        synch
+000111c0: 726f 6e69 7a65 723d 4e6f 6e65 2c0a 2020  ronizer=None,.  
+000111d0: 2020 2020 2020 6772 6f75 703a 2073 7472        group: str
+000111e0: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
+000111f0: 2020 2020 2020 2020 656e 636f 6469 6e67          encoding
+00011200: 3a20 4d61 7070 696e 6720 7c20 4e6f 6e65  : Mapping | None
+00011210: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00011220: 2063 6f6d 7075 7465 3a20 626f 6f6c 203d   compute: bool =
+00011230: 2054 7275 652c 0a20 2020 2020 2020 2063   True,.        c
+00011240: 6f6e 736f 6c69 6461 7465 643a 2062 6f6f  onsolidated: boo
+00011250: 6c20 7c20 4e6f 6e65 203d 204e 6f6e 652c  l | None = None,
+00011260: 0a20 2020 2020 2020 2061 7070 656e 645f  .        append_
+00011270: 6469 6d3a 2048 6173 6861 626c 6520 7c20  dim: Hashable | 
+00011280: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+00011290: 2020 2020 2072 6567 696f 6e3a 204d 6170       region: Map
+000112a0: 7069 6e67 5b73 7472 2c20 736c 6963 655d  ping[str, slice]
+000112b0: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
+000112c0: 2020 2020 2020 2020 7361 6665 5f63 6875          safe_chu
+000112d0: 6e6b 733a 2062 6f6f 6c20 3d20 5472 7565  nks: bool = True
+000112e0: 2c0a 2020 2020 2020 2020 7374 6f72 6167  ,.        storag
+000112f0: 655f 6f70 7469 6f6e 733a 2064 6963 745b  e_options: dict[
+00011300: 7374 722c 2073 7472 5d20 7c20 4e6f 6e65  str, str] | None
+00011310: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00011320: 207a 6172 725f 7665 7273 696f 6e3a 2069   zarr_version: i
+00011330: 6e74 207c 204e 6f6e 6520 3d20 4e6f 6e65  nt | None = None
+00011340: 2c0a 2020 2020 2020 2020 6368 756e 6b6d  ,.        chunkm
+00011350: 616e 6167 6572 5f73 746f 7265 5f6b 7761  anager_store_kwa
+00011360: 7267 733a 2064 6963 745b 7374 722c 2041  rgs: dict[str, A
+00011370: 6e79 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ny] | None = Non
+00011380: 652c 0a20 2020 2029 202d 3e20 5a61 7272  e,.    ) -> Zarr
+00011390: 5374 6f72 6520 7c20 4465 6c61 7965 643a  Store | Delayed:
+000113a0: 0a20 2020 2020 2020 2022 2222 5772 6974  .        """Writ
+000113b0: 6520 6461 7461 7365 7420 636f 6e74 656e  e dataset conten
+000113c0: 7473 2074 6f20 6120 7a61 7272 2067 726f  ts to a zarr gro
+000113d0: 7570 2e0a 0a20 2020 2020 2020 205a 6172  up...        Zar
+000113e0: 7220 6368 756e 6b73 2061 7265 2064 6574  r chunks are det
+000113f0: 6572 6d69 6e65 6420 696e 2074 6865 2066  ermined in the f
+00011400: 6f6c 6c6f 7769 6e67 2077 6179 3a0a 0a20  ollowing way:.. 
+00011410: 2020 2020 2020 202d 2046 726f 6d20 7468         - From th
+00011420: 6520 6060 6368 756e 6b73 6060 2061 7474  e ``chunks`` att
+00011430: 7269 6275 7465 2069 6e20 6561 6368 2076  ribute in each v
+00011440: 6172 6961 626c 6527 7320 6060 656e 636f  ariable's ``enco
+00011450: 6469 6e67 6060 0a20 2020 2020 2020 2020  ding``.         
+00011460: 2028 6361 6e20 6265 2073 6574 2076 6961   (can be set via
+00011470: 2060 4461 7461 7365 742e 6368 756e 6b60   `Dataset.chunk`
+00011480: 292e 0a20 2020 2020 2020 202d 2049 6620  )..        - If 
+00011490: 7468 6520 7661 7269 6162 6c65 2069 7320  the variable is 
+000114a0: 6120 4461 736b 2061 7272 6179 2c20 6672  a Dask array, fr
+000114b0: 6f6d 2074 6865 2064 6173 6b20 6368 756e  om the dask chun
+000114c0: 6b73 0a20 2020 2020 2020 202d 2049 6620  ks.        - If 
+000114d0: 6e65 6974 6865 7220 4461 736b 2063 6875  neither Dask chu
+000114e0: 6e6b 7320 6e6f 7220 656e 636f 6469 6e67  nks nor encoding
+000114f0: 2063 6875 6e6b 7320 6172 6520 7072 6573   chunks are pres
+00011500: 656e 742c 2063 6875 6e6b 7320 7769 6c6c  ent, chunks will
+00011510: 0a20 2020 2020 2020 2020 2062 6520 6465  .          be de
+00011520: 7465 726d 696e 6564 2061 7574 6f6d 6174  termined automat
+00011530: 6963 616c 6c79 2062 7920 5a61 7272 0a20  ically by Zarr. 
+00011540: 2020 2020 2020 202d 2049 6620 626f 7468         - If both
+00011550: 2044 6173 6b20 6368 756e 6b73 2061 6e64   Dask chunks and
+00011560: 2065 6e63 6f64 696e 6720 6368 756e 6b73   encoding chunks
+00011570: 2061 7265 2070 7265 7365 6e74 2c20 656e   are present, en
+00011580: 636f 6469 6e67 2063 6875 6e6b 730a 2020  coding chunks.  
+00011590: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
+000115a0: 7573 6564 2c20 7072 6f76 6964 6564 2074  used, provided t
+000115b0: 6861 7420 7468 6572 6520 6973 2061 206d  hat there is a m
+000115c0: 616e 792d 746f 2d6f 6e65 2072 656c 6174  any-to-one relat
+000115d0: 696f 6e73 6869 7020 6265 7477 6565 6e0a  ionship between.
+000115e0: 2020 2020 2020 2020 2020 656e 636f 6469            encodi
+000115f0: 6e67 2063 6875 6e6b 7320 616e 6420 6461  ng chunks and da
+00011600: 736b 2063 6875 6e6b 7320 2869 2e65 2e20  sk chunks (i.e. 
+00011610: 4461 736b 2063 6875 6e6b 7320 6172 6520  Dask chunks are 
+00011620: 6269 6767 6572 2074 6861 6e20 616e 640a  bigger than and.
+00011630: 2020 2020 2020 2020 2020 6576 656e 6c79            evenly
+00011640: 2064 6976 6964 6520 656e 636f 6469 6e67   divide encoding
+00011650: 2063 6875 6e6b 7329 3b20 6f74 6865 7277   chunks); otherw
+00011660: 6973 6520 7261 6973 6520 6120 6060 5661  ise raise a ``Va
+00011670: 6c75 6545 7272 6f72 6060 2e0a 2020 2020  lueError``..    
+00011680: 2020 2020 2020 5468 6973 2072 6573 7472        This restr
+00011690: 6963 7469 6f6e 2065 6e73 7572 6573 2074  iction ensures t
+000116a0: 6861 7420 6e6f 2073 796e 6368 726f 6e69  hat no synchroni
+000116b0: 7a61 7469 6f6e 202f 206c 6f63 6b73 2061  zation / locks a
+000116c0: 7265 2072 6571 7569 7265 640a 2020 2020  re required.    
+000116d0: 2020 2020 2020 7768 656e 2077 7269 7469        when writi
+000116e0: 6e67 2e20 546f 2064 6973 6162 6c65 2074  ng. To disable t
+000116f0: 6869 7320 7265 7374 7269 6374 696f 6e2c  his restriction,
+00011700: 2075 7365 2060 6073 6166 655f 6368 756e   use ``safe_chun
+00011710: 6b73 3d46 616c 7365 6060 2e0a 0a20 2020  ks=False``...   
+00011720: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00011730: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00011740: 2d2d 0a20 2020 2020 2020 2073 746f 7265  --.        store
+00011750: 203a 204d 7574 6162 6c65 4d61 7070 696e   : MutableMappin
+00011760: 672c 2073 7472 206f 7220 7061 7468 2d6c  g, str or path-l
+00011770: 696b 652c 206f 7074 696f 6e61 6c0a 2020  ike, optional.  
+00011780: 2020 2020 2020 2020 2020 5374 6f72 6520            Store 
+00011790: 6f72 2070 6174 6820 746f 2064 6972 6563  or path to direc
+000117a0: 746f 7279 2069 6e20 6c6f 6361 6c20 6f72  tory in local or
+000117b0: 2072 656d 6f74 6520 6669 6c65 2073 7973   remote file sys
+000117c0: 7465 6d2e 0a20 2020 2020 2020 2063 6875  tem..        chu
+000117d0: 6e6b 5f73 746f 7265 203a 204d 7574 6162  nk_store : Mutab
+000117e0: 6c65 4d61 7070 696e 672c 2073 7472 206f  leMapping, str o
+000117f0: 7220 7061 7468 2d6c 696b 652c 206f 7074  r path-like, opt
+00011800: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00011810: 2020 5374 6f72 6520 6f72 2070 6174 6820    Store or path 
+00011820: 746f 2064 6972 6563 746f 7279 2069 6e20  to directory in 
+00011830: 6c6f 6361 6c20 6f72 2072 656d 6f74 6520  local or remote 
+00011840: 6669 6c65 2073 7973 7465 6d20 6f6e 6c79  file system only
+00011850: 2066 6f72 205a 6172 720a 2020 2020 2020   for Zarr.      
+00011860: 2020 2020 2020 6172 7261 7920 6368 756e        array chun
+00011870: 6b73 2e20 5265 7175 6972 6573 207a 6172  ks. Requires zar
+00011880: 722d 7079 7468 6f6e 2076 322e 342e 3020  r-python v2.4.0 
+00011890: 6f72 206c 6174 6572 2e0a 2020 2020 2020  or later..      
+000118a0: 2020 6d6f 6465 203a 207b 2277 222c 2022    mode : {"w", "
+000118b0: 772d 222c 2022 6122 2c20 2272 2b22 2c20  w-", "a", "r+", 
+000118c0: 4e6f 6e65 7d2c 206f 7074 696f 6e61 6c0a  None}, optional.
+000118d0: 2020 2020 2020 2020 2020 2020 5065 7273              Pers
+000118e0: 6973 7465 6e63 6520 6d6f 6465 3a20 2277  istence mode: "w
+000118f0: 2220 6d65 616e 7320 6372 6561 7465 2028  " means create (
+00011900: 6f76 6572 7772 6974 6520 6966 2065 7869  overwrite if exi
+00011910: 7374 7329 3b0a 2020 2020 2020 2020 2020  sts);.          
+00011920: 2020 2277 2d22 206d 6561 6e73 2063 7265    "w-" means cre
+00011930: 6174 6520 2866 6169 6c20 6966 2065 7869  ate (fail if exi
+00011940: 7374 7329 3b0a 2020 2020 2020 2020 2020  sts);.          
+00011950: 2020 2261 2220 6d65 616e 7320 6f76 6572    "a" means over
+00011960: 7269 6465 2065 7869 7374 696e 6720 7661  ride existing va
+00011970: 7269 6162 6c65 7320 2863 7265 6174 6520  riables (create 
+00011980: 6966 2064 6f65 7320 6e6f 7420 6578 6973  if does not exis
+00011990: 7429 3b0a 2020 2020 2020 2020 2020 2020  t);.            
+000119a0: 2272 2b22 206d 6561 6e73 206d 6f64 6966  "r+" means modif
+000119b0: 7920 6578 6973 7469 6e67 2061 7272 6179  y existing array
+000119c0: 202a 7661 6c75 6573 2a20 6f6e 6c79 2028   *values* only (
+000119d0: 7261 6973 6520 616e 2065 7272 6f72 2069  raise an error i
+000119e0: 660a 2020 2020 2020 2020 2020 2020 616e  f.            an
+000119f0: 7920 6d65 7461 6461 7461 206f 7220 7368  y metadata or sh
+00011a00: 6170 6573 2077 6f75 6c64 2063 6861 6e67  apes would chang
+00011a10: 6529 2e0a 2020 2020 2020 2020 2020 2020  e)..            
+00011a20: 5468 6520 6465 6661 756c 7420 6d6f 6465  The default mode
+00011a30: 2069 7320 2261 2220 6966 2060 6061 7070   is "a" if ``app
+00011a40: 656e 645f 6469 6d60 6020 6973 2073 6574  end_dim`` is set
+00011a50: 2e20 4f74 6865 7277 6973 652c 2069 7420  . Otherwise, it 
+00011a60: 6973 0a20 2020 2020 2020 2020 2020 2022  is.            "
+00011a70: 722b 2220 6966 2060 6072 6567 696f 6e60  r+" if ``region`
+00011a80: 6020 6973 2073 6574 2061 6e64 2060 6077  ` is set and ``w
+00011a90: 2d60 6020 6f74 6865 7277 6973 652e 0a20  -`` otherwise.. 
+00011aa0: 2020 2020 2020 2073 796e 6368 726f 6e69         synchroni
+00011ab0: 7a65 7220 3a20 6f62 6a65 6374 2c20 6f70  zer : object, op
+00011ac0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00011ad0: 2020 205a 6172 7220 6172 7261 7920 7379     Zarr array sy
+00011ae0: 6e63 6872 6f6e 697a 6572 2e0a 2020 2020  nchronizer..    
+00011af0: 2020 2020 6772 6f75 7020 3a20 7374 722c      group : str,
+00011b00: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00011b10: 2020 2020 2020 4772 6f75 7020 7061 7468        Group path
+00011b20: 2e20 2861 2e6b 2e61 2e20 6070 6174 6860  . (a.k.a. `path`
+00011b30: 2069 6e20 7a61 7272 2074 6572 6d69 6e6f   in zarr termino
+00011b40: 6c6f 6779 2e29 0a20 2020 2020 2020 2065  logy.).        e
+00011b50: 6e63 6f64 696e 6720 3a20 6469 6374 2c20  ncoding : dict, 
+00011b60: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00011b70: 2020 2020 204e 6573 7465 6420 6469 6374       Nested dict
+00011b80: 696f 6e61 7279 2077 6974 6820 7661 7269  ionary with vari
+00011b90: 6162 6c65 206e 616d 6573 2061 7320 6b65  able names as ke
+00011ba0: 7973 2061 6e64 2064 6963 7469 6f6e 6172  ys and dictionar
+00011bb0: 6965 7320 6f66 0a20 2020 2020 2020 2020  ies of.         
+00011bc0: 2020 2076 6172 6961 626c 6520 7370 6563     variable spec
+00011bd0: 6966 6963 2065 6e63 6f64 696e 6773 2061  ific encodings a
+00011be0: 7320 7661 6c75 6573 2c20 652e 672e 2c0a  s values, e.g.,.
+00011bf0: 2020 2020 2020 2020 2020 2020 6060 7b22              ``{"
+00011c00: 6d79 5f76 6172 6961 626c 6522 3a20 7b22  my_variable": {"
+00011c10: 6474 7970 6522 3a20 2269 6e74 3136 222c  dtype": "int16",
+00011c20: 2022 7363 616c 655f 6661 6374 6f72 223a   "scale_factor":
+00011c30: 2030 2e31 2c7d 2c20 2e2e 2e7d 6060 0a20   0.1,}, ...}``. 
+00011c40: 2020 2020 2020 2063 6f6d 7075 7465 203a         compute :
+00011c50: 2062 6f6f 6c2c 2064 6566 6175 6c74 3a20   bool, default: 
+00011c60: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
+00011c70: 2049 6620 5472 7565 2077 7269 7465 2061   If True write a
+00011c80: 7272 6179 2064 6174 6120 696d 6d65 6469  rray data immedi
+00011c90: 6174 656c 792c 206f 7468 6572 7769 7365  ately, otherwise
+00011ca0: 2072 6574 7572 6e20 610a 2020 2020 2020   return a.      
+00011cb0: 2020 2020 2020 6060 6461 736b 2e64 656c        ``dask.del
+00011cc0: 6179 6564 2e44 656c 6179 6564 6060 206f  ayed.Delayed`` o
+00011cd0: 626a 6563 7420 7468 6174 2063 616e 2062  bject that can b
+00011ce0: 6520 636f 6d70 7574 6564 2074 6f20 7772  e computed to wr
+00011cf0: 6974 650a 2020 2020 2020 2020 2020 2020  ite.            
+00011d00: 6172 7261 7920 6461 7461 206c 6174 6572  array data later
+00011d10: 2e20 4d65 7461 6461 7461 2069 7320 616c  . Metadata is al
+00011d20: 7761 7973 2075 7064 6174 6564 2065 6167  ways updated eag
+00011d30: 6572 6c79 2e0a 2020 2020 2020 2020 636f  erly..        co
+00011d40: 6e73 6f6c 6964 6174 6564 203a 2062 6f6f  nsolidated : boo
+00011d50: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
+00011d60: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+00011d70: 2061 7070 6c79 207a 6172 7227 7320 6063   apply zarr's `c
+00011d80: 6f6e 736f 6c69 6461 7465 5f6d 6574 6164  onsolidate_metad
+00011d90: 6174 6160 2066 756e 6374 696f 6e20 746f  ata` function to
+00011da0: 2074 6865 2073 746f 7265 0a20 2020 2020   the store.     
+00011db0: 2020 2020 2020 2061 6674 6572 2077 7269         after wri
+00011dc0: 7469 6e67 206d 6574 6164 6174 6120 616e  ting metadata an
+00011dd0: 6420 7265 6164 2065 7869 7374 696e 6720  d read existing 
+00011de0: 7374 6f72 6573 2077 6974 6820 636f 6e73  stores with cons
+00011df0: 6f6c 6964 6174 6564 0a20 2020 2020 2020  olidated.       
+00011e00: 2020 2020 206d 6574 6164 6174 613b 2069       metadata; i
+00011e10: 6620 4661 6c73 652c 2064 6f20 6e6f 742e  f False, do not.
+00011e20: 2054 6865 2064 6566 6175 6c74 2028 6063   The default (`c
+00011e30: 6f6e 736f 6c69 6461 7465 643d 4e6f 6e65  onsolidated=None
+00011e40: 6029 206d 6561 6e73 0a20 2020 2020 2020  `) means.       
+00011e50: 2020 2020 2077 7269 7465 2063 6f6e 736f       write conso
+00011e60: 6c69 6461 7465 6420 6d65 7461 6461 7461  lidated metadata
+00011e70: 2061 6e64 2061 7474 656d 7074 2074 6f20   and attempt to 
+00011e80: 7265 6164 2063 6f6e 736f 6c69 6461 7465  read consolidate
+00011e90: 640a 2020 2020 2020 2020 2020 2020 6d65  d.            me
+00011ea0: 7461 6461 7461 2066 6f72 2065 7869 7374  tadata for exist
+00011eb0: 696e 6720 7374 6f72 6573 2028 6661 6c6c  ing stores (fall
+00011ec0: 696e 6720 6261 636b 2074 6f20 6e6f 6e2d  ing back to non-
+00011ed0: 636f 6e73 6f6c 6964 6174 6564 292e 0a0a  consolidated)...
+00011ee0: 2020 2020 2020 2020 2020 2020 5768 656e              When
+00011ef0: 2074 6865 2065 7870 6572 696d 656e 7461   the experimenta
+00011f00: 6c20 6060 7a61 7272 5f76 6572 7369 6f6e  l ``zarr_version
+00011f10: 3d33 6060 2c20 6060 636f 6e73 6f6c 6964  =3``, ``consolid
+00011f20: 6174 6564 6060 206d 7573 7420 6265 0a20  ated`` must be. 
+00011f30: 2020 2020 2020 2020 2020 2065 6974 6865             eithe
+00011f40: 7220 6265 2060 604e 6f6e 6560 6020 6f72  r be ``None`` or
+00011f50: 2060 6046 616c 7365 6060 2e0a 2020 2020   ``False``..    
+00011f60: 2020 2020 6170 7065 6e64 5f64 696d 203a      append_dim :
+00011f70: 2068 6173 6861 626c 652c 206f 7074 696f   hashable, optio
+00011f80: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00011f90: 4966 2073 6574 2c20 7468 6520 6469 6d65  If set, the dime
+00011fa0: 6e73 696f 6e20 616c 6f6e 6720 7768 6963  nsion along whic
+00011fb0: 6820 7468 6520 6461 7461 2077 696c 6c20  h the data will 
+00011fc0: 6265 2061 7070 656e 6465 642e 2041 6c6c  be appended. All
+00011fd0: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+00011fe0: 6572 2064 696d 656e 7369 6f6e 7320 6f6e  er dimensions on
+00011ff0: 206f 7665 7272 6964 6465 6e20 7661 7269   overridden vari
+00012000: 6162 6c65 7320 6d75 7374 2072 656d 6169  ables must remai
+00012010: 6e20 7468 6520 7361 6d65 2073 697a 652e  n the same size.
+00012020: 0a20 2020 2020 2020 2072 6567 696f 6e20  .        region 
+00012030: 3a20 6469 6374 2c20 6f70 7469 6f6e 616c  : dict, optional
+00012040: 0a20 2020 2020 2020 2020 2020 204f 7074  .            Opt
+00012050: 696f 6e61 6c20 6d61 7070 696e 6720 6672  ional mapping fr
+00012060: 6f6d 2064 696d 656e 7369 6f6e 206e 616d  om dimension nam
+00012070: 6573 2074 6f20 696e 7465 6765 7220 736c  es to integer sl
+00012080: 6963 6573 2061 6c6f 6e67 0a20 2020 2020  ices along.     
+00012090: 2020 2020 2020 2064 6174 6173 6574 2064         dataset d
+000120a0: 696d 656e 7369 6f6e 7320 746f 2069 6e64  imensions to ind
+000120b0: 6963 6174 6520 7468 6520 7265 6769 6f6e  icate the region
+000120c0: 206f 6620 6578 6973 7469 6e67 207a 6172   of existing zar
+000120d0: 7220 6172 7261 7928 7329 0a20 2020 2020  r array(s).     
+000120e0: 2020 2020 2020 2069 6e20 7768 6963 6820         in which 
+000120f0: 746f 2077 7269 7465 2074 6869 7320 6461  to write this da
+00012100: 7461 7365 7427 7320 6461 7461 2e20 466f  taset's data. Fo
+00012110: 7220 6578 616d 706c 652c 0a20 2020 2020  r example,.     
+00012120: 2020 2020 2020 2060 607b 2778 273a 2073         ``{'x': s
+00012130: 6c69 6365 2830 2c20 3130 3030 292c 2027  lice(0, 1000), '
+00012140: 7927 3a20 736c 6963 6528 3130 3030 302c  y': slice(10000,
+00012150: 2031 3130 3030 297d 6060 2077 6f75 6c64   11000)}`` would
+00012160: 2069 6e64 6963 6174 650a 2020 2020 2020   indicate.      
+00012170: 2020 2020 2020 7468 6174 2076 616c 7565        that value
+00012180: 7320 7368 6f75 6c64 2062 6520 7772 6974  s should be writ
+00012190: 7465 6e20 746f 2074 6865 2072 6567 696f  ten to the regio
+000121a0: 6e20 6060 303a 3130 3030 6060 2061 6c6f  n ``0:1000`` alo
+000121b0: 6e67 2060 6078 6060 0a20 2020 2020 2020  ng ``x``.       
+000121c0: 2020 2020 2061 6e64 2060 6031 3030 3030       and ``10000
+000121d0: 3a31 3130 3030 6060 2061 6c6f 6e67 2060  :11000`` along `
+000121e0: 6079 6060 2e0a 0a20 2020 2020 2020 2020  `y``...         
+000121f0: 2020 2054 776f 2072 6573 7472 6963 7469     Two restricti
+00012200: 6f6e 7320 6170 706c 7920 746f 2074 6865  ons apply to the
+00012210: 2075 7365 206f 6620 6060 7265 6769 6f6e   use of ``region
+00012220: 6060 3a0a 0a20 2020 2020 2020 2020 2020  ``:..           
+00012230: 202d 2049 6620 6060 7265 6769 6f6e 6060   - If ``region``
+00012240: 2069 7320 7365 742c 205f 616c 6c5f 2076   is set, _all_ v
+00012250: 6172 6961 626c 6573 2069 6e20 6120 6461  ariables in a da
+00012260: 7461 7365 7420 6d75 7374 2068 6176 6520  taset must have 
+00012270: 6174 0a20 2020 2020 2020 2020 2020 2020  at.             
+00012280: 206c 6561 7374 206f 6e65 2064 696d 656e   least one dimen
+00012290: 7369 6f6e 2069 6e20 636f 6d6d 6f6e 2077  sion in common w
+000122a0: 6974 6820 7468 6520 7265 6769 6f6e 2e20  ith the region. 
+000122b0: 4f74 6865 7220 7661 7269 6162 6c65 730a  Other variables.
+000122c0: 2020 2020 2020 2020 2020 2020 2020 7368                sh
+000122d0: 6f75 6c64 2062 6520 7772 6974 7465 6e20  ould be written 
+000122e0: 696e 2061 2073 6570 6172 6174 6520 6361  in a separate ca
+000122f0: 6c6c 2074 6f20 6060 746f 5f7a 6172 7228  ll to ``to_zarr(
+00012300: 2960 602e 0a20 2020 2020 2020 2020 2020  )``..           
+00012310: 202d 2044 696d 656e 7369 6f6e 7320 6361   - Dimensions ca
+00012320: 6e6e 6f74 2062 6520 696e 636c 7564 6564  nnot be included
+00012330: 2069 6e20 626f 7468 2060 6072 6567 696f   in both ``regio
+00012340: 6e60 6020 616e 640a 2020 2020 2020 2020  n`` and.        
+00012350: 2020 2020 2020 6060 6170 7065 6e64 5f64        ``append_d
+00012360: 696d 6060 2061 7420 7468 6520 7361 6d65  im`` at the same
+00012370: 2074 696d 652e 2054 6f20 6372 6561 7465   time. To create
+00012380: 2065 6d70 7479 2061 7272 6179 7320 746f   empty arrays to
+00012390: 2066 696c 6c0a 2020 2020 2020 2020 2020   fill.          
+000123a0: 2020 2020 696e 2077 6974 6820 6060 7265      in with ``re
+000123b0: 6769 6f6e 6060 2c20 7573 6520 6120 7365  gion``, use a se
+000123c0: 7061 7261 7465 2063 616c 6c20 746f 2060  parate call to `
+000123d0: 6074 6f5f 7a61 7272 2829 6060 2077 6974  `to_zarr()`` wit
+000123e0: 680a 2020 2020 2020 2020 2020 2020 2020  h.              
+000123f0: 6060 636f 6d70 7574 653d 4661 6c73 6560  ``compute=False`
+00012400: 602e 2053 6565 2022 4170 7065 6e64 696e  `. See "Appendin
+00012410: 6720 746f 2065 7869 7374 696e 6720 5a61  g to existing Za
+00012420: 7272 2073 746f 7265 7322 2069 6e0a 2020  rr stores" in.  
+00012430: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00012440: 7265 6665 7265 6e63 6520 646f 6375 6d65  reference docume
+00012450: 6e74 6174 696f 6e20 666f 7220 6675 6c6c  ntation for full
+00012460: 2064 6574 6169 6c73 2e0a 2020 2020 2020   details..      
+00012470: 2020 7361 6665 5f63 6875 6e6b 7320 3a20    safe_chunks : 
+00012480: 626f 6f6c 2c20 6465 6661 756c 743a 2054  bool, default: T
+00012490: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+000124a0: 4966 2054 7275 652c 206f 6e6c 7920 616c  If True, only al
+000124b0: 6c6f 7720 7772 6974 6573 2074 6f20 7768  low writes to wh
+000124c0: 656e 2074 6865 7265 2069 7320 6120 6d61  en there is a ma
+000124d0: 6e79 2d74 6f2d 6f6e 6520 7265 6c61 7469  ny-to-one relati
+000124e0: 6f6e 7368 6970 0a20 2020 2020 2020 2020  onship.         
+000124f0: 2020 2062 6574 7765 656e 205a 6172 7220     between Zarr 
+00012500: 6368 756e 6b73 2028 7370 6563 6966 6965  chunks (specifie
+00012510: 6420 696e 2065 6e63 6f64 696e 6729 2061  d in encoding) a
+00012520: 6e64 2044 6173 6b20 6368 756e 6b73 2e0a  nd Dask chunks..
+00012530: 2020 2020 2020 2020 2020 2020 5365 7420              Set 
+00012540: 4661 6c73 6520 746f 206f 7665 7272 6964  False to overrid
+00012550: 6520 7468 6973 2072 6573 7472 6963 7469  e this restricti
+00012560: 6f6e 3b20 686f 7765 7665 722c 2064 6174  on; however, dat
+00012570: 6120 6d61 7920 6265 636f 6d65 2063 6f72  a may become cor
+00012580: 7275 7074 6564 0a20 2020 2020 2020 2020  rupted.         
+00012590: 2020 2069 6620 5a61 7272 2061 7272 6179     if Zarr array
+000125a0: 7320 6172 6520 7772 6974 7465 6e20 696e  s are written in
+000125b0: 2070 6172 616c 6c65 6c2e 2054 6869 7320   parallel. This 
+000125c0: 6f70 7469 6f6e 206d 6179 2062 6520 7573  option may be us
+000125d0: 6566 756c 2069 6e20 636f 6d62 696e 6174  eful in combinat
+000125e0: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+000125f0: 7769 7468 2060 6063 6f6d 7075 7465 3d46  with ``compute=F
+00012600: 616c 7365 6060 2074 6f20 696e 6974 6961  alse`` to initia
+00012610: 6c69 7a65 2061 205a 6172 7220 6672 6f6d  lize a Zarr from
+00012620: 2061 6e20 6578 6973 7469 6e67 0a20 2020   an existing.   
+00012630: 2020 2020 2020 2020 2044 6174 6173 6574           Dataset
+00012640: 2077 6974 6820 6172 6269 7472 6172 7920   with arbitrary 
+00012650: 6368 756e 6b20 7374 7275 6374 7572 652e  chunk structure.
+00012660: 0a20 2020 2020 2020 2073 746f 7261 6765  .        storage
+00012670: 5f6f 7074 696f 6e73 203a 2064 6963 742c  _options : dict,
+00012680: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00012690: 2020 2020 2020 416e 7920 6164 6469 7469        Any additi
+000126a0: 6f6e 616c 2070 6172 616d 6574 6572 7320  onal parameters 
+000126b0: 666f 7220 7468 6520 7374 6f72 6167 6520  for the storage 
+000126c0: 6261 636b 656e 6420 2869 676e 6f72 6564  backend (ignored
+000126d0: 2066 6f72 206c 6f63 616c 0a20 2020 2020   for local.     
+000126e0: 2020 2020 2020 2070 6174 6873 292e 0a20         paths).. 
+000126f0: 2020 2020 2020 207a 6172 725f 7665 7273         zarr_vers
+00012700: 696f 6e20 3a20 696e 7420 6f72 204e 6f6e  ion : int or Non
+00012710: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
+00012720: 2020 2020 2020 2020 5468 6520 6465 7369          The desi
+00012730: 7265 6420 7a61 7272 2073 7065 6320 7665  red zarr spec ve
+00012740: 7273 696f 6e20 746f 2074 6172 6765 7420  rsion to target 
+00012750: 2863 7572 7265 6e74 6c79 2032 206f 7220  (currently 2 or 
+00012760: 3329 2e20 5468 650a 2020 2020 2020 2020  3). The.        
+00012770: 2020 2020 6465 6661 756c 7420 6f66 204e      default of N
+00012780: 6f6e 6520 7769 6c6c 2061 7474 656d 7074  one will attempt
+00012790: 2074 6f20 6465 7465 726d 696e 6520 7468   to determine th
+000127a0: 6520 7a61 7272 2076 6572 7369 6f6e 2066  e zarr version f
+000127b0: 726f 6d0a 2020 2020 2020 2020 2020 2020  rom.            
+000127c0: 6060 7374 6f72 6560 6020 7768 656e 2070  ``store`` when p
+000127d0: 6f73 7369 626c 652c 206f 7468 6572 7769  ossible, otherwi
+000127e0: 7365 2064 6566 6175 6c74 696e 6720 746f  se defaulting to
+000127f0: 2032 2e0a 2020 2020 2020 2020 6368 756e   2..        chun
+00012800: 6b6d 616e 6167 6572 5f73 746f 7265 5f6b  kmanager_store_k
+00012810: 7761 7267 7320 3a20 6469 6374 2c20 6f70  wargs : dict, op
+00012820: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00012830: 2020 2041 6464 6974 696f 6e61 6c20 6b65     Additional ke
+00012840: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+00012850: 7061 7373 6564 206f 6e20 746f 2074 6865  passed on to the
+00012860: 2060 4368 756e 6b4d 616e 6167 6572 2e73   `ChunkManager.s
+00012870: 746f 7265 6020 6d65 7468 6f64 2075 7365  tore` method use
+00012880: 6420 746f 2073 746f 7265 0a20 2020 2020  d to store.     
+00012890: 2020 2020 2020 2063 6875 6e6b 6564 2061         chunked a
+000128a0: 7272 6179 732e 2046 6f72 2065 7861 6d70  rrays. For examp
+000128b0: 6c65 2066 6f72 2061 2064 6173 6b20 6172  le for a dask ar
+000128c0: 7261 7920 6164 6469 7469 6f6e 616c 206b  ray additional k
+000128d0: 7761 7267 7320 7769 6c6c 2062 6520 7061  wargs will be pa
+000128e0: 7373 6564 2065 7665 6e74 7561 6c6c 7920  ssed eventually 
+000128f0: 746f 0a20 2020 2020 2020 2020 2020 203a  to.            :
+00012900: 7079 3a66 756e 633a 6064 6173 6b2e 6172  py:func:`dask.ar
+00012910: 7261 792e 7374 6f72 6528 2960 2e20 4578  ray.store()`. Ex
+00012920: 7065 7269 6d65 6e74 616c 2041 5049 2074  perimental API t
+00012930: 6861 7420 7368 6f75 6c64 206e 6f74 2062  hat should not b
+00012940: 6520 7265 6c69 6564 2075 706f 6e2e 0a0a  e relied upon...
+00012950: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00012960: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00012970: 2020 2020 2020 2020 2020 2020 2a20 6060              * ``
+00012980: 6461 736b 2e64 656c 6179 6564 2e44 656c  dask.delayed.Del
+00012990: 6179 6564 6060 2069 6620 636f 6d70 7574  ayed`` if comput
+000129a0: 6520 6973 2046 616c 7365 0a20 2020 2020  e is False.     
+000129b0: 2020 2020 2020 202a 205a 6172 7253 746f         * ZarrSto
+000129c0: 7265 206f 7468 6572 7769 7365 0a0a 2020  re otherwise..  
+000129d0: 2020 2020 2020 5265 6665 7265 6e63 6573        References
+000129e0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000129f0: 2d2d 2d0a 2020 2020 2020 2020 6874 7470  ---.        http
+00012a00: 733a 2f2f 7a61 7272 2e72 6561 6474 6865  s://zarr.readthe
+00012a10: 646f 6373 2e69 6f2f 0a0a 2020 2020 2020  docs.io/..      
+00012a20: 2020 4e6f 7465 730a 2020 2020 2020 2020    Notes.        
+00012a30: 2d2d 2d2d 2d0a 2020 2020 2020 2020 5a61  -----.        Za
+00012a40: 7272 2063 6875 6e6b 696e 6720 6265 6861  rr chunking beha
+00012a50: 7669 6f72 3a0a 2020 2020 2020 2020 2020  vior:.          
+00012a60: 2020 4966 2063 6875 6e6b 7320 6172 6520    If chunks are 
+00012a70: 666f 756e 6420 696e 2074 6865 2065 6e63  found in the enc
+00012a80: 6f64 696e 6720 6172 6775 6d65 6e74 206f  oding argument o
+00012a90: 7220 6174 7472 6962 7574 650a 2020 2020  r attribute.    
+00012aa0: 2020 2020 2020 2020 636f 7272 6573 706f          correspo
+00012ab0: 6e64 696e 6720 746f 2061 6e79 2044 6174  nding to any Dat
+00012ac0: 6141 7272 6179 2c20 7468 6f73 6520 6368  aArray, those ch
+00012ad0: 756e 6b73 2061 7265 2075 7365 642e 0a20  unks are used.. 
+00012ae0: 2020 2020 2020 2020 2020 2049 6620 6120             If a 
+00012af0: 4461 7461 4172 7261 7920 6973 2061 2064  DataArray is a d
+00012b00: 6173 6b20 6172 7261 792c 2069 7420 6973  ask array, it is
+00012b10: 2077 7269 7474 656e 2077 6974 6820 7468   written with th
+00012b20: 6f73 6520 6368 756e 6b73 2e0a 2020 2020  ose chunks..    
+00012b30: 2020 2020 2020 2020 4966 206e 6f74 206f          If not o
+00012b40: 7468 6572 2063 6875 6e6b 7320 6172 6520  ther chunks are 
+00012b50: 666f 756e 642c 205a 6172 7220 7573 6573  found, Zarr uses
+00012b60: 2069 7473 206f 776e 2068 6575 7269 7374   its own heurist
+00012b70: 6963 7320 746f 0a20 2020 2020 2020 2020  ics to.         
+00012b80: 2020 2063 686f 6f73 6520 6175 746f 6d61     choose automa
+00012b90: 7469 6320 6368 756e 6b20 7369 7a65 732e  tic chunk sizes.
+00012ba0: 0a0a 2020 2020 2020 2020 656e 636f 6469  ..        encodi
+00012bb0: 6e67 3a0a 2020 2020 2020 2020 2020 2020  ng:.            
+00012bc0: 5468 6520 656e 636f 6469 6e67 2061 7474  The encoding att
+00012bd0: 7269 6275 7465 2028 6966 2065 7869 7374  ribute (if exist
+00012be0: 7329 206f 6620 7468 6520 4461 7461 4172  s) of the DataAr
+00012bf0: 7261 7928 7329 2077 696c 6c20 6265 0a20  ray(s) will be. 
+00012c00: 2020 2020 2020 2020 2020 2075 7365 642e             used.
+00012c10: 204f 7665 7272 6964 6520 616e 7920 6578   Override any ex
+00012c20: 6973 7469 6e67 2065 6e63 6f64 696e 6773  isting encodings
+00012c30: 2062 7920 7072 6f76 6964 696e 6720 7468   by providing th
+00012c40: 6520 6060 656e 636f 6469 6e67 6060 206b  e ``encoding`` k
+00012c50: 7761 7267 2e0a 0a20 2020 2020 2020 2053  warg...        S
+00012c60: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+00012c70: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00012c80: 203a 7265 663a 6069 6f2e 7a61 7272 600a   :ref:`io.zarr`.
+00012c90: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00012ca0: 492f 4f20 7573 6572 2067 7569 6465 2c20  I/O user guide, 
+00012cb0: 7769 7468 206d 6f72 6520 6465 7461 696c  with more detail
+00012cc0: 7320 616e 6420 6578 616d 706c 6573 2e0a  s and examples..
+00012cd0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00012ce0: 2020 2020 6672 6f6d 2078 6172 7261 792e      from xarray.
+00012cf0: 6261 636b 656e 6473 2e61 7069 2069 6d70  backends.api imp
+00012d00: 6f72 7420 746f 5f7a 6172 720a 0a20 2020  ort to_zarr..   
+00012d10: 2020 2020 2072 6574 7572 6e20 746f 5f7a       return to_z
+00012d20: 6172 7228 2020 2320 7479 7065 3a20 6967  arr(  # type: ig
+00012d30: 6e6f 7265 5b63 616c 6c2d 6f76 6572 6c6f  nore[call-overlo
+00012d40: 6164 2c6d 6973 635d 0a20 2020 2020 2020  ad,misc].       
+00012d50: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00012d60: 2020 2020 2020 2073 746f 7265 3d73 746f         store=sto
+00012d70: 7265 2c0a 2020 2020 2020 2020 2020 2020  re,.            
+00012d80: 6368 756e 6b5f 7374 6f72 653d 6368 756e  chunk_store=chun
+00012d90: 6b5f 7374 6f72 652c 0a20 2020 2020 2020  k_store,.       
+00012da0: 2020 2020 2073 746f 7261 6765 5f6f 7074       storage_opt
+00012db0: 696f 6e73 3d73 746f 7261 6765 5f6f 7074  ions=storage_opt
+00012dc0: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
+00012dd0: 2020 6d6f 6465 3d6d 6f64 652c 0a20 2020    mode=mode,.   
+00012de0: 2020 2020 2020 2020 2073 796e 6368 726f           synchro
+00012df0: 6e69 7a65 723d 7379 6e63 6872 6f6e 697a  nizer=synchroniz
+00012e00: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+00012e10: 6772 6f75 703d 6772 6f75 702c 0a20 2020  group=group,.   
+00012e20: 2020 2020 2020 2020 2065 6e63 6f64 696e           encodin
+00012e30: 673d 656e 636f 6469 6e67 2c0a 2020 2020  g=encoding,.    
+00012e40: 2020 2020 2020 2020 636f 6d70 7574 653d          compute=
+00012e50: 636f 6d70 7574 652c 0a20 2020 2020 2020  compute,.       
+00012e60: 2020 2020 2063 6f6e 736f 6c69 6461 7465       consolidate
+00012e70: 643d 636f 6e73 6f6c 6964 6174 6564 2c0a  d=consolidated,.
+00012e80: 2020 2020 2020 2020 2020 2020 6170 7065              appe
+00012e90: 6e64 5f64 696d 3d61 7070 656e 645f 6469  nd_dim=append_di
+00012ea0: 6d2c 0a20 2020 2020 2020 2020 2020 2072  m,.            r
+00012eb0: 6567 696f 6e3d 7265 6769 6f6e 2c0a 2020  egion=region,.  
+00012ec0: 2020 2020 2020 2020 2020 7361 6665 5f63            safe_c
+00012ed0: 6875 6e6b 733d 7361 6665 5f63 6875 6e6b  hunks=safe_chunk
+00012ee0: 732c 0a20 2020 2020 2020 2020 2020 207a  s,.            z
+00012ef0: 6172 725f 7665 7273 696f 6e3d 7a61 7272  arr_version=zarr
+00012f00: 5f76 6572 7369 6f6e 2c0a 2020 2020 2020  _version,.      
+00012f10: 2020 2020 2020 6368 756e 6b6d 616e 6167        chunkmanag
+00012f20: 6572 5f73 746f 7265 5f6b 7761 7267 733d  er_store_kwargs=
+00012f30: 6368 756e 6b6d 616e 6167 6572 5f73 746f  chunkmanager_sto
+00012f40: 7265 5f6b 7761 7267 732c 0a20 2020 2020  re_kwargs,.     
+00012f50: 2020 2029 0a0a 2020 2020 6465 6620 5f5f     )..    def __
+00012f60: 7265 7072 5f5f 2873 656c 6629 202d 3e20  repr__(self) -> 
+00012f70: 7374 723a 0a20 2020 2020 2020 2072 6574  str:.        ret
+00012f80: 7572 6e20 666f 726d 6174 7469 6e67 2e64  urn formatting.d
+00012f90: 6174 6173 6574 5f72 6570 7228 7365 6c66  ataset_repr(self
+00012fa0: 290a 0a20 2020 2064 6566 205f 7265 7072  )..    def _repr
+00012fb0: 5f68 746d 6c5f 2873 656c 6629 202d 3e20  _html_(self) -> 
+00012fc0: 7374 723a 0a20 2020 2020 2020 2069 6620  str:.        if 
+00012fd0: 4f50 5449 4f4e 535b 2264 6973 706c 6179  OPTIONS["display
+00012fe0: 5f73 7479 6c65 225d 203d 3d20 2274 6578  _style"] == "tex
+00012ff0: 7422 3a0a 2020 2020 2020 2020 2020 2020  t":.            
+00013000: 7265 7475 726e 2066 223c 7072 653e 7b65  return f"<pre>{e
+00013010: 7363 6170 6528 7265 7072 2873 656c 6629  scape(repr(self)
+00013020: 297d 3c2f 7072 653e 220a 2020 2020 2020  )}</pre>".      
+00013030: 2020 7265 7475 726e 2066 6f72 6d61 7474    return formatt
+00013040: 696e 675f 6874 6d6c 2e64 6174 6173 6574  ing_html.dataset
+00013050: 5f72 6570 7228 7365 6c66 290a 0a20 2020  _repr(self)..   
+00013060: 2064 6566 2069 6e66 6f28 7365 6c66 2c20   def info(self, 
+00013070: 6275 663a 2049 4f20 7c20 4e6f 6e65 203d  buf: IO | None =
+00013080: 204e 6f6e 6529 202d 3e20 4e6f 6e65 3a0a   None) -> None:.
+00013090: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000130a0: 2020 2020 436f 6e63 6973 6520 7375 6d6d      Concise summ
+000130b0: 6172 7920 6f66 2061 2044 6174 6173 6574  ary of a Dataset
+000130c0: 2076 6172 6961 626c 6573 2061 6e64 2061   variables and a
+000130d0: 7474 7269 6275 7465 732e 0a0a 2020 2020  ttributes...    
+000130e0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+000130f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00013100: 2d0a 2020 2020 2020 2020 6275 6620 3a20  -.        buf : 
+00013110: 6669 6c65 2d6c 696b 652c 2064 6566 6175  file-like, defau
+00013120: 6c74 3a20 7379 732e 7374 646f 7574 0a20  lt: sys.stdout. 
+00013130: 2020 2020 2020 2020 2020 2077 7269 7461             writa
+00013140: 626c 6520 6275 6666 6572 0a0a 2020 2020  ble buffer..    
+00013150: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00013160: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00013170: 2020 2020 2020 7061 6e64 6173 2e44 6174        pandas.Dat
+00013180: 6146 7261 6d65 2e61 7373 6967 6e0a 2020  aFrame.assign.  
+00013190: 2020 2020 2020 6e63 6475 6d70 203a 206e        ncdump : n
+000131a0: 6574 4344 4627 7320 6e63 6475 6d70 0a20  etCDF's ncdump. 
+000131b0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000131c0: 2020 2069 6620 6275 6620 6973 204e 6f6e     if buf is Non
+000131d0: 653a 2020 2320 7072 6167 6d61 3a20 6e6f  e:  # pragma: no
+000131e0: 2063 6f76 6572 0a20 2020 2020 2020 2020   cover.         
+000131f0: 2020 2062 7566 203d 2073 7973 2e73 7464     buf = sys.std
+00013200: 6f75 740a 0a20 2020 2020 2020 206c 696e  out..        lin
+00013210: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
+00013220: 6c69 6e65 732e 6170 7065 6e64 2822 7861  lines.append("xa
+00013230: 7272 6179 2e44 6174 6173 6574 207b 2229  rray.Dataset {")
+00013240: 0a20 2020 2020 2020 206c 696e 6573 2e61  .        lines.a
+00013250: 7070 656e 6428 2264 696d 656e 7369 6f6e  ppend("dimension
+00013260: 733a 2229 0a20 2020 2020 2020 2066 6f72  s:").        for
+00013270: 206e 616d 652c 2073 697a 6520 696e 2073   name, size in s
+00013280: 656c 662e 6469 6d73 2e69 7465 6d73 2829  elf.dims.items()
+00013290: 3a0a 2020 2020 2020 2020 2020 2020 6c69  :.            li
+000132a0: 6e65 732e 6170 7065 6e64 2866 225c 747b  nes.append(f"\t{
+000132b0: 6e61 6d65 7d20 3d20 7b73 697a 657d 203b  name} = {size} ;
+000132c0: 2229 0a20 2020 2020 2020 206c 696e 6573  ").        lines
+000132d0: 2e61 7070 656e 6428 225c 6e76 6172 6961  .append("\nvaria
+000132e0: 626c 6573 3a22 290a 2020 2020 2020 2020  bles:").        
+000132f0: 666f 7220 6e61 6d65 2c20 6461 2069 6e20  for name, da in 
+00013300: 7365 6c66 2e76 6172 6961 626c 6573 2e69  self.variables.i
+00013310: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+00013320: 2020 2020 6469 6d73 203d 2022 2c20 222e      dims = ", ".
+00013330: 6a6f 696e 286d 6170 2873 7472 2c20 6461  join(map(str, da
+00013340: 2e64 696d 7329 290a 2020 2020 2020 2020  .dims)).        
+00013350: 2020 2020 6c69 6e65 732e 6170 7065 6e64      lines.append
+00013360: 2866 225c 747b 6461 2e64 7479 7065 7d20  (f"\t{da.dtype} 
+00013370: 7b6e 616d 657d 287b 6469 6d73 7d29 203b  {name}({dims}) ;
+00013380: 2229 0a20 2020 2020 2020 2020 2020 2066  ").            f
+00013390: 6f72 206b 2c20 7620 696e 2064 612e 6174  or k, v in da.at
+000133a0: 7472 732e 6974 656d 7328 293a 0a20 2020  trs.items():.   
+000133b0: 2020 2020 2020 2020 2020 2020 206c 696e               lin
+000133c0: 6573 2e61 7070 656e 6428 6622 5c74 5c74  es.append(f"\t\t
+000133d0: 7b6e 616d 657d 3a7b 6b7d 203d 207b 767d  {name}:{k} = {v}
+000133e0: 203b 2229 0a20 2020 2020 2020 206c 696e   ;").        lin
+000133f0: 6573 2e61 7070 656e 6428 225c 6e2f 2f20  es.append("\n// 
+00013400: 676c 6f62 616c 2061 7474 7269 6275 7465  global attribute
+00013410: 733a 2229 0a20 2020 2020 2020 2066 6f72  s:").        for
+00013420: 206b 2c20 7620 696e 2073 656c 662e 6174   k, v in self.at
+00013430: 7472 732e 6974 656d 7328 293a 0a20 2020  trs.items():.   
+00013440: 2020 2020 2020 2020 206c 696e 6573 2e61           lines.a
+00013450: 7070 656e 6428 6622 5c74 3a7b 6b7d 203d  ppend(f"\t:{k} =
+00013460: 207b 767d 203b 2229 0a20 2020 2020 2020   {v} ;").       
+00013470: 206c 696e 6573 2e61 7070 656e 6428 227d   lines.append("}
+00013480: 2229 0a0a 2020 2020 2020 2020 6275 662e  ")..        buf.
+00013490: 7772 6974 6528 225c 6e22 2e6a 6f69 6e28  write("\n".join(
+000134a0: 6c69 6e65 7329 290a 0a20 2020 2040 7072  lines))..    @pr
+000134b0: 6f70 6572 7479 0a20 2020 2064 6566 2063  operty.    def c
+000134c0: 6875 6e6b 7328 7365 6c66 2920 2d3e 204d  hunks(self) -> M
+000134d0: 6170 7069 6e67 5b48 6173 6861 626c 652c  apping[Hashable,
+000134e0: 2074 7570 6c65 5b69 6e74 2c20 2e2e 2e5d   tuple[int, ...]
+000134f0: 5d3a 0a20 2020 2020 2020 2022 2222 0a20  ]:.        """. 
+00013500: 2020 2020 2020 204d 6170 7069 6e67 2066         Mapping f
+00013510: 726f 6d20 6469 6d65 6e73 696f 6e20 6e61  rom dimension na
+00013520: 6d65 7320 746f 2062 6c6f 636b 206c 656e  mes to block len
+00013530: 6774 6873 2066 6f72 2074 6869 7320 6461  gths for this da
+00013540: 7461 7365 7427 7320 6461 7461 2c20 6f72  taset's data, or
+00013550: 204e 6f6e 6520 6966 0a20 2020 2020 2020   None if.       
+00013560: 2074 6865 2075 6e64 6572 6c79 696e 6720   the underlying 
+00013570: 6461 7461 2069 7320 6e6f 7420 6120 6461  data is not a da
+00013580: 736b 2061 7272 6179 2e0a 2020 2020 2020  sk array..      
+00013590: 2020 4361 6e6e 6f74 2062 6520 6d6f 6469    Cannot be modi
+000135a0: 6669 6564 2064 6972 6563 746c 792c 2062  fied directly, b
+000135b0: 7574 2063 616e 2062 6520 6d6f 6469 6669  ut can be modifi
+000135c0: 6564 2062 7920 6361 6c6c 696e 6720 2e63  ed by calling .c
+000135d0: 6875 6e6b 2829 2e0a 0a20 2020 2020 2020  hunk()...       
+000135e0: 2053 616d 6520 6173 2044 6174 6173 6574   Same as Dataset
+000135f0: 2e63 6875 6e6b 7369 7a65 732c 2062 7574  .chunksizes, but
+00013600: 206d 6169 6e74 6169 6e65 6420 666f 7220   maintained for 
+00013610: 6261 636b 7761 7264 7320 636f 6d70 6174  backwards compat
+00013620: 6962 696c 6974 792e 0a0a 2020 2020 2020  ibility...      
+00013630: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+00013640: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00013650: 2020 2020 4461 7461 7365 742e 6368 756e      Dataset.chun
+00013660: 6b0a 2020 2020 2020 2020 4461 7461 7365  k.        Datase
+00013670: 742e 6368 756e 6b73 697a 6573 0a20 2020  t.chunksizes.   
+00013680: 2020 2020 2078 6172 7261 792e 756e 6966       xarray.unif
+00013690: 795f 6368 756e 6b73 0a20 2020 2020 2020  y_chunks.       
+000136a0: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+000136b0: 7572 6e20 6765 745f 6368 756e 6b73 697a  urn get_chunksiz
+000136c0: 6573 2873 656c 662e 7661 7269 6162 6c65  es(self.variable
+000136d0: 732e 7661 6c75 6573 2829 290a 0a20 2020  s.values())..   
+000136e0: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+000136f0: 6566 2063 6875 6e6b 7369 7a65 7328 7365  ef chunksizes(se
+00013700: 6c66 2920 2d3e 204d 6170 7069 6e67 5b48  lf) -> Mapping[H
+00013710: 6173 6861 626c 652c 2074 7570 6c65 5b69  ashable, tuple[i
+00013720: 6e74 2c20 2e2e 2e5d 5d3a 0a20 2020 2020  nt, ...]]:.     
+00013730: 2020 2022 2222 0a20 2020 2020 2020 204d     """.        M
+00013740: 6170 7069 6e67 2066 726f 6d20 6469 6d65  apping from dime
+00013750: 6e73 696f 6e20 6e61 6d65 7320 746f 2062  nsion names to b
+00013760: 6c6f 636b 206c 656e 6774 6873 2066 6f72  lock lengths for
+00013770: 2074 6869 7320 6461 7461 7365 7427 7320   this dataset's 
+00013780: 6461 7461 2c20 6f72 204e 6f6e 6520 6966  data, or None if
+00013790: 0a20 2020 2020 2020 2074 6865 2075 6e64  .        the und
+000137a0: 6572 6c79 696e 6720 6461 7461 2069 7320  erlying data is 
+000137b0: 6e6f 7420 6120 6461 736b 2061 7272 6179  not a dask array
+000137c0: 2e0a 2020 2020 2020 2020 4361 6e6e 6f74  ..        Cannot
+000137d0: 2062 6520 6d6f 6469 6669 6564 2064 6972   be modified dir
+000137e0: 6563 746c 792c 2062 7574 2063 616e 2062  ectly, but can b
+000137f0: 6520 6d6f 6469 6669 6564 2062 7920 6361  e modified by ca
+00013800: 6c6c 696e 6720 2e63 6875 6e6b 2829 2e0a  lling .chunk()..
+00013810: 0a20 2020 2020 2020 2053 616d 6520 6173  .        Same as
+00013820: 2044 6174 6173 6574 2e63 6875 6e6b 732e   Dataset.chunks.
+00013830: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00013840: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+00013850: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+00013860: 7365 742e 6368 756e 6b0a 2020 2020 2020  set.chunk.      
+00013870: 2020 4461 7461 7365 742e 6368 756e 6b73    Dataset.chunks
+00013880: 0a20 2020 2020 2020 2078 6172 7261 792e  .        xarray.
+00013890: 756e 6966 795f 6368 756e 6b73 0a20 2020  unify_chunks.   
+000138a0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000138b0: 2072 6574 7572 6e20 6765 745f 6368 756e   return get_chun
+000138c0: 6b73 697a 6573 2873 656c 662e 7661 7269  ksizes(self.vari
+000138d0: 6162 6c65 732e 7661 6c75 6573 2829 290a  ables.values()).
+000138e0: 0a20 2020 2064 6566 2063 6875 6e6b 280a  .    def chunk(.
+000138f0: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
+00013900: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
+00013910: 2063 6875 6e6b 733a 2028 0a20 2020 2020   chunks: (.     
+00013920: 2020 2020 2020 2069 6e74 207c 204c 6974         int | Lit
+00013930: 6572 616c 5b22 6175 746f 225d 207c 204d  eral["auto"] | M
+00013940: 6170 7069 6e67 5b41 6e79 2c20 4e6f 6e65  apping[Any, None
+00013950: 207c 2069 6e74 207c 2073 7472 207c 2074   | int | str | t
+00013960: 7570 6c65 5b69 6e74 2c20 2e2e 2e5d 5d0a  uple[int, ...]].
+00013970: 2020 2020 2020 2020 2920 3d20 7b7d 2c20          ) = {}, 
+00013980: 2023 207b 7d20 6576 656e 2074 686f 7567   # {} even thoug
+00013990: 6820 6974 2773 2074 6563 686e 6963 616c  h it's technical
+000139a0: 6c79 2075 6e73 6166 652c 2069 7320 6265  ly unsafe, is be
+000139b0: 696e 6720 7573 6564 2069 6e74 656e 7469  ing used intenti
+000139c0: 6f6e 616c 6c79 2068 6572 6520 2823 3436  onally here (#46
+000139d0: 3637 290a 2020 2020 2020 2020 6e61 6d65  67).        name
+000139e0: 5f70 7265 6669 783a 2073 7472 203d 2022  _prefix: str = "
+000139f0: 7861 7272 6179 2d22 2c0a 2020 2020 2020  xarray-",.      
+00013a00: 2020 746f 6b65 6e3a 2073 7472 207c 204e    token: str | N
+00013a10: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+00013a20: 2020 2020 6c6f 636b 3a20 626f 6f6c 203d      lock: bool =
+00013a30: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
+00013a40: 696e 6c69 6e65 5f61 7272 6179 3a20 626f  inline_array: bo
+00013a50: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00013a60: 2020 2020 6368 756e 6b65 645f 6172 7261      chunked_arra
+00013a70: 795f 7479 7065 3a20 7374 7220 7c20 4368  y_type: str | Ch
+00013a80: 756e 6b4d 616e 6167 6572 456e 7472 7970  unkManagerEntryp
+00013a90: 6f69 6e74 207c 204e 6f6e 6520 3d20 4e6f  oint | None = No
+00013aa0: 6e65 2c0a 2020 2020 2020 2020 6672 6f6d  ne,.        from
+00013ab0: 5f61 7272 6179 5f6b 7761 7267 733d 4e6f  _array_kwargs=No
+00013ac0: 6e65 2c0a 2020 2020 2020 2020 2a2a 6368  ne,.        **ch
+00013ad0: 756e 6b73 5f6b 7761 7267 733a 204e 6f6e  unks_kwargs: Non
+00013ae0: 6520 7c20 696e 7420 7c20 7374 7220 7c20  e | int | str | 
+00013af0: 7475 706c 655b 696e 742c 202e 2e2e 5d2c  tuple[int, ...],
+00013b00: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
+00013b10: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+00013b20: 436f 6572 6365 2061 6c6c 2061 7272 6179  Coerce all array
+00013b30: 7320 696e 2074 6869 7320 6461 7461 7365  s in this datase
+00013b40: 7420 696e 746f 2064 6173 6b20 6172 7261  t into dask arra
+00013b50: 7973 2077 6974 6820 7468 6520 6769 7665  ys with the give
+00013b60: 6e0a 2020 2020 2020 2020 6368 756e 6b73  n.        chunks
+00013b70: 2e0a 0a20 2020 2020 2020 204e 6f6e 2d64  ...        Non-d
+00013b80: 6173 6b20 6172 7261 7973 2069 6e20 7468  ask arrays in th
+00013b90: 6973 2064 6174 6173 6574 2077 696c 6c20  is dataset will 
+00013ba0: 6265 2063 6f6e 7665 7274 6564 2074 6f20  be converted to 
+00013bb0: 6461 736b 2061 7272 6179 732e 2044 6173  dask arrays. Das
+00013bc0: 6b0a 2020 2020 2020 2020 6172 7261 7973  k.        arrays
+00013bd0: 2077 696c 6c20 6265 2072 6563 6875 6e6b   will be rechunk
+00013be0: 6564 2074 6f20 7468 6520 6769 7665 6e20  ed to the given 
+00013bf0: 6368 756e 6b20 7369 7a65 732e 0a0a 2020  chunk sizes...  
+00013c00: 2020 2020 2020 4966 206e 6569 7468 6572        If neither
+00013c10: 2063 6875 6e6b 7320 6973 206e 6f74 2070   chunks is not p
+00013c20: 726f 7669 6465 6420 666f 7220 6f6e 6520  rovided for one 
+00013c30: 6f72 206d 6f72 6520 6469 6d65 6e73 696f  or more dimensio
+00013c40: 6e73 2c20 6368 756e 6b0a 2020 2020 2020  ns, chunk.      
+00013c50: 2020 7369 7a65 7320 616c 6f6e 6720 7468    sizes along th
+00013c60: 6174 2064 696d 656e 7369 6f6e 2077 696c  at dimension wil
+00013c70: 6c20 6e6f 7420 6265 2075 7064 6174 6564  l not be updated
+00013c80: 3b20 6e6f 6e2d 6461 736b 2061 7272 6179  ; non-dask array
+00013c90: 7320 7769 6c6c 2062 650a 2020 2020 2020  s will be.      
+00013ca0: 2020 636f 6e76 6572 7465 6420 696e 746f    converted into
+00013cb0: 2064 6173 6b20 6172 7261 7973 2077 6974   dask arrays wit
+00013cc0: 6820 6120 7369 6e67 6c65 2062 6c6f 636b  h a single block
+00013cd0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00013ce0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00013cf0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00013d00: 2063 6875 6e6b 7320 3a20 696e 742c 2074   chunks : int, t
+00013d10: 7570 6c65 206f 6620 696e 742c 2022 6175  uple of int, "au
+00013d20: 746f 2220 6f72 206d 6170 7069 6e67 206f  to" or mapping o
+00013d30: 6620 6861 7368 6162 6c65 2074 6f20 696e  f hashable to in
+00013d40: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
+00013d50: 2020 2020 2020 2020 4368 756e 6b20 7369          Chunk si
+00013d60: 7a65 7320 616c 6f6e 6720 6561 6368 2064  zes along each d
+00013d70: 696d 656e 7369 6f6e 2c20 652e 672e 2c20  imension, e.g., 
+00013d80: 6060 3560 602c 2060 6022 6175 746f 2260  ``5``, ``"auto"`
+00013d90: 602c 206f 720a 2020 2020 2020 2020 2020  `, or.          
+00013da0: 2020 6060 7b22 7822 3a20 352c 2022 7922    ``{"x": 5, "y"
+00013db0: 3a20 357d 6060 2e0a 2020 2020 2020 2020  : 5}``..        
+00013dc0: 6e61 6d65 5f70 7265 6669 7820 3a20 7374  name_prefix : st
+00013dd0: 722c 2064 6566 6175 6c74 3a20 2278 6172  r, default: "xar
+00013de0: 7261 792d 220a 2020 2020 2020 2020 2020  ray-".          
+00013df0: 2020 5072 6566 6978 2066 6f72 2074 6865    Prefix for the
+00013e00: 206e 616d 6520 6f66 2061 6e79 206e 6577   name of any new
+00013e10: 2064 6173 6b20 6172 7261 7973 2e0a 2020   dask arrays..  
+00013e20: 2020 2020 2020 746f 6b65 6e20 3a20 7374        token : st
+00013e30: 722c 206f 7074 696f 6e61 6c0a 2020 2020  r, optional.    
+00013e40: 2020 2020 2020 2020 546f 6b65 6e20 756e          Token un
+00013e50: 6971 7565 6c79 2069 6465 6e74 6966 7969  iquely identifyi
+00013e60: 6e67 2074 6869 7320 6461 7461 7365 742e  ng this dataset.
+00013e70: 0a20 2020 2020 2020 206c 6f63 6b20 3a20  .        lock : 
+00013e80: 626f 6f6c 2c20 6465 6661 756c 743a 2046  bool, default: F
+00013e90: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00013ea0: 2050 6173 7365 6420 6f6e 2074 6f20 3a70   Passed on to :p
+00013eb0: 793a 6675 6e63 3a60 6461 736b 2e61 7272  y:func:`dask.arr
+00013ec0: 6179 2e66 726f 6d5f 6172 7261 7960 2c20  ay.from_array`, 
+00013ed0: 6966 2074 6865 2061 7272 6179 2069 7320  if the array is 
+00013ee0: 6e6f 740a 2020 2020 2020 2020 2020 2020  not.            
+00013ef0: 616c 7265 6164 7920 6173 2064 6173 6b20  already as dask 
+00013f00: 6172 7261 792e 0a20 2020 2020 2020 2069  array..        i
+00013f10: 6e6c 696e 655f 6172 7261 793a 2062 6f6f  nline_array: boo
+00013f20: 6c2c 2064 6566 6175 6c74 3a20 4661 6c73  l, default: Fals
+00013f30: 650a 2020 2020 2020 2020 2020 2020 5061  e.            Pa
+00013f40: 7373 6564 206f 6e20 746f 203a 7079 3a66  ssed on to :py:f
+00013f50: 756e 633a 6064 6173 6b2e 6172 7261 792e  unc:`dask.array.
+00013f60: 6672 6f6d 5f61 7272 6179 602c 2069 6620  from_array`, if 
+00013f70: 7468 6520 6172 7261 7920 6973 206e 6f74  the array is not
+00013f80: 0a20 2020 2020 2020 2020 2020 2061 6c72  .            alr
+00013f90: 6561 6479 2061 7320 6461 736b 2061 7272  eady as dask arr
+00013fa0: 6179 2e0a 2020 2020 2020 2020 6368 756e  ay..        chun
+00013fb0: 6b65 645f 6172 7261 795f 7479 7065 3a20  ked_array_type: 
+00013fc0: 7374 722c 206f 7074 696f 6e61 6c0a 2020  str, optional.  
+00013fd0: 2020 2020 2020 2020 2020 5768 6963 6820            Which 
+00013fe0: 6368 756e 6b65 6420 6172 7261 7920 7479  chunked array ty
+00013ff0: 7065 2074 6f20 636f 6572 6365 2074 6869  pe to coerce thi
+00014000: 7320 6461 7461 7365 7473 2720 6172 7261  s datasets' arra
+00014010: 7973 2074 6f2e 0a20 2020 2020 2020 2020  ys to..         
+00014020: 2020 2044 6566 6175 6c74 7320 746f 2027     Defaults to '
+00014030: 6461 736b 2720 6966 2069 6e73 7461 6c6c  dask' if install
+00014040: 6564 2c20 656c 7365 2077 6861 7465 7665  ed, else whateve
+00014050: 7220 6973 2072 6567 6973 7465 7265 6420  r is registered 
+00014060: 7669 6120 7468 6520 6043 6875 6e6b 4d61  via the `ChunkMa
+00014070: 6e61 6765 7245 6e65 7472 7950 6f69 6e74  nagerEnetryPoint
+00014080: 6020 7379 7374 656d 2e0a 2020 2020 2020  ` system..      
+00014090: 2020 2020 2020 4578 7065 7269 6d65 6e74        Experiment
+000140a0: 616c 2041 5049 2074 6861 7420 7368 6f75  al API that shou
+000140b0: 6c64 206e 6f74 2062 6520 7265 6c69 6564  ld not be relied
+000140c0: 2075 706f 6e2e 0a20 2020 2020 2020 2066   upon..        f
+000140d0: 726f 6d5f 6172 7261 795f 6b77 6172 6773  rom_array_kwargs
+000140e0: 3a20 6469 6374 2c20 6f70 7469 6f6e 616c  : dict, optional
+000140f0: 0a20 2020 2020 2020 2020 2020 2041 6464  .            Add
+00014100: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
+00014110: 6172 6775 6d65 6e74 7320 7061 7373 6564  arguments passed
+00014120: 206f 6e20 746f 2074 6865 2060 4368 756e   on to the `Chun
+00014130: 6b4d 616e 6167 6572 456e 7472 7970 6f69  kManagerEntrypoi
+00014140: 6e74 2e66 726f 6d5f 6172 7261 7960 206d  nt.from_array` m
+00014150: 6574 686f 6420 7573 6564 2074 6f20 6372  ethod used to cr
+00014160: 6561 7465 0a20 2020 2020 2020 2020 2020  eate.           
+00014170: 2063 6875 6e6b 6564 2061 7272 6179 732c   chunked arrays,
+00014180: 2076 6961 2077 6869 6368 6576 6572 2063   via whichever c
+00014190: 6875 6e6b 206d 616e 6167 6572 2069 7320  hunk manager is 
+000141a0: 7370 6563 6966 6965 6420 7468 726f 7567  specified throug
+000141b0: 6820 7468 6520 6063 6875 6e6b 6564 5f61  h the `chunked_a
+000141c0: 7272 6179 5f74 7970 6560 206b 7761 7267  rray_type` kwarg
+000141d0: 2e0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
+000141e0: 7220 6578 616d 706c 652c 2077 6974 6820  r example, with 
+000141f0: 6461 736b 2061 7320 7468 6520 6465 6661  dask as the defa
+00014200: 756c 7420 6368 756e 6b65 6420 6172 7261  ult chunked arra
+00014210: 7920 7479 7065 2c20 7468 6973 206d 6574  y type, this met
+00014220: 686f 6420 776f 756c 6420 7061 7373 2061  hod would pass a
+00014230: 6464 6974 696f 6e61 6c20 6b77 6172 6773  dditional kwargs
+00014240: 0a20 2020 2020 2020 2020 2020 2074 6f20  .            to 
+00014250: 3a70 793a 6675 6e63 3a60 6461 736b 2e61  :py:func:`dask.a
+00014260: 7272 6179 2e66 726f 6d5f 6172 7261 7960  rray.from_array`
+00014270: 2e20 4578 7065 7269 6d65 6e74 616c 2041  . Experimental A
+00014280: 5049 2074 6861 7420 7368 6f75 6c64 206e  PI that should n
+00014290: 6f74 2062 6520 7265 6c69 6564 2075 706f  ot be relied upo
+000142a0: 6e2e 0a20 2020 2020 2020 202a 2a63 6875  n..        **chu
+000142b0: 6e6b 735f 6b77 6172 6773 203a 207b 6469  nks_kwargs : {di
+000142c0: 6d3a 2063 6875 6e6b 732c 202e 2e2e 7d2c  m: chunks, ...},
+000142d0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+000142e0: 2020 2020 2020 5468 6520 6b65 7977 6f72        The keywor
+000142f0: 6420 6172 6775 6d65 6e74 7320 666f 726d  d arguments form
+00014300: 206f 6620 6060 6368 756e 6b73 6060 2e0a   of ``chunks``..
+00014310: 2020 2020 2020 2020 2020 2020 4f6e 6520              One 
+00014320: 6f66 2063 6875 6e6b 7320 6f72 2063 6875  of chunks or chu
+00014330: 6e6b 735f 6b77 6172 6773 206d 7573 7420  nks_kwargs must 
+00014340: 6265 2070 726f 7669 6465 640a 0a20 2020  be provided..   
+00014350: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+00014360: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00014370: 2020 2020 2063 6875 6e6b 6564 203a 2078       chunked : x
+00014380: 6172 7261 792e 4461 7461 7365 740a 0a20  array.Dataset.. 
+00014390: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+000143a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000143b0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
+000143c0: 2e63 6875 6e6b 730a 2020 2020 2020 2020  .chunks.        
+000143d0: 4461 7461 7365 742e 6368 756e 6b73 697a  Dataset.chunksiz
+000143e0: 6573 0a20 2020 2020 2020 2078 6172 7261  es.        xarra
+000143f0: 792e 756e 6966 795f 6368 756e 6b73 0a20  y.unify_chunks. 
+00014400: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
+00014410: 792e 6672 6f6d 5f61 7272 6179 0a20 2020  y.from_array.   
+00014420: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00014430: 2069 6620 6368 756e 6b73 2069 7320 4e6f   if chunks is No
+00014440: 6e65 2061 6e64 2063 6875 6e6b 735f 6b77  ne and chunks_kw
+00014450: 6172 6773 2069 7320 4e6f 6e65 3a0a 2020  args is None:.  
+00014460: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+00014470: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00014480: 2020 2020 2020 2020 2022 4e6f 6e65 2076           "None v
+00014490: 616c 7565 2066 6f72 2027 6368 756e 6b73  alue for 'chunks
+000144a0: 2720 6973 2064 6570 7265 6361 7465 642e  ' is deprecated.
+000144b0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+000144c0: 2020 2022 4974 2077 696c 6c20 7261 6973     "It will rais
+000144d0: 6520 616e 2065 7272 6f72 2069 6e20 7468  e an error in th
+000144e0: 6520 6675 7475 7265 2e20 5573 6520 696e  e future. Use in
+000144f0: 7374 6561 6420 277b 7d27 222c 0a20 2020  stead '{}'",.   
+00014500: 2020 2020 2020 2020 2020 2020 2063 6174               cat
+00014510: 6567 6f72 793d 4675 7475 7265 5761 726e  egory=FutureWarn
+00014520: 696e 672c 0a20 2020 2020 2020 2020 2020  ing,.           
+00014530: 2029 0a20 2020 2020 2020 2020 2020 2063   ).            c
+00014540: 6875 6e6b 7320 3d20 7b7d 0a0a 2020 2020  hunks = {}..    
+00014550: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00014560: 6528 6368 756e 6b73 2c20 284e 756d 6265  e(chunks, (Numbe
+00014570: 722c 2073 7472 2c20 696e 7429 293a 0a20  r, str, int)):. 
+00014580: 2020 2020 2020 2020 2020 2063 6875 6e6b             chunk
+00014590: 7320 3d20 6469 6374 2e66 726f 6d6b 6579  s = dict.fromkey
+000145a0: 7328 7365 6c66 2e64 696d 732c 2063 6875  s(self.dims, chu
+000145b0: 6e6b 7329 0a20 2020 2020 2020 2065 6c73  nks).        els
+000145c0: 653a 0a20 2020 2020 2020 2020 2020 2063  e:.            c
+000145d0: 6875 6e6b 7320 3d20 6569 7468 6572 5f64  hunks = either_d
+000145e0: 6963 745f 6f72 5f6b 7761 7267 7328 6368  ict_or_kwargs(ch
+000145f0: 756e 6b73 2c20 6368 756e 6b73 5f6b 7761  unks, chunks_kwa
+00014600: 7267 732c 2022 6368 756e 6b22 290a 0a20  rgs, "chunk").. 
+00014610: 2020 2020 2020 2062 6164 5f64 696d 7320         bad_dims 
+00014620: 3d20 6368 756e 6b73 2e6b 6579 7328 2920  = chunks.keys() 
+00014630: 2d20 7365 6c66 2e64 696d 732e 6b65 7973  - self.dims.keys
+00014640: 2829 0a20 2020 2020 2020 2069 6620 6261  ().        if ba
+00014650: 645f 6469 6d73 3a0a 2020 2020 2020 2020  d_dims:.        
+00014660: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00014670: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00014680: 2020 2020 2020 6622 736f 6d65 2063 6875        f"some chu
+00014690: 6e6b 7320 6b65 7973 2061 7265 206e 6f74  nks keys are not
+000146a0: 2064 696d 656e 7369 6f6e 7320 6f6e 2074   dimensions on t
+000146b0: 6869 7320 6f62 6a65 6374 3a20 7b62 6164  his object: {bad
+000146c0: 5f64 696d 737d 220a 2020 2020 2020 2020  _dims}".        
+000146d0: 2020 2020 290a 0a20 2020 2020 2020 2063      )..        c
+000146e0: 6875 6e6b 6d61 6e61 6765 7220 3d20 6775  hunkmanager = gu
+000146f0: 6573 735f 6368 756e 6b6d 616e 6167 6572  ess_chunkmanager
+00014700: 2863 6875 6e6b 6564 5f61 7272 6179 5f74  (chunked_array_t
+00014710: 7970 6529 0a20 2020 2020 2020 2069 6620  ype).        if 
+00014720: 6672 6f6d 5f61 7272 6179 5f6b 7761 7267  from_array_kwarg
+00014730: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+00014740: 2020 2020 2020 2066 726f 6d5f 6172 7261         from_arra
+00014750: 795f 6b77 6172 6773 203d 207b 7d0a 0a20  y_kwargs = {}.. 
+00014760: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+00014770: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00014780: 206b 3a20 5f6d 6179 6265 5f63 6875 6e6b   k: _maybe_chunk
+00014790: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000147a0: 2020 6b2c 0a20 2020 2020 2020 2020 2020    k,.           
+000147b0: 2020 2020 2076 2c0a 2020 2020 2020 2020       v,.        
+000147c0: 2020 2020 2020 2020 6368 756e 6b73 2c0a          chunks,.
+000147d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000147e0: 746f 6b65 6e2c 0a20 2020 2020 2020 2020  token,.         
+000147f0: 2020 2020 2020 206c 6f63 6b2c 0a20 2020         lock,.   
+00014800: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+00014810: 655f 7072 6566 6978 2c0a 2020 2020 2020  e_prefix,.      
+00014820: 2020 2020 2020 2020 2020 696e 6c69 6e65            inline
+00014830: 5f61 7272 6179 3d69 6e6c 696e 655f 6172  _array=inline_ar
+00014840: 7261 792c 0a20 2020 2020 2020 2020 2020  ray,.           
+00014850: 2020 2020 2063 6875 6e6b 6564 5f61 7272       chunked_arr
+00014860: 6179 5f74 7970 653d 6368 756e 6b6d 616e  ay_type=chunkman
+00014870: 6167 6572 2c0a 2020 2020 2020 2020 2020  ager,.          
+00014880: 2020 2020 2020 6672 6f6d 5f61 7272 6179        from_array
+00014890: 5f6b 7761 7267 733d 6672 6f6d 5f61 7272  _kwargs=from_arr
+000148a0: 6179 5f6b 7761 7267 732e 636f 7079 2829  ay_kwargs.copy()
+000148b0: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+000148c0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000148d0: 6b2c 2076 2069 6e20 7365 6c66 2e76 6172  k, v in self.var
+000148e0: 6961 626c 6573 2e69 7465 6d73 2829 0a20  iables.items(). 
+000148f0: 2020 2020 2020 207d 0a20 2020 2020 2020         }.       
+00014900: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
+00014910: 706c 6163 6528 7661 7269 6162 6c65 7329  place(variables)
+00014920: 0a0a 2020 2020 6465 6620 5f76 616c 6964  ..    def _valid
+00014930: 6174 655f 696e 6465 7865 7273 280a 2020  ate_indexers(.  
+00014940: 2020 2020 2020 7365 6c66 2c20 696e 6465        self, inde
+00014950: 7865 7273 3a20 4d61 7070 696e 675b 416e  xers: Mapping[An
+00014960: 792c 2041 6e79 5d2c 206d 6973 7369 6e67  y, Any], missing
+00014970: 5f64 696d 733a 2045 7272 6f72 4f70 7469  _dims: ErrorOpti
+00014980: 6f6e 7357 6974 6857 6172 6e20 3d20 2272  onsWithWarn = "r
+00014990: 6169 7365 220a 2020 2020 2920 2d3e 2049  aise".    ) -> I
+000149a0: 7465 7261 746f 725b 7475 706c 655b 4861  terator[tuple[Ha
+000149b0: 7368 6162 6c65 2c20 696e 7420 7c20 736c  shable, int | sl
+000149c0: 6963 6520 7c20 6e70 2e6e 6461 7272 6179  ice | np.ndarray
+000149d0: 207c 2056 6172 6961 626c 655d 5d3a 0a20   | Variable]]:. 
+000149e0: 2020 2020 2020 2022 2222 4865 7265 2077         """Here w
+000149f0: 6520 6d61 6b65 2073 7572 650a 2020 2020  e make sure.    
+00014a00: 2020 2020 2b20 696e 6465 7865 7220 6861      + indexer ha
+00014a10: 7320 6120 7661 6c69 6420 6b65 7973 0a20  s a valid keys. 
+00014a20: 2020 2020 2020 202b 2069 6e64 6578 6572         + indexer
+00014a30: 2069 7320 696e 2061 2076 616c 6964 2064   is in a valid d
+00014a40: 6174 6120 7479 7065 0a20 2020 2020 2020  ata type.       
+00014a50: 202b 2073 7472 696e 6720 696e 6465 7865   + string indexe
+00014a60: 7273 2061 7265 2063 6173 7420 746f 2074  rs are cast to t
+00014a70: 6865 2061 7070 726f 7072 6961 7465 2064  he appropriate d
+00014a80: 6174 6520 7479 7065 2069 6620 7468 650a  ate type if the.
+00014a90: 2020 2020 2020 2020 2020 6173 736f 6369            associ
+00014aa0: 6174 6564 2069 6e64 6578 2069 7320 6120  ated index is a 
+00014ab0: 4461 7465 7469 6d65 496e 6465 7820 6f72  DatetimeIndex or
+00014ac0: 2043 4654 696d 6549 6e64 6578 0a20 2020   CFTimeIndex.   
+00014ad0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00014ae0: 2066 726f 6d20 7861 7272 6179 2e63 6f64   from xarray.cod
+00014af0: 696e 672e 6366 7469 6d65 696e 6465 7820  ing.cftimeindex 
+00014b00: 696d 706f 7274 2043 4654 696d 6549 6e64  import CFTimeInd
+00014b10: 6578 0a20 2020 2020 2020 2066 726f 6d20  ex.        from 
+00014b20: 7861 7272 6179 2e63 6f72 652e 6461 7461  xarray.core.data
+00014b30: 6172 7261 7920 696d 706f 7274 2044 6174  array import Dat
+00014b40: 6141 7272 6179 0a0a 2020 2020 2020 2020  aArray..        
+00014b50: 696e 6465 7865 7273 203d 2064 726f 705f  indexers = drop_
+00014b60: 6469 6d73 5f66 726f 6d5f 696e 6465 7865  dims_from_indexe
+00014b70: 7273 2869 6e64 6578 6572 732c 2073 656c  rs(indexers, sel
+00014b80: 662e 6469 6d73 2c20 6d69 7373 696e 675f  f.dims, missing_
+00014b90: 6469 6d73 290a 0a20 2020 2020 2020 2023  dims)..        #
+00014ba0: 2061 6c6c 2069 6e64 6578 6572 7320 7368   all indexers sh
+00014bb0: 6f75 6c64 2062 6520 696e 742c 2073 6c69  ould be int, sli
+00014bc0: 6365 2c20 6e70 2e6e 6461 7272 6179 732c  ce, np.ndarrays,
+00014bd0: 206f 7220 5661 7269 6162 6c65 0a20 2020   or Variable.   
+00014be0: 2020 2020 2066 6f72 206b 2c20 7620 696e       for k, v in
+00014bf0: 2069 6e64 6578 6572 732e 6974 656d 7328   indexers.items(
+00014c00: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00014c10: 6620 6973 696e 7374 616e 6365 2876 2c20  f isinstance(v, 
+00014c20: 2869 6e74 2c20 736c 6963 652c 2056 6172  (int, slice, Var
+00014c30: 6961 626c 6529 293a 0a20 2020 2020 2020  iable)):.       
+00014c40: 2020 2020 2020 2020 2079 6965 6c64 206b           yield k
+00014c50: 2c20 760a 2020 2020 2020 2020 2020 2020  , v.            
+00014c60: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00014c70: 762c 2044 6174 6141 7272 6179 293a 0a20  v, DataArray):. 
+00014c80: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00014c90: 6965 6c64 206b 2c20 762e 7661 7269 6162  ield k, v.variab
+00014ca0: 6c65 0a20 2020 2020 2020 2020 2020 2065  le.            e
+00014cb0: 6c69 6620 6973 696e 7374 616e 6365 2876  lif isinstance(v
+00014cc0: 2c20 7475 706c 6529 3a0a 2020 2020 2020  , tuple):.      
+00014cd0: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+00014ce0: 6b2c 2061 735f 7661 7269 6162 6c65 2876  k, as_variable(v
+00014cf0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00014d00: 6966 2069 7369 6e73 7461 6e63 6528 762c  if isinstance(v,
+00014d10: 2044 6174 6173 6574 293a 0a20 2020 2020   Dataset):.     
+00014d20: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00014d30: 2054 7970 6545 7272 6f72 2822 6361 6e6e   TypeError("cann
+00014d40: 6f74 2075 7365 2061 2044 6174 6173 6574  ot use a Dataset
+00014d50: 2061 7320 616e 2069 6e64 6578 6572 2229   as an indexer")
+00014d60: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00014d70: 6620 6973 696e 7374 616e 6365 2876 2c20  f isinstance(v, 
+00014d80: 5365 7175 656e 6365 2920 616e 6420 6c65  Sequence) and le
+00014d90: 6e28 7629 203d 3d20 303a 0a20 2020 2020  n(v) == 0:.     
+00014da0: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+00014db0: 206b 2c20 6e70 2e65 6d70 7479 2828 302c   k, np.empty((0,
+00014dc0: 292c 2064 7479 7065 3d22 696e 7436 3422  ), dtype="int64"
+00014dd0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00014de0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00014df0: 2020 2020 6966 206e 6f74 2069 735f 6475      if not is_du
+00014e00: 636b 5f61 7272 6179 2876 293a 0a20 2020  ck_array(v):.   
+00014e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e20: 2076 203d 206e 702e 6173 6172 7261 7928   v = np.asarray(
+00014e30: 7629 0a0a 2020 2020 2020 2020 2020 2020  v)..            
+00014e40: 2020 2020 6966 2076 2e64 7479 7065 2e6b      if v.dtype.k
+00014e50: 696e 6420 696e 2022 5553 223a 0a20 2020  ind in "US":.   
+00014e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e70: 2069 6e64 6578 203d 2073 656c 662e 5f69   index = self._i
+00014e80: 6e64 6578 6573 5b6b 5d2e 746f 5f70 616e  ndexes[k].to_pan
+00014e90: 6461 735f 696e 6465 7828 290a 2020 2020  das_index().    
+00014ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014eb0: 6966 2069 7369 6e73 7461 6e63 6528 696e  if isinstance(in
+00014ec0: 6465 782c 2070 642e 4461 7465 7469 6d65  dex, pd.Datetime
+00014ed0: 496e 6465 7829 3a0a 2020 2020 2020 2020  Index):.        
+00014ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ef0: 7620 3d20 6475 636b 5f61 7272 6179 5f6f  v = duck_array_o
+00014f00: 7073 2e61 7374 7970 6528 762c 2064 7479  ps.astype(v, dty
+00014f10: 7065 3d22 6461 7465 7469 6d65 3634 5b6e  pe="datetime64[n
+00014f20: 735d 2229 0a20 2020 2020 2020 2020 2020  s]").           
+00014f30: 2020 2020 2020 2020 2065 6c69 6620 6973           elif is
+00014f40: 696e 7374 616e 6365 2869 6e64 6578 2c20  instance(index, 
+00014f50: 4346 5469 6d65 496e 6465 7829 3a0a 2020  CFTimeIndex):.  
+00014f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014f70: 2020 2020 2020 7620 3d20 5f70 6172 7365        v = _parse
+00014f80: 5f61 7272 6179 5f6f 665f 6366 7469 6d65  _array_of_cftime
+00014f90: 5f73 7472 696e 6773 2876 2c20 696e 6465  _strings(v, inde
+00014fa0: 782e 6461 7465 5f74 7970 6529 0a0a 2020  x.date_type)..  
+00014fb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00014fc0: 2076 2e6e 6469 6d20 3e20 313a 0a20 2020   v.ndim > 1:.   
+00014fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014fe0: 2072 6169 7365 2049 6e64 6578 4572 726f   raise IndexErro
+00014ff0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00015000: 2020 2020 2020 2020 2020 2022 556e 6c61             "Unla
+00015010: 6265 6c65 6420 6d75 6c74 692d 6469 6d65  beled multi-dime
+00015020: 6e73 696f 6e61 6c20 6172 7261 7920 6361  nsional array ca
+00015030: 6e6e 6f74 2062 6520 220a 2020 2020 2020  nnot be ".      
+00015040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015050: 2020 2275 7365 6420 666f 7220 696e 6465    "used for inde
+00015060: 7869 6e67 3a20 7b7d 222e 666f 726d 6174  xing: {}".format
+00015070: 286b 290a 2020 2020 2020 2020 2020 2020  (k).            
+00015080: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00015090: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
+000150a0: 6b2c 2076 0a0a 2020 2020 6465 6620 5f76  k, v..    def _v
+000150b0: 616c 6964 6174 655f 696e 7465 7270 5f69  alidate_interp_i
+000150c0: 6e64 6578 6572 7328 0a20 2020 2020 2020  ndexers(.       
+000150d0: 2073 656c 662c 2069 6e64 6578 6572 733a   self, indexers:
+000150e0: 204d 6170 7069 6e67 5b41 6e79 2c20 416e   Mapping[Any, An
+000150f0: 795d 0a20 2020 2029 202d 3e20 4974 6572  y].    ) -> Iter
+00015100: 6174 6f72 5b74 7570 6c65 5b48 6173 6861  ator[tuple[Hasha
+00015110: 626c 652c 2056 6172 6961 626c 655d 5d3a  ble, Variable]]:
+00015120: 0a20 2020 2020 2020 2022 2222 5661 7269  .        """Vari
+00015130: 616e 7420 6f66 205f 7661 6c69 6461 7465  ant of _validate
+00015140: 5f69 6e64 6578 6572 7320 746f 2062 6520  _indexers to be 
+00015150: 7573 6564 2066 6f72 2069 6e74 6572 706f  used for interpo
+00015160: 6c61 7469 6f6e 2222 220a 2020 2020 2020  lation""".      
+00015170: 2020 666f 7220 6b2c 2076 2069 6e20 7365    for k, v in se
+00015180: 6c66 2e5f 7661 6c69 6461 7465 5f69 6e64  lf._validate_ind
+00015190: 6578 6572 7328 696e 6465 7865 7273 293a  exers(indexers):
+000151a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000151b0: 6973 696e 7374 616e 6365 2876 2c20 5661  isinstance(v, Va
+000151c0: 7269 6162 6c65 293a 0a20 2020 2020 2020  riable):.       
+000151d0: 2020 2020 2020 2020 2069 6620 762e 6e64           if v.nd
+000151e0: 696d 203d 3d20 313a 0a20 2020 2020 2020  im == 1:.       
+000151f0: 2020 2020 2020 2020 2020 2020 2079 6965               yie
+00015200: 6c64 206b 2c20 762e 746f 5f69 6e64 6578  ld k, v.to_index
+00015210: 5f76 6172 6961 626c 6528 290a 2020 2020  _variable().    
+00015220: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00015230: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00015240: 2020 2020 2020 7969 656c 6420 6b2c 2076        yield k, v
+00015250: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00015260: 6620 6973 696e 7374 616e 6365 2876 2c20  f isinstance(v, 
+00015270: 696e 7429 3a0a 2020 2020 2020 2020 2020  int):.          
+00015280: 2020 2020 2020 7969 656c 6420 6b2c 2056        yield k, V
+00015290: 6172 6961 626c 6528 2829 2c20 762c 2061  ariable((), v, a
+000152a0: 7474 7273 3d73 656c 662e 636f 6f72 6473  ttrs=self.coords
+000152b0: 5b6b 5d2e 6174 7472 7329 0a20 2020 2020  [k].attrs).     
+000152c0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+000152d0: 7374 616e 6365 2876 2c20 6e70 2e6e 6461  stance(v, np.nda
+000152e0: 7272 6179 293a 0a20 2020 2020 2020 2020  rray):.         
+000152f0: 2020 2020 2020 2069 6620 762e 6e64 696d         if v.ndim
+00015300: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00015310: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
+00015320: 206b 2c20 5661 7269 6162 6c65 2828 292c   k, Variable((),
+00015330: 2076 2c20 6174 7472 733d 7365 6c66 2e63   v, attrs=self.c
+00015340: 6f6f 7264 735b 6b5d 2e61 7474 7273 290a  oords[k].attrs).
+00015350: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015360: 656c 6966 2076 2e6e 6469 6d20 3d3d 2031  elif v.ndim == 1
+00015370: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00015380: 2020 2020 2020 7969 656c 6420 6b2c 2049        yield k, I
+00015390: 6e64 6578 5661 7269 6162 6c65 2828 6b2c  ndexVariable((k,
+000153a0: 292c 2076 2c20 6174 7472 733d 7365 6c66  ), v, attrs=self
+000153b0: 2e63 6f6f 7264 735b 6b5d 2e61 7474 7273  .coords[k].attrs
+000153c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+000153d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000153e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000153f0: 6520 4173 7365 7274 696f 6e45 7272 6f72  e AssertionError
+00015400: 2829 2020 2320 416c 7265 6164 7920 7465  ()  # Already te
+00015410: 7374 6564 2062 7920 5f76 616c 6964 6174  sted by _validat
+00015420: 655f 696e 6465 7865 7273 0a20 2020 2020  e_indexers.     
+00015430: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00015440: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00015450: 7365 2054 7970 6545 7272 6f72 2874 7970  se TypeError(typ
+00015460: 6528 7629 290a 0a20 2020 2064 6566 205f  e(v))..    def _
+00015470: 6765 745f 696e 6465 7865 7273 5f63 6f6f  get_indexers_coo
+00015480: 7264 735f 616e 645f 696e 6465 7865 7328  rds_and_indexes(
+00015490: 7365 6c66 2c20 696e 6465 7865 7273 293a  self, indexers):
+000154a0: 0a20 2020 2020 2020 2022 2222 4578 7472  .        """Extr
+000154b0: 6163 7420 636f 6f72 6469 6e61 7465 7320  act coordinates 
+000154c0: 616e 6420 696e 6465 7865 7320 6672 6f6d  and indexes from
+000154d0: 2069 6e64 6578 6572 732e 0a0a 2020 2020   indexers...    
+000154e0: 2020 2020 4f6e 6c79 2063 6f6f 7264 696e      Only coordin
+000154f0: 6174 6520 7769 7468 2061 206e 616d 6520  ate with a name 
+00015500: 6469 6666 6572 656e 7420 6672 6f6d 2061  different from a
+00015510: 6e79 206f 6620 7365 6c66 2e76 6172 6961  ny of self.varia
+00015520: 626c 6573 2077 696c 6c0a 2020 2020 2020  bles will.      
+00015530: 2020 6265 2061 7474 6163 6865 642e 0a20    be attached.. 
+00015540: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00015550: 2020 2066 726f 6d20 7861 7272 6179 2e63     from xarray.c
+00015560: 6f72 652e 6461 7461 6172 7261 7920 696d  ore.dataarray im
+00015570: 706f 7274 2044 6174 6141 7272 6179 0a0a  port DataArray..
+00015580: 2020 2020 2020 2020 636f 6f72 6473 5f6c          coords_l
+00015590: 6973 7420 3d20 5b5d 0a20 2020 2020 2020  ist = [].       
+000155a0: 2066 6f72 206b 2c20 7620 696e 2069 6e64   for k, v in ind
+000155b0: 6578 6572 732e 6974 656d 7328 293a 0a20  exers.items():. 
+000155c0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+000155d0: 696e 7374 616e 6365 2876 2c20 4461 7461  instance(v, Data
+000155e0: 4172 7261 7929 3a0a 2020 2020 2020 2020  Array):.        
+000155f0: 2020 2020 2020 2020 6966 2076 2e64 7479          if v.dty
+00015600: 7065 2e6b 696e 6420 3d3d 2022 6222 3a0a  pe.kind == "b":.
+00015610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015620: 2020 2020 6966 2076 2e6e 6469 6d20 213d      if v.ndim !=
+00015630: 2031 3a20 2023 2077 6520 6f6e 6c79 2073   1:  # we only s
+00015640: 7570 706f 7274 2031 2d64 2062 6f6f 6c65  upport 1-d boole
+00015650: 616e 2061 7272 6179 0a20 2020 2020 2020  an array.       
+00015660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015670: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00015680: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00015690: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000156a0: 7b3a 647d 642d 626f 6f6c 6561 6e20 6172  {:d}d-boolean ar
+000156b0: 7261 7920 6973 2075 7365 6420 666f 7220  ray is used for 
+000156c0: 696e 6465 7869 6e67 2061 6c6f 6e67 2022  indexing along "
+000156d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000156e0: 2020 2020 2020 2020 2020 2020 2022 6469               "di
+000156f0: 6d65 6e73 696f 6e20 7b21 727d 2c20 6275  mension {!r}, bu
+00015700: 7420 6f6e 6c79 2031 6420 626f 6f6c 6561  t only 1d boolea
+00015710: 6e20 6172 7261 7973 2061 7265 2022 0a20  n arrays are ". 
+00015720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015730: 2020 2020 2020 2020 2020 2022 7375 7070             "supp
+00015740: 6f72 7465 642e 222e 666f 726d 6174 2876  orted.".format(v
+00015750: 2e6e 6469 6d2c 206b 290a 2020 2020 2020  .ndim, k).      
+00015760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015770: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00015780: 2020 2020 2020 2020 2320 4d61 6b65 2073          # Make s
+00015790: 7572 6520 696e 2063 6173 6520 6f66 2062  ure in case of b
+000157a0: 6f6f 6c65 616e 2044 6174 6141 7272 6179  oolean DataArray
+000157b0: 2c20 6974 730a 2020 2020 2020 2020 2020  , its.          
+000157c0: 2020 2020 2020 2020 2020 2320 636f 6f72            # coor
+000157d0: 6469 6e61 7465 2061 6c73 6f20 7368 6f75  dinate also shou
+000157e0: 6c64 2062 6520 696e 6465 7865 642e 0a20  ld be indexed.. 
+000157f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015800: 2020 2076 5f63 6f6f 7264 7320 3d20 765b     v_coords = v[
+00015810: 762e 7661 6c75 6573 2e6e 6f6e 7a65 726f  v.values.nonzero
+00015820: 2829 5b30 5d5d 2e63 6f6f 7264 730a 2020  ()[0]].coords.  
+00015830: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00015840: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00015850: 2020 2020 2020 2020 765f 636f 6f72 6473          v_coords
+00015860: 203d 2076 2e63 6f6f 7264 730a 2020 2020   = v.coords.    
+00015870: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
+00015880: 6473 5f6c 6973 742e 6170 7065 6e64 2876  ds_list.append(v
+00015890: 5f63 6f6f 7264 7329 0a0a 2020 2020 2020  _coords)..      
+000158a0: 2020 2320 7765 2064 6f6e 2774 206e 6565    # we don't nee
+000158b0: 6420 746f 2063 616c 6c20 616c 6967 6e28  d to call align(
+000158c0: 2920 6578 706c 6963 6974 6c79 206f 7220  ) explicitly or 
+000158d0: 6368 6563 6b20 696e 6465 7865 7320 666f  check indexes fo
+000158e0: 720a 2020 2020 2020 2020 2320 616c 6967  r.        # alig
+000158f0: 6e6d 656e 742c 2062 6563 6175 7365 206d  nment, because m
+00015900: 6572 6765 5f76 6172 6961 626c 6573 2061  erge_variables a
+00015910: 6c72 6561 6479 2063 6865 636b 7320 666f  lready checks fo
+00015920: 7220 6578 6163 7420 616c 6967 6e6d 656e  r exact alignmen
+00015930: 740a 2020 2020 2020 2020 2320 6265 7477  t.        # betw
+00015940: 6565 6e20 6469 6d65 6e73 696f 6e20 636f  een dimension co
+00015950: 6f72 6469 6e61 7465 730a 2020 2020 2020  ordinates.      
+00015960: 2020 636f 6f72 6473 2c20 696e 6465 7865    coords, indexe
+00015970: 7320 3d20 6d65 7267 655f 636f 6f72 6469  s = merge_coordi
+00015980: 6e61 7465 735f 7769 7468 6f75 745f 616c  nates_without_al
+00015990: 6967 6e28 636f 6f72 6473 5f6c 6973 7429  ign(coords_list)
+000159a0: 0a20 2020 2020 2020 2061 7373 6572 745f  .        assert_
+000159b0: 636f 6f72 6469 6e61 7465 5f63 6f6e 7369  coordinate_consi
+000159c0: 7374 656e 7428 7365 6c66 2c20 636f 6f72  stent(self, coor
+000159d0: 6473 290a 0a20 2020 2020 2020 2023 2073  ds)..        # s
+000159e0: 696c 656e 746c 7920 6472 6f70 2074 6865  ilently drop the
+000159f0: 2063 6f6e 666c 6963 7465 6420 7661 7269   conflicted vari
+00015a00: 6162 6c65 732e 0a20 2020 2020 2020 2061  ables..        a
+00015a10: 7474 6163 6865 645f 636f 6f72 6473 203d  ttached_coords =
+00015a20: 207b 6b3a 2076 2066 6f72 206b 2c20 7620   {k: v for k, v 
+00015a30: 696e 2063 6f6f 7264 732e 6974 656d 7328  in coords.items(
+00015a40: 2920 6966 206b 206e 6f74 2069 6e20 7365  ) if k not in se
+00015a50: 6c66 2e5f 7661 7269 6162 6c65 737d 0a20  lf._variables}. 
+00015a60: 2020 2020 2020 2061 7474 6163 6865 645f         attached_
+00015a70: 696e 6465 7865 7320 3d20 7b0a 2020 2020  indexes = {.    
+00015a80: 2020 2020 2020 2020 6b3a 2076 2066 6f72          k: v for
+00015a90: 206b 2c20 7620 696e 2069 6e64 6578 6573   k, v in indexes
+00015aa0: 2e69 7465 6d73 2829 2069 6620 6b20 6e6f  .items() if k no
+00015ab0: 7420 696e 2073 656c 662e 5f76 6172 6961  t in self._varia
+00015ac0: 626c 6573 0a20 2020 2020 2020 207d 0a20  bles.        }. 
+00015ad0: 2020 2020 2020 2072 6574 7572 6e20 6174         return at
+00015ae0: 7461 6368 6564 5f63 6f6f 7264 732c 2061  tached_coords, a
+00015af0: 7474 6163 6865 645f 696e 6465 7865 730a  ttached_indexes.
+00015b00: 0a20 2020 2064 6566 2069 7365 6c28 0a20  .    def isel(. 
+00015b10: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
+00015b20: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
+00015b30: 696e 6465 7865 7273 3a20 4d61 7070 696e  indexers: Mappin
+00015b40: 675b 416e 792c 2041 6e79 5d20 7c20 4e6f  g[Any, Any] | No
+00015b50: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+00015b60: 2020 2064 726f 703a 2062 6f6f 6c20 3d20     drop: bool = 
+00015b70: 4661 6c73 652c 0a20 2020 2020 2020 206d  False,.        m
+00015b80: 6973 7369 6e67 5f64 696d 733a 2045 7272  issing_dims: Err
+00015b90: 6f72 4f70 7469 6f6e 7357 6974 6857 6172  orOptionsWithWar
+00015ba0: 6e20 3d20 2272 6169 7365 222c 0a20 2020  n = "raise",.   
+00015bb0: 2020 2020 202a 2a69 6e64 6578 6572 735f       **indexers_
+00015bc0: 6b77 6172 6773 3a20 416e 792c 0a20 2020  kwargs: Any,.   
+00015bd0: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
+00015be0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+00015bf0: 726e 7320 6120 6e65 7720 6461 7461 7365  rns a new datase
+00015c00: 7420 7769 7468 2065 6163 6820 6172 7261  t with each arra
+00015c10: 7920 696e 6465 7865 6420 616c 6f6e 6720  y indexed along 
+00015c20: 7468 6520 7370 6563 6966 6965 640a 2020  the specified.  
+00015c30: 2020 2020 2020 6469 6d65 6e73 696f 6e28        dimension(
+00015c40: 7329 2e0a 0a20 2020 2020 2020 2054 6869  s)...        Thi
+00015c50: 7320 6d65 7468 6f64 2073 656c 6563 7473  s method selects
+00015c60: 2076 616c 7565 7320 6672 6f6d 2065 6163   values from eac
+00015c70: 6820 6172 7261 7920 7573 696e 6720 6974  h array using it
+00015c80: 7320 605f 5f67 6574 6974 656d 5f5f 600a  s `__getitem__`.
+00015c90: 2020 2020 2020 2020 6d65 7468 6f64 2c20          method, 
+00015ca0: 6578 6365 7074 2074 6869 7320 6d65 7468  except this meth
+00015cb0: 6f64 2064 6f65 7320 6e6f 7420 7265 7175  od does not requ
+00015cc0: 6972 6520 6b6e 6f77 696e 6720 7468 6520  ire knowing the 
+00015cd0: 6f72 6465 7220 6f66 0a20 2020 2020 2020  order of.       
+00015ce0: 2065 6163 6820 6172 7261 7927 7320 6469   each array's di
+00015cf0: 6d65 6e73 696f 6e73 2e0a 0a20 2020 2020  mensions...     
+00015d00: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+00015d10: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00015d20: 0a20 2020 2020 2020 2069 6e64 6578 6572  .        indexer
+00015d30: 7320 3a20 6469 6374 2c20 6f70 7469 6f6e  s : dict, option
+00015d40: 616c 0a20 2020 2020 2020 2020 2020 2041  al.            A
+00015d50: 2064 6963 7420 7769 7468 206b 6579 7320   dict with keys 
+00015d60: 6d61 7463 6869 6e67 2064 696d 656e 7369  matching dimensi
+00015d70: 6f6e 7320 616e 6420 7661 6c75 6573 2067  ons and values g
+00015d80: 6976 656e 0a20 2020 2020 2020 2020 2020  iven.           
+00015d90: 2062 7920 696e 7465 6765 7273 2c20 736c   by integers, sl
+00015da0: 6963 6520 6f62 6a65 6374 7320 6f72 2061  ice objects or a
+00015db0: 7272 6179 732e 0a20 2020 2020 2020 2020  rrays..         
+00015dc0: 2020 2069 6e64 6578 6572 2063 616e 2062     indexer can b
+00015dd0: 6520 6120 696e 7465 6765 722c 2073 6c69  e a integer, sli
+00015de0: 6365 2c20 6172 7261 792d 6c69 6b65 206f  ce, array-like o
+00015df0: 7220 4461 7461 4172 7261 792e 0a20 2020  r DataArray..   
+00015e00: 2020 2020 2020 2020 2049 6620 4461 7461           If Data
+00015e10: 4172 7261 7973 2061 7265 2070 6173 7365  Arrays are passe
+00015e20: 6420 6173 2069 6e64 6578 6572 732c 2078  d as indexers, x
+00015e30: 6172 7261 792d 7374 796c 6520 696e 6465  array-style inde
+00015e40: 7869 6e67 2077 696c 6c20 6265 0a20 2020  xing will be.   
+00015e50: 2020 2020 2020 2020 2063 6172 7269 6564           carried
+00015e60: 206f 7574 2e20 5365 6520 3a72 6566 3a60   out. See :ref:`
+00015e70: 696e 6465 7869 6e67 6020 666f 7220 7468  indexing` for th
+00015e80: 6520 6465 7461 696c 732e 0a20 2020 2020  e details..     
+00015e90: 2020 2020 2020 204f 6e65 206f 6620 696e         One of in
+00015ea0: 6465 7865 7273 206f 7220 696e 6465 7865  dexers or indexe
+00015eb0: 7273 5f6b 7761 7267 7320 6d75 7374 2062  rs_kwargs must b
+00015ec0: 6520 7072 6f76 6964 6564 2e0a 2020 2020  e provided..    
+00015ed0: 2020 2020 6472 6f70 203a 2062 6f6f 6c2c      drop : bool,
+00015ee0: 2064 6566 6175 6c74 3a20 4661 6c73 650a   default: False.
+00015ef0: 2020 2020 2020 2020 2020 2020 4966 2060              If `
+00015f00: 6064 726f 703d 5472 7565 6060 2c20 6472  `drop=True``, dr
+00015f10: 6f70 2063 6f6f 7264 696e 6174 6573 2076  op coordinates v
+00015f20: 6172 6961 626c 6573 2069 6e64 6578 6564  ariables indexed
+00015f30: 2062 7920 696e 7465 6765 7273 0a20 2020   by integers.   
+00015f40: 2020 2020 2020 2020 2069 6e73 7465 6164           instead
+00015f50: 206f 6620 6d61 6b69 6e67 2074 6865 6d20   of making them 
+00015f60: 7363 616c 6172 2e0a 2020 2020 2020 2020  scalar..        
+00015f70: 6d69 7373 696e 675f 6469 6d73 203a 207b  missing_dims : {
+00015f80: 2272 6169 7365 222c 2022 7761 726e 222c  "raise", "warn",
+00015f90: 2022 6967 6e6f 7265 227d 2c20 6465 6661   "ignore"}, defa
+00015fa0: 756c 743a 2022 7261 6973 6522 0a20 2020  ult: "raise".   
+00015fb0: 2020 2020 2020 2020 2057 6861 7420 746f           What to
+00015fc0: 2064 6f20 6966 2064 696d 656e 7369 6f6e   do if dimension
+00015fd0: 7320 7468 6174 2073 686f 756c 6420 6265  s that should be
+00015fe0: 2073 656c 6563 7465 6420 6672 6f6d 2061   selected from a
+00015ff0: 7265 206e 6f74 2070 7265 7365 6e74 2069  re not present i
+00016000: 6e20 7468 650a 2020 2020 2020 2020 2020  n the.          
+00016010: 2020 4461 7461 7365 743a 0a20 2020 2020    Dataset:.     
+00016020: 2020 2020 2020 202d 2022 7261 6973 6522         - "raise"
+00016030: 3a20 7261 6973 6520 616e 2065 7863 6570  : raise an excep
+00016040: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00016050: 202d 2022 7761 726e 223a 2072 6169 7365   - "warn": raise
+00016060: 2061 2077 6172 6e69 6e67 2c20 616e 6420   a warning, and 
+00016070: 6967 6e6f 7265 2074 6865 206d 6973 7369  ignore the missi
+00016080: 6e67 2064 696d 656e 7369 6f6e 730a 2020  ng dimensions.  
+00016090: 2020 2020 2020 2020 2020 2d20 2269 676e            - "ign
+000160a0: 6f72 6522 3a20 6967 6e6f 7265 2074 6865  ore": ignore the
+000160b0: 206d 6973 7369 6e67 2064 696d 656e 7369   missing dimensi
+000160c0: 6f6e 730a 0a20 2020 2020 2020 202a 2a69  ons..        **i
+000160d0: 6e64 6578 6572 735f 6b77 6172 6773 203a  ndexers_kwargs :
+000160e0: 207b 6469 6d3a 2069 6e64 6578 6572 2c20   {dim: indexer, 
+000160f0: 2e2e 2e7d 2c20 6f70 7469 6f6e 616c 0a20  ...}, optional. 
+00016100: 2020 2020 2020 2020 2020 2054 6865 206b             The k
+00016110: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
+00016120: 2066 6f72 6d20 6f66 2060 6069 6e64 6578   form of ``index
+00016130: 6572 7360 602e 0a20 2020 2020 2020 2020  ers``..         
+00016140: 2020 204f 6e65 206f 6620 696e 6465 7865     One of indexe
+00016150: 7273 206f 7220 696e 6465 7865 7273 5f6b  rs or indexers_k
+00016160: 7761 7267 7320 6d75 7374 2062 6520 7072  wargs must be pr
+00016170: 6f76 6964 6564 2e0a 0a20 2020 2020 2020  ovided...       
+00016180: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00016190: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+000161a0: 206f 626a 203a 2044 6174 6173 6574 0a20   obj : Dataset. 
+000161b0: 2020 2020 2020 2020 2020 2041 206e 6577             A new
+000161c0: 2044 6174 6173 6574 2077 6974 6820 7468   Dataset with th
+000161d0: 6520 7361 6d65 2063 6f6e 7465 6e74 7320  e same contents 
+000161e0: 6173 2074 6869 7320 6461 7461 7365 742c  as this dataset,
+000161f0: 2065 7863 6570 7420 6561 6368 0a20 2020   except each.   
+00016200: 2020 2020 2020 2020 2061 7272 6179 2061           array a
+00016210: 6e64 2064 696d 656e 7369 6f6e 2069 7320  nd dimension is 
+00016220: 696e 6465 7865 6420 6279 2074 6865 2061  indexed by the a
+00016230: 7070 726f 7072 6961 7465 2069 6e64 6578  ppropriate index
+00016240: 6572 732e 0a20 2020 2020 2020 2020 2020  ers..           
+00016250: 2049 6620 696e 6465 7865 7220 4461 7461   If indexer Data
+00016260: 4172 7261 7973 2068 6176 6520 636f 6f72  Arrays have coor
+00016270: 6469 6e61 7465 7320 7468 6174 2064 6f20  dinates that do 
+00016280: 6e6f 7420 636f 6e66 6c69 6374 2077 6974  not conflict wit
+00016290: 680a 2020 2020 2020 2020 2020 2020 7468  h.            th
+000162a0: 6973 206f 626a 6563 742c 2074 6865 6e20  is object, then 
+000162b0: 7468 6573 6520 636f 6f72 6469 6e61 7465  these coordinate
+000162c0: 7320 7769 6c6c 2062 6520 6174 7461 6368  s will be attach
+000162d0: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
+000162e0: 496e 2067 656e 6572 616c 2c20 6561 6368  In general, each
+000162f0: 2061 7272 6179 2773 2064 6174 6120 7769   array's data wi
+00016300: 6c6c 2062 6520 6120 7669 6577 206f 6620  ll be a view of 
+00016310: 7468 6520 6172 7261 7927 7320 6461 7461  the array's data
+00016320: 0a20 2020 2020 2020 2020 2020 2069 6e20  .            in 
+00016330: 7468 6973 2064 6174 6173 6574 2c20 756e  this dataset, un
+00016340: 6c65 7373 2076 6563 746f 7269 7a65 6420  less vectorized 
+00016350: 696e 6465 7869 6e67 2077 6173 2074 7269  indexing was tri
+00016360: 6767 6572 6564 2062 7920 7573 696e 670a  ggered by using.
+00016370: 2020 2020 2020 2020 2020 2020 616e 2061              an a
+00016380: 7272 6179 2069 6e64 6578 6572 2c20 696e  rray indexer, in
+00016390: 2077 6869 6368 2063 6173 6520 7468 6520   which case the 
+000163a0: 6461 7461 2077 696c 6c20 6265 2061 2063  data will be a c
+000163b0: 6f70 792e 0a0a 2020 2020 2020 2020 5365  opy...        Se
+000163c0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+000163d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000163e0: 4461 7461 7365 742e 7365 6c0a 2020 2020  Dataset.sel.    
+000163f0: 2020 2020 4461 7461 4172 7261 792e 6973      DataArray.is
+00016400: 656c 0a20 2020 2020 2020 2022 2222 0a20  el.        """. 
+00016410: 2020 2020 2020 2069 6e64 6578 6572 7320         indexers 
+00016420: 3d20 6569 7468 6572 5f64 6963 745f 6f72  = either_dict_or
+00016430: 5f6b 7761 7267 7328 696e 6465 7865 7273  _kwargs(indexers
+00016440: 2c20 696e 6465 7865 7273 5f6b 7761 7267  , indexers_kwarg
+00016450: 732c 2022 6973 656c 2229 0a20 2020 2020  s, "isel").     
+00016460: 2020 2069 6620 616e 7928 6973 5f66 616e     if any(is_fan
+00016470: 6379 5f69 6e64 6578 6572 2869 6478 2920  cy_indexer(idx) 
+00016480: 666f 7220 6964 7820 696e 2069 6e64 6578  for idx in index
+00016490: 6572 732e 7661 6c75 6573 2829 293a 0a20  ers.values()):. 
+000164a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000164b0: 6e20 7365 6c66 2e5f 6973 656c 5f66 616e  n self._isel_fan
+000164c0: 6379 2869 6e64 6578 6572 732c 2064 726f  cy(indexers, dro
+000164d0: 703d 6472 6f70 2c20 6d69 7373 696e 675f  p=drop, missing_
+000164e0: 6469 6d73 3d6d 6973 7369 6e67 5f64 696d  dims=missing_dim
+000164f0: 7329 0a0a 2020 2020 2020 2020 2320 4d75  s)..        # Mu
+00016500: 6368 2066 6173 7465 7220 616c 676f 7269  ch faster algori
+00016510: 7468 6d20 666f 7220 7768 656e 2061 6c6c  thm for when all
+00016520: 2069 6e64 6578 6572 7320 6172 6520 696e   indexers are in
+00016530: 7473 2c20 736c 6963 6573 2c20 6f6e 652d  ts, slices, one-
+00016540: 6469 6d65 6e73 696f 6e61 6c0a 2020 2020  dimensional.    
+00016550: 2020 2020 2320 6c69 7374 732c 206f 7220      # lists, or 
+00016560: 7a65 726f 206f 7220 6f6e 652d 6469 6d65  zero or one-dime
+00016570: 6e73 696f 6e61 6c20 6e70 2e6e 6461 7272  nsional np.ndarr
+00016580: 6179 2773 0a20 2020 2020 2020 2069 6e64  ay's.        ind
+00016590: 6578 6572 7320 3d20 6472 6f70 5f64 696d  exers = drop_dim
+000165a0: 735f 6672 6f6d 5f69 6e64 6578 6572 7328  s_from_indexers(
+000165b0: 696e 6465 7865 7273 2c20 7365 6c66 2e64  indexers, self.d
+000165c0: 696d 732c 206d 6973 7369 6e67 5f64 696d  ims, missing_dim
+000165d0: 7329 0a0a 2020 2020 2020 2020 7661 7269  s)..        vari
+000165e0: 6162 6c65 7320 3d20 7b7d 0a20 2020 2020  ables = {}.     
+000165f0: 2020 2064 696d 733a 2064 6963 745b 4861     dims: dict[Ha
+00016600: 7368 6162 6c65 2c20 696e 745d 203d 207b  shable, int] = {
+00016610: 7d0a 2020 2020 2020 2020 636f 6f72 645f  }.        coord_
+00016620: 6e61 6d65 7320 3d20 7365 6c66 2e5f 636f  names = self._co
+00016630: 6f72 645f 6e61 6d65 732e 636f 7079 2829  ord_names.copy()
+00016640: 0a0a 2020 2020 2020 2020 696e 6465 7865  ..        indexe
+00016650: 732c 2069 6e64 6578 5f76 6172 6961 626c  s, index_variabl
+00016660: 6573 203d 2069 7365 6c5f 696e 6465 7865  es = isel_indexe
+00016670: 7328 7365 6c66 2e78 696e 6465 7865 732c  s(self.xindexes,
+00016680: 2069 6e64 6578 6572 7329 0a0a 2020 2020   indexers)..    
+00016690: 2020 2020 666f 7220 6e61 6d65 2c20 7661      for name, va
+000166a0: 7220 696e 2073 656c 662e 5f76 6172 6961  r in self._varia
+000166b0: 626c 6573 2e69 7465 6d73 2829 3a0a 2020  bles.items():.  
+000166c0: 2020 2020 2020 2020 2020 2320 7072 6573            # pres
+000166d0: 6572 7665 2076 6172 6961 626c 6520 6f72  erve variable or
+000166e0: 6465 720a 2020 2020 2020 2020 2020 2020  der.            
+000166f0: 6966 206e 616d 6520 696e 2069 6e64 6578  if name in index
+00016700: 5f76 6172 6961 626c 6573 3a0a 2020 2020  _variables:.    
+00016710: 2020 2020 2020 2020 2020 2020 7661 7220              var 
+00016720: 3d20 696e 6465 785f 7661 7269 6162 6c65  = index_variable
+00016730: 735b 6e61 6d65 5d0a 2020 2020 2020 2020  s[name].        
+00016740: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00016750: 2020 2020 2020 2020 2020 7661 725f 696e            var_in
+00016760: 6465 7865 7273 203d 207b 6b3a 2076 2066  dexers = {k: v f
+00016770: 6f72 206b 2c20 7620 696e 2069 6e64 6578  or k, v in index
+00016780: 6572 732e 6974 656d 7328 2920 6966 206b  ers.items() if k
+00016790: 2069 6e20 7661 722e 6469 6d73 7d0a 2020   in var.dims}.  
+000167a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000167b0: 2076 6172 5f69 6e64 6578 6572 733a 0a20   var_indexers:. 
+000167c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000167d0: 2020 2076 6172 203d 2076 6172 2e69 7365     var = var.ise
+000167e0: 6c28 7661 725f 696e 6465 7865 7273 290a  l(var_indexers).
+000167f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016800: 2020 2020 6966 2064 726f 7020 616e 6420      if drop and 
+00016810: 7661 722e 6e64 696d 203d 3d20 3020 616e  var.ndim == 0 an
+00016820: 6420 6e61 6d65 2069 6e20 636f 6f72 645f  d name in coord_
+00016830: 6e61 6d65 733a 0a20 2020 2020 2020 2020  names:.         
+00016840: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00016850: 6f6f 7264 5f6e 616d 6573 2e72 656d 6f76  oord_names.remov
+00016860: 6528 6e61 6d65 290a 2020 2020 2020 2020  e(name).        
+00016870: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016880: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
+00016890: 2020 2020 2076 6172 6961 626c 6573 5b6e       variables[n
+000168a0: 616d 655d 203d 2076 6172 0a20 2020 2020  ame] = var.     
+000168b0: 2020 2020 2020 2064 696d 732e 7570 6461         dims.upda
+000168c0: 7465 287a 6970 2876 6172 2e64 696d 732c  te(zip(var.dims,
+000168d0: 2076 6172 2e73 6861 7065 2929 0a0a 2020   var.shape))..  
+000168e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000168f0: 662e 5f63 6f6e 7374 7275 6374 5f64 6972  f._construct_dir
+00016900: 6563 7428 0a20 2020 2020 2020 2020 2020  ect(.           
+00016910: 2076 6172 6961 626c 6573 3d76 6172 6961   variables=varia
+00016920: 626c 6573 2c0a 2020 2020 2020 2020 2020  bles,.          
+00016930: 2020 636f 6f72 645f 6e61 6d65 733d 636f    coord_names=co
+00016940: 6f72 645f 6e61 6d65 732c 0a20 2020 2020  ord_names,.     
+00016950: 2020 2020 2020 2064 696d 733d 6469 6d73         dims=dims
+00016960: 2c0a 2020 2020 2020 2020 2020 2020 6174  ,.            at
+00016970: 7472 733d 7365 6c66 2e5f 6174 7472 732c  trs=self._attrs,
+00016980: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00016990: 6578 6573 3d69 6e64 6578 6573 2c0a 2020  exes=indexes,.  
+000169a0: 2020 2020 2020 2020 2020 656e 636f 6469            encodi
+000169b0: 6e67 3d73 656c 662e 5f65 6e63 6f64 696e  ng=self._encodin
+000169c0: 672c 0a20 2020 2020 2020 2020 2020 2063  g,.            c
+000169d0: 6c6f 7365 3d73 656c 662e 5f63 6c6f 7365  lose=self._close
+000169e0: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+000169f0: 2064 6566 205f 6973 656c 5f66 616e 6379   def _isel_fancy
+00016a00: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
+00016a10: 545f 4461 7461 7365 742c 0a20 2020 2020  T_Dataset,.     
+00016a20: 2020 2069 6e64 6578 6572 733a 204d 6170     indexers: Map
+00016a30: 7069 6e67 5b41 6e79 2c20 416e 795d 2c0a  ping[Any, Any],.
+00016a40: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
+00016a50: 2020 2064 726f 703a 2062 6f6f 6c2c 0a20     drop: bool,. 
+00016a60: 2020 2020 2020 206d 6973 7369 6e67 5f64         missing_d
+00016a70: 696d 733a 2045 7272 6f72 4f70 7469 6f6e  ims: ErrorOption
+00016a80: 7357 6974 6857 6172 6e20 3d20 2272 6169  sWithWarn = "rai
+00016a90: 7365 222c 0a20 2020 2029 202d 3e20 545f  se",.    ) -> T_
+00016aa0: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
+00016ab0: 2076 616c 6964 5f69 6e64 6578 6572 7320   valid_indexers 
+00016ac0: 3d20 6469 6374 2873 656c 662e 5f76 616c  = dict(self._val
+00016ad0: 6964 6174 655f 696e 6465 7865 7273 2869  idate_indexers(i
+00016ae0: 6e64 6578 6572 732c 206d 6973 7369 6e67  ndexers, missing
+00016af0: 5f64 696d 7329 290a 0a20 2020 2020 2020  _dims))..       
+00016b00: 2076 6172 6961 626c 6573 3a20 6469 6374   variables: dict
+00016b10: 5b48 6173 6861 626c 652c 2056 6172 6961  [Hashable, Varia
+00016b20: 626c 655d 203d 207b 7d0a 2020 2020 2020  ble] = {}.      
+00016b30: 2020 696e 6465 7865 732c 2069 6e64 6578    indexes, index
+00016b40: 5f76 6172 6961 626c 6573 203d 2069 7365  _variables = ise
+00016b50: 6c5f 696e 6465 7865 7328 7365 6c66 2e78  l_indexes(self.x
+00016b60: 696e 6465 7865 732c 2076 616c 6964 5f69  indexes, valid_i
+00016b70: 6e64 6578 6572 7329 0a0a 2020 2020 2020  ndexers)..      
+00016b80: 2020 666f 7220 6e61 6d65 2c20 7661 7220    for name, var 
+00016b90: 696e 2073 656c 662e 7661 7269 6162 6c65  in self.variable
+00016ba0: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
+00016bb0: 2020 2020 2020 2069 6620 6e61 6d65 2069         if name i
+00016bc0: 6e20 696e 6465 785f 7661 7269 6162 6c65  n index_variable
+00016bd0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+00016be0: 2020 206e 6577 5f76 6172 203d 2069 6e64     new_var = ind
+00016bf0: 6578 5f76 6172 6961 626c 6573 5b6e 616d  ex_variables[nam
+00016c00: 655d 0a20 2020 2020 2020 2020 2020 2065  e].            e
+00016c10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00016c20: 2020 2020 2076 6172 5f69 6e64 6578 6572       var_indexer
+00016c30: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00016c40: 2020 2020 2020 2020 2020 6b3a 2076 2066            k: v f
+00016c50: 6f72 206b 2c20 7620 696e 2076 616c 6964  or k, v in valid
+00016c60: 5f69 6e64 6578 6572 732e 6974 656d 7328  _indexers.items(
+00016c70: 2920 6966 206b 2069 6e20 7661 722e 6469  ) if k in var.di
+00016c80: 6d73 0a20 2020 2020 2020 2020 2020 2020  ms.             
+00016c90: 2020 207d 0a20 2020 2020 2020 2020 2020     }.           
+00016ca0: 2020 2020 2069 6620 7661 725f 696e 6465       if var_inde
+00016cb0: 7865 7273 3a0a 2020 2020 2020 2020 2020  xers:.          
+00016cc0: 2020 2020 2020 2020 2020 6e65 775f 7661            new_va
+00016cd0: 7220 3d20 7661 722e 6973 656c 2869 6e64  r = var.isel(ind
+00016ce0: 6578 6572 733d 7661 725f 696e 6465 7865  exers=var_indexe
+00016cf0: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
+00016d00: 2020 2020 2020 2020 2320 6472 6f70 2073          # drop s
+00016d10: 6361 6c61 7220 636f 6f72 6469 6e61 7465  calar coordinate
+00016d20: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00016d30: 2020 2020 2020 2320 6874 7470 733a 2f2f        # https://
+00016d40: 6769 7468 7562 2e63 6f6d 2f70 7964 6174  github.com/pydat
+00016d50: 612f 7861 7272 6179 2f69 7373 7565 732f  a/xarray/issues/
+00016d60: 3635 3534 0a20 2020 2020 2020 2020 2020  6554.           
+00016d70: 2020 2020 2020 2020 2069 6620 6e61 6d65           if name
+00016d80: 2069 6e20 7365 6c66 2e63 6f6f 7264 7320   in self.coords 
+00016d90: 616e 6420 6472 6f70 2061 6e64 206e 6577  and drop and new
+00016da0: 5f76 6172 2e6e 6469 6d20 3d3d 2030 3a0a  _var.ndim == 0:.
+00016db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016dc0: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
+00016dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00016de0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00016df0: 2020 2020 2020 2020 2020 206e 6577 5f76             new_v
+00016e00: 6172 203d 2076 6172 2e63 6f70 7928 6465  ar = var.copy(de
+00016e10: 6570 3d46 616c 7365 290a 2020 2020 2020  ep=False).      
+00016e20: 2020 2020 2020 2020 2020 6966 206e 616d            if nam
+00016e30: 6520 6e6f 7420 696e 2069 6e64 6578 6573  e not in indexes
+00016e40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00016e50: 2020 2020 2020 6e65 775f 7661 7220 3d20        new_var = 
+00016e60: 6e65 775f 7661 722e 746f 5f62 6173 655f  new_var.to_base_
+00016e70: 7661 7269 6162 6c65 2829 0a20 2020 2020  variable().     
+00016e80: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+00016e90: 5b6e 616d 655d 203d 206e 6577 5f76 6172  [name] = new_var
+00016ea0: 0a0a 2020 2020 2020 2020 636f 6f72 645f  ..        coord_
+00016eb0: 6e61 6d65 7320 3d20 7365 6c66 2e5f 636f  names = self._co
+00016ec0: 6f72 645f 6e61 6d65 7320 2620 7661 7269  ord_names & vari
+00016ed0: 6162 6c65 732e 6b65 7973 2829 0a20 2020  ables.keys().   
+00016ee0: 2020 2020 2073 656c 6563 7465 6420 3d20       selected = 
+00016ef0: 7365 6c66 2e5f 7265 706c 6163 655f 7769  self._replace_wi
+00016f00: 7468 5f6e 6577 5f64 696d 7328 7661 7269  th_new_dims(vari
+00016f10: 6162 6c65 732c 2063 6f6f 7264 5f6e 616d  ables, coord_nam
+00016f20: 6573 2c20 696e 6465 7865 7329 0a0a 2020  es, indexes)..  
+00016f30: 2020 2020 2020 2320 4578 7472 6163 7420        # Extract 
+00016f40: 636f 6f72 6469 6e61 7465 7320 6672 6f6d  coordinates from
+00016f50: 2069 6e64 6578 6572 730a 2020 2020 2020   indexers.      
+00016f60: 2020 636f 6f72 645f 7661 7273 2c20 6e65    coord_vars, ne
+00016f70: 775f 696e 6465 7865 7320 3d20 7365 6c65  w_indexes = sele
+00016f80: 6374 6564 2e5f 6765 745f 696e 6465 7865  cted._get_indexe
+00016f90: 7273 5f63 6f6f 7264 735f 616e 645f 696e  rs_coords_and_in
+00016fa0: 6465 7865 7328 696e 6465 7865 7273 290a  dexes(indexers).
+00016fb0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+00016fc0: 732e 7570 6461 7465 2863 6f6f 7264 5f76  s.update(coord_v
+00016fd0: 6172 7329 0a20 2020 2020 2020 2069 6e64  ars).        ind
+00016fe0: 6578 6573 2e75 7064 6174 6528 6e65 775f  exes.update(new_
+00016ff0: 696e 6465 7865 7329 0a20 2020 2020 2020  indexes).       
+00017000: 2063 6f6f 7264 5f6e 616d 6573 203d 2073   coord_names = s
+00017010: 656c 662e 5f63 6f6f 7264 5f6e 616d 6573  elf._coord_names
+00017020: 2026 2076 6172 6961 626c 6573 2e6b 6579   & variables.key
+00017030: 7328 2920 7c20 636f 6f72 645f 7661 7273  s() | coord_vars
+00017040: 2e6b 6579 7328 290a 2020 2020 2020 2020  .keys().        
+00017050: 7265 7475 726e 2073 656c 662e 5f72 6570  return self._rep
+00017060: 6c61 6365 5f77 6974 685f 6e65 775f 6469  lace_with_new_di
+00017070: 6d73 2876 6172 6961 626c 6573 2c20 636f  ms(variables, co
+00017080: 6f72 645f 6e61 6d65 732c 2069 6e64 6578  ord_names, index
+00017090: 6573 3d69 6e64 6578 6573 290a 0a20 2020  es=indexes)..   
+000170a0: 2064 6566 2073 656c 280a 2020 2020 2020   def sel(.      
+000170b0: 2020 7365 6c66 3a20 545f 4461 7461 7365    self: T_Datase
+000170c0: 742c 0a20 2020 2020 2020 2069 6e64 6578  t,.        index
+000170d0: 6572 733a 204d 6170 7069 6e67 5b41 6e79  ers: Mapping[Any
+000170e0: 2c20 416e 795d 207c 204e 6f6e 6520 3d20  , Any] | None = 
+000170f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6d65  None,.        me
+00017100: 7468 6f64 3a20 7374 7220 7c20 4e6f 6e65  thod: str | None
+00017110: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00017120: 2074 6f6c 6572 616e 6365 3a20 696e 7420   tolerance: int 
+00017130: 7c20 666c 6f61 7420 7c20 4974 6572 6162  | float | Iterab
+00017140: 6c65 5b69 6e74 207c 2066 6c6f 6174 5d20  le[int | float] 
+00017150: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+00017160: 2020 2020 2020 2064 726f 703a 2062 6f6f         drop: boo
+00017170: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
+00017180: 2020 202a 2a69 6e64 6578 6572 735f 6b77     **indexers_kw
+00017190: 6172 6773 3a20 416e 792c 0a20 2020 2029  args: Any,.    )
+000171a0: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
+000171b0: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+000171c0: 7320 6120 6e65 7720 6461 7461 7365 7420  s a new dataset 
+000171d0: 7769 7468 2065 6163 6820 6172 7261 7920  with each array 
+000171e0: 696e 6465 7865 6420 6279 2074 6963 6b20  indexed by tick 
+000171f0: 6c61 6265 6c73 0a20 2020 2020 2020 2061  labels.        a
+00017200: 6c6f 6e67 2074 6865 2073 7065 6369 6669  long the specifi
+00017210: 6564 2064 696d 656e 7369 6f6e 2873 292e  ed dimension(s).
+00017220: 0a0a 2020 2020 2020 2020 496e 2063 6f6e  ..        In con
+00017230: 7472 6173 7420 746f 2060 4461 7461 7365  trast to `Datase
+00017240: 742e 6973 656c 602c 2069 6e64 6578 6572  t.isel`, indexer
+00017250: 7320 666f 7220 7468 6973 206d 6574 686f  s for this metho
+00017260: 6420 7368 6f75 6c64 2075 7365 0a20 2020  d should use.   
+00017270: 2020 2020 206c 6162 656c 7320 696e 7374       labels inst
+00017280: 6561 6420 6f66 2069 6e74 6567 6572 732e  ead of integers.
+00017290: 0a0a 2020 2020 2020 2020 556e 6465 7220  ..        Under 
+000172a0: 7468 6520 686f 6f64 2c20 7468 6973 206d  the hood, this m
+000172b0: 6574 686f 6420 6973 2070 6f77 6572 6564  ethod is powered
+000172c0: 2062 7920 7573 696e 6720 7061 6e64 6173   by using pandas
+000172d0: 2773 2070 6f77 6572 6675 6c20 496e 6465  's powerful Inde
+000172e0: 780a 2020 2020 2020 2020 6f62 6a65 6374  x.        object
+000172f0: 732e 2054 6869 7320 6d61 6b65 7320 6c61  s. This makes la
+00017300: 6265 6c20 6261 7365 6420 696e 6465 7869  bel based indexi
+00017310: 6e67 2065 7373 656e 7469 616c 6c79 206a  ng essentially j
+00017320: 7573 7420 6173 2066 6173 7420 6173 0a20  ust as fast as. 
+00017330: 2020 2020 2020 2075 7369 6e67 2069 6e74         using int
+00017340: 6567 6572 2069 6e64 6578 696e 672e 0a0a  eger indexing...
+00017350: 2020 2020 2020 2020 4974 2061 6c73 6f20          It also 
+00017360: 6d65 616e 7320 7468 6973 206d 6574 686f  means this metho
+00017370: 6420 7573 6573 2070 616e 6461 7327 7320  d uses pandas's 
+00017380: 2877 656c 6c20 646f 6375 6d65 6e74 6564  (well documented
+00017390: 2920 6c6f 6769 6320 666f 720a 2020 2020  ) logic for.    
+000173a0: 2020 2020 696e 6465 7869 6e67 2e20 5468      indexing. Th
+000173b0: 6973 206d 6561 6e73 2079 6f75 2063 616e  is means you can
+000173c0: 2075 7365 2073 7472 696e 6720 7368 6f72   use string shor
+000173d0: 7463 7574 7320 666f 7220 6461 7465 7469  tcuts for dateti
+000173e0: 6d65 2069 6e64 6578 6573 0a20 2020 2020  me indexes.     
+000173f0: 2020 2028 652e 672e 2c20 2732 3030 302d     (e.g., '2000-
+00017400: 3031 2720 746f 2073 656c 6563 7420 616c  01' to select al
+00017410: 6c20 7661 6c75 6573 2069 6e20 4a61 6e75  l values in Janu
+00017420: 6172 7920 3230 3030 292e 2049 7420 616c  ary 2000). It al
+00017430: 736f 206d 6561 6e73 0a20 2020 2020 2020  so means.       
+00017440: 2074 6861 7420 736c 6963 6573 2061 7265   that slices are
+00017450: 2074 7265 6174 6564 2061 7320 696e 636c   treated as incl
+00017460: 7573 6976 6520 6f66 2062 6f74 6820 7468  usive of both th
+00017470: 6520 7374 6172 7420 616e 6420 7374 6f70  e start and stop
+00017480: 2076 616c 7565 732c 0a20 2020 2020 2020   values,.       
+00017490: 2075 6e6c 696b 6520 6e6f 726d 616c 2050   unlike normal P
+000174a0: 7974 686f 6e20 696e 6465 7869 6e67 2e0a  ython indexing..
+000174b0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000174c0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+000174d0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
+000174e0: 6e64 6578 6572 7320 3a20 6469 6374 2c20  ndexers : dict, 
+000174f0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00017500: 2020 2020 2041 2064 6963 7420 7769 7468       A dict with
+00017510: 206b 6579 7320 6d61 7463 6869 6e67 2064   keys matching d
+00017520: 696d 656e 7369 6f6e 7320 616e 6420 7661  imensions and va
+00017530: 6c75 6573 2067 6976 656e 0a20 2020 2020  lues given.     
+00017540: 2020 2020 2020 2062 7920 7363 616c 6172         by scalar
+00017550: 732c 2073 6c69 6365 7320 6f72 2061 7272  s, slices or arr
+00017560: 6179 7320 6f66 2074 6963 6b20 6c61 6265  ays of tick labe
+00017570: 6c73 2e20 466f 7220 6469 6d65 6e73 696f  ls. For dimensio
+00017580: 6e73 2077 6974 680a 2020 2020 2020 2020  ns with.        
+00017590: 2020 2020 6d75 6c74 692d 696e 6465 782c      multi-index,
+000175a0: 2074 6865 2069 6e64 6578 6572 206d 6179   the indexer may
+000175b0: 2061 6c73 6f20 6265 2061 2064 6963 742d   also be a dict-
+000175c0: 6c69 6b65 206f 626a 6563 7420 7769 7468  like object with
+000175d0: 206b 6579 730a 2020 2020 2020 2020 2020   keys.          
+000175e0: 2020 6d61 7463 6869 6e67 2069 6e64 6578    matching index
+000175f0: 206c 6576 656c 206e 616d 6573 2e0a 2020   level names..  
+00017600: 2020 2020 2020 2020 2020 4966 2044 6174            If Dat
+00017610: 6141 7272 6179 7320 6172 6520 7061 7373  aArrays are pass
+00017620: 6564 2061 7320 696e 6465 7865 7273 2c20  ed as indexers, 
+00017630: 7861 7272 6179 2d73 7479 6c65 2069 6e64  xarray-style ind
+00017640: 6578 696e 6720 7769 6c6c 2062 650a 2020  exing will be.  
+00017650: 2020 2020 2020 2020 2020 6361 7272 6965            carrie
+00017660: 6420 6f75 742e 2053 6565 203a 7265 663a  d out. See :ref:
+00017670: 6069 6e64 6578 696e 6760 2066 6f72 2074  `indexing` for t
+00017680: 6865 2064 6574 6169 6c73 2e0a 2020 2020  he details..    
+00017690: 2020 2020 2020 2020 4f6e 6520 6f66 2069          One of i
+000176a0: 6e64 6578 6572 7320 6f72 2069 6e64 6578  ndexers or index
+000176b0: 6572 735f 6b77 6172 6773 206d 7573 7420  ers_kwargs must 
+000176c0: 6265 2070 726f 7669 6465 642e 0a20 2020  be provided..   
+000176d0: 2020 2020 206d 6574 686f 6420 3a20 7b4e       method : {N
+000176e0: 6f6e 652c 2022 6e65 6172 6573 7422 2c20  one, "nearest", 
+000176f0: 2270 6164 222c 2022 6666 696c 6c22 2c20  "pad", "ffill", 
+00017700: 2262 6163 6b66 696c 6c22 2c20 2262 6669  "backfill", "bfi
+00017710: 6c6c 227d 2c20 6f70 7469 6f6e 616c 0a20  ll"}, optional. 
+00017720: 2020 2020 2020 2020 2020 204d 6574 686f             Metho
+00017730: 6420 746f 2075 7365 2066 6f72 2069 6e65  d to use for ine
+00017740: 7861 6374 206d 6174 6368 6573 3a0a 0a20  xact matches:.. 
+00017750: 2020 2020 2020 2020 2020 202a 204e 6f6e             * Non
+00017760: 6520 2864 6566 6175 6c74 293a 206f 6e6c  e (default): onl
+00017770: 7920 6578 6163 7420 6d61 7463 6865 730a  y exact matches.
+00017780: 2020 2020 2020 2020 2020 2020 2a20 7061              * pa
+00017790: 6420 2f20 6666 696c 6c3a 2070 726f 7061  d / ffill: propa
+000177a0: 6761 7465 206c 6173 7420 7661 6c69 6420  gate last valid 
+000177b0: 696e 6465 7820 7661 6c75 6520 666f 7277  index value forw
+000177c0: 6172 640a 2020 2020 2020 2020 2020 2020  ard.            
+000177d0: 2a20 6261 636b 6669 6c6c 202f 2062 6669  * backfill / bfi
+000177e0: 6c6c 3a20 7072 6f70 6167 6174 6520 6e65  ll: propagate ne
+000177f0: 7874 2076 616c 6964 2069 6e64 6578 2076  xt valid index v
+00017800: 616c 7565 2062 6163 6b77 6172 640a 2020  alue backward.  
+00017810: 2020 2020 2020 2020 2020 2a20 6e65 6172            * near
+00017820: 6573 743a 2075 7365 206e 6561 7265 7374  est: use nearest
+00017830: 2076 616c 6964 2069 6e64 6578 2076 616c   valid index val
+00017840: 7565 0a20 2020 2020 2020 2074 6f6c 6572  ue.        toler
+00017850: 616e 6365 203a 206f 7074 696f 6e61 6c0a  ance : optional.
+00017860: 2020 2020 2020 2020 2020 2020 4d61 7869              Maxi
+00017870: 6d75 6d20 6469 7374 616e 6365 2062 6574  mum distance bet
+00017880: 7765 656e 206f 7269 6769 6e61 6c20 616e  ween original an
+00017890: 6420 6e65 7720 6c61 6265 6c73 2066 6f72  d new labels for
+000178a0: 2069 6e65 7861 6374 0a20 2020 2020 2020   inexact.       
+000178b0: 2020 2020 206d 6174 6368 6573 2e20 5468       matches. Th
+000178c0: 6520 7661 6c75 6573 206f 6620 7468 6520  e values of the 
+000178d0: 696e 6465 7820 6174 2074 6865 206d 6174  index at the mat
+000178e0: 6368 696e 6720 6c6f 6361 7469 6f6e 7320  ching locations 
+000178f0: 6d75 7374 0a20 2020 2020 2020 2020 2020  must.           
+00017900: 2073 6174 6973 6679 2074 6865 2065 7175   satisfy the equ
+00017910: 6174 696f 6e20 6060 6162 7328 696e 6465  ation ``abs(inde
+00017920: 785b 696e 6465 7865 725d 202d 2074 6172  x[indexer] - tar
+00017930: 6765 7429 203c 3d20 746f 6c65 7261 6e63  get) <= toleranc
+00017940: 6560 602e 0a20 2020 2020 2020 2064 726f  e``..        dro
+00017950: 7020 3a20 626f 6f6c 2c20 6f70 7469 6f6e  p : bool, option
+00017960: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+00017970: 6620 6060 6472 6f70 3d54 7275 6560 602c  f ``drop=True``,
+00017980: 2064 726f 7020 636f 6f72 6469 6e61 7465   drop coordinate
+00017990: 7320 7661 7269 6162 6c65 7320 696e 2060  s variables in `
+000179a0: 696e 6465 7865 7273 6020 696e 7374 6561  indexers` instea
+000179b0: 640a 2020 2020 2020 2020 2020 2020 6f66  d.            of
+000179c0: 206d 616b 696e 6720 7468 656d 2073 6361   making them sca
+000179d0: 6c61 722e 0a20 2020 2020 2020 202a 2a69  lar..        **i
+000179e0: 6e64 6578 6572 735f 6b77 6172 6773 203a  ndexers_kwargs :
+000179f0: 207b 6469 6d3a 2069 6e64 6578 6572 2c20   {dim: indexer, 
+00017a00: 2e2e 2e7d 2c20 6f70 7469 6f6e 616c 0a20  ...}, optional. 
+00017a10: 2020 2020 2020 2020 2020 2054 6865 206b             The k
+00017a20: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
+00017a30: 2066 6f72 6d20 6f66 2060 6069 6e64 6578   form of ``index
+00017a40: 6572 7360 602e 0a20 2020 2020 2020 2020  ers``..         
+00017a50: 2020 204f 6e65 206f 6620 696e 6465 7865     One of indexe
+00017a60: 7273 206f 7220 696e 6465 7865 7273 5f6b  rs or indexers_k
+00017a70: 7761 7267 7320 6d75 7374 2062 6520 7072  wargs must be pr
+00017a80: 6f76 6964 6564 2e0a 0a20 2020 2020 2020  ovided...       
+00017a90: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00017aa0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00017ab0: 206f 626a 203a 2044 6174 6173 6574 0a20   obj : Dataset. 
+00017ac0: 2020 2020 2020 2020 2020 2041 206e 6577             A new
+00017ad0: 2044 6174 6173 6574 2077 6974 6820 7468   Dataset with th
+00017ae0: 6520 7361 6d65 2063 6f6e 7465 6e74 7320  e same contents 
+00017af0: 6173 2074 6869 7320 6461 7461 7365 742c  as this dataset,
+00017b00: 2065 7863 6570 7420 6561 6368 0a20 2020   except each.   
+00017b10: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
+00017b20: 6520 616e 6420 6469 6d65 6e73 696f 6e20  e and dimension 
+00017b30: 6973 2069 6e64 6578 6564 2062 7920 7468  is indexed by th
+00017b40: 6520 6170 7072 6f70 7269 6174 6520 696e  e appropriate in
+00017b50: 6465 7865 7273 2e0a 2020 2020 2020 2020  dexers..        
+00017b60: 2020 2020 4966 2069 6e64 6578 6572 2044      If indexer D
+00017b70: 6174 6141 7272 6179 7320 6861 7665 2063  ataArrays have c
+00017b80: 6f6f 7264 696e 6174 6573 2074 6861 7420  oordinates that 
+00017b90: 646f 206e 6f74 2063 6f6e 666c 6963 7420  do not conflict 
+00017ba0: 7769 7468 0a20 2020 2020 2020 2020 2020  with.           
+00017bb0: 2074 6869 7320 6f62 6a65 6374 2c20 7468   this object, th
+00017bc0: 656e 2074 6865 7365 2063 6f6f 7264 696e  en these coordin
+00017bd0: 6174 6573 2077 696c 6c20 6265 2061 7474  ates will be att
+00017be0: 6163 6865 642e 0a20 2020 2020 2020 2020  ached..         
+00017bf0: 2020 2049 6e20 6765 6e65 7261 6c2c 2065     In general, e
+00017c00: 6163 6820 6172 7261 7927 7320 6461 7461  ach array's data
+00017c10: 2077 696c 6c20 6265 2061 2076 6965 7720   will be a view 
+00017c20: 6f66 2074 6865 2061 7272 6179 2773 2064  of the array's d
+00017c30: 6174 610a 2020 2020 2020 2020 2020 2020  ata.            
+00017c40: 696e 2074 6869 7320 6461 7461 7365 742c  in this dataset,
+00017c50: 2075 6e6c 6573 7320 7665 6374 6f72 697a   unless vectoriz
+00017c60: 6564 2069 6e64 6578 696e 6720 7761 7320  ed indexing was 
+00017c70: 7472 6967 6765 7265 6420 6279 2075 7369  triggered by usi
+00017c80: 6e67 0a20 2020 2020 2020 2020 2020 2061  ng.            a
+00017c90: 6e20 6172 7261 7920 696e 6465 7865 722c  n array indexer,
+00017ca0: 2069 6e20 7768 6963 6820 6361 7365 2074   in which case t
+00017cb0: 6865 2064 6174 6120 7769 6c6c 2062 6520  he data will be 
+00017cc0: 6120 636f 7079 2e0a 0a20 2020 2020 2020  a copy...       
+00017cd0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+00017ce0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00017cf0: 2020 2044 6174 6173 6574 2e69 7365 6c0a     Dataset.isel.
+00017d00: 2020 2020 2020 2020 4461 7461 4172 7261          DataArra
+00017d10: 792e 7365 6c0a 2020 2020 2020 2020 2222  y.sel.        ""
+00017d20: 220a 2020 2020 2020 2020 696e 6465 7865  ".        indexe
+00017d30: 7273 203d 2065 6974 6865 725f 6469 6374  rs = either_dict
+00017d40: 5f6f 725f 6b77 6172 6773 2869 6e64 6578  _or_kwargs(index
+00017d50: 6572 732c 2069 6e64 6578 6572 735f 6b77  ers, indexers_kw
+00017d60: 6172 6773 2c20 2273 656c 2229 0a20 2020  args, "sel").   
+00017d70: 2020 2020 2071 7565 7279 5f72 6573 756c       query_resul
+00017d80: 7473 203d 206d 6170 5f69 6e64 6578 5f71  ts = map_index_q
+00017d90: 7565 7269 6573 280a 2020 2020 2020 2020  ueries(.        
+00017da0: 2020 2020 7365 6c66 2c20 696e 6465 7865      self, indexe
+00017db0: 7273 3d69 6e64 6578 6572 732c 206d 6574  rs=indexers, met
+00017dc0: 686f 643d 6d65 7468 6f64 2c20 746f 6c65  hod=method, tole
+00017dd0: 7261 6e63 653d 746f 6c65 7261 6e63 650a  rance=tolerance.
+00017de0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00017df0: 2020 2069 6620 6472 6f70 3a0a 2020 2020     if drop:.    
+00017e00: 2020 2020 2020 2020 6e6f 5f73 6361 6c61          no_scala
+00017e10: 725f 7661 7269 6162 6c65 7320 3d20 7b7d  r_variables = {}
+00017e20: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00017e30: 206b 2c20 7620 696e 2071 7565 7279 5f72   k, v in query_r
+00017e40: 6573 756c 7473 2e76 6172 6961 626c 6573  esults.variables
+00017e50: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+00017e60: 2020 2020 2020 2020 2020 6966 2076 2e64            if v.d
+00017e70: 696d 733a 0a20 2020 2020 2020 2020 2020  ims:.           
+00017e80: 2020 2020 2020 2020 206e 6f5f 7363 616c           no_scal
+00017e90: 6172 5f76 6172 6961 626c 6573 5b6b 5d20  ar_variables[k] 
+00017ea0: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
+00017eb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00017ec0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00017ed0: 206b 2069 6e20 7365 6c66 2e5f 636f 6f72   k in self._coor
+00017ee0: 645f 6e61 6d65 733a 0a20 2020 2020 2020  d_names:.       
+00017ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017f00: 2071 7565 7279 5f72 6573 756c 7473 2e64   query_results.d
+00017f10: 726f 705f 636f 6f72 6473 2e61 7070 656e  rop_coords.appen
+00017f20: 6428 6b29 0a20 2020 2020 2020 2020 2020  d(k).           
+00017f30: 2071 7565 7279 5f72 6573 756c 7473 2e76   query_results.v
+00017f40: 6172 6961 626c 6573 203d 206e 6f5f 7363  ariables = no_sc
+00017f50: 616c 6172 5f76 6172 6961 626c 6573 0a0a  alar_variables..
+00017f60: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+00017f70: 2073 656c 662e 6973 656c 2869 6e64 6578   self.isel(index
+00017f80: 6572 733d 7175 6572 795f 7265 7375 6c74  ers=query_result
+00017f90: 732e 6469 6d5f 696e 6465 7865 7273 2c20  s.dim_indexers, 
+00017fa0: 6472 6f70 3d64 726f 7029 0a20 2020 2020  drop=drop).     
+00017fb0: 2020 2072 6574 7572 6e20 7265 7375 6c74     return result
+00017fc0: 2e5f 6f76 6572 7772 6974 655f 696e 6465  ._overwrite_inde
+00017fd0: 7865 7328 2a71 7565 7279 5f72 6573 756c  xes(*query_resul
+00017fe0: 7473 2e61 735f 7475 706c 6528 295b 313a  ts.as_tuple()[1:
+00017ff0: 5d29 0a0a 2020 2020 6465 6620 6865 6164  ])..    def head
+00018000: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
+00018010: 545f 4461 7461 7365 742c 0a20 2020 2020  T_Dataset,.     
+00018020: 2020 2069 6e64 6578 6572 733a 204d 6170     indexers: Map
+00018030: 7069 6e67 5b41 6e79 2c20 696e 745d 207c  ping[Any, int] |
+00018040: 2069 6e74 207c 204e 6f6e 6520 3d20 4e6f   int | None = No
+00018050: 6e65 2c0a 2020 2020 2020 2020 2a2a 696e  ne,.        **in
+00018060: 6465 7865 7273 5f6b 7761 7267 733a 2041  dexers_kwargs: A
+00018070: 6e79 2c0a 2020 2020 2920 2d3e 2054 5f44  ny,.    ) -> T_D
+00018080: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00018090: 2222 2252 6574 7572 6e73 2061 206e 6577  """Returns a new
+000180a0: 2064 6174 6173 6574 2077 6974 6820 7468   dataset with th
+000180b0: 6520 6669 7273 7420 606e 6020 7661 6c75  e first `n` valu
+000180c0: 6573 206f 6620 6561 6368 2061 7272 6179  es of each array
+000180d0: 0a20 2020 2020 2020 2066 6f72 2074 6865  .        for the
+000180e0: 2073 7065 6369 6669 6564 2064 696d 656e   specified dimen
+000180f0: 7369 6f6e 2873 292e 0a0a 2020 2020 2020  sion(s)...      
+00018100: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00018110: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00018120: 2020 2020 2020 2020 696e 6465 7865 7273          indexers
+00018130: 203a 2064 6963 7420 6f72 2069 6e74 2c20   : dict or int, 
+00018140: 6465 6661 756c 743a 2035 0a20 2020 2020  default: 5.     
+00018150: 2020 2020 2020 2041 2064 6963 7420 7769         A dict wi
+00018160: 7468 206b 6579 7320 6d61 7463 6869 6e67  th keys matching
+00018170: 2064 696d 656e 7369 6f6e 7320 616e 6420   dimensions and 
+00018180: 696e 7465 6765 7220 7661 6c75 6573 2060  integer values `
+00018190: 6e60 0a20 2020 2020 2020 2020 2020 206f  n`.            o
+000181a0: 7220 6120 7369 6e67 6c65 2069 6e74 6567  r a single integ
+000181b0: 6572 2060 6e60 2061 7070 6c69 6564 206f  er `n` applied o
+000181c0: 7665 7220 616c 6c20 6469 6d65 6e73 696f  ver all dimensio
+000181d0: 6e73 2e0a 2020 2020 2020 2020 2020 2020  ns..            
+000181e0: 4f6e 6520 6f66 2069 6e64 6578 6572 7320  One of indexers 
+000181f0: 6f72 2069 6e64 6578 6572 735f 6b77 6172  or indexers_kwar
+00018200: 6773 206d 7573 7420 6265 2070 726f 7669  gs must be provi
+00018210: 6465 642e 0a20 2020 2020 2020 202a 2a69  ded..        **i
+00018220: 6e64 6578 6572 735f 6b77 6172 6773 203a  ndexers_kwargs :
+00018230: 207b 6469 6d3a 206e 2c20 2e2e 2e7d 2c20   {dim: n, ...}, 
+00018240: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00018250: 2020 2020 2054 6865 206b 6579 776f 7264       The keyword
+00018260: 2061 7267 756d 656e 7473 2066 6f72 6d20   arguments form 
+00018270: 6f66 2060 6069 6e64 6578 6572 7360 602e  of ``indexers``.
+00018280: 0a20 2020 2020 2020 2020 2020 204f 6e65  .            One
+00018290: 206f 6620 696e 6465 7865 7273 206f 7220   of indexers or 
+000182a0: 696e 6465 7865 7273 5f6b 7761 7267 7320  indexers_kwargs 
+000182b0: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
+000182c0: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+000182d0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+000182e0: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
+000182f0: 6173 6574 2e74 6169 6c0a 2020 2020 2020  aset.tail.      
+00018300: 2020 4461 7461 7365 742e 7468 696e 0a20    Dataset.thin. 
+00018310: 2020 2020 2020 2044 6174 6141 7272 6179         DataArray
+00018320: 2e68 6561 640a 2020 2020 2020 2020 2222  .head.        ""
+00018330: 220a 2020 2020 2020 2020 6966 206e 6f74  ".        if not
+00018340: 2069 6e64 6578 6572 735f 6b77 6172 6773   indexers_kwargs
+00018350: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00018360: 2069 6e64 6578 6572 7320 6973 204e 6f6e   indexers is Non
+00018370: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00018380: 2020 2069 6e64 6578 6572 7320 3d20 350a     indexers = 5.
+00018390: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+000183a0: 6f74 2069 7369 6e73 7461 6e63 6528 696e  ot isinstance(in
+000183b0: 6465 7865 7273 2c20 696e 7429 2061 6e64  dexers, int) and
+000183c0: 206e 6f74 2069 735f 6469 6374 5f6c 696b   not is_dict_lik
+000183d0: 6528 696e 6465 7865 7273 293a 0a20 2020  e(indexers):.   
+000183e0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000183f0: 7365 2054 7970 6545 7272 6f72 2822 696e  se TypeError("in
+00018400: 6465 7865 7273 206d 7573 7420 6265 2065  dexers must be e
+00018410: 6974 6865 7220 6469 6374 2d6c 696b 6520  ither dict-like 
+00018420: 6f72 2061 2073 696e 676c 6520 696e 7465  or a single inte
+00018430: 6765 7222 290a 2020 2020 2020 2020 6966  ger").        if
+00018440: 2069 7369 6e73 7461 6e63 6528 696e 6465   isinstance(inde
+00018450: 7865 7273 2c20 696e 7429 3a0a 2020 2020  xers, int):.    
+00018460: 2020 2020 2020 2020 696e 6465 7865 7273          indexers
+00018470: 203d 207b 6469 6d3a 2069 6e64 6578 6572   = {dim: indexer
+00018480: 7320 666f 7220 6469 6d20 696e 2073 656c  s for dim in sel
+00018490: 662e 6469 6d73 7d0a 2020 2020 2020 2020  f.dims}.        
+000184a0: 696e 6465 7865 7273 203d 2065 6974 6865  indexers = eithe
+000184b0: 725f 6469 6374 5f6f 725f 6b77 6172 6773  r_dict_or_kwargs
+000184c0: 2869 6e64 6578 6572 732c 2069 6e64 6578  (indexers, index
+000184d0: 6572 735f 6b77 6172 6773 2c20 2268 6561  ers_kwargs, "hea
+000184e0: 6422 290a 2020 2020 2020 2020 666f 7220  d").        for 
+000184f0: 6b2c 2076 2069 6e20 696e 6465 7865 7273  k, v in indexers
+00018500: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+00018510: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00018520: 6e73 7461 6e63 6528 762c 2069 6e74 293a  nstance(v, int):
+00018530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018540: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00018550: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00018560: 2020 2020 2020 2265 7870 6563 7465 6420        "expected 
+00018570: 696e 7465 6765 7220 7479 7065 2069 6e64  integer type ind
+00018580: 6578 6572 2066 6f72 2022 0a20 2020 2020  exer for ".     
+00018590: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000185a0: 2264 696d 656e 7369 6f6e 207b 6b21 727d  "dimension {k!r}
+000185b0: 2c20 666f 756e 6420 7b74 7970 6528 7629  , found {type(v)
+000185c0: 2172 7d22 0a20 2020 2020 2020 2020 2020  !r}".           
+000185d0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000185e0: 2020 2065 6c69 6620 7620 3c20 303a 0a20     elif v < 0:. 
+000185f0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00018600: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00018610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018620: 2020 2020 2022 6578 7065 6374 6564 2070       "expected p
+00018630: 6f73 6974 6976 6520 696e 7465 6765 7220  ositive integer 
+00018640: 6173 2069 6e64 6578 6572 2022 0a20 2020  as indexer ".   
+00018650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018660: 2066 2266 6f72 2064 696d 656e 7369 6f6e   f"for dimension
+00018670: 207b 6b21 727d 2c20 666f 756e 6420 7b76   {k!r}, found {v
+00018680: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00018690: 2020 2029 0a20 2020 2020 2020 2069 6e64     ).        ind
+000186a0: 6578 6572 735f 736c 6963 6573 203d 207b  exers_slices = {
+000186b0: 6b3a 2073 6c69 6365 2876 616c 2920 666f  k: slice(val) fo
+000186c0: 7220 6b2c 2076 616c 2069 6e20 696e 6465  r k, val in inde
+000186d0: 7865 7273 2e69 7465 6d73 2829 7d0a 2020  xers.items()}.  
+000186e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+000186f0: 662e 6973 656c 2869 6e64 6578 6572 735f  f.isel(indexers_
+00018700: 736c 6963 6573 290a 0a20 2020 2064 6566  slices)..    def
+00018710: 2074 6169 6c28 0a20 2020 2020 2020 2073   tail(.        s
+00018720: 656c 663a 2054 5f44 6174 6173 6574 2c0a  elf: T_Dataset,.
+00018730: 2020 2020 2020 2020 696e 6465 7865 7273          indexers
+00018740: 3a20 4d61 7070 696e 675b 416e 792c 2069  : Mapping[Any, i
+00018750: 6e74 5d20 7c20 696e 7420 7c20 4e6f 6e65  nt] | int | None
+00018760: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00018770: 202a 2a69 6e64 6578 6572 735f 6b77 6172   **indexers_kwar
+00018780: 6773 3a20 416e 792c 0a20 2020 2029 202d  gs: Any,.    ) -
+00018790: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
+000187a0: 2020 2020 2022 2222 5265 7475 726e 7320       """Returns 
+000187b0: 6120 6e65 7720 6461 7461 7365 7420 7769  a new dataset wi
+000187c0: 7468 2074 6865 206c 6173 7420 606e 6020  th the last `n` 
+000187d0: 7661 6c75 6573 206f 6620 6561 6368 2061  values of each a
+000187e0: 7272 6179 0a20 2020 2020 2020 2066 6f72  rray.        for
+000187f0: 2074 6865 2073 7065 6369 6669 6564 2064   the specified d
+00018800: 696d 656e 7369 6f6e 2873 292e 0a0a 2020  imension(s)...  
+00018810: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00018820: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00018830: 2d2d 2d0a 2020 2020 2020 2020 696e 6465  ---.        inde
+00018840: 7865 7273 203a 2064 6963 7420 6f72 2069  xers : dict or i
+00018850: 6e74 2c20 6465 6661 756c 743a 2035 0a20  nt, default: 5. 
+00018860: 2020 2020 2020 2020 2020 2041 2064 6963             A dic
+00018870: 7420 7769 7468 206b 6579 7320 6d61 7463  t with keys matc
+00018880: 6869 6e67 2064 696d 656e 7369 6f6e 7320  hing dimensions 
+00018890: 616e 6420 696e 7465 6765 7220 7661 6c75  and integer valu
+000188a0: 6573 2060 6e60 0a20 2020 2020 2020 2020  es `n`.         
+000188b0: 2020 206f 7220 6120 7369 6e67 6c65 2069     or a single i
+000188c0: 6e74 6567 6572 2060 6e60 2061 7070 6c69  nteger `n` appli
+000188d0: 6564 206f 7665 7220 616c 6c20 6469 6d65  ed over all dime
+000188e0: 6e73 696f 6e73 2e0a 2020 2020 2020 2020  nsions..        
+000188f0: 2020 2020 4f6e 6520 6f66 2069 6e64 6578      One of index
+00018900: 6572 7320 6f72 2069 6e64 6578 6572 735f  ers or indexers_
+00018910: 6b77 6172 6773 206d 7573 7420 6265 2070  kwargs must be p
+00018920: 726f 7669 6465 642e 0a20 2020 2020 2020  rovided..       
+00018930: 202a 2a69 6e64 6578 6572 735f 6b77 6172   **indexers_kwar
+00018940: 6773 203a 207b 6469 6d3a 206e 2c20 2e2e  gs : {dim: n, ..
+00018950: 2e7d 2c20 6f70 7469 6f6e 616c 0a20 2020  .}, optional.   
+00018960: 2020 2020 2020 2020 2054 6865 206b 6579           The key
+00018970: 776f 7264 2061 7267 756d 656e 7473 2066  word arguments f
+00018980: 6f72 6d20 6f66 2060 6069 6e64 6578 6572  orm of ``indexer
+00018990: 7360 602e 0a20 2020 2020 2020 2020 2020  s``..           
+000189a0: 204f 6e65 206f 6620 696e 6465 7865 7273   One of indexers
+000189b0: 206f 7220 696e 6465 7865 7273 5f6b 7761   or indexers_kwa
+000189c0: 7267 7320 6d75 7374 2062 6520 7072 6f76  rgs must be prov
+000189d0: 6964 6564 2e0a 0a20 2020 2020 2020 2053  ided...        S
+000189e0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+000189f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00018a00: 2044 6174 6173 6574 2e68 6561 640a 2020   Dataset.head.  
+00018a10: 2020 2020 2020 4461 7461 7365 742e 7468        Dataset.th
+00018a20: 696e 0a20 2020 2020 2020 2044 6174 6141  in.        DataA
+00018a30: 7272 6179 2e74 6169 6c0a 2020 2020 2020  rray.tail.      
+00018a40: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00018a50: 206e 6f74 2069 6e64 6578 6572 735f 6b77   not indexers_kw
+00018a60: 6172 6773 3a0a 2020 2020 2020 2020 2020  args:.          
+00018a70: 2020 6966 2069 6e64 6578 6572 7320 6973    if indexers is
+00018a80: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00018a90: 2020 2020 2020 2069 6e64 6578 6572 7320         indexers 
+00018aa0: 3d20 350a 2020 2020 2020 2020 2020 2020  = 5.            
+00018ab0: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00018ac0: 6528 696e 6465 7865 7273 2c20 696e 7429  e(indexers, int)
+00018ad0: 2061 6e64 206e 6f74 2069 735f 6469 6374   and not is_dict
+00018ae0: 5f6c 696b 6528 696e 6465 7865 7273 293a  _like(indexers):
+00018af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018b00: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
+00018b10: 2822 696e 6465 7865 7273 206d 7573 7420  ("indexers must 
+00018b20: 6265 2065 6974 6865 7220 6469 6374 2d6c  be either dict-l
+00018b30: 696b 6520 6f72 2061 2073 696e 676c 6520  ike or a single 
+00018b40: 696e 7465 6765 7222 290a 2020 2020 2020  integer").      
+00018b50: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00018b60: 696e 6465 7865 7273 2c20 696e 7429 3a0a  indexers, int):.
+00018b70: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00018b80: 7865 7273 203d 207b 6469 6d3a 2069 6e64  xers = {dim: ind
+00018b90: 6578 6572 7320 666f 7220 6469 6d20 696e  exers for dim in
+00018ba0: 2073 656c 662e 6469 6d73 7d0a 2020 2020   self.dims}.    
+00018bb0: 2020 2020 696e 6465 7865 7273 203d 2065      indexers = e
+00018bc0: 6974 6865 725f 6469 6374 5f6f 725f 6b77  ither_dict_or_kw
+00018bd0: 6172 6773 2869 6e64 6578 6572 732c 2069  args(indexers, i
+00018be0: 6e64 6578 6572 735f 6b77 6172 6773 2c20  ndexers_kwargs, 
+00018bf0: 2274 6169 6c22 290a 2020 2020 2020 2020  "tail").        
+00018c00: 666f 7220 6b2c 2076 2069 6e20 696e 6465  for k, v in inde
+00018c10: 7865 7273 2e69 7465 6d73 2829 3a0a 2020  xers.items():.  
+00018c20: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+00018c30: 2069 7369 6e73 7461 6e63 6528 762c 2069   isinstance(v, i
+00018c40: 6e74 293a 0a20 2020 2020 2020 2020 2020  nt):.           
+00018c50: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00018c60: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00018c70: 2020 2020 2020 2020 2020 2265 7870 6563            "expec
+00018c80: 7465 6420 696e 7465 6765 7220 7479 7065  ted integer type
+00018c90: 2069 6e64 6578 6572 2066 6f72 2022 0a20   indexer for ". 
+00018ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018cb0: 2020 2066 2264 696d 656e 7369 6f6e 207b     f"dimension {
+00018cc0: 6b21 727d 2c20 666f 756e 6420 7b74 7970  k!r}, found {typ
+00018cd0: 6528 7629 2172 7d22 0a20 2020 2020 2020  e(v)!r}".       
+00018ce0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00018cf0: 2020 2020 2020 2065 6c69 6620 7620 3c20         elif v < 
+00018d00: 303a 0a20 2020 2020 2020 2020 2020 2020  0:.             
+00018d10: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00018d20: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00018d30: 2020 2020 2020 2020 2022 6578 7065 6374           "expect
+00018d40: 6564 2070 6f73 6974 6976 6520 696e 7465  ed positive inte
+00018d50: 6765 7220 6173 2069 6e64 6578 6572 2022  ger as indexer "
+00018d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018d70: 2020 2020 2066 2266 6f72 2064 696d 656e       f"for dimen
+00018d80: 7369 6f6e 207b 6b21 727d 2c20 666f 756e  sion {k!r}, foun
+00018d90: 6420 7b76 7d22 0a20 2020 2020 2020 2020  d {v}".         
+00018da0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00018db0: 2069 6e64 6578 6572 735f 736c 6963 6573   indexers_slices
+00018dc0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+00018dd0: 206b 3a20 736c 6963 6528 2d76 616c 2c20   k: slice(-val, 
+00018de0: 4e6f 6e65 2920 6966 2076 616c 2021 3d20  None) if val != 
+00018df0: 3020 656c 7365 2073 6c69 6365 2876 616c  0 else slice(val
+00018e00: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+00018e10: 7220 6b2c 2076 616c 2069 6e20 696e 6465  r k, val in inde
+00018e20: 7865 7273 2e69 7465 6d73 2829 0a20 2020  xers.items().   
+00018e30: 2020 2020 207d 0a20 2020 2020 2020 2072       }.        r
+00018e40: 6574 7572 6e20 7365 6c66 2e69 7365 6c28  eturn self.isel(
+00018e50: 696e 6465 7865 7273 5f73 6c69 6365 7329  indexers_slices)
+00018e60: 0a0a 2020 2020 6465 6620 7468 696e 280a  ..    def thin(.
+00018e70: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
+00018e80: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
+00018e90: 2069 6e64 6578 6572 733a 204d 6170 7069   indexers: Mappi
+00018ea0: 6e67 5b41 6e79 2c20 696e 745d 207c 2069  ng[Any, int] | i
+00018eb0: 6e74 207c 204e 6f6e 6520 3d20 4e6f 6e65  nt | None = None
+00018ec0: 2c0a 2020 2020 2020 2020 2a2a 696e 6465  ,.        **inde
+00018ed0: 7865 7273 5f6b 7761 7267 733a 2041 6e79  xers_kwargs: Any
+00018ee0: 2c0a 2020 2020 2920 2d3e 2054 5f44 6174  ,.    ) -> T_Dat
+00018ef0: 6173 6574 3a0a 2020 2020 2020 2020 2222  aset:.        ""
+00018f00: 2252 6574 7572 6e73 2061 206e 6577 2064  "Returns a new d
+00018f10: 6174 6173 6574 2077 6974 6820 6561 6368  ataset with each
+00018f20: 2061 7272 6179 2069 6e64 6578 6564 2061   array indexed a
+00018f30: 6c6f 6e67 2065 7665 7279 2060 6e60 2d74  long every `n`-t
+00018f40: 680a 2020 2020 2020 2020 7661 6c75 6520  h.        value 
+00018f50: 666f 7220 7468 6520 7370 6563 6966 6965  for the specifie
+00018f60: 6420 6469 6d65 6e73 696f 6e28 7329 0a0a  d dimension(s)..
+00018f70: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00018f80: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00018f90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 696e  -----.        in
+00018fa0: 6465 7865 7273 203a 2064 6963 7420 6f72  dexers : dict or
+00018fb0: 2069 6e74 0a20 2020 2020 2020 2020 2020   int.           
+00018fc0: 2041 2064 6963 7420 7769 7468 206b 6579   A dict with key
+00018fd0: 7320 6d61 7463 6869 6e67 2064 696d 656e  s matching dimen
+00018fe0: 7369 6f6e 7320 616e 6420 696e 7465 6765  sions and intege
+00018ff0: 7220 7661 6c75 6573 2060 6e60 0a20 2020  r values `n`.   
+00019000: 2020 2020 2020 2020 206f 7220 6120 7369           or a si
+00019010: 6e67 6c65 2069 6e74 6567 6572 2060 6e60  ngle integer `n`
+00019020: 2061 7070 6c69 6564 206f 7665 7220 616c   applied over al
+00019030: 6c20 6469 6d65 6e73 696f 6e73 2e0a 2020  l dimensions..  
+00019040: 2020 2020 2020 2020 2020 4f6e 6520 6f66            One of
+00019050: 2069 6e64 6578 6572 7320 6f72 2069 6e64   indexers or ind
+00019060: 6578 6572 735f 6b77 6172 6773 206d 7573  exers_kwargs mus
+00019070: 7420 6265 2070 726f 7669 6465 642e 0a20  t be provided.. 
+00019080: 2020 2020 2020 202a 2a69 6e64 6578 6572         **indexer
+00019090: 735f 6b77 6172 6773 203a 207b 6469 6d3a  s_kwargs : {dim:
+000190a0: 206e 2c20 2e2e 2e7d 2c20 6f70 7469 6f6e   n, ...}, option
+000190b0: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
+000190c0: 6865 206b 6579 776f 7264 2061 7267 756d  he keyword argum
+000190d0: 656e 7473 2066 6f72 6d20 6f66 2060 6069  ents form of ``i
+000190e0: 6e64 6578 6572 7360 602e 0a20 2020 2020  ndexers``..     
+000190f0: 2020 2020 2020 204f 6e65 206f 6620 696e         One of in
+00019100: 6465 7865 7273 206f 7220 696e 6465 7865  dexers or indexe
+00019110: 7273 5f6b 7761 7267 7320 6d75 7374 2062  rs_kwargs must b
+00019120: 6520 7072 6f76 6964 6564 2e0a 0a20 2020  e provided...   
+00019130: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+00019140: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00019150: 2020 2020 2020 203e 3e3e 2078 5f61 7272         >>> x_arr
+00019160: 203d 206e 702e 6172 616e 6765 2830 2c20   = np.arange(0, 
+00019170: 3236 290a 2020 2020 2020 2020 3e3e 3e20  26).        >>> 
+00019180: 785f 6172 720a 2020 2020 2020 2020 6172  x_arr.        ar
+00019190: 7261 7928 5b20 302c 2020 312c 2020 322c  ray([ 0,  1,  2,
+000191a0: 2020 332c 2020 342c 2020 352c 2020 362c    3,  4,  5,  6,
+000191b0: 2020 372c 2020 382c 2020 392c 2031 302c    7,  8,  9, 10,
+000191c0: 2031 312c 2031 322c 2031 332c 2031 342c   11, 12, 13, 14,
+000191d0: 2031 352c 2031 362c 0a20 2020 2020 2020   15, 16,.       
+000191e0: 2020 2020 2020 2020 3137 2c20 3138 2c20          17, 18, 
+000191f0: 3139 2c20 3230 2c20 3231 2c20 3232 2c20  19, 20, 21, 22, 
+00019200: 3233 2c20 3234 2c20 3235 5d29 0a20 2020  23, 24, 25]).   
+00019210: 2020 2020 203e 3e3e 2078 203d 2078 722e       >>> x = xr.
+00019220: 4461 7461 4172 7261 7928 0a20 2020 2020  DataArray(.     
+00019230: 2020 202e 2e2e 2020 2020 206e 702e 7265     ...     np.re
+00019240: 7368 6170 6528 785f 6172 722c 2028 322c  shape(x_arr, (2,
+00019250: 2031 3329 292c 0a20 2020 2020 2020 202e   13)),.        .
+00019260: 2e2e 2020 2020 2064 696d 733d 2822 7822  ..     dims=("x"
+00019270: 2c20 2279 2229 2c0a 2020 2020 2020 2020  , "y"),.        
+00019280: 2e2e 2e20 2020 2020 636f 6f72 6473 3d7b  ...     coords={
+00019290: 2278 223a 205b 302c 2031 5d2c 2022 7922  "x": [0, 1], "y"
+000192a0: 3a20 6e70 2e61 7261 6e67 6528 302c 2031  : np.arange(0, 1
+000192b0: 3329 7d2c 0a20 2020 2020 2020 202e 2e2e  3)},.        ...
+000192c0: 2029 0a20 2020 2020 2020 203e 3e3e 2078   ).        >>> x
+000192d0: 5f64 7320 3d20 7872 2e44 6174 6173 6574  _ds = xr.Dataset
+000192e0: 287b 2266 6f6f 223a 2078 7d29 0a20 2020  ({"foo": x}).   
+000192f0: 2020 2020 203e 3e3e 2078 5f64 730a 2020       >>> x_ds.  
+00019300: 2020 2020 2020 3c78 6172 7261 792e 4461        <xarray.Da
+00019310: 7461 7365 743e 0a20 2020 2020 2020 2044  taset>.        D
+00019320: 696d 656e 7369 6f6e 733a 2020 2878 3a20  imensions:  (x: 
+00019330: 322c 2079 3a20 3133 290a 2020 2020 2020  2, y: 13).      
+00019340: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
+00019350: 2020 2020 2020 2020 202a 2078 2020 2020           * x    
+00019360: 2020 2020 2878 2920 696e 7436 3420 3020      (x) int64 0 
+00019370: 310a 2020 2020 2020 2020 2020 2a20 7920  1.          * y 
+00019380: 2020 2020 2020 2028 7929 2069 6e74 3634         (y) int64
+00019390: 2030 2031 2032 2033 2034 2035 2036 2037   0 1 2 3 4 5 6 7
+000193a0: 2038 2039 2031 3020 3131 2031 320a 2020   8 9 10 11 12.  
+000193b0: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
+000193c0: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
+000193d0: 2020 666f 6f20 2020 2020 2028 782c 2079    foo      (x, y
+000193e0: 2920 696e 7436 3420 3020 3120 3220 3320  ) int64 0 1 2 3 
+000193f0: 3420 3520 3620 3720 3820 3920 2e2e 2e20  4 5 6 7 8 9 ... 
+00019400: 3136 2031 3720 3138 2031 3920 3230 2032  16 17 18 19 20 2
+00019410: 3120 3232 2032 3320 3234 2032 350a 0a20  1 22 23 24 25.. 
+00019420: 2020 2020 2020 203e 3e3e 2078 5f64 732e         >>> x_ds.
+00019430: 7468 696e 2833 290a 2020 2020 2020 2020  thin(3).        
+00019440: 3c78 6172 7261 792e 4461 7461 7365 743e  <xarray.Dataset>
+00019450: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
+00019460: 6f6e 733a 2020 2878 3a20 312c 2079 3a20  ons:  (x: 1, y: 
+00019470: 3529 0a20 2020 2020 2020 2043 6f6f 7264  5).        Coord
+00019480: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
+00019490: 2020 2a20 7820 2020 2020 2020 2028 7829    * x        (x)
+000194a0: 2069 6e74 3634 2030 0a20 2020 2020 2020   int64 0.       
+000194b0: 2020 202a 2079 2020 2020 2020 2020 2879     * y        (y
+000194c0: 2920 696e 7436 3420 3020 3320 3620 3920  ) int64 0 3 6 9 
+000194d0: 3132 0a20 2020 2020 2020 2044 6174 6120  12.        Data 
+000194e0: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
+000194f0: 2020 2020 2020 2066 6f6f 2020 2020 2020         foo      
+00019500: 2878 2c20 7929 2069 6e74 3634 2030 2033  (x, y) int64 0 3
+00019510: 2036 2039 2031 320a 2020 2020 2020 2020   6 9 12.        
+00019520: 3e3e 3e20 782e 7468 696e 287b 2278 223a  >>> x.thin({"x":
+00019530: 2032 2c20 2279 223a 2035 7d29 0a20 2020   2, "y": 5}).   
+00019540: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
+00019550: 6141 7272 6179 2028 783a 2031 2c20 793a  aArray (x: 1, y:
+00019560: 2033 293e 0a20 2020 2020 2020 2061 7272   3)>.        arr
+00019570: 6179 285b 5b20 302c 2020 352c 2031 305d  ay([[ 0,  5, 10]
+00019580: 5d29 0a20 2020 2020 2020 2043 6f6f 7264  ]).        Coord
+00019590: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
+000195a0: 2020 2a20 7820 2020 2020 2020 2028 7829    * x        (x)
+000195b0: 2069 6e74 3634 2030 0a20 2020 2020 2020   int64 0.       
+000195c0: 2020 202a 2079 2020 2020 2020 2020 2879     * y        (y
+000195d0: 2920 696e 7436 3420 3020 3520 3130 0a0a  ) int64 0 5 10..
+000195e0: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+000195f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00019600: 2d0a 2020 2020 2020 2020 4461 7461 7365  -.        Datase
+00019610: 742e 6865 6164 0a20 2020 2020 2020 2044  t.head.        D
+00019620: 6174 6173 6574 2e74 6169 6c0a 2020 2020  ataset.tail.    
+00019630: 2020 2020 4461 7461 4172 7261 792e 7468      DataArray.th
+00019640: 696e 0a20 2020 2020 2020 2022 2222 0a20  in.        """. 
+00019650: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
+00019660: 2020 2020 2020 2020 6e6f 7420 696e 6465          not inde
+00019670: 7865 7273 5f6b 7761 7267 730a 2020 2020  xers_kwargs.    
+00019680: 2020 2020 2020 2020 616e 6420 6e6f 7420          and not 
+00019690: 6973 696e 7374 616e 6365 2869 6e64 6578  isinstance(index
+000196a0: 6572 732c 2069 6e74 290a 2020 2020 2020  ers, int).      
+000196b0: 2020 2020 2020 616e 6420 6e6f 7420 6973        and not is
+000196c0: 5f64 6963 745f 6c69 6b65 2869 6e64 6578  _dict_like(index
+000196d0: 6572 7329 0a20 2020 2020 2020 2029 3a0a  ers).        ):.
+000196e0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000196f0: 6520 5479 7065 4572 726f 7228 2269 6e64  e TypeError("ind
+00019700: 6578 6572 7320 6d75 7374 2062 6520 6569  exers must be ei
+00019710: 7468 6572 2064 6963 742d 6c69 6b65 206f  ther dict-like o
+00019720: 7220 6120 7369 6e67 6c65 2069 6e74 6567  r a single integ
+00019730: 6572 2229 0a20 2020 2020 2020 2069 6620  er").        if 
+00019740: 6973 696e 7374 616e 6365 2869 6e64 6578  isinstance(index
+00019750: 6572 732c 2069 6e74 293a 0a20 2020 2020  ers, int):.     
+00019760: 2020 2020 2020 2069 6e64 6578 6572 7320         indexers 
+00019770: 3d20 7b64 696d 3a20 696e 6465 7865 7273  = {dim: indexers
+00019780: 2066 6f72 2064 696d 2069 6e20 7365 6c66   for dim in self
+00019790: 2e64 696d 737d 0a20 2020 2020 2020 2069  .dims}.        i
+000197a0: 6e64 6578 6572 7320 3d20 6569 7468 6572  ndexers = either
+000197b0: 5f64 6963 745f 6f72 5f6b 7761 7267 7328  _dict_or_kwargs(
+000197c0: 696e 6465 7865 7273 2c20 696e 6465 7865  indexers, indexe
+000197d0: 7273 5f6b 7761 7267 732c 2022 7468 696e  rs_kwargs, "thin
+000197e0: 2229 0a20 2020 2020 2020 2066 6f72 206b  ").        for k
+000197f0: 2c20 7620 696e 2069 6e64 6578 6572 732e  , v in indexers.
+00019800: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+00019810: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00019820: 7374 616e 6365 2876 2c20 696e 7429 3a0a  stance(v, int):.
+00019830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019840: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00019850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019860: 2020 2020 2022 6578 7065 6374 6564 2069       "expected i
+00019870: 6e74 6567 6572 2074 7970 6520 696e 6465  nteger type inde
+00019880: 7865 7220 666f 7220 220a 2020 2020 2020  xer for ".      
+00019890: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+000198a0: 6469 6d65 6e73 696f 6e20 7b6b 2172 7d2c  dimension {k!r},
+000198b0: 2066 6f75 6e64 207b 7479 7065 2876 2921   found {type(v)!
+000198c0: 727d 220a 2020 2020 2020 2020 2020 2020  r}".            
+000198d0: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+000198e0: 2020 656c 6966 2076 203c 2030 3a0a 2020    elif v < 0:.  
+000198f0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00019900: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+00019910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019920: 2020 2020 2265 7870 6563 7465 6420 706f      "expected po
+00019930: 7369 7469 7665 2069 6e74 6567 6572 2061  sitive integer a
+00019940: 7320 696e 6465 7865 7220 220a 2020 2020  s indexer ".    
+00019950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019960: 6622 666f 7220 6469 6d65 6e73 696f 6e20  f"for dimension 
+00019970: 7b6b 2172 7d2c 2066 6f75 6e64 207b 767d  {k!r}, found {v}
+00019980: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00019990: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+000199a0: 656c 6966 2076 203d 3d20 303a 0a20 2020  elif v == 0:.   
+000199b0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000199c0: 7365 2056 616c 7565 4572 726f 7228 2273  se ValueError("s
+000199d0: 7465 7020 6361 6e6e 6f74 2062 6520 7a65  tep cannot be ze
+000199e0: 726f 2229 0a20 2020 2020 2020 2069 6e64  ro").        ind
+000199f0: 6578 6572 735f 736c 6963 6573 203d 207b  exers_slices = {
+00019a00: 6b3a 2073 6c69 6365 284e 6f6e 652c 204e  k: slice(None, N
+00019a10: 6f6e 652c 2076 616c 2920 666f 7220 6b2c  one, val) for k,
+00019a20: 2076 616c 2069 6e20 696e 6465 7865 7273   val in indexers
+00019a30: 2e69 7465 6d73 2829 7d0a 2020 2020 2020  .items()}.      
+00019a40: 2020 7265 7475 726e 2073 656c 662e 6973    return self.is
+00019a50: 656c 2869 6e64 6578 6572 735f 736c 6963  el(indexers_slic
+00019a60: 6573 290a 0a20 2020 2064 6566 2062 726f  es)..    def bro
+00019a70: 6164 6361 7374 5f6c 696b 6528 0a20 2020  adcast_like(.   
+00019a80: 2020 2020 2073 656c 663a 2054 5f44 6174       self: T_Dat
+00019a90: 6173 6574 2c0a 2020 2020 2020 2020 6f74  aset,.        ot
+00019aa0: 6865 723a 2044 6174 6173 6574 207c 2044  her: Dataset | D
+00019ab0: 6174 6141 7272 6179 2c0a 2020 2020 2020  ataArray,.      
+00019ac0: 2020 6578 636c 7564 653a 2049 7465 7261    exclude: Itera
+00019ad0: 626c 655b 4861 7368 6162 6c65 5d20 7c20  ble[Hashable] | 
+00019ae0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+00019af0: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
+00019b00: 0a20 2020 2020 2020 2022 2222 4272 6f61  .        """Broa
+00019b10: 6463 6173 7420 7468 6973 2044 6174 6141  dcast this DataA
+00019b20: 7272 6179 2061 6761 696e 7374 2061 6e6f  rray against ano
+00019b30: 7468 6572 2044 6174 6173 6574 206f 7220  ther Dataset or 
+00019b40: 4461 7461 4172 7261 792e 0a20 2020 2020  DataArray..     
+00019b50: 2020 2054 6869 7320 6973 2065 7175 6976     This is equiv
+00019b60: 616c 656e 7420 746f 2078 722e 6272 6f61  alent to xr.broa
+00019b70: 6463 6173 7428 6f74 6865 722c 2073 656c  dcast(other, sel
+00019b80: 6629 5b31 5d0a 0a20 2020 2020 2020 2050  f)[1]..        P
+00019b90: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00019ba0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00019bb0: 2020 2020 206f 7468 6572 203a 2044 6174       other : Dat
+00019bc0: 6173 6574 206f 7220 4461 7461 4172 7261  aset or DataArra
+00019bd0: 790a 2020 2020 2020 2020 2020 2020 4f62  y.            Ob
+00019be0: 6a65 6374 2061 6761 696e 7374 2077 6869  ject against whi
+00019bf0: 6368 2074 6f20 6272 6f61 6463 6173 7420  ch to broadcast 
+00019c00: 7468 6973 2061 7272 6179 2e0a 2020 2020  this array..    
+00019c10: 2020 2020 6578 636c 7564 6520 3a20 6974      exclude : it
+00019c20: 6572 6162 6c65 206f 6620 6861 7368 6162  erable of hashab
+00019c30: 6c65 2c20 6f70 7469 6f6e 616c 0a20 2020  le, optional.   
+00019c40: 2020 2020 2020 2020 2044 696d 656e 7369           Dimensi
+00019c50: 6f6e 7320 7468 6174 206d 7573 7420 6e6f  ons that must no
+00019c60: 7420 6265 2062 726f 6164 6361 7374 6564  t be broadcasted
+00019c70: 0a0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00019c80: 2020 2020 2020 6966 2065 7863 6c75 6465        if exclude
+00019c90: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00019ca0: 2020 2020 2020 6578 636c 7564 6520 3d20        exclude = 
+00019cb0: 7365 7428 290a 2020 2020 2020 2020 656c  set().        el
+00019cc0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00019cd0: 6578 636c 7564 6520 3d20 7365 7428 6578  exclude = set(ex
+00019ce0: 636c 7564 6529 0a20 2020 2020 2020 2061  clude).        a
+00019cf0: 7267 7320 3d20 616c 6967 6e28 6f74 6865  rgs = align(othe
+00019d00: 722c 2073 656c 662c 206a 6f69 6e3d 226f  r, self, join="o
+00019d10: 7574 6572 222c 2063 6f70 793d 4661 6c73  uter", copy=Fals
+00019d20: 652c 2065 7863 6c75 6465 3d65 7863 6c75  e, exclude=exclu
+00019d30: 6465 290a 0a20 2020 2020 2020 2064 696d  de)..        dim
+00019d40: 735f 6d61 702c 2063 6f6d 6d6f 6e5f 636f  s_map, common_co
+00019d50: 6f72 6473 203d 205f 6765 745f 6272 6f61  ords = _get_broa
+00019d60: 6463 6173 745f 6469 6d73 5f6d 6170 5f63  dcast_dims_map_c
+00019d70: 6f6d 6d6f 6e5f 636f 6f72 6473 2861 7267  ommon_coords(arg
+00019d80: 732c 2065 7863 6c75 6465 290a 0a20 2020  s, exclude)..   
+00019d90: 2020 2020 2072 6574 7572 6e20 5f62 726f       return _bro
+00019da0: 6164 6361 7374 5f68 656c 7065 7228 0a20  adcast_helper(. 
+00019db0: 2020 2020 2020 2020 2020 2063 6173 7428             cast(
+00019dc0: 2254 5f44 6174 6173 6574 222c 2061 7267  "T_Dataset", arg
+00019dd0: 735b 315d 292c 2065 7863 6c75 6465 2c20  s[1]), exclude, 
+00019de0: 6469 6d73 5f6d 6170 2c20 636f 6d6d 6f6e  dims_map, common
+00019df0: 5f63 6f6f 7264 730a 2020 2020 2020 2020  _coords.        
+00019e00: 290a 0a20 2020 2064 6566 205f 7265 696e  )..    def _rein
+00019e10: 6465 785f 6361 6c6c 6261 636b 280a 2020  dex_callback(.  
+00019e20: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+00019e30: 2020 2020 616c 6967 6e65 723a 2061 6c69      aligner: ali
+00019e40: 676e 6d65 6e74 2e41 6c69 676e 6572 2c0a  gnment.Aligner,.
+00019e50: 2020 2020 2020 2020 6469 6d5f 706f 735f          dim_pos_
+00019e60: 696e 6465 7865 7273 3a20 6469 6374 5b48  indexers: dict[H
+00019e70: 6173 6861 626c 652c 2041 6e79 5d2c 0a20  ashable, Any],. 
+00019e80: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+00019e90: 3a20 6469 6374 5b48 6173 6861 626c 652c  : dict[Hashable,
+00019ea0: 2056 6172 6961 626c 655d 2c0a 2020 2020   Variable],.    
+00019eb0: 2020 2020 696e 6465 7865 733a 2064 6963      indexes: dic
+00019ec0: 745b 4861 7368 6162 6c65 2c20 496e 6465  t[Hashable, Inde
+00019ed0: 785d 2c0a 2020 2020 2020 2020 6669 6c6c  x],.        fill
+00019ee0: 5f76 616c 7565 3a20 416e 792c 0a20 2020  _value: Any,.   
+00019ef0: 2020 2020 2065 7863 6c75 6465 5f64 696d       exclude_dim
+00019f00: 733a 2066 726f 7a65 6e73 6574 5b48 6173  s: frozenset[Has
+00019f10: 6861 626c 655d 2c0a 2020 2020 2020 2020  hable],.        
+00019f20: 6578 636c 7564 655f 7661 7273 3a20 6672  exclude_vars: fr
+00019f30: 6f7a 656e 7365 745b 4861 7368 6162 6c65  ozenset[Hashable
+00019f40: 5d2c 0a20 2020 2029 202d 3e20 4461 7461  ],.    ) -> Data
+00019f50: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+00019f60: 4361 6c6c 6261 636b 2063 616c 6c65 6420  Callback called 
+00019f70: 6672 6f6d 2060 6041 6c69 676e 6572 6060  from ``Aligner``
+00019f80: 2074 6f20 6372 6561 7465 2061 206e 6577   to create a new
+00019f90: 2072 6569 6e64 6578 6564 2044 6174 6173   reindexed Datas
+00019fa0: 6574 2e22 2222 0a0a 2020 2020 2020 2020  et."""..        
+00019fb0: 6e65 775f 7661 7269 6162 6c65 7320 3d20  new_variables = 
+00019fc0: 7661 7269 6162 6c65 732e 636f 7079 2829  variables.copy()
+00019fd0: 0a20 2020 2020 2020 206e 6577 5f69 6e64  .        new_ind
+00019fe0: 6578 6573 203d 2069 6e64 6578 6573 2e63  exes = indexes.c
+00019ff0: 6f70 7928 290a 0a20 2020 2020 2020 2023  opy()..        #
+0001a000: 2072 652d 6173 7369 676e 2076 6172 6961   re-assign varia
+0001a010: 626c 6520 6d65 7461 6461 7461 0a20 2020  ble metadata.   
+0001a020: 2020 2020 2066 6f72 206e 616d 652c 206e       for name, n
+0001a030: 6577 5f76 6172 2069 6e20 6e65 775f 7661  ew_var in new_va
+0001a040: 7269 6162 6c65 732e 6974 656d 7328 293a  riables.items():
+0001a050: 0a20 2020 2020 2020 2020 2020 2076 6172  .            var
+0001a060: 203d 2073 656c 662e 5f76 6172 6961 626c   = self._variabl
+0001a070: 6573 2e67 6574 286e 616d 6529 0a20 2020  es.get(name).   
+0001a080: 2020 2020 2020 2020 2069 6620 7661 7220           if var 
+0001a090: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0001a0a0: 2020 2020 2020 2020 2020 2020 206e 6577               new
+0001a0b0: 5f76 6172 2e61 7474 7273 203d 2076 6172  _var.attrs = var
+0001a0c0: 2e61 7474 7273 0a20 2020 2020 2020 2020  .attrs.         
+0001a0d0: 2020 2020 2020 206e 6577 5f76 6172 2e65         new_var.e
+0001a0e0: 6e63 6f64 696e 6720 3d20 7661 722e 656e  ncoding = var.en
+0001a0f0: 636f 6469 6e67 0a0a 2020 2020 2020 2020  coding..        
+0001a100: 2320 7061 7373 2074 6872 6f75 6768 2069  # pass through i
+0001a110: 6e64 6578 6573 2066 726f 6d20 6578 636c  ndexes from excl
+0001a120: 7564 6564 2064 696d 656e 7369 6f6e 730a  uded dimensions.
+0001a130: 2020 2020 2020 2020 2320 6e6f 2065 7874          # no ext
+0001a140: 7261 2063 6865 636b 206e 6565 6465 6420  ra check needed 
+0001a150: 666f 7220 6d75 6c74 692d 636f 6f72 6469  for multi-coordi
+0001a160: 6e61 7465 2069 6e64 6578 6573 2c20 706f  nate indexes, po
+0001a170: 7465 6e74 6961 6c20 636f 6e66 6c69 6374  tential conflict
+0001a180: 730a 2020 2020 2020 2020 2320 7368 6f75  s.        # shou
+0001a190: 6c64 2061 6c72 6561 6479 2068 6176 6520  ld already have 
+0001a1a0: 6265 656e 2064 6574 6563 7465 6420 7768  been detected wh
+0001a1b0: 656e 2061 6c69 676e 696e 6720 7468 6520  en aligning the 
+0001a1c0: 696e 6465 7865 730a 2020 2020 2020 2020  indexes.        
+0001a1d0: 666f 7220 6e61 6d65 2c20 6964 7820 696e  for name, idx in
+0001a1e0: 2073 656c 662e 5f69 6e64 6578 6573 2e69   self._indexes.i
+0001a1f0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+0001a200: 2020 2020 7661 7220 3d20 7365 6c66 2e5f      var = self._
+0001a210: 7661 7269 6162 6c65 735b 6e61 6d65 5d0a  variables[name].
+0001a220: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0001a230: 6574 2876 6172 2e64 696d 7329 203c 3d20  et(var.dims) <= 
+0001a240: 6578 636c 7564 655f 6469 6d73 3a0a 2020  exclude_dims:.  
+0001a250: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
+0001a260: 775f 696e 6465 7865 735b 6e61 6d65 5d20  w_indexes[name] 
+0001a270: 3d20 6964 780a 2020 2020 2020 2020 2020  = idx.          
+0001a280: 2020 2020 2020 6e65 775f 7661 7269 6162        new_variab
+0001a290: 6c65 735b 6e61 6d65 5d20 3d20 7661 720a  les[name] = var.
+0001a2a0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0001a2b0: 6469 6d5f 706f 735f 696e 6465 7865 7273  dim_pos_indexers
+0001a2c0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+0001a2d0: 6661 7374 2070 6174 6820 666f 7220 6e6f  fast path for no
+0001a2e0: 2072 6569 6e64 6578 696e 6720 6e65 6365   reindexing nece
+0001a2f0: 7373 6172 790a 2020 2020 2020 2020 2020  ssary.          
+0001a300: 2020 6966 2073 6574 286e 6577 5f69 6e64    if set(new_ind
+0001a310: 6578 6573 2920 2d20 7365 7428 7365 6c66  exes) - set(self
+0001a320: 2e5f 696e 6465 7865 7329 3a0a 2020 2020  ._indexes):.    
+0001a330: 2020 2020 2020 2020 2020 2020 2320 7468              # th
+0001a340: 6973 206f 6e6c 7920 6164 6473 206e 6577  is only adds new
+0001a350: 2069 6e64 6578 6573 2061 6e64 2074 6865   indexes and the
+0001a360: 6972 2063 6f6f 7264 696e 6174 6520 7661  ir coordinate va
+0001a370: 7269 6162 6c65 730a 2020 2020 2020 2020  riables.        
+0001a380: 2020 2020 2020 2020 7265 696e 6465 7865          reindexe
+0001a390: 6420 3d20 7365 6c66 2e5f 6f76 6572 7772  d = self._overwr
+0001a3a0: 6974 655f 696e 6465 7865 7328 6e65 775f  ite_indexes(new_
+0001a3b0: 696e 6465 7865 732c 206e 6577 5f76 6172  indexes, new_var
+0001a3c0: 6961 626c 6573 290a 2020 2020 2020 2020  iables).        
+0001a3d0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0001a3e0: 2020 2020 2020 2020 2020 7265 696e 6465            reinde
+0001a3f0: 7865 6420 3d20 7365 6c66 2e63 6f70 7928  xed = self.copy(
+0001a400: 6465 6570 3d61 6c69 676e 6572 2e63 6f70  deep=aligner.cop
+0001a410: 7929 0a20 2020 2020 2020 2065 6c73 653a  y).        else:
+0001a420: 0a20 2020 2020 2020 2020 2020 2074 6f5f  .            to_
+0001a430: 7265 696e 6465 7820 3d20 7b0a 2020 2020  reindex = {.    
+0001a440: 2020 2020 2020 2020 2020 2020 6b3a 2076              k: v
+0001a450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a460: 2066 6f72 206b 2c20 7620 696e 2073 656c   for k, v in sel
+0001a470: 662e 7661 7269 6162 6c65 732e 6974 656d  f.variables.item
+0001a480: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+0001a490: 2020 2020 6966 206b 206e 6f74 2069 6e20      if k not in 
+0001a4a0: 7661 7269 6162 6c65 7320 616e 6420 6b20  variables and k 
+0001a4b0: 6e6f 7420 696e 2065 7863 6c75 6465 5f76  not in exclude_v
+0001a4c0: 6172 730a 2020 2020 2020 2020 2020 2020  ars.            
+0001a4d0: 7d0a 2020 2020 2020 2020 2020 2020 7265  }.            re
+0001a4e0: 696e 6465 7865 645f 7661 7273 203d 2061  indexed_vars = a
+0001a4f0: 6c69 676e 6d65 6e74 2e72 6569 6e64 6578  lignment.reindex
+0001a500: 5f76 6172 6961 626c 6573 280a 2020 2020  _variables(.    
+0001a510: 2020 2020 2020 2020 2020 2020 746f 5f72              to_r
+0001a520: 6569 6e64 6578 2c0a 2020 2020 2020 2020  eindex,.        
+0001a530: 2020 2020 2020 2020 6469 6d5f 706f 735f          dim_pos_
+0001a540: 696e 6465 7865 7273 2c0a 2020 2020 2020  indexers,.      
+0001a550: 2020 2020 2020 2020 2020 636f 7079 3d61            copy=a
+0001a560: 6c69 676e 6572 2e63 6f70 792c 0a20 2020  ligner.copy,.   
+0001a570: 2020 2020 2020 2020 2020 2020 2066 696c               fil
+0001a580: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
+0001a590: 7565 2c0a 2020 2020 2020 2020 2020 2020  ue,.            
+0001a5a0: 2020 2020 7370 6172 7365 3d61 6c69 676e      sparse=align
+0001a5b0: 6572 2e73 7061 7273 652c 0a20 2020 2020  er.sparse,.     
+0001a5c0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0001a5d0: 2020 2020 206e 6577 5f76 6172 6961 626c       new_variabl
+0001a5e0: 6573 2e75 7064 6174 6528 7265 696e 6465  es.update(reinde
+0001a5f0: 7865 645f 7661 7273 290a 2020 2020 2020  xed_vars).      
+0001a600: 2020 2020 2020 6e65 775f 636f 6f72 645f        new_coord_
+0001a610: 6e61 6d65 7320 3d20 7365 6c66 2e5f 636f  names = self._co
+0001a620: 6f72 645f 6e61 6d65 7320 7c20 7365 7428  ord_names | set(
+0001a630: 6e65 775f 696e 6465 7865 7329 0a20 2020  new_indexes).   
+0001a640: 2020 2020 2020 2020 2072 6569 6e64 6578           reindex
+0001a650: 6564 203d 2073 656c 662e 5f72 6570 6c61  ed = self._repla
+0001a660: 6365 5f77 6974 685f 6e65 775f 6469 6d73  ce_with_new_dims
+0001a670: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001a680: 2020 6e65 775f 7661 7269 6162 6c65 732c    new_variables,
+0001a690: 206e 6577 5f63 6f6f 7264 5f6e 616d 6573   new_coord_names
+0001a6a0: 2c20 696e 6465 7865 733d 6e65 775f 696e  , indexes=new_in
+0001a6b0: 6465 7865 730a 2020 2020 2020 2020 2020  dexes.          
+0001a6c0: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
+0001a6d0: 7572 6e20 7265 696e 6465 7865 640a 0a20  urn reindexed.. 
+0001a6e0: 2020 2064 6566 2072 6569 6e64 6578 5f6c     def reindex_l
+0001a6f0: 696b 6528 0a20 2020 2020 2020 2073 656c  ike(.        sel
+0001a700: 663a 2054 5f44 6174 6173 6574 2c0a 2020  f: T_Dataset,.  
+0001a710: 2020 2020 2020 6f74 6865 723a 2044 6174        other: Dat
+0001a720: 6173 6574 207c 2044 6174 6141 7272 6179  aset | DataArray
+0001a730: 2c0a 2020 2020 2020 2020 6d65 7468 6f64  ,.        method
+0001a740: 3a20 5265 696e 6465 784d 6574 686f 644f  : ReindexMethodO
+0001a750: 7074 696f 6e73 203d 204e 6f6e 652c 0a20  ptions = None,. 
+0001a760: 2020 2020 2020 2074 6f6c 6572 616e 6365         tolerance
+0001a770: 3a20 696e 7420 7c20 666c 6f61 7420 7c20  : int | float | 
+0001a780: 4974 6572 6162 6c65 5b69 6e74 207c 2066  Iterable[int | f
+0001a790: 6c6f 6174 5d20 7c20 4e6f 6e65 203d 204e  loat] | None = N
+0001a7a0: 6f6e 652c 0a20 2020 2020 2020 2063 6f70  one,.        cop
+0001a7b0: 793a 2062 6f6f 6c20 3d20 5472 7565 2c0a  y: bool = True,.
+0001a7c0: 2020 2020 2020 2020 6669 6c6c 5f76 616c          fill_val
+0001a7d0: 7565 3a20 416e 7920 3d20 7872 6474 7970  ue: Any = xrdtyp
+0001a7e0: 6573 2e4e 412c 0a20 2020 2029 202d 3e20  es.NA,.    ) -> 
+0001a7f0: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
+0001a800: 2020 2022 2222 436f 6e66 6f72 6d20 7468     """Conform th
+0001a810: 6973 206f 626a 6563 7420 6f6e 746f 2074  is object onto t
+0001a820: 6865 2069 6e64 6578 6573 206f 6620 616e  he indexes of an
+0001a830: 6f74 6865 7220 6f62 6a65 6374 2c20 6669  other object, fi
+0001a840: 6c6c 696e 6720 696e 0a20 2020 2020 2020  lling in.       
+0001a850: 206d 6973 7369 6e67 2076 616c 7565 7320   missing values 
+0001a860: 7769 7468 2060 6066 696c 6c5f 7661 6c75  with ``fill_valu
+0001a870: 6560 602e 2054 6865 2064 6566 6175 6c74  e``. The default
+0001a880: 2066 696c 6c20 7661 6c75 6520 6973 204e   fill value is N
+0001a890: 614e 2e0a 0a20 2020 2020 2020 2050 6172  aN...        Par
+0001a8a0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+0001a8b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0001a8c0: 2020 206f 7468 6572 203a 2044 6174 6173     other : Datas
+0001a8d0: 6574 206f 7220 4461 7461 4172 7261 790a  et or DataArray.
+0001a8e0: 2020 2020 2020 2020 2020 2020 4f62 6a65              Obje
+0001a8f0: 6374 2077 6974 6820 616e 2027 696e 6465  ct with an 'inde
+0001a900: 7865 7327 2061 7474 7269 6275 7465 2067  xes' attribute g
+0001a910: 6976 696e 6720 6120 6d61 7070 696e 6720  iving a mapping 
+0001a920: 6672 6f6d 2064 696d 656e 7369 6f6e 0a20  from dimension. 
+0001a930: 2020 2020 2020 2020 2020 206e 616d 6573             names
+0001a940: 2074 6f20 7061 6e64 6173 2e49 6e64 6578   to pandas.Index
+0001a950: 206f 626a 6563 7473 2c20 7768 6963 6820   objects, which 
+0001a960: 7072 6f76 6964 6573 2063 6f6f 7264 696e  provides coordin
+0001a970: 6174 6573 2075 706f 6e0a 2020 2020 2020  ates upon.      
+0001a980: 2020 2020 2020 7768 6963 6820 746f 2069        which to i
+0001a990: 6e64 6578 2074 6865 2076 6172 6961 626c  ndex the variabl
+0001a9a0: 6573 2069 6e20 7468 6973 2064 6174 6173  es in this datas
+0001a9b0: 6574 2e20 5468 6520 696e 6465 7865 7320  et. The indexes 
+0001a9c0: 6f6e 2074 6869 730a 2020 2020 2020 2020  on this.        
+0001a9d0: 2020 2020 6f74 6865 7220 6f62 6a65 6374      other object
+0001a9e0: 206e 6565 6420 6e6f 7420 6265 2074 6865   need not be the
+0001a9f0: 2073 616d 6520 6173 2074 6865 2069 6e64   same as the ind
+0001aa00: 6578 6573 206f 6e20 7468 6973 0a20 2020  exes on this.   
+0001aa10: 2020 2020 2020 2020 2064 6174 6173 6574           dataset
+0001aa20: 2e20 416e 7920 6d69 732d 6d61 7463 6865  . Any mis-matche
+0001aa30: 6420 696e 6465 7820 7661 6c75 6573 2077  d index values w
+0001aa40: 696c 6c20 6265 2066 696c 6c65 6420 696e  ill be filled in
+0001aa50: 2077 6974 680a 2020 2020 2020 2020 2020   with.          
+0001aa60: 2020 4e61 4e2c 2061 6e64 2061 6e79 206d    NaN, and any m
+0001aa70: 6973 2d6d 6174 6368 6564 2064 696d 656e  is-matched dimen
+0001aa80: 7369 6f6e 206e 616d 6573 2077 696c 6c20  sion names will 
+0001aa90: 7369 6d70 6c79 2062 6520 6967 6e6f 7265  simply be ignore
+0001aaa0: 642e 0a20 2020 2020 2020 206d 6574 686f  d..        metho
+0001aab0: 6420 3a20 7b4e 6f6e 652c 2022 6e65 6172  d : {None, "near
+0001aac0: 6573 7422 2c20 2270 6164 222c 2022 6666  est", "pad", "ff
+0001aad0: 696c 6c22 2c20 2262 6163 6b66 696c 6c22  ill", "backfill"
+0001aae0: 2c20 2262 6669 6c6c 222c 204e 6f6e 657d  , "bfill", None}
+0001aaf0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0001ab00: 2020 2020 2020 204d 6574 686f 6420 746f         Method to
+0001ab10: 2075 7365 2066 6f72 2066 696c 6c69 6e67   use for filling
+0001ab20: 2069 6e64 6578 2076 616c 7565 7320 6672   index values fr
+0001ab30: 6f6d 206f 7468 6572 206e 6f74 2066 6f75  om other not fou
+0001ab40: 6e64 2069 6e20 7468 6973 0a20 2020 2020  nd in this.     
+0001ab50: 2020 2020 2020 2064 6174 6173 6574 3a0a         dataset:.
+0001ab60: 0a20 2020 2020 2020 2020 2020 202d 204e  .            - N
+0001ab70: 6f6e 6520 2864 6566 6175 6c74 293a 2064  one (default): d
+0001ab80: 6f6e 2774 2066 696c 6c20 6761 7073 0a20  on't fill gaps. 
+0001ab90: 2020 2020 2020 2020 2020 202d 2022 7061             - "pa
+0001aba0: 6422 202f 2022 6666 696c 6c22 3a20 7072  d" / "ffill": pr
+0001abb0: 6f70 6167 6174 6520 6c61 7374 2076 616c  opagate last val
+0001abc0: 6964 2069 6e64 6578 2076 616c 7565 2066  id index value f
+0001abd0: 6f72 7761 7264 0a20 2020 2020 2020 2020  orward.         
+0001abe0: 2020 202d 2022 6261 636b 6669 6c6c 2220     - "backfill" 
+0001abf0: 2f20 2262 6669 6c6c 223a 2070 726f 7061  / "bfill": propa
+0001ac00: 6761 7465 206e 6578 7420 7661 6c69 6420  gate next valid 
+0001ac10: 696e 6465 7820 7661 6c75 6520 6261 636b  index value back
+0001ac20: 7761 7264 0a20 2020 2020 2020 2020 2020  ward.           
+0001ac30: 202d 2022 6e65 6172 6573 7422 3a20 7573   - "nearest": us
+0001ac40: 6520 6e65 6172 6573 7420 7661 6c69 6420  e nearest valid 
+0001ac50: 696e 6465 7820 7661 6c75 650a 0a20 2020  index value..   
+0001ac60: 2020 2020 2074 6f6c 6572 616e 6365 203a       tolerance :
+0001ac70: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0001ac80: 2020 2020 2020 4d61 7869 6d75 6d20 6469        Maximum di
+0001ac90: 7374 616e 6365 2062 6574 7765 656e 206f  stance between o
+0001aca0: 7269 6769 6e61 6c20 616e 6420 6e65 7720  riginal and new 
+0001acb0: 6c61 6265 6c73 2066 6f72 2069 6e65 7861  labels for inexa
+0001acc0: 6374 0a20 2020 2020 2020 2020 2020 206d  ct.            m
+0001acd0: 6174 6368 6573 2e20 5468 6520 7661 6c75  atches. The valu
+0001ace0: 6573 206f 6620 7468 6520 696e 6465 7820  es of the index 
+0001acf0: 6174 2074 6865 206d 6174 6368 696e 6720  at the matching 
+0001ad00: 6c6f 6361 7469 6f6e 7320 6d75 7374 0a20  locations must. 
+0001ad10: 2020 2020 2020 2020 2020 2073 6174 6973             satis
+0001ad20: 6679 2074 6865 2065 7175 6174 696f 6e20  fy the equation 
+0001ad30: 6060 6162 7328 696e 6465 785b 696e 6465  ``abs(index[inde
+0001ad40: 7865 725d 202d 2074 6172 6765 7429 203c  xer] - target) <
+0001ad50: 3d20 746f 6c65 7261 6e63 6560 602e 0a20  = tolerance``.. 
+0001ad60: 2020 2020 2020 2020 2020 2054 6f6c 6572             Toler
+0001ad70: 616e 6365 206d 6179 2062 6520 6120 7363  ance may be a sc
+0001ad80: 616c 6172 2076 616c 7565 2c20 7768 6963  alar value, whic
+0001ad90: 6820 6170 706c 6965 7320 7468 6520 7361  h applies the sa
+0001ada0: 6d65 2074 6f6c 6572 616e 6365 0a20 2020  me tolerance.   
+0001adb0: 2020 2020 2020 2020 2074 6f20 616c 6c20           to all 
+0001adc0: 7661 6c75 6573 2c20 6f72 206c 6973 742d  values, or list-
+0001add0: 6c69 6b65 2c20 7768 6963 6820 6170 706c  like, which appl
+0001ade0: 6965 7320 7661 7269 6162 6c65 2074 6f6c  ies variable tol
+0001adf0: 6572 616e 6365 2070 6572 0a20 2020 2020  erance per.     
+0001ae00: 2020 2020 2020 2065 6c65 6d65 6e74 2e20         element. 
+0001ae10: 4c69 7374 2d6c 696b 6520 6d75 7374 2062  List-like must b
+0001ae20: 6520 7468 6520 7361 6d65 2073 697a 6520  e the same size 
+0001ae30: 6173 2074 6865 2069 6e64 6578 2061 6e64  as the index and
+0001ae40: 2069 7473 2064 7479 7065 0a20 2020 2020   its dtype.     
+0001ae50: 2020 2020 2020 206d 7573 7420 6578 6163         must exac
+0001ae60: 746c 7920 6d61 7463 6820 7468 6520 696e  tly match the in
+0001ae70: 6465 78e2 8099 7320 7479 7065 2e0a 2020  dex...s type..  
+0001ae80: 2020 2020 2020 636f 7079 203a 2062 6f6f        copy : boo
+0001ae90: 6c2c 2064 6566 6175 6c74 3a20 5472 7565  l, default: True
+0001aea0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0001aeb0: 6060 636f 7079 3d54 7275 6560 602c 2064  ``copy=True``, d
+0001aec0: 6174 6120 696e 2074 6865 2072 6574 7572  ata in the retur
+0001aed0: 6e20 7661 6c75 6520 6973 2061 6c77 6179  n value is alway
+0001aee0: 7320 636f 7069 6564 2e20 4966 0a20 2020  s copied. If.   
+0001aef0: 2020 2020 2020 2020 2060 6063 6f70 793d           ``copy=
+0001af00: 4661 6c73 6560 6020 616e 6420 7265 696e  False`` and rein
+0001af10: 6465 7869 6e67 2069 7320 756e 6e65 6365  dexing is unnece
+0001af20: 7373 6172 792c 206f 7220 6361 6e20 6265  ssary, or can be
+0001af30: 2070 6572 666f 726d 6564 0a20 2020 2020   performed.     
+0001af40: 2020 2020 2020 2077 6974 6820 6f6e 6c79         with only
+0001af50: 2073 6c69 6365 206f 7065 7261 7469 6f6e   slice operation
+0001af60: 732c 2074 6865 6e20 7468 6520 6f75 7470  s, then the outp
+0001af70: 7574 206d 6179 2073 6861 7265 206d 656d  ut may share mem
+0001af80: 6f72 7920 7769 7468 0a20 2020 2020 2020  ory with.       
+0001af90: 2020 2020 2074 6865 2069 6e70 7574 2e20       the input. 
+0001afa0: 496e 2065 6974 6865 7220 6361 7365 2c20  In either case, 
+0001afb0: 6120 6e65 7720 7861 7272 6179 206f 626a  a new xarray obj
+0001afc0: 6563 7420 6973 2061 6c77 6179 7320 7265  ect is always re
+0001afd0: 7475 726e 6564 2e0a 2020 2020 2020 2020  turned..        
+0001afe0: 6669 6c6c 5f76 616c 7565 203a 2073 6361  fill_value : sca
+0001aff0: 6c61 7220 6f72 2064 6963 742d 6c69 6b65  lar or dict-like
+0001b000: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0001b010: 2020 2020 2020 2056 616c 7565 2074 6f20         Value to 
+0001b020: 7573 6520 666f 7220 6e65 776c 7920 6d69  use for newly mi
+0001b030: 7373 696e 6720 7661 6c75 6573 2e20 4966  ssing values. If
+0001b040: 2061 2064 6963 742d 6c69 6b65 206d 6170   a dict-like map
+0001b050: 730a 2020 2020 2020 2020 2020 2020 7661  s.            va
+0001b060: 7269 6162 6c65 206e 616d 6573 2074 6f20  riable names to 
+0001b070: 6669 6c6c 2076 616c 7565 732e 0a0a 2020  fill values...  
+0001b080: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+0001b090: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+0001b0a0: 2020 2020 2020 7265 696e 6465 7865 6420        reindexed 
+0001b0b0: 3a20 4461 7461 7365 740a 2020 2020 2020  : Dataset.      
+0001b0c0: 2020 2020 2020 416e 6f74 6865 7220 6461        Another da
+0001b0d0: 7461 7365 742c 2077 6974 6820 7468 6973  taset, with this
+0001b0e0: 2064 6174 6173 6574 2773 2064 6174 6120   dataset's data 
+0001b0f0: 6275 7420 636f 6f72 6469 6e61 7465 7320  but coordinates 
+0001b100: 6672 6f6d 2074 6865 0a20 2020 2020 2020  from the.       
+0001b110: 2020 2020 206f 7468 6572 206f 626a 6563       other objec
+0001b120: 742e 0a0a 2020 2020 2020 2020 5365 6520  t...        See 
+0001b130: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+0001b140: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
+0001b150: 7461 7365 742e 7265 696e 6465 780a 2020  taset.reindex.  
+0001b160: 2020 2020 2020 616c 6967 6e0a 2020 2020        align.    
+0001b170: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+0001b180: 7265 7475 726e 2061 6c69 676e 6d65 6e74  return alignment
+0001b190: 2e72 6569 6e64 6578 5f6c 696b 6528 0a20  .reindex_like(. 
+0001b1a0: 2020 2020 2020 2020 2020 2073 656c 662c             self,
+0001b1b0: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+0001b1c0: 6572 3d6f 7468 6572 2c0a 2020 2020 2020  er=other,.      
+0001b1d0: 2020 2020 2020 6d65 7468 6f64 3d6d 6574        method=met
+0001b1e0: 686f 642c 0a20 2020 2020 2020 2020 2020  hod,.           
+0001b1f0: 2074 6f6c 6572 616e 6365 3d74 6f6c 6572   tolerance=toler
+0001b200: 616e 6365 2c0a 2020 2020 2020 2020 2020  ance,.          
+0001b210: 2020 636f 7079 3d63 6f70 792c 0a20 2020    copy=copy,.   
+0001b220: 2020 2020 2020 2020 2066 696c 6c5f 7661           fill_va
+0001b230: 6c75 653d 6669 6c6c 5f76 616c 7565 2c0a  lue=fill_value,.
+0001b240: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0001b250: 6566 2072 6569 6e64 6578 280a 2020 2020  ef reindex(.    
+0001b260: 2020 2020 7365 6c66 3a20 545f 4461 7461      self: T_Data
+0001b270: 7365 742c 0a20 2020 2020 2020 2069 6e64  set,.        ind
+0001b280: 6578 6572 733a 204d 6170 7069 6e67 5b41  exers: Mapping[A
+0001b290: 6e79 2c20 416e 795d 207c 204e 6f6e 6520  ny, Any] | None 
+0001b2a0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0001b2b0: 6d65 7468 6f64 3a20 5265 696e 6465 784d  method: ReindexM
+0001b2c0: 6574 686f 644f 7074 696f 6e73 203d 204e  ethodOptions = N
+0001b2d0: 6f6e 652c 0a20 2020 2020 2020 2074 6f6c  one,.        tol
+0001b2e0: 6572 616e 6365 3a20 696e 7420 7c20 666c  erance: int | fl
+0001b2f0: 6f61 7420 7c20 4974 6572 6162 6c65 5b69  oat | Iterable[i
+0001b300: 6e74 207c 2066 6c6f 6174 5d20 7c20 4e6f  nt | float] | No
+0001b310: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+0001b320: 2020 2063 6f70 793a 2062 6f6f 6c20 3d20     copy: bool = 
+0001b330: 5472 7565 2c0a 2020 2020 2020 2020 6669  True,.        fi
+0001b340: 6c6c 5f76 616c 7565 3a20 416e 7920 3d20  ll_value: Any = 
+0001b350: 7872 6474 7970 6573 2e4e 412c 0a20 2020  xrdtypes.NA,.   
+0001b360: 2020 2020 202a 2a69 6e64 6578 6572 735f       **indexers_
+0001b370: 6b77 6172 6773 3a20 416e 792c 0a20 2020  kwargs: Any,.   
+0001b380: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
+0001b390: 0a20 2020 2020 2020 2022 2222 436f 6e66  .        """Conf
+0001b3a0: 6f72 6d20 7468 6973 206f 626a 6563 7420  orm this object 
+0001b3b0: 6f6e 746f 2061 206e 6577 2073 6574 206f  onto a new set o
+0001b3c0: 6620 696e 6465 7865 732c 2066 696c 6c69  f indexes, filli
+0001b3d0: 6e67 2069 6e0a 2020 2020 2020 2020 6d69  ng in.        mi
+0001b3e0: 7373 696e 6720 7661 6c75 6573 2077 6974  ssing values wit
+0001b3f0: 6820 6060 6669 6c6c 5f76 616c 7565 6060  h ``fill_value``
+0001b400: 2e20 5468 6520 6465 6661 756c 7420 6669  . The default fi
+0001b410: 6c6c 2076 616c 7565 2069 7320 4e61 4e2e  ll value is NaN.
+0001b420: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0001b430: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0001b440: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0001b450: 696e 6465 7865 7273 203a 2064 6963 742c  indexers : dict,
+0001b460: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0001b470: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
+0001b480: 2077 6974 6820 6b65 7973 2067 6976 656e   with keys given
+0001b490: 2062 7920 6469 6d65 6e73 696f 6e20 6e61   by dimension na
+0001b4a0: 6d65 7320 616e 6420 7661 6c75 6573 2067  mes and values g
+0001b4b0: 6976 656e 2062 790a 2020 2020 2020 2020  iven by.        
+0001b4c0: 2020 2020 6172 7261 7973 206f 6620 636f      arrays of co
+0001b4d0: 6f72 6469 6e61 7465 7320 7469 636b 206c  ordinates tick l
+0001b4e0: 6162 656c 732e 2041 6e79 206d 6973 2d6d  abels. Any mis-m
+0001b4f0: 6174 6368 6564 2063 6f6f 7264 696e 6174  atched coordinat
+0001b500: 650a 2020 2020 2020 2020 2020 2020 7661  e.            va
+0001b510: 6c75 6573 2077 696c 6c20 6265 2066 696c  lues will be fil
+0001b520: 6c65 6420 696e 2077 6974 6820 4e61 4e2c  led in with NaN,
+0001b530: 2061 6e64 2061 6e79 206d 6973 2d6d 6174   and any mis-mat
+0001b540: 6368 6564 2064 696d 656e 7369 6f6e 0a20  ched dimension. 
+0001b550: 2020 2020 2020 2020 2020 206e 616d 6573             names
+0001b560: 2077 696c 6c20 7369 6d70 6c79 2062 6520   will simply be 
+0001b570: 6967 6e6f 7265 642e 0a20 2020 2020 2020  ignored..       
+0001b580: 2020 2020 204f 6e65 206f 6620 696e 6465       One of inde
+0001b590: 7865 7273 206f 7220 696e 6465 7865 7273  xers or indexers
+0001b5a0: 5f6b 7761 7267 7320 6d75 7374 2062 6520  _kwargs must be 
+0001b5b0: 7072 6f76 6964 6564 2e0a 2020 2020 2020  provided..      
+0001b5c0: 2020 6d65 7468 6f64 203a 207b 4e6f 6e65    method : {None
+0001b5d0: 2c20 226e 6561 7265 7374 222c 2022 7061  , "nearest", "pa
+0001b5e0: 6422 2c20 2266 6669 6c6c 222c 2022 6261  d", "ffill", "ba
+0001b5f0: 636b 6669 6c6c 222c 2022 6266 696c 6c22  ckfill", "bfill"
+0001b600: 2c20 4e6f 6e65 7d2c 206f 7074 696f 6e61  , None}, optiona
+0001b610: 6c0a 2020 2020 2020 2020 2020 2020 4d65  l.            Me
+0001b620: 7468 6f64 2074 6f20 7573 6520 666f 7220  thod to use for 
+0001b630: 6669 6c6c 696e 6720 696e 6465 7820 7661  filling index va
+0001b640: 6c75 6573 2069 6e20 6060 696e 6465 7865  lues in ``indexe
+0001b650: 7273 6060 206e 6f74 2066 6f75 6e64 2069  rs`` not found i
+0001b660: 6e0a 2020 2020 2020 2020 2020 2020 7468  n.            th
+0001b670: 6973 2064 6174 6173 6574 3a0a 0a20 2020  is dataset:..   
+0001b680: 2020 2020 2020 2020 202d 204e 6f6e 6520           - None 
+0001b690: 2864 6566 6175 6c74 293a 2064 6f6e 2774  (default): don't
+0001b6a0: 2066 696c 6c20 6761 7073 0a20 2020 2020   fill gaps.     
+0001b6b0: 2020 2020 2020 202d 2022 7061 6422 202f         - "pad" /
+0001b6c0: 2022 6666 696c 6c22 3a20 7072 6f70 6167   "ffill": propag
+0001b6d0: 6174 6520 6c61 7374 2076 616c 6964 2069  ate last valid i
+0001b6e0: 6e64 6578 2076 616c 7565 2066 6f72 7761  ndex value forwa
+0001b6f0: 7264 0a20 2020 2020 2020 2020 2020 202d  rd.            -
+0001b700: 2022 6261 636b 6669 6c6c 2220 2f20 2262   "backfill" / "b
+0001b710: 6669 6c6c 223a 2070 726f 7061 6761 7465  fill": propagate
+0001b720: 206e 6578 7420 7661 6c69 6420 696e 6465   next valid inde
+0001b730: 7820 7661 6c75 6520 6261 636b 7761 7264  x value backward
+0001b740: 0a20 2020 2020 2020 2020 2020 202d 2022  .            - "
+0001b750: 6e65 6172 6573 7422 3a20 7573 6520 6e65  nearest": use ne
+0001b760: 6172 6573 7420 7661 6c69 6420 696e 6465  arest valid inde
+0001b770: 7820 7661 6c75 650a 0a20 2020 2020 2020  x value..       
+0001b780: 2074 6f6c 6572 616e 6365 203a 206f 7074   tolerance : opt
+0001b790: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0001b7a0: 2020 4d61 7869 6d75 6d20 6469 7374 616e    Maximum distan
+0001b7b0: 6365 2062 6574 7765 656e 206f 7269 6769  ce between origi
+0001b7c0: 6e61 6c20 616e 6420 6e65 7720 6c61 6265  nal and new labe
+0001b7d0: 6c73 2066 6f72 2069 6e65 7861 6374 0a20  ls for inexact. 
+0001b7e0: 2020 2020 2020 2020 2020 206d 6174 6368             match
+0001b7f0: 6573 2e20 5468 6520 7661 6c75 6573 206f  es. The values o
+0001b800: 6620 7468 6520 696e 6465 7820 6174 2074  f the index at t
+0001b810: 6865 206d 6174 6368 696e 6720 6c6f 6361  he matching loca
+0001b820: 7469 6f6e 7320 6d75 7374 0a20 2020 2020  tions must.     
+0001b830: 2020 2020 2020 2073 6174 6973 6679 2074         satisfy t
+0001b840: 6865 2065 7175 6174 696f 6e20 6060 6162  he equation ``ab
+0001b850: 7328 696e 6465 785b 696e 6465 7865 725d  s(index[indexer]
+0001b860: 202d 2074 6172 6765 7429 203c 3d20 746f   - target) <= to
+0001b870: 6c65 7261 6e63 6560 602e 0a20 2020 2020  lerance``..     
+0001b880: 2020 2020 2020 2054 6f6c 6572 616e 6365         Tolerance
+0001b890: 206d 6179 2062 6520 6120 7363 616c 6172   may be a scalar
+0001b8a0: 2076 616c 7565 2c20 7768 6963 6820 6170   value, which ap
+0001b8b0: 706c 6965 7320 7468 6520 7361 6d65 2074  plies the same t
+0001b8c0: 6f6c 6572 616e 6365 0a20 2020 2020 2020  olerance.       
+0001b8d0: 2020 2020 2074 6f20 616c 6c20 7661 6c75       to all valu
+0001b8e0: 6573 2c20 6f72 206c 6973 742d 6c69 6b65  es, or list-like
+0001b8f0: 2c20 7768 6963 6820 6170 706c 6965 7320  , which applies 
+0001b900: 7661 7269 6162 6c65 2074 6f6c 6572 616e  variable toleran
+0001b910: 6365 2070 6572 0a20 2020 2020 2020 2020  ce per.         
+0001b920: 2020 2065 6c65 6d65 6e74 2e20 4c69 7374     element. List
+0001b930: 2d6c 696b 6520 6d75 7374 2062 6520 7468  -like must be th
+0001b940: 6520 7361 6d65 2073 697a 6520 6173 2074  e same size as t
+0001b950: 6865 2069 6e64 6578 2061 6e64 2069 7473  he index and its
+0001b960: 2064 7479 7065 0a20 2020 2020 2020 2020   dtype.         
+0001b970: 2020 206d 7573 7420 6578 6163 746c 7920     must exactly 
+0001b980: 6d61 7463 6820 7468 6520 696e 6465 78e2  match the index.
+0001b990: 8099 7320 7479 7065 2e0a 2020 2020 2020  ..s type..      
+0001b9a0: 2020 636f 7079 203a 2062 6f6f 6c2c 2064    copy : bool, d
+0001b9b0: 6566 6175 6c74 3a20 5472 7565 0a20 2020  efault: True.   
+0001b9c0: 2020 2020 2020 2020 2049 6620 6060 636f           If ``co
+0001b9d0: 7079 3d54 7275 6560 602c 2064 6174 6120  py=True``, data 
+0001b9e0: 696e 2074 6865 2072 6574 7572 6e20 7661  in the return va
+0001b9f0: 6c75 6520 6973 2061 6c77 6179 7320 636f  lue is always co
+0001ba00: 7069 6564 2e20 4966 0a20 2020 2020 2020  pied. If.       
+0001ba10: 2020 2020 2060 6063 6f70 793d 4661 6c73       ``copy=Fals
+0001ba20: 6560 6020 616e 6420 7265 696e 6465 7869  e`` and reindexi
+0001ba30: 6e67 2069 7320 756e 6e65 6365 7373 6172  ng is unnecessar
+0001ba40: 792c 206f 7220 6361 6e20 6265 2070 6572  y, or can be per
+0001ba50: 666f 726d 6564 0a20 2020 2020 2020 2020  formed.         
+0001ba60: 2020 2077 6974 6820 6f6e 6c79 2073 6c69     with only sli
+0001ba70: 6365 206f 7065 7261 7469 6f6e 732c 2074  ce operations, t
+0001ba80: 6865 6e20 7468 6520 6f75 7470 7574 206d  hen the output m
+0001ba90: 6179 2073 6861 7265 206d 656d 6f72 7920  ay share memory 
+0001baa0: 7769 7468 0a20 2020 2020 2020 2020 2020  with.           
+0001bab0: 2074 6865 2069 6e70 7574 2e20 496e 2065   the input. In e
+0001bac0: 6974 6865 7220 6361 7365 2c20 6120 6e65  ither case, a ne
+0001bad0: 7720 7861 7272 6179 206f 626a 6563 7420  w xarray object 
+0001bae0: 6973 2061 6c77 6179 7320 7265 7475 726e  is always return
+0001baf0: 6564 2e0a 2020 2020 2020 2020 6669 6c6c  ed..        fill
+0001bb00: 5f76 616c 7565 203a 2073 6361 6c61 7220  _value : scalar 
+0001bb10: 6f72 2064 6963 742d 6c69 6b65 2c20 6f70  or dict-like, op
+0001bb20: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+0001bb30: 2020 2056 616c 7565 2074 6f20 7573 6520     Value to use 
+0001bb40: 666f 7220 6e65 776c 7920 6d69 7373 696e  for newly missin
+0001bb50: 6720 7661 6c75 6573 2e20 4966 2061 2064  g values. If a d
+0001bb60: 6963 742d 6c69 6b65 2c0a 2020 2020 2020  ict-like,.      
+0001bb70: 2020 2020 2020 6d61 7073 2076 6172 6961        maps varia
+0001bb80: 626c 6520 6e61 6d65 7320 2869 6e63 6c75  ble names (inclu
+0001bb90: 6469 6e67 2063 6f6f 7264 696e 6174 6573  ding coordinates
+0001bba0: 2920 746f 2066 696c 6c20 7661 6c75 6573  ) to fill values
+0001bbb0: 2e0a 2020 2020 2020 2020 7370 6172 7365  ..        sparse
+0001bbc0: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+0001bbd0: 3a20 4661 6c73 650a 2020 2020 2020 2020  : False.        
+0001bbe0: 2020 2020 7573 6520 7370 6172 7365 2d61      use sparse-a
+0001bbf0: 7272 6179 2e0a 2020 2020 2020 2020 2a2a  rray..        **
+0001bc00: 696e 6465 7865 7273 5f6b 7761 7267 7320  indexers_kwargs 
+0001bc10: 3a20 7b64 696d 3a20 696e 6465 7865 722c  : {dim: indexer,
+0001bc20: 202e 2e2e 7d2c 206f 7074 696f 6e61 6c0a   ...}, optional.
+0001bc30: 2020 2020 2020 2020 2020 2020 4b65 7977              Keyw
+0001bc40: 6f72 6420 6172 6775 6d65 6e74 7320 696e  ord arguments in
+0001bc50: 2074 6865 2073 616d 6520 666f 726d 2061   the same form a
+0001bc60: 7320 6060 696e 6465 7865 7273 6060 2e0a  s ``indexers``..
+0001bc70: 2020 2020 2020 2020 2020 2020 4f6e 6520              One 
+0001bc80: 6f66 2069 6e64 6578 6572 7320 6f72 2069  of indexers or i
+0001bc90: 6e64 6578 6572 735f 6b77 6172 6773 206d  ndexers_kwargs m
+0001bca0: 7573 7420 6265 2070 726f 7669 6465 642e  ust be provided.
+0001bcb0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001bcc0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0001bcd0: 2d0a 2020 2020 2020 2020 7265 696e 6465  -.        reinde
+0001bce0: 7865 6420 3a20 4461 7461 7365 740a 2020  xed : Dataset.  
+0001bcf0: 2020 2020 2020 2020 2020 416e 6f74 6865            Anothe
+0001bd00: 7220 6461 7461 7365 742c 2077 6974 6820  r dataset, with 
+0001bd10: 7468 6973 2064 6174 6173 6574 2773 2064  this dataset's d
+0001bd20: 6174 6120 6275 7420 7265 706c 6163 6564  ata but replaced
+0001bd30: 2063 6f6f 7264 696e 6174 6573 2e0a 0a20   coordinates... 
+0001bd40: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+0001bd50: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0001bd60: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
+0001bd70: 2e72 6569 6e64 6578 5f6c 696b 650a 2020  .reindex_like.  
+0001bd80: 2020 2020 2020 616c 6967 6e0a 2020 2020        align.    
+0001bd90: 2020 2020 7061 6e64 6173 2e49 6e64 6578      pandas.Index
+0001bda0: 2e67 6574 5f69 6e64 6578 6572 0a0a 2020  .get_indexer..  
+0001bdb0: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
+0001bdc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+0001bdd0: 2020 2020 2020 2020 4372 6561 7465 2061          Create a
+0001bde0: 2064 6174 6173 6574 2077 6974 6820 736f   dataset with so
+0001bdf0: 6d65 2066 6963 7469 6f6e 616c 2064 6174  me fictional dat
+0001be00: 612e 0a0a 2020 2020 2020 2020 3e3e 3e20  a...        >>> 
+0001be10: 7820 3d20 7872 2e44 6174 6173 6574 280a  x = xr.Dataset(.
+0001be20: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001be30: 7b0a 2020 2020 2020 2020 2e2e 2e20 2020  {.        ...   
+0001be40: 2020 2020 2020 2274 656d 7065 7261 7475        "temperatu
+0001be50: 7265 223a 2028 2273 7461 7469 6f6e 222c  re": ("station",
+0001be60: 2032 3020 2a20 6e70 2e72 616e 646f 6d2e   20 * np.random.
+0001be70: 7261 6e64 2834 2929 2c0a 2020 2020 2020  rand(4)),.      
+0001be80: 2020 2e2e 2e20 2020 2020 2020 2020 2270    ...         "p
+0001be90: 7265 7373 7572 6522 3a20 2822 7374 6174  ressure": ("stat
+0001bea0: 696f 6e22 2c20 3530 3020 2a20 6e70 2e72  ion", 500 * np.r
+0001beb0: 616e 646f 6d2e 7261 6e64 2834 2929 2c0a  andom.rand(4)),.
+0001bec0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0001bed0: 7d2c 0a20 2020 2020 2020 202e 2e2e 2020  },.        ...  
+0001bee0: 2020 2063 6f6f 7264 733d 7b22 7374 6174     coords={"stat
+0001bef0: 696f 6e22 3a20 5b22 626f 7374 6f6e 222c  ion": ["boston",
+0001bf00: 2022 6e79 6322 2c20 2273 6561 7474 6c65   "nyc", "seattle
+0001bf10: 222c 2022 6465 6e76 6572 225d 7d2c 0a20  ", "denver"]},. 
+0001bf20: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+0001bf30: 2020 2020 203e 3e3e 2078 0a20 2020 2020       >>> x.     
+0001bf40: 2020 203c 7861 7272 6179 2e44 6174 6173     <xarray.Datas
+0001bf50: 6574 3e0a 2020 2020 2020 2020 4469 6d65  et>.        Dime
+0001bf60: 6e73 696f 6e73 3a20 2020 2020 2028 7374  nsions:      (st
+0001bf70: 6174 696f 6e3a 2034 290a 2020 2020 2020  ation: 4).      
+0001bf80: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
+0001bf90: 2020 2020 2020 2020 202a 2073 7461 7469           * stati
+0001bfa0: 6f6e 2020 2020 2020 2873 7461 7469 6f6e  on      (station
+0001bfb0: 2920 3c55 3720 2762 6f73 746f 6e27 2027  ) <U7 'boston' '
+0001bfc0: 6e79 6327 2027 7365 6174 746c 6527 2027  nyc' 'seattle' '
+0001bfd0: 6465 6e76 6572 270a 2020 2020 2020 2020  denver'.        
+0001bfe0: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
+0001bff0: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
+0001c000: 6572 6174 7572 6520 2028 7374 6174 696f  erature  (statio
+0001c010: 6e29 2066 6c6f 6174 3634 2031 302e 3938  n) float64 10.98
+0001c020: 2031 342e 3320 3132 2e30 3620 3130 2e39   14.3 12.06 10.9
+0001c030: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+0001c040: 7373 7572 6520 2020 2020 2873 7461 7469  ssure     (stati
+0001c050: 6f6e 2920 666c 6f61 7436 3420 3231 312e  on) float64 211.
+0001c060: 3820 3332 322e 3920 3231 382e 3820 3434  8 322.9 218.8 44
+0001c070: 352e 390a 2020 2020 2020 2020 3e3e 3e20  5.9.        >>> 
+0001c080: 782e 696e 6465 7865 730a 2020 2020 2020  x.indexes.      
+0001c090: 2020 496e 6465 7865 733a 0a20 2020 2020    Indexes:.     
+0001c0a0: 2020 2020 2020 2073 7461 7469 6f6e 2020         station  
+0001c0b0: 496e 6465 7828 5b27 626f 7374 6f6e 272c  Index(['boston',
+0001c0c0: 2027 6e79 6327 2c20 2773 6561 7474 6c65   'nyc', 'seattle
+0001c0d0: 272c 2027 6465 6e76 6572 275d 2c20 6474  ', 'denver'], dt
+0001c0e0: 7970 653d 276f 626a 6563 7427 2c20 6e61  ype='object', na
+0001c0f0: 6d65 3d27 7374 6174 696f 6e27 290a 0a20  me='station').. 
+0001c100: 2020 2020 2020 2043 7265 6174 6520 6120         Create a 
+0001c110: 6e65 7720 696e 6465 7820 616e 6420 7265  new index and re
+0001c120: 696e 6465 7820 7468 6520 6461 7461 7365  index the datase
+0001c130: 742e 2042 7920 6465 6661 756c 7420 7661  t. By default va
+0001c140: 6c75 6573 2069 6e20 7468 6520 6e65 7720  lues in the new 
+0001c150: 696e 6465 7820 7468 6174 0a20 2020 2020  index that.     
+0001c160: 2020 2064 6f20 6e6f 7420 6861 7665 2063     do not have c
+0001c170: 6f72 7265 7370 6f6e 6469 6e67 2072 6563  orresponding rec
+0001c180: 6f72 6473 2069 6e20 7468 6520 6461 7461  ords in the data
+0001c190: 7365 7420 6172 6520 6173 7369 676e 6564  set are assigned
+0001c1a0: 2060 4e61 4e60 2e0a 0a20 2020 2020 2020   `NaN`...       
+0001c1b0: 203e 3e3e 206e 6577 5f69 6e64 6578 203d   >>> new_index =
+0001c1c0: 205b 2262 6f73 746f 6e22 2c20 2261 7573   ["boston", "aus
+0001c1d0: 7469 6e22 2c20 2273 6561 7474 6c65 222c  tin", "seattle",
+0001c1e0: 2022 6c69 6e63 6f6c 6e22 5d0a 2020 2020   "lincoln"].    
+0001c1f0: 2020 2020 3e3e 3e20 782e 7265 696e 6465      >>> x.reinde
+0001c200: 7828 7b22 7374 6174 696f 6e22 3a20 6e65  x({"station": ne
+0001c210: 775f 696e 6465 787d 290a 2020 2020 2020  w_index}).      
+0001c220: 2020 3c78 6172 7261 792e 4461 7461 7365    <xarray.Datase
+0001c230: 743e 0a20 2020 2020 2020 2044 696d 656e  t>.        Dimen
+0001c240: 7369 6f6e 733a 2020 2020 2020 2873 7461  sions:      (sta
+0001c250: 7469 6f6e 3a20 3429 0a20 2020 2020 2020  tion: 4).       
+0001c260: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
+0001c270: 2020 2020 2020 2020 2a20 7374 6174 696f          * statio
+0001c280: 6e20 2020 2020 2028 7374 6174 696f 6e29  n      (station)
+0001c290: 203c 5537 2027 626f 7374 6f6e 2720 2761   <U7 'boston' 'a
+0001c2a0: 7573 7469 6e27 2027 7365 6174 746c 6527  ustin' 'seattle'
+0001c2b0: 2027 6c69 6e63 6f6c 6e27 0a20 2020 2020   'lincoln'.     
+0001c2c0: 2020 2044 6174 6120 7661 7269 6162 6c65     Data variable
+0001c2d0: 733a 0a20 2020 2020 2020 2020 2020 2074  s:.            t
+0001c2e0: 656d 7065 7261 7475 7265 2020 2873 7461  emperature  (sta
+0001c2f0: 7469 6f6e 2920 666c 6f61 7436 3420 3130  tion) float64 10
+0001c300: 2e39 3820 6e61 6e20 3132 2e30 3620 6e61  .98 nan 12.06 na
+0001c310: 6e0a 2020 2020 2020 2020 2020 2020 7072  n.            pr
+0001c320: 6573 7375 7265 2020 2020 2028 7374 6174  essure     (stat
+0001c330: 696f 6e29 2066 6c6f 6174 3634 2032 3131  ion) float64 211
+0001c340: 2e38 206e 616e 2032 3138 2e38 206e 616e  .8 nan 218.8 nan
+0001c350: 0a0a 2020 2020 2020 2020 5765 2063 616e  ..        We can
+0001c360: 2066 696c 6c20 696e 2074 6865 206d 6973   fill in the mis
+0001c370: 7369 6e67 2076 616c 7565 7320 6279 2070  sing values by p
+0001c380: 6173 7369 6e67 2061 2076 616c 7565 2074  assing a value t
+0001c390: 6f20 7468 6520 6b65 7977 6f72 6420 6066  o the keyword `f
+0001c3a0: 696c 6c5f 7661 6c75 6560 2e0a 0a20 2020  ill_value`...   
+0001c3b0: 2020 2020 203e 3e3e 2078 2e72 6569 6e64       >>> x.reind
+0001c3c0: 6578 287b 2273 7461 7469 6f6e 223a 206e  ex({"station": n
+0001c3d0: 6577 5f69 6e64 6578 7d2c 2066 696c 6c5f  ew_index}, fill_
+0001c3e0: 7661 6c75 653d 3029 0a20 2020 2020 2020  value=0).       
+0001c3f0: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+0001c400: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
+0001c410: 696f 6e73 3a20 2020 2020 2028 7374 6174  ions:      (stat
+0001c420: 696f 6e3a 2034 290a 2020 2020 2020 2020  ion: 4).        
+0001c430: 436f 6f72 6469 6e61 7465 733a 0a20 2020  Coordinates:.   
+0001c440: 2020 2020 2020 202a 2073 7461 7469 6f6e         * station
+0001c450: 2020 2020 2020 2873 7461 7469 6f6e 2920        (station) 
+0001c460: 3c55 3720 2762 6f73 746f 6e27 2027 6175  <U7 'boston' 'au
+0001c470: 7374 696e 2720 2773 6561 7474 6c65 2720  stin' 'seattle' 
+0001c480: 276c 696e 636f 6c6e 270a 2020 2020 2020  'lincoln'.      
+0001c490: 2020 4461 7461 2076 6172 6961 626c 6573    Data variables
+0001c4a0: 3a0a 2020 2020 2020 2020 2020 2020 7465  :.            te
+0001c4b0: 6d70 6572 6174 7572 6520 2028 7374 6174  mperature  (stat
+0001c4c0: 696f 6e29 2066 6c6f 6174 3634 2031 302e  ion) float64 10.
+0001c4d0: 3938 2030 2e30 2031 322e 3036 2030 2e30  98 0.0 12.06 0.0
+0001c4e0: 0a20 2020 2020 2020 2020 2020 2070 7265  .            pre
+0001c4f0: 7373 7572 6520 2020 2020 2873 7461 7469  ssure     (stati
+0001c500: 6f6e 2920 666c 6f61 7436 3420 3231 312e  on) float64 211.
+0001c510: 3820 302e 3020 3231 382e 3820 302e 300a  8 0.0 218.8 0.0.
+0001c520: 0a20 2020 2020 2020 2057 6520 6361 6e20  .        We can 
+0001c530: 616c 736f 2075 7365 2064 6966 6665 7265  also use differe
+0001c540: 6e74 2066 696c 6c20 7661 6c75 6573 2066  nt fill values f
+0001c550: 6f72 2065 6163 6820 7661 7269 6162 6c65  or each variable
+0001c560: 2e0a 0a20 2020 2020 2020 203e 3e3e 2078  ...        >>> x
+0001c570: 2e72 6569 6e64 6578 280a 2020 2020 2020  .reindex(.      
+0001c580: 2020 2e2e 2e20 2020 2020 7b22 7374 6174    ...     {"stat
+0001c590: 696f 6e22 3a20 6e65 775f 696e 6465 787d  ion": new_index}
+0001c5a0: 2c20 6669 6c6c 5f76 616c 7565 3d7b 2274  , fill_value={"t
+0001c5b0: 656d 7065 7261 7475 7265 223a 2030 2c20  emperature": 0, 
+0001c5c0: 2270 7265 7373 7572 6522 3a20 3130 307d  "pressure": 100}
+0001c5d0: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
+0001c5e0: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
+0001c5f0: 6174 6173 6574 3e0a 2020 2020 2020 2020  ataset>.        
+0001c600: 4469 6d65 6e73 696f 6e73 3a20 2020 2020  Dimensions:     
+0001c610: 2028 7374 6174 696f 6e3a 2034 290a 2020   (station: 4).  
+0001c620: 2020 2020 2020 436f 6f72 6469 6e61 7465        Coordinate
+0001c630: 733a 0a20 2020 2020 2020 2020 202a 2073  s:.          * s
+0001c640: 7461 7469 6f6e 2020 2020 2020 2873 7461  tation      (sta
+0001c650: 7469 6f6e 2920 3c55 3720 2762 6f73 746f  tion) <U7 'bosto
+0001c660: 6e27 2027 6175 7374 696e 2720 2773 6561  n' 'austin' 'sea
+0001c670: 7474 6c65 2720 276c 696e 636f 6c6e 270a  ttle' 'lincoln'.
+0001c680: 2020 2020 2020 2020 4461 7461 2076 6172          Data var
+0001c690: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
+0001c6a0: 2020 2020 7465 6d70 6572 6174 7572 6520      temperature 
+0001c6b0: 2028 7374 6174 696f 6e29 2066 6c6f 6174   (station) float
+0001c6c0: 3634 2031 302e 3938 2030 2e30 2031 322e  64 10.98 0.0 12.
+0001c6d0: 3036 2030 2e30 0a20 2020 2020 2020 2020  06 0.0.         
+0001c6e0: 2020 2070 7265 7373 7572 6520 2020 2020     pressure     
+0001c6f0: 2873 7461 7469 6f6e 2920 666c 6f61 7436  (station) float6
+0001c700: 3420 3231 312e 3820 3130 302e 3020 3231  4 211.8 100.0 21
+0001c710: 382e 3820 3130 302e 300a 0a20 2020 2020  8.8 100.0..     
+0001c720: 2020 2042 6563 6175 7365 2074 6865 2069     Because the i
+0001c730: 6e64 6578 2069 7320 6e6f 7420 6d6f 6e6f  ndex is not mono
+0001c740: 746f 6e69 6361 6c6c 7920 696e 6372 6561  tonically increa
+0001c750: 7369 6e67 206f 7220 6465 6372 6561 7369  sing or decreasi
+0001c760: 6e67 2c20 7765 2063 616e 6e6f 7420 7573  ng, we cannot us
+0001c770: 6520 6172 6775 6d65 6e74 730a 2020 2020  e arguments.    
+0001c780: 2020 2020 746f 2074 6865 206b 6579 776f      to the keywo
+0001c790: 7264 206d 6574 686f 6420 746f 2066 696c  rd method to fil
+0001c7a0: 6c20 7468 6520 604e 614e 6020 7661 6c75  l the `NaN` valu
+0001c7b0: 6573 2e0a 0a20 2020 2020 2020 203e 3e3e  es...        >>>
+0001c7c0: 2078 2e72 6569 6e64 6578 287b 2273 7461   x.reindex({"sta
+0001c7d0: 7469 6f6e 223a 206e 6577 5f69 6e64 6578  tion": new_index
+0001c7e0: 7d2c 206d 6574 686f 643d 226e 6561 7265  }, method="neare
+0001c7f0: 7374 2229 0a20 2020 2020 2020 2054 7261  st").        Tra
+0001c800: 6365 6261 636b 2028 6d6f 7374 2072 6563  ceback (most rec
+0001c810: 656e 7420 6361 6c6c 206c 6173 7429 3a0a  ent call last):.
+0001c820: 2020 2020 2020 2020 2e2e 2e0a 2020 2020          ....    
+0001c830: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0001c840: 6c75 6545 7272 6f72 2827 696e 6465 7820  lueError('index 
+0001c850: 6d75 7374 2062 6520 6d6f 6e6f 746f 6e69  must be monotoni
+0001c860: 6320 696e 6372 6561 7369 6e67 206f 7220  c increasing or 
+0001c870: 6465 6372 6561 7369 6e67 2729 0a20 2020  decreasing').   
+0001c880: 2020 2020 2056 616c 7565 4572 726f 723a       ValueError:
+0001c890: 2069 6e64 6578 206d 7573 7420 6265 206d   index must be m
+0001c8a0: 6f6e 6f74 6f6e 6963 2069 6e63 7265 6173  onotonic increas
+0001c8b0: 696e 6720 6f72 2064 6563 7265 6173 696e  ing or decreasin
+0001c8c0: 670a 0a20 2020 2020 2020 2054 6f20 6675  g..        To fu
+0001c8d0: 7274 6865 7220 696c 6c75 7374 7261 7465  rther illustrate
+0001c8e0: 2074 6865 2066 696c 6c69 6e67 2066 756e   the filling fun
+0001c8f0: 6374 696f 6e61 6c69 7479 2069 6e20 7265  ctionality in re
+0001c900: 696e 6465 782c 2077 6520 7769 6c6c 2063  index, we will c
+0001c910: 7265 6174 6520 610a 2020 2020 2020 2020  reate a.        
+0001c920: 6461 7461 7365 7420 7769 7468 2061 206d  dataset with a m
+0001c930: 6f6e 6f74 6f6e 6963 616c 6c79 2069 6e63  onotonically inc
+0001c940: 7265 6173 696e 6720 696e 6465 7820 2866  reasing index (f
+0001c950: 6f72 2065 7861 6d70 6c65 2c20 6120 7365  or example, a se
+0001c960: 7175 656e 6365 206f 6620 6461 7465 7329  quence of dates)
+0001c970: 2e0a 0a20 2020 2020 2020 203e 3e3e 2078  ...        >>> x
+0001c980: 3220 3d20 7872 2e44 6174 6173 6574 280a  2 = xr.Dataset(.
 0001c990: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0001c9a0: 636f 6f72 6473 3d7b 2274 696d 6522 3a20  coords={"time": 
-0001c9b0: 7064 2e64 6174 655f 7261 6e67 6528 2230  pd.date_range("0
-0001c9c0: 312f 3031 2f32 3031 3922 2c20 7065 7269  1/01/2019", peri
-0001c9d0: 6f64 733d 362c 2066 7265 713d 2244 2229  ods=6, freq="D")
-0001c9e0: 7d2c 0a20 2020 2020 2020 202e 2e2e 2029  },.        ... )
-0001c9f0: 0a20 2020 2020 2020 203e 3e3e 2078 320a  .        >>> x2.
-0001ca00: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
-0001ca10: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
-0001ca20: 2044 696d 656e 7369 6f6e 733a 2020 2020   Dimensions:    
-0001ca30: 2020 2874 696d 653a 2036 290a 2020 2020    (time: 6).    
-0001ca40: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
-0001ca50: 0a20 2020 2020 2020 2020 202a 2074 696d  .          * tim
-0001ca60: 6520 2020 2020 2020 2020 2874 696d 6529  e         (time)
-0001ca70: 2064 6174 6574 696d 6536 345b 6e73 5d20   datetime64[ns] 
-0001ca80: 3230 3139 2d30 312d 3031 2032 3031 392d  2019-01-01 2019-
-0001ca90: 3031 2d30 3220 2e2e 2e20 3230 3139 2d30  01-02 ... 2019-0
-0001caa0: 312d 3036 0a20 2020 2020 2020 2044 6174  1-06.        Dat
-0001cab0: 6120 7661 7269 6162 6c65 733a 0a20 2020  a variables:.   
-0001cac0: 2020 2020 2020 2020 2074 656d 7065 7261           tempera
-0001cad0: 7475 7265 2020 2874 696d 6529 2066 6c6f  ture  (time) flo
-0001cae0: 6174 3634 2031 352e 3537 2031 322e 3737  at64 15.57 12.77
-0001caf0: 206e 616e 2030 2e33 3038 3120 3136 2e35   nan 0.3081 16.5
-0001cb00: 3920 3135 2e31 320a 2020 2020 2020 2020  9 15.12.        
-0001cb10: 2020 2020 7072 6573 7375 7265 2020 2020      pressure    
-0001cb20: 2028 7469 6d65 2920 666c 6f61 7436 3420   (time) float64 
-0001cb30: 3438 312e 3820 3139 312e 3720 3339 352e  481.8 191.7 395.
-0001cb40: 3920 3236 342e 3420 3238 342e 3020 3436  9 264.4 284.0 46
-0001cb50: 322e 380a 0a20 2020 2020 2020 2053 7570  2.8..        Sup
-0001cb60: 706f 7365 2077 6520 6465 6369 6465 2074  pose we decide t
-0001cb70: 6f20 6578 7061 6e64 2074 6865 2064 6174  o expand the dat
-0001cb80: 6173 6574 2074 6f20 636f 7665 7220 6120  aset to cover a 
-0001cb90: 7769 6465 7220 6461 7465 2072 616e 6765  wider date range
-0001cba0: 2e0a 0a20 2020 2020 2020 203e 3e3e 2074  ...        >>> t
-0001cbb0: 696d 655f 696e 6465 7832 203d 2070 642e  ime_index2 = pd.
-0001cbc0: 6461 7465 5f72 616e 6765 2822 3132 2f32  date_range("12/2
-0001cbd0: 392f 3230 3138 222c 2070 6572 696f 6473  9/2018", periods
-0001cbe0: 3d31 302c 2066 7265 713d 2244 2229 0a20  =10, freq="D"). 
-0001cbf0: 2020 2020 2020 203e 3e3e 2078 322e 7265         >>> x2.re
-0001cc00: 696e 6465 7828 7b22 7469 6d65 223a 2074  index({"time": t
-0001cc10: 696d 655f 696e 6465 7832 7d29 0a20 2020  ime_index2}).   
-0001cc20: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
-0001cc30: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
-0001cc40: 6d65 6e73 696f 6e73 3a20 2020 2020 2028  mensions:      (
-0001cc50: 7469 6d65 3a20 3130 290a 2020 2020 2020  time: 10).      
-0001cc60: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
-0001cc70: 2020 2020 2020 2020 202a 2074 696d 6520           * time 
-0001cc80: 2020 2020 2020 2020 2874 696d 6529 2064          (time) d
-0001cc90: 6174 6574 696d 6536 345b 6e73 5d20 3230  atetime64[ns] 20
-0001cca0: 3138 2d31 322d 3239 2032 3031 382d 3132  18-12-29 2018-12
-0001ccb0: 2d33 3020 2e2e 2e20 3230 3139 2d30 312d  -30 ... 2019-01-
-0001ccc0: 3037 0a20 2020 2020 2020 2044 6174 6120  07.        Data 
-0001ccd0: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
-0001cce0: 2020 2020 2020 2074 656d 7065 7261 7475         temperatu
-0001ccf0: 7265 2020 2874 696d 6529 2066 6c6f 6174  re  (time) float
-0001cd00: 3634 206e 616e 206e 616e 206e 616e 2031  64 nan nan nan 1
-0001cd10: 352e 3537 202e 2e2e 2030 2e33 3038 3120  5.57 ... 0.3081 
-0001cd20: 3136 2e35 3920 3135 2e31 3220 6e61 6e0a  16.59 15.12 nan.
-0001cd30: 2020 2020 2020 2020 2020 2020 7072 6573              pres
-0001cd40: 7375 7265 2020 2020 2028 7469 6d65 2920  sure     (time) 
-0001cd50: 666c 6f61 7436 3420 6e61 6e20 6e61 6e20  float64 nan nan 
-0001cd60: 6e61 6e20 3438 312e 3820 2e2e 2e20 3236  nan 481.8 ... 26
-0001cd70: 342e 3420 3238 342e 3020 3436 322e 3820  4.4 284.0 462.8 
-0001cd80: 6e61 6e0a 0a20 2020 2020 2020 2054 6865  nan..        The
-0001cd90: 2069 6e64 6578 2065 6e74 7269 6573 2074   index entries t
-0001cda0: 6861 7420 6469 6420 6e6f 7420 6861 7665  hat did not have
-0001cdb0: 2061 2076 616c 7565 2069 6e20 7468 6520   a value in the 
-0001cdc0: 6f72 6967 696e 616c 2064 6174 6120 6672  original data fr
-0001cdd0: 616d 6520 2866 6f72 2065 7861 6d70 6c65  ame (for example
-0001cde0: 2c20 6032 3031 382d 3132 2d32 3960 290a  , `2018-12-29`).
-0001cdf0: 2020 2020 2020 2020 6172 6520 6279 2064          are by d
-0001ce00: 6566 6175 6c74 2066 696c 6c65 6420 7769  efault filled wi
-0001ce10: 7468 204e 614e 2e20 4966 2064 6573 6972  th NaN. If desir
-0001ce20: 6564 2c20 7765 2063 616e 2066 696c 6c20  ed, we can fill 
-0001ce30: 696e 2074 6865 206d 6973 7369 6e67 2076  in the missing v
-0001ce40: 616c 7565 7320 7573 696e 6720 6f6e 6520  alues using one 
-0001ce50: 6f66 2073 6576 6572 616c 206f 7074 696f  of several optio
-0001ce60: 6e73 2e0a 0a20 2020 2020 2020 2046 6f72  ns...        For
-0001ce70: 2065 7861 6d70 6c65 2c20 746f 2062 6163   example, to bac
-0001ce80: 6b2d 7072 6f70 6167 6174 6520 7468 6520  k-propagate the 
-0001ce90: 6c61 7374 2076 616c 6964 2076 616c 7565  last valid value
-0001cea0: 2074 6f20 6669 6c6c 2074 6865 2060 4e61   to fill the `Na
-0001ceb0: 4e60 2076 616c 7565 732c 0a20 2020 2020  N` values,.     
-0001cec0: 2020 2070 6173 7320 6062 6669 6c6c 6020     pass `bfill` 
-0001ced0: 6173 2061 6e20 6172 6775 6d65 6e74 2074  as an argument t
-0001cee0: 6f20 7468 6520 606d 6574 686f 6460 206b  o the `method` k
-0001cef0: 6579 776f 7264 2e0a 0a20 2020 2020 2020  eyword...       
-0001cf00: 203e 3e3e 2078 3320 3d20 7832 2e72 6569   >>> x3 = x2.rei
-0001cf10: 6e64 6578 287b 2274 696d 6522 3a20 7469  ndex({"time": ti
-0001cf20: 6d65 5f69 6e64 6578 327d 2c20 6d65 7468  me_index2}, meth
-0001cf30: 6f64 3d22 6266 696c 6c22 290a 2020 2020  od="bfill").    
-0001cf40: 2020 2020 3e3e 3e20 7833 0a20 2020 2020      >>> x3.     
-0001cf50: 2020 203c 7861 7272 6179 2e44 6174 6173     <xarray.Datas
-0001cf60: 6574 3e0a 2020 2020 2020 2020 4469 6d65  et>.        Dime
-0001cf70: 6e73 696f 6e73 3a20 2020 2020 2028 7469  nsions:      (ti
-0001cf80: 6d65 3a20 3130 290a 2020 2020 2020 2020  me: 10).        
-0001cf90: 436f 6f72 6469 6e61 7465 733a 0a20 2020  Coordinates:.   
-0001cfa0: 2020 2020 2020 202a 2074 696d 6520 2020         * time   
-0001cfb0: 2020 2020 2020 2874 696d 6529 2064 6174        (time) dat
-0001cfc0: 6574 696d 6536 345b 6e73 5d20 3230 3138  etime64[ns] 2018
-0001cfd0: 2d31 322d 3239 2032 3031 382d 3132 2d33  -12-29 2018-12-3
-0001cfe0: 3020 2e2e 2e20 3230 3139 2d30 312d 3037  0 ... 2019-01-07
-0001cff0: 0a20 2020 2020 2020 2044 6174 6120 7661  .        Data va
-0001d000: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
-0001d010: 2020 2020 2074 656d 7065 7261 7475 7265       temperature
-0001d020: 2020 2874 696d 6529 2066 6c6f 6174 3634    (time) float64
-0001d030: 2031 352e 3537 2031 352e 3537 2031 352e   15.57 15.57 15.
-0001d040: 3537 2031 352e 3537 202e 2e2e 2031 362e  57 15.57 ... 16.
-0001d050: 3539 2031 352e 3132 206e 616e 0a20 2020  59 15.12 nan.   
-0001d060: 2020 2020 2020 2020 2070 7265 7373 7572           pressur
-0001d070: 6520 2020 2020 2874 696d 6529 2066 6c6f  e     (time) flo
-0001d080: 6174 3634 2034 3831 2e38 2034 3831 2e38  at64 481.8 481.8
-0001d090: 2034 3831 2e38 2034 3831 2e38 202e 2e2e   481.8 481.8 ...
-0001d0a0: 2032 3834 2e30 2034 3632 2e38 206e 616e   284.0 462.8 nan
-0001d0b0: 0a0a 2020 2020 2020 2020 506c 6561 7365  ..        Please
-0001d0c0: 206e 6f74 6520 7468 6174 2074 6865 2060   note that the `
-0001d0d0: 4e61 4e60 2076 616c 7565 2070 7265 7365  NaN` value prese
-0001d0e0: 6e74 2069 6e20 7468 6520 6f72 6967 696e  nt in the origin
-0001d0f0: 616c 2064 6174 6173 6574 2028 6174 2069  al dataset (at i
-0001d100: 6e64 6578 2076 616c 7565 2060 3230 3139  ndex value `2019
-0001d110: 2d30 312d 3033 6029 0a20 2020 2020 2020  -01-03`).       
-0001d120: 2077 696c 6c20 6e6f 7420 6265 2066 696c   will not be fil
-0001d130: 6c65 6420 6279 2061 6e79 206f 6620 7468  led by any of th
-0001d140: 6520 7661 6c75 6520 7072 6f70 6167 6174  e value propagat
-0001d150: 696f 6e20 7363 6865 6d65 732e 0a0a 2020  ion schemes...  
-0001d160: 2020 2020 2020 3e3e 3e20 7832 2e77 6865        >>> x2.whe
-0001d170: 7265 2878 322e 7465 6d70 6572 6174 7572  re(x2.temperatur
-0001d180: 652e 6973 6e75 6c6c 2829 2c20 6472 6f70  e.isnull(), drop
-0001d190: 3d54 7275 6529 0a20 2020 2020 2020 203c  =True).        <
-0001d1a0: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
-0001d1b0: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
-0001d1c0: 6e73 3a20 2020 2020 2028 7469 6d65 3a20  ns:      (time: 
-0001d1d0: 3129 0a20 2020 2020 2020 2043 6f6f 7264  1).        Coord
-0001d1e0: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
-0001d1f0: 2020 2a20 7469 6d65 2020 2020 2020 2020    * time        
-0001d200: 2028 7469 6d65 2920 6461 7465 7469 6d65   (time) datetime
-0001d210: 3634 5b6e 735d 2032 3031 392d 3031 2d30  64[ns] 2019-01-0
-0001d220: 330a 2020 2020 2020 2020 4461 7461 2076  3.        Data v
-0001d230: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
-0001d240: 2020 2020 2020 7465 6d70 6572 6174 7572        temperatur
-0001d250: 6520 2028 7469 6d65 2920 666c 6f61 7436  e  (time) float6
-0001d260: 3420 6e61 6e0a 2020 2020 2020 2020 2020  4 nan.          
-0001d270: 2020 7072 6573 7375 7265 2020 2020 2028    pressure     (
-0001d280: 7469 6d65 2920 666c 6f61 7436 3420 3339  time) float64 39
-0001d290: 352e 390a 2020 2020 2020 2020 3e3e 3e20  5.9.        >>> 
-0001d2a0: 7833 2e77 6865 7265 2878 332e 7465 6d70  x3.where(x3.temp
-0001d2b0: 6572 6174 7572 652e 6973 6e75 6c6c 2829  erature.isnull()
-0001d2c0: 2c20 6472 6f70 3d54 7275 6529 0a20 2020  , drop=True).   
-0001d2d0: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
-0001d2e0: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
-0001d2f0: 6d65 6e73 696f 6e73 3a20 2020 2020 2028  mensions:      (
-0001d300: 7469 6d65 3a20 3229 0a20 2020 2020 2020  time: 2).       
-0001d310: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
-0001d320: 2020 2020 2020 2020 2a20 7469 6d65 2020          * time  
-0001d330: 2020 2020 2020 2028 7469 6d65 2920 6461         (time) da
-0001d340: 7465 7469 6d65 3634 5b6e 735d 2032 3031  tetime64[ns] 201
-0001d350: 392d 3031 2d30 3320 3230 3139 2d30 312d  9-01-03 2019-01-
-0001d360: 3037 0a20 2020 2020 2020 2044 6174 6120  07.        Data 
-0001d370: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
-0001d380: 2020 2020 2020 2074 656d 7065 7261 7475         temperatu
-0001d390: 7265 2020 2874 696d 6529 2066 6c6f 6174  re  (time) float
-0001d3a0: 3634 206e 616e 206e 616e 0a20 2020 2020  64 nan nan.     
-0001d3b0: 2020 2020 2020 2070 7265 7373 7572 6520         pressure 
-0001d3c0: 2020 2020 2874 696d 6529 2066 6c6f 6174      (time) float
-0001d3d0: 3634 2033 3935 2e39 206e 616e 0a0a 2020  64 395.9 nan..  
-0001d3e0: 2020 2020 2020 5468 6973 2069 7320 6265        This is be
-0001d3f0: 6361 7573 6520 6669 6c6c 696e 6720 7768  cause filling wh
-0001d400: 696c 6520 7265 696e 6465 7869 6e67 2064  ile reindexing d
-0001d410: 6f65 7320 6e6f 7420 6c6f 6f6b 2061 7420  oes not look at 
-0001d420: 6461 7461 7365 7420 7661 6c75 6573 2c20  dataset values, 
-0001d430: 6275 7420 6f6e 6c79 2063 6f6d 7061 7265  but only compare
-0001d440: 730a 2020 2020 2020 2020 7468 6520 6f72  s.        the or
-0001d450: 6967 696e 616c 2061 6e64 2064 6573 6972  iginal and desir
-0001d460: 6564 2069 6e64 6578 6573 2e20 4966 2079  ed indexes. If y
-0001d470: 6f75 2064 6f20 7761 6e74 2074 6f20 6669  ou do want to fi
-0001d480: 6c6c 2069 6e20 7468 6520 604e 614e 6020  ll in the `NaN` 
-0001d490: 7661 6c75 6573 2070 7265 7365 6e74 2069  values present i
-0001d4a0: 6e20 7468 650a 2020 2020 2020 2020 6f72  n the.        or
-0001d4b0: 6967 696e 616c 2064 6174 6173 6574 2c20  iginal dataset, 
-0001d4c0: 7573 6520 7468 6520 3a70 793a 6d65 7468  use the :py:meth
-0001d4d0: 3a60 7e44 6174 6173 6574 2e66 696c 6c6e  :`~Dataset.filln
-0001d4e0: 6128 2960 206d 6574 686f 642e 0a0a 2020  a()` method...  
-0001d4f0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001d500: 2020 696e 6465 7865 7273 203d 2075 7469    indexers = uti
-0001d510: 6c73 2e65 6974 6865 725f 6469 6374 5f6f  ls.either_dict_o
-0001d520: 725f 6b77 6172 6773 2869 6e64 6578 6572  r_kwargs(indexer
-0001d530: 732c 2069 6e64 6578 6572 735f 6b77 6172  s, indexers_kwar
-0001d540: 6773 2c20 2272 6569 6e64 6578 2229 0a20  gs, "reindex"). 
-0001d550: 2020 2020 2020 2072 6574 7572 6e20 616c         return al
-0001d560: 6967 6e6d 656e 742e 7265 696e 6465 7828  ignment.reindex(
-0001d570: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001d580: 662c 0a20 2020 2020 2020 2020 2020 2069  f,.            i
-0001d590: 6e64 6578 6572 733d 696e 6465 7865 7273  ndexers=indexers
-0001d5a0: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-0001d5b0: 7468 6f64 3d6d 6574 686f 642c 0a20 2020  thod=method,.   
-0001d5c0: 2020 2020 2020 2020 2074 6f6c 6572 616e           toleran
-0001d5d0: 6365 3d74 6f6c 6572 616e 6365 2c0a 2020  ce=tolerance,.  
-0001d5e0: 2020 2020 2020 2020 2020 636f 7079 3d63            copy=c
-0001d5f0: 6f70 792c 0a20 2020 2020 2020 2020 2020  opy,.           
-0001d600: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
-0001d610: 5f76 616c 7565 2c0a 2020 2020 2020 2020  _value,.        
-0001d620: 290a 0a20 2020 2064 6566 205f 7265 696e  )..    def _rein
-0001d630: 6465 7828 0a20 2020 2020 2020 2073 656c  dex(.        sel
-0001d640: 663a 2054 5f44 6174 6173 6574 2c0a 2020  f: T_Dataset,.  
-0001d650: 2020 2020 2020 696e 6465 7865 7273 3a20        indexers: 
-0001d660: 4d61 7070 696e 675b 416e 792c 2041 6e79  Mapping[Any, Any
-0001d670: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-0001d680: 0a20 2020 2020 2020 206d 6574 686f 643a  .        method:
-0001d690: 2073 7472 207c 204e 6f6e 6520 3d20 4e6f   str | None = No
-0001d6a0: 6e65 2c0a 2020 2020 2020 2020 746f 6c65  ne,.        tole
-0001d6b0: 7261 6e63 653a 2069 6e74 207c 2066 6c6f  rance: int | flo
-0001d6c0: 6174 207c 2049 7465 7261 626c 655b 696e  at | Iterable[in
-0001d6d0: 7420 7c20 666c 6f61 745d 207c 204e 6f6e  t | float] | Non
-0001d6e0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-0001d6f0: 2020 636f 7079 3a20 626f 6f6c 203d 2054    copy: bool = T
-0001d700: 7275 652c 0a20 2020 2020 2020 2066 696c  rue,.        fil
-0001d710: 6c5f 7661 6c75 653a 2041 6e79 203d 2078  l_value: Any = x
-0001d720: 7264 7479 7065 732e 4e41 2c0a 2020 2020  rdtypes.NA,.    
-0001d730: 2020 2020 7370 6172 7365 3a20 626f 6f6c      sparse: bool
-0001d740: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
-0001d750: 2020 2a2a 696e 6465 7865 7273 5f6b 7761    **indexers_kwa
-0001d760: 7267 733a 2041 6e79 2c0a 2020 2020 2920  rgs: Any,.    ) 
-0001d770: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-0001d780: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001d790: 2020 5361 6d65 2061 7320 7265 696e 6465    Same as reinde
-0001d7a0: 7820 6275 7420 7375 7070 6f72 7473 2073  x but supports s
-0001d7b0: 7061 7273 6520 6f70 7469 6f6e 2e0a 2020  parse option..  
-0001d7c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001d7d0: 2020 696e 6465 7865 7273 203d 2075 7469    indexers = uti
-0001d7e0: 6c73 2e65 6974 6865 725f 6469 6374 5f6f  ls.either_dict_o
-0001d7f0: 725f 6b77 6172 6773 2869 6e64 6578 6572  r_kwargs(indexer
-0001d800: 732c 2069 6e64 6578 6572 735f 6b77 6172  s, indexers_kwar
-0001d810: 6773 2c20 2272 6569 6e64 6578 2229 0a20  gs, "reindex"). 
-0001d820: 2020 2020 2020 2072 6574 7572 6e20 616c         return al
-0001d830: 6967 6e6d 656e 742e 7265 696e 6465 7828  ignment.reindex(
-0001d840: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0001d850: 662c 0a20 2020 2020 2020 2020 2020 2069  f,.            i
-0001d860: 6e64 6578 6572 733d 696e 6465 7865 7273  ndexers=indexers
-0001d870: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
-0001d880: 7468 6f64 3d6d 6574 686f 642c 0a20 2020  thod=method,.   
-0001d890: 2020 2020 2020 2020 2074 6f6c 6572 616e           toleran
-0001d8a0: 6365 3d74 6f6c 6572 616e 6365 2c0a 2020  ce=tolerance,.  
-0001d8b0: 2020 2020 2020 2020 2020 636f 7079 3d63            copy=c
-0001d8c0: 6f70 792c 0a20 2020 2020 2020 2020 2020  opy,.           
-0001d8d0: 2066 696c 6c5f 7661 6c75 653d 6669 6c6c   fill_value=fill
-0001d8e0: 5f76 616c 7565 2c0a 2020 2020 2020 2020  _value,.        
-0001d8f0: 2020 2020 7370 6172 7365 3d73 7061 7273      sparse=spars
-0001d900: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
-0001d910: 2020 6465 6620 696e 7465 7270 280a 2020    def interp(.  
-0001d920: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
-0001d930: 7461 7365 742c 0a20 2020 2020 2020 2063  taset,.        c
-0001d940: 6f6f 7264 733a 204d 6170 7069 6e67 5b41  oords: Mapping[A
-0001d950: 6e79 2c20 416e 795d 207c 204e 6f6e 6520  ny, Any] | None 
-0001d960: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0001d970: 6d65 7468 6f64 3a20 496e 7465 7270 4f70  method: InterpOp
-0001d980: 7469 6f6e 7320 3d20 226c 696e 6561 7222  tions = "linear"
-0001d990: 2c0a 2020 2020 2020 2020 6173 7375 6d65  ,.        assume
-0001d9a0: 5f73 6f72 7465 643a 2062 6f6f 6c20 3d20  _sorted: bool = 
-0001d9b0: 4661 6c73 652c 0a20 2020 2020 2020 206b  False,.        k
-0001d9c0: 7761 7267 733a 204d 6170 7069 6e67 5b73  wargs: Mapping[s
-0001d9d0: 7472 2c20 416e 795d 207c 204e 6f6e 6520  tr, Any] | None 
-0001d9e0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0001d9f0: 6d65 7468 6f64 5f6e 6f6e 5f6e 756d 6572  method_non_numer
-0001da00: 6963 3a20 7374 7220 3d20 226e 6561 7265  ic: str = "neare
-0001da10: 7374 222c 0a20 2020 2020 2020 202a 2a63  st",.        **c
-0001da20: 6f6f 7264 735f 6b77 6172 6773 3a20 416e  oords_kwargs: An
-0001da30: 792c 0a20 2020 2029 202d 3e20 545f 4461  y,.    ) -> T_Da
-0001da40: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-0001da50: 2222 496e 7465 7270 6f6c 6174 6520 6120  ""Interpolate a 
-0001da60: 4461 7461 7365 7420 6f6e 746f 206e 6577  Dataset onto new
-0001da70: 2063 6f6f 7264 696e 6174 6573 0a0a 2020   coordinates..  
-0001da80: 2020 2020 2020 5065 7266 6f72 6d73 2075        Performs u
-0001da90: 6e69 7661 7269 6174 6520 6f72 206d 756c  nivariate or mul
-0001daa0: 7469 7661 7269 6174 6520 696e 7465 7270  tivariate interp
-0001dab0: 6f6c 6174 696f 6e20 6f66 2061 2044 6174  olation of a Dat
-0001dac0: 6173 6574 206f 6e74 6f0a 2020 2020 2020  aset onto.      
-0001dad0: 2020 6e65 7720 636f 6f72 6469 6e61 7465    new coordinate
-0001dae0: 7320 7573 696e 6720 7363 6970 7927 7320  s using scipy's 
-0001daf0: 696e 7465 7270 6f6c 6174 696f 6e20 726f  interpolation ro
-0001db00: 7574 696e 6573 2e20 4966 2069 6e74 6572  utines. If inter
-0001db10: 706f 6c61 7469 6e67 0a20 2020 2020 2020  polating.       
-0001db20: 2061 6c6f 6e67 2061 6e20 6578 6973 7469   along an existi
-0001db30: 6e67 2064 696d 656e 7369 6f6e 2c20 3a70  ng dimension, :p
-0001db40: 793a 636c 6173 733a 6073 6369 7079 2e69  y:class:`scipy.i
-0001db50: 6e74 6572 706f 6c61 7465 2e69 6e74 6572  nterpolate.inter
-0001db60: 7031 6460 2069 730a 2020 2020 2020 2020  p1d` is.        
-0001db70: 6361 6c6c 6564 2e20 2057 6865 6e20 696e  called.  When in
-0001db80: 7465 7270 6f6c 6174 696e 6720 616c 6f6e  terpolating alon
-0001db90: 6720 6d75 6c74 6970 6c65 2065 7869 7374  g multiple exist
-0001dba0: 696e 6720 6469 6d65 6e73 696f 6e73 2c20  ing dimensions, 
-0001dbb0: 616e 0a20 2020 2020 2020 2061 7474 656d  an.        attem
-0001dbc0: 7074 2069 7320 6d61 6465 2074 6f20 6465  pt is made to de
-0001dbd0: 636f 6d70 6f73 6520 7468 6520 696e 7465  compose the inte
-0001dbe0: 7270 6f6c 6174 696f 6e20 696e 746f 206d  rpolation into m
-0001dbf0: 756c 7469 706c 650a 2020 2020 2020 2020  ultiple.        
-0001dc00: 312d 6469 6d65 6e73 696f 6e61 6c20 696e  1-dimensional in
-0001dc10: 7465 7270 6f6c 6174 696f 6e73 2e20 4966  terpolations. If
-0001dc20: 2074 6869 7320 6973 2070 6f73 7369 626c   this is possibl
-0001dc30: 652c 0a20 2020 2020 2020 203a 7079 3a63  e,.        :py:c
-0001dc40: 6c61 7373 3a60 7363 6970 792e 696e 7465  lass:`scipy.inte
-0001dc50: 7270 6f6c 6174 652e 696e 7465 7270 3164  rpolate.interp1d
-0001dc60: 6020 6973 2063 616c 6c65 642e 204f 7468  ` is called. Oth
-0001dc70: 6572 7769 7365 2c0a 2020 2020 2020 2020  erwise,.        
-0001dc80: 3a70 793a 6675 6e63 3a60 7363 6970 792e  :py:func:`scipy.
-0001dc90: 696e 7465 7270 6f6c 6174 652e 696e 7465  interpolate.inte
-0001dca0: 7270 6e60 2069 7320 6361 6c6c 6564 2e0a  rpn` is called..
-0001dcb0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0001dcc0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-0001dcd0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2063  ------.        c
-0001dce0: 6f6f 7264 7320 3a20 6469 6374 2c20 6f70  oords : dict, op
-0001dcf0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0001dd00: 2020 204d 6170 7069 6e67 2066 726f 6d20     Mapping from 
-0001dd10: 6469 6d65 6e73 696f 6e20 6e61 6d65 7320  dimension names 
-0001dd20: 746f 2074 6865 206e 6577 2063 6f6f 7264  to the new coord
-0001dd30: 696e 6174 6573 2e0a 2020 2020 2020 2020  inates..        
-0001dd40: 2020 2020 4e65 7720 636f 6f72 6469 6e61      New coordina
-0001dd50: 7465 2063 616e 2062 6520 6120 7363 616c  te can be a scal
-0001dd60: 6172 2c20 6172 7261 792d 6c69 6b65 206f  ar, array-like o
-0001dd70: 7220 4461 7461 4172 7261 792e 0a20 2020  r DataArray..   
-0001dd80: 2020 2020 2020 2020 2049 6620 4461 7461           If Data
-0001dd90: 4172 7261 7973 2061 7265 2070 6173 7365  Arrays are passe
-0001dda0: 6420 6173 206e 6577 2063 6f6f 7264 696e  d as new coordin
-0001ddb0: 6174 6573 2c20 7468 6569 7220 6469 6d65  ates, their dime
-0001ddc0: 6e73 696f 6e73 2061 7265 0a20 2020 2020  nsions are.     
-0001ddd0: 2020 2020 2020 2075 7365 6420 666f 7220         used for 
-0001dde0: 7468 6520 6272 6f61 6463 6173 7469 6e67  the broadcasting
-0001ddf0: 2e20 4d69 7373 696e 6720 7661 6c75 6573  . Missing values
-0001de00: 2061 7265 2073 6b69 7070 6564 2e0a 2020   are skipped..  
-0001de10: 2020 2020 2020 6d65 7468 6f64 203a 207b        method : {
-0001de20: 226c 696e 6561 7222 2c20 226e 6561 7265  "linear", "neare
-0001de30: 7374 222c 2022 7a65 726f 222c 2022 736c  st", "zero", "sl
-0001de40: 696e 6561 7222 2c20 2271 7561 6472 6174  inear", "quadrat
-0001de50: 6963 222c 2022 6375 6269 6322 2c20 2270  ic", "cubic", "p
-0001de60: 6f6c 796e 6f6d 6961 6c22 2c20 5c0a 2020  olynomial", \.  
-0001de70: 2020 2020 2020 2020 2020 2262 6172 7963            "baryc
-0001de80: 656e 7472 6963 222c 2022 6b72 6f67 222c  entric", "krog",
-0001de90: 2022 7063 6869 7022 2c20 2273 706c 696e   "pchip", "splin
-0001dea0: 6522 2c20 2261 6b69 6d61 227d 2c20 6465  e", "akima"}, de
-0001deb0: 6661 756c 743a 2022 6c69 6e65 6172 220a  fault: "linear".
-0001dec0: 2020 2020 2020 2020 2020 2020 5374 7269              Stri
-0001ded0: 6e67 2069 6e64 6963 6174 696e 6720 7768  ng indicating wh
-0001dee0: 6963 6820 6d65 7468 6f64 2074 6f20 7573  ich method to us
-0001def0: 6520 666f 7220 696e 7465 7270 6f6c 6174  e for interpolat
-0001df00: 696f 6e3a 0a0a 2020 2020 2020 2020 2020  ion:..          
-0001df10: 2020 2d20 276c 696e 6561 7227 3a20 6c69    - 'linear': li
-0001df20: 6e65 6172 2069 6e74 6572 706f 6c61 7469  near interpolati
-0001df30: 6f6e 2e20 4164 6469 7469 6f6e 616c 206b  on. Additional k
-0001df40: 6579 776f 7264 0a20 2020 2020 2020 2020  eyword.         
-0001df50: 2020 2020 2061 7267 756d 656e 7473 2061       arguments a
-0001df60: 7265 2070 6173 7365 6420 746f 203a 7079  re passed to :py
-0001df70: 3a66 756e 633a 606e 756d 7079 2e69 6e74  :func:`numpy.int
-0001df80: 6572 7060 0a20 2020 2020 2020 2020 2020  erp`.           
-0001df90: 202d 2027 6e65 6172 6573 7427 2c20 277a   - 'nearest', 'z
-0001dfa0: 6572 6f27 2c20 2773 6c69 6e65 6172 272c  ero', 'slinear',
-0001dfb0: 2027 7175 6164 7261 7469 6327 2c20 2763   'quadratic', 'c
-0001dfc0: 7562 6963 272c 2027 706f 6c79 6e6f 6d69  ubic', 'polynomi
-0001dfd0: 616c 273a 0a20 2020 2020 2020 2020 2020  al':.           
-0001dfe0: 2020 2061 7265 2070 6173 7365 6420 746f     are passed to
-0001dff0: 203a 7079 3a66 756e 633a 6073 6369 7079   :py:func:`scipy
-0001e000: 2e69 6e74 6572 706f 6c61 7465 2e69 6e74  .interpolate.int
-0001e010: 6572 7031 6460 2e20 4966 0a20 2020 2020  erp1d`. If.     
-0001e020: 2020 2020 2020 2020 2060 606d 6574 686f           ``metho
-0001e030: 643d 2770 6f6c 796e 6f6d 6961 6c27 6060  d='polynomial'``
-0001e040: 2c20 7468 6520 6060 6f72 6465 7260 6020  , the ``order`` 
-0001e050: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-0001e060: 206d 7573 7420 616c 736f 2062 650a 2020   must also be.  
-0001e070: 2020 2020 2020 2020 2020 2020 7072 6f76              prov
-0001e080: 6964 6564 2e0a 2020 2020 2020 2020 2020  ided..          
-0001e090: 2020 2d20 2762 6172 7963 656e 7472 6963    - 'barycentric
-0001e0a0: 272c 2027 6b72 6f67 272c 2027 7063 6869  ', 'krog', 'pchi
-0001e0b0: 7027 2c20 2773 706c 696e 6527 2c20 2761  p', 'spline', 'a
-0001e0c0: 6b69 6d61 273a 2075 7365 2074 6865 6972  kima': use their
-0001e0d0: 0a20 2020 2020 2020 2020 2020 2020 2072  .              r
-0001e0e0: 6573 7065 6374 6976 6520 3a70 793a 636c  espective :py:cl
-0001e0f0: 6173 733a 6073 6369 7079 2e69 6e74 6572  ass:`scipy.inter
-0001e100: 706f 6c61 7465 6020 636c 6173 7365 732e  polate` classes.
-0001e110: 0a0a 2020 2020 2020 2020 6173 7375 6d65  ..        assume
-0001e120: 5f73 6f72 7465 6420 3a20 626f 6f6c 2c20  _sorted : bool, 
-0001e130: 6465 6661 756c 743a 2046 616c 7365 0a20  default: False. 
-0001e140: 2020 2020 2020 2020 2020 2049 6620 4661             If Fa
-0001e150: 6c73 652c 2076 616c 7565 7320 6f66 2063  lse, values of c
-0001e160: 6f6f 7264 696e 6174 6573 2074 6861 7420  oordinates that 
-0001e170: 6172 6520 696e 7465 7270 6f6c 6174 6564  are interpolated
-0001e180: 206f 7665 7220 6361 6e20 6265 0a20 2020   over can be.   
-0001e190: 2020 2020 2020 2020 2069 6e20 616e 7920           in any 
-0001e1a0: 6f72 6465 7220 616e 6420 7468 6579 2061  order and they a
-0001e1b0: 7265 2073 6f72 7465 6420 6669 7273 742e  re sorted first.
-0001e1c0: 2049 6620 5472 7565 2c20 696e 7465 7270   If True, interp
-0001e1d0: 6f6c 6174 6564 0a20 2020 2020 2020 2020  olated.         
-0001e1e0: 2020 2063 6f6f 7264 696e 6174 6573 2061     coordinates a
-0001e1f0: 7265 2061 7373 756d 6564 2074 6f20 6265  re assumed to be
-0001e200: 2061 6e20 6172 7261 7920 6f66 206d 6f6e   an array of mon
-0001e210: 6f74 6f6e 6963 616c 6c79 2069 6e63 7265  otonically incre
-0001e220: 6173 696e 670a 2020 2020 2020 2020 2020  asing.          
-0001e230: 2020 7661 6c75 6573 2e0a 2020 2020 2020    values..      
-0001e240: 2020 6b77 6172 6773 203a 2064 6963 742c    kwargs : dict,
-0001e250: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0001e260: 2020 2020 2020 4164 6469 7469 6f6e 616c        Additional
-0001e270: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-0001e280: 7473 2070 6173 7365 6420 746f 2073 6369  ts passed to sci
-0001e290: 7079 2773 2069 6e74 6572 706f 6c61 746f  py's interpolato
-0001e2a0: 722e 2056 616c 6964 0a20 2020 2020 2020  r. Valid.       
-0001e2b0: 2020 2020 206f 7074 696f 6e73 2061 6e64       options and
-0001e2c0: 2074 6865 6972 2062 6568 6176 696f 7220   their behavior 
-0001e2d0: 6465 7065 6e64 2077 6865 7468 6572 2060  depend whether `
-0001e2e0: 6069 6e74 6572 7031 6460 6020 6f72 0a20  `interp1d`` or. 
-0001e2f0: 2020 2020 2020 2020 2020 2060 6069 6e74             ``int
-0001e300: 6572 706e 6060 2069 7320 7573 6564 2e0a  erpn`` is used..
-0001e310: 2020 2020 2020 2020 6d65 7468 6f64 5f6e          method_n
-0001e320: 6f6e 5f6e 756d 6572 6963 203a 207b 226e  on_numeric : {"n
-0001e330: 6561 7265 7374 222c 2022 7061 6422 2c20  earest", "pad", 
-0001e340: 2266 6669 6c6c 222c 2022 6261 636b 6669  "ffill", "backfi
-0001e350: 6c6c 222c 2022 6266 696c 6c22 7d2c 206f  ll", "bfill"}, o
-0001e360: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-0001e370: 2020 2020 4d65 7468 6f64 2066 6f72 206e      Method for n
-0001e380: 6f6e 2d6e 756d 6572 6963 2074 7970 6573  on-numeric types
-0001e390: 2e20 5061 7373 6564 206f 6e20 746f 203a  . Passed on to :
-0001e3a0: 7079 3a6d 6574 683a 6044 6174 6173 6574  py:meth:`Dataset
-0001e3b0: 2e72 6569 6e64 6578 602e 0a20 2020 2020  .reindex`..     
-0001e3c0: 2020 2020 2020 2060 6022 6e65 6172 6573         ``"neares
-0001e3d0: 7422 6060 2069 7320 7573 6564 2062 7920  t"`` is used by 
-0001e3e0: 6465 6661 756c 742e 0a20 2020 2020 2020  default..       
-0001e3f0: 202a 2a63 6f6f 7264 735f 6b77 6172 6773   **coords_kwargs
-0001e400: 203a 207b 6469 6d3a 2063 6f6f 7264 696e   : {dim: coordin
-0001e410: 6174 652c 202e 2e2e 7d2c 206f 7074 696f  ate, ...}, optio
-0001e420: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0001e430: 5468 6520 6b65 7977 6f72 6420 6172 6775  The keyword argu
-0001e440: 6d65 6e74 7320 666f 726d 206f 6620 6060  ments form of ``
-0001e450: 636f 6f72 6473 6060 2e0a 2020 2020 2020  coords``..      
-0001e460: 2020 2020 2020 4f6e 6520 6f66 2063 6f6f        One of coo
-0001e470: 7264 7320 6f72 2063 6f6f 7264 735f 6b77  rds or coords_kw
-0001e480: 6172 6773 206d 7573 7420 6265 2070 726f  args must be pro
-0001e490: 7669 6465 642e 0a0a 2020 2020 2020 2020  vided...        
-0001e4a0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0001e4b0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0001e4c0: 696e 7465 7270 6f6c 6174 6564 203a 2044  interpolated : D
-0001e4d0: 6174 6173 6574 0a20 2020 2020 2020 2020  ataset.         
-0001e4e0: 2020 204e 6577 2064 6174 6173 6574 206f     New dataset o
-0001e4f0: 6e20 7468 6520 6e65 7720 636f 6f72 6469  n the new coordi
-0001e500: 6e61 7465 732e 0a0a 2020 2020 2020 2020  nates...        
-0001e510: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
-0001e520: 2d2d 2d0a 2020 2020 2020 2020 7363 6970  ---.        scip
-0001e530: 7920 6973 2072 6571 7569 7265 642e 0a0a  y is required...
-0001e540: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
-0001e550: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0001e560: 2d0a 2020 2020 2020 2020 7363 6970 792e  -.        scipy.
-0001e570: 696e 7465 7270 6f6c 6174 652e 696e 7465  interpolate.inte
-0001e580: 7270 3164 0a20 2020 2020 2020 2073 6369  rp1d.        sci
-0001e590: 7079 2e69 6e74 6572 706f 6c61 7465 2e69  py.interpolate.i
-0001e5a0: 6e74 6572 706e 0a0a 2020 2020 2020 2020  nterpn..        
-0001e5b0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-0001e5c0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-0001e5d0: 2020 3e3e 3e20 6473 203d 2078 722e 4461    >>> ds = xr.Da
-0001e5e0: 7461 7365 7428 0a20 2020 2020 2020 202e  taset(.        .
-0001e5f0: 2e2e 2020 2020 2064 6174 615f 7661 7273  ..     data_vars
-0001e600: 3d7b 0a20 2020 2020 2020 202e 2e2e 2020  ={.        ...  
-0001e610: 2020 2020 2020 2022 6122 3a20 2822 7822         "a": ("x"
-0001e620: 2c20 5b35 2c20 372c 2034 5d29 2c0a 2020  , [5, 7, 4]),.  
-0001e630: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0001e640: 2020 2262 223a 2028 0a20 2020 2020 2020    "b": (.       
-0001e650: 202e 2e2e 2020 2020 2020 2020 2020 2020   ...            
-0001e660: 2028 2278 222c 2022 7922 292c 0a20 2020   ("x", "y"),.   
-0001e670: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-0001e680: 2020 2020 205b 5b31 2c20 342c 2032 2c20       [[1, 4, 2, 
-0001e690: 395d 2c20 5b32 2c20 372c 2036 2c20 6e70  9], [2, 7, 6, np
-0001e6a0: 2e6e 616e 5d2c 205b 362c 206e 702e 6e61  .nan], [6, np.na
-0001e6b0: 6e2c 2035 2c20 385d 5d2c 0a20 2020 2020  n, 5, 8]],.     
-0001e6c0: 2020 202e 2e2e 2020 2020 2020 2020 2029     ...         )
-0001e6d0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-0001e6e0: 2020 7d2c 0a20 2020 2020 2020 202e 2e2e    },.        ...
-0001e6f0: 2020 2020 2063 6f6f 7264 733d 7b22 7822       coords={"x"
-0001e700: 3a20 5b30 2c20 312c 2032 5d2c 2022 7922  : [0, 1, 2], "y"
-0001e710: 3a20 5b31 302c 2031 322c 2031 342c 2031  : [10, 12, 14, 1
-0001e720: 365d 7d2c 0a20 2020 2020 2020 202e 2e2e  6]},.        ...
-0001e730: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-0001e740: 730a 2020 2020 2020 2020 3c78 6172 7261  s.        <xarra
-0001e750: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
-0001e760: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
-0001e770: 2878 3a20 332c 2079 3a20 3429 0a20 2020  (x: 3, y: 4).   
-0001e780: 2020 2020 2043 6f6f 7264 696e 6174 6573       Coordinates
-0001e790: 3a0a 2020 2020 2020 2020 2020 2a20 7820  :.          * x 
-0001e7a0: 2020 2020 2020 2028 7829 2069 6e74 3634         (x) int64
-0001e7b0: 2030 2031 2032 0a20 2020 2020 2020 2020   0 1 2.         
-0001e7c0: 202a 2079 2020 2020 2020 2020 2879 2920   * y        (y) 
-0001e7d0: 696e 7436 3420 3130 2031 3220 3134 2031  int64 10 12 14 1
-0001e7e0: 360a 2020 2020 2020 2020 4461 7461 2076  6.        Data v
-0001e7f0: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
-0001e800: 2020 2020 2020 6120 2020 2020 2020 2028        a        (
-0001e810: 7829 2069 6e74 3634 2035 2037 2034 0a20  x) int64 5 7 4. 
-0001e820: 2020 2020 2020 2020 2020 2062 2020 2020             b    
-0001e830: 2020 2020 2878 2c20 7929 2066 6c6f 6174      (x, y) float
-0001e840: 3634 2031 2e30 2034 2e30 2032 2e30 2039  64 1.0 4.0 2.0 9
-0001e850: 2e30 2032 2e30 2037 2e30 2036 2e30 206e  .0 2.0 7.0 6.0 n
-0001e860: 616e 2036 2e30 206e 616e 2035 2e30 2038  an 6.0 nan 5.0 8
-0001e870: 2e30 0a0a 2020 2020 2020 2020 3144 2069  .0..        1D i
-0001e880: 6e74 6572 706f 6c61 7469 6f6e 2077 6974  nterpolation wit
-0001e890: 6820 7468 6520 6465 6661 756c 7420 6d65  h the default me
-0001e8a0: 7468 6f64 2028 6c69 6e65 6172 293a 0a0a  thod (linear):..
-0001e8b0: 2020 2020 2020 2020 3e3e 3e20 6473 2e69          >>> ds.i
-0001e8c0: 6e74 6572 7028 783d 5b30 2c20 302e 3735  nterp(x=[0, 0.75
-0001e8d0: 2c20 312e 3235 2c20 312e 3735 5d29 0a20  , 1.25, 1.75]). 
-0001e8e0: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
-0001e8f0: 6174 6173 6574 3e0a 2020 2020 2020 2020  ataset>.        
-0001e900: 4469 6d65 6e73 696f 6e73 3a20 2028 783a  Dimensions:  (x:
-0001e910: 2034 2c20 793a 2034 290a 2020 2020 2020   4, y: 4).      
-0001e920: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
-0001e930: 2020 2020 2020 2020 202a 2079 2020 2020           * y    
-0001e940: 2020 2020 2879 2920 696e 7436 3420 3130      (y) int64 10
-0001e950: 2031 3220 3134 2031 360a 2020 2020 2020   12 14 16.      
-0001e960: 2020 2020 2a20 7820 2020 2020 2020 2028      * x        (
-0001e970: 7829 2066 6c6f 6174 3634 2030 2e30 2030  x) float64 0.0 0
-0001e980: 2e37 3520 312e 3235 2031 2e37 350a 2020  .75 1.25 1.75.  
-0001e990: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
-0001e9a0: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
-0001e9b0: 2020 6120 2020 2020 2020 2028 7829 2066    a        (x) f
-0001e9c0: 6c6f 6174 3634 2035 2e30 2036 2e35 2036  loat64 5.0 6.5 6
-0001e9d0: 2e32 3520 342e 3735 0a20 2020 2020 2020  .25 4.75.       
-0001e9e0: 2020 2020 2062 2020 2020 2020 2020 2878       b        (x
-0001e9f0: 2c20 7929 2066 6c6f 6174 3634 2031 2e30  , y) float64 1.0
-0001ea00: 2034 2e30 2032 2e30 206e 616e 2031 2e37   4.0 2.0 nan 1.7
-0001ea10: 3520 362e 3235 202e 2e2e 206e 616e 2035  5 6.25 ... nan 5
-0001ea20: 2e30 206e 616e 2035 2e32 3520 6e61 6e0a  .0 nan 5.25 nan.
-0001ea30: 0a20 2020 2020 2020 2031 4420 696e 7465  .        1D inte
-0001ea40: 7270 6f6c 6174 696f 6e20 7769 7468 2061  rpolation with a
-0001ea50: 2064 6966 6665 7265 6e74 206d 6574 686f   different metho
-0001ea60: 643a 0a0a 2020 2020 2020 2020 3e3e 3e20  d:..        >>> 
-0001ea70: 6473 2e69 6e74 6572 7028 783d 5b30 2c20  ds.interp(x=[0, 
-0001ea80: 302e 3735 2c20 312e 3235 2c20 312e 3735  0.75, 1.25, 1.75
-0001ea90: 5d2c 206d 6574 686f 643d 226e 6561 7265  ], method="neare
-0001eaa0: 7374 2229 0a20 2020 2020 2020 203c 7861  st").        <xa
-0001eab0: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
-0001eac0: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
-0001ead0: 3a20 2028 783a 2034 2c20 793a 2034 290a  :  (x: 4, y: 4).
-0001eae0: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
-0001eaf0: 7465 733a 0a20 2020 2020 2020 2020 202a  tes:.          *
-0001eb00: 2079 2020 2020 2020 2020 2879 2920 696e   y        (y) in
-0001eb10: 7436 3420 3130 2031 3220 3134 2031 360a  t64 10 12 14 16.
-0001eb20: 2020 2020 2020 2020 2020 2a20 7820 2020            * x   
-0001eb30: 2020 2020 2028 7829 2066 6c6f 6174 3634       (x) float64
-0001eb40: 2030 2e30 2030 2e37 3520 312e 3235 2031   0.0 0.75 1.25 1
-0001eb50: 2e37 350a 2020 2020 2020 2020 4461 7461  .75.        Data
-0001eb60: 2076 6172 6961 626c 6573 3a0a 2020 2020   variables:.    
-0001eb70: 2020 2020 2020 2020 6120 2020 2020 2020          a       
-0001eb80: 2028 7829 2066 6c6f 6174 3634 2035 2e30   (x) float64 5.0
-0001eb90: 2037 2e30 2037 2e30 2034 2e30 0a20 2020   7.0 7.0 4.0.   
-0001eba0: 2020 2020 2020 2020 2062 2020 2020 2020           b      
-0001ebb0: 2020 2878 2c20 7929 2066 6c6f 6174 3634    (x, y) float64
-0001ebc0: 2031 2e30 2034 2e30 2032 2e30 2039 2e30   1.0 4.0 2.0 9.0
-0001ebd0: 2032 2e30 2037 2e30 202e 2e2e 2036 2e30   2.0 7.0 ... 6.0
-0001ebe0: 206e 616e 2036 2e30 206e 616e 2035 2e30   nan 6.0 nan 5.0
-0001ebf0: 2038 2e30 0a0a 2020 2020 2020 2020 3144   8.0..        1D
-0001ec00: 2065 7874 7261 706f 6c61 7469 6f6e 3a0a   extrapolation:.
-0001ec10: 0a20 2020 2020 2020 203e 3e3e 2064 732e  .        >>> ds.
-0001ec20: 696e 7465 7270 280a 2020 2020 2020 2020  interp(.        
-0001ec30: 2e2e 2e20 2020 2020 783d 5b31 2c20 312e  ...     x=[1, 1.
-0001ec40: 352c 2032 2e35 2c20 332e 355d 2c0a 2020  5, 2.5, 3.5],.  
-0001ec50: 2020 2020 2020 2e2e 2e20 2020 2020 6d65        ...     me
-0001ec60: 7468 6f64 3d22 6c69 6e65 6172 222c 0a20  thod="linear",. 
-0001ec70: 2020 2020 2020 202e 2e2e 2020 2020 206b         ...     k
-0001ec80: 7761 7267 733d 7b22 6669 6c6c 5f76 616c  wargs={"fill_val
-0001ec90: 7565 223a 2022 6578 7472 6170 6f6c 6174  ue": "extrapolat
-0001eca0: 6522 7d2c 0a20 2020 2020 2020 202e 2e2e  e"},.        ...
-0001ecb0: 2029 0a20 2020 2020 2020 203c 7861 7272   ).        <xarr
-0001ecc0: 6179 2e44 6174 6173 6574 3e0a 2020 2020  ay.Dataset>.    
-0001ecd0: 2020 2020 4469 6d65 6e73 696f 6e73 3a20      Dimensions: 
-0001ece0: 2028 783a 2034 2c20 793a 2034 290a 2020   (x: 4, y: 4).  
-0001ecf0: 2020 2020 2020 436f 6f72 6469 6e61 7465        Coordinate
-0001ed00: 733a 0a20 2020 2020 2020 2020 202a 2079  s:.          * y
-0001ed10: 2020 2020 2020 2020 2879 2920 696e 7436          (y) int6
-0001ed20: 3420 3130 2031 3220 3134 2031 360a 2020  4 10 12 14 16.  
-0001ed30: 2020 2020 2020 2020 2a20 7820 2020 2020          * x     
-0001ed40: 2020 2028 7829 2066 6c6f 6174 3634 2031     (x) float64 1
-0001ed50: 2e30 2031 2e35 2032 2e35 2033 2e35 0a20  .0 1.5 2.5 3.5. 
-0001ed60: 2020 2020 2020 2044 6174 6120 7661 7269         Data vari
-0001ed70: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
-0001ed80: 2020 2061 2020 2020 2020 2020 2878 2920     a        (x) 
-0001ed90: 666c 6f61 7436 3420 372e 3020 352e 3520  float64 7.0 5.5 
-0001eda0: 322e 3520 2d30 2e35 0a20 2020 2020 2020  2.5 -0.5.       
-0001edb0: 2020 2020 2062 2020 2020 2020 2020 2878       b        (x
-0001edc0: 2c20 7929 2066 6c6f 6174 3634 2032 2e30  , y) float64 2.0
-0001edd0: 2037 2e30 2036 2e30 206e 616e 2034 2e30   7.0 6.0 nan 4.0
-0001ede0: 206e 616e 202e 2e2e 2034 2e35 206e 616e   nan ... 4.5 nan
-0001edf0: 2031 322e 3020 6e61 6e20 332e 3520 6e61   12.0 nan 3.5 na
-0001ee00: 6e0a 0a20 2020 2020 2020 2032 4420 696e  n..        2D in
-0001ee10: 7465 7270 6f6c 6174 696f 6e3a 0a0a 2020  terpolation:..  
-0001ee20: 2020 2020 2020 3e3e 3e20 6473 2e69 6e74        >>> ds.int
-0001ee30: 6572 7028 783d 5b30 2c20 302e 3735 2c20  erp(x=[0, 0.75, 
-0001ee40: 312e 3235 2c20 312e 3735 5d2c 2079 3d5b  1.25, 1.75], y=[
-0001ee50: 3131 2c20 3133 2c20 3135 5d2c 206d 6574  11, 13, 15], met
-0001ee60: 686f 643d 226c 696e 6561 7222 290a 2020  hod="linear").  
-0001ee70: 2020 2020 2020 3c78 6172 7261 792e 4461        <xarray.Da
-0001ee80: 7461 7365 743e 0a20 2020 2020 2020 2044  taset>.        D
-0001ee90: 696d 656e 7369 6f6e 733a 2020 2878 3a20  imensions:  (x: 
-0001eea0: 342c 2079 3a20 3329 0a20 2020 2020 2020  4, y: 3).       
-0001eeb0: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
-0001eec0: 2020 2020 2020 2020 2a20 7820 2020 2020          * x     
-0001eed0: 2020 2028 7829 2066 6c6f 6174 3634 2030     (x) float64 0
-0001eee0: 2e30 2030 2e37 3520 312e 3235 2031 2e37  .0 0.75 1.25 1.7
-0001eef0: 350a 2020 2020 2020 2020 2020 2a20 7920  5.          * y 
-0001ef00: 2020 2020 2020 2028 7929 2069 6e74 3634         (y) int64
-0001ef10: 2031 3120 3133 2031 350a 2020 2020 2020   11 13 15.      
-0001ef20: 2020 4461 7461 2076 6172 6961 626c 6573    Data variables
-0001ef30: 3a0a 2020 2020 2020 2020 2020 2020 6120  :.            a 
-0001ef40: 2020 2020 2020 2028 7829 2066 6c6f 6174         (x) float
-0001ef50: 3634 2035 2e30 2036 2e35 2036 2e32 3520  64 5.0 6.5 6.25 
-0001ef60: 342e 3735 0a20 2020 2020 2020 2020 2020  4.75.           
-0001ef70: 2062 2020 2020 2020 2020 2878 2c20 7929   b        (x, y)
-0001ef80: 2066 6c6f 6174 3634 2032 2e35 2033 2e30   float64 2.5 3.0
-0001ef90: 206e 616e 2034 2e30 2035 2e36 3235 206e   nan 4.0 5.625 n
-0001efa0: 616e 206e 616e 206e 616e 206e 616e 206e  an nan nan nan n
-0001efb0: 616e 206e 616e 206e 616e 0a20 2020 2020  an nan nan.     
-0001efc0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-0001efd0: 726f 6d20 7861 7272 6179 2e63 6f72 6520  rom xarray.core 
-0001efe0: 696d 706f 7274 206d 6973 7369 6e67 0a0a  import missing..
-0001eff0: 2020 2020 2020 2020 6966 206b 7761 7267          if kwarg
-0001f000: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
-0001f010: 2020 2020 2020 206b 7761 7267 7320 3d20         kwargs = 
-0001f020: 7b7d 0a0a 2020 2020 2020 2020 636f 6f72  {}..        coor
-0001f030: 6473 203d 2065 6974 6865 725f 6469 6374  ds = either_dict
-0001f040: 5f6f 725f 6b77 6172 6773 2863 6f6f 7264  _or_kwargs(coord
-0001f050: 732c 2063 6f6f 7264 735f 6b77 6172 6773  s, coords_kwargs
-0001f060: 2c20 2269 6e74 6572 7022 290a 2020 2020  , "interp").    
-0001f070: 2020 2020 696e 6465 7865 7273 203d 2064      indexers = d
-0001f080: 6963 7428 7365 6c66 2e5f 7661 6c69 6461  ict(self._valida
-0001f090: 7465 5f69 6e74 6572 705f 696e 6465 7865  te_interp_indexe
-0001f0a0: 7273 2863 6f6f 7264 7329 290a 0a20 2020  rs(coords))..   
-0001f0b0: 2020 2020 2069 6620 636f 6f72 6473 3a0a       if coords:.
-0001f0c0: 2020 2020 2020 2020 2020 2020 2320 5468              # Th
-0001f0d0: 6973 2061 766f 6964 7320 6272 6f61 6463  is avoids broadc
-0001f0e0: 6173 7469 6e67 206f 7665 7220 636f 6f72  asting over coor
-0001f0f0: 6469 6e61 7465 7320 7468 6174 2061 7265  dinates that are
-0001f100: 2062 6f74 6820 696e 0a20 2020 2020 2020   both in.       
-0001f110: 2020 2020 2023 2074 6865 206f 7269 6769       # the origi
-0001f120: 6e61 6c20 6172 7261 7920 414e 4420 696e  nal array AND in
-0001f130: 2074 6865 2069 6e64 6578 696e 6720 6172   the indexing ar
-0001f140: 7261 792e 2049 7420 6573 7365 6e74 6961  ray. It essentia
-0001f150: 6c6c 790a 2020 2020 2020 2020 2020 2020  lly.            
-0001f160: 2320 666f 7263 6573 2069 6e74 6572 706f  # forces interpo
-0001f170: 6c61 7469 6f6e 2061 6c6f 6e67 2074 6865  lation along the
-0001f180: 2073 6861 7265 6420 636f 6f72 6469 6e61   shared coordina
-0001f190: 7465 732e 0a20 2020 2020 2020 2020 2020  tes..           
-0001f1a0: 2073 6469 6d73 203d 2028 0a20 2020 2020   sdims = (.     
-0001f1b0: 2020 2020 2020 2020 2020 2073 6574 2873             set(s
-0001f1c0: 656c 662e 6469 6d73 290a 2020 2020 2020  elf.dims).      
-0001f1d0: 2020 2020 2020 2020 2020 2e69 6e74 6572            .inter
-0001f1e0: 7365 6374 696f 6e28 2a5b 7365 7428 6e78  section(*[set(nx
-0001f1f0: 2e64 696d 7329 2066 6f72 206e 7820 696e  .dims) for nx in
-0001f200: 2069 6e64 6578 6572 732e 7661 6c75 6573   indexers.values
-0001f210: 2829 5d29 0a20 2020 2020 2020 2020 2020  ()]).           
-0001f220: 2020 2020 202e 6469 6666 6572 656e 6365       .difference
-0001f230: 2863 6f6f 7264 732e 6b65 7973 2829 290a  (coords.keys()).
-0001f240: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001f250: 2020 2020 2020 2020 2020 696e 6465 7865            indexe
-0001f260: 7273 2e75 7064 6174 6528 7b64 3a20 7365  rs.update({d: se
-0001f270: 6c66 2e76 6172 6961 626c 6573 5b64 5d20  lf.variables[d] 
-0001f280: 666f 7220 6420 696e 2073 6469 6d73 7d29  for d in sdims})
-0001f290: 0a0a 2020 2020 2020 2020 6f62 6a20 3d20  ..        obj = 
-0001f2a0: 7365 6c66 2069 6620 6173 7375 6d65 5f73  self if assume_s
-0001f2b0: 6f72 7465 6420 656c 7365 2073 656c 662e  orted else self.
-0001f2c0: 736f 7274 6279 285b 6b20 666f 7220 6b20  sortby([k for k 
-0001f2d0: 696e 2063 6f6f 7264 735d 290a 0a20 2020  in coords])..   
-0001f2e0: 2020 2020 2064 6566 206d 6179 6265 5f76       def maybe_v
-0001f2f0: 6172 6961 626c 6528 6f62 6a2c 206b 293a  ariable(obj, k):
-0001f300: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
-0001f310: 6f72 6b61 726f 756e 6420 746f 2067 6574  orkaround to get
-0001f320: 2076 6172 6961 626c 6520 666f 7220 6469   variable for di
-0001f330: 6d65 6e73 696f 6e20 7769 7468 6f75 7420  mension without 
-0001f340: 636f 6f72 6469 6e61 7465 2e0a 2020 2020  coordinate..    
-0001f350: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0001f360: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-0001f370: 7572 6e20 6f62 6a2e 5f76 6172 6961 626c  urn obj._variabl
-0001f380: 6573 5b6b 5d0a 2020 2020 2020 2020 2020  es[k].          
-0001f390: 2020 6578 6365 7074 204b 6579 4572 726f    except KeyErro
-0001f3a0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-0001f3b0: 2020 2072 6574 7572 6e20 6173 5f76 6172     return as_var
-0001f3c0: 6961 626c 6528 286b 2c20 7261 6e67 6528  iable((k, range(
-0001f3d0: 6f62 6a2e 6469 6d73 5b6b 5d29 2929 0a0a  obj.dims[k])))..
-0001f3e0: 2020 2020 2020 2020 6465 6620 5f76 616c          def _val
-0001f3f0: 6964 6174 655f 696e 7465 7270 5f69 6e64  idate_interp_ind
-0001f400: 6578 6572 2878 2c20 6e65 775f 7829 3a0a  exer(x, new_x):.
-0001f410: 2020 2020 2020 2020 2020 2020 2320 496e              # In
-0001f420: 2074 6865 2063 6173 6520 6f66 2064 6174   the case of dat
-0001f430: 6574 696d 6573 2c20 7468 6520 7265 7374  etimes, the rest
-0001f440: 7269 6374 696f 6e73 2070 6c61 6365 6420  rictions placed 
-0001f450: 6f6e 2069 6e64 6578 6572 730a 2020 2020  on indexers.    
-0001f460: 2020 2020 2020 2020 2320 7573 6564 2077          # used w
-0001f470: 6974 6820 696e 7465 7270 2061 7265 2073  ith interp are s
-0001f480: 7472 6f6e 6765 7220 7468 616e 2074 686f  tronger than tho
-0001f490: 7365 2077 6869 6368 2061 7265 2070 6c61  se which are pla
-0001f4a0: 6365 6420 6f6e 0a20 2020 2020 2020 2020  ced on.         
-0001f4b0: 2020 2023 2069 7365 6c2c 2073 6f20 7765     # isel, so we
-0001f4c0: 206e 6565 6420 616e 2061 6464 6974 696f   need an additio
-0001f4d0: 6e61 6c20 6368 6563 6b20 6166 7465 7220  nal check after 
-0001f4e0: 5f76 616c 6964 6174 655f 696e 6465 7865  _validate_indexe
-0001f4f0: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
-0001f500: 6966 205f 636f 6e74 6169 6e73 5f64 6174  if _contains_dat
-0001f510: 6574 696d 655f 6c69 6b65 5f6f 626a 6563  etime_like_objec
-0001f520: 7473 280a 2020 2020 2020 2020 2020 2020  ts(.            
-0001f530: 2020 2020 780a 2020 2020 2020 2020 2020      x.          
-0001f540: 2020 2920 616e 6420 6e6f 7420 5f63 6f6e    ) and not _con
-0001f550: 7461 696e 735f 6461 7465 7469 6d65 5f6c  tains_datetime_l
-0001f560: 696b 655f 6f62 6a65 6374 7328 6e65 775f  ike_objects(new_
-0001f570: 7829 3a0a 2020 2020 2020 2020 2020 2020  x):.            
-0001f580: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-0001f590: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-0001f5a0: 2020 2020 2020 2020 2022 5768 656e 2069           "When i
-0001f5b0: 6e74 6572 706f 6c61 7469 6e67 206f 7665  nterpolating ove
-0001f5c0: 7220 6120 6461 7465 7469 6d65 2d6c 696b  r a datetime-lik
-0001f5d0: 6520 220a 2020 2020 2020 2020 2020 2020  e ".            
-0001f5e0: 2020 2020 2020 2020 2263 6f6f 7264 696e          "coordin
-0001f5f0: 6174 652c 2074 6865 2063 6f6f 7264 696e  ate, the coordin
-0001f600: 6174 6573 2074 6f20 220a 2020 2020 2020  ates to ".      
-0001f610: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-0001f620: 6e74 6572 706f 6c61 7465 2074 6f20 6d75  nterpolate to mu
-0001f630: 7374 2062 6520 6569 7468 6572 2064 6174  st be either dat
-0001f640: 6574 696d 6520 220a 2020 2020 2020 2020  etime ".        
-0001f650: 2020 2020 2020 2020 2020 2020 2273 7472              "str
-0001f660: 696e 6773 206f 7220 6461 7465 7469 6d65  ings or datetime
-0001f670: 732e 2022 0a20 2020 2020 2020 2020 2020  s. ".           
-0001f680: 2020 2020 2020 2020 2022 496e 7374 6561           "Instea
-0001f690: 6420 676f 745c 6e7b 7d22 2e66 6f72 6d61  d got\n{}".forma
-0001f6a0: 7428 6e65 775f 7829 0a20 2020 2020 2020  t(new_x).       
-0001f6b0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0001f6c0: 2020 2020 2020 2072 6574 7572 6e20 782c         return x,
-0001f6d0: 206e 6577 5f78 0a0a 2020 2020 2020 2020   new_x..        
-0001f6e0: 7661 6c69 6461 7465 645f 696e 6465 7865  validated_indexe
-0001f6f0: 7273 203d 207b 0a20 2020 2020 2020 2020  rs = {.         
-0001f700: 2020 206b 3a20 5f76 616c 6964 6174 655f     k: _validate_
-0001f710: 696e 7465 7270 5f69 6e64 6578 6572 286d  interp_indexer(m
-0001f720: 6179 6265 5f76 6172 6961 626c 6528 6f62  aybe_variable(ob
-0001f730: 6a2c 206b 292c 2076 290a 2020 2020 2020  j, k), v).      
-0001f740: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
-0001f750: 6e20 696e 6465 7865 7273 2e69 7465 6d73  n indexers.items
-0001f760: 2829 0a20 2020 2020 2020 207d 0a0a 2020  ().        }..  
-0001f770: 2020 2020 2020 2320 6f70 7469 6d69 7a61        # optimiza
-0001f780: 7469 6f6e 3a20 7375 6273 6574 2074 6f20  tion: subset to 
-0001f790: 636f 6f72 6469 6e61 7465 2072 616e 6765  coordinate range
-0001f7a0: 206f 6620 7468 6520 7461 7267 6574 2069   of the target i
-0001f7b0: 6e64 6578 0a20 2020 2020 2020 2069 6620  ndex.        if 
-0001f7c0: 6d65 7468 6f64 2069 6e20 5b22 6c69 6e65  method in ["line
-0001f7d0: 6172 222c 2022 6e65 6172 6573 7422 5d3a  ar", "nearest"]:
-0001f7e0: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
-0001f7f0: 206b 2c20 7620 696e 2076 616c 6964 6174   k, v in validat
-0001f800: 6564 5f69 6e64 6578 6572 732e 6974 656d  ed_indexers.item
-0001f810: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-0001f820: 2020 2020 206f 626a 2c20 6e65 7769 6478       obj, newidx
-0001f830: 203d 206d 6973 7369 6e67 2e5f 6c6f 6361   = missing._loca
-0001f840: 6c69 7a65 286f 626a 2c20 7b6b 3a20 767d  lize(obj, {k: v}
-0001f850: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001f860: 2020 7661 6c69 6461 7465 645f 696e 6465    validated_inde
-0001f870: 7865 7273 5b6b 5d20 3d20 6e65 7769 6478  xers[k] = newidx
-0001f880: 5b6b 5d0a 0a20 2020 2020 2020 2023 206f  [k]..        # o
-0001f890: 7074 696d 697a 6174 696f 6e3a 2063 7265  ptimization: cre
-0001f8a0: 6174 6520 6461 736b 2063 6f6f 7264 696e  ate dask coordin
-0001f8b0: 6174 6520 6172 7261 7973 206f 6e63 6520  ate arrays once 
-0001f8c0: 7065 7220 4461 7461 7365 740a 2020 2020  per Dataset.    
-0001f8d0: 2020 2020 2320 7261 7468 6572 2074 6861      # rather tha
-0001f8e0: 6e20 6f6e 6365 2070 6572 2056 6172 6961  n once per Varia
-0001f8f0: 626c 6520 7768 656e 2064 6173 6b2e 6172  ble when dask.ar
-0001f900: 7261 792e 756e 6966 795f 6368 756e 6b73  ray.unify_chunks
-0001f910: 2069 7320 6361 6c6c 6564 206c 6174 6572   is called later
-0001f920: 0a20 2020 2020 2020 2023 2047 4834 3733  .        # GH473
-0001f930: 390a 2020 2020 2020 2020 6966 206f 626a  9.        if obj
-0001f940: 2e5f 5f64 6173 6b5f 6772 6170 685f 5f28  .__dask_graph__(
-0001f950: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-0001f960: 6173 6b5f 696e 6465 7865 7273 203d 207b  ask_indexers = {
-0001f970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f980: 206b 3a20 2869 6e64 6578 2e74 6f5f 6261   k: (index.to_ba
-0001f990: 7365 5f76 6172 6961 626c 6528 292e 6368  se_variable().ch
-0001f9a0: 756e 6b28 292c 2064 6573 742e 746f 5f62  unk(), dest.to_b
-0001f9b0: 6173 655f 7661 7269 6162 6c65 2829 2e63  ase_variable().c
-0001f9c0: 6875 6e6b 2829 290a 2020 2020 2020 2020  hunk()).        
-0001f9d0: 2020 2020 2020 2020 666f 7220 6b2c 2028          for k, (
-0001f9e0: 696e 6465 782c 2064 6573 7429 2069 6e20  index, dest) in 
-0001f9f0: 7661 6c69 6461 7465 645f 696e 6465 7865  validated_indexe
-0001fa00: 7273 2e69 7465 6d73 2829 0a20 2020 2020  rs.items().     
-0001fa10: 2020 2020 2020 207d 0a0a 2020 2020 2020         }..      
-0001fa20: 2020 7661 7269 6162 6c65 733a 2064 6963    variables: dic
-0001fa30: 745b 4861 7368 6162 6c65 2c20 5661 7269  t[Hashable, Vari
-0001fa40: 6162 6c65 5d20 3d20 7b7d 0a20 2020 2020  able] = {}.     
-0001fa50: 2020 2072 6569 6e64 6578 3a20 626f 6f6c     reindex: bool
-0001fa60: 203d 2046 616c 7365 0a20 2020 2020 2020   = False.       
-0001fa70: 2066 6f72 206e 616d 652c 2076 6172 2069   for name, var i
-0001fa80: 6e20 6f62 6a2e 5f76 6172 6961 626c 6573  n obj._variables
-0001fa90: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-0001faa0: 2020 2020 2020 6966 206e 616d 6520 696e        if name in
-0001fab0: 2069 6e64 6578 6572 733a 0a20 2020 2020   indexers:.     
-0001fac0: 2020 2020 2020 2020 2020 2063 6f6e 7469             conti
-0001fad0: 6e75 650a 0a20 2020 2020 2020 2020 2020  nue..           
-0001fae0: 2069 6620 6973 5f64 7563 6b5f 6461 736b   if is_duck_dask
-0001faf0: 5f61 7272 6179 2876 6172 2e64 6174 6129  _array(var.data)
-0001fb00: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001fb10: 2020 7573 655f 696e 6465 7865 7273 203d    use_indexers =
-0001fb20: 2064 6173 6b5f 696e 6465 7865 7273 0a20   dask_indexers. 
-0001fb30: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0001fb40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fb50: 2075 7365 5f69 6e64 6578 6572 7320 3d20   use_indexers = 
-0001fb60: 7661 6c69 6461 7465 645f 696e 6465 7865  validated_indexe
-0001fb70: 7273 0a0a 2020 2020 2020 2020 2020 2020  rs..            
-0001fb80: 6474 7970 655f 6b69 6e64 203d 2076 6172  dtype_kind = var
-0001fb90: 2e64 7479 7065 2e6b 696e 640a 2020 2020  .dtype.kind.    
-0001fba0: 2020 2020 2020 2020 6966 2064 7479 7065          if dtype
-0001fbb0: 5f6b 696e 6420 696e 2022 7569 6663 223a  _kind in "uifc":
-0001fbc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fbd0: 2023 2046 6f72 206e 6f72 6d61 6c20 6e75   # For normal nu
-0001fbe0: 6d62 6572 2074 7970 6573 2064 6f20 7468  mber types do th
-0001fbf0: 6520 696e 7465 7270 6f6c 6174 696f 6e3a  e interpolation:
-0001fc00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001fc10: 2076 6172 5f69 6e64 6578 6572 7320 3d20   var_indexers = 
-0001fc20: 7b6b 3a20 7620 666f 7220 6b2c 2076 2069  {k: v for k, v i
-0001fc30: 6e20 7573 655f 696e 6465 7865 7273 2e69  n use_indexers.i
-0001fc40: 7465 6d73 2829 2069 6620 6b20 696e 2076  tems() if k in v
-0001fc50: 6172 2e64 696d 737d 0a20 2020 2020 2020  ar.dims}.       
-0001fc60: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
-0001fc70: 6573 5b6e 616d 655d 203d 206d 6973 7369  es[name] = missi
-0001fc80: 6e67 2e69 6e74 6572 7028 7661 722c 2076  ng.interp(var, v
-0001fc90: 6172 5f69 6e64 6578 6572 732c 206d 6574  ar_indexers, met
-0001fca0: 686f 642c 202a 2a6b 7761 7267 7329 0a20  hod, **kwargs). 
-0001fcb0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
-0001fcc0: 6474 7970 655f 6b69 6e64 2069 6e20 224f  dtype_kind in "O
-0001fcd0: 6255 2220 616e 6420 2875 7365 5f69 6e64  bU" and (use_ind
-0001fce0: 6578 6572 732e 6b65 7973 2829 2026 2076  exers.keys() & v
-0001fcf0: 6172 2e64 696d 7329 3a0a 2020 2020 2020  ar.dims):.      
-0001fd00: 2020 2020 2020 2020 2020 2320 466f 7220            # For 
-0001fd10: 7479 7065 7320 7468 6174 2077 6520 646f  types that we do
-0001fd20: 206e 6f74 2075 6e64 6572 7374 616e 6420   not understand 
-0001fd30: 646f 2073 7465 7077 6973 650a 2020 2020  do stepwise.    
-0001fd40: 2020 2020 2020 2020 2020 2020 2320 696e              # in
-0001fd50: 7465 7270 6f6c 6174 696f 6e20 746f 2061  terpolation to a
-0001fd60: 766f 6964 206d 6f64 6966 7969 6e67 2074  void modifying t
-0001fd70: 6865 2065 6c65 6d65 6e74 732e 0a20 2020  he elements..   
-0001fd80: 2020 2020 2020 2020 2020 2020 2023 2072               # r
-0001fd90: 6569 6e64 6578 2074 6865 2076 6172 6961  eindex the varia
-0001fda0: 626c 6520 696e 7374 6561 6420 6265 6361  ble instead beca
-0001fdb0: 7573 6520 6974 2073 7570 706f 7274 730a  use it supports.
-0001fdc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001fdd0: 2320 626f 6f6c 6561 6e73 2061 6e64 206f  # booleans and o
-0001fde0: 626a 6563 7473 2061 6e64 2072 6574 6169  bjects and retai
-0001fdf0: 6e73 2074 6865 2064 7479 7065 2062 7574  ns the dtype but
-0001fe00: 2069 6e73 6964 650a 2020 2020 2020 2020   inside.        
-0001fe10: 2020 2020 2020 2020 2320 7468 6973 206c          # this l
-0001fe20: 6f6f 7020 7468 6572 6520 6d69 6768 7420  oop there might 
-0001fe30: 6265 2073 6f6d 6520 6475 706c 6963 6174  be some duplicat
-0001fe40: 6520 636f 6465 2074 6861 7420 736c 6f77  e code that slow
-0001fe50: 7320 6974 0a20 2020 2020 2020 2020 2020  s it.           
-0001fe60: 2020 2020 2023 2064 6f77 6e2c 2074 6865       # down, the
-0001fe70: 7265 666f 7265 2063 6f6c 6c65 6374 2074  refore collect t
-0001fe80: 6865 7365 2073 6967 6e61 6c73 2061 6e64  hese signals and
-0001fe90: 2072 756e 2069 7420 6c61 7465 723a 0a20   run it later:. 
-0001fea0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001feb0: 6569 6e64 6578 203d 2054 7275 650a 2020  eindex = True.  
-0001fec0: 2020 2020 2020 2020 2020 656c 6966 2061            elif a
-0001fed0: 6c6c 2864 206e 6f74 2069 6e20 696e 6465  ll(d not in inde
-0001fee0: 7865 7273 2066 6f72 2064 2069 6e20 7661  xers for d in va
-0001fef0: 722e 6469 6d73 293a 0a20 2020 2020 2020  r.dims):.       
-0001ff00: 2020 2020 2020 2020 2023 2046 6f72 2061           # For a
-0001ff10: 6e79 7468 696e 6720 656c 7365 2077 6520  nything else we 
-0001ff20: 6361 6e20 6f6e 6c79 206b 6565 7020 7661  can only keep va
-0001ff30: 7269 6162 6c65 7320 6966 2074 6865 790a  riables if they.
-0001ff40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ff50: 2320 6172 6520 6e6f 7420 6465 7065 6e64  # are not depend
-0001ff60: 656e 7420 6f6e 2061 6e79 2063 6f6f 7264  ent on any coord
-0001ff70: 7320 7468 6174 2061 7265 2062 6569 6e67  s that are being
-0001ff80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001ff90: 2023 2069 6e74 6572 706f 6c61 7465 6420   # interpolated 
-0001ffa0: 616c 6f6e 673a 0a20 2020 2020 2020 2020  along:.         
-0001ffb0: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-0001ffc0: 5b6e 616d 655d 203d 2076 6172 0a0a 2020  [name] = var..  
-0001ffd0: 2020 2020 2020 6966 2072 6569 6e64 6578        if reindex
-0001ffe0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0001fff0: 696e 6465 785f 696e 6465 7865 7273 203d  index_indexers =
-00020000: 207b 0a20 2020 2020 2020 2020 2020 2020   {.             
-00020010: 2020 206b 3a20 7620 666f 7220 6b2c 2028     k: v for k, (
-00020020: 5f2c 2076 2920 696e 2076 616c 6964 6174  _, v) in validat
-00020030: 6564 5f69 6e64 6578 6572 732e 6974 656d  ed_indexers.item
-00020040: 7328 2920 6966 2076 2e64 696d 7320 3d3d  s() if v.dims ==
-00020050: 2028 6b2c 290a 2020 2020 2020 2020 2020   (k,).          
-00020060: 2020 7d0a 2020 2020 2020 2020 2020 2020    }.            
-00020070: 7265 696e 6465 7865 6420 3d20 616c 6967  reindexed = alig
-00020080: 6e6d 656e 742e 7265 696e 6465 7828 0a20  nment.reindex(. 
-00020090: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-000200a0: 626a 2c0a 2020 2020 2020 2020 2020 2020  bj,.            
-000200b0: 2020 2020 696e 6465 7865 7273 3d72 6569      indexers=rei
-000200c0: 6e64 6578 5f69 6e64 6578 6572 732c 0a20  ndex_indexers,. 
-000200d0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000200e0: 6574 686f 643d 6d65 7468 6f64 5f6e 6f6e  ethod=method_non
-000200f0: 5f6e 756d 6572 6963 2c0a 2020 2020 2020  _numeric,.      
-00020100: 2020 2020 2020 2020 2020 6578 636c 7564            exclud
-00020110: 655f 7661 7273 3d76 6172 6961 626c 6573  e_vars=variables
-00020120: 2e6b 6579 7328 292c 0a20 2020 2020 2020  .keys(),.       
-00020130: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00020140: 2020 2069 6e64 6578 6573 203d 2064 6963     indexes = dic
-00020150: 7428 7265 696e 6465 7865 642e 5f69 6e64  t(reindexed._ind
-00020160: 6578 6573 290a 2020 2020 2020 2020 2020  exes).          
-00020170: 2020 7661 7269 6162 6c65 732e 7570 6461    variables.upda
-00020180: 7465 2872 6569 6e64 6578 6564 2e76 6172  te(reindexed.var
-00020190: 6961 626c 6573 290a 2020 2020 2020 2020  iables).        
-000201a0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000201b0: 2020 2320 4765 7420 7468 6520 696e 6465    # Get the inde
-000201c0: 7865 7320 7468 6174 2061 7265 206e 6f74  xes that are not
-000201d0: 2062 6569 6e67 2069 6e74 6572 706f 6c61   being interpola
-000201e0: 7465 6420 616c 6f6e 670a 2020 2020 2020  ted along.      
-000201f0: 2020 2020 2020 696e 6465 7865 7320 3d20        indexes = 
-00020200: 7b6b 3a20 7620 666f 7220 6b2c 2076 2069  {k: v for k, v i
-00020210: 6e20 6f62 6a2e 5f69 6e64 6578 6573 2e69  n obj._indexes.i
-00020220: 7465 6d73 2829 2069 6620 6b20 6e6f 7420  tems() if k not 
-00020230: 696e 2069 6e64 6578 6572 737d 0a0a 2020  in indexers}..  
-00020240: 2020 2020 2020 2320 4765 7420 7468 6520        # Get the 
-00020250: 636f 6f72 6473 2074 6861 7420 616c 736f  coords that also
-00020260: 2065 7869 7374 2069 6e20 7468 6520 7661   exist in the va
-00020270: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
-00020280: 2063 6f6f 7264 5f6e 616d 6573 203d 206f   coord_names = o
-00020290: 626a 2e5f 636f 6f72 645f 6e61 6d65 7320  bj._coord_names 
-000202a0: 2620 7661 7269 6162 6c65 732e 6b65 7973  & variables.keys
-000202b0: 2829 0a20 2020 2020 2020 2073 656c 6563  ().        selec
-000202c0: 7465 6420 3d20 7365 6c66 2e5f 7265 706c  ted = self._repl
-000202d0: 6163 655f 7769 7468 5f6e 6577 5f64 696d  ace_with_new_dim
-000202e0: 7328 0a20 2020 2020 2020 2020 2020 2076  s(.            v
-000202f0: 6172 6961 626c 6573 2e63 6f70 7928 292c  ariables.copy(),
-00020300: 2063 6f6f 7264 5f6e 616d 6573 2c20 696e   coord_names, in
-00020310: 6465 7865 733d 696e 6465 7865 730a 2020  dexes=indexes.  
-00020320: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00020330: 2023 2041 7474 6163 6820 696e 6465 7865   # Attach indexe
-00020340: 7220 6173 2063 6f6f 7264 696e 6174 650a  r as coordinate.
-00020350: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
-00020360: 2069 6e20 696e 6465 7865 7273 2e69 7465   in indexers.ite
-00020370: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
-00020380: 2020 6173 7365 7274 2069 7369 6e73 7461    assert isinsta
-00020390: 6e63 6528 762c 2056 6172 6961 626c 6529  nce(v, Variable)
-000203a0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000203b0: 762e 6469 6d73 203d 3d20 286b 2c29 3a0a  v.dims == (k,):.
-000203c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000203d0: 696e 6465 7820 3d20 5061 6e64 6173 496e  index = PandasIn
-000203e0: 6465 7828 762c 206b 2c20 636f 6f72 645f  dex(v, k, coord_
-000203f0: 6474 7970 653d 762e 6474 7970 6529 0a20  dtype=v.dtype). 
-00020400: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00020410: 6e64 6578 5f76 6172 7320 3d20 696e 6465  ndex_vars = inde
-00020420: 782e 6372 6561 7465 5f76 6172 6961 626c  x.create_variabl
-00020430: 6573 287b 6b3a 2076 7d29 0a20 2020 2020  es({k: v}).     
-00020440: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-00020450: 6573 5b6b 5d20 3d20 696e 6465 780a 2020  es[k] = index.  
-00020460: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00020470: 7269 6162 6c65 732e 7570 6461 7465 2869  riables.update(i
-00020480: 6e64 6578 5f76 6172 7329 0a20 2020 2020  ndex_vars).     
-00020490: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-000204a0: 2020 2020 2020 2020 2020 2020 2076 6172               var
-000204b0: 6961 626c 6573 5b6b 5d20 3d20 760a 0a20  iables[k] = v.. 
-000204c0: 2020 2020 2020 2023 2045 7874 7261 6374         # Extract
-000204d0: 2063 6f6f 7264 696e 6174 6573 2066 726f   coordinates fro
-000204e0: 6d20 696e 6465 7865 7273 0a20 2020 2020  m indexers.     
-000204f0: 2020 2063 6f6f 7264 5f76 6172 732c 206e     coord_vars, n
-00020500: 6577 5f69 6e64 6578 6573 203d 2073 656c  ew_indexes = sel
-00020510: 6563 7465 642e 5f67 6574 5f69 6e64 6578  ected._get_index
-00020520: 6572 735f 636f 6f72 6473 5f61 6e64 5f69  ers_coords_and_i
-00020530: 6e64 6578 6573 2863 6f6f 7264 7329 0a20  ndexes(coords). 
-00020540: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-00020550: 2e75 7064 6174 6528 636f 6f72 645f 7661  .update(coord_va
-00020560: 7273 290a 2020 2020 2020 2020 696e 6465  rs).        inde
-00020570: 7865 732e 7570 6461 7465 286e 6577 5f69  xes.update(new_i
-00020580: 6e64 6578 6573 290a 0a20 2020 2020 2020  ndexes)..       
-00020590: 2063 6f6f 7264 5f6e 616d 6573 203d 206f   coord_names = o
-000205a0: 626a 2e5f 636f 6f72 645f 6e61 6d65 7320  bj._coord_names 
-000205b0: 2620 7661 7269 6162 6c65 732e 6b65 7973  & variables.keys
-000205c0: 2829 207c 2063 6f6f 7264 5f76 6172 732e  () | coord_vars.
-000205d0: 6b65 7973 2829 0a20 2020 2020 2020 2072  keys().        r
-000205e0: 6574 7572 6e20 7365 6c66 2e5f 7265 706c  eturn self._repl
-000205f0: 6163 655f 7769 7468 5f6e 6577 5f64 696d  ace_with_new_dim
-00020600: 7328 7661 7269 6162 6c65 732c 2063 6f6f  s(variables, coo
-00020610: 7264 5f6e 616d 6573 2c20 696e 6465 7865  rd_names, indexe
-00020620: 733d 696e 6465 7865 7329 0a0a 2020 2020  s=indexes)..    
-00020630: 6465 6620 696e 7465 7270 5f6c 696b 6528  def interp_like(
-00020640: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00020650: 2020 2020 2020 206f 7468 6572 3a20 4461         other: Da
-00020660: 7461 7365 7420 7c20 4461 7461 4172 7261  taset | DataArra
-00020670: 792c 0a20 2020 2020 2020 206d 6574 686f  y,.        metho
-00020680: 643a 2049 6e74 6572 704f 7074 696f 6e73  d: InterpOptions
-00020690: 203d 2022 6c69 6e65 6172 222c 0a20 2020   = "linear",.   
-000206a0: 2020 2020 2061 7373 756d 655f 736f 7274       assume_sort
-000206b0: 6564 3a20 626f 6f6c 203d 2046 616c 7365  ed: bool = False
-000206c0: 2c0a 2020 2020 2020 2020 6b77 6172 6773  ,.        kwargs
-000206d0: 3a20 4d61 7070 696e 675b 7374 722c 2041  : Mapping[str, A
-000206e0: 6e79 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ny] | None = Non
-000206f0: 652c 0a20 2020 2020 2020 206d 6574 686f  e,.        metho
-00020700: 645f 6e6f 6e5f 6e75 6d65 7269 633a 2073  d_non_numeric: s
-00020710: 7472 203d 2022 6e65 6172 6573 7422 2c0a  tr = "nearest",.
-00020720: 2020 2020 2920 2d3e 2044 6174 6173 6574      ) -> Dataset
-00020730: 3a0a 2020 2020 2020 2020 2222 2249 6e74  :.        """Int
-00020740: 6572 706f 6c61 7465 2074 6869 7320 6f62  erpolate this ob
-00020750: 6a65 6374 206f 6e74 6f20 7468 6520 636f  ject onto the co
-00020760: 6f72 6469 6e61 7465 7320 6f66 2061 6e6f  ordinates of ano
-00020770: 7468 6572 206f 626a 6563 742c 0a20 2020  ther object,.   
-00020780: 2020 2020 2066 696c 6c69 6e67 2074 6865       filling the
-00020790: 206f 7574 206f 6620 7261 6e67 6520 7661   out of range va
-000207a0: 6c75 6573 2077 6974 6820 4e61 4e2e 0a0a  lues with NaN...
-000207b0: 2020 2020 2020 2020 4966 2069 6e74 6572          If inter
-000207c0: 706f 6c61 7469 6e67 2061 6c6f 6e67 2061  polating along a
-000207d0: 2073 696e 676c 6520 6578 6973 7469 6e67   single existing
-000207e0: 2064 696d 656e 7369 6f6e 2c0a 2020 2020   dimension,.    
-000207f0: 2020 2020 3a70 793a 636c 6173 733a 6073      :py:class:`s
-00020800: 6369 7079 2e69 6e74 6572 706f 6c61 7465  cipy.interpolate
-00020810: 2e69 6e74 6572 7031 6460 2069 7320 6361  .interp1d` is ca
-00020820: 6c6c 6564 2e20 5768 656e 2069 6e74 6572  lled. When inter
-00020830: 706f 6c61 7469 6e67 0a20 2020 2020 2020  polating.       
-00020840: 2061 6c6f 6e67 206d 756c 7469 706c 6520   along multiple 
-00020850: 6578 6973 7469 6e67 2064 696d 656e 7369  existing dimensi
-00020860: 6f6e 732c 2061 6e20 6174 7465 6d70 7420  ons, an attempt 
-00020870: 6973 206d 6164 6520 746f 2064 6563 6f6d  is made to decom
-00020880: 706f 7365 2074 6865 0a20 2020 2020 2020  pose the.       
-00020890: 2069 6e74 6572 706f 6c61 7469 6f6e 2069   interpolation i
-000208a0: 6e74 6f20 6d75 6c74 6970 6c65 2031 2d64  nto multiple 1-d
-000208b0: 696d 656e 7369 6f6e 616c 2069 6e74 6572  imensional inter
-000208c0: 706f 6c61 7469 6f6e 732e 2049 6620 7468  polations. If th
-000208d0: 6973 2069 730a 2020 2020 2020 2020 706f  is is.        po
-000208e0: 7373 6962 6c65 2c20 3a70 793a 636c 6173  ssible, :py:clas
-000208f0: 733a 6073 6369 7079 2e69 6e74 6572 706f  s:`scipy.interpo
-00020900: 6c61 7465 2e69 6e74 6572 7031 6460 2069  late.interp1d` i
-00020910: 7320 6361 6c6c 6564 2e20 4f74 6865 7277  s called. Otherw
-00020920: 6973 652c 0a20 2020 2020 2020 203a 7079  ise,.        :py
-00020930: 3a66 756e 633a 6073 6369 7079 2e69 6e74  :func:`scipy.int
-00020940: 6572 706f 6c61 7465 2e69 6e74 6572 706e  erpolate.interpn
-00020950: 6020 6973 2063 616c 6c65 642e 0a0a 2020  ` is called...  
-00020960: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00020970: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00020980: 2d2d 2d0a 2020 2020 2020 2020 6f74 6865  ---.        othe
-00020990: 7220 3a20 4461 7461 7365 7420 6f72 2044  r : Dataset or D
-000209a0: 6174 6141 7272 6179 0a20 2020 2020 2020  ataArray.       
-000209b0: 2020 2020 204f 626a 6563 7420 7769 7468       Object with
-000209c0: 2061 6e20 2769 6e64 6578 6573 2720 6174   an 'indexes' at
-000209d0: 7472 6962 7574 6520 6769 7669 6e67 2061  tribute giving a
-000209e0: 206d 6170 7069 6e67 2066 726f 6d20 6469   mapping from di
-000209f0: 6d65 6e73 696f 6e0a 2020 2020 2020 2020  mension.        
-00020a00: 2020 2020 6e61 6d65 7320 746f 2061 6e20      names to an 
-00020a10: 3164 2061 7272 6179 2d6c 696b 652c 2077  1d array-like, w
-00020a20: 6869 6368 2070 726f 7669 6465 7320 636f  hich provides co
-00020a30: 6f72 6469 6e61 7465 7320 7570 6f6e 0a20  ordinates upon. 
-00020a40: 2020 2020 2020 2020 2020 2077 6869 6368             which
-00020a50: 2074 6f20 696e 6465 7820 7468 6520 7661   to index the va
-00020a60: 7269 6162 6c65 7320 696e 2074 6869 7320  riables in this 
-00020a70: 6461 7461 7365 742e 204d 6973 7369 6e67  dataset. Missing
-00020a80: 2076 616c 7565 7320 6172 6520 736b 6970   values are skip
-00020a90: 7065 642e 0a20 2020 2020 2020 206d 6574  ped..        met
-00020aa0: 686f 6420 3a20 7b22 6c69 6e65 6172 222c  hod : {"linear",
-00020ab0: 2022 6e65 6172 6573 7422 2c20 227a 6572   "nearest", "zer
-00020ac0: 6f22 2c20 2273 6c69 6e65 6172 222c 2022  o", "slinear", "
-00020ad0: 7175 6164 7261 7469 6322 2c20 2263 7562  quadratic", "cub
-00020ae0: 6963 222c 2022 706f 6c79 6e6f 6d69 616c  ic", "polynomial
-00020af0: 222c 205c 0a20 2020 2020 2020 2020 2020  ", \.           
-00020b00: 2022 6261 7279 6365 6e74 7269 6322 2c20   "barycentric", 
-00020b10: 226b 726f 6722 2c20 2270 6368 6970 222c  "krog", "pchip",
-00020b20: 2022 7370 6c69 6e65 222c 2022 616b 696d   "spline", "akim
-00020b30: 6122 7d2c 2064 6566 6175 6c74 3a20 226c  a"}, default: "l
-00020b40: 696e 6561 7222 0a20 2020 2020 2020 2020  inear".         
-00020b50: 2020 2053 7472 696e 6720 696e 6469 6361     String indica
-00020b60: 7469 6e67 2077 6869 6368 206d 6574 686f  ting which metho
-00020b70: 6420 746f 2075 7365 2066 6f72 2069 6e74  d to use for int
-00020b80: 6572 706f 6c61 7469 6f6e 3a0a 0a20 2020  erpolation:..   
-00020b90: 2020 2020 2020 2020 202d 2027 6c69 6e65           - 'line
-00020ba0: 6172 273a 206c 696e 6561 7220 696e 7465  ar': linear inte
-00020bb0: 7270 6f6c 6174 696f 6e2e 2041 6464 6974  rpolation. Addit
-00020bc0: 696f 6e61 6c20 6b65 7977 6f72 640a 2020  ional keyword.  
-00020bd0: 2020 2020 2020 2020 2020 2020 6172 6775              argu
-00020be0: 6d65 6e74 7320 6172 6520 7061 7373 6564  ments are passed
-00020bf0: 2074 6f20 3a70 793a 6675 6e63 3a60 6e75   to :py:func:`nu
-00020c00: 6d70 792e 696e 7465 7270 600a 2020 2020  mpy.interp`.    
-00020c10: 2020 2020 2020 2020 2d20 276e 6561 7265          - 'neare
-00020c20: 7374 272c 2027 7a65 726f 272c 2027 736c  st', 'zero', 'sl
-00020c30: 696e 6561 7227 2c20 2771 7561 6472 6174  inear', 'quadrat
-00020c40: 6963 272c 2027 6375 6269 6327 2c20 2770  ic', 'cubic', 'p
-00020c50: 6f6c 796e 6f6d 6961 6c27 3a0a 2020 2020  olynomial':.    
-00020c60: 2020 2020 2020 2020 2020 6172 6520 7061            are pa
-00020c70: 7373 6564 2074 6f20 3a70 793a 6675 6e63  ssed to :py:func
-00020c80: 3a60 7363 6970 792e 696e 7465 7270 6f6c  :`scipy.interpol
-00020c90: 6174 652e 696e 7465 7270 3164 602e 2049  ate.interp1d`. I
-00020ca0: 660a 2020 2020 2020 2020 2020 2020 2020  f.              
-00020cb0: 6060 6d65 7468 6f64 3d27 706f 6c79 6e6f  ``method='polyno
-00020cc0: 6d69 616c 2760 602c 2074 6865 2060 606f  mial'``, the ``o
-00020cd0: 7264 6572 6060 206b 6579 776f 7264 2061  rder`` keyword a
-00020ce0: 7267 756d 656e 7420 6d75 7374 2061 6c73  rgument must als
-00020cf0: 6f20 6265 0a20 2020 2020 2020 2020 2020  o be.           
-00020d00: 2020 2070 726f 7669 6465 642e 0a20 2020     provided..   
-00020d10: 2020 2020 2020 2020 202d 2027 6261 7279           - 'bary
-00020d20: 6365 6e74 7269 6327 2c20 276b 726f 6727  centric', 'krog'
-00020d30: 2c20 2770 6368 6970 272c 2027 7370 6c69  , 'pchip', 'spli
-00020d40: 6e65 272c 2027 616b 696d 6127 3a20 7573  ne', 'akima': us
-00020d50: 6520 7468 6569 720a 2020 2020 2020 2020  e their.        
-00020d60: 2020 2020 2020 7265 7370 6563 7469 7665        respective
-00020d70: 203a 7079 3a63 6c61 7373 3a60 7363 6970   :py:class:`scip
-00020d80: 792e 696e 7465 7270 6f6c 6174 6560 2063  y.interpolate` c
-00020d90: 6c61 7373 6573 2e0a 0a20 2020 2020 2020  lasses...       
-00020da0: 2061 7373 756d 655f 736f 7274 6564 203a   assume_sorted :
-00020db0: 2062 6f6f 6c2c 2064 6566 6175 6c74 3a20   bool, default: 
-00020dc0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00020dd0: 2020 4966 2046 616c 7365 2c20 7661 6c75    If False, valu
-00020de0: 6573 206f 6620 636f 6f72 6469 6e61 7465  es of coordinate
-00020df0: 7320 7468 6174 2061 7265 2069 6e74 6572  s that are inter
-00020e00: 706f 6c61 7465 6420 6f76 6572 2063 616e  polated over can
-00020e10: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
-00020e20: 696e 2061 6e79 206f 7264 6572 2061 6e64  in any order and
-00020e30: 2074 6865 7920 6172 6520 736f 7274 6564   they are sorted
-00020e40: 2066 6972 7374 2e20 4966 2054 7275 652c   first. If True,
-00020e50: 2069 6e74 6572 706f 6c61 7465 640a 2020   interpolated.  
-00020e60: 2020 2020 2020 2020 2020 636f 6f72 6469            coordi
-00020e70: 6e61 7465 7320 6172 6520 6173 7375 6d65  nates are assume
-00020e80: 6420 746f 2062 6520 616e 2061 7272 6179  d to be an array
-00020e90: 206f 6620 6d6f 6e6f 746f 6e69 6361 6c6c   of monotonicall
-00020ea0: 7920 696e 6372 6561 7369 6e67 0a20 2020  y increasing.   
-00020eb0: 2020 2020 2020 2020 2076 616c 7565 732e           values.
-00020ec0: 0a20 2020 2020 2020 206b 7761 7267 7320  .        kwargs 
-00020ed0: 3a20 6469 6374 2c20 6f70 7469 6f6e 616c  : dict, optional
-00020ee0: 0a20 2020 2020 2020 2020 2020 2041 6464  .            Add
-00020ef0: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
-00020f00: 7061 7373 6564 2074 6f20 7363 6970 7927  passed to scipy'
-00020f10: 7320 696e 7465 7270 6f6c 6174 6f72 2e0a  s interpolator..
-00020f20: 2020 2020 2020 2020 6d65 7468 6f64 5f6e          method_n
-00020f30: 6f6e 5f6e 756d 6572 6963 203a 207b 226e  on_numeric : {"n
-00020f40: 6561 7265 7374 222c 2022 7061 6422 2c20  earest", "pad", 
-00020f50: 2266 6669 6c6c 222c 2022 6261 636b 6669  "ffill", "backfi
-00020f60: 6c6c 222c 2022 6266 696c 6c22 7d2c 206f  ll", "bfill"}, o
-00020f70: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00020f80: 2020 2020 4d65 7468 6f64 2066 6f72 206e      Method for n
-00020f90: 6f6e 2d6e 756d 6572 6963 2074 7970 6573  on-numeric types
-00020fa0: 2e20 5061 7373 6564 206f 6e20 746f 203a  . Passed on to :
-00020fb0: 7079 3a6d 6574 683a 6044 6174 6173 6574  py:meth:`Dataset
-00020fc0: 2e72 6569 6e64 6578 602e 0a20 2020 2020  .reindex`..     
-00020fd0: 2020 2020 2020 2060 6022 6e65 6172 6573         ``"neares
-00020fe0: 7422 6060 2069 7320 7573 6564 2062 7920  t"`` is used by 
-00020ff0: 6465 6661 756c 742e 0a0a 2020 2020 2020  default...      
-00021000: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-00021010: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00021020: 2020 696e 7465 7270 6f6c 6174 6564 203a    interpolated :
-00021030: 2044 6174 6173 6574 0a20 2020 2020 2020   Dataset.       
-00021040: 2020 2020 2041 6e6f 7468 6572 2064 6174       Another dat
-00021050: 6173 6574 2062 7920 696e 7465 7270 6f6c  aset by interpol
-00021060: 6174 696e 6720 7468 6973 2064 6174 6173  ating this datas
-00021070: 6574 2773 2064 6174 6120 616c 6f6e 6720  et's data along 
-00021080: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00021090: 636f 6f72 6469 6e61 7465 7320 6f66 2074  coordinates of t
-000210a0: 6865 206f 7468 6572 206f 626a 6563 742e  he other object.
-000210b0: 0a0a 2020 2020 2020 2020 4e6f 7465 730a  ..        Notes.
-000210c0: 2020 2020 2020 2020 2d2d 2d2d 2d0a 2020          -----.  
-000210d0: 2020 2020 2020 7363 6970 7920 6973 2072        scipy is r
-000210e0: 6571 7569 7265 642e 0a20 2020 2020 2020  equired..       
-000210f0: 2049 6620 7468 6520 6461 7461 7365 7420   If the dataset 
-00021100: 6861 7320 6f62 6a65 6374 2d74 7970 6520  has object-type 
-00021110: 636f 6f72 6469 6e61 7465 732c 2072 6569  coordinates, rei
-00021120: 6e64 6578 2069 7320 7573 6564 2066 6f72  ndex is used for
-00021130: 2074 6865 7365 0a20 2020 2020 2020 2063   these.        c
-00021140: 6f6f 7264 696e 6174 6573 2069 6e73 7465  oordinates inste
-00021150: 6164 206f 6620 7468 6520 696e 7465 7270  ad of the interp
-00021160: 6f6c 6174 696f 6e2e 0a0a 2020 2020 2020  olation...      
-00021170: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-00021180: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00021190: 2020 2020 4461 7461 7365 742e 696e 7465      Dataset.inte
-000211a0: 7270 0a20 2020 2020 2020 2044 6174 6173  rp.        Datas
-000211b0: 6574 2e72 6569 6e64 6578 5f6c 696b 650a  et.reindex_like.
-000211c0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000211d0: 2020 2020 6966 206b 7761 7267 7320 6973      if kwargs is
-000211e0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000211f0: 2020 206b 7761 7267 7320 3d20 7b7d 0a0a     kwargs = {}..
-00021200: 2020 2020 2020 2020 2320 7069 636b 206f          # pick o
-00021210: 6e6c 7920 6469 6d65 6e73 696f 6e20 636f  nly dimension co
-00021220: 6f72 6469 6e61 7465 7320 7769 7468 2061  ordinates with a
-00021230: 2073 696e 676c 6520 696e 6465 780a 2020   single index.  
-00021240: 2020 2020 2020 636f 6f72 6473 203d 207b        coords = {
-00021250: 7d0a 2020 2020 2020 2020 6f74 6865 725f  }.        other_
-00021260: 696e 6465 7865 7320 3d20 6f74 6865 722e  indexes = other.
-00021270: 7869 6e64 6578 6573 0a20 2020 2020 2020  xindexes.       
-00021280: 2066 6f72 2064 696d 2069 6e20 7365 6c66   for dim in self
-00021290: 2e64 696d 733a 0a20 2020 2020 2020 2020  .dims:.         
-000212a0: 2020 206f 7468 6572 5f64 696d 5f63 6f6f     other_dim_coo
-000212b0: 7264 7320 3d20 6f74 6865 725f 696e 6465  rds = other_inde
-000212c0: 7865 732e 6765 745f 616c 6c5f 636f 6f72  xes.get_all_coor
-000212d0: 6473 2864 696d 2c20 6572 726f 7273 3d22  ds(dim, errors="
-000212e0: 6967 6e6f 7265 2229 0a20 2020 2020 2020  ignore").       
-000212f0: 2020 2020 2069 6620 6c65 6e28 6f74 6865       if len(othe
-00021300: 725f 6469 6d5f 636f 6f72 6473 2920 3d3d  r_dim_coords) ==
-00021310: 2031 3a0a 2020 2020 2020 2020 2020 2020   1:.            
-00021320: 2020 2020 636f 6f72 6473 5b64 696d 5d20      coords[dim] 
-00021330: 3d20 6f74 6865 725f 6469 6d5f 636f 6f72  = other_dim_coor
-00021340: 6473 5b64 696d 5d0a 0a20 2020 2020 2020  ds[dim]..       
-00021350: 206e 756d 6572 6963 5f63 6f6f 7264 733a   numeric_coords:
-00021360: 2064 6963 745b 4861 7368 6162 6c65 2c20   dict[Hashable, 
-00021370: 7064 2e49 6e64 6578 5d20 3d20 7b7d 0a20  pd.Index] = {}. 
-00021380: 2020 2020 2020 206f 626a 6563 745f 636f         object_co
-00021390: 6f72 6473 3a20 6469 6374 5b48 6173 6861  ords: dict[Hasha
-000213a0: 626c 652c 2070 642e 496e 6465 785d 203d  ble, pd.Index] =
-000213b0: 207b 7d0a 2020 2020 2020 2020 666f 7220   {}.        for 
-000213c0: 6b2c 2076 2069 6e20 636f 6f72 6473 2e69  k, v in coords.i
-000213d0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-000213e0: 2020 2020 6966 2076 2e64 7479 7065 2e6b      if v.dtype.k
-000213f0: 696e 6420 696e 2022 7569 6663 4d6d 223a  ind in "uifcMm":
-00021400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021410: 206e 756d 6572 6963 5f63 6f6f 7264 735b   numeric_coords[
-00021420: 6b5d 203d 2076 0a20 2020 2020 2020 2020  k] = v.         
-00021430: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00021440: 2020 2020 2020 2020 206f 626a 6563 745f           object_
-00021450: 636f 6f72 6473 5b6b 5d20 3d20 760a 0a20  coords[k] = v.. 
-00021460: 2020 2020 2020 2064 7320 3d20 7365 6c66         ds = self
-00021470: 0a20 2020 2020 2020 2069 6620 6f62 6a65  .        if obje
-00021480: 6374 5f63 6f6f 7264 733a 0a20 2020 2020  ct_coords:.     
-00021490: 2020 2020 2020 2023 2057 6520 646f 206e         # We do n
-000214a0: 6f74 2073 7570 706f 7274 2069 6e74 6572  ot support inter
-000214b0: 706f 6c61 7469 6f6e 2061 6c6f 6e67 206f  polation along o
-000214c0: 626a 6563 7420 636f 6f72 6469 6e61 7465  bject coordinate
-000214d0: 2e0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-000214e0: 7265 696e 6465 7820 696e 7374 6561 642e  reindex instead.
-000214f0: 0a20 2020 2020 2020 2020 2020 2064 7320  .            ds 
-00021500: 3d20 7365 6c66 2e72 6569 6e64 6578 286f  = self.reindex(o
-00021510: 626a 6563 745f 636f 6f72 6473 290a 2020  bject_coords).  
-00021520: 2020 2020 2020 7265 7475 726e 2064 732e        return ds.
-00021530: 696e 7465 7270 280a 2020 2020 2020 2020  interp(.        
-00021540: 2020 2020 636f 6f72 6473 3d6e 756d 6572      coords=numer
-00021550: 6963 5f63 6f6f 7264 732c 0a20 2020 2020  ic_coords,.     
-00021560: 2020 2020 2020 206d 6574 686f 643d 6d65         method=me
-00021570: 7468 6f64 2c0a 2020 2020 2020 2020 2020  thod,.          
-00021580: 2020 6173 7375 6d65 5f73 6f72 7465 643d    assume_sorted=
-00021590: 6173 7375 6d65 5f73 6f72 7465 642c 0a20  assume_sorted,. 
-000215a0: 2020 2020 2020 2020 2020 206b 7761 7267             kwarg
-000215b0: 733d 6b77 6172 6773 2c0a 2020 2020 2020  s=kwargs,.      
-000215c0: 2020 2020 2020 6d65 7468 6f64 5f6e 6f6e        method_non
-000215d0: 5f6e 756d 6572 6963 3d6d 6574 686f 645f  _numeric=method_
-000215e0: 6e6f 6e5f 6e75 6d65 7269 632c 0a20 2020  non_numeric,.   
-000215f0: 2020 2020 2029 0a0a 2020 2020 2320 4865       )..    # He
-00021600: 6c70 6572 206d 6574 686f 6473 2066 6f72  lper methods for
-00021610: 2072 656e 616d 6528 290a 2020 2020 6465   rename().    de
-00021620: 6620 5f72 656e 616d 655f 7661 7273 280a  f _rename_vars(.
-00021630: 2020 2020 2020 2020 7365 6c66 2c20 6e61          self, na
-00021640: 6d65 5f64 6963 742c 2064 696d 735f 6469  me_dict, dims_di
-00021650: 6374 0a20 2020 2029 202d 3e20 7475 706c  ct.    ) -> tupl
-00021660: 655b 6469 6374 5b48 6173 6861 626c 652c  e[dict[Hashable,
-00021670: 2056 6172 6961 626c 655d 2c20 7365 745b   Variable], set[
-00021680: 4861 7368 6162 6c65 5d5d 3a0a 2020 2020  Hashable]]:.    
-00021690: 2020 2020 7661 7269 6162 6c65 7320 3d20      variables = 
-000216a0: 7b7d 0a20 2020 2020 2020 2063 6f6f 7264  {}.        coord
-000216b0: 5f6e 616d 6573 203d 2073 6574 2829 0a20  _names = set(). 
-000216c0: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
-000216d0: 696e 2073 656c 662e 7661 7269 6162 6c65  in self.variable
-000216e0: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-000216f0: 2020 2020 2020 2076 6172 203d 2076 2e63         var = v.c
-00021700: 6f70 7928 6465 6570 3d46 616c 7365 290a  opy(deep=False).
-00021710: 2020 2020 2020 2020 2020 2020 7661 722e              var.
-00021720: 6469 6d73 203d 2074 7570 6c65 2864 696d  dims = tuple(dim
-00021730: 735f 6469 6374 2e67 6574 2864 696d 2c20  s_dict.get(dim, 
-00021740: 6469 6d29 2066 6f72 2064 696d 2069 6e20  dim) for dim in 
-00021750: 762e 6469 6d73 290a 2020 2020 2020 2020  v.dims).        
-00021760: 2020 2020 6e61 6d65 203d 206e 616d 655f      name = name_
-00021770: 6469 6374 2e67 6574 286b 2c20 6b29 0a20  dict.get(k, k). 
-00021780: 2020 2020 2020 2020 2020 2069 6620 6e61             if na
-00021790: 6d65 2069 6e20 7661 7269 6162 6c65 733a  me in variables:
-000217a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000217b0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-000217c0: 7228 6622 7468 6520 6e65 7720 6e61 6d65  r(f"the new name
-000217d0: 207b 6e61 6d65 2172 7d20 636f 6e66 6c69   {name!r} confli
-000217e0: 6374 7322 290a 2020 2020 2020 2020 2020  cts").          
-000217f0: 2020 7661 7269 6162 6c65 735b 6e61 6d65    variables[name
-00021800: 5d20 3d20 7661 720a 2020 2020 2020 2020  ] = var.        
-00021810: 2020 2020 6966 206b 2069 6e20 7365 6c66      if k in self
-00021820: 2e5f 636f 6f72 645f 6e61 6d65 733a 0a20  ._coord_names:. 
-00021830: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00021840: 6f6f 7264 5f6e 616d 6573 2e61 6464 286e  oord_names.add(n
-00021850: 616d 6529 0a20 2020 2020 2020 2072 6574  ame).        ret
-00021860: 7572 6e20 7661 7269 6162 6c65 732c 2063  urn variables, c
-00021870: 6f6f 7264 5f6e 616d 6573 0a0a 2020 2020  oord_names..    
-00021880: 6465 6620 5f72 656e 616d 655f 6469 6d73  def _rename_dims
-00021890: 2873 656c 662c 206e 616d 655f 6469 6374  (self, name_dict
-000218a0: 3a20 4d61 7070 696e 675b 416e 792c 2048  : Mapping[Any, H
-000218b0: 6173 6861 626c 655d 2920 2d3e 2064 6963  ashable]) -> dic
-000218c0: 745b 4861 7368 6162 6c65 2c20 696e 745d  t[Hashable, int]
-000218d0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000218e0: 207b 6e61 6d65 5f64 6963 742e 6765 7428   {name_dict.get(
-000218f0: 6b2c 206b 293a 2076 2066 6f72 206b 2c20  k, k): v for k, 
-00021900: 7620 696e 2073 656c 662e 6469 6d73 2e69  v in self.dims.i
-00021910: 7465 6d73 2829 7d0a 0a20 2020 2064 6566  tems()}..    def
-00021920: 205f 7265 6e61 6d65 5f69 6e64 6578 6573   _rename_indexes
-00021930: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-00021940: 6e61 6d65 5f64 6963 743a 204d 6170 7069  name_dict: Mappi
-00021950: 6e67 5b41 6e79 2c20 4861 7368 6162 6c65  ng[Any, Hashable
-00021960: 5d2c 2064 696d 735f 6469 6374 3a20 4d61  ], dims_dict: Ma
-00021970: 7070 696e 675b 416e 792c 2048 6173 6861  pping[Any, Hasha
-00021980: 626c 655d 0a20 2020 2029 202d 3e20 7475  ble].    ) -> tu
-00021990: 706c 655b 6469 6374 5b48 6173 6861 626c  ple[dict[Hashabl
-000219a0: 652c 2049 6e64 6578 5d2c 2064 6963 745b  e, Index], dict[
-000219b0: 4861 7368 6162 6c65 2c20 5661 7269 6162  Hashable, Variab
-000219c0: 6c65 5d5d 3a0a 2020 2020 2020 2020 6966  le]]:.        if
-000219d0: 206e 6f74 2073 656c 662e 5f69 6e64 6578   not self._index
-000219e0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-000219f0: 7265 7475 726e 207b 7d2c 207b 7d0a 0a20  return {}, {}.. 
-00021a00: 2020 2020 2020 2069 6e64 6578 6573 203d         indexes =
-00021a10: 207b 7d0a 2020 2020 2020 2020 7661 7269   {}.        vari
-00021a20: 6162 6c65 7320 3d20 7b7d 0a0a 2020 2020  ables = {}..    
-00021a30: 2020 2020 666f 7220 696e 6465 782c 2063      for index, c
-00021a40: 6f6f 7264 5f6e 616d 6573 2069 6e20 7365  oord_names in se
-00021a50: 6c66 2e78 696e 6465 7865 732e 6772 6f75  lf.xindexes.grou
-00021a60: 705f 6279 5f69 6e64 6578 2829 3a0a 2020  p_by_index():.  
-00021a70: 2020 2020 2020 2020 2020 6e65 775f 696e            new_in
-00021a80: 6465 7820 3d20 696e 6465 782e 7265 6e61  dex = index.rena
-00021a90: 6d65 286e 616d 655f 6469 6374 2c20 6469  me(name_dict, di
-00021aa0: 6d73 5f64 6963 7429 0a20 2020 2020 2020  ms_dict).       
-00021ab0: 2020 2020 206e 6577 5f63 6f6f 7264 5f6e       new_coord_n
-00021ac0: 616d 6573 203d 205b 6e61 6d65 5f64 6963  ames = [name_dic
-00021ad0: 742e 6765 7428 6b2c 206b 2920 666f 7220  t.get(k, k) for 
-00021ae0: 6b20 696e 2063 6f6f 7264 5f6e 616d 6573  k in coord_names
-00021af0: 5d0a 2020 2020 2020 2020 2020 2020 696e  ].            in
-00021b00: 6465 7865 732e 7570 6461 7465 287b 6b3a  dexes.update({k:
-00021b10: 206e 6577 5f69 6e64 6578 2066 6f72 206b   new_index for k
-00021b20: 2069 6e20 6e65 775f 636f 6f72 645f 6e61   in new_coord_na
-00021b30: 6d65 737d 290a 2020 2020 2020 2020 2020  mes}).          
-00021b40: 2020 6e65 775f 696e 6465 785f 7661 7273    new_index_vars
-00021b50: 203d 206e 6577 5f69 6e64 6578 2e63 7265   = new_index.cre
-00021b60: 6174 655f 7661 7269 6162 6c65 7328 0a20  ate_variables(. 
-00021b70: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-00021b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021b90: 2020 2020 206e 6577 3a20 7365 6c66 2e5f       new: self._
-00021ba0: 7661 7269 6162 6c65 735b 6f6c 645d 0a20  variables[old]. 
-00021bb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021bc0: 2020 2066 6f72 206f 6c64 2c20 6e65 7720     for old, new 
-00021bd0: 696e 207a 6970 2863 6f6f 7264 5f6e 616d  in zip(coord_nam
-00021be0: 6573 2c20 6e65 775f 636f 6f72 645f 6e61  es, new_coord_na
-00021bf0: 6d65 7329 0a20 2020 2020 2020 2020 2020  mes).           
-00021c00: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-00021c10: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00021c20: 2076 6172 6961 626c 6573 2e75 7064 6174   variables.updat
-00021c30: 6528 6e65 775f 696e 6465 785f 7661 7273  e(new_index_vars
-00021c40: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
-00021c50: 6e20 696e 6465 7865 732c 2076 6172 6961  n indexes, varia
-00021c60: 626c 6573 0a0a 2020 2020 6465 6620 5f72  bles..    def _r
-00021c70: 656e 616d 655f 616c 6c28 0a20 2020 2020  ename_all(.     
-00021c80: 2020 2073 656c 662c 206e 616d 655f 6469     self, name_di
-00021c90: 6374 3a20 4d61 7070 696e 675b 416e 792c  ct: Mapping[Any,
-00021ca0: 2048 6173 6861 626c 655d 2c20 6469 6d73   Hashable], dims
-00021cb0: 5f64 6963 743a 204d 6170 7069 6e67 5b41  _dict: Mapping[A
-00021cc0: 6e79 2c20 4861 7368 6162 6c65 5d0a 2020  ny, Hashable].  
-00021cd0: 2020 2920 2d3e 2074 7570 6c65 5b0a 2020    ) -> tuple[.  
-00021ce0: 2020 2020 2020 6469 6374 5b48 6173 6861        dict[Hasha
-00021cf0: 626c 652c 2056 6172 6961 626c 655d 2c0a  ble, Variable],.
-00021d00: 2020 2020 2020 2020 7365 745b 4861 7368          set[Hash
-00021d10: 6162 6c65 5d2c 0a20 2020 2020 2020 2064  able],.        d
-00021d20: 6963 745b 4861 7368 6162 6c65 2c20 696e  ict[Hashable, in
-00021d30: 745d 2c0a 2020 2020 2020 2020 6469 6374  t],.        dict
-00021d40: 5b48 6173 6861 626c 652c 2049 6e64 6578  [Hashable, Index
-00021d50: 5d2c 0a20 2020 205d 3a0a 2020 2020 2020  ],.    ]:.      
-00021d60: 2020 7661 7269 6162 6c65 732c 2063 6f6f    variables, coo
-00021d70: 7264 5f6e 616d 6573 203d 2073 656c 662e  rd_names = self.
-00021d80: 5f72 656e 616d 655f 7661 7273 286e 616d  _rename_vars(nam
-00021d90: 655f 6469 6374 2c20 6469 6d73 5f64 6963  e_dict, dims_dic
-00021da0: 7429 0a20 2020 2020 2020 2064 696d 7320  t).        dims 
-00021db0: 3d20 7365 6c66 2e5f 7265 6e61 6d65 5f64  = self._rename_d
-00021dc0: 696d 7328 6469 6d73 5f64 6963 7429 0a0a  ims(dims_dict)..
-00021dd0: 2020 2020 2020 2020 696e 6465 7865 732c          indexes,
-00021de0: 2069 6e64 6578 5f76 6172 7320 3d20 7365   index_vars = se
-00021df0: 6c66 2e5f 7265 6e61 6d65 5f69 6e64 6578  lf._rename_index
-00021e00: 6573 286e 616d 655f 6469 6374 2c20 6469  es(name_dict, di
-00021e10: 6d73 5f64 6963 7429 0a20 2020 2020 2020  ms_dict).       
-00021e20: 2076 6172 6961 626c 6573 203d 207b 6b3a   variables = {k:
-00021e30: 2069 6e64 6578 5f76 6172 732e 6765 7428   index_vars.get(
-00021e40: 6b2c 2076 2920 666f 7220 6b2c 2076 2069  k, v) for k, v i
-00021e50: 6e20 7661 7269 6162 6c65 732e 6974 656d  n variables.item
-00021e60: 7328 297d 0a0a 2020 2020 2020 2020 7265  s()}..        re
-00021e70: 7475 726e 2076 6172 6961 626c 6573 2c20  turn variables, 
-00021e80: 636f 6f72 645f 6e61 6d65 732c 2064 696d  coord_names, dim
-00021e90: 732c 2069 6e64 6578 6573 0a0a 2020 2020  s, indexes..    
-00021ea0: 6465 6620 5f72 656e 616d 6528 0a20 2020  def _rename(.   
-00021eb0: 2020 2020 2073 656c 663a 2054 5f44 6174       self: T_Dat
-00021ec0: 6173 6574 2c0a 2020 2020 2020 2020 6e61  aset,.        na
-00021ed0: 6d65 5f64 6963 743a 204d 6170 7069 6e67  me_dict: Mapping
-00021ee0: 5b41 6e79 2c20 4861 7368 6162 6c65 5d20  [Any, Hashable] 
-00021ef0: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00021f00: 2020 2020 2020 202a 2a6e 616d 6573 3a20         **names: 
-00021f10: 4861 7368 6162 6c65 2c0a 2020 2020 2920  Hashable,.    ) 
-00021f20: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-00021f30: 2020 2020 2020 2222 2241 6c73 6f20 7573        """Also us
-00021f40: 6564 2069 6e74 6572 6e61 6c6c 7920 6279  ed internally by
-00021f50: 2044 6174 6141 7272 6179 2073 6f20 7468   DataArray so th
-00021f60: 6174 2074 6865 2077 6172 6e69 6e67 2028  at the warning (
-00021f70: 6966 2061 6e79 290a 2020 2020 2020 2020  if any).        
-00021f80: 6973 2072 6169 7365 6420 6174 2074 6865  is raised at the
-00021f90: 2072 6967 6874 2073 7461 636b 206c 6576   right stack lev
-00021fa0: 656c 2e0a 2020 2020 2020 2020 2222 220a  el..        """.
-00021fb0: 2020 2020 2020 2020 6e61 6d65 5f64 6963          name_dic
-00021fc0: 7420 3d20 6569 7468 6572 5f64 6963 745f  t = either_dict_
-00021fd0: 6f72 5f6b 7761 7267 7328 6e61 6d65 5f64  or_kwargs(name_d
-00021fe0: 6963 742c 206e 616d 6573 2c20 2272 656e  ict, names, "ren
-00021ff0: 616d 6522 290a 2020 2020 2020 2020 666f  ame").        fo
-00022000: 7220 6b20 696e 206e 616d 655f 6469 6374  r k in name_dict
-00022010: 2e6b 6579 7328 293a 0a20 2020 2020 2020  .keys():.       
-00022020: 2020 2020 2069 6620 6b20 6e6f 7420 696e       if k not in
-00022030: 2073 656c 6620 616e 6420 6b20 6e6f 7420   self and k not 
-00022040: 696e 2073 656c 662e 6469 6d73 3a0a 2020  in self.dims:.  
-00022050: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00022060: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00022070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022080: 2020 2020 6622 6361 6e6e 6f74 2072 656e      f"cannot ren
-00022090: 616d 6520 7b6b 2172 7d20 6265 6361 7573  ame {k!r} becaus
-000220a0: 6520 6974 2069 7320 6e6f 7420 6120 220a  e it is not a ".
-000220b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000220c0: 2020 2020 2276 6172 6961 626c 6520 6f72      "variable or
-000220d0: 2064 696d 656e 7369 6f6e 2069 6e20 7468   dimension in th
-000220e0: 6973 2064 6174 6173 6574 220a 2020 2020  is dataset".    
-000220f0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00022100: 2020 2020 2020 2020 2020 2063 7265 6174             creat
-00022110: 655f 6469 6d5f 636f 6f72 6420 3d20 4661  e_dim_coord = Fa
-00022120: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00022130: 6e65 775f 6b20 3d20 6e61 6d65 5f64 6963  new_k = name_dic
-00022140: 745b 6b5d 0a0a 2020 2020 2020 2020 2020  t[k]..          
-00022150: 2020 6966 206b 2069 6e20 7365 6c66 2e64    if k in self.d
-00022160: 696d 7320 616e 6420 6e65 775f 6b20 696e  ims and new_k in
-00022170: 2073 656c 662e 5f63 6f6f 7264 5f6e 616d   self._coord_nam
-00022180: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00022190: 2020 2020 636f 6f72 645f 6469 6d73 203d      coord_dims =
-000221a0: 2073 656c 662e 5f76 6172 6961 626c 6573   self._variables
-000221b0: 5b6e 616d 655f 6469 6374 5b6b 5d5d 2e64  [name_dict[k]].d
-000221c0: 696d 730a 2020 2020 2020 2020 2020 2020  ims.            
-000221d0: 2020 2020 6966 2063 6f6f 7264 5f64 696d      if coord_dim
-000221e0: 7320 3d3d 2028 6b2c 293a 0a20 2020 2020  s == (k,):.     
-000221f0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00022200: 7265 6174 655f 6469 6d5f 636f 6f72 6420  reate_dim_coord 
-00022210: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-00022220: 2020 2065 6c69 6620 6b20 696e 2073 656c     elif k in sel
-00022230: 662e 5f63 6f6f 7264 5f6e 616d 6573 2061  f._coord_names a
-00022240: 6e64 206e 6577 5f6b 2069 6e20 7365 6c66  nd new_k in self
-00022250: 2e64 696d 733a 0a20 2020 2020 2020 2020  .dims:.         
-00022260: 2020 2020 2020 2063 6f6f 7264 5f64 696d         coord_dim
-00022270: 7320 3d20 7365 6c66 2e5f 7661 7269 6162  s = self._variab
-00022280: 6c65 735b 6b5d 2e64 696d 730a 2020 2020  les[k].dims.    
-00022290: 2020 2020 2020 2020 2020 2020 6966 2063              if c
-000222a0: 6f6f 7264 5f64 696d 7320 3d3d 2028 6e65  oord_dims == (ne
-000222b0: 775f 6b2c 293a 0a20 2020 2020 2020 2020  w_k,):.         
-000222c0: 2020 2020 2020 2020 2020 2063 7265 6174             creat
-000222d0: 655f 6469 6d5f 636f 6f72 6420 3d20 5472  e_dim_coord = Tr
-000222e0: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
-000222f0: 6966 2063 7265 6174 655f 6469 6d5f 636f  if create_dim_co
-00022300: 6f72 643a 0a20 2020 2020 2020 2020 2020  ord:.           
-00022310: 2020 2020 2077 6172 6e69 6e67 732e 7761       warnings.wa
-00022320: 726e 280a 2020 2020 2020 2020 2020 2020  rn(.            
-00022330: 2020 2020 2020 2020 6622 7265 6e61 6d65          f"rename
-00022340: 207b 6b21 727d 2074 6f20 7b6e 616d 655f   {k!r} to {name_
-00022350: 6469 6374 5b6b 5d21 727d 2064 6f65 7320  dict[k]!r} does 
-00022360: 6e6f 7420 6372 6561 7465 2061 6e20 696e  not create an in
-00022370: 6465 7820 220a 2020 2020 2020 2020 2020  dex ".          
-00022380: 2020 2020 2020 2020 2020 2261 6e79 6d6f            "anymo
-00022390: 7265 2e20 5472 7920 7573 696e 6720 7377  re. Try using sw
-000223a0: 6170 5f64 696d 7320 696e 7374 6561 6420  ap_dims instead 
-000223b0: 6f72 2075 7365 2073 6574 5f69 6e64 6578  or use set_index
-000223c0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-000223d0: 2020 2020 2020 2022 6166 7465 7220 7265         "after re
-000223e0: 6e61 6d65 2074 6f20 6372 6561 7465 2061  name to create a
-000223f0: 6e20 696e 6465 7865 6420 636f 6f72 6469  n indexed coordi
-00022400: 6e61 7465 2e22 2c0a 2020 2020 2020 2020  nate.",.        
-00022410: 2020 2020 2020 2020 2020 2020 5573 6572              User
-00022420: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
-00022430: 2020 2020 2020 2020 2020 2020 2073 7461               sta
-00022440: 636b 6c65 7665 6c3d 332c 0a20 2020 2020  cklevel=3,.     
-00022450: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00022460: 2020 2020 2020 7661 7269 6162 6c65 732c        variables,
-00022470: 2063 6f6f 7264 5f6e 616d 6573 2c20 6469   coord_names, di
-00022480: 6d73 2c20 696e 6465 7865 7320 3d20 7365  ms, indexes = se
-00022490: 6c66 2e5f 7265 6e61 6d65 5f61 6c6c 280a  lf._rename_all(.
-000224a0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-000224b0: 5f64 6963 743d 6e61 6d65 5f64 6963 742c  _dict=name_dict,
-000224c0: 2064 696d 735f 6469 6374 3d6e 616d 655f   dims_dict=name_
-000224d0: 6469 6374 0a20 2020 2020 2020 2029 0a20  dict.        ). 
-000224e0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000224f0: 6c66 2e5f 7265 706c 6163 6528 7661 7269  lf._replace(vari
-00022500: 6162 6c65 732c 2063 6f6f 7264 5f6e 616d  ables, coord_nam
-00022510: 6573 2c20 6469 6d73 3d64 696d 732c 2069  es, dims=dims, i
-00022520: 6e64 6578 6573 3d69 6e64 6578 6573 290a  ndexes=indexes).
-00022530: 0a20 2020 2064 6566 2072 656e 616d 6528  .    def rename(
-00022540: 0a20 2020 2020 2020 2073 656c 663a 2054  .        self: T
-00022550: 5f44 6174 6173 6574 2c0a 2020 2020 2020  _Dataset,.      
-00022560: 2020 6e61 6d65 5f64 6963 743a 204d 6170    name_dict: Map
-00022570: 7069 6e67 5b41 6e79 2c20 4861 7368 6162  ping[Any, Hashab
-00022580: 6c65 5d20 7c20 4e6f 6e65 203d 204e 6f6e  le] | None = Non
-00022590: 652c 0a20 2020 2020 2020 202a 2a6e 616d  e,.        **nam
-000225a0: 6573 3a20 4861 7368 6162 6c65 2c0a 2020  es: Hashable,.  
-000225b0: 2020 2920 2d3e 2054 5f44 6174 6173 6574    ) -> T_Dataset
-000225c0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-000225d0: 7572 6e73 2061 206e 6577 206f 626a 6563  urns a new objec
-000225e0: 7420 7769 7468 2072 656e 616d 6564 2076  t with renamed v
-000225f0: 6172 6961 626c 6573 2c20 636f 6f72 6469  ariables, coordi
-00022600: 6e61 7465 7320 616e 6420 6469 6d65 6e73  nates and dimens
-00022610: 696f 6e73 2e0a 0a20 2020 2020 2020 2050  ions...        P
-00022620: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00022630: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00022640: 2020 2020 206e 616d 655f 6469 6374 203a       name_dict :
-00022650: 2064 6963 742d 6c69 6b65 2c20 6f70 7469   dict-like, opti
-00022660: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00022670: 2044 6963 7469 6f6e 6172 7920 7768 6f73   Dictionary whos
-00022680: 6520 6b65 7973 2061 7265 2063 7572 7265  e keys are curre
-00022690: 6e74 2076 6172 6961 626c 652c 2063 6f6f  nt variable, coo
-000226a0: 7264 696e 6174 6520 6f72 2064 696d 656e  rdinate or dimen
-000226b0: 7369 6f6e 206e 616d 6573 2061 6e64 0a20  sion names and. 
-000226c0: 2020 2020 2020 2020 2020 2077 686f 7365             whose
-000226d0: 2076 616c 7565 7320 6172 6520 7468 6520   values are the 
-000226e0: 6465 7369 7265 6420 6e61 6d65 732e 0a20  desired names.. 
-000226f0: 2020 2020 2020 202a 2a6e 616d 6573 203a         **names :
-00022700: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00022710: 2020 2020 2020 4b65 7977 6f72 6420 666f        Keyword fo
-00022720: 726d 206f 6620 6060 6e61 6d65 5f64 6963  rm of ``name_dic
-00022730: 7460 602e 0a20 2020 2020 2020 2020 2020  t``..           
-00022740: 204f 6e65 206f 6620 6e61 6d65 5f64 6963   One of name_dic
-00022750: 7420 6f72 206e 616d 6573 206d 7573 7420  t or names must 
-00022760: 6265 2070 726f 7669 6465 642e 0a0a 2020  be provided...  
-00022770: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00022780: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00022790: 2020 2020 2020 7265 6e61 6d65 6420 3a20        renamed : 
-000227a0: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
-000227b0: 2020 2020 4461 7461 7365 7420 7769 7468      Dataset with
-000227c0: 2072 656e 616d 6564 2076 6172 6961 626c   renamed variabl
-000227d0: 6573 2c20 636f 6f72 6469 6e61 7465 7320  es, coordinates 
-000227e0: 616e 6420 6469 6d65 6e73 696f 6e73 2e0a  and dimensions..
-000227f0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-00022800: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-00022810: 2d2d 0a20 2020 2020 2020 2044 6174 6173  --.        Datas
-00022820: 6574 2e73 7761 705f 6469 6d73 0a20 2020  et.swap_dims.   
-00022830: 2020 2020 2044 6174 6173 6574 2e72 656e       Dataset.ren
-00022840: 616d 655f 7661 7273 0a20 2020 2020 2020  ame_vars.       
-00022850: 2044 6174 6173 6574 2e72 656e 616d 655f   Dataset.rename_
-00022860: 6469 6d73 0a20 2020 2020 2020 2044 6174  dims.        Dat
-00022870: 6141 7272 6179 2e72 656e 616d 650a 2020  aArray.rename.  
-00022880: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00022890: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-000228a0: 656e 616d 6528 6e61 6d65 5f64 6963 743d  ename(name_dict=
-000228b0: 6e61 6d65 5f64 6963 742c 202a 2a6e 616d  name_dict, **nam
-000228c0: 6573 290a 0a20 2020 2064 6566 2072 656e  es)..    def ren
-000228d0: 616d 655f 6469 6d73 280a 2020 2020 2020  ame_dims(.      
-000228e0: 2020 7365 6c66 3a20 545f 4461 7461 7365    self: T_Datase
-000228f0: 742c 0a20 2020 2020 2020 2064 696d 735f  t,.        dims_
-00022900: 6469 6374 3a20 4d61 7070 696e 675b 416e  dict: Mapping[An
-00022910: 792c 2048 6173 6861 626c 655d 207c 204e  y, Hashable] | N
-00022920: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-00022930: 2020 2020 2a2a 6469 6d73 3a20 4861 7368      **dims: Hash
-00022940: 6162 6c65 2c0a 2020 2020 2920 2d3e 2054  able,.    ) -> T
-00022950: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
-00022960: 2020 2222 2252 6574 7572 6e73 2061 206e    """Returns a n
-00022970: 6577 206f 626a 6563 7420 7769 7468 2072  ew object with r
-00022980: 656e 616d 6564 2064 696d 656e 7369 6f6e  enamed dimension
-00022990: 7320 6f6e 6c79 2e0a 0a20 2020 2020 2020  s only...       
-000229a0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000229b0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-000229c0: 2020 2020 2020 2064 696d 735f 6469 6374         dims_dict
-000229d0: 203a 2064 6963 742d 6c69 6b65 2c20 6f70   : dict-like, op
-000229e0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-000229f0: 2020 2044 6963 7469 6f6e 6172 7920 7768     Dictionary wh
-00022a00: 6f73 6520 6b65 7973 2061 7265 2063 7572  ose keys are cur
-00022a10: 7265 6e74 2064 696d 656e 7369 6f6e 206e  rent dimension n
-00022a20: 616d 6573 2061 6e64 0a20 2020 2020 2020  ames and.       
-00022a30: 2020 2020 2077 686f 7365 2076 616c 7565       whose value
-00022a40: 7320 6172 6520 7468 6520 6465 7369 7265  s are the desire
-00022a50: 6420 6e61 6d65 732e 2054 6865 2064 6573  d names. The des
-00022a60: 6972 6564 206e 616d 6573 206d 7573 740a  ired names must.
-00022a70: 2020 2020 2020 2020 2020 2020 6e6f 7420              not 
-00022a80: 6265 2074 6865 206e 616d 6520 6f66 2061  be the name of a
-00022a90: 6e20 6578 6973 7469 6e67 2064 696d 656e  n existing dimen
-00022aa0: 7369 6f6e 206f 7220 5661 7269 6162 6c65  sion or Variable
-00022ab0: 2069 6e20 7468 6520 4461 7461 7365 742e   in the Dataset.
-00022ac0: 0a20 2020 2020 2020 202a 2a64 696d 7320  .        **dims 
-00022ad0: 3a20 6f70 7469 6f6e 616c 0a20 2020 2020  : optional.     
-00022ae0: 2020 2020 2020 204b 6579 776f 7264 2066         Keyword f
-00022af0: 6f72 6d20 6f66 2060 6064 696d 735f 6469  orm of ``dims_di
-00022b00: 6374 6060 2e0a 2020 2020 2020 2020 2020  ct``..          
-00022b10: 2020 4f6e 6520 6f66 2064 696d 735f 6469    One of dims_di
-00022b20: 6374 206f 7220 6469 6d73 206d 7573 7420  ct or dims must 
-00022b30: 6265 2070 726f 7669 6465 642e 0a0a 2020  be provided...  
-00022b40: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00022b50: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00022b60: 2020 2020 2020 7265 6e61 6d65 6420 3a20        renamed : 
-00022b70: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
-00022b80: 2020 2020 4461 7461 7365 7420 7769 7468      Dataset with
-00022b90: 2072 656e 616d 6564 2064 696d 656e 7369   renamed dimensi
-00022ba0: 6f6e 732e 0a0a 2020 2020 2020 2020 5365  ons...        Se
-00022bb0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-00022bc0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00022bd0: 4461 7461 7365 742e 7377 6170 5f64 696d  Dataset.swap_dim
-00022be0: 730a 2020 2020 2020 2020 4461 7461 7365  s.        Datase
-00022bf0: 742e 7265 6e61 6d65 0a20 2020 2020 2020  t.rename.       
-00022c00: 2044 6174 6173 6574 2e72 656e 616d 655f   Dataset.rename_
-00022c10: 7661 7273 0a20 2020 2020 2020 2044 6174  vars.        Dat
-00022c20: 6141 7272 6179 2e72 656e 616d 650a 2020  aArray.rename.  
-00022c30: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00022c40: 2020 6469 6d73 5f64 6963 7420 3d20 6569    dims_dict = ei
-00022c50: 7468 6572 5f64 6963 745f 6f72 5f6b 7761  ther_dict_or_kwa
-00022c60: 7267 7328 6469 6d73 5f64 6963 742c 2064  rgs(dims_dict, d
-00022c70: 696d 732c 2022 7265 6e61 6d65 5f64 696d  ims, "rename_dim
-00022c80: 7322 290a 2020 2020 2020 2020 666f 7220  s").        for 
-00022c90: 6b2c 2076 2069 6e20 6469 6d73 5f64 6963  k, v in dims_dic
-00022ca0: 742e 6974 656d 7328 293a 0a20 2020 2020  t.items():.     
-00022cb0: 2020 2020 2020 2069 6620 6b20 6e6f 7420         if k not 
-00022cc0: 696e 2073 656c 662e 6469 6d73 3a0a 2020  in self.dims:.  
-00022cd0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00022ce0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00022cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d00: 2020 2020 6622 6361 6e6e 6f74 2072 656e      f"cannot ren
-00022d10: 616d 6520 7b6b 2172 7d20 6265 6361 7573  ame {k!r} becaus
-00022d20: 6520 6974 2069 7320 6e6f 7420 6120 220a  e it is not a ".
-00022d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d40: 2020 2020 2264 696d 656e 7369 6f6e 2069      "dimension i
-00022d50: 6e20 7468 6973 2064 6174 6173 6574 220a  n this dataset".
-00022d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022d70: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00022d80: 2076 2069 6e20 7365 6c66 2e64 696d 7320   v in self.dims 
-00022d90: 6f72 2076 2069 6e20 7365 6c66 3a0a 2020  or v in self:.  
-00022da0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00022db0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00022dc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022dd0: 2020 2020 6622 4361 6e6e 6f74 2072 656e      f"Cannot ren
-00022de0: 616d 6520 7b6b 7d20 746f 207b 767d 2062  ame {k} to {v} b
-00022df0: 6563 6175 7365 207b 767d 2061 6c72 6561  ecause {v} alrea
-00022e00: 6479 2065 7869 7374 732e 2022 0a20 2020  dy exists. ".   
-00022e10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e20: 2022 5472 7920 7573 696e 6720 7377 6170   "Try using swap
-00022e30: 5f64 696d 7320 696e 7374 6561 642e 220a  _dims instead.".
-00022e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00022e50: 290a 0a20 2020 2020 2020 2076 6172 6961  )..        varia
-00022e60: 626c 6573 2c20 636f 6f72 645f 6e61 6d65  bles, coord_name
-00022e70: 732c 2073 697a 6573 2c20 696e 6465 7865  s, sizes, indexe
-00022e80: 7320 3d20 7365 6c66 2e5f 7265 6e61 6d65  s = self._rename
-00022e90: 5f61 6c6c 280a 2020 2020 2020 2020 2020  _all(.          
-00022ea0: 2020 6e61 6d65 5f64 6963 743d 7b7d 2c20    name_dict={}, 
-00022eb0: 6469 6d73 5f64 6963 743d 6469 6d73 5f64  dims_dict=dims_d
-00022ec0: 6963 740a 2020 2020 2020 2020 290a 2020  ict.        ).  
-00022ed0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00022ee0: 662e 5f72 6570 6c61 6365 2876 6172 6961  f._replace(varia
-00022ef0: 626c 6573 2c20 636f 6f72 645f 6e61 6d65  bles, coord_name
-00022f00: 732c 2064 696d 733d 7369 7a65 732c 2069  s, dims=sizes, i
-00022f10: 6e64 6578 6573 3d69 6e64 6578 6573 290a  ndexes=indexes).
-00022f20: 0a20 2020 2064 6566 2072 656e 616d 655f  .    def rename_
-00022f30: 7661 7273 280a 2020 2020 2020 2020 7365  vars(.        se
-00022f40: 6c66 3a20 545f 4461 7461 7365 742c 0a20  lf: T_Dataset,. 
-00022f50: 2020 2020 2020 206e 616d 655f 6469 6374         name_dict
-00022f60: 3a20 4d61 7070 696e 675b 416e 792c 2048  : Mapping[Any, H
-00022f70: 6173 6861 626c 655d 207c 204e 6f6e 6520  ashable] | None 
-00022f80: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00022f90: 2a2a 6e61 6d65 733a 2048 6173 6861 626c  **names: Hashabl
-00022fa0: 652c 0a20 2020 2029 202d 3e20 545f 4461  e,.    ) -> T_Da
-00022fb0: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-00022fc0: 2222 5265 7475 726e 7320 6120 6e65 7720  ""Returns a new 
-00022fd0: 6f62 6a65 6374 2077 6974 6820 7265 6e61  object with rena
-00022fe0: 6d65 6420 7661 7269 6162 6c65 7320 696e  med variables in
-00022ff0: 636c 7564 696e 6720 636f 6f72 6469 6e61  cluding coordina
-00023000: 7465 730a 0a20 2020 2020 2020 2050 6172  tes..        Par
-00023010: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-00023020: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-00023030: 2020 206e 616d 655f 6469 6374 203a 2064     name_dict : d
-00023040: 6963 742d 6c69 6b65 2c20 6f70 7469 6f6e  ict-like, option
-00023050: 616c 0a20 2020 2020 2020 2020 2020 2044  al.            D
-00023060: 6963 7469 6f6e 6172 7920 7768 6f73 6520  ictionary whose 
-00023070: 6b65 7973 2061 7265 2063 7572 7265 6e74  keys are current
-00023080: 2076 6172 6961 626c 6520 6f72 2063 6f6f   variable or coo
-00023090: 7264 696e 6174 6520 6e61 6d65 7320 616e  rdinate names an
-000230a0: 640a 2020 2020 2020 2020 2020 2020 7768  d.            wh
-000230b0: 6f73 6520 7661 6c75 6573 2061 7265 2074  ose values are t
-000230c0: 6865 2064 6573 6972 6564 206e 616d 6573  he desired names
-000230d0: 2e0a 2020 2020 2020 2020 2a2a 6e61 6d65  ..        **name
-000230e0: 7320 3a20 6f70 7469 6f6e 616c 0a20 2020  s : optional.   
-000230f0: 2020 2020 2020 2020 204b 6579 776f 7264           Keyword
-00023100: 2066 6f72 6d20 6f66 2060 606e 616d 655f   form of ``name_
-00023110: 6469 6374 6060 2e0a 2020 2020 2020 2020  dict``..        
-00023120: 2020 2020 4f6e 6520 6f66 206e 616d 655f      One of name_
-00023130: 6469 6374 206f 7220 6e61 6d65 7320 6d75  dict or names mu
-00023140: 7374 2062 6520 7072 6f76 6964 6564 2e0a  st be provided..
-00023150: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00023160: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00023170: 0a20 2020 2020 2020 2072 656e 616d 6564  .        renamed
-00023180: 203a 2044 6174 6173 6574 0a20 2020 2020   : Dataset.     
-00023190: 2020 2020 2020 2044 6174 6173 6574 2077         Dataset w
-000231a0: 6974 6820 7265 6e61 6d65 6420 7661 7269  ith renamed vari
-000231b0: 6162 6c65 7320 696e 636c 7564 696e 6720  ables including 
-000231c0: 636f 6f72 6469 6e61 7465 730a 0a20 2020  coordinates..   
-000231d0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-000231e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-000231f0: 2020 2020 2020 2044 6174 6173 6574 2e73         Dataset.s
-00023200: 7761 705f 6469 6d73 0a20 2020 2020 2020  wap_dims.       
-00023210: 2044 6174 6173 6574 2e72 656e 616d 650a   Dataset.rename.
-00023220: 2020 2020 2020 2020 4461 7461 7365 742e          Dataset.
-00023230: 7265 6e61 6d65 5f64 696d 730a 2020 2020  rename_dims.    
-00023240: 2020 2020 4461 7461 4172 7261 792e 7265      DataArray.re
-00023250: 6e61 6d65 0a20 2020 2020 2020 2022 2222  name.        """
-00023260: 0a20 2020 2020 2020 206e 616d 655f 6469  .        name_di
-00023270: 6374 203d 2065 6974 6865 725f 6469 6374  ct = either_dict
-00023280: 5f6f 725f 6b77 6172 6773 286e 616d 655f  _or_kwargs(name_
-00023290: 6469 6374 2c20 6e61 6d65 732c 2022 7265  dict, names, "re
-000232a0: 6e61 6d65 5f76 6172 7322 290a 2020 2020  name_vars").    
-000232b0: 2020 2020 666f 7220 6b20 696e 206e 616d      for k in nam
-000232c0: 655f 6469 6374 3a0a 2020 2020 2020 2020  e_dict:.        
-000232d0: 2020 2020 6966 206b 206e 6f74 2069 6e20      if k not in 
-000232e0: 7365 6c66 3a0a 2020 2020 2020 2020 2020  self:.          
-000232f0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-00023300: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-00023310: 2020 2020 2020 2020 2020 2020 6622 6361              f"ca
-00023320: 6e6e 6f74 2072 656e 616d 6520 7b6b 2172  nnot rename {k!r
-00023330: 7d20 6265 6361 7573 6520 6974 2069 7320  } because it is 
-00023340: 6e6f 7420 6120 220a 2020 2020 2020 2020  not a ".        
-00023350: 2020 2020 2020 2020 2020 2020 2276 6172              "var
-00023360: 6961 626c 6520 6f72 2063 6f6f 7264 696e  iable or coordin
-00023370: 6174 6520 696e 2074 6869 7320 6461 7461  ate in this data
-00023380: 7365 7422 0a20 2020 2020 2020 2020 2020  set".           
-00023390: 2020 2020 2029 0a20 2020 2020 2020 2076       ).        v
-000233a0: 6172 6961 626c 6573 2c20 636f 6f72 645f  ariables, coord_
-000233b0: 6e61 6d65 732c 2064 696d 732c 2069 6e64  names, dims, ind
-000233c0: 6578 6573 203d 2073 656c 662e 5f72 656e  exes = self._ren
-000233d0: 616d 655f 616c 6c28 0a20 2020 2020 2020  ame_all(.       
-000233e0: 2020 2020 206e 616d 655f 6469 6374 3d6e       name_dict=n
-000233f0: 616d 655f 6469 6374 2c20 6469 6d73 5f64  ame_dict, dims_d
-00023400: 6963 743d 7b7d 0a20 2020 2020 2020 2029  ict={}.        )
-00023410: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00023420: 7365 6c66 2e5f 7265 706c 6163 6528 7661  self._replace(va
-00023430: 7269 6162 6c65 732c 2063 6f6f 7264 5f6e  riables, coord_n
-00023440: 616d 6573 2c20 6469 6d73 3d64 696d 732c  ames, dims=dims,
-00023450: 2069 6e64 6578 6573 3d69 6e64 6578 6573   indexes=indexes
-00023460: 290a 0a20 2020 2064 6566 2073 7761 705f  )..    def swap_
-00023470: 6469 6d73 280a 2020 2020 2020 2020 7365  dims(.        se
-00023480: 6c66 3a20 545f 4461 7461 7365 742c 2064  lf: T_Dataset, d
-00023490: 696d 735f 6469 6374 3a20 4d61 7070 696e  ims_dict: Mappin
-000234a0: 675b 416e 792c 2048 6173 6861 626c 655d  g[Any, Hashable]
-000234b0: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c20   | None = None, 
-000234c0: 2a2a 6469 6d73 5f6b 7761 7267 730a 2020  **dims_kwargs.  
-000234d0: 2020 2920 2d3e 2054 5f44 6174 6173 6574    ) -> T_Dataset
-000234e0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-000234f0: 7572 6e73 2061 206e 6577 206f 626a 6563  urns a new objec
-00023500: 7420 7769 7468 2073 7761 7070 6564 2064  t with swapped d
-00023510: 696d 656e 7369 6f6e 732e 0a0a 2020 2020  imensions...    
-00023520: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00023530: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00023540: 2d0a 2020 2020 2020 2020 6469 6d73 5f64  -.        dims_d
-00023550: 6963 7420 3a20 6469 6374 2d6c 696b 650a  ict : dict-like.
-00023560: 2020 2020 2020 2020 2020 2020 4469 6374              Dict
-00023570: 696f 6e61 7279 2077 686f 7365 206b 6579  ionary whose key
-00023580: 7320 6172 6520 6375 7272 656e 7420 6469  s are current di
-00023590: 6d65 6e73 696f 6e20 6e61 6d65 7320 616e  mension names an
-000235a0: 6420 7768 6f73 6520 7661 6c75 6573 0a20  d whose values. 
-000235b0: 2020 2020 2020 2020 2020 2061 7265 206e             are n
-000235c0: 6577 206e 616d 6573 2e0a 2020 2020 2020  ew names..      
-000235d0: 2020 2a2a 6469 6d73 5f6b 7761 7267 7320    **dims_kwargs 
-000235e0: 3a20 7b65 7869 7374 696e 675f 6469 6d3a  : {existing_dim:
-000235f0: 206e 6577 5f64 696d 2c20 2e2e 2e7d 2c20   new_dim, ...}, 
-00023600: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00023610: 2020 2020 2054 6865 206b 6579 776f 7264       The keyword
-00023620: 2061 7267 756d 656e 7473 2066 6f72 6d20   arguments form 
-00023630: 6f66 2060 6064 696d 735f 6469 6374 6060  of ``dims_dict``
-00023640: 2e0a 2020 2020 2020 2020 2020 2020 4f6e  ..            On
-00023650: 6520 6f66 2064 696d 735f 6469 6374 206f  e of dims_dict o
-00023660: 7220 6469 6d73 5f6b 7761 7267 7320 6d75  r dims_kwargs mu
-00023670: 7374 2062 6520 7072 6f76 6964 6564 2e0a  st be provided..
-00023680: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00023690: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000236a0: 0a20 2020 2020 2020 2073 7761 7070 6564  .        swapped
-000236b0: 203a 2044 6174 6173 6574 0a20 2020 2020   : Dataset.     
-000236c0: 2020 2020 2020 2044 6174 6173 6574 2077         Dataset w
-000236d0: 6974 6820 7377 6170 7065 6420 6469 6d65  ith swapped dime
-000236e0: 6e73 696f 6e73 2e0a 0a20 2020 2020 2020  nsions...       
-000236f0: 2045 7861 6d70 6c65 730a 2020 2020 2020   Examples.      
-00023700: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-00023710: 2020 203e 3e3e 2064 7320 3d20 7872 2e44     >>> ds = xr.D
-00023720: 6174 6173 6574 280a 2020 2020 2020 2020  ataset(.        
-00023730: 2e2e 2e20 2020 2020 6461 7461 5f76 6172  ...     data_var
-00023740: 733d 7b22 6122 3a20 2822 7822 2c20 5b35  s={"a": ("x", [5
-00023750: 2c20 375d 292c 2022 6222 3a20 2822 7822  , 7]), "b": ("x"
-00023760: 2c20 5b30 2e31 2c20 322e 345d 297d 2c0a  , [0.1, 2.4])},.
-00023770: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00023780: 636f 6f72 6473 3d7b 2278 223a 205b 2261  coords={"x": ["a
-00023790: 222c 2022 6222 5d2c 2022 7922 3a20 2822  ", "b"], "y": ("
-000237a0: 7822 2c20 5b30 2c20 315d 297d 2c0a 2020  x", [0, 1])},.  
-000237b0: 2020 2020 2020 2e2e 2e20 290a 2020 2020        ... ).    
-000237c0: 2020 2020 3e3e 3e20 6473 0a20 2020 2020      >>> ds.     
-000237d0: 2020 203c 7861 7272 6179 2e44 6174 6173     <xarray.Datas
-000237e0: 6574 3e0a 2020 2020 2020 2020 4469 6d65  et>.        Dime
-000237f0: 6e73 696f 6e73 3a20 2028 783a 2032 290a  nsions:  (x: 2).
-00023800: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
-00023810: 7465 733a 0a20 2020 2020 2020 2020 202a  tes:.          *
-00023820: 2078 2020 2020 2020 2020 2878 2920 3c55   x        (x) <U
-00023830: 3120 2761 2720 2762 270a 2020 2020 2020  1 'a' 'b'.      
-00023840: 2020 2020 2020 7920 2020 2020 2020 2028        y        (
-00023850: 7829 2069 6e74 3634 2030 2031 0a20 2020  x) int64 0 1.   
-00023860: 2020 2020 2044 6174 6120 7661 7269 6162       Data variab
-00023870: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
-00023880: 2061 2020 2020 2020 2020 2878 2920 696e   a        (x) in
-00023890: 7436 3420 3520 370a 2020 2020 2020 2020  t64 5 7.        
-000238a0: 2020 2020 6220 2020 2020 2020 2028 7829      b        (x)
-000238b0: 2066 6c6f 6174 3634 2030 2e31 2032 2e34   float64 0.1 2.4
-000238c0: 0a0a 2020 2020 2020 2020 3e3e 3e20 6473  ..        >>> ds
-000238d0: 2e73 7761 705f 6469 6d73 287b 2278 223a  .swap_dims({"x":
-000238e0: 2022 7922 7d29 0a20 2020 2020 2020 203c   "y"}).        <
-000238f0: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
-00023900: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
-00023910: 6e73 3a20 2028 793a 2032 290a 2020 2020  ns:  (y: 2).    
-00023920: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
-00023930: 0a20 2020 2020 2020 2020 2020 2078 2020  .            x  
-00023940: 2020 2020 2020 2879 2920 3c55 3120 2761        (y) <U1 'a
-00023950: 2720 2762 270a 2020 2020 2020 2020 2020  ' 'b'.          
-00023960: 2a20 7920 2020 2020 2020 2028 7929 2069  * y        (y) i
-00023970: 6e74 3634 2030 2031 0a20 2020 2020 2020  nt64 0 1.       
-00023980: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
-00023990: 0a20 2020 2020 2020 2020 2020 2061 2020  .            a  
-000239a0: 2020 2020 2020 2879 2920 696e 7436 3420        (y) int64 
-000239b0: 3520 370a 2020 2020 2020 2020 2020 2020  5 7.            
-000239c0: 6220 2020 2020 2020 2028 7929 2066 6c6f  b        (y) flo
-000239d0: 6174 3634 2030 2e31 2032 2e34 0a0a 2020  at64 0.1 2.4..  
-000239e0: 2020 2020 2020 3e3e 3e20 6473 2e73 7761        >>> ds.swa
-000239f0: 705f 6469 6d73 287b 2278 223a 2022 7a22  p_dims({"x": "z"
-00023a00: 7d29 0a20 2020 2020 2020 203c 7861 7272  }).        <xarr
-00023a10: 6179 2e44 6174 6173 6574 3e0a 2020 2020  ay.Dataset>.    
-00023a20: 2020 2020 4469 6d65 6e73 696f 6e73 3a20      Dimensions: 
-00023a30: 2028 7a3a 2032 290a 2020 2020 2020 2020   (z: 2).        
-00023a40: 436f 6f72 6469 6e61 7465 733a 0a20 2020  Coordinates:.   
-00023a50: 2020 2020 2020 2020 2078 2020 2020 2020           x      
-00023a60: 2020 287a 2920 3c55 3120 2761 2720 2762    (z) <U1 'a' 'b
-00023a70: 270a 2020 2020 2020 2020 2020 2020 7920  '.            y 
-00023a80: 2020 2020 2020 2028 7a29 2069 6e74 3634         (z) int64
-00023a90: 2030 2031 0a20 2020 2020 2020 2044 696d   0 1.        Dim
-00023aa0: 656e 7369 6f6e 7320 7769 7468 6f75 7420  ensions without 
-00023ab0: 636f 6f72 6469 6e61 7465 733a 207a 0a20  coordinates: z. 
-00023ac0: 2020 2020 2020 2044 6174 6120 7661 7269         Data vari
-00023ad0: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
-00023ae0: 2020 2061 2020 2020 2020 2020 287a 2920     a        (z) 
-00023af0: 696e 7436 3420 3520 370a 2020 2020 2020  int64 5 7.      
-00023b00: 2020 2020 2020 6220 2020 2020 2020 2028        b        (
-00023b10: 7a29 2066 6c6f 6174 3634 2030 2e31 2032  z) float64 0.1 2
-00023b20: 2e34 0a0a 2020 2020 2020 2020 5365 6520  .4..        See 
-00023b30: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-00023b40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
-00023b50: 7461 7365 742e 7265 6e61 6d65 0a20 2020  taset.rename.   
-00023b60: 2020 2020 2044 6174 6141 7272 6179 2e73       DataArray.s
-00023b70: 7761 705f 6469 6d73 0a20 2020 2020 2020  wap_dims.       
-00023b80: 2022 2222 0a20 2020 2020 2020 2023 2054   """.        # T
-00023b90: 4f44 4f3a 2064 6570 7265 6361 7465 2074  ODO: deprecate t
-00023ba0: 6869 7320 6d65 7468 6f64 2069 6e20 6661  his method in fa
-00023bb0: 766f 7220 6f66 2061 2028 6c65 7373 2063  vor of a (less c
-00023bc0: 6f6e 6675 7369 6e67 290a 2020 2020 2020  onfusing).      
-00023bd0: 2020 2320 7265 6e61 6d65 5f64 696d 7328    # rename_dims(
-00023be0: 2920 6d65 7468 6f64 2074 6861 7420 6f6e  ) method that on
-00023bf0: 6c79 2072 656e 616d 6573 2064 696d 656e  ly renames dimen
-00023c00: 7369 6f6e 732e 0a0a 2020 2020 2020 2020  sions...        
-00023c10: 6469 6d73 5f64 6963 7420 3d20 6569 7468  dims_dict = eith
-00023c20: 6572 5f64 6963 745f 6f72 5f6b 7761 7267  er_dict_or_kwarg
-00023c30: 7328 6469 6d73 5f64 6963 742c 2064 696d  s(dims_dict, dim
-00023c40: 735f 6b77 6172 6773 2c20 2273 7761 705f  s_kwargs, "swap_
-00023c50: 6469 6d73 2229 0a20 2020 2020 2020 2066  dims").        f
-00023c60: 6f72 206b 2c20 7620 696e 2064 696d 735f  or k, v in dims_
-00023c70: 6469 6374 2e69 7465 6d73 2829 3a0a 2020  dict.items():.  
-00023c80: 2020 2020 2020 2020 2020 6966 206b 206e            if k n
-00023c90: 6f74 2069 6e20 7365 6c66 2e64 696d 733a  ot in self.dims:
-00023ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00023cb0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00023cc0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00023cd0: 2020 2020 2020 2066 2263 616e 6e6f 7420         f"cannot 
-00023ce0: 7377 6170 2066 726f 6d20 6469 6d65 6e73  swap from dimens
-00023cf0: 696f 6e20 7b6b 2172 7d20 6265 6361 7573  ion {k!r} becaus
-00023d00: 6520 6974 2069 7320 220a 2020 2020 2020  e it is ".      
-00023d10: 2020 2020 2020 2020 2020 2020 2020 226e                "n
-00023d20: 6f74 2061 6e20 6578 6973 7469 6e67 2064  ot an existing d
-00023d30: 696d 656e 7369 6f6e 220a 2020 2020 2020  imension".      
-00023d40: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00023d50: 2020 2020 2020 2020 6966 2076 2069 6e20          if v in 
-00023d60: 7365 6c66 2e76 6172 6961 626c 6573 2061  self.variables a
-00023d70: 6e64 2073 656c 662e 7661 7269 6162 6c65  nd self.variable
-00023d80: 735b 765d 2e64 696d 7320 213d 2028 6b2c  s[v].dims != (k,
-00023d90: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00023da0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00023db0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-00023dc0: 2020 2020 2020 2020 2066 2272 6570 6c61           f"repla
-00023dd0: 6365 6d65 6e74 2064 696d 656e 7369 6f6e  cement dimension
-00023de0: 207b 7621 727d 2069 7320 6e6f 7420 6120   {v!r} is not a 
-00023df0: 3144 2022 0a20 2020 2020 2020 2020 2020  1D ".           
-00023e00: 2020 2020 2020 2020 2066 2276 6172 6961           f"varia
-00023e10: 626c 6520 616c 6f6e 6720 7468 6520 6f6c  ble along the ol
-00023e20: 6420 6469 6d65 6e73 696f 6e20 7b6b 2172  d dimension {k!r
-00023e30: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-00023e40: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-00023e50: 7375 6c74 5f64 696d 7320 3d20 7b64 696d  sult_dims = {dim
-00023e60: 735f 6469 6374 2e67 6574 2864 696d 2c20  s_dict.get(dim, 
-00023e70: 6469 6d29 2066 6f72 2064 696d 2069 6e20  dim) for dim in 
-00023e80: 7365 6c66 2e64 696d 737d 0a0a 2020 2020  self.dims}..    
-00023e90: 2020 2020 636f 6f72 645f 6e61 6d65 7320      coord_names 
-00023ea0: 3d20 7365 6c66 2e5f 636f 6f72 645f 6e61  = self._coord_na
-00023eb0: 6d65 732e 636f 7079 2829 0a20 2020 2020  mes.copy().     
-00023ec0: 2020 2063 6f6f 7264 5f6e 616d 6573 2e75     coord_names.u
-00023ed0: 7064 6174 6528 7b64 696d 2066 6f72 2064  pdate({dim for d
-00023ee0: 696d 2069 6e20 6469 6d73 5f64 6963 742e  im in dims_dict.
-00023ef0: 7661 6c75 6573 2829 2069 6620 6469 6d20  values() if dim 
-00023f00: 696e 2073 656c 662e 7661 7269 6162 6c65  in self.variable
-00023f10: 737d 290a 0a20 2020 2020 2020 2076 6172  s})..        var
-00023f20: 6961 626c 6573 3a20 6469 6374 5b48 6173  iables: dict[Has
-00023f30: 6861 626c 652c 2056 6172 6961 626c 655d  hable, Variable]
-00023f40: 203d 207b 7d0a 2020 2020 2020 2020 696e   = {}.        in
-00023f50: 6465 7865 733a 2064 6963 745b 4861 7368  dexes: dict[Hash
-00023f60: 6162 6c65 2c20 496e 6465 785d 203d 207b  able, Index] = {
-00023f70: 7d0a 2020 2020 2020 2020 666f 7220 6b2c  }.        for k,
-00023f80: 2076 2069 6e20 7365 6c66 2e76 6172 6961   v in self.varia
-00023f90: 626c 6573 2e69 7465 6d73 2829 3a0a 2020  bles.items():.  
-00023fa0: 2020 2020 2020 2020 2020 6469 6d73 203d            dims =
-00023fb0: 2074 7570 6c65 2864 696d 735f 6469 6374   tuple(dims_dict
-00023fc0: 2e67 6574 2864 696d 2c20 6469 6d29 2066  .get(dim, dim) f
-00023fd0: 6f72 2064 696d 2069 6e20 762e 6469 6d73  or dim in v.dims
-00023fe0: 290a 2020 2020 2020 2020 2020 2020 7661  ).            va
-00023ff0: 723a 2056 6172 6961 626c 650a 2020 2020  r: Variable.    
-00024000: 2020 2020 2020 2020 6966 206b 2069 6e20          if k in 
-00024010: 7265 7375 6c74 5f64 696d 733a 0a20 2020  result_dims:.   
-00024020: 2020 2020 2020 2020 2020 2020 2076 6172               var
-00024030: 203d 2076 2e74 6f5f 696e 6465 785f 7661   = v.to_index_va
-00024040: 7269 6162 6c65 2829 0a20 2020 2020 2020  riable().       
-00024050: 2020 2020 2020 2020 2076 6172 2e64 696d           var.dim
-00024060: 7320 3d20 6469 6d73 0a20 2020 2020 2020  s = dims.       
-00024070: 2020 2020 2020 2020 2069 6620 6b20 696e           if k in
-00024080: 2073 656c 662e 5f69 6e64 6578 6573 3a0a   self._indexes:.
-00024090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000240a0: 2020 2020 696e 6465 7865 735b 6b5d 203d      indexes[k] =
-000240b0: 2073 656c 662e 5f69 6e64 6578 6573 5b6b   self._indexes[k
-000240c0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-000240d0: 2020 2020 2020 7661 7269 6162 6c65 735b        variables[
-000240e0: 6b5d 203d 2076 6172 0a20 2020 2020 2020  k] = var.       
-000240f0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00024100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00024110: 2020 2069 6e64 6578 2c20 696e 6465 785f     index, index_
-00024120: 7661 7273 203d 2063 7265 6174 655f 6465  vars = create_de
-00024130: 6661 756c 745f 696e 6465 785f 696d 706c  fault_index_impl
-00024140: 6963 6974 2876 6172 290a 2020 2020 2020  icit(var).      
-00024150: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00024160: 6465 7865 732e 7570 6461 7465 287b 6e61  dexes.update({na
-00024170: 6d65 3a20 696e 6465 7820 666f 7220 6e61  me: index for na
-00024180: 6d65 2069 6e20 696e 6465 785f 7661 7273  me in index_vars
-00024190: 7d29 0a20 2020 2020 2020 2020 2020 2020  }).             
-000241a0: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-000241b0: 2e75 7064 6174 6528 696e 6465 785f 7661  .update(index_va
-000241c0: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
-000241d0: 2020 2020 2020 2020 636f 6f72 645f 6e61          coord_na
-000241e0: 6d65 732e 7570 6461 7465 2869 6e64 6578  mes.update(index
-000241f0: 5f76 6172 7329 0a20 2020 2020 2020 2020  _vars).         
+0001c9a0: 7b0a 2020 2020 2020 2020 2e2e 2e20 2020  {.        ...   
+0001c9b0: 2020 2020 2020 2274 656d 7065 7261 7475        "temperatu
+0001c9c0: 7265 223a 2028 0a20 2020 2020 2020 202e  re": (.        .
+0001c9d0: 2e2e 2020 2020 2020 2020 2020 2020 2022  ..             "
+0001c9e0: 7469 6d65 222c 0a20 2020 2020 2020 202e  time",.        .
+0001c9f0: 2e2e 2020 2020 2020 2020 2020 2020 205b  ..             [
+0001ca00: 3135 2e35 372c 2031 322e 3737 2c20 6e70  15.57, 12.77, np
+0001ca10: 2e6e 616e 2c20 302e 3330 3831 2c20 3136  .nan, 0.3081, 16
+0001ca20: 2e35 392c 2031 352e 3132 5d2c 0a20 2020  .59, 15.12],.   
+0001ca30: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0001ca40: 2029 2c0a 2020 2020 2020 2020 2e2e 2e20   ),.        ... 
+0001ca50: 2020 2020 2020 2020 2270 7265 7373 7572          "pressur
+0001ca60: 6522 3a20 2822 7469 6d65 222c 2035 3030  e": ("time", 500
+0001ca70: 202a 206e 702e 7261 6e64 6f6d 2e72 616e   * np.random.ran
+0001ca80: 6428 3629 292c 0a20 2020 2020 2020 202e  d(6)),.        .
+0001ca90: 2e2e 2020 2020 207d 2c0a 2020 2020 2020  ..     },.      
+0001caa0: 2020 2e2e 2e20 2020 2020 636f 6f72 6473    ...     coords
+0001cab0: 3d7b 2274 696d 6522 3a20 7064 2e64 6174  ={"time": pd.dat
+0001cac0: 655f 7261 6e67 6528 2230 312f 3031 2f32  e_range("01/01/2
+0001cad0: 3031 3922 2c20 7065 7269 6f64 733d 362c  019", periods=6,
+0001cae0: 2066 7265 713d 2244 2229 7d2c 0a20 2020   freq="D")},.   
+0001caf0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
+0001cb00: 2020 203e 3e3e 2078 320a 2020 2020 2020     >>> x2.      
+0001cb10: 2020 3c78 6172 7261 792e 4461 7461 7365    <xarray.Datase
+0001cb20: 743e 0a20 2020 2020 2020 2044 696d 656e  t>.        Dimen
+0001cb30: 7369 6f6e 733a 2020 2020 2020 2874 696d  sions:      (tim
+0001cb40: 653a 2036 290a 2020 2020 2020 2020 436f  e: 6).        Co
+0001cb50: 6f72 6469 6e61 7465 733a 0a20 2020 2020  ordinates:.     
+0001cb60: 2020 2020 202a 2074 696d 6520 2020 2020       * time     
+0001cb70: 2020 2020 2874 696d 6529 2064 6174 6574      (time) datet
+0001cb80: 696d 6536 345b 6e73 5d20 3230 3139 2d30  ime64[ns] 2019-0
+0001cb90: 312d 3031 2032 3031 392d 3031 2d30 3220  1-01 2019-01-02 
+0001cba0: 2e2e 2e20 3230 3139 2d30 312d 3036 0a20  ... 2019-01-06. 
+0001cbb0: 2020 2020 2020 2044 6174 6120 7661 7269         Data vari
+0001cbc0: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
+0001cbd0: 2020 2074 656d 7065 7261 7475 7265 2020     temperature  
+0001cbe0: 2874 696d 6529 2066 6c6f 6174 3634 2031  (time) float64 1
+0001cbf0: 352e 3537 2031 322e 3737 206e 616e 2030  5.57 12.77 nan 0
+0001cc00: 2e33 3038 3120 3136 2e35 3920 3135 2e31  .3081 16.59 15.1
+0001cc10: 320a 2020 2020 2020 2020 2020 2020 7072  2.            pr
+0001cc20: 6573 7375 7265 2020 2020 2028 7469 6d65  essure     (time
+0001cc30: 2920 666c 6f61 7436 3420 3438 312e 3820  ) float64 481.8 
+0001cc40: 3139 312e 3720 3339 352e 3920 3236 342e  191.7 395.9 264.
+0001cc50: 3420 3238 342e 3020 3436 322e 380a 0a20  4 284.0 462.8.. 
+0001cc60: 2020 2020 2020 2053 7570 706f 7365 2077         Suppose w
+0001cc70: 6520 6465 6369 6465 2074 6f20 6578 7061  e decide to expa
+0001cc80: 6e64 2074 6865 2064 6174 6173 6574 2074  nd the dataset t
+0001cc90: 6f20 636f 7665 7220 6120 7769 6465 7220  o cover a wider 
+0001cca0: 6461 7465 2072 616e 6765 2e0a 0a20 2020  date range...   
+0001ccb0: 2020 2020 203e 3e3e 2074 696d 655f 696e       >>> time_in
+0001ccc0: 6465 7832 203d 2070 642e 6461 7465 5f72  dex2 = pd.date_r
+0001ccd0: 616e 6765 2822 3132 2f32 392f 3230 3138  ange("12/29/2018
+0001cce0: 222c 2070 6572 696f 6473 3d31 302c 2066  ", periods=10, f
+0001ccf0: 7265 713d 2244 2229 0a20 2020 2020 2020  req="D").       
+0001cd00: 203e 3e3e 2078 322e 7265 696e 6465 7828   >>> x2.reindex(
+0001cd10: 7b22 7469 6d65 223a 2074 696d 655f 696e  {"time": time_in
+0001cd20: 6465 7832 7d29 0a20 2020 2020 2020 203c  dex2}).        <
+0001cd30: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
+0001cd40: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+0001cd50: 6e73 3a20 2020 2020 2028 7469 6d65 3a20  ns:      (time: 
+0001cd60: 3130 290a 2020 2020 2020 2020 436f 6f72  10).        Coor
+0001cd70: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
+0001cd80: 2020 202a 2074 696d 6520 2020 2020 2020     * time       
+0001cd90: 2020 2874 696d 6529 2064 6174 6574 696d    (time) datetim
+0001cda0: 6536 345b 6e73 5d20 3230 3138 2d31 322d  e64[ns] 2018-12-
+0001cdb0: 3239 2032 3031 382d 3132 2d33 3020 2e2e  29 2018-12-30 ..
+0001cdc0: 2e20 3230 3139 2d30 312d 3037 0a20 2020  . 2019-01-07.   
+0001cdd0: 2020 2020 2044 6174 6120 7661 7269 6162       Data variab
+0001cde0: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
+0001cdf0: 2074 656d 7065 7261 7475 7265 2020 2874   temperature  (t
+0001ce00: 696d 6529 2066 6c6f 6174 3634 206e 616e  ime) float64 nan
+0001ce10: 206e 616e 206e 616e 2031 352e 3537 202e   nan nan 15.57 .
+0001ce20: 2e2e 2030 2e33 3038 3120 3136 2e35 3920  .. 0.3081 16.59 
+0001ce30: 3135 2e31 3220 6e61 6e0a 2020 2020 2020  15.12 nan.      
+0001ce40: 2020 2020 2020 7072 6573 7375 7265 2020        pressure  
+0001ce50: 2020 2028 7469 6d65 2920 666c 6f61 7436     (time) float6
+0001ce60: 3420 6e61 6e20 6e61 6e20 6e61 6e20 3438  4 nan nan nan 48
+0001ce70: 312e 3820 2e2e 2e20 3236 342e 3420 3238  1.8 ... 264.4 28
+0001ce80: 342e 3020 3436 322e 3820 6e61 6e0a 0a20  4.0 462.8 nan.. 
+0001ce90: 2020 2020 2020 2054 6865 2069 6e64 6578         The index
+0001cea0: 2065 6e74 7269 6573 2074 6861 7420 6469   entries that di
+0001ceb0: 6420 6e6f 7420 6861 7665 2061 2076 616c  d not have a val
+0001cec0: 7565 2069 6e20 7468 6520 6f72 6967 696e  ue in the origin
+0001ced0: 616c 2064 6174 6120 6672 616d 6520 2866  al data frame (f
+0001cee0: 6f72 2065 7861 6d70 6c65 2c20 6032 3031  or example, `201
+0001cef0: 382d 3132 2d32 3960 290a 2020 2020 2020  8-12-29`).      
+0001cf00: 2020 6172 6520 6279 2064 6566 6175 6c74    are by default
+0001cf10: 2066 696c 6c65 6420 7769 7468 204e 614e   filled with NaN
+0001cf20: 2e20 4966 2064 6573 6972 6564 2c20 7765  . If desired, we
+0001cf30: 2063 616e 2066 696c 6c20 696e 2074 6865   can fill in the
+0001cf40: 206d 6973 7369 6e67 2076 616c 7565 7320   missing values 
+0001cf50: 7573 696e 6720 6f6e 6520 6f66 2073 6576  using one of sev
+0001cf60: 6572 616c 206f 7074 696f 6e73 2e0a 0a20  eral options... 
+0001cf70: 2020 2020 2020 2046 6f72 2065 7861 6d70         For examp
+0001cf80: 6c65 2c20 746f 2062 6163 6b2d 7072 6f70  le, to back-prop
+0001cf90: 6167 6174 6520 7468 6520 6c61 7374 2076  agate the last v
+0001cfa0: 616c 6964 2076 616c 7565 2074 6f20 6669  alid value to fi
+0001cfb0: 6c6c 2074 6865 2060 4e61 4e60 2076 616c  ll the `NaN` val
+0001cfc0: 7565 732c 0a20 2020 2020 2020 2070 6173  ues,.        pas
+0001cfd0: 7320 6062 6669 6c6c 6020 6173 2061 6e20  s `bfill` as an 
+0001cfe0: 6172 6775 6d65 6e74 2074 6f20 7468 6520  argument to the 
+0001cff0: 606d 6574 686f 6460 206b 6579 776f 7264  `method` keyword
+0001d000: 2e0a 0a20 2020 2020 2020 203e 3e3e 2078  ...        >>> x
+0001d010: 3320 3d20 7832 2e72 6569 6e64 6578 287b  3 = x2.reindex({
+0001d020: 2274 696d 6522 3a20 7469 6d65 5f69 6e64  "time": time_ind
+0001d030: 6578 327d 2c20 6d65 7468 6f64 3d22 6266  ex2}, method="bf
+0001d040: 696c 6c22 290a 2020 2020 2020 2020 3e3e  ill").        >>
+0001d050: 3e20 7833 0a20 2020 2020 2020 203c 7861  > x3.        <xa
+0001d060: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
+0001d070: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
+0001d080: 3a20 2020 2020 2028 7469 6d65 3a20 3130  :      (time: 10
+0001d090: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
+0001d0a0: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
+0001d0b0: 202a 2074 696d 6520 2020 2020 2020 2020   * time         
+0001d0c0: 2874 696d 6529 2064 6174 6574 696d 6536  (time) datetime6
+0001d0d0: 345b 6e73 5d20 3230 3138 2d31 322d 3239  4[ns] 2018-12-29
+0001d0e0: 2032 3031 382d 3132 2d33 3020 2e2e 2e20   2018-12-30 ... 
+0001d0f0: 3230 3139 2d30 312d 3037 0a20 2020 2020  2019-01-07.     
+0001d100: 2020 2044 6174 6120 7661 7269 6162 6c65     Data variable
+0001d110: 733a 0a20 2020 2020 2020 2020 2020 2074  s:.            t
+0001d120: 656d 7065 7261 7475 7265 2020 2874 696d  emperature  (tim
+0001d130: 6529 2066 6c6f 6174 3634 2031 352e 3537  e) float64 15.57
+0001d140: 2031 352e 3537 2031 352e 3537 2031 352e   15.57 15.57 15.
+0001d150: 3537 202e 2e2e 2031 362e 3539 2031 352e  57 ... 16.59 15.
+0001d160: 3132 206e 616e 0a20 2020 2020 2020 2020  12 nan.         
+0001d170: 2020 2070 7265 7373 7572 6520 2020 2020     pressure     
+0001d180: 2874 696d 6529 2066 6c6f 6174 3634 2034  (time) float64 4
+0001d190: 3831 2e38 2034 3831 2e38 2034 3831 2e38  81.8 481.8 481.8
+0001d1a0: 2034 3831 2e38 202e 2e2e 2032 3834 2e30   481.8 ... 284.0
+0001d1b0: 2034 3632 2e38 206e 616e 0a0a 2020 2020   462.8 nan..    
+0001d1c0: 2020 2020 506c 6561 7365 206e 6f74 6520      Please note 
+0001d1d0: 7468 6174 2074 6865 2060 4e61 4e60 2076  that the `NaN` v
+0001d1e0: 616c 7565 2070 7265 7365 6e74 2069 6e20  alue present in 
+0001d1f0: 7468 6520 6f72 6967 696e 616c 2064 6174  the original dat
+0001d200: 6173 6574 2028 6174 2069 6e64 6578 2076  aset (at index v
+0001d210: 616c 7565 2060 3230 3139 2d30 312d 3033  alue `2019-01-03
+0001d220: 6029 0a20 2020 2020 2020 2077 696c 6c20  `).        will 
+0001d230: 6e6f 7420 6265 2066 696c 6c65 6420 6279  not be filled by
+0001d240: 2061 6e79 206f 6620 7468 6520 7661 6c75   any of the valu
+0001d250: 6520 7072 6f70 6167 6174 696f 6e20 7363  e propagation sc
+0001d260: 6865 6d65 732e 0a0a 2020 2020 2020 2020  hemes...        
+0001d270: 3e3e 3e20 7832 2e77 6865 7265 2878 322e  >>> x2.where(x2.
+0001d280: 7465 6d70 6572 6174 7572 652e 6973 6e75  temperature.isnu
+0001d290: 6c6c 2829 2c20 6472 6f70 3d54 7275 6529  ll(), drop=True)
+0001d2a0: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
+0001d2b0: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
+0001d2c0: 2020 4469 6d65 6e73 696f 6e73 3a20 2020    Dimensions:   
+0001d2d0: 2020 2028 7469 6d65 3a20 3129 0a20 2020     (time: 1).   
+0001d2e0: 2020 2020 2043 6f6f 7264 696e 6174 6573       Coordinates
+0001d2f0: 3a0a 2020 2020 2020 2020 2020 2a20 7469  :.          * ti
+0001d300: 6d65 2020 2020 2020 2020 2028 7469 6d65  me         (time
+0001d310: 2920 6461 7465 7469 6d65 3634 5b6e 735d  ) datetime64[ns]
+0001d320: 2032 3031 392d 3031 2d30 330a 2020 2020   2019-01-03.    
+0001d330: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
+0001d340: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0001d350: 7465 6d70 6572 6174 7572 6520 2028 7469  temperature  (ti
+0001d360: 6d65 2920 666c 6f61 7436 3420 6e61 6e0a  me) float64 nan.
+0001d370: 2020 2020 2020 2020 2020 2020 7072 6573              pres
+0001d380: 7375 7265 2020 2020 2028 7469 6d65 2920  sure     (time) 
+0001d390: 666c 6f61 7436 3420 3339 352e 390a 2020  float64 395.9.  
+0001d3a0: 2020 2020 2020 3e3e 3e20 7833 2e77 6865        >>> x3.whe
+0001d3b0: 7265 2878 332e 7465 6d70 6572 6174 7572  re(x3.temperatur
+0001d3c0: 652e 6973 6e75 6c6c 2829 2c20 6472 6f70  e.isnull(), drop
+0001d3d0: 3d54 7275 6529 0a20 2020 2020 2020 203c  =True).        <
+0001d3e0: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
+0001d3f0: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+0001d400: 6e73 3a20 2020 2020 2028 7469 6d65 3a20  ns:      (time: 
+0001d410: 3229 0a20 2020 2020 2020 2043 6f6f 7264  2).        Coord
+0001d420: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
+0001d430: 2020 2a20 7469 6d65 2020 2020 2020 2020    * time        
+0001d440: 2028 7469 6d65 2920 6461 7465 7469 6d65   (time) datetime
+0001d450: 3634 5b6e 735d 2032 3031 392d 3031 2d30  64[ns] 2019-01-0
+0001d460: 3320 3230 3139 2d30 312d 3037 0a20 2020  3 2019-01-07.   
+0001d470: 2020 2020 2044 6174 6120 7661 7269 6162       Data variab
+0001d480: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
+0001d490: 2074 656d 7065 7261 7475 7265 2020 2874   temperature  (t
+0001d4a0: 696d 6529 2066 6c6f 6174 3634 206e 616e  ime) float64 nan
+0001d4b0: 206e 616e 0a20 2020 2020 2020 2020 2020   nan.           
+0001d4c0: 2070 7265 7373 7572 6520 2020 2020 2874   pressure     (t
+0001d4d0: 696d 6529 2066 6c6f 6174 3634 2033 3935  ime) float64 395
+0001d4e0: 2e39 206e 616e 0a0a 2020 2020 2020 2020  .9 nan..        
+0001d4f0: 5468 6973 2069 7320 6265 6361 7573 6520  This is because 
+0001d500: 6669 6c6c 696e 6720 7768 696c 6520 7265  filling while re
+0001d510: 696e 6465 7869 6e67 2064 6f65 7320 6e6f  indexing does no
+0001d520: 7420 6c6f 6f6b 2061 7420 6461 7461 7365  t look at datase
+0001d530: 7420 7661 6c75 6573 2c20 6275 7420 6f6e  t values, but on
+0001d540: 6c79 2063 6f6d 7061 7265 730a 2020 2020  ly compares.    
+0001d550: 2020 2020 7468 6520 6f72 6967 696e 616c      the original
+0001d560: 2061 6e64 2064 6573 6972 6564 2069 6e64   and desired ind
+0001d570: 6578 6573 2e20 4966 2079 6f75 2064 6f20  exes. If you do 
+0001d580: 7761 6e74 2074 6f20 6669 6c6c 2069 6e20  want to fill in 
+0001d590: 7468 6520 604e 614e 6020 7661 6c75 6573  the `NaN` values
+0001d5a0: 2070 7265 7365 6e74 2069 6e20 7468 650a   present in the.
+0001d5b0: 2020 2020 2020 2020 6f72 6967 696e 616c          original
+0001d5c0: 2064 6174 6173 6574 2c20 7573 6520 7468   dataset, use th
+0001d5d0: 6520 3a70 793a 6d65 7468 3a60 7e44 6174  e :py:meth:`~Dat
+0001d5e0: 6173 6574 2e66 696c 6c6e 6128 2960 206d  aset.fillna()` m
+0001d5f0: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
+0001d600: 2222 220a 2020 2020 2020 2020 696e 6465  """.        inde
+0001d610: 7865 7273 203d 2075 7469 6c73 2e65 6974  xers = utils.eit
+0001d620: 6865 725f 6469 6374 5f6f 725f 6b77 6172  her_dict_or_kwar
+0001d630: 6773 2869 6e64 6578 6572 732c 2069 6e64  gs(indexers, ind
+0001d640: 6578 6572 735f 6b77 6172 6773 2c20 2272  exers_kwargs, "r
+0001d650: 6569 6e64 6578 2229 0a20 2020 2020 2020  eindex").       
+0001d660: 2072 6574 7572 6e20 616c 6967 6e6d 656e   return alignmen
+0001d670: 742e 7265 696e 6465 7828 0a20 2020 2020  t.reindex(.     
+0001d680: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001d690: 2020 2020 2020 2020 2069 6e64 6578 6572           indexer
+0001d6a0: 733d 696e 6465 7865 7273 2c0a 2020 2020  s=indexers,.    
+0001d6b0: 2020 2020 2020 2020 6d65 7468 6f64 3d6d          method=m
+0001d6c0: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
+0001d6d0: 2020 2074 6f6c 6572 616e 6365 3d74 6f6c     tolerance=tol
+0001d6e0: 6572 616e 6365 2c0a 2020 2020 2020 2020  erance,.        
+0001d6f0: 2020 2020 636f 7079 3d63 6f70 792c 0a20      copy=copy,. 
+0001d700: 2020 2020 2020 2020 2020 2066 696c 6c5f             fill_
+0001d710: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
+0001d720: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+0001d730: 2064 6566 205f 7265 696e 6465 7828 0a20   def _reindex(. 
+0001d740: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
+0001d750: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
+0001d760: 696e 6465 7865 7273 3a20 4d61 7070 696e  indexers: Mappin
+0001d770: 675b 416e 792c 2041 6e79 5d20 7c20 4e6f  g[Any, Any] | No
+0001d780: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+0001d790: 2020 206d 6574 686f 643a 2073 7472 207c     method: str |
+0001d7a0: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+0001d7b0: 2020 2020 2020 746f 6c65 7261 6e63 653a        tolerance:
+0001d7c0: 2069 6e74 207c 2066 6c6f 6174 207c 2049   int | float | I
+0001d7d0: 7465 7261 626c 655b 696e 7420 7c20 666c  terable[int | fl
+0001d7e0: 6f61 745d 207c 204e 6f6e 6520 3d20 4e6f  oat] | None = No
+0001d7f0: 6e65 2c0a 2020 2020 2020 2020 636f 7079  ne,.        copy
+0001d800: 3a20 626f 6f6c 203d 2054 7275 652c 0a20  : bool = True,. 
+0001d810: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
+0001d820: 653a 2041 6e79 203d 2078 7264 7479 7065  e: Any = xrdtype
+0001d830: 732e 4e41 2c0a 2020 2020 2020 2020 7370  s.NA,.        sp
+0001d840: 6172 7365 3a20 626f 6f6c 203d 2046 616c  arse: bool = Fal
+0001d850: 7365 2c0a 2020 2020 2020 2020 2a2a 696e  se,.        **in
+0001d860: 6465 7865 7273 5f6b 7761 7267 733a 2041  dexers_kwargs: A
+0001d870: 6e79 2c0a 2020 2020 2920 2d3e 2054 5f44  ny,.    ) -> T_D
+0001d880: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+0001d890: 2222 220a 2020 2020 2020 2020 5361 6d65  """.        Same
+0001d8a0: 2061 7320 7265 696e 6465 7820 6275 7420   as reindex but 
+0001d8b0: 7375 7070 6f72 7473 2073 7061 7273 6520  supports sparse 
+0001d8c0: 6f70 7469 6f6e 2e0a 2020 2020 2020 2020  option..        
+0001d8d0: 2222 220a 2020 2020 2020 2020 696e 6465  """.        inde
+0001d8e0: 7865 7273 203d 2075 7469 6c73 2e65 6974  xers = utils.eit
+0001d8f0: 6865 725f 6469 6374 5f6f 725f 6b77 6172  her_dict_or_kwar
+0001d900: 6773 2869 6e64 6578 6572 732c 2069 6e64  gs(indexers, ind
+0001d910: 6578 6572 735f 6b77 6172 6773 2c20 2272  exers_kwargs, "r
+0001d920: 6569 6e64 6578 2229 0a20 2020 2020 2020  eindex").       
+0001d930: 2072 6574 7572 6e20 616c 6967 6e6d 656e   return alignmen
+0001d940: 742e 7265 696e 6465 7828 0a20 2020 2020  t.reindex(.     
+0001d950: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001d960: 2020 2020 2020 2020 2069 6e64 6578 6572           indexer
+0001d970: 733d 696e 6465 7865 7273 2c0a 2020 2020  s=indexers,.    
+0001d980: 2020 2020 2020 2020 6d65 7468 6f64 3d6d          method=m
+0001d990: 6574 686f 642c 0a20 2020 2020 2020 2020  ethod,.         
+0001d9a0: 2020 2074 6f6c 6572 616e 6365 3d74 6f6c     tolerance=tol
+0001d9b0: 6572 616e 6365 2c0a 2020 2020 2020 2020  erance,.        
+0001d9c0: 2020 2020 636f 7079 3d63 6f70 792c 0a20      copy=copy,. 
+0001d9d0: 2020 2020 2020 2020 2020 2066 696c 6c5f             fill_
+0001d9e0: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
+0001d9f0: 2c0a 2020 2020 2020 2020 2020 2020 7370  ,.            sp
+0001da00: 6172 7365 3d73 7061 7273 652c 0a20 2020  arse=sparse,.   
+0001da10: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+0001da20: 696e 7465 7270 280a 2020 2020 2020 2020  interp(.        
+0001da30: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+0001da40: 0a20 2020 2020 2020 2063 6f6f 7264 733a  .        coords:
+0001da50: 204d 6170 7069 6e67 5b41 6e79 2c20 416e   Mapping[Any, An
+0001da60: 795d 207c 204e 6f6e 6520 3d20 4e6f 6e65  y] | None = None
+0001da70: 2c0a 2020 2020 2020 2020 6d65 7468 6f64  ,.        method
+0001da80: 3a20 496e 7465 7270 4f70 7469 6f6e 7320  : InterpOptions 
+0001da90: 3d20 226c 696e 6561 7222 2c0a 2020 2020  = "linear",.    
+0001daa0: 2020 2020 6173 7375 6d65 5f73 6f72 7465      assume_sorte
+0001dab0: 643a 2062 6f6f 6c20 3d20 4661 6c73 652c  d: bool = False,
+0001dac0: 0a20 2020 2020 2020 206b 7761 7267 733a  .        kwargs:
+0001dad0: 204d 6170 7069 6e67 5b73 7472 2c20 416e   Mapping[str, An
+0001dae0: 795d 207c 204e 6f6e 6520 3d20 4e6f 6e65  y] | None = None
+0001daf0: 2c0a 2020 2020 2020 2020 6d65 7468 6f64  ,.        method
+0001db00: 5f6e 6f6e 5f6e 756d 6572 6963 3a20 7374  _non_numeric: st
+0001db10: 7220 3d20 226e 6561 7265 7374 222c 0a20  r = "nearest",. 
+0001db20: 2020 2020 2020 202a 2a63 6f6f 7264 735f         **coords_
+0001db30: 6b77 6172 6773 3a20 416e 792c 0a20 2020  kwargs: Any,.   
+0001db40: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
+0001db50: 0a20 2020 2020 2020 2022 2222 496e 7465  .        """Inte
+0001db60: 7270 6f6c 6174 6520 6120 4461 7461 7365  rpolate a Datase
+0001db70: 7420 6f6e 746f 206e 6577 2063 6f6f 7264  t onto new coord
+0001db80: 696e 6174 6573 0a0a 2020 2020 2020 2020  inates..        
+0001db90: 5065 7266 6f72 6d73 2075 6e69 7661 7269  Performs univari
+0001dba0: 6174 6520 6f72 206d 756c 7469 7661 7269  ate or multivari
+0001dbb0: 6174 6520 696e 7465 7270 6f6c 6174 696f  ate interpolatio
+0001dbc0: 6e20 6f66 2061 2044 6174 6173 6574 206f  n of a Dataset o
+0001dbd0: 6e74 6f0a 2020 2020 2020 2020 6e65 7720  nto.        new 
+0001dbe0: 636f 6f72 6469 6e61 7465 7320 7573 696e  coordinates usin
+0001dbf0: 6720 7363 6970 7927 7320 696e 7465 7270  g scipy's interp
+0001dc00: 6f6c 6174 696f 6e20 726f 7574 696e 6573  olation routines
+0001dc10: 2e20 4966 2069 6e74 6572 706f 6c61 7469  . If interpolati
+0001dc20: 6e67 0a20 2020 2020 2020 2061 6c6f 6e67  ng.        along
+0001dc30: 2061 6e20 6578 6973 7469 6e67 2064 696d   an existing dim
+0001dc40: 656e 7369 6f6e 2c20 3a70 793a 636c 6173  ension, :py:clas
+0001dc50: 733a 6073 6369 7079 2e69 6e74 6572 706f  s:`scipy.interpo
+0001dc60: 6c61 7465 2e69 6e74 6572 7031 6460 2069  late.interp1d` i
+0001dc70: 730a 2020 2020 2020 2020 6361 6c6c 6564  s.        called
+0001dc80: 2e20 2057 6865 6e20 696e 7465 7270 6f6c  .  When interpol
+0001dc90: 6174 696e 6720 616c 6f6e 6720 6d75 6c74  ating along mult
+0001dca0: 6970 6c65 2065 7869 7374 696e 6720 6469  iple existing di
+0001dcb0: 6d65 6e73 696f 6e73 2c20 616e 0a20 2020  mensions, an.   
+0001dcc0: 2020 2020 2061 7474 656d 7074 2069 7320       attempt is 
+0001dcd0: 6d61 6465 2074 6f20 6465 636f 6d70 6f73  made to decompos
+0001dce0: 6520 7468 6520 696e 7465 7270 6f6c 6174  e the interpolat
+0001dcf0: 696f 6e20 696e 746f 206d 756c 7469 706c  ion into multipl
+0001dd00: 650a 2020 2020 2020 2020 312d 6469 6d65  e.        1-dime
+0001dd10: 6e73 696f 6e61 6c20 696e 7465 7270 6f6c  nsional interpol
+0001dd20: 6174 696f 6e73 2e20 4966 2074 6869 7320  ations. If this 
+0001dd30: 6973 2070 6f73 7369 626c 652c 0a20 2020  is possible,.   
+0001dd40: 2020 2020 203a 7079 3a63 6c61 7373 3a60       :py:class:`
+0001dd50: 7363 6970 792e 696e 7465 7270 6f6c 6174  scipy.interpolat
+0001dd60: 652e 696e 7465 7270 3164 6020 6973 2063  e.interp1d` is c
+0001dd70: 616c 6c65 642e 204f 7468 6572 7769 7365  alled. Otherwise
+0001dd80: 2c0a 2020 2020 2020 2020 3a70 793a 6675  ,.        :py:fu
+0001dd90: 6e63 3a60 7363 6970 792e 696e 7465 7270  nc:`scipy.interp
+0001dda0: 6f6c 6174 652e 696e 7465 7270 6e60 2069  olate.interpn` i
+0001ddb0: 7320 6361 6c6c 6564 2e0a 0a20 2020 2020  s called...     
+0001ddc0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+0001ddd0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001dde0: 0a20 2020 2020 2020 2063 6f6f 7264 7320  .        coords 
+0001ddf0: 3a20 6469 6374 2c20 6f70 7469 6f6e 616c  : dict, optional
+0001de00: 0a20 2020 2020 2020 2020 2020 204d 6170  .            Map
+0001de10: 7069 6e67 2066 726f 6d20 6469 6d65 6e73  ping from dimens
+0001de20: 696f 6e20 6e61 6d65 7320 746f 2074 6865  ion names to the
+0001de30: 206e 6577 2063 6f6f 7264 696e 6174 6573   new coordinates
+0001de40: 2e0a 2020 2020 2020 2020 2020 2020 4e65  ..            Ne
+0001de50: 7720 636f 6f72 6469 6e61 7465 2063 616e  w coordinate can
+0001de60: 2062 6520 6120 7363 616c 6172 2c20 6172   be a scalar, ar
+0001de70: 7261 792d 6c69 6b65 206f 7220 4461 7461  ray-like or Data
+0001de80: 4172 7261 792e 0a20 2020 2020 2020 2020  Array..         
+0001de90: 2020 2049 6620 4461 7461 4172 7261 7973     If DataArrays
+0001dea0: 2061 7265 2070 6173 7365 6420 6173 206e   are passed as n
+0001deb0: 6577 2063 6f6f 7264 696e 6174 6573 2c20  ew coordinates, 
+0001dec0: 7468 6569 7220 6469 6d65 6e73 696f 6e73  their dimensions
+0001ded0: 2061 7265 0a20 2020 2020 2020 2020 2020   are.           
+0001dee0: 2075 7365 6420 666f 7220 7468 6520 6272   used for the br
+0001def0: 6f61 6463 6173 7469 6e67 2e20 4d69 7373  oadcasting. Miss
+0001df00: 696e 6720 7661 6c75 6573 2061 7265 2073  ing values are s
+0001df10: 6b69 7070 6564 2e0a 2020 2020 2020 2020  kipped..        
+0001df20: 6d65 7468 6f64 203a 207b 226c 696e 6561  method : {"linea
+0001df30: 7222 2c20 226e 6561 7265 7374 222c 2022  r", "nearest", "
+0001df40: 7a65 726f 222c 2022 736c 696e 6561 7222  zero", "slinear"
+0001df50: 2c20 2271 7561 6472 6174 6963 222c 2022  , "quadratic", "
+0001df60: 6375 6269 6322 2c20 2270 6f6c 796e 6f6d  cubic", "polynom
+0001df70: 6961 6c22 2c20 5c0a 2020 2020 2020 2020  ial", \.        
+0001df80: 2020 2020 2262 6172 7963 656e 7472 6963      "barycentric
+0001df90: 222c 2022 6b72 6f67 222c 2022 7063 6869  ", "krog", "pchi
+0001dfa0: 7022 2c20 2273 706c 696e 6522 2c20 2261  p", "spline", "a
+0001dfb0: 6b69 6d61 227d 2c20 6465 6661 756c 743a  kima"}, default:
+0001dfc0: 2022 6c69 6e65 6172 220a 2020 2020 2020   "linear".      
+0001dfd0: 2020 2020 2020 5374 7269 6e67 2069 6e64        String ind
+0001dfe0: 6963 6174 696e 6720 7768 6963 6820 6d65  icating which me
+0001dff0: 7468 6f64 2074 6f20 7573 6520 666f 7220  thod to use for 
+0001e000: 696e 7465 7270 6f6c 6174 696f 6e3a 0a0a  interpolation:..
+0001e010: 2020 2020 2020 2020 2020 2020 2d20 276c              - 'l
+0001e020: 696e 6561 7227 3a20 6c69 6e65 6172 2069  inear': linear i
+0001e030: 6e74 6572 706f 6c61 7469 6f6e 2e20 4164  nterpolation. Ad
+0001e040: 6469 7469 6f6e 616c 206b 6579 776f 7264  ditional keyword
+0001e050: 0a20 2020 2020 2020 2020 2020 2020 2061  .              a
+0001e060: 7267 756d 656e 7473 2061 7265 2070 6173  rguments are pas
+0001e070: 7365 6420 746f 203a 7079 3a66 756e 633a  sed to :py:func:
+0001e080: 606e 756d 7079 2e69 6e74 6572 7060 0a20  `numpy.interp`. 
+0001e090: 2020 2020 2020 2020 2020 202d 2027 6e65             - 'ne
+0001e0a0: 6172 6573 7427 2c20 277a 6572 6f27 2c20  arest', 'zero', 
+0001e0b0: 2773 6c69 6e65 6172 272c 2027 7175 6164  'slinear', 'quad
+0001e0c0: 7261 7469 6327 2c20 2763 7562 6963 272c  ratic', 'cubic',
+0001e0d0: 2027 706f 6c79 6e6f 6d69 616c 273a 0a20   'polynomial':. 
+0001e0e0: 2020 2020 2020 2020 2020 2020 2061 7265               are
+0001e0f0: 2070 6173 7365 6420 746f 203a 7079 3a66   passed to :py:f
+0001e100: 756e 633a 6073 6369 7079 2e69 6e74 6572  unc:`scipy.inter
+0001e110: 706f 6c61 7465 2e69 6e74 6572 7031 6460  polate.interp1d`
+0001e120: 2e20 4966 0a20 2020 2020 2020 2020 2020  . If.           
+0001e130: 2020 2060 606d 6574 686f 643d 2770 6f6c     ``method='pol
+0001e140: 796e 6f6d 6961 6c27 6060 2c20 7468 6520  ynomial'``, the 
+0001e150: 6060 6f72 6465 7260 6020 6b65 7977 6f72  ``order`` keywor
+0001e160: 6420 6172 6775 6d65 6e74 206d 7573 7420  d argument must 
+0001e170: 616c 736f 2062 650a 2020 2020 2020 2020  also be.        
+0001e180: 2020 2020 2020 7072 6f76 6964 6564 2e0a        provided..
+0001e190: 2020 2020 2020 2020 2020 2020 2d20 2762              - 'b
+0001e1a0: 6172 7963 656e 7472 6963 272c 2027 6b72  arycentric', 'kr
+0001e1b0: 6f67 272c 2027 7063 6869 7027 2c20 2773  og', 'pchip', 's
+0001e1c0: 706c 696e 6527 2c20 2761 6b69 6d61 273a  pline', 'akima':
+0001e1d0: 2075 7365 2074 6865 6972 0a20 2020 2020   use their.     
+0001e1e0: 2020 2020 2020 2020 2072 6573 7065 6374           respect
+0001e1f0: 6976 6520 3a70 793a 636c 6173 733a 6073  ive :py:class:`s
+0001e200: 6369 7079 2e69 6e74 6572 706f 6c61 7465  cipy.interpolate
+0001e210: 6020 636c 6173 7365 732e 0a0a 2020 2020  ` classes...    
+0001e220: 2020 2020 6173 7375 6d65 5f73 6f72 7465      assume_sorte
+0001e230: 6420 3a20 626f 6f6c 2c20 6465 6661 756c  d : bool, defaul
+0001e240: 743a 2046 616c 7365 0a20 2020 2020 2020  t: False.       
+0001e250: 2020 2020 2049 6620 4661 6c73 652c 2076       If False, v
+0001e260: 616c 7565 7320 6f66 2063 6f6f 7264 696e  alues of coordin
+0001e270: 6174 6573 2074 6861 7420 6172 6520 696e  ates that are in
+0001e280: 7465 7270 6f6c 6174 6564 206f 7665 7220  terpolated over 
+0001e290: 6361 6e20 6265 0a20 2020 2020 2020 2020  can be.         
+0001e2a0: 2020 2069 6e20 616e 7920 6f72 6465 7220     in any order 
+0001e2b0: 616e 6420 7468 6579 2061 7265 2073 6f72  and they are sor
+0001e2c0: 7465 6420 6669 7273 742e 2049 6620 5472  ted first. If Tr
+0001e2d0: 7565 2c20 696e 7465 7270 6f6c 6174 6564  ue, interpolated
+0001e2e0: 0a20 2020 2020 2020 2020 2020 2063 6f6f  .            coo
+0001e2f0: 7264 696e 6174 6573 2061 7265 2061 7373  rdinates are ass
+0001e300: 756d 6564 2074 6f20 6265 2061 6e20 6172  umed to be an ar
+0001e310: 7261 7920 6f66 206d 6f6e 6f74 6f6e 6963  ray of monotonic
+0001e320: 616c 6c79 2069 6e63 7265 6173 696e 670a  ally increasing.
+0001e330: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0001e340: 6573 2e0a 2020 2020 2020 2020 6b77 6172  es..        kwar
+0001e350: 6773 203a 2064 6963 742c 206f 7074 696f  gs : dict, optio
+0001e360: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0001e370: 4164 6469 7469 6f6e 616c 206b 6579 776f  Additional keywo
+0001e380: 7264 2061 7267 756d 656e 7473 2070 6173  rd arguments pas
+0001e390: 7365 6420 746f 2073 6369 7079 2773 2069  sed to scipy's i
+0001e3a0: 6e74 6572 706f 6c61 746f 722e 2056 616c  nterpolator. Val
+0001e3b0: 6964 0a20 2020 2020 2020 2020 2020 206f  id.            o
+0001e3c0: 7074 696f 6e73 2061 6e64 2074 6865 6972  ptions and their
+0001e3d0: 2062 6568 6176 696f 7220 6465 7065 6e64   behavior depend
+0001e3e0: 2077 6865 7468 6572 2060 6069 6e74 6572   whether ``inter
+0001e3f0: 7031 6460 6020 6f72 0a20 2020 2020 2020  p1d`` or.       
+0001e400: 2020 2020 2060 6069 6e74 6572 706e 6060       ``interpn``
+0001e410: 2069 7320 7573 6564 2e0a 2020 2020 2020   is used..      
+0001e420: 2020 6d65 7468 6f64 5f6e 6f6e 5f6e 756d    method_non_num
+0001e430: 6572 6963 203a 207b 226e 6561 7265 7374  eric : {"nearest
+0001e440: 222c 2022 7061 6422 2c20 2266 6669 6c6c  ", "pad", "ffill
+0001e450: 222c 2022 6261 636b 6669 6c6c 222c 2022  ", "backfill", "
+0001e460: 6266 696c 6c22 7d2c 206f 7074 696f 6e61  bfill"}, optiona
+0001e470: 6c0a 2020 2020 2020 2020 2020 2020 4d65  l.            Me
+0001e480: 7468 6f64 2066 6f72 206e 6f6e 2d6e 756d  thod for non-num
+0001e490: 6572 6963 2074 7970 6573 2e20 5061 7373  eric types. Pass
+0001e4a0: 6564 206f 6e20 746f 203a 7079 3a6d 6574  ed on to :py:met
+0001e4b0: 683a 6044 6174 6173 6574 2e72 6569 6e64  h:`Dataset.reind
+0001e4c0: 6578 602e 0a20 2020 2020 2020 2020 2020  ex`..           
+0001e4d0: 2060 6022 6e65 6172 6573 7422 6060 2069   ``"nearest"`` i
+0001e4e0: 7320 7573 6564 2062 7920 6465 6661 756c  s used by defaul
+0001e4f0: 742e 0a20 2020 2020 2020 202a 2a63 6f6f  t..        **coo
+0001e500: 7264 735f 6b77 6172 6773 203a 207b 6469  rds_kwargs : {di
+0001e510: 6d3a 2063 6f6f 7264 696e 6174 652c 202e  m: coordinate, .
+0001e520: 2e2e 7d2c 206f 7074 696f 6e61 6c0a 2020  ..}, optional.  
+0001e530: 2020 2020 2020 2020 2020 5468 6520 6b65            The ke
+0001e540: 7977 6f72 6420 6172 6775 6d65 6e74 7320  yword arguments 
+0001e550: 666f 726d 206f 6620 6060 636f 6f72 6473  form of ``coords
+0001e560: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
+0001e570: 4f6e 6520 6f66 2063 6f6f 7264 7320 6f72  One of coords or
+0001e580: 2063 6f6f 7264 735f 6b77 6172 6773 206d   coords_kwargs m
+0001e590: 7573 7420 6265 2070 726f 7669 6465 642e  ust be provided.
+0001e5a0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001e5b0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0001e5c0: 2d0a 2020 2020 2020 2020 696e 7465 7270  -.        interp
+0001e5d0: 6f6c 6174 6564 203a 2044 6174 6173 6574  olated : Dataset
+0001e5e0: 0a20 2020 2020 2020 2020 2020 204e 6577  .            New
+0001e5f0: 2064 6174 6173 6574 206f 6e20 7468 6520   dataset on the 
+0001e600: 6e65 7720 636f 6f72 6469 6e61 7465 732e  new coordinates.
+0001e610: 0a0a 2020 2020 2020 2020 4e6f 7465 730a  ..        Notes.
+0001e620: 2020 2020 2020 2020 2d2d 2d2d 2d0a 2020          -----.  
+0001e630: 2020 2020 2020 7363 6970 7920 6973 2072        scipy is r
+0001e640: 6571 7569 7265 642e 0a0a 2020 2020 2020  equired...      
+0001e650: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+0001e660: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+0001e670: 2020 2020 7363 6970 792e 696e 7465 7270      scipy.interp
+0001e680: 6f6c 6174 652e 696e 7465 7270 3164 0a20  olate.interp1d. 
+0001e690: 2020 2020 2020 2073 6369 7079 2e69 6e74         scipy.int
+0001e6a0: 6572 706f 6c61 7465 2e69 6e74 6572 706e  erpolate.interpn
+0001e6b0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+0001e6c0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+0001e6d0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+0001e6e0: 6473 203d 2078 722e 4461 7461 7365 7428  ds = xr.Dataset(
+0001e6f0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0001e700: 2064 6174 615f 7661 7273 3d7b 0a20 2020   data_vars={.   
+0001e710: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+0001e720: 2022 6122 3a20 2822 7822 2c20 5b35 2c20   "a": ("x", [5, 
+0001e730: 372c 2034 5d29 2c0a 2020 2020 2020 2020  7, 4]),.        
+0001e740: 2e2e 2e20 2020 2020 2020 2020 2262 223a  ...         "b":
+0001e750: 2028 0a20 2020 2020 2020 202e 2e2e 2020   (.        ...  
+0001e760: 2020 2020 2020 2020 2020 2028 2278 222c             ("x",
+0001e770: 2022 7922 292c 0a20 2020 2020 2020 202e   "y"),.        .
+0001e780: 2e2e 2020 2020 2020 2020 2020 2020 205b  ..             [
+0001e790: 5b31 2c20 342c 2032 2c20 395d 2c20 5b32  [1, 4, 2, 9], [2
+0001e7a0: 2c20 372c 2036 2c20 6e70 2e6e 616e 5d2c  , 7, 6, np.nan],
+0001e7b0: 205b 362c 206e 702e 6e61 6e2c 2035 2c20   [6, np.nan, 5, 
+0001e7c0: 385d 5d2c 0a20 2020 2020 2020 202e 2e2e  8]],.        ...
+0001e7d0: 2020 2020 2020 2020 2029 2c0a 2020 2020           ),.    
+0001e7e0: 2020 2020 2e2e 2e20 2020 2020 7d2c 0a20      ...     },. 
+0001e7f0: 2020 2020 2020 202e 2e2e 2020 2020 2063         ...     c
+0001e800: 6f6f 7264 733d 7b22 7822 3a20 5b30 2c20  oords={"x": [0, 
+0001e810: 312c 2032 5d2c 2022 7922 3a20 5b31 302c  1, 2], "y": [10,
+0001e820: 2031 322c 2031 342c 2031 365d 7d2c 0a20   12, 14, 16]},. 
+0001e830: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+0001e840: 2020 2020 203e 3e3e 2064 730a 2020 2020       >>> ds.    
+0001e850: 2020 2020 3c78 6172 7261 792e 4461 7461      <xarray.Data
+0001e860: 7365 743e 0a20 2020 2020 2020 2044 696d  set>.        Dim
+0001e870: 656e 7369 6f6e 733a 2020 2878 3a20 332c  ensions:  (x: 3,
+0001e880: 2079 3a20 3429 0a20 2020 2020 2020 2043   y: 4).        C
+0001e890: 6f6f 7264 696e 6174 6573 3a0a 2020 2020  oordinates:.    
+0001e8a0: 2020 2020 2020 2a20 7820 2020 2020 2020        * x       
+0001e8b0: 2028 7829 2069 6e74 3634 2030 2031 2032   (x) int64 0 1 2
+0001e8c0: 0a20 2020 2020 2020 2020 202a 2079 2020  .          * y  
+0001e8d0: 2020 2020 2020 2879 2920 696e 7436 3420        (y) int64 
+0001e8e0: 3130 2031 3220 3134 2031 360a 2020 2020  10 12 14 16.    
+0001e8f0: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
+0001e900: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0001e910: 6120 2020 2020 2020 2028 7829 2069 6e74  a        (x) int
+0001e920: 3634 2035 2037 2034 0a20 2020 2020 2020  64 5 7 4.       
+0001e930: 2020 2020 2062 2020 2020 2020 2020 2878       b        (x
+0001e940: 2c20 7929 2066 6c6f 6174 3634 2031 2e30  , y) float64 1.0
+0001e950: 2034 2e30 2032 2e30 2039 2e30 2032 2e30   4.0 2.0 9.0 2.0
+0001e960: 2037 2e30 2036 2e30 206e 616e 2036 2e30   7.0 6.0 nan 6.0
+0001e970: 206e 616e 2035 2e30 2038 2e30 0a0a 2020   nan 5.0 8.0..  
+0001e980: 2020 2020 2020 3144 2069 6e74 6572 706f        1D interpo
+0001e990: 6c61 7469 6f6e 2077 6974 6820 7468 6520  lation with the 
+0001e9a0: 6465 6661 756c 7420 6d65 7468 6f64 2028  default method (
+0001e9b0: 6c69 6e65 6172 293a 0a0a 2020 2020 2020  linear):..      
+0001e9c0: 2020 3e3e 3e20 6473 2e69 6e74 6572 7028    >>> ds.interp(
+0001e9d0: 783d 5b30 2c20 302e 3735 2c20 312e 3235  x=[0, 0.75, 1.25
+0001e9e0: 2c20 312e 3735 5d29 0a20 2020 2020 2020  , 1.75]).       
+0001e9f0: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+0001ea00: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
+0001ea10: 696f 6e73 3a20 2028 783a 2034 2c20 793a  ions:  (x: 4, y:
+0001ea20: 2034 290a 2020 2020 2020 2020 436f 6f72   4).        Coor
+0001ea30: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
+0001ea40: 2020 202a 2079 2020 2020 2020 2020 2879     * y        (y
+0001ea50: 2920 696e 7436 3420 3130 2031 3220 3134  ) int64 10 12 14
+0001ea60: 2031 360a 2020 2020 2020 2020 2020 2a20   16.          * 
+0001ea70: 7820 2020 2020 2020 2028 7829 2066 6c6f  x        (x) flo
+0001ea80: 6174 3634 2030 2e30 2030 2e37 3520 312e  at64 0.0 0.75 1.
+0001ea90: 3235 2031 2e37 350a 2020 2020 2020 2020  25 1.75.        
+0001eaa0: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
+0001eab0: 2020 2020 2020 2020 2020 2020 6120 2020              a   
+0001eac0: 2020 2020 2028 7829 2066 6c6f 6174 3634       (x) float64
+0001ead0: 2035 2e30 2036 2e35 2036 2e32 3520 342e   5.0 6.5 6.25 4.
+0001eae0: 3735 0a20 2020 2020 2020 2020 2020 2062  75.            b
+0001eaf0: 2020 2020 2020 2020 2878 2c20 7929 2066          (x, y) f
+0001eb00: 6c6f 6174 3634 2031 2e30 2034 2e30 2032  loat64 1.0 4.0 2
+0001eb10: 2e30 206e 616e 2031 2e37 3520 362e 3235  .0 nan 1.75 6.25
+0001eb20: 202e 2e2e 206e 616e 2035 2e30 206e 616e   ... nan 5.0 nan
+0001eb30: 2035 2e32 3520 6e61 6e0a 0a20 2020 2020   5.25 nan..     
+0001eb40: 2020 2031 4420 696e 7465 7270 6f6c 6174     1D interpolat
+0001eb50: 696f 6e20 7769 7468 2061 2064 6966 6665  ion with a diffe
+0001eb60: 7265 6e74 206d 6574 686f 643a 0a0a 2020  rent method:..  
+0001eb70: 2020 2020 2020 3e3e 3e20 6473 2e69 6e74        >>> ds.int
+0001eb80: 6572 7028 783d 5b30 2c20 302e 3735 2c20  erp(x=[0, 0.75, 
+0001eb90: 312e 3235 2c20 312e 3735 5d2c 206d 6574  1.25, 1.75], met
+0001eba0: 686f 643d 226e 6561 7265 7374 2229 0a20  hod="nearest"). 
+0001ebb0: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
+0001ebc0: 6174 6173 6574 3e0a 2020 2020 2020 2020  ataset>.        
+0001ebd0: 4469 6d65 6e73 696f 6e73 3a20 2028 783a  Dimensions:  (x:
+0001ebe0: 2034 2c20 793a 2034 290a 2020 2020 2020   4, y: 4).      
+0001ebf0: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
+0001ec00: 2020 2020 2020 2020 202a 2079 2020 2020           * y    
+0001ec10: 2020 2020 2879 2920 696e 7436 3420 3130      (y) int64 10
+0001ec20: 2031 3220 3134 2031 360a 2020 2020 2020   12 14 16.      
+0001ec30: 2020 2020 2a20 7820 2020 2020 2020 2028      * x        (
+0001ec40: 7829 2066 6c6f 6174 3634 2030 2e30 2030  x) float64 0.0 0
+0001ec50: 2e37 3520 312e 3235 2031 2e37 350a 2020  .75 1.25 1.75.  
+0001ec60: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
+0001ec70: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
+0001ec80: 2020 6120 2020 2020 2020 2028 7829 2066    a        (x) f
+0001ec90: 6c6f 6174 3634 2035 2e30 2037 2e30 2037  loat64 5.0 7.0 7
+0001eca0: 2e30 2034 2e30 0a20 2020 2020 2020 2020  .0 4.0.         
+0001ecb0: 2020 2062 2020 2020 2020 2020 2878 2c20     b        (x, 
+0001ecc0: 7929 2066 6c6f 6174 3634 2031 2e30 2034  y) float64 1.0 4
+0001ecd0: 2e30 2032 2e30 2039 2e30 2032 2e30 2037  .0 2.0 9.0 2.0 7
+0001ece0: 2e30 202e 2e2e 2036 2e30 206e 616e 2036  .0 ... 6.0 nan 6
+0001ecf0: 2e30 206e 616e 2035 2e30 2038 2e30 0a0a  .0 nan 5.0 8.0..
+0001ed00: 2020 2020 2020 2020 3144 2065 7874 7261          1D extra
+0001ed10: 706f 6c61 7469 6f6e 3a0a 0a20 2020 2020  polation:..     
+0001ed20: 2020 203e 3e3e 2064 732e 696e 7465 7270     >>> ds.interp
+0001ed30: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+0001ed40: 2020 783d 5b31 2c20 312e 352c 2032 2e35    x=[1, 1.5, 2.5
+0001ed50: 2c20 332e 355d 2c0a 2020 2020 2020 2020  , 3.5],.        
+0001ed60: 2e2e 2e20 2020 2020 6d65 7468 6f64 3d22  ...     method="
+0001ed70: 6c69 6e65 6172 222c 0a20 2020 2020 2020  linear",.       
+0001ed80: 202e 2e2e 2020 2020 206b 7761 7267 733d   ...     kwargs=
+0001ed90: 7b22 6669 6c6c 5f76 616c 7565 223a 2022  {"fill_value": "
+0001eda0: 6578 7472 6170 6f6c 6174 6522 7d2c 0a20  extrapolate"},. 
+0001edb0: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+0001edc0: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
+0001edd0: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
+0001ede0: 6d65 6e73 696f 6e73 3a20 2028 783a 2034  mensions:  (x: 4
+0001edf0: 2c20 793a 2034 290a 2020 2020 2020 2020  , y: 4).        
+0001ee00: 436f 6f72 6469 6e61 7465 733a 0a20 2020  Coordinates:.   
+0001ee10: 2020 2020 2020 202a 2079 2020 2020 2020         * y      
+0001ee20: 2020 2879 2920 696e 7436 3420 3130 2031    (y) int64 10 1
+0001ee30: 3220 3134 2031 360a 2020 2020 2020 2020  2 14 16.        
+0001ee40: 2020 2a20 7820 2020 2020 2020 2028 7829    * x        (x)
+0001ee50: 2066 6c6f 6174 3634 2031 2e30 2031 2e35   float64 1.0 1.5
+0001ee60: 2032 2e35 2033 2e35 0a20 2020 2020 2020   2.5 3.5.       
+0001ee70: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
+0001ee80: 0a20 2020 2020 2020 2020 2020 2061 2020  .            a  
+0001ee90: 2020 2020 2020 2878 2920 666c 6f61 7436        (x) float6
+0001eea0: 3420 372e 3020 352e 3520 322e 3520 2d30  4 7.0 5.5 2.5 -0
+0001eeb0: 2e35 0a20 2020 2020 2020 2020 2020 2062  .5.            b
+0001eec0: 2020 2020 2020 2020 2878 2c20 7929 2066          (x, y) f
+0001eed0: 6c6f 6174 3634 2032 2e30 2037 2e30 2036  loat64 2.0 7.0 6
+0001eee0: 2e30 206e 616e 2034 2e30 206e 616e 202e  .0 nan 4.0 nan .
+0001eef0: 2e2e 2034 2e35 206e 616e 2031 322e 3020  .. 4.5 nan 12.0 
+0001ef00: 6e61 6e20 332e 3520 6e61 6e0a 0a20 2020  nan 3.5 nan..   
+0001ef10: 2020 2020 2032 4420 696e 7465 7270 6f6c       2D interpol
+0001ef20: 6174 696f 6e3a 0a0a 2020 2020 2020 2020  ation:..        
+0001ef30: 3e3e 3e20 6473 2e69 6e74 6572 7028 783d  >>> ds.interp(x=
+0001ef40: 5b30 2c20 302e 3735 2c20 312e 3235 2c20  [0, 0.75, 1.25, 
+0001ef50: 312e 3735 5d2c 2079 3d5b 3131 2c20 3133  1.75], y=[11, 13
+0001ef60: 2c20 3135 5d2c 206d 6574 686f 643d 226c  , 15], method="l
+0001ef70: 696e 6561 7222 290a 2020 2020 2020 2020  inear").        
+0001ef80: 3c78 6172 7261 792e 4461 7461 7365 743e  <xarray.Dataset>
+0001ef90: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
+0001efa0: 6f6e 733a 2020 2878 3a20 342c 2079 3a20  ons:  (x: 4, y: 
+0001efb0: 3329 0a20 2020 2020 2020 2043 6f6f 7264  3).        Coord
+0001efc0: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
+0001efd0: 2020 2a20 7820 2020 2020 2020 2028 7829    * x        (x)
+0001efe0: 2066 6c6f 6174 3634 2030 2e30 2030 2e37   float64 0.0 0.7
+0001eff0: 3520 312e 3235 2031 2e37 350a 2020 2020  5 1.25 1.75.    
+0001f000: 2020 2020 2020 2a20 7920 2020 2020 2020        * y       
+0001f010: 2028 7929 2069 6e74 3634 2031 3120 3133   (y) int64 11 13
+0001f020: 2031 350a 2020 2020 2020 2020 4461 7461   15.        Data
+0001f030: 2076 6172 6961 626c 6573 3a0a 2020 2020   variables:.    
+0001f040: 2020 2020 2020 2020 6120 2020 2020 2020          a       
+0001f050: 2028 7829 2066 6c6f 6174 3634 2035 2e30   (x) float64 5.0
+0001f060: 2036 2e35 2036 2e32 3520 342e 3735 0a20   6.5 6.25 4.75. 
+0001f070: 2020 2020 2020 2020 2020 2062 2020 2020             b    
+0001f080: 2020 2020 2878 2c20 7929 2066 6c6f 6174      (x, y) float
+0001f090: 3634 2032 2e35 2033 2e30 206e 616e 2034  64 2.5 3.0 nan 4
+0001f0a0: 2e30 2035 2e36 3235 206e 616e 206e 616e  .0 5.625 nan nan
+0001f0b0: 206e 616e 206e 616e 206e 616e 206e 616e   nan nan nan nan
+0001f0c0: 206e 616e 0a20 2020 2020 2020 2022 2222   nan.        """
+0001f0d0: 0a20 2020 2020 2020 2066 726f 6d20 7861  .        from xa
+0001f0e0: 7272 6179 2e63 6f72 6520 696d 706f 7274  rray.core import
+0001f0f0: 206d 6973 7369 6e67 0a0a 2020 2020 2020   missing..      
+0001f100: 2020 6966 206b 7761 7267 7320 6973 204e    if kwargs is N
+0001f110: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0001f120: 206b 7761 7267 7320 3d20 7b7d 0a0a 2020   kwargs = {}..  
+0001f130: 2020 2020 2020 636f 6f72 6473 203d 2065        coords = e
+0001f140: 6974 6865 725f 6469 6374 5f6f 725f 6b77  ither_dict_or_kw
+0001f150: 6172 6773 2863 6f6f 7264 732c 2063 6f6f  args(coords, coo
+0001f160: 7264 735f 6b77 6172 6773 2c20 2269 6e74  rds_kwargs, "int
+0001f170: 6572 7022 290a 2020 2020 2020 2020 696e  erp").        in
+0001f180: 6465 7865 7273 203d 2064 6963 7428 7365  dexers = dict(se
+0001f190: 6c66 2e5f 7661 6c69 6461 7465 5f69 6e74  lf._validate_int
+0001f1a0: 6572 705f 696e 6465 7865 7273 2863 6f6f  erp_indexers(coo
+0001f1b0: 7264 7329 290a 0a20 2020 2020 2020 2069  rds))..        i
+0001f1c0: 6620 636f 6f72 6473 3a0a 2020 2020 2020  f coords:.      
+0001f1d0: 2020 2020 2020 2320 5468 6973 2061 766f        # This avo
+0001f1e0: 6964 7320 6272 6f61 6463 6173 7469 6e67  ids broadcasting
+0001f1f0: 206f 7665 7220 636f 6f72 6469 6e61 7465   over coordinate
+0001f200: 7320 7468 6174 2061 7265 2062 6f74 6820  s that are both 
+0001f210: 696e 0a20 2020 2020 2020 2020 2020 2023  in.            #
+0001f220: 2074 6865 206f 7269 6769 6e61 6c20 6172   the original ar
+0001f230: 7261 7920 414e 4420 696e 2074 6865 2069  ray AND in the i
+0001f240: 6e64 6578 696e 6720 6172 7261 792e 2049  ndexing array. I
+0001f250: 7420 6573 7365 6e74 6961 6c6c 790a 2020  t essentially.  
+0001f260: 2020 2020 2020 2020 2020 2320 666f 7263            # forc
+0001f270: 6573 2069 6e74 6572 706f 6c61 7469 6f6e  es interpolation
+0001f280: 2061 6c6f 6e67 2074 6865 2073 6861 7265   along the share
+0001f290: 6420 636f 6f72 6469 6e61 7465 732e 0a20  d coordinates.. 
+0001f2a0: 2020 2020 2020 2020 2020 2073 6469 6d73             sdims
+0001f2b0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+0001f2c0: 2020 2020 2073 6574 2873 656c 662e 6469       set(self.di
+0001f2d0: 6d73 290a 2020 2020 2020 2020 2020 2020  ms).            
+0001f2e0: 2020 2020 2e69 6e74 6572 7365 6374 696f      .intersectio
+0001f2f0: 6e28 2a5b 7365 7428 6e78 2e64 696d 7329  n(*[set(nx.dims)
+0001f300: 2066 6f72 206e 7820 696e 2069 6e64 6578   for nx in index
+0001f310: 6572 732e 7661 6c75 6573 2829 5d29 0a20  ers.values()]). 
+0001f320: 2020 2020 2020 2020 2020 2020 2020 202e                 .
+0001f330: 6469 6666 6572 656e 6365 2863 6f6f 7264  difference(coord
+0001f340: 732e 6b65 7973 2829 290a 2020 2020 2020  s.keys()).      
+0001f350: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0001f360: 2020 2020 696e 6465 7865 7273 2e75 7064      indexers.upd
+0001f370: 6174 6528 7b64 3a20 7365 6c66 2e76 6172  ate({d: self.var
+0001f380: 6961 626c 6573 5b64 5d20 666f 7220 6420  iables[d] for d 
+0001f390: 696e 2073 6469 6d73 7d29 0a0a 2020 2020  in sdims})..    
+0001f3a0: 2020 2020 6f62 6a20 3d20 7365 6c66 2069      obj = self i
+0001f3b0: 6620 6173 7375 6d65 5f73 6f72 7465 6420  f assume_sorted 
+0001f3c0: 656c 7365 2073 656c 662e 736f 7274 6279  else self.sortby
+0001f3d0: 285b 6b20 666f 7220 6b20 696e 2063 6f6f  ([k for k in coo
+0001f3e0: 7264 735d 290a 0a20 2020 2020 2020 2064  rds])..        d
+0001f3f0: 6566 206d 6179 6265 5f76 6172 6961 626c  ef maybe_variabl
+0001f400: 6528 6f62 6a2c 206b 293a 0a20 2020 2020  e(obj, k):.     
+0001f410: 2020 2020 2020 2023 2077 6f72 6b61 726f         # workaro
+0001f420: 756e 6420 746f 2067 6574 2076 6172 6961  und to get varia
+0001f430: 626c 6520 666f 7220 6469 6d65 6e73 696f  ble for dimensio
+0001f440: 6e20 7769 7468 6f75 7420 636f 6f72 6469  n without coordi
+0001f450: 6e61 7465 2e0a 2020 2020 2020 2020 2020  nate..          
+0001f460: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0001f470: 2020 2020 2020 2072 6574 7572 6e20 6f62         return ob
+0001f480: 6a2e 5f76 6172 6961 626c 6573 5b6b 5d0a  j._variables[k].
+0001f490: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+0001f4a0: 7074 204b 6579 4572 726f 723a 0a20 2020  pt KeyError:.   
+0001f4b0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+0001f4c0: 7572 6e20 6173 5f76 6172 6961 626c 6528  urn as_variable(
+0001f4d0: 286b 2c20 7261 6e67 6528 6f62 6a2e 6469  (k, range(obj.di
+0001f4e0: 6d73 5b6b 5d29 2929 0a0a 2020 2020 2020  ms[k])))..      
+0001f4f0: 2020 6465 6620 5f76 616c 6964 6174 655f    def _validate_
+0001f500: 696e 7465 7270 5f69 6e64 6578 6572 2878  interp_indexer(x
+0001f510: 2c20 6e65 775f 7829 3a0a 2020 2020 2020  , new_x):.      
+0001f520: 2020 2020 2020 2320 496e 2074 6865 2063        # In the c
+0001f530: 6173 6520 6f66 2064 6174 6574 696d 6573  ase of datetimes
+0001f540: 2c20 7468 6520 7265 7374 7269 6374 696f  , the restrictio
+0001f550: 6e73 2070 6c61 6365 6420 6f6e 2069 6e64  ns placed on ind
+0001f560: 6578 6572 730a 2020 2020 2020 2020 2020  exers.          
+0001f570: 2020 2320 7573 6564 2077 6974 6820 696e    # used with in
+0001f580: 7465 7270 2061 7265 2073 7472 6f6e 6765  terp are stronge
+0001f590: 7220 7468 616e 2074 686f 7365 2077 6869  r than those whi
+0001f5a0: 6368 2061 7265 2070 6c61 6365 6420 6f6e  ch are placed on
+0001f5b0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+0001f5c0: 7365 6c2c 2073 6f20 7765 206e 6565 6420  sel, so we need 
+0001f5d0: 616e 2061 6464 6974 696f 6e61 6c20 6368  an additional ch
+0001f5e0: 6563 6b20 6166 7465 7220 5f76 616c 6964  eck after _valid
+0001f5f0: 6174 655f 696e 6465 7865 7273 2e0a 2020  ate_indexers..  
+0001f600: 2020 2020 2020 2020 2020 6966 205f 636f            if _co
+0001f610: 6e74 6169 6e73 5f64 6174 6574 696d 655f  ntains_datetime_
+0001f620: 6c69 6b65 5f6f 626a 6563 7473 280a 2020  like_objects(.  
+0001f630: 2020 2020 2020 2020 2020 2020 2020 780a                x.
+0001f640: 2020 2020 2020 2020 2020 2020 2920 616e              ) an
+0001f650: 6420 6e6f 7420 5f63 6f6e 7461 696e 735f  d not _contains_
+0001f660: 6461 7465 7469 6d65 5f6c 696b 655f 6f62  datetime_like_ob
+0001f670: 6a65 6374 7328 6e65 775f 7829 3a0a 2020  jects(new_x):.  
+0001f680: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0001f690: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
+0001f6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f6b0: 2020 2022 5768 656e 2069 6e74 6572 706f     "When interpo
+0001f6c0: 6c61 7469 6e67 206f 7665 7220 6120 6461  lating over a da
+0001f6d0: 7465 7469 6d65 2d6c 696b 6520 220a 2020  tetime-like ".  
+0001f6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f6f0: 2020 2263 6f6f 7264 696e 6174 652c 2074    "coordinate, t
+0001f700: 6865 2063 6f6f 7264 696e 6174 6573 2074  he coordinates t
+0001f710: 6f20 220a 2020 2020 2020 2020 2020 2020  o ".            
+0001f720: 2020 2020 2020 2020 2269 6e74 6572 706f          "interpo
+0001f730: 6c61 7465 2074 6f20 6d75 7374 2062 6520  late to must be 
+0001f740: 6569 7468 6572 2064 6174 6574 696d 6520  either datetime 
+0001f750: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0001f760: 2020 2020 2020 2273 7472 696e 6773 206f        "strings o
+0001f770: 7220 6461 7465 7469 6d65 732e 2022 0a20  r datetimes. ". 
+0001f780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f790: 2020 2022 496e 7374 6561 6420 676f 745c     "Instead got\
+0001f7a0: 6e7b 7d22 2e66 6f72 6d61 7428 6e65 775f  n{}".format(new_
+0001f7b0: 7829 0a20 2020 2020 2020 2020 2020 2020  x).             
+0001f7c0: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+0001f7d0: 2072 6574 7572 6e20 782c 206e 6577 5f78   return x, new_x
+0001f7e0: 0a0a 2020 2020 2020 2020 7661 6c69 6461  ..        valida
+0001f7f0: 7465 645f 696e 6465 7865 7273 203d 207b  ted_indexers = {
+0001f800: 0a20 2020 2020 2020 2020 2020 206b 3a20  .            k: 
+0001f810: 5f76 616c 6964 6174 655f 696e 7465 7270  _validate_interp
+0001f820: 5f69 6e64 6578 6572 286d 6179 6265 5f76  _indexer(maybe_v
+0001f830: 6172 6961 626c 6528 6f62 6a2c 206b 292c  ariable(obj, k),
+0001f840: 2076 290a 2020 2020 2020 2020 2020 2020   v).            
+0001f850: 666f 7220 6b2c 2076 2069 6e20 696e 6465  for k, v in inde
+0001f860: 7865 7273 2e69 7465 6d73 2829 0a20 2020  xers.items().   
+0001f870: 2020 2020 207d 0a0a 2020 2020 2020 2020       }..        
+0001f880: 2320 6f70 7469 6d69 7a61 7469 6f6e 3a20  # optimization: 
+0001f890: 7375 6273 6574 2074 6f20 636f 6f72 6469  subset to coordi
+0001f8a0: 6e61 7465 2072 616e 6765 206f 6620 7468  nate range of th
+0001f8b0: 6520 7461 7267 6574 2069 6e64 6578 0a20  e target index. 
+0001f8c0: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
+0001f8d0: 2069 6e20 5b22 6c69 6e65 6172 222c 2022   in ["linear", "
+0001f8e0: 6e65 6172 6573 7422 5d3a 0a20 2020 2020  nearest"]:.     
+0001f8f0: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
+0001f900: 696e 2076 616c 6964 6174 6564 5f69 6e64  in validated_ind
+0001f910: 6578 6572 732e 6974 656d 7328 293a 0a20  exers.items():. 
+0001f920: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0001f930: 626a 2c20 6e65 7769 6478 203d 206d 6973  bj, newidx = mis
+0001f940: 7369 6e67 2e5f 6c6f 6361 6c69 7a65 286f  sing._localize(o
+0001f950: 626a 2c20 7b6b 3a20 767d 290a 2020 2020  bj, {k: v}).    
+0001f960: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+0001f970: 6461 7465 645f 696e 6465 7865 7273 5b6b  dated_indexers[k
+0001f980: 5d20 3d20 6e65 7769 6478 5b6b 5d0a 0a20  ] = newidx[k].. 
+0001f990: 2020 2020 2020 2023 206f 7074 696d 697a         # optimiz
+0001f9a0: 6174 696f 6e3a 2063 7265 6174 6520 6461  ation: create da
+0001f9b0: 736b 2063 6f6f 7264 696e 6174 6520 6172  sk coordinate ar
+0001f9c0: 7261 7973 206f 6e63 6520 7065 7220 4461  rays once per Da
+0001f9d0: 7461 7365 740a 2020 2020 2020 2020 2320  taset.        # 
+0001f9e0: 7261 7468 6572 2074 6861 6e20 6f6e 6365  rather than once
+0001f9f0: 2070 6572 2056 6172 6961 626c 6520 7768   per Variable wh
+0001fa00: 656e 2064 6173 6b2e 6172 7261 792e 756e  en dask.array.un
+0001fa10: 6966 795f 6368 756e 6b73 2069 7320 6361  ify_chunks is ca
+0001fa20: 6c6c 6564 206c 6174 6572 0a20 2020 2020  lled later.     
+0001fa30: 2020 2023 2047 4834 3733 390a 2020 2020     # GH4739.    
+0001fa40: 2020 2020 6966 206f 626a 2e5f 5f64 6173      if obj.__das
+0001fa50: 6b5f 6772 6170 685f 5f28 293a 0a20 2020  k_graph__():.   
+0001fa60: 2020 2020 2020 2020 2064 6173 6b5f 696e           dask_in
+0001fa70: 6465 7865 7273 203d 207b 0a20 2020 2020  dexers = {.     
+0001fa80: 2020 2020 2020 2020 2020 206b 3a20 2869             k: (i
+0001fa90: 6e64 6578 2e74 6f5f 6261 7365 5f76 6172  ndex.to_base_var
+0001faa0: 6961 626c 6528 292e 6368 756e 6b28 292c  iable().chunk(),
+0001fab0: 2064 6573 742e 746f 5f62 6173 655f 7661   dest.to_base_va
+0001fac0: 7269 6162 6c65 2829 2e63 6875 6e6b 2829  riable().chunk()
+0001fad0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001fae0: 2020 666f 7220 6b2c 2028 696e 6465 782c    for k, (index,
+0001faf0: 2064 6573 7429 2069 6e20 7661 6c69 6461   dest) in valida
+0001fb00: 7465 645f 696e 6465 7865 7273 2e69 7465  ted_indexers.ite
+0001fb10: 6d73 2829 0a20 2020 2020 2020 2020 2020  ms().           
+0001fb20: 207d 0a0a 2020 2020 2020 2020 7661 7269   }..        vari
+0001fb30: 6162 6c65 733a 2064 6963 745b 4861 7368  ables: dict[Hash
+0001fb40: 6162 6c65 2c20 5661 7269 6162 6c65 5d20  able, Variable] 
+0001fb50: 3d20 7b7d 0a20 2020 2020 2020 2072 6569  = {}.        rei
+0001fb60: 6e64 6578 3a20 626f 6f6c 203d 2046 616c  ndex: bool = Fal
+0001fb70: 7365 0a20 2020 2020 2020 2066 6f72 206e  se.        for n
+0001fb80: 616d 652c 2076 6172 2069 6e20 6f62 6a2e  ame, var in obj.
+0001fb90: 5f76 6172 6961 626c 6573 2e69 7465 6d73  _variables.items
+0001fba0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0001fbb0: 6966 206e 616d 6520 696e 2069 6e64 6578  if name in index
+0001fbc0: 6572 733a 0a20 2020 2020 2020 2020 2020  ers:.           
+0001fbd0: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
+0001fbe0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+0001fbf0: 5f64 7563 6b5f 6461 736b 5f61 7272 6179  _duck_dask_array
+0001fc00: 2876 6172 2e64 6174 6129 3a0a 2020 2020  (var.data):.    
+0001fc10: 2020 2020 2020 2020 2020 2020 7573 655f              use_
+0001fc20: 696e 6465 7865 7273 203d 2064 6173 6b5f  indexers = dask_
+0001fc30: 696e 6465 7865 7273 0a20 2020 2020 2020  indexers.       
+0001fc40: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0001fc50: 2020 2020 2020 2020 2020 2075 7365 5f69             use_i
+0001fc60: 6e64 6578 6572 7320 3d20 7661 6c69 6461  ndexers = valida
+0001fc70: 7465 645f 696e 6465 7865 7273 0a0a 2020  ted_indexers..  
+0001fc80: 2020 2020 2020 2020 2020 6474 7970 655f            dtype_
+0001fc90: 6b69 6e64 203d 2076 6172 2e64 7479 7065  kind = var.dtype
+0001fca0: 2e6b 696e 640a 2020 2020 2020 2020 2020  .kind.          
+0001fcb0: 2020 6966 2064 7479 7065 5f6b 696e 6420    if dtype_kind 
+0001fcc0: 696e 2022 7569 6663 223a 0a20 2020 2020  in "uifc":.     
+0001fcd0: 2020 2020 2020 2020 2020 2023 2046 6f72             # For
+0001fce0: 206e 6f72 6d61 6c20 6e75 6d62 6572 2074   normal number t
+0001fcf0: 7970 6573 2064 6f20 7468 6520 696e 7465  ypes do the inte
+0001fd00: 7270 6f6c 6174 696f 6e3a 0a20 2020 2020  rpolation:.     
+0001fd10: 2020 2020 2020 2020 2020 2076 6172 5f69             var_i
+0001fd20: 6e64 6578 6572 7320 3d20 7b6b 3a20 7620  ndexers = {k: v 
+0001fd30: 666f 7220 6b2c 2076 2069 6e20 7573 655f  for k, v in use_
+0001fd40: 696e 6465 7865 7273 2e69 7465 6d73 2829  indexers.items()
+0001fd50: 2069 6620 6b20 696e 2076 6172 2e64 696d   if k in var.dim
+0001fd60: 737d 0a20 2020 2020 2020 2020 2020 2020  s}.             
+0001fd70: 2020 2076 6172 6961 626c 6573 5b6e 616d     variables[nam
+0001fd80: 655d 203d 206d 6973 7369 6e67 2e69 6e74  e] = missing.int
+0001fd90: 6572 7028 7661 722c 2076 6172 5f69 6e64  erp(var, var_ind
+0001fda0: 6578 6572 732c 206d 6574 686f 642c 202a  exers, method, *
+0001fdb0: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
+0001fdc0: 2020 2020 2065 6c69 6620 6474 7970 655f       elif dtype_
+0001fdd0: 6b69 6e64 2069 6e20 224f 6255 2220 616e  kind in "ObU" an
+0001fde0: 6420 2875 7365 5f69 6e64 6578 6572 732e  d (use_indexers.
+0001fdf0: 6b65 7973 2829 2026 2076 6172 2e64 696d  keys() & var.dim
+0001fe00: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
+0001fe10: 2020 2020 2320 466f 7220 7479 7065 7320      # For types 
+0001fe20: 7468 6174 2077 6520 646f 206e 6f74 2075  that we do not u
+0001fe30: 6e64 6572 7374 616e 6420 646f 2073 7465  nderstand do ste
+0001fe40: 7077 6973 650a 2020 2020 2020 2020 2020  pwise.          
+0001fe50: 2020 2020 2020 2320 696e 7465 7270 6f6c        # interpol
+0001fe60: 6174 696f 6e20 746f 2061 766f 6964 206d  ation to avoid m
+0001fe70: 6f64 6966 7969 6e67 2074 6865 2065 6c65  odifying the ele
+0001fe80: 6d65 6e74 732e 0a20 2020 2020 2020 2020  ments..         
+0001fe90: 2020 2020 2020 2023 2072 6569 6e64 6578         # reindex
+0001fea0: 2074 6865 2076 6172 6961 626c 6520 696e   the variable in
+0001feb0: 7374 6561 6420 6265 6361 7573 6520 6974  stead because it
+0001fec0: 2073 7570 706f 7274 730a 2020 2020 2020   supports.      
+0001fed0: 2020 2020 2020 2020 2020 2320 626f 6f6c            # bool
+0001fee0: 6561 6e73 2061 6e64 206f 626a 6563 7473  eans and objects
+0001fef0: 2061 6e64 2072 6574 6169 6e73 2074 6865   and retains the
+0001ff00: 2064 7479 7065 2062 7574 2069 6e73 6964   dtype but insid
+0001ff10: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0001ff20: 2020 2320 7468 6973 206c 6f6f 7020 7468    # this loop th
+0001ff30: 6572 6520 6d69 6768 7420 6265 2073 6f6d  ere might be som
+0001ff40: 6520 6475 706c 6963 6174 6520 636f 6465  e duplicate code
+0001ff50: 2074 6861 7420 736c 6f77 7320 6974 0a20   that slows it. 
+0001ff60: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0001ff70: 2064 6f77 6e2c 2074 6865 7265 666f 7265   down, therefore
+0001ff80: 2063 6f6c 6c65 6374 2074 6865 7365 2073   collect these s
+0001ff90: 6967 6e61 6c73 2061 6e64 2072 756e 2069  ignals and run i
+0001ffa0: 7420 6c61 7465 723a 0a20 2020 2020 2020  t later:.       
+0001ffb0: 2020 2020 2020 2020 2072 6569 6e64 6578           reindex
+0001ffc0: 203d 2054 7275 650a 2020 2020 2020 2020   = True.        
+0001ffd0: 2020 2020 656c 6966 2061 6c6c 2864 206e      elif all(d n
+0001ffe0: 6f74 2069 6e20 696e 6465 7865 7273 2066  ot in indexers f
+0001fff0: 6f72 2064 2069 6e20 7661 722e 6469 6d73  or d in var.dims
+00020000: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00020010: 2020 2023 2046 6f72 2061 6e79 7468 696e     # For anythin
+00020020: 6720 656c 7365 2077 6520 6361 6e20 6f6e  g else we can on
+00020030: 6c79 206b 6565 7020 7661 7269 6162 6c65  ly keep variable
+00020040: 7320 6966 2074 6865 790a 2020 2020 2020  s if they.      
+00020050: 2020 2020 2020 2020 2020 2320 6172 6520            # are 
+00020060: 6e6f 7420 6465 7065 6e64 656e 7420 6f6e  not dependent on
+00020070: 2061 6e79 2063 6f6f 7264 7320 7468 6174   any coords that
+00020080: 2061 7265 2062 6569 6e67 0a20 2020 2020   are being.     
+00020090: 2020 2020 2020 2020 2020 2023 2069 6e74             # int
+000200a0: 6572 706f 6c61 7465 6420 616c 6f6e 673a  erpolated along:
+000200b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000200c0: 2076 6172 6961 626c 6573 5b6e 616d 655d   variables[name]
+000200d0: 203d 2076 6172 0a0a 2020 2020 2020 2020   = var..        
+000200e0: 6966 2072 6569 6e64 6578 3a0a 2020 2020  if reindex:.    
+000200f0: 2020 2020 2020 2020 7265 696e 6465 785f          reindex_
+00020100: 696e 6465 7865 7273 203d 207b 0a20 2020  indexers = {.   
+00020110: 2020 2020 2020 2020 2020 2020 206b 3a20               k: 
+00020120: 7620 666f 7220 6b2c 2028 5f2c 2076 2920  v for k, (_, v) 
+00020130: 696e 2076 616c 6964 6174 6564 5f69 6e64  in validated_ind
+00020140: 6578 6572 732e 6974 656d 7328 2920 6966  exers.items() if
+00020150: 2076 2e64 696d 7320 3d3d 2028 6b2c 290a   v.dims == (k,).
+00020160: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
+00020170: 2020 2020 2020 2020 2020 7265 696e 6465            reinde
+00020180: 7865 6420 3d20 616c 6967 6e6d 656e 742e  xed = alignment.
+00020190: 7265 696e 6465 7828 0a20 2020 2020 2020  reindex(.       
+000201a0: 2020 2020 2020 2020 206f 626a 2c0a 2020           obj,.  
+000201b0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000201c0: 6465 7865 7273 3d72 6569 6e64 6578 5f69  dexers=reindex_i
+000201d0: 6e64 6578 6572 732c 0a20 2020 2020 2020  ndexers,.       
+000201e0: 2020 2020 2020 2020 206d 6574 686f 643d           method=
+000201f0: 6d65 7468 6f64 5f6e 6f6e 5f6e 756d 6572  method_non_numer
+00020200: 6963 2c0a 2020 2020 2020 2020 2020 2020  ic,.            
+00020210: 2020 2020 6578 636c 7564 655f 7661 7273      exclude_vars
+00020220: 3d76 6172 6961 626c 6573 2e6b 6579 7328  =variables.keys(
+00020230: 292c 0a20 2020 2020 2020 2020 2020 2029  ),.            )
+00020240: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00020250: 6578 6573 203d 2064 6963 7428 7265 696e  exes = dict(rein
+00020260: 6465 7865 642e 5f69 6e64 6578 6573 290a  dexed._indexes).
+00020270: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+00020280: 6162 6c65 732e 7570 6461 7465 2872 6569  ables.update(rei
+00020290: 6e64 6578 6564 2e76 6172 6961 626c 6573  ndexed.variables
+000202a0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+000202b0: 2020 2020 2020 2020 2020 2020 2320 4765              # Ge
+000202c0: 7420 7468 6520 696e 6465 7865 7320 7468  t the indexes th
+000202d0: 6174 2061 7265 206e 6f74 2062 6569 6e67  at are not being
+000202e0: 2069 6e74 6572 706f 6c61 7465 6420 616c   interpolated al
+000202f0: 6f6e 670a 2020 2020 2020 2020 2020 2020  ong.            
+00020300: 696e 6465 7865 7320 3d20 7b6b 3a20 7620  indexes = {k: v 
+00020310: 666f 7220 6b2c 2076 2069 6e20 6f62 6a2e  for k, v in obj.
+00020320: 5f69 6e64 6578 6573 2e69 7465 6d73 2829  _indexes.items()
+00020330: 2069 6620 6b20 6e6f 7420 696e 2069 6e64   if k not in ind
+00020340: 6578 6572 737d 0a0a 2020 2020 2020 2020  exers}..        
+00020350: 2320 4765 7420 7468 6520 636f 6f72 6473  # Get the coords
+00020360: 2074 6861 7420 616c 736f 2065 7869 7374   that also exist
+00020370: 2069 6e20 7468 6520 7661 7269 6162 6c65   in the variable
+00020380: 733a 0a20 2020 2020 2020 2063 6f6f 7264  s:.        coord
+00020390: 5f6e 616d 6573 203d 206f 626a 2e5f 636f  _names = obj._co
+000203a0: 6f72 645f 6e61 6d65 7320 2620 7661 7269  ord_names & vari
+000203b0: 6162 6c65 732e 6b65 7973 2829 0a20 2020  ables.keys().   
+000203c0: 2020 2020 2073 656c 6563 7465 6420 3d20       selected = 
+000203d0: 7365 6c66 2e5f 7265 706c 6163 655f 7769  self._replace_wi
+000203e0: 7468 5f6e 6577 5f64 696d 7328 0a20 2020  th_new_dims(.   
+000203f0: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
+00020400: 6573 2e63 6f70 7928 292c 2063 6f6f 7264  es.copy(), coord
+00020410: 5f6e 616d 6573 2c20 696e 6465 7865 733d  _names, indexes=
+00020420: 696e 6465 7865 730a 2020 2020 2020 2020  indexes.        
+00020430: 290a 0a20 2020 2020 2020 2023 2041 7474  )..        # Att
+00020440: 6163 6820 696e 6465 7865 7220 6173 2063  ach indexer as c
+00020450: 6f6f 7264 696e 6174 650a 2020 2020 2020  oordinate.      
+00020460: 2020 666f 7220 6b2c 2076 2069 6e20 696e    for k, v in in
+00020470: 6465 7865 7273 2e69 7465 6d73 2829 3a0a  dexers.items():.
+00020480: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+00020490: 7274 2069 7369 6e73 7461 6e63 6528 762c  rt isinstance(v,
+000204a0: 2056 6172 6961 626c 6529 0a20 2020 2020   Variable).     
+000204b0: 2020 2020 2020 2069 6620 762e 6469 6d73         if v.dims
+000204c0: 203d 3d20 286b 2c29 3a0a 2020 2020 2020   == (k,):.      
+000204d0: 2020 2020 2020 2020 2020 696e 6465 7820            index 
+000204e0: 3d20 5061 6e64 6173 496e 6465 7828 762c  = PandasIndex(v,
+000204f0: 206b 2c20 636f 6f72 645f 6474 7970 653d   k, coord_dtype=
+00020500: 762e 6474 7970 6529 0a20 2020 2020 2020  v.dtype).       
+00020510: 2020 2020 2020 2020 2069 6e64 6578 5f76           index_v
+00020520: 6172 7320 3d20 696e 6465 782e 6372 6561  ars = index.crea
+00020530: 7465 5f76 6172 6961 626c 6573 287b 6b3a  te_variables({k:
+00020540: 2076 7d29 0a20 2020 2020 2020 2020 2020   v}).           
+00020550: 2020 2020 2069 6e64 6578 6573 5b6b 5d20       indexes[k] 
+00020560: 3d20 696e 6465 780a 2020 2020 2020 2020  = index.        
+00020570: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+00020580: 732e 7570 6461 7465 2869 6e64 6578 5f76  s.update(index_v
+00020590: 6172 7329 0a20 2020 2020 2020 2020 2020  ars).           
+000205a0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000205b0: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+000205c0: 5b6b 5d20 3d20 760a 0a20 2020 2020 2020  [k] = v..       
+000205d0: 2023 2045 7874 7261 6374 2063 6f6f 7264   # Extract coord
+000205e0: 696e 6174 6573 2066 726f 6d20 696e 6465  inates from inde
+000205f0: 7865 7273 0a20 2020 2020 2020 2063 6f6f  xers.        coo
+00020600: 7264 5f76 6172 732c 206e 6577 5f69 6e64  rd_vars, new_ind
+00020610: 6578 6573 203d 2073 656c 6563 7465 642e  exes = selected.
+00020620: 5f67 6574 5f69 6e64 6578 6572 735f 636f  _get_indexers_co
+00020630: 6f72 6473 5f61 6e64 5f69 6e64 6578 6573  ords_and_indexes
+00020640: 2863 6f6f 7264 7329 0a20 2020 2020 2020  (coords).       
+00020650: 2076 6172 6961 626c 6573 2e75 7064 6174   variables.updat
+00020660: 6528 636f 6f72 645f 7661 7273 290a 2020  e(coord_vars).  
+00020670: 2020 2020 2020 696e 6465 7865 732e 7570        indexes.up
+00020680: 6461 7465 286e 6577 5f69 6e64 6578 6573  date(new_indexes
+00020690: 290a 0a20 2020 2020 2020 2063 6f6f 7264  )..        coord
+000206a0: 5f6e 616d 6573 203d 206f 626a 2e5f 636f  _names = obj._co
+000206b0: 6f72 645f 6e61 6d65 7320 2620 7661 7269  ord_names & vari
+000206c0: 6162 6c65 732e 6b65 7973 2829 207c 2063  ables.keys() | c
+000206d0: 6f6f 7264 5f76 6172 732e 6b65 7973 2829  oord_vars.keys()
+000206e0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000206f0: 7365 6c66 2e5f 7265 706c 6163 655f 7769  self._replace_wi
+00020700: 7468 5f6e 6577 5f64 696d 7328 7661 7269  th_new_dims(vari
+00020710: 6162 6c65 732c 2063 6f6f 7264 5f6e 616d  ables, coord_nam
+00020720: 6573 2c20 696e 6465 7865 733d 696e 6465  es, indexes=inde
+00020730: 7865 7329 0a0a 2020 2020 6465 6620 696e  xes)..    def in
+00020740: 7465 7270 5f6c 696b 6528 0a20 2020 2020  terp_like(.     
+00020750: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00020760: 206f 7468 6572 3a20 4461 7461 7365 7420   other: Dataset 
+00020770: 7c20 4461 7461 4172 7261 792c 0a20 2020  | DataArray,.   
+00020780: 2020 2020 206d 6574 686f 643a 2049 6e74       method: Int
+00020790: 6572 704f 7074 696f 6e73 203d 2022 6c69  erpOptions = "li
+000207a0: 6e65 6172 222c 0a20 2020 2020 2020 2061  near",.        a
+000207b0: 7373 756d 655f 736f 7274 6564 3a20 626f  ssume_sorted: bo
+000207c0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+000207d0: 2020 2020 6b77 6172 6773 3a20 4d61 7070      kwargs: Mapp
+000207e0: 696e 675b 7374 722c 2041 6e79 5d20 7c20  ing[str, Any] | 
+000207f0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+00020800: 2020 2020 206d 6574 686f 645f 6e6f 6e5f       method_non_
+00020810: 6e75 6d65 7269 633a 2073 7472 203d 2022  numeric: str = "
+00020820: 6e65 6172 6573 7422 2c0a 2020 2020 2920  nearest",.    ) 
+00020830: 2d3e 2044 6174 6173 6574 3a0a 2020 2020  -> Dataset:.    
+00020840: 2020 2020 2222 2249 6e74 6572 706f 6c61      """Interpola
+00020850: 7465 2074 6869 7320 6f62 6a65 6374 206f  te this object o
+00020860: 6e74 6f20 7468 6520 636f 6f72 6469 6e61  nto the coordina
+00020870: 7465 7320 6f66 2061 6e6f 7468 6572 206f  tes of another o
+00020880: 626a 6563 742c 0a20 2020 2020 2020 2066  bject,.        f
+00020890: 696c 6c69 6e67 2074 6865 206f 7574 206f  illing the out o
+000208a0: 6620 7261 6e67 6520 7661 6c75 6573 2077  f range values w
+000208b0: 6974 6820 4e61 4e2e 0a0a 2020 2020 2020  ith NaN...      
+000208c0: 2020 4966 2069 6e74 6572 706f 6c61 7469    If interpolati
+000208d0: 6e67 2061 6c6f 6e67 2061 2073 696e 676c  ng along a singl
+000208e0: 6520 6578 6973 7469 6e67 2064 696d 656e  e existing dimen
+000208f0: 7369 6f6e 2c0a 2020 2020 2020 2020 3a70  sion,.        :p
+00020900: 793a 636c 6173 733a 6073 6369 7079 2e69  y:class:`scipy.i
+00020910: 6e74 6572 706f 6c61 7465 2e69 6e74 6572  nterpolate.inter
+00020920: 7031 6460 2069 7320 6361 6c6c 6564 2e20  p1d` is called. 
+00020930: 5768 656e 2069 6e74 6572 706f 6c61 7469  When interpolati
+00020940: 6e67 0a20 2020 2020 2020 2061 6c6f 6e67  ng.        along
+00020950: 206d 756c 7469 706c 6520 6578 6973 7469   multiple existi
+00020960: 6e67 2064 696d 656e 7369 6f6e 732c 2061  ng dimensions, a
+00020970: 6e20 6174 7465 6d70 7420 6973 206d 6164  n attempt is mad
+00020980: 6520 746f 2064 6563 6f6d 706f 7365 2074  e to decompose t
+00020990: 6865 0a20 2020 2020 2020 2069 6e74 6572  he.        inter
+000209a0: 706f 6c61 7469 6f6e 2069 6e74 6f20 6d75  polation into mu
+000209b0: 6c74 6970 6c65 2031 2d64 696d 656e 7369  ltiple 1-dimensi
+000209c0: 6f6e 616c 2069 6e74 6572 706f 6c61 7469  onal interpolati
+000209d0: 6f6e 732e 2049 6620 7468 6973 2069 730a  ons. If this is.
+000209e0: 2020 2020 2020 2020 706f 7373 6962 6c65          possible
+000209f0: 2c20 3a70 793a 636c 6173 733a 6073 6369  , :py:class:`sci
+00020a00: 7079 2e69 6e74 6572 706f 6c61 7465 2e69  py.interpolate.i
+00020a10: 6e74 6572 7031 6460 2069 7320 6361 6c6c  nterp1d` is call
+00020a20: 6564 2e20 4f74 6865 7277 6973 652c 0a20  ed. Otherwise,. 
+00020a30: 2020 2020 2020 203a 7079 3a66 756e 633a         :py:func:
+00020a40: 6073 6369 7079 2e69 6e74 6572 706f 6c61  `scipy.interpola
+00020a50: 7465 2e69 6e74 6572 706e 6020 6973 2063  te.interpn` is c
+00020a60: 616c 6c65 642e 0a0a 2020 2020 2020 2020  alled...        
+00020a70: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00020a80: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00020a90: 2020 2020 2020 6f74 6865 7220 3a20 4461        other : Da
+00020aa0: 7461 7365 7420 6f72 2044 6174 6141 7272  taset or DataArr
+00020ab0: 6179 0a20 2020 2020 2020 2020 2020 204f  ay.            O
+00020ac0: 626a 6563 7420 7769 7468 2061 6e20 2769  bject with an 'i
+00020ad0: 6e64 6578 6573 2720 6174 7472 6962 7574  ndexes' attribut
+00020ae0: 6520 6769 7669 6e67 2061 206d 6170 7069  e giving a mappi
+00020af0: 6e67 2066 726f 6d20 6469 6d65 6e73 696f  ng from dimensio
+00020b00: 6e0a 2020 2020 2020 2020 2020 2020 6e61  n.            na
+00020b10: 6d65 7320 746f 2061 6e20 3164 2061 7272  mes to an 1d arr
+00020b20: 6179 2d6c 696b 652c 2077 6869 6368 2070  ay-like, which p
+00020b30: 726f 7669 6465 7320 636f 6f72 6469 6e61  rovides coordina
+00020b40: 7465 7320 7570 6f6e 0a20 2020 2020 2020  tes upon.       
+00020b50: 2020 2020 2077 6869 6368 2074 6f20 696e       which to in
+00020b60: 6465 7820 7468 6520 7661 7269 6162 6c65  dex the variable
+00020b70: 7320 696e 2074 6869 7320 6461 7461 7365  s in this datase
+00020b80: 742e 204d 6973 7369 6e67 2076 616c 7565  t. Missing value
+00020b90: 7320 6172 6520 736b 6970 7065 642e 0a20  s are skipped.. 
+00020ba0: 2020 2020 2020 206d 6574 686f 6420 3a20         method : 
+00020bb0: 7b22 6c69 6e65 6172 222c 2022 6e65 6172  {"linear", "near
+00020bc0: 6573 7422 2c20 227a 6572 6f22 2c20 2273  est", "zero", "s
+00020bd0: 6c69 6e65 6172 222c 2022 7175 6164 7261  linear", "quadra
+00020be0: 7469 6322 2c20 2263 7562 6963 222c 2022  tic", "cubic", "
+00020bf0: 706f 6c79 6e6f 6d69 616c 222c 205c 0a20  polynomial", \. 
+00020c00: 2020 2020 2020 2020 2020 2022 6261 7279             "bary
+00020c10: 6365 6e74 7269 6322 2c20 226b 726f 6722  centric", "krog"
+00020c20: 2c20 2270 6368 6970 222c 2022 7370 6c69  , "pchip", "spli
+00020c30: 6e65 222c 2022 616b 696d 6122 7d2c 2064  ne", "akima"}, d
+00020c40: 6566 6175 6c74 3a20 226c 696e 6561 7222  efault: "linear"
+00020c50: 0a20 2020 2020 2020 2020 2020 2053 7472  .            Str
+00020c60: 696e 6720 696e 6469 6361 7469 6e67 2077  ing indicating w
+00020c70: 6869 6368 206d 6574 686f 6420 746f 2075  hich method to u
+00020c80: 7365 2066 6f72 2069 6e74 6572 706f 6c61  se for interpola
+00020c90: 7469 6f6e 3a0a 0a20 2020 2020 2020 2020  tion:..         
+00020ca0: 2020 202d 2027 6c69 6e65 6172 273a 206c     - 'linear': l
+00020cb0: 696e 6561 7220 696e 7465 7270 6f6c 6174  inear interpolat
+00020cc0: 696f 6e2e 2041 6464 6974 696f 6e61 6c20  ion. Additional 
+00020cd0: 6b65 7977 6f72 640a 2020 2020 2020 2020  keyword.        
+00020ce0: 2020 2020 2020 6172 6775 6d65 6e74 7320        arguments 
+00020cf0: 6172 6520 7061 7373 6564 2074 6f20 3a70  are passed to :p
+00020d00: 793a 6675 6e63 3a60 6e75 6d70 792e 696e  y:func:`numpy.in
+00020d10: 7465 7270 600a 2020 2020 2020 2020 2020  terp`.          
+00020d20: 2020 2d20 276e 6561 7265 7374 272c 2027    - 'nearest', '
+00020d30: 7a65 726f 272c 2027 736c 696e 6561 7227  zero', 'slinear'
+00020d40: 2c20 2771 7561 6472 6174 6963 272c 2027  , 'quadratic', '
+00020d50: 6375 6269 6327 2c20 2770 6f6c 796e 6f6d  cubic', 'polynom
+00020d60: 6961 6c27 3a0a 2020 2020 2020 2020 2020  ial':.          
+00020d70: 2020 2020 6172 6520 7061 7373 6564 2074      are passed t
+00020d80: 6f20 3a70 793a 6675 6e63 3a60 7363 6970  o :py:func:`scip
+00020d90: 792e 696e 7465 7270 6f6c 6174 652e 696e  y.interpolate.in
+00020da0: 7465 7270 3164 602e 2049 660a 2020 2020  terp1d`. If.    
+00020db0: 2020 2020 2020 2020 2020 6060 6d65 7468            ``meth
+00020dc0: 6f64 3d27 706f 6c79 6e6f 6d69 616c 2760  od='polynomial'`
+00020dd0: 602c 2074 6865 2060 606f 7264 6572 6060  `, the ``order``
+00020de0: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
+00020df0: 7420 6d75 7374 2061 6c73 6f20 6265 0a20  t must also be. 
+00020e00: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+00020e10: 7669 6465 642e 0a20 2020 2020 2020 2020  vided..         
+00020e20: 2020 202d 2027 6261 7279 6365 6e74 7269     - 'barycentri
+00020e30: 6327 2c20 276b 726f 6727 2c20 2770 6368  c', 'krog', 'pch
+00020e40: 6970 272c 2027 7370 6c69 6e65 272c 2027  ip', 'spline', '
+00020e50: 616b 696d 6127 3a20 7573 6520 7468 6569  akima': use thei
+00020e60: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+00020e70: 7265 7370 6563 7469 7665 203a 7079 3a63  respective :py:c
+00020e80: 6c61 7373 3a60 7363 6970 792e 696e 7465  lass:`scipy.inte
+00020e90: 7270 6f6c 6174 6560 2063 6c61 7373 6573  rpolate` classes
+00020ea0: 2e0a 0a20 2020 2020 2020 2061 7373 756d  ...        assum
+00020eb0: 655f 736f 7274 6564 203a 2062 6f6f 6c2c  e_sorted : bool,
+00020ec0: 2064 6566 6175 6c74 3a20 4661 6c73 650a   default: False.
+00020ed0: 2020 2020 2020 2020 2020 2020 4966 2046              If F
+00020ee0: 616c 7365 2c20 7661 6c75 6573 206f 6620  alse, values of 
+00020ef0: 636f 6f72 6469 6e61 7465 7320 7468 6174  coordinates that
+00020f00: 2061 7265 2069 6e74 6572 706f 6c61 7465   are interpolate
+00020f10: 6420 6f76 6572 2063 616e 2062 650a 2020  d over can be.  
+00020f20: 2020 2020 2020 2020 2020 696e 2061 6e79            in any
+00020f30: 206f 7264 6572 2061 6e64 2074 6865 7920   order and they 
+00020f40: 6172 6520 736f 7274 6564 2066 6972 7374  are sorted first
+00020f50: 2e20 4966 2054 7275 652c 2069 6e74 6572  . If True, inter
+00020f60: 706f 6c61 7465 640a 2020 2020 2020 2020  polated.        
+00020f70: 2020 2020 636f 6f72 6469 6e61 7465 7320      coordinates 
+00020f80: 6172 6520 6173 7375 6d65 6420 746f 2062  are assumed to b
+00020f90: 6520 616e 2061 7272 6179 206f 6620 6d6f  e an array of mo
+00020fa0: 6e6f 746f 6e69 6361 6c6c 7920 696e 6372  notonically incr
+00020fb0: 6561 7369 6e67 0a20 2020 2020 2020 2020  easing.         
+00020fc0: 2020 2076 616c 7565 732e 0a20 2020 2020     values..     
+00020fd0: 2020 206b 7761 7267 7320 3a20 6469 6374     kwargs : dict
+00020fe0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00020ff0: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
+00021000: 6c20 6b65 7977 6f72 6420 7061 7373 6564  l keyword passed
+00021010: 2074 6f20 7363 6970 7927 7320 696e 7465   to scipy's inte
+00021020: 7270 6f6c 6174 6f72 2e0a 2020 2020 2020  rpolator..      
+00021030: 2020 6d65 7468 6f64 5f6e 6f6e 5f6e 756d    method_non_num
+00021040: 6572 6963 203a 207b 226e 6561 7265 7374  eric : {"nearest
+00021050: 222c 2022 7061 6422 2c20 2266 6669 6c6c  ", "pad", "ffill
+00021060: 222c 2022 6261 636b 6669 6c6c 222c 2022  ", "backfill", "
+00021070: 6266 696c 6c22 7d2c 206f 7074 696f 6e61  bfill"}, optiona
+00021080: 6c0a 2020 2020 2020 2020 2020 2020 4d65  l.            Me
+00021090: 7468 6f64 2066 6f72 206e 6f6e 2d6e 756d  thod for non-num
+000210a0: 6572 6963 2074 7970 6573 2e20 5061 7373  eric types. Pass
+000210b0: 6564 206f 6e20 746f 203a 7079 3a6d 6574  ed on to :py:met
+000210c0: 683a 6044 6174 6173 6574 2e72 6569 6e64  h:`Dataset.reind
+000210d0: 6578 602e 0a20 2020 2020 2020 2020 2020  ex`..           
+000210e0: 2060 6022 6e65 6172 6573 7422 6060 2069   ``"nearest"`` i
+000210f0: 7320 7573 6564 2062 7920 6465 6661 756c  s used by defaul
+00021100: 742e 0a0a 2020 2020 2020 2020 5265 7475  t...        Retu
+00021110: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+00021120: 2d2d 2d0a 2020 2020 2020 2020 696e 7465  ---.        inte
+00021130: 7270 6f6c 6174 6564 203a 2044 6174 6173  rpolated : Datas
+00021140: 6574 0a20 2020 2020 2020 2020 2020 2041  et.            A
+00021150: 6e6f 7468 6572 2064 6174 6173 6574 2062  nother dataset b
+00021160: 7920 696e 7465 7270 6f6c 6174 696e 6720  y interpolating 
+00021170: 7468 6973 2064 6174 6173 6574 2773 2064  this dataset's d
+00021180: 6174 6120 616c 6f6e 6720 7468 650a 2020  ata along the.  
+00021190: 2020 2020 2020 2020 2020 636f 6f72 6469            coordi
+000211a0: 6e61 7465 7320 6f66 2074 6865 206f 7468  nates of the oth
+000211b0: 6572 206f 626a 6563 742e 0a0a 2020 2020  er object...    
+000211c0: 2020 2020 4e6f 7465 730a 2020 2020 2020      Notes.      
+000211d0: 2020 2d2d 2d2d 2d0a 2020 2020 2020 2020    -----.        
+000211e0: 7363 6970 7920 6973 2072 6571 7569 7265  scipy is require
+000211f0: 642e 0a20 2020 2020 2020 2049 6620 7468  d..        If th
+00021200: 6520 6461 7461 7365 7420 6861 7320 6f62  e dataset has ob
+00021210: 6a65 6374 2d74 7970 6520 636f 6f72 6469  ject-type coordi
+00021220: 6e61 7465 732c 2072 6569 6e64 6578 2069  nates, reindex i
+00021230: 7320 7573 6564 2066 6f72 2074 6865 7365  s used for these
+00021240: 0a20 2020 2020 2020 2063 6f6f 7264 696e  .        coordin
+00021250: 6174 6573 2069 6e73 7465 6164 206f 6620  ates instead of 
+00021260: 7468 6520 696e 7465 7270 6f6c 6174 696f  the interpolatio
+00021270: 6e2e 0a0a 2020 2020 2020 2020 5365 6520  n...        See 
+00021280: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+00021290: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
+000212a0: 7461 7365 742e 696e 7465 7270 0a20 2020  taset.interp.   
+000212b0: 2020 2020 2044 6174 6173 6574 2e72 6569       Dataset.rei
+000212c0: 6e64 6578 5f6c 696b 650a 2020 2020 2020  ndex_like.      
+000212d0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+000212e0: 206b 7761 7267 7320 6973 204e 6f6e 653a   kwargs is None:
+000212f0: 0a20 2020 2020 2020 2020 2020 206b 7761  .            kwa
+00021300: 7267 7320 3d20 7b7d 0a0a 2020 2020 2020  rgs = {}..      
+00021310: 2020 2320 7069 636b 206f 6e6c 7920 6469    # pick only di
+00021320: 6d65 6e73 696f 6e20 636f 6f72 6469 6e61  mension coordina
+00021330: 7465 7320 7769 7468 2061 2073 696e 676c  tes with a singl
+00021340: 6520 696e 6465 780a 2020 2020 2020 2020  e index.        
+00021350: 636f 6f72 6473 203d 207b 7d0a 2020 2020  coords = {}.    
+00021360: 2020 2020 6f74 6865 725f 696e 6465 7865      other_indexe
+00021370: 7320 3d20 6f74 6865 722e 7869 6e64 6578  s = other.xindex
+00021380: 6573 0a20 2020 2020 2020 2066 6f72 2064  es.        for d
+00021390: 696d 2069 6e20 7365 6c66 2e64 696d 733a  im in self.dims:
+000213a0: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
+000213b0: 6572 5f64 696d 5f63 6f6f 7264 7320 3d20  er_dim_coords = 
+000213c0: 6f74 6865 725f 696e 6465 7865 732e 6765  other_indexes.ge
+000213d0: 745f 616c 6c5f 636f 6f72 6473 2864 696d  t_all_coords(dim
+000213e0: 2c20 6572 726f 7273 3d22 6967 6e6f 7265  , errors="ignore
+000213f0: 2229 0a20 2020 2020 2020 2020 2020 2069  ").            i
+00021400: 6620 6c65 6e28 6f74 6865 725f 6469 6d5f  f len(other_dim_
+00021410: 636f 6f72 6473 2920 3d3d 2031 3a0a 2020  coords) == 1:.  
+00021420: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00021430: 6f72 6473 5b64 696d 5d20 3d20 6f74 6865  ords[dim] = othe
+00021440: 725f 6469 6d5f 636f 6f72 6473 5b64 696d  r_dim_coords[dim
+00021450: 5d0a 0a20 2020 2020 2020 206e 756d 6572  ]..        numer
+00021460: 6963 5f63 6f6f 7264 733a 2064 6963 745b  ic_coords: dict[
+00021470: 4861 7368 6162 6c65 2c20 7064 2e49 6e64  Hashable, pd.Ind
+00021480: 6578 5d20 3d20 7b7d 0a20 2020 2020 2020  ex] = {}.       
+00021490: 206f 626a 6563 745f 636f 6f72 6473 3a20   object_coords: 
+000214a0: 6469 6374 5b48 6173 6861 626c 652c 2070  dict[Hashable, p
+000214b0: 642e 496e 6465 785d 203d 207b 7d0a 2020  d.Index] = {}.  
+000214c0: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
+000214d0: 6e20 636f 6f72 6473 2e69 7465 6d73 2829  n coords.items()
+000214e0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000214f0: 2076 2e64 7479 7065 2e6b 696e 6420 696e   v.dtype.kind in
+00021500: 2022 7569 6663 4d6d 223a 0a20 2020 2020   "uifcMm":.     
+00021510: 2020 2020 2020 2020 2020 206e 756d 6572             numer
+00021520: 6963 5f63 6f6f 7264 735b 6b5d 203d 2076  ic_coords[k] = v
+00021530: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00021540: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00021550: 2020 206f 626a 6563 745f 636f 6f72 6473     object_coords
+00021560: 5b6b 5d20 3d20 760a 0a20 2020 2020 2020  [k] = v..       
+00021570: 2064 7320 3d20 7365 6c66 0a20 2020 2020   ds = self.     
+00021580: 2020 2069 6620 6f62 6a65 6374 5f63 6f6f     if object_coo
+00021590: 7264 733a 0a20 2020 2020 2020 2020 2020  rds:.           
+000215a0: 2023 2057 6520 646f 206e 6f74 2073 7570   # We do not sup
+000215b0: 706f 7274 2069 6e74 6572 706f 6c61 7469  port interpolati
+000215c0: 6f6e 2061 6c6f 6e67 206f 626a 6563 7420  on along object 
+000215d0: 636f 6f72 6469 6e61 7465 2e0a 2020 2020  coordinate..    
+000215e0: 2020 2020 2020 2020 2320 7265 696e 6465          # reinde
+000215f0: 7820 696e 7374 6561 642e 0a20 2020 2020  x instead..     
+00021600: 2020 2020 2020 2064 7320 3d20 7365 6c66         ds = self
+00021610: 2e72 6569 6e64 6578 286f 626a 6563 745f  .reindex(object_
+00021620: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
+00021630: 7265 7475 726e 2064 732e 696e 7465 7270  return ds.interp
+00021640: 280a 2020 2020 2020 2020 2020 2020 636f  (.            co
+00021650: 6f72 6473 3d6e 756d 6572 6963 5f63 6f6f  ords=numeric_coo
+00021660: 7264 732c 0a20 2020 2020 2020 2020 2020  rds,.           
+00021670: 206d 6574 686f 643d 6d65 7468 6f64 2c0a   method=method,.
+00021680: 2020 2020 2020 2020 2020 2020 6173 7375              assu
+00021690: 6d65 5f73 6f72 7465 643d 6173 7375 6d65  me_sorted=assume
+000216a0: 5f73 6f72 7465 642c 0a20 2020 2020 2020  _sorted,.       
+000216b0: 2020 2020 206b 7761 7267 733d 6b77 6172       kwargs=kwar
+000216c0: 6773 2c0a 2020 2020 2020 2020 2020 2020  gs,.            
+000216d0: 6d65 7468 6f64 5f6e 6f6e 5f6e 756d 6572  method_non_numer
+000216e0: 6963 3d6d 6574 686f 645f 6e6f 6e5f 6e75  ic=method_non_nu
+000216f0: 6d65 7269 632c 0a20 2020 2020 2020 2029  meric,.        )
+00021700: 0a0a 2020 2020 2320 4865 6c70 6572 206d  ..    # Helper m
+00021710: 6574 686f 6473 2066 6f72 2072 656e 616d  ethods for renam
+00021720: 6528 290a 2020 2020 6465 6620 5f72 656e  e().    def _ren
+00021730: 616d 655f 7661 7273 280a 2020 2020 2020  ame_vars(.      
+00021740: 2020 7365 6c66 2c20 6e61 6d65 5f64 6963    self, name_dic
+00021750: 742c 2064 696d 735f 6469 6374 0a20 2020  t, dims_dict.   
+00021760: 2029 202d 3e20 7475 706c 655b 6469 6374   ) -> tuple[dict
+00021770: 5b48 6173 6861 626c 652c 2056 6172 6961  [Hashable, Varia
+00021780: 626c 655d 2c20 7365 745b 4861 7368 6162  ble], set[Hashab
+00021790: 6c65 5d5d 3a0a 2020 2020 2020 2020 7661  le]]:.        va
+000217a0: 7269 6162 6c65 7320 3d20 7b7d 0a20 2020  riables = {}.   
+000217b0: 2020 2020 2063 6f6f 7264 5f6e 616d 6573       coord_names
+000217c0: 203d 2073 6574 2829 0a20 2020 2020 2020   = set().       
+000217d0: 2066 6f72 206b 2c20 7620 696e 2073 656c   for k, v in sel
+000217e0: 662e 7661 7269 6162 6c65 732e 6974 656d  f.variables.item
+000217f0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00021800: 2076 6172 203d 2076 2e63 6f70 7928 6465   var = v.copy(de
+00021810: 6570 3d46 616c 7365 290a 2020 2020 2020  ep=False).      
+00021820: 2020 2020 2020 7661 722e 6469 6d73 203d        var.dims =
+00021830: 2074 7570 6c65 2864 696d 735f 6469 6374   tuple(dims_dict
+00021840: 2e67 6574 2864 696d 2c20 6469 6d29 2066  .get(dim, dim) f
+00021850: 6f72 2064 696d 2069 6e20 762e 6469 6d73  or dim in v.dims
+00021860: 290a 2020 2020 2020 2020 2020 2020 6e61  ).            na
+00021870: 6d65 203d 206e 616d 655f 6469 6374 2e67  me = name_dict.g
+00021880: 6574 286b 2c20 6b29 0a20 2020 2020 2020  et(k, k).       
+00021890: 2020 2020 2069 6620 6e61 6d65 2069 6e20       if name in 
+000218a0: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
+000218b0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000218c0: 2056 616c 7565 4572 726f 7228 6622 7468   ValueError(f"th
+000218d0: 6520 6e65 7720 6e61 6d65 207b 6e61 6d65  e new name {name
+000218e0: 2172 7d20 636f 6e66 6c69 6374 7322 290a  !r} conflicts").
+000218f0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+00021900: 6162 6c65 735b 6e61 6d65 5d20 3d20 7661  ables[name] = va
+00021910: 720a 2020 2020 2020 2020 2020 2020 6966  r.            if
+00021920: 206b 2069 6e20 7365 6c66 2e5f 636f 6f72   k in self._coor
+00021930: 645f 6e61 6d65 733a 0a20 2020 2020 2020  d_names:.       
+00021940: 2020 2020 2020 2020 2063 6f6f 7264 5f6e           coord_n
+00021950: 616d 6573 2e61 6464 286e 616d 6529 0a20  ames.add(name). 
+00021960: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
+00021970: 7269 6162 6c65 732c 2063 6f6f 7264 5f6e  riables, coord_n
+00021980: 616d 6573 0a0a 2020 2020 6465 6620 5f72  ames..    def _r
+00021990: 656e 616d 655f 6469 6d73 2873 656c 662c  ename_dims(self,
+000219a0: 206e 616d 655f 6469 6374 3a20 4d61 7070   name_dict: Mapp
+000219b0: 696e 675b 416e 792c 2048 6173 6861 626c  ing[Any, Hashabl
+000219c0: 655d 2920 2d3e 2064 6963 745b 4861 7368  e]) -> dict[Hash
+000219d0: 6162 6c65 2c20 696e 745d 3a0a 2020 2020  able, int]:.    
+000219e0: 2020 2020 7265 7475 726e 207b 6e61 6d65      return {name
+000219f0: 5f64 6963 742e 6765 7428 6b2c 206b 293a  _dict.get(k, k):
+00021a00: 2076 2066 6f72 206b 2c20 7620 696e 2073   v for k, v in s
+00021a10: 656c 662e 6469 6d73 2e69 7465 6d73 2829  elf.dims.items()
+00021a20: 7d0a 0a20 2020 2064 6566 205f 7265 6e61  }..    def _rena
+00021a30: 6d65 5f69 6e64 6578 6573 280a 2020 2020  me_indexes(.    
+00021a40: 2020 2020 7365 6c66 2c20 6e61 6d65 5f64      self, name_d
+00021a50: 6963 743a 204d 6170 7069 6e67 5b41 6e79  ict: Mapping[Any
+00021a60: 2c20 4861 7368 6162 6c65 5d2c 2064 696d  , Hashable], dim
+00021a70: 735f 6469 6374 3a20 4d61 7070 696e 675b  s_dict: Mapping[
+00021a80: 416e 792c 2048 6173 6861 626c 655d 0a20  Any, Hashable]. 
+00021a90: 2020 2029 202d 3e20 7475 706c 655b 6469     ) -> tuple[di
+00021aa0: 6374 5b48 6173 6861 626c 652c 2049 6e64  ct[Hashable, Ind
+00021ab0: 6578 5d2c 2064 6963 745b 4861 7368 6162  ex], dict[Hashab
+00021ac0: 6c65 2c20 5661 7269 6162 6c65 5d5d 3a0a  le, Variable]]:.
+00021ad0: 2020 2020 2020 2020 6966 206e 6f74 2073          if not s
+00021ae0: 656c 662e 5f69 6e64 6578 6573 3a0a 2020  elf._indexes:.  
+00021af0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00021b00: 207b 7d2c 207b 7d0a 0a20 2020 2020 2020   {}, {}..       
+00021b10: 2069 6e64 6578 6573 203d 207b 7d0a 2020   indexes = {}.  
+00021b20: 2020 2020 2020 7661 7269 6162 6c65 7320        variables 
+00021b30: 3d20 7b7d 0a0a 2020 2020 2020 2020 666f  = {}..        fo
+00021b40: 7220 696e 6465 782c 2063 6f6f 7264 5f6e  r index, coord_n
+00021b50: 616d 6573 2069 6e20 7365 6c66 2e78 696e  ames in self.xin
+00021b60: 6465 7865 732e 6772 6f75 705f 6279 5f69  dexes.group_by_i
+00021b70: 6e64 6578 2829 3a0a 2020 2020 2020 2020  ndex():.        
+00021b80: 2020 2020 6e65 775f 696e 6465 7820 3d20      new_index = 
+00021b90: 696e 6465 782e 7265 6e61 6d65 286e 616d  index.rename(nam
+00021ba0: 655f 6469 6374 2c20 6469 6d73 5f64 6963  e_dict, dims_dic
+00021bb0: 7429 0a20 2020 2020 2020 2020 2020 206e  t).            n
+00021bc0: 6577 5f63 6f6f 7264 5f6e 616d 6573 203d  ew_coord_names =
+00021bd0: 205b 6e61 6d65 5f64 6963 742e 6765 7428   [name_dict.get(
+00021be0: 6b2c 206b 2920 666f 7220 6b20 696e 2063  k, k) for k in c
+00021bf0: 6f6f 7264 5f6e 616d 6573 5d0a 2020 2020  oord_names].    
+00021c00: 2020 2020 2020 2020 696e 6465 7865 732e          indexes.
+00021c10: 7570 6461 7465 287b 6b3a 206e 6577 5f69  update({k: new_i
+00021c20: 6e64 6578 2066 6f72 206b 2069 6e20 6e65  ndex for k in ne
+00021c30: 775f 636f 6f72 645f 6e61 6d65 737d 290a  w_coord_names}).
+00021c40: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00021c50: 696e 6465 785f 7661 7273 203d 206e 6577  index_vars = new
+00021c60: 5f69 6e64 6578 2e63 7265 6174 655f 7661  _index.create_va
+00021c70: 7269 6162 6c65 7328 0a20 2020 2020 2020  riables(.       
+00021c80: 2020 2020 2020 2020 207b 0a20 2020 2020           {.     
+00021c90: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00021ca0: 6577 3a20 7365 6c66 2e5f 7661 7269 6162  ew: self._variab
+00021cb0: 6c65 735b 6f6c 645d 0a20 2020 2020 2020  les[old].       
+00021cc0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+00021cd0: 206f 6c64 2c20 6e65 7720 696e 207a 6970   old, new in zip
+00021ce0: 2863 6f6f 7264 5f6e 616d 6573 2c20 6e65  (coord_names, ne
+00021cf0: 775f 636f 6f72 645f 6e61 6d65 7329 0a20  w_coord_names). 
+00021d00: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00021d10: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00021d20: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00021d30: 626c 6573 2e75 7064 6174 6528 6e65 775f  bles.update(new_
+00021d40: 696e 6465 785f 7661 7273 290a 0a20 2020  index_vars)..   
+00021d50: 2020 2020 2072 6574 7572 6e20 696e 6465       return inde
+00021d60: 7865 732c 2076 6172 6961 626c 6573 0a0a  xes, variables..
+00021d70: 2020 2020 6465 6620 5f72 656e 616d 655f      def _rename_
+00021d80: 616c 6c28 0a20 2020 2020 2020 2073 656c  all(.        sel
+00021d90: 662c 206e 616d 655f 6469 6374 3a20 4d61  f, name_dict: Ma
+00021da0: 7070 696e 675b 416e 792c 2048 6173 6861  pping[Any, Hasha
+00021db0: 626c 655d 2c20 6469 6d73 5f64 6963 743a  ble], dims_dict:
+00021dc0: 204d 6170 7069 6e67 5b41 6e79 2c20 4861   Mapping[Any, Ha
+00021dd0: 7368 6162 6c65 5d0a 2020 2020 2920 2d3e  shable].    ) ->
+00021de0: 2074 7570 6c65 5b0a 2020 2020 2020 2020   tuple[.        
+00021df0: 6469 6374 5b48 6173 6861 626c 652c 2056  dict[Hashable, V
+00021e00: 6172 6961 626c 655d 2c0a 2020 2020 2020  ariable],.      
+00021e10: 2020 7365 745b 4861 7368 6162 6c65 5d2c    set[Hashable],
+00021e20: 0a20 2020 2020 2020 2064 6963 745b 4861  .        dict[Ha
+00021e30: 7368 6162 6c65 2c20 696e 745d 2c0a 2020  shable, int],.  
+00021e40: 2020 2020 2020 6469 6374 5b48 6173 6861        dict[Hasha
+00021e50: 626c 652c 2049 6e64 6578 5d2c 0a20 2020  ble, Index],.   
+00021e60: 205d 3a0a 2020 2020 2020 2020 7661 7269   ]:.        vari
+00021e70: 6162 6c65 732c 2063 6f6f 7264 5f6e 616d  ables, coord_nam
+00021e80: 6573 203d 2073 656c 662e 5f72 656e 616d  es = self._renam
+00021e90: 655f 7661 7273 286e 616d 655f 6469 6374  e_vars(name_dict
+00021ea0: 2c20 6469 6d73 5f64 6963 7429 0a20 2020  , dims_dict).   
+00021eb0: 2020 2020 2064 696d 7320 3d20 7365 6c66       dims = self
+00021ec0: 2e5f 7265 6e61 6d65 5f64 696d 7328 6469  ._rename_dims(di
+00021ed0: 6d73 5f64 6963 7429 0a0a 2020 2020 2020  ms_dict)..      
+00021ee0: 2020 696e 6465 7865 732c 2069 6e64 6578    indexes, index
+00021ef0: 5f76 6172 7320 3d20 7365 6c66 2e5f 7265  _vars = self._re
+00021f00: 6e61 6d65 5f69 6e64 6578 6573 286e 616d  name_indexes(nam
+00021f10: 655f 6469 6374 2c20 6469 6d73 5f64 6963  e_dict, dims_dic
+00021f20: 7429 0a20 2020 2020 2020 2076 6172 6961  t).        varia
+00021f30: 626c 6573 203d 207b 6b3a 2069 6e64 6578  bles = {k: index
+00021f40: 5f76 6172 732e 6765 7428 6b2c 2076 2920  _vars.get(k, v) 
+00021f50: 666f 7220 6b2c 2076 2069 6e20 7661 7269  for k, v in vari
+00021f60: 6162 6c65 732e 6974 656d 7328 297d 0a0a  ables.items()}..
+00021f70: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+00021f80: 6172 6961 626c 6573 2c20 636f 6f72 645f  ariables, coord_
+00021f90: 6e61 6d65 732c 2064 696d 732c 2069 6e64  names, dims, ind
+00021fa0: 6578 6573 0a0a 2020 2020 6465 6620 5f72  exes..    def _r
+00021fb0: 656e 616d 6528 0a20 2020 2020 2020 2073  ename(.        s
+00021fc0: 656c 663a 2054 5f44 6174 6173 6574 2c0a  elf: T_Dataset,.
+00021fd0: 2020 2020 2020 2020 6e61 6d65 5f64 6963          name_dic
+00021fe0: 743a 204d 6170 7069 6e67 5b41 6e79 2c20  t: Mapping[Any, 
+00021ff0: 4861 7368 6162 6c65 5d20 7c20 4e6f 6e65  Hashable] | None
+00022000: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00022010: 202a 2a6e 616d 6573 3a20 4861 7368 6162   **names: Hashab
+00022020: 6c65 2c0a 2020 2020 2920 2d3e 2054 5f44  le,.    ) -> T_D
+00022030: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00022040: 2222 2241 6c73 6f20 7573 6564 2069 6e74  """Also used int
+00022050: 6572 6e61 6c6c 7920 6279 2044 6174 6141  ernally by DataA
+00022060: 7272 6179 2073 6f20 7468 6174 2074 6865  rray so that the
+00022070: 2077 6172 6e69 6e67 2028 6966 2061 6e79   warning (if any
+00022080: 290a 2020 2020 2020 2020 6973 2072 6169  ).        is rai
+00022090: 7365 6420 6174 2074 6865 2072 6967 6874  sed at the right
+000220a0: 2073 7461 636b 206c 6576 656c 2e0a 2020   stack level..  
+000220b0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000220c0: 2020 6e61 6d65 5f64 6963 7420 3d20 6569    name_dict = ei
+000220d0: 7468 6572 5f64 6963 745f 6f72 5f6b 7761  ther_dict_or_kwa
+000220e0: 7267 7328 6e61 6d65 5f64 6963 742c 206e  rgs(name_dict, n
+000220f0: 616d 6573 2c20 2272 656e 616d 6522 290a  ames, "rename").
+00022100: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
+00022110: 206e 616d 655f 6469 6374 2e6b 6579 7328   name_dict.keys(
+00022120: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00022130: 6620 6b20 6e6f 7420 696e 2073 656c 6620  f k not in self 
+00022140: 616e 6420 6b20 6e6f 7420 696e 2073 656c  and k not in sel
+00022150: 662e 6469 6d73 3a0a 2020 2020 2020 2020  f.dims:.        
+00022160: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00022170: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00022180: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00022190: 6361 6e6e 6f74 2072 656e 616d 6520 7b6b  cannot rename {k
+000221a0: 2172 7d20 6265 6361 7573 6520 6974 2069  !r} because it i
+000221b0: 7320 6e6f 7420 6120 220a 2020 2020 2020  s not a ".      
+000221c0: 2020 2020 2020 2020 2020 2020 2020 2276                "v
+000221d0: 6172 6961 626c 6520 6f72 2064 696d 656e  ariable or dimen
+000221e0: 7369 6f6e 2069 6e20 7468 6973 2064 6174  sion in this dat
+000221f0: 6173 6574 220a 2020 2020 2020 2020 2020  aset".          
+00022200: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00022210: 2020 2020 2063 7265 6174 655f 6469 6d5f       create_dim_
+00022220: 636f 6f72 6420 3d20 4661 6c73 650a 2020  coord = False.  
+00022230: 2020 2020 2020 2020 2020 6e65 775f 6b20            new_k 
+00022240: 3d20 6e61 6d65 5f64 6963 745b 6b5d 0a0a  = name_dict[k]..
+00022250: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+00022260: 2069 6e20 7365 6c66 2e64 696d 7320 616e   in self.dims an
+00022270: 6420 6e65 775f 6b20 696e 2073 656c 662e  d new_k in self.
+00022280: 5f63 6f6f 7264 5f6e 616d 6573 3a0a 2020  _coord_names:.  
+00022290: 2020 2020 2020 2020 2020 2020 2020 636f                co
+000222a0: 6f72 645f 6469 6d73 203d 2073 656c 662e  ord_dims = self.
+000222b0: 5f76 6172 6961 626c 6573 5b6e 616d 655f  _variables[name_
+000222c0: 6469 6374 5b6b 5d5d 2e64 696d 730a 2020  dict[k]].dims.  
+000222d0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000222e0: 2063 6f6f 7264 5f64 696d 7320 3d3d 2028   coord_dims == (
+000222f0: 6b2c 293a 0a20 2020 2020 2020 2020 2020  k,):.           
+00022300: 2020 2020 2020 2020 2063 7265 6174 655f           create_
+00022310: 6469 6d5f 636f 6f72 6420 3d20 5472 7565  dim_coord = True
+00022320: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+00022330: 6620 6b20 696e 2073 656c 662e 5f63 6f6f  f k in self._coo
+00022340: 7264 5f6e 616d 6573 2061 6e64 206e 6577  rd_names and new
+00022350: 5f6b 2069 6e20 7365 6c66 2e64 696d 733a  _k in self.dims:
+00022360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022370: 2063 6f6f 7264 5f64 696d 7320 3d20 7365   coord_dims = se
+00022380: 6c66 2e5f 7661 7269 6162 6c65 735b 6b5d  lf._variables[k]
+00022390: 2e64 696d 730a 2020 2020 2020 2020 2020  .dims.          
+000223a0: 2020 2020 2020 6966 2063 6f6f 7264 5f64        if coord_d
+000223b0: 696d 7320 3d3d 2028 6e65 775f 6b2c 293a  ims == (new_k,):
+000223c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000223d0: 2020 2020 2063 7265 6174 655f 6469 6d5f       create_dim_
+000223e0: 636f 6f72 6420 3d20 5472 7565 0a0a 2020  coord = True..  
+000223f0: 2020 2020 2020 2020 2020 6966 2063 7265            if cre
+00022400: 6174 655f 6469 6d5f 636f 6f72 643a 0a20  ate_dim_coord:. 
+00022410: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00022420: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+00022430: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022440: 2020 6622 7265 6e61 6d65 207b 6b21 727d    f"rename {k!r}
+00022450: 2074 6f20 7b6e 616d 655f 6469 6374 5b6b   to {name_dict[k
+00022460: 5d21 727d 2064 6f65 7320 6e6f 7420 6372  ]!r} does not cr
+00022470: 6561 7465 2061 6e20 696e 6465 7820 220a  eate an index ".
+00022480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022490: 2020 2020 2261 6e79 6d6f 7265 2e20 5472      "anymore. Tr
+000224a0: 7920 7573 696e 6720 7377 6170 5f64 696d  y using swap_dim
+000224b0: 7320 696e 7374 6561 6420 6f72 2075 7365  s instead or use
+000224c0: 2073 6574 5f69 6e64 6578 2022 0a20 2020   set_index ".   
+000224d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000224e0: 2022 6166 7465 7220 7265 6e61 6d65 2074   "after rename t
+000224f0: 6f20 6372 6561 7465 2061 6e20 696e 6465  o create an inde
+00022500: 7865 6420 636f 6f72 6469 6e61 7465 2e22  xed coordinate."
+00022510: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00022520: 2020 2020 2020 5573 6572 5761 726e 696e        UserWarnin
+00022530: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
+00022540: 2020 2020 2020 2073 7461 636b 6c65 7665         stackleve
+00022550: 6c3d 332c 0a20 2020 2020 2020 2020 2020  l=3,.           
+00022560: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00022570: 7661 7269 6162 6c65 732c 2063 6f6f 7264  variables, coord
+00022580: 5f6e 616d 6573 2c20 6469 6d73 2c20 696e  _names, dims, in
+00022590: 6465 7865 7320 3d20 7365 6c66 2e5f 7265  dexes = self._re
+000225a0: 6e61 6d65 5f61 6c6c 280a 2020 2020 2020  name_all(.      
+000225b0: 2020 2020 2020 6e61 6d65 5f64 6963 743d        name_dict=
+000225c0: 6e61 6d65 5f64 6963 742c 2064 696d 735f  name_dict, dims_
+000225d0: 6469 6374 3d6e 616d 655f 6469 6374 0a20  dict=name_dict. 
+000225e0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+000225f0: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
+00022600: 706c 6163 6528 7661 7269 6162 6c65 732c  place(variables,
+00022610: 2063 6f6f 7264 5f6e 616d 6573 2c20 6469   coord_names, di
+00022620: 6d73 3d64 696d 732c 2069 6e64 6578 6573  ms=dims, indexes
+00022630: 3d69 6e64 6578 6573 290a 0a20 2020 2064  =indexes)..    d
+00022640: 6566 2072 656e 616d 6528 0a20 2020 2020  ef rename(.     
+00022650: 2020 2073 656c 663a 2054 5f44 6174 6173     self: T_Datas
+00022660: 6574 2c0a 2020 2020 2020 2020 6e61 6d65  et,.        name
+00022670: 5f64 6963 743a 204d 6170 7069 6e67 5b41  _dict: Mapping[A
+00022680: 6e79 2c20 4861 7368 6162 6c65 5d20 7c20  ny, Hashable] | 
+00022690: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+000226a0: 2020 2020 202a 2a6e 616d 6573 3a20 4861       **names: Ha
+000226b0: 7368 6162 6c65 2c0a 2020 2020 2920 2d3e  shable,.    ) ->
+000226c0: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
+000226d0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
+000226e0: 206e 6577 206f 626a 6563 7420 7769 7468   new object with
+000226f0: 2072 656e 616d 6564 2076 6172 6961 626c   renamed variabl
+00022700: 6573 2c20 636f 6f72 6469 6e61 7465 7320  es, coordinates 
+00022710: 616e 6420 6469 6d65 6e73 696f 6e73 2e0a  and dimensions..
+00022720: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00022730: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00022740: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
+00022750: 616d 655f 6469 6374 203a 2064 6963 742d  ame_dict : dict-
+00022760: 6c69 6b65 2c20 6f70 7469 6f6e 616c 0a20  like, optional. 
+00022770: 2020 2020 2020 2020 2020 2044 6963 7469             Dicti
+00022780: 6f6e 6172 7920 7768 6f73 6520 6b65 7973  onary whose keys
+00022790: 2061 7265 2063 7572 7265 6e74 2076 6172   are current var
+000227a0: 6961 626c 652c 2063 6f6f 7264 696e 6174  iable, coordinat
+000227b0: 6520 6f72 2064 696d 656e 7369 6f6e 206e  e or dimension n
+000227c0: 616d 6573 2061 6e64 0a20 2020 2020 2020  ames and.       
+000227d0: 2020 2020 2077 686f 7365 2076 616c 7565       whose value
+000227e0: 7320 6172 6520 7468 6520 6465 7369 7265  s are the desire
+000227f0: 6420 6e61 6d65 732e 0a20 2020 2020 2020  d names..       
+00022800: 202a 2a6e 616d 6573 203a 206f 7074 696f   **names : optio
+00022810: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00022820: 4b65 7977 6f72 6420 666f 726d 206f 6620  Keyword form of 
+00022830: 6060 6e61 6d65 5f64 6963 7460 602e 0a20  ``name_dict``.. 
+00022840: 2020 2020 2020 2020 2020 204f 6e65 206f             One o
+00022850: 6620 6e61 6d65 5f64 6963 7420 6f72 206e  f name_dict or n
+00022860: 616d 6573 206d 7573 7420 6265 2070 726f  ames must be pro
+00022870: 7669 6465 642e 0a0a 2020 2020 2020 2020  vided...        
+00022880: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00022890: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000228a0: 7265 6e61 6d65 6420 3a20 4461 7461 7365  renamed : Datase
+000228b0: 740a 2020 2020 2020 2020 2020 2020 4461  t.            Da
+000228c0: 7461 7365 7420 7769 7468 2072 656e 616d  taset with renam
+000228d0: 6564 2076 6172 6961 626c 6573 2c20 636f  ed variables, co
+000228e0: 6f72 6469 6e61 7465 7320 616e 6420 6469  ordinates and di
+000228f0: 6d65 6e73 696f 6e73 2e0a 0a20 2020 2020  mensions...     
+00022900: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+00022910: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+00022920: 2020 2020 2044 6174 6173 6574 2e73 7761       Dataset.swa
+00022930: 705f 6469 6d73 0a20 2020 2020 2020 2044  p_dims.        D
+00022940: 6174 6173 6574 2e72 656e 616d 655f 7661  ataset.rename_va
+00022950: 7273 0a20 2020 2020 2020 2044 6174 6173  rs.        Datas
+00022960: 6574 2e72 656e 616d 655f 6469 6d73 0a20  et.rename_dims. 
+00022970: 2020 2020 2020 2044 6174 6141 7272 6179         DataArray
+00022980: 2e72 656e 616d 650a 2020 2020 2020 2020  .rename.        
+00022990: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+000229a0: 726e 2073 656c 662e 5f72 656e 616d 6528  rn self._rename(
+000229b0: 6e61 6d65 5f64 6963 743d 6e61 6d65 5f64  name_dict=name_d
+000229c0: 6963 742c 202a 2a6e 616d 6573 290a 0a20  ict, **names).. 
+000229d0: 2020 2064 6566 2072 656e 616d 655f 6469     def rename_di
+000229e0: 6d73 280a 2020 2020 2020 2020 7365 6c66  ms(.        self
+000229f0: 3a20 545f 4461 7461 7365 742c 0a20 2020  : T_Dataset,.   
+00022a00: 2020 2020 2064 696d 735f 6469 6374 3a20       dims_dict: 
+00022a10: 4d61 7070 696e 675b 416e 792c 2048 6173  Mapping[Any, Has
+00022a20: 6861 626c 655d 207c 204e 6f6e 6520 3d20  hable] | None = 
+00022a30: 4e6f 6e65 2c0a 2020 2020 2020 2020 2a2a  None,.        **
+00022a40: 6469 6d73 3a20 4861 7368 6162 6c65 2c0a  dims: Hashable,.
+00022a50: 2020 2020 2920 2d3e 2054 5f44 6174 6173      ) -> T_Datas
+00022a60: 6574 3a0a 2020 2020 2020 2020 2222 2252  et:.        """R
+00022a70: 6574 7572 6e73 2061 206e 6577 206f 626a  eturns a new obj
+00022a80: 6563 7420 7769 7468 2072 656e 616d 6564  ect with renamed
+00022a90: 2064 696d 656e 7369 6f6e 7320 6f6e 6c79   dimensions only
+00022aa0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00022ab0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00022ac0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00022ad0: 2064 696d 735f 6469 6374 203a 2064 6963   dims_dict : dic
+00022ae0: 742d 6c69 6b65 2c20 6f70 7469 6f6e 616c  t-like, optional
+00022af0: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
+00022b00: 7469 6f6e 6172 7920 7768 6f73 6520 6b65  tionary whose ke
+00022b10: 7973 2061 7265 2063 7572 7265 6e74 2064  ys are current d
+00022b20: 696d 656e 7369 6f6e 206e 616d 6573 2061  imension names a
+00022b30: 6e64 0a20 2020 2020 2020 2020 2020 2077  nd.            w
+00022b40: 686f 7365 2076 616c 7565 7320 6172 6520  hose values are 
+00022b50: 7468 6520 6465 7369 7265 6420 6e61 6d65  the desired name
+00022b60: 732e 2054 6865 2064 6573 6972 6564 206e  s. The desired n
+00022b70: 616d 6573 206d 7573 740a 2020 2020 2020  ames must.      
+00022b80: 2020 2020 2020 6e6f 7420 6265 2074 6865        not be the
+00022b90: 206e 616d 6520 6f66 2061 6e20 6578 6973   name of an exis
+00022ba0: 7469 6e67 2064 696d 656e 7369 6f6e 206f  ting dimension o
+00022bb0: 7220 5661 7269 6162 6c65 2069 6e20 7468  r Variable in th
+00022bc0: 6520 4461 7461 7365 742e 0a20 2020 2020  e Dataset..     
+00022bd0: 2020 202a 2a64 696d 7320 3a20 6f70 7469     **dims : opti
+00022be0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00022bf0: 204b 6579 776f 7264 2066 6f72 6d20 6f66   Keyword form of
+00022c00: 2060 6064 696d 735f 6469 6374 6060 2e0a   ``dims_dict``..
+00022c10: 2020 2020 2020 2020 2020 2020 4f6e 6520              One 
+00022c20: 6f66 2064 696d 735f 6469 6374 206f 7220  of dims_dict or 
+00022c30: 6469 6d73 206d 7573 7420 6265 2070 726f  dims must be pro
+00022c40: 7669 6465 642e 0a0a 2020 2020 2020 2020  vided...        
+00022c50: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00022c60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00022c70: 7265 6e61 6d65 6420 3a20 4461 7461 7365  renamed : Datase
+00022c80: 740a 2020 2020 2020 2020 2020 2020 4461  t.            Da
+00022c90: 7461 7365 7420 7769 7468 2072 656e 616d  taset with renam
+00022ca0: 6564 2064 696d 656e 7369 6f6e 732e 0a0a  ed dimensions...
+00022cb0: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+00022cc0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00022cd0: 2d0a 2020 2020 2020 2020 4461 7461 7365  -.        Datase
+00022ce0: 742e 7377 6170 5f64 696d 730a 2020 2020  t.swap_dims.    
+00022cf0: 2020 2020 4461 7461 7365 742e 7265 6e61      Dataset.rena
+00022d00: 6d65 0a20 2020 2020 2020 2044 6174 6173  me.        Datas
+00022d10: 6574 2e72 656e 616d 655f 7661 7273 0a20  et.rename_vars. 
+00022d20: 2020 2020 2020 2044 6174 6141 7272 6179         DataArray
+00022d30: 2e72 656e 616d 650a 2020 2020 2020 2020  .rename.        
+00022d40: 2222 220a 2020 2020 2020 2020 6469 6d73  """.        dims
+00022d50: 5f64 6963 7420 3d20 6569 7468 6572 5f64  _dict = either_d
+00022d60: 6963 745f 6f72 5f6b 7761 7267 7328 6469  ict_or_kwargs(di
+00022d70: 6d73 5f64 6963 742c 2064 696d 732c 2022  ms_dict, dims, "
+00022d80: 7265 6e61 6d65 5f64 696d 7322 290a 2020  rename_dims").  
+00022d90: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
+00022da0: 6e20 6469 6d73 5f64 6963 742e 6974 656d  n dims_dict.item
+00022db0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00022dc0: 2069 6620 6b20 6e6f 7420 696e 2073 656c   if k not in sel
+00022dd0: 662e 6469 6d73 3a0a 2020 2020 2020 2020  f.dims:.        
+00022de0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00022df0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00022e00: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00022e10: 6361 6e6e 6f74 2072 656e 616d 6520 7b6b  cannot rename {k
+00022e20: 2172 7d20 6265 6361 7573 6520 6974 2069  !r} because it i
+00022e30: 7320 6e6f 7420 6120 220a 2020 2020 2020  s not a ".      
+00022e40: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+00022e50: 696d 656e 7369 6f6e 2069 6e20 7468 6973  imension in this
+00022e60: 2064 6174 6173 6574 220a 2020 2020 2020   dataset".      
+00022e70: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00022e80: 2020 2020 2020 2020 6966 2076 2069 6e20          if v in 
+00022e90: 7365 6c66 2e64 696d 7320 6f72 2076 2069  self.dims or v i
+00022ea0: 6e20 7365 6c66 3a0a 2020 2020 2020 2020  n self:.        
+00022eb0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00022ec0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00022ed0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00022ee0: 4361 6e6e 6f74 2072 656e 616d 6520 7b6b  Cannot rename {k
+00022ef0: 7d20 746f 207b 767d 2062 6563 6175 7365  } to {v} because
+00022f00: 207b 767d 2061 6c72 6561 6479 2065 7869   {v} already exi
+00022f10: 7374 732e 2022 0a20 2020 2020 2020 2020  sts. ".         
+00022f20: 2020 2020 2020 2020 2020 2022 5472 7920             "Try 
+00022f30: 7573 696e 6720 7377 6170 5f64 696d 7320  using swap_dims 
+00022f40: 696e 7374 6561 642e 220a 2020 2020 2020  instead.".      
+00022f50: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00022f60: 2020 2020 2076 6172 6961 626c 6573 2c20       variables, 
+00022f70: 636f 6f72 645f 6e61 6d65 732c 2073 697a  coord_names, siz
+00022f80: 6573 2c20 696e 6465 7865 7320 3d20 7365  es, indexes = se
+00022f90: 6c66 2e5f 7265 6e61 6d65 5f61 6c6c 280a  lf._rename_all(.
+00022fa0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00022fb0: 5f64 6963 743d 7b7d 2c20 6469 6d73 5f64  _dict={}, dims_d
+00022fc0: 6963 743d 6469 6d73 5f64 6963 740a 2020  ict=dims_dict.  
+00022fd0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00022fe0: 7265 7475 726e 2073 656c 662e 5f72 6570  return self._rep
+00022ff0: 6c61 6365 2876 6172 6961 626c 6573 2c20  lace(variables, 
+00023000: 636f 6f72 645f 6e61 6d65 732c 2064 696d  coord_names, dim
+00023010: 733d 7369 7a65 732c 2069 6e64 6578 6573  s=sizes, indexes
+00023020: 3d69 6e64 6578 6573 290a 0a20 2020 2064  =indexes)..    d
+00023030: 6566 2072 656e 616d 655f 7661 7273 280a  ef rename_vars(.
+00023040: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
+00023050: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
+00023060: 206e 616d 655f 6469 6374 3a20 4d61 7070   name_dict: Mapp
+00023070: 696e 675b 416e 792c 2048 6173 6861 626c  ing[Any, Hashabl
+00023080: 655d 207c 204e 6f6e 6520 3d20 4e6f 6e65  e] | None = None
+00023090: 2c0a 2020 2020 2020 2020 2a2a 6e61 6d65  ,.        **name
+000230a0: 733a 2048 6173 6861 626c 652c 0a20 2020  s: Hashable,.   
+000230b0: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
+000230c0: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
+000230d0: 726e 7320 6120 6e65 7720 6f62 6a65 6374  rns a new object
+000230e0: 2077 6974 6820 7265 6e61 6d65 6420 7661   with renamed va
+000230f0: 7269 6162 6c65 7320 696e 636c 7564 696e  riables includin
+00023100: 6720 636f 6f72 6469 6e61 7465 730a 0a20  g coordinates.. 
+00023110: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00023120: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00023130: 2d2d 2d2d 0a20 2020 2020 2020 206e 616d  ----.        nam
+00023140: 655f 6469 6374 203a 2064 6963 742d 6c69  e_dict : dict-li
+00023150: 6b65 2c20 6f70 7469 6f6e 616c 0a20 2020  ke, optional.   
+00023160: 2020 2020 2020 2020 2044 6963 7469 6f6e           Diction
+00023170: 6172 7920 7768 6f73 6520 6b65 7973 2061  ary whose keys a
+00023180: 7265 2063 7572 7265 6e74 2076 6172 6961  re current varia
+00023190: 626c 6520 6f72 2063 6f6f 7264 696e 6174  ble or coordinat
+000231a0: 6520 6e61 6d65 7320 616e 640a 2020 2020  e names and.    
+000231b0: 2020 2020 2020 2020 7768 6f73 6520 7661          whose va
+000231c0: 6c75 6573 2061 7265 2074 6865 2064 6573  lues are the des
+000231d0: 6972 6564 206e 616d 6573 2e0a 2020 2020  ired names..    
+000231e0: 2020 2020 2a2a 6e61 6d65 7320 3a20 6f70      **names : op
+000231f0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00023200: 2020 204b 6579 776f 7264 2066 6f72 6d20     Keyword form 
+00023210: 6f66 2060 606e 616d 655f 6469 6374 6060  of ``name_dict``
+00023220: 2e0a 2020 2020 2020 2020 2020 2020 4f6e  ..            On
+00023230: 6520 6f66 206e 616d 655f 6469 6374 206f  e of name_dict o
+00023240: 7220 6e61 6d65 7320 6d75 7374 2062 6520  r names must be 
+00023250: 7072 6f76 6964 6564 2e0a 0a20 2020 2020  provided...     
+00023260: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+00023270: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00023280: 2020 2072 656e 616d 6564 203a 2044 6174     renamed : Dat
+00023290: 6173 6574 0a20 2020 2020 2020 2020 2020  aset.           
+000232a0: 2044 6174 6173 6574 2077 6974 6820 7265   Dataset with re
+000232b0: 6e61 6d65 6420 7661 7269 6162 6c65 7320  named variables 
+000232c0: 696e 636c 7564 696e 6720 636f 6f72 6469  including coordi
+000232d0: 6e61 7465 730a 0a20 2020 2020 2020 2053  nates..        S
+000232e0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+000232f0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00023300: 2044 6174 6173 6574 2e73 7761 705f 6469   Dataset.swap_di
+00023310: 6d73 0a20 2020 2020 2020 2044 6174 6173  ms.        Datas
+00023320: 6574 2e72 656e 616d 650a 2020 2020 2020  et.rename.      
+00023330: 2020 4461 7461 7365 742e 7265 6e61 6d65    Dataset.rename
+00023340: 5f64 696d 730a 2020 2020 2020 2020 4461  _dims.        Da
+00023350: 7461 4172 7261 792e 7265 6e61 6d65 0a20  taArray.rename. 
+00023360: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00023370: 2020 206e 616d 655f 6469 6374 203d 2065     name_dict = e
+00023380: 6974 6865 725f 6469 6374 5f6f 725f 6b77  ither_dict_or_kw
+00023390: 6172 6773 286e 616d 655f 6469 6374 2c20  args(name_dict, 
+000233a0: 6e61 6d65 732c 2022 7265 6e61 6d65 5f76  names, "rename_v
+000233b0: 6172 7322 290a 2020 2020 2020 2020 666f  ars").        fo
+000233c0: 7220 6b20 696e 206e 616d 655f 6469 6374  r k in name_dict
+000233d0: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000233e0: 206b 206e 6f74 2069 6e20 7365 6c66 3a0a   k not in self:.
+000233f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023400: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+00023410: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00023420: 2020 2020 2020 6622 6361 6e6e 6f74 2072        f"cannot r
+00023430: 656e 616d 6520 7b6b 2172 7d20 6265 6361  ename {k!r} beca
+00023440: 7573 6520 6974 2069 7320 6e6f 7420 6120  use it is not a 
+00023450: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00023460: 2020 2020 2020 2276 6172 6961 626c 6520        "variable 
+00023470: 6f72 2063 6f6f 7264 696e 6174 6520 696e  or coordinate in
+00023480: 2074 6869 7320 6461 7461 7365 7422 0a20   this dataset". 
+00023490: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000234a0: 0a20 2020 2020 2020 2076 6172 6961 626c  .        variabl
+000234b0: 6573 2c20 636f 6f72 645f 6e61 6d65 732c  es, coord_names,
+000234c0: 2064 696d 732c 2069 6e64 6578 6573 203d   dims, indexes =
+000234d0: 2073 656c 662e 5f72 656e 616d 655f 616c   self._rename_al
+000234e0: 6c28 0a20 2020 2020 2020 2020 2020 206e  l(.            n
+000234f0: 616d 655f 6469 6374 3d6e 616d 655f 6469  ame_dict=name_di
+00023500: 6374 2c20 6469 6d73 5f64 6963 743d 7b7d  ct, dims_dict={}
+00023510: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00023520: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00023530: 7265 706c 6163 6528 7661 7269 6162 6c65  replace(variable
+00023540: 732c 2063 6f6f 7264 5f6e 616d 6573 2c20  s, coord_names, 
+00023550: 6469 6d73 3d64 696d 732c 2069 6e64 6578  dims=dims, index
+00023560: 6573 3d69 6e64 6578 6573 290a 0a20 2020  es=indexes)..   
+00023570: 2064 6566 2073 7761 705f 6469 6d73 280a   def swap_dims(.
+00023580: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
+00023590: 4461 7461 7365 742c 2064 696d 735f 6469  Dataset, dims_di
+000235a0: 6374 3a20 4d61 7070 696e 675b 416e 792c  ct: Mapping[Any,
+000235b0: 2048 6173 6861 626c 655d 207c 204e 6f6e   Hashable] | Non
+000235c0: 6520 3d20 4e6f 6e65 2c20 2a2a 6469 6d73  e = None, **dims
+000235d0: 5f6b 7761 7267 730a 2020 2020 2920 2d3e  _kwargs.    ) ->
+000235e0: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
+000235f0: 2020 2020 2222 2252 6574 7572 6e73 2061      """Returns a
+00023600: 206e 6577 206f 626a 6563 7420 7769 7468   new object with
+00023610: 2073 7761 7070 6564 2064 696d 656e 7369   swapped dimensi
+00023620: 6f6e 732e 0a0a 2020 2020 2020 2020 5061  ons...        Pa
+00023630: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00023640: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00023650: 2020 2020 6469 6d73 5f64 6963 7420 3a20      dims_dict : 
+00023660: 6469 6374 2d6c 696b 650a 2020 2020 2020  dict-like.      
+00023670: 2020 2020 2020 4469 6374 696f 6e61 7279        Dictionary
+00023680: 2077 686f 7365 206b 6579 7320 6172 6520   whose keys are 
+00023690: 6375 7272 656e 7420 6469 6d65 6e73 696f  current dimensio
+000236a0: 6e20 6e61 6d65 7320 616e 6420 7768 6f73  n names and whos
+000236b0: 6520 7661 6c75 6573 0a20 2020 2020 2020  e values.       
+000236c0: 2020 2020 2061 7265 206e 6577 206e 616d       are new nam
+000236d0: 6573 2e0a 2020 2020 2020 2020 2a2a 6469  es..        **di
+000236e0: 6d73 5f6b 7761 7267 7320 3a20 7b65 7869  ms_kwargs : {exi
+000236f0: 7374 696e 675f 6469 6d3a 206e 6577 5f64  sting_dim: new_d
+00023700: 696d 2c20 2e2e 2e7d 2c20 6f70 7469 6f6e  im, ...}, option
+00023710: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
+00023720: 6865 206b 6579 776f 7264 2061 7267 756d  he keyword argum
+00023730: 656e 7473 2066 6f72 6d20 6f66 2060 6064  ents form of ``d
+00023740: 696d 735f 6469 6374 6060 2e0a 2020 2020  ims_dict``..    
+00023750: 2020 2020 2020 2020 4f6e 6520 6f66 2064          One of d
+00023760: 696d 735f 6469 6374 206f 7220 6469 6d73  ims_dict or dims
+00023770: 5f6b 7761 7267 7320 6d75 7374 2062 6520  _kwargs must be 
+00023780: 7072 6f76 6964 6564 2e0a 0a20 2020 2020  provided...     
+00023790: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+000237a0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+000237b0: 2020 2073 7761 7070 6564 203a 2044 6174     swapped : Dat
+000237c0: 6173 6574 0a20 2020 2020 2020 2020 2020  aset.           
+000237d0: 2044 6174 6173 6574 2077 6974 6820 7377   Dataset with sw
+000237e0: 6170 7065 6420 6469 6d65 6e73 696f 6e73  apped dimensions
+000237f0: 2e0a 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+00023800: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
+00023810: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
+00023820: 2064 7320 3d20 7872 2e44 6174 6173 6574   ds = xr.Dataset
+00023830: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
+00023840: 2020 6461 7461 5f76 6172 733d 7b22 6122    data_vars={"a"
+00023850: 3a20 2822 7822 2c20 5b35 2c20 375d 292c  : ("x", [5, 7]),
+00023860: 2022 6222 3a20 2822 7822 2c20 5b30 2e31   "b": ("x", [0.1
+00023870: 2c20 322e 345d 297d 2c0a 2020 2020 2020  , 2.4])},.      
+00023880: 2020 2e2e 2e20 2020 2020 636f 6f72 6473    ...     coords
+00023890: 3d7b 2278 223a 205b 2261 222c 2022 6222  ={"x": ["a", "b"
+000238a0: 5d2c 2022 7922 3a20 2822 7822 2c20 5b30  ], "y": ("x", [0
+000238b0: 2c20 315d 297d 2c0a 2020 2020 2020 2020  , 1])},.        
+000238c0: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+000238d0: 3e20 6473 0a20 2020 2020 2020 203c 7861  > ds.        <xa
+000238e0: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
+000238f0: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
+00023900: 3a20 2028 783a 2032 290a 2020 2020 2020  :  (x: 2).      
+00023910: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
+00023920: 2020 2020 2020 2020 202a 2078 2020 2020           * x    
+00023930: 2020 2020 2878 2920 3c55 3120 2761 2720      (x) <U1 'a' 
+00023940: 2762 270a 2020 2020 2020 2020 2020 2020  'b'.            
+00023950: 7920 2020 2020 2020 2028 7829 2069 6e74  y        (x) int
+00023960: 3634 2030 2031 0a20 2020 2020 2020 2044  64 0 1.        D
+00023970: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
+00023980: 2020 2020 2020 2020 2020 2061 2020 2020             a    
+00023990: 2020 2020 2878 2920 696e 7436 3420 3520      (x) int64 5 
+000239a0: 370a 2020 2020 2020 2020 2020 2020 6220  7.            b 
+000239b0: 2020 2020 2020 2028 7829 2066 6c6f 6174         (x) float
+000239c0: 3634 2030 2e31 2032 2e34 0a0a 2020 2020  64 0.1 2.4..    
+000239d0: 2020 2020 3e3e 3e20 6473 2e73 7761 705f      >>> ds.swap_
+000239e0: 6469 6d73 287b 2278 223a 2022 7922 7d29  dims({"x": "y"})
+000239f0: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
+00023a00: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
+00023a10: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
+00023a20: 793a 2032 290a 2020 2020 2020 2020 436f  y: 2).        Co
+00023a30: 6f72 6469 6e61 7465 733a 0a20 2020 2020  ordinates:.     
+00023a40: 2020 2020 2020 2078 2020 2020 2020 2020         x        
+00023a50: 2879 2920 3c55 3120 2761 2720 2762 270a  (y) <U1 'a' 'b'.
+00023a60: 2020 2020 2020 2020 2020 2a20 7920 2020            * y   
+00023a70: 2020 2020 2028 7929 2069 6e74 3634 2030       (y) int64 0
+00023a80: 2031 0a20 2020 2020 2020 2044 6174 6120   1.        Data 
+00023a90: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
+00023aa0: 2020 2020 2020 2061 2020 2020 2020 2020         a        
+00023ab0: 2879 2920 696e 7436 3420 3520 370a 2020  (y) int64 5 7.  
+00023ac0: 2020 2020 2020 2020 2020 6220 2020 2020            b     
+00023ad0: 2020 2028 7929 2066 6c6f 6174 3634 2030     (y) float64 0
+00023ae0: 2e31 2032 2e34 0a0a 2020 2020 2020 2020  .1 2.4..        
+00023af0: 3e3e 3e20 6473 2e73 7761 705f 6469 6d73  >>> ds.swap_dims
+00023b00: 287b 2278 223a 2022 7a22 7d29 0a20 2020  ({"x": "z"}).   
+00023b10: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
+00023b20: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
+00023b30: 6d65 6e73 696f 6e73 3a20 2028 7a3a 2032  mensions:  (z: 2
+00023b40: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
+00023b50: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
+00023b60: 2020 2078 2020 2020 2020 2020 287a 2920     x        (z) 
+00023b70: 3c55 3120 2761 2720 2762 270a 2020 2020  <U1 'a' 'b'.    
+00023b80: 2020 2020 2020 2020 7920 2020 2020 2020          y       
+00023b90: 2028 7a29 2069 6e74 3634 2030 2031 0a20   (z) int64 0 1. 
+00023ba0: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
+00023bb0: 7320 7769 7468 6f75 7420 636f 6f72 6469  s without coordi
+00023bc0: 6e61 7465 733a 207a 0a20 2020 2020 2020  nates: z.       
+00023bd0: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
+00023be0: 0a20 2020 2020 2020 2020 2020 2061 2020  .            a  
+00023bf0: 2020 2020 2020 287a 2920 696e 7436 3420        (z) int64 
+00023c00: 3520 370a 2020 2020 2020 2020 2020 2020  5 7.            
+00023c10: 6220 2020 2020 2020 2028 7a29 2066 6c6f  b        (z) flo
+00023c20: 6174 3634 2030 2e31 2032 2e34 0a0a 2020  at64 0.1 2.4..  
+00023c30: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
+00023c40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+00023c50: 2020 2020 2020 2020 4461 7461 7365 742e          Dataset.
+00023c60: 7265 6e61 6d65 0a20 2020 2020 2020 2044  rename.        D
+00023c70: 6174 6141 7272 6179 2e73 7761 705f 6469  ataArray.swap_di
+00023c80: 6d73 0a20 2020 2020 2020 2022 2222 0a20  ms.        """. 
+00023c90: 2020 2020 2020 2023 2054 4f44 4f3a 2064         # TODO: d
+00023ca0: 6570 7265 6361 7465 2074 6869 7320 6d65  eprecate this me
+00023cb0: 7468 6f64 2069 6e20 6661 766f 7220 6f66  thod in favor of
+00023cc0: 2061 2028 6c65 7373 2063 6f6e 6675 7369   a (less confusi
+00023cd0: 6e67 290a 2020 2020 2020 2020 2320 7265  ng).        # re
+00023ce0: 6e61 6d65 5f64 696d 7328 2920 6d65 7468  name_dims() meth
+00023cf0: 6f64 2074 6861 7420 6f6e 6c79 2072 656e  od that only ren
+00023d00: 616d 6573 2064 696d 656e 7369 6f6e 732e  ames dimensions.
+00023d10: 0a0a 2020 2020 2020 2020 6469 6d73 5f64  ..        dims_d
+00023d20: 6963 7420 3d20 6569 7468 6572 5f64 6963  ict = either_dic
+00023d30: 745f 6f72 5f6b 7761 7267 7328 6469 6d73  t_or_kwargs(dims
+00023d40: 5f64 6963 742c 2064 696d 735f 6b77 6172  _dict, dims_kwar
+00023d50: 6773 2c20 2273 7761 705f 6469 6d73 2229  gs, "swap_dims")
+00023d60: 0a20 2020 2020 2020 2066 6f72 206b 2c20  .        for k, 
+00023d70: 7620 696e 2064 696d 735f 6469 6374 2e69  v in dims_dict.i
+00023d80: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+00023d90: 2020 2020 6966 206b 206e 6f74 2069 6e20      if k not in 
+00023da0: 7365 6c66 2e64 696d 733a 0a20 2020 2020  self.dims:.     
+00023db0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00023dc0: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+00023dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023de0: 2066 2263 616e 6e6f 7420 7377 6170 2066   f"cannot swap f
+00023df0: 726f 6d20 6469 6d65 6e73 696f 6e20 7b6b  rom dimension {k
+00023e00: 2172 7d20 6265 6361 7573 6520 6974 2069  !r} because it i
+00023e10: 7320 220a 2020 2020 2020 2020 2020 2020  s ".            
+00023e20: 2020 2020 2020 2020 226e 6f74 2061 6e20          "not an 
+00023e30: 6578 6973 7469 6e67 2064 696d 656e 7369  existing dimensi
+00023e40: 6f6e 220a 2020 2020 2020 2020 2020 2020  on".            
+00023e50: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
+00023e60: 2020 6966 2076 2069 6e20 7365 6c66 2e76    if v in self.v
+00023e70: 6172 6961 626c 6573 2061 6e64 2073 656c  ariables and sel
+00023e80: 662e 7661 7269 6162 6c65 735b 765d 2e64  f.variables[v].d
+00023e90: 696d 7320 213d 2028 6b2c 293a 0a20 2020  ims != (k,):.   
+00023ea0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00023eb0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+00023ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023ed0: 2020 2066 2272 6570 6c61 6365 6d65 6e74     f"replacement
+00023ee0: 2064 696d 656e 7369 6f6e 207b 7621 727d   dimension {v!r}
+00023ef0: 2069 7320 6e6f 7420 6120 3144 2022 0a20   is not a 1D ". 
+00023f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00023f10: 2020 2066 2276 6172 6961 626c 6520 616c     f"variable al
+00023f20: 6f6e 6720 7468 6520 6f6c 6420 6469 6d65  ong the old dime
+00023f30: 6e73 696f 6e20 7b6b 2172 7d22 0a20 2020  nsion {k!r}".   
+00023f40: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+00023f50: 2020 2020 2020 2020 7265 7375 6c74 5f64          result_d
+00023f60: 696d 7320 3d20 7b64 696d 735f 6469 6374  ims = {dims_dict
+00023f70: 2e67 6574 2864 696d 2c20 6469 6d29 2066  .get(dim, dim) f
+00023f80: 6f72 2064 696d 2069 6e20 7365 6c66 2e64  or dim in self.d
+00023f90: 696d 737d 0a0a 2020 2020 2020 2020 636f  ims}..        co
+00023fa0: 6f72 645f 6e61 6d65 7320 3d20 7365 6c66  ord_names = self
+00023fb0: 2e5f 636f 6f72 645f 6e61 6d65 732e 636f  ._coord_names.co
+00023fc0: 7079 2829 0a20 2020 2020 2020 2063 6f6f  py().        coo
+00023fd0: 7264 5f6e 616d 6573 2e75 7064 6174 6528  rd_names.update(
+00023fe0: 7b64 696d 2066 6f72 2064 696d 2069 6e20  {dim for dim in 
+00023ff0: 6469 6d73 5f64 6963 742e 7661 6c75 6573  dims_dict.values
+00024000: 2829 2069 6620 6469 6d20 696e 2073 656c  () if dim in sel
+00024010: 662e 7661 7269 6162 6c65 737d 290a 0a20  f.variables}).. 
+00024020: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+00024030: 3a20 6469 6374 5b48 6173 6861 626c 652c  : dict[Hashable,
+00024040: 2056 6172 6961 626c 655d 203d 207b 7d0a   Variable] = {}.
+00024050: 2020 2020 2020 2020 696e 6465 7865 733a          indexes:
+00024060: 2064 6963 745b 4861 7368 6162 6c65 2c20   dict[Hashable, 
+00024070: 496e 6465 785d 203d 207b 7d0a 2020 2020  Index] = {}.    
+00024080: 2020 2020 666f 7220 6b2c 2076 2069 6e20      for k, v in 
+00024090: 7365 6c66 2e76 6172 6961 626c 6573 2e69  self.variables.i
+000240a0: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+000240b0: 2020 2020 6469 6d73 203d 2074 7570 6c65      dims = tuple
+000240c0: 2864 696d 735f 6469 6374 2e67 6574 2864  (dims_dict.get(d
+000240d0: 696d 2c20 6469 6d29 2066 6f72 2064 696d  im, dim) for dim
+000240e0: 2069 6e20 762e 6469 6d73 290a 2020 2020   in v.dims).    
+000240f0: 2020 2020 2020 2020 7661 723a 2056 6172          var: Var
+00024100: 6961 626c 650a 2020 2020 2020 2020 2020  iable.          
+00024110: 2020 6966 206b 2069 6e20 7265 7375 6c74    if k in result
+00024120: 5f64 696d 733a 0a20 2020 2020 2020 2020  _dims:.         
+00024130: 2020 2020 2020 2076 6172 203d 2076 2e74         var = v.t
+00024140: 6f5f 696e 6465 785f 7661 7269 6162 6c65  o_index_variable
+00024150: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
+00024160: 2020 2076 6172 2e64 696d 7320 3d20 6469     var.dims = di
+00024170: 6d73 0a20 2020 2020 2020 2020 2020 2020  ms.             
+00024180: 2020 2069 6620 6b20 696e 2073 656c 662e     if k in self.
+00024190: 5f69 6e64 6578 6573 3a0a 2020 2020 2020  _indexes:.      
+000241a0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000241b0: 6465 7865 735b 6b5d 203d 2073 656c 662e  dexes[k] = self.
+000241c0: 5f69 6e64 6578 6573 5b6b 5d0a 2020 2020  _indexes[k].    
+000241d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000241e0: 7661 7269 6162 6c65 735b 6b5d 203d 2076  variables[k] = v
+000241f0: 6172 0a20 2020 2020 2020 2020 2020 2020  ar.             
 00024200: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00024210: 2020 2020 2020 2020 2076 6172 203d 2076           var = v
-00024220: 2e74 6f5f 6261 7365 5f76 6172 6961 626c  .to_base_variabl
-00024230: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
-00024240: 2020 2020 7661 722e 6469 6d73 203d 2064      var.dims = d
-00024250: 696d 730a 2020 2020 2020 2020 2020 2020  ims.            
-00024260: 2020 2020 7661 7269 6162 6c65 735b 6b5d      variables[k]
-00024270: 203d 2076 6172 0a0a 2020 2020 2020 2020   = var..        
-00024280: 7265 7475 726e 2073 656c 662e 5f72 6570  return self._rep
-00024290: 6c61 6365 5f77 6974 685f 6e65 775f 6469  lace_with_new_di
-000242a0: 6d73 2876 6172 6961 626c 6573 2c20 636f  ms(variables, co
-000242b0: 6f72 645f 6e61 6d65 732c 2069 6e64 6578  ord_names, index
-000242c0: 6573 3d69 6e64 6578 6573 290a 0a20 2020  es=indexes)..   
-000242d0: 2023 2063 6861 6e67 6520 7479 7065 206f   # change type o
-000242e0: 6620 7365 6c66 2061 6e64 2072 6574 7572  f self and retur
-000242f0: 6e20 746f 2054 5f44 6174 6173 6574 206f  n to T_Dataset o
-00024300: 6e63 650a 2020 2020 2320 6874 7470 733a  nce.    # https:
-00024310: 2f2f 6769 7468 7562 2e63 6f6d 2f70 7974  //github.com/pyt
-00024320: 686f 6e2f 6d79 7079 2f69 7373 7565 732f  hon/mypy/issues/
-00024330: 3132 3834 3620 6973 2072 6573 6f6c 7665  12846 is resolve
-00024340: 640a 2020 2020 6465 6620 6578 7061 6e64  d.    def expand
-00024350: 5f64 696d 7328 0a20 2020 2020 2020 2073  _dims(.        s
-00024360: 656c 662c 0a20 2020 2020 2020 2064 696d  elf,.        dim
-00024370: 3a20 4e6f 6e65 207c 2048 6173 6861 626c  : None | Hashabl
-00024380: 6520 7c20 5365 7175 656e 6365 5b48 6173  e | Sequence[Has
-00024390: 6861 626c 655d 207c 204d 6170 7069 6e67  hable] | Mapping
-000243a0: 5b41 6e79 2c20 416e 795d 203d 204e 6f6e  [Any, Any] = Non
-000243b0: 652c 0a20 2020 2020 2020 2061 7869 733a  e,.        axis:
-000243c0: 204e 6f6e 6520 7c20 696e 7420 7c20 5365   None | int | Se
-000243d0: 7175 656e 6365 5b69 6e74 5d20 3d20 4e6f  quence[int] = No
-000243e0: 6e65 2c0a 2020 2020 2020 2020 2a2a 6469  ne,.        **di
-000243f0: 6d5f 6b77 6172 6773 3a20 416e 792c 0a20  m_kwargs: Any,. 
-00024400: 2020 2029 202d 3e20 4461 7461 7365 743a     ) -> Dataset:
-00024410: 0a20 2020 2020 2020 2022 2222 5265 7475  .        """Retu
-00024420: 726e 2061 206e 6577 206f 626a 6563 7420  rn a new object 
-00024430: 7769 7468 2061 6e20 6164 6469 7469 6f6e  with an addition
-00024440: 616c 2061 7869 7320 286f 7220 6178 6573  al axis (or axes
-00024450: 2920 696e 7365 7274 6564 2061 740a 2020  ) inserted at.  
-00024460: 2020 2020 2020 7468 6520 636f 7272 6573        the corres
-00024470: 706f 6e64 696e 6720 706f 7369 7469 6f6e  ponding position
-00024480: 2069 6e20 7468 6520 6172 7261 7920 7368   in the array sh
-00024490: 6170 652e 2020 5468 6520 6e65 7720 6f62  ape.  The new ob
-000244a0: 6a65 6374 2069 7320 610a 2020 2020 2020  ject is a.      
-000244b0: 2020 7669 6577 2069 6e74 6f20 7468 6520    view into the 
-000244c0: 756e 6465 726c 7969 6e67 2061 7272 6179  underlying array
-000244d0: 2c20 6e6f 7420 6120 636f 7079 2e0a 0a20  , not a copy... 
-000244e0: 2020 2020 2020 2049 6620 6469 6d20 6973         If dim is
-000244f0: 2061 6c72 6561 6479 2061 2073 6361 6c61   already a scala
-00024500: 7220 636f 6f72 6469 6e61 7465 2c20 6974  r coordinate, it
-00024510: 2077 696c 6c20 6265 2070 726f 6d6f 7465   will be promote
-00024520: 6420 746f 2061 2031 440a 2020 2020 2020  d to a 1D.      
-00024530: 2020 636f 6f72 6469 6e61 7465 2063 6f6e    coordinate con
-00024540: 7369 7374 696e 6720 6f66 2061 2073 696e  sisting of a sin
-00024550: 676c 6520 7661 6c75 652e 0a0a 2020 2020  gle value...    
-00024560: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00024570: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00024580: 2d0a 2020 2020 2020 2020 6469 6d20 3a20  -.        dim : 
-00024590: 6861 7368 6162 6c65 2c20 7365 7175 656e  hashable, sequen
-000245a0: 6365 206f 6620 6861 7368 6162 6c65 2c20  ce of hashable, 
-000245b0: 6d61 7070 696e 672c 206f 7220 4e6f 6e65  mapping, or None
-000245c0: 0a20 2020 2020 2020 2020 2020 2044 696d  .            Dim
-000245d0: 656e 7369 6f6e 7320 746f 2069 6e63 6c75  ensions to inclu
-000245e0: 6465 206f 6e20 7468 6520 6e65 7720 7661  de on the new va
-000245f0: 7269 6162 6c65 2e20 4966 2070 726f 7669  riable. If provi
-00024600: 6465 6420 6173 2068 6173 6861 626c 650a  ded as hashable.
-00024610: 2020 2020 2020 2020 2020 2020 6f72 2073              or s
-00024620: 6571 7565 6e63 6520 6f66 2068 6173 6861  equence of hasha
-00024630: 626c 652c 2074 6865 6e20 6469 6d65 6e73  ble, then dimens
-00024640: 696f 6e73 2061 7265 2069 6e73 6572 7465  ions are inserte
-00024650: 6420 7769 7468 206c 656e 6774 680a 2020  d with length.  
-00024660: 2020 2020 2020 2020 2020 312e 2049 6620            1. If 
-00024670: 7072 6f76 6964 6564 2061 7320 6120 6d61  provided as a ma
-00024680: 7070 696e 672c 2074 6865 6e20 7468 6520  pping, then the 
-00024690: 6b65 7973 2061 7265 2074 6865 206e 6577  keys are the new
-000246a0: 2064 696d 656e 7369 6f6e 730a 2020 2020   dimensions.    
-000246b0: 2020 2020 2020 2020 616e 6420 7468 6520          and the 
-000246c0: 7661 6c75 6573 2061 7265 2065 6974 6865  values are eithe
-000246d0: 7220 696e 7465 6765 7273 2028 6769 7669  r integers (givi
-000246e0: 6e67 2074 6865 206c 656e 6774 6820 6f66  ng the length of
-000246f0: 2074 6865 206e 6577 0a20 2020 2020 2020   the new.       
-00024700: 2020 2020 2064 696d 656e 7369 6f6e 7329       dimensions)
-00024710: 206f 7220 6172 7261 792d 6c69 6b65 2028   or array-like (
-00024720: 6769 7669 6e67 2074 6865 2063 6f6f 7264  giving the coord
-00024730: 696e 6174 6573 206f 6620 7468 6520 6e65  inates of the ne
-00024740: 770a 2020 2020 2020 2020 2020 2020 6469  w.            di
-00024750: 6d65 6e73 696f 6e73 292e 0a20 2020 2020  mensions)..     
-00024760: 2020 2061 7869 7320 3a20 696e 742c 2073     axis : int, s
-00024770: 6571 7565 6e63 6520 6f66 2069 6e74 2c20  equence of int, 
-00024780: 6f72 204e 6f6e 652c 2064 6566 6175 6c74  or None, default
-00024790: 3a20 4e6f 6e65 0a20 2020 2020 2020 2020  : None.         
-000247a0: 2020 2041 7869 7320 706f 7369 7469 6f6e     Axis position
-000247b0: 2873 2920 7768 6572 6520 6e65 7720 6178  (s) where new ax
-000247c0: 6973 2069 7320 746f 2062 6520 696e 7365  is is to be inse
-000247d0: 7274 6564 2028 706f 7369 7469 6f6e 2873  rted (position(s
-000247e0: 2920 6f6e 0a20 2020 2020 2020 2020 2020  ) on.           
-000247f0: 2074 6865 2072 6573 756c 7420 6172 7261   the result arra
-00024800: 7929 2e20 4966 2061 2073 6571 7565 6e63  y). If a sequenc
-00024810: 6520 6f66 2069 6e74 6567 6572 7320 6973  e of integers is
-00024820: 2070 6173 7365 642c 0a20 2020 2020 2020   passed,.       
-00024830: 2020 2020 206d 756c 7469 706c 6520 6178       multiple ax
-00024840: 6573 2061 7265 2069 6e73 6572 7465 642e  es are inserted.
-00024850: 2049 6e20 7468 6973 2063 6173 652c 2064   In this case, d
-00024860: 696d 2061 7267 756d 656e 7473 2073 686f  im arguments sho
-00024870: 756c 6420 6265 0a20 2020 2020 2020 2020  uld be.         
-00024880: 2020 2073 616d 6520 6c65 6e67 7468 206c     same length l
-00024890: 6973 742e 2049 6620 6178 6973 3d4e 6f6e  ist. If axis=Non
-000248a0: 6520 6973 2070 6173 7365 642c 2061 6c6c  e is passed, all
-000248b0: 2074 6865 2061 7865 7320 7769 6c6c 2062   the axes will b
-000248c0: 650a 2020 2020 2020 2020 2020 2020 696e  e.            in
-000248d0: 7365 7274 6564 2074 6f20 7468 6520 7374  serted to the st
-000248e0: 6172 7420 6f66 2074 6865 2072 6573 756c  art of the resul
-000248f0: 7420 6172 7261 792e 0a20 2020 2020 2020  t array..       
-00024900: 202a 2a64 696d 5f6b 7761 7267 7320 3a20   **dim_kwargs : 
-00024910: 696e 7420 6f72 2073 6571 7565 6e63 6520  int or sequence 
-00024920: 6f72 206e 6461 7272 6179 0a20 2020 2020  or ndarray.     
-00024930: 2020 2020 2020 2054 6865 206b 6579 776f         The keywo
-00024940: 7264 7320 6172 6520 6172 6269 7472 6172  rds are arbitrar
-00024950: 7920 6469 6d65 6e73 696f 6e73 2062 6569  y dimensions bei
-00024960: 6e67 2069 6e73 6572 7465 6420 616e 6420  ng inserted and 
-00024970: 7468 6520 7661 6c75 6573 0a20 2020 2020  the values.     
-00024980: 2020 2020 2020 2061 7265 2065 6974 6865         are eithe
-00024990: 7220 7468 6520 6c65 6e67 7468 7320 6f66  r the lengths of
-000249a0: 2074 6865 206e 6577 2064 696d 7320 2869   the new dims (i
-000249b0: 6620 696e 7420 6973 2067 6976 656e 292c  f int is given),
-000249c0: 206f 7220 7468 6569 720a 2020 2020 2020   or their.      
-000249d0: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
-000249e0: 732e 204e 6f74 652c 2074 6869 7320 6973  s. Note, this is
-000249f0: 2061 6e20 616c 7465 726e 6174 6976 6520   an alternative 
-00024a00: 746f 2070 6173 7369 6e67 2061 2064 6963  to passing a dic
-00024a10: 7420 746f 2074 6865 0a20 2020 2020 2020  t to the.       
-00024a20: 2020 2020 2064 696d 206b 7761 7267 2061       dim kwarg a
-00024a30: 6e64 2077 696c 6c20 6f6e 6c79 2062 6520  nd will only be 
-00024a40: 7573 6564 2069 6620 6469 6d20 6973 204e  used if dim is N
-00024a50: 6f6e 652e 0a0a 2020 2020 2020 2020 5265  one...        Re
-00024a60: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00024a70: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6578  -----.        ex
-00024a80: 7061 6e64 6564 203a 2044 6174 6173 6574  panded : Dataset
-00024a90: 0a20 2020 2020 2020 2020 2020 2054 6869  .            Thi
-00024aa0: 7320 6f62 6a65 6374 2c20 6275 7420 7769  s object, but wi
-00024ab0: 7468 2061 6464 6974 696f 6e61 6c20 6469  th additional di
-00024ac0: 6d65 6e73 696f 6e28 7329 2e0a 0a20 2020  mension(s)...   
-00024ad0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-00024ae0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-00024af0: 2020 2020 2020 2044 6174 6141 7272 6179         DataArray
-00024b00: 2e65 7870 616e 645f 6469 6d73 0a20 2020  .expand_dims.   
-00024b10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00024b20: 2069 6620 6469 6d20 6973 204e 6f6e 653a   if dim is None:
-00024b30: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00024b40: 730a 2020 2020 2020 2020 656c 6966 2069  s.        elif i
-00024b50: 7369 6e73 7461 6e63 6528 6469 6d2c 204d  sinstance(dim, M
-00024b60: 6170 7069 6e67 293a 0a20 2020 2020 2020  apping):.       
-00024b70: 2020 2020 2023 2057 6527 7265 206c 6174       # We're lat
-00024b80: 6572 2067 6f69 6e67 2074 6f20 6d6f 6469  er going to modi
-00024b90: 6679 2064 696d 2069 6e20 706c 6163 653b  fy dim in place;
-00024ba0: 2064 6f6e 2774 2074 616d 7065 7220 7769   don't tamper wi
-00024bb0: 7468 0a20 2020 2020 2020 2020 2020 2023  th.            #
-00024bc0: 2074 6865 2069 6e70 7574 0a20 2020 2020   the input.     
-00024bd0: 2020 2020 2020 2064 696d 203d 2064 6963         dim = dic
-00024be0: 7428 6469 6d29 0a20 2020 2020 2020 2065  t(dim).        e
-00024bf0: 6c69 6620 6973 696e 7374 616e 6365 2864  lif isinstance(d
-00024c00: 696d 2c20 696e 7429 3a0a 2020 2020 2020  im, int):.      
-00024c10: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00024c20: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00024c30: 2020 2020 2020 2022 6469 6d20 7368 6f75         "dim shou
-00024c40: 6c64 2062 6520 6861 7368 6162 6c65 206f  ld be hashable o
-00024c50: 7220 7365 7175 656e 6365 206f 6620 6861  r sequence of ha
-00024c60: 7368 6162 6c65 7320 6f72 206d 6170 7069  shables or mappi
-00024c70: 6e67 220a 2020 2020 2020 2020 2020 2020  ng".            
-00024c80: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00024c90: 7369 6e73 7461 6e63 6528 6469 6d2c 2073  sinstance(dim, s
-00024ca0: 7472 2920 6f72 206e 6f74 2069 7369 6e73  tr) or not isins
-00024cb0: 7461 6e63 6528 6469 6d2c 2053 6571 7565  tance(dim, Seque
-00024cc0: 6e63 6529 3a0a 2020 2020 2020 2020 2020  nce):.          
-00024cd0: 2020 6469 6d20 3d20 7b64 696d 3a20 317d    dim = {dim: 1}
-00024ce0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
-00024cf0: 696e 7374 616e 6365 2864 696d 2c20 5365  instance(dim, Se
-00024d00: 7175 656e 6365 293a 0a20 2020 2020 2020  quence):.       
-00024d10: 2020 2020 2069 6620 6c65 6e28 6469 6d29       if len(dim)
-00024d20: 2021 3d20 6c65 6e28 7365 7428 6469 6d29   != len(set(dim)
-00024d30: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00024d40: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00024d50: 726f 7228 2264 696d 7320 7368 6f75 6c64  ror("dims should
-00024d60: 206e 6f74 2063 6f6e 7461 696e 2064 7570   not contain dup
-00024d70: 6c69 6361 7465 2076 616c 7565 732e 2229  licate values.")
-00024d80: 0a20 2020 2020 2020 2020 2020 2064 696d  .            dim
-00024d90: 203d 207b 643a 2031 2066 6f72 2064 2069   = {d: 1 for d i
-00024da0: 6e20 6469 6d7d 0a0a 2020 2020 2020 2020  n dim}..        
-00024db0: 6469 6d20 3d20 6569 7468 6572 5f64 6963  dim = either_dic
-00024dc0: 745f 6f72 5f6b 7761 7267 7328 6469 6d2c  t_or_kwargs(dim,
-00024dd0: 2064 696d 5f6b 7761 7267 732c 2022 6578   dim_kwargs, "ex
-00024de0: 7061 6e64 5f64 696d 7322 290a 2020 2020  pand_dims").    
-00024df0: 2020 2020 6173 7365 7274 2069 7369 6e73      assert isins
-00024e00: 7461 6e63 6528 6469 6d2c 204d 7574 6162  tance(dim, Mutab
-00024e10: 6c65 4d61 7070 696e 6729 0a0a 2020 2020  leMapping)..    
-00024e20: 2020 2020 6966 2061 7869 7320 6973 204e      if axis is N
-00024e30: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00024e40: 2061 7869 7320 3d20 6c69 7374 2872 616e   axis = list(ran
-00024e50: 6765 286c 656e 2864 696d 2929 290a 2020  ge(len(dim))).  
-00024e60: 2020 2020 2020 656c 6966 206e 6f74 2069        elif not i
-00024e70: 7369 6e73 7461 6e63 6528 6178 6973 2c20  sinstance(axis, 
-00024e80: 5365 7175 656e 6365 293a 0a20 2020 2020  Sequence):.     
-00024e90: 2020 2020 2020 2061 7869 7320 3d20 5b61         axis = [a
-00024ea0: 7869 735d 0a0a 2020 2020 2020 2020 6966  xis]..        if
-00024eb0: 206c 656e 2864 696d 2920 213d 206c 656e   len(dim) != len
-00024ec0: 2861 7869 7329 3a0a 2020 2020 2020 2020  (axis):.        
-00024ed0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00024ee0: 7272 6f72 2822 6c65 6e67 7468 7320 6f66  rror("lengths of
-00024ef0: 2064 696d 2061 6e64 2061 7869 7320 7368   dim and axis sh
-00024f00: 6f75 6c64 2062 6520 6964 656e 7469 6361  ould be identica
-00024f10: 6c2e 2229 0a20 2020 2020 2020 2066 6f72  l.").        for
-00024f20: 2064 2069 6e20 6469 6d3a 0a20 2020 2020   d in dim:.     
-00024f30: 2020 2020 2020 2069 6620 6420 696e 2073         if d in s
-00024f40: 656c 662e 6469 6d73 3a0a 2020 2020 2020  elf.dims:.      
-00024f50: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00024f60: 5661 6c75 6545 7272 6f72 2866 2244 696d  ValueError(f"Dim
-00024f70: 656e 7369 6f6e 207b 647d 2061 6c72 6561  ension {d} alrea
-00024f80: 6479 2065 7869 7374 732e 2229 0a20 2020  dy exists.").   
-00024f90: 2020 2020 2020 2020 2069 6620 6420 696e           if d in
-00024fa0: 2073 656c 662e 5f76 6172 6961 626c 6573   self._variables
-00024fb0: 2061 6e64 206e 6f74 2075 7469 6c73 2e69   and not utils.i
-00024fc0: 735f 7363 616c 6172 2873 656c 662e 5f76  s_scalar(self._v
-00024fd0: 6172 6961 626c 6573 5b64 5d29 3a0a 2020  ariables[d]):.  
-00024fe0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00024ff0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00025000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025010: 2020 2020 227b 6469 6d7d 2061 6c72 6561      "{dim} alrea
-00025020: 6479 2065 7869 7374 7320 6173 2063 6f6f  dy exists as coo
-00025030: 7264 696e 6174 6520 6f72 220a 2020 2020  rdinate or".    
-00025040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025050: 2220 7661 7269 6162 6c65 206e 616d 652e  " variable name.
-00025060: 222e 666f 726d 6174 2864 696d 3d64 290a  ".format(dim=d).
-00025070: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025080: 290a 0a20 2020 2020 2020 2076 6172 6961  )..        varia
-00025090: 626c 6573 3a20 6469 6374 5b48 6173 6861  bles: dict[Hasha
-000250a0: 626c 652c 2056 6172 6961 626c 655d 203d  ble, Variable] =
-000250b0: 207b 7d0a 2020 2020 2020 2020 696e 6465   {}.        inde
-000250c0: 7865 733a 2064 6963 745b 4861 7368 6162  xes: dict[Hashab
-000250d0: 6c65 2c20 496e 6465 785d 203d 2064 6963  le, Index] = dic
-000250e0: 7428 7365 6c66 2e5f 696e 6465 7865 7329  t(self._indexes)
-000250f0: 0a20 2020 2020 2020 2063 6f6f 7264 5f6e  .        coord_n
-00025100: 616d 6573 203d 2073 656c 662e 5f63 6f6f  ames = self._coo
-00025110: 7264 5f6e 616d 6573 2e63 6f70 7928 290a  rd_names.copy().
-00025120: 2020 2020 2020 2020 2320 4966 2064 696d          # If dim
-00025130: 2069 7320 6120 6469 6374 2c20 7468 656e   is a dict, then
-00025140: 2065 6e73 7572 6520 7468 6174 2074 6865   ensure that the
-00025150: 2076 616c 7565 7320 6172 6520 6569 7468   values are eith
-00025160: 6572 2069 6e74 6567 6572 730a 2020 2020  er integers.    
-00025170: 2020 2020 2320 6f72 2069 7465 7261 626c      # or iterabl
-00025180: 6573 2e0a 2020 2020 2020 2020 666f 7220  es..        for 
-00025190: 6b2c 2076 2069 6e20 6469 6d2e 6974 656d  k, v in dim.item
-000251a0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-000251b0: 2069 6620 6861 7361 7474 7228 762c 2022   if hasattr(v, "
-000251c0: 5f5f 6974 6572 5f5f 2229 3a0a 2020 2020  __iter__"):.    
-000251d0: 2020 2020 2020 2020 2020 2020 2320 4966              # If
-000251e0: 2074 6865 2076 616c 7565 2066 6f72 2074   the value for t
-000251f0: 6865 206e 6577 2064 696d 656e 7369 6f6e  he new dimension
-00025200: 2069 7320 616e 2069 7465 7261 626c 652c   is an iterable,
-00025210: 2074 6865 6e0a 2020 2020 2020 2020 2020   then.          
-00025220: 2020 2020 2020 2320 7361 7665 2074 6865        # save the
-00025230: 2063 6f6f 7264 696e 6174 6573 2074 6f20   coordinates to 
-00025240: 7468 6520 7661 7269 6162 6c65 7320 6469  the variables di
-00025250: 6374 2c20 616e 6420 7365 7420 7468 650a  ct, and set the.
-00025260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025270: 2320 7661 6c75 6520 7769 7468 696e 2074  # value within t
-00025280: 6865 2064 696d 2064 6963 7420 746f 2074  he dim dict to t
-00025290: 6865 206c 656e 6774 6820 6f66 2074 6865  he length of the
-000252a0: 2069 7465 7261 626c 650a 2020 2020 2020   iterable.      
-000252b0: 2020 2020 2020 2020 2020 2320 666f 7220            # for 
-000252c0: 6c61 7465 7220 7573 652e 0a20 2020 2020  later use..     
-000252d0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-000252e0: 203d 2050 616e 6461 7349 6e64 6578 2876   = PandasIndex(v
-000252f0: 2c20 6b29 0a20 2020 2020 2020 2020 2020  , k).           
-00025300: 2020 2020 2069 6e64 6578 6573 5b6b 5d20       indexes[k] 
-00025310: 3d20 696e 6465 780a 2020 2020 2020 2020  = index.        
-00025320: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-00025330: 732e 7570 6461 7465 2869 6e64 6578 2e63  s.update(index.c
-00025340: 7265 6174 655f 7661 7269 6162 6c65 7328  reate_variables(
-00025350: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
-00025360: 2020 2063 6f6f 7264 5f6e 616d 6573 2e61     coord_names.a
-00025370: 6464 286b 290a 2020 2020 2020 2020 2020  dd(k).          
-00025380: 2020 2020 2020 6469 6d5b 6b5d 203d 2076        dim[k] = v
-00025390: 6172 6961 626c 6573 5b6b 5d2e 7369 7a65  ariables[k].size
-000253a0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-000253b0: 6620 6973 696e 7374 616e 6365 2876 2c20  f isinstance(v, 
-000253c0: 696e 7429 3a0a 2020 2020 2020 2020 2020  int):.          
-000253d0: 2020 2020 2020 7061 7373 2020 2320 446f        pass  # Do
-000253e0: 206e 6f74 6869 6e67 2069 6620 7468 6520   nothing if the 
-000253f0: 6469 6d65 6e73 696f 6e73 2076 616c 7565  dimensions value
-00025400: 2069 7320 6a75 7374 2061 6e20 696e 740a   is just an int.
-00025410: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00025420: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00025430: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00025440: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
-00025450: 2020 2020 2020 2022 5468 6520 7661 6c75         "The valu
-00025460: 6520 6f66 206e 6577 2064 696d 656e 7369  e of new dimensi
-00025470: 6f6e 207b 6b7d 206d 7573 7420 6265 2022  on {k} must be "
-00025480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025490: 2020 2020 2022 616e 2069 7465 7261 626c       "an iterabl
-000254a0: 6520 6f72 2061 6e20 696e 7422 2e66 6f72  e or an int".for
-000254b0: 6d61 7428 6b3d 6b29 0a20 2020 2020 2020  mat(k=k).       
-000254c0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-000254d0: 2020 2020 666f 7220 6b2c 2076 2069 6e20      for k, v in 
-000254e0: 7365 6c66 2e5f 7661 7269 6162 6c65 732e  self._variables.
-000254f0: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-00025500: 2020 2020 2069 6620 6b20 6e6f 7420 696e       if k not in
-00025510: 2064 696d 3a0a 2020 2020 2020 2020 2020   dim:.          
-00025520: 2020 2020 2020 6966 206b 2069 6e20 636f        if k in co
-00025530: 6f72 645f 6e61 6d65 733a 2020 2320 446f  ord_names:  # Do
-00025540: 206e 6f74 2063 6861 6e67 6520 636f 6f72   not change coor
-00025550: 6469 6e61 7465 730a 2020 2020 2020 2020  dinates.        
-00025560: 2020 2020 2020 2020 2020 2020 7661 7269              vari
-00025570: 6162 6c65 735b 6b5d 203d 2076 0a20 2020  ables[k] = v.   
-00025580: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00025590: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-000255a0: 2020 2020 2020 2072 6573 756c 745f 6e64         result_nd
-000255b0: 696d 203d 206c 656e 2876 2e64 696d 7329  im = len(v.dims)
-000255c0: 202b 206c 656e 2861 7869 7329 0a20 2020   + len(axis).   
-000255d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000255e0: 2066 6f72 2061 2069 6e20 6178 6973 3a0a   for a in axis:.
-000255f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025600: 2020 2020 2020 2020 6966 2061 203c 202d          if a < -
-00025610: 7265 7375 6c74 5f6e 6469 6d20 6f72 2072  result_ndim or r
-00025620: 6573 756c 745f 6e64 696d 202d 2031 203c  esult_ndim - 1 <
-00025630: 2061 3a0a 2020 2020 2020 2020 2020 2020   a:.            
-00025640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025650: 7261 6973 6520 496e 6465 7845 7272 6f72  raise IndexError
-00025660: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00025670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025680: 2020 6622 4178 6973 207b 617d 206f 6620    f"Axis {a} of 
-00025690: 7661 7269 6162 6c65 207b 6b7d 2069 7320  variable {k} is 
-000256a0: 6f75 7420 6f66 2062 6f75 6e64 7320 6f66  out of bounds of
-000256b0: 2074 6865 2022 0a20 2020 2020 2020 2020   the ".         
-000256c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000256d0: 2020 2020 2020 2066 2265 7870 616e 6465         f"expande
-000256e0: 6420 6469 6d65 6e73 696f 6e20 7369 7a65  d dimension size
-000256f0: 207b 7265 7375 6c74 5f6e 6469 6d7d 220a   {result_ndim}".
+00024210: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+00024220: 6578 2c20 696e 6465 785f 7661 7273 203d  ex, index_vars =
+00024230: 2063 7265 6174 655f 6465 6661 756c 745f   create_default_
+00024240: 696e 6465 785f 696d 706c 6963 6974 2876  index_implicit(v
+00024250: 6172 290a 2020 2020 2020 2020 2020 2020  ar).            
+00024260: 2020 2020 2020 2020 696e 6465 7865 732e          indexes.
+00024270: 7570 6461 7465 287b 6e61 6d65 3a20 696e  update({name: in
+00024280: 6465 7820 666f 7220 6e61 6d65 2069 6e20  dex for name in 
+00024290: 696e 6465 785f 7661 7273 7d29 0a20 2020  index_vars}).   
+000242a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000242b0: 2076 6172 6961 626c 6573 2e75 7064 6174   variables.updat
+000242c0: 6528 696e 6465 785f 7661 7273 290a 2020  e(index_vars).  
+000242d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000242e0: 2020 636f 6f72 645f 6e61 6d65 732e 7570    coord_names.up
+000242f0: 6461 7465 2869 6e64 6578 5f76 6172 7329  date(index_vars)
+00024300: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00024310: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+00024320: 2020 2076 6172 203d 2076 2e74 6f5f 6261     var = v.to_ba
+00024330: 7365 5f76 6172 6961 626c 6528 290a 2020  se_variable().  
+00024340: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00024350: 722e 6469 6d73 203d 2064 696d 730a 2020  r.dims = dims.  
+00024360: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00024370: 7269 6162 6c65 735b 6b5d 203d 2076 6172  riables[k] = var
+00024380: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00024390: 2073 656c 662e 5f72 6570 6c61 6365 5f77   self._replace_w
+000243a0: 6974 685f 6e65 775f 6469 6d73 2876 6172  ith_new_dims(var
+000243b0: 6961 626c 6573 2c20 636f 6f72 645f 6e61  iables, coord_na
+000243c0: 6d65 732c 2069 6e64 6578 6573 3d69 6e64  mes, indexes=ind
+000243d0: 6578 6573 290a 0a20 2020 2023 2063 6861  exes)..    # cha
+000243e0: 6e67 6520 7479 7065 206f 6620 7365 6c66  nge type of self
+000243f0: 2061 6e64 2072 6574 7572 6e20 746f 2054   and return to T
+00024400: 5f44 6174 6173 6574 206f 6e63 650a 2020  _Dataset once.  
+00024410: 2020 2320 6874 7470 733a 2f2f 6769 7468    # https://gith
+00024420: 7562 2e63 6f6d 2f70 7974 686f 6e2f 6d79  ub.com/python/my
+00024430: 7079 2f69 7373 7565 732f 3132 3834 3620  py/issues/12846 
+00024440: 6973 2072 6573 6f6c 7665 640a 2020 2020  is resolved.    
+00024450: 6465 6620 6578 7061 6e64 5f64 696d 7328  def expand_dims(
+00024460: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00024470: 2020 2020 2020 2064 696d 3a20 4e6f 6e65         dim: None
+00024480: 207c 2048 6173 6861 626c 6520 7c20 5365   | Hashable | Se
+00024490: 7175 656e 6365 5b48 6173 6861 626c 655d  quence[Hashable]
+000244a0: 207c 204d 6170 7069 6e67 5b41 6e79 2c20   | Mapping[Any, 
+000244b0: 416e 795d 203d 204e 6f6e 652c 0a20 2020  Any] = None,.   
+000244c0: 2020 2020 2061 7869 733a 204e 6f6e 6520       axis: None 
+000244d0: 7c20 696e 7420 7c20 5365 7175 656e 6365  | int | Sequence
+000244e0: 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a 2020  [int] = None,.  
+000244f0: 2020 2020 2020 2a2a 6469 6d5f 6b77 6172        **dim_kwar
+00024500: 6773 3a20 416e 792c 0a20 2020 2029 202d  gs: Any,.    ) -
+00024510: 3e20 4461 7461 7365 743a 0a20 2020 2020  > Dataset:.     
+00024520: 2020 2022 2222 5265 7475 726e 2061 206e     """Return a n
+00024530: 6577 206f 626a 6563 7420 7769 7468 2061  ew object with a
+00024540: 6e20 6164 6469 7469 6f6e 616c 2061 7869  n additional axi
+00024550: 7320 286f 7220 6178 6573 2920 696e 7365  s (or axes) inse
+00024560: 7274 6564 2061 740a 2020 2020 2020 2020  rted at.        
+00024570: 7468 6520 636f 7272 6573 706f 6e64 696e  the correspondin
+00024580: 6720 706f 7369 7469 6f6e 2069 6e20 7468  g position in th
+00024590: 6520 6172 7261 7920 7368 6170 652e 2020  e array shape.  
+000245a0: 5468 6520 6e65 7720 6f62 6a65 6374 2069  The new object i
+000245b0: 7320 610a 2020 2020 2020 2020 7669 6577  s a.        view
+000245c0: 2069 6e74 6f20 7468 6520 756e 6465 726c   into the underl
+000245d0: 7969 6e67 2061 7272 6179 2c20 6e6f 7420  ying array, not 
+000245e0: 6120 636f 7079 2e0a 0a20 2020 2020 2020  a copy...       
+000245f0: 2049 6620 6469 6d20 6973 2061 6c72 6561   If dim is alrea
+00024600: 6479 2061 2073 6361 6c61 7220 636f 6f72  dy a scalar coor
+00024610: 6469 6e61 7465 2c20 6974 2077 696c 6c20  dinate, it will 
+00024620: 6265 2070 726f 6d6f 7465 6420 746f 2061  be promoted to a
+00024630: 2031 440a 2020 2020 2020 2020 636f 6f72   1D.        coor
+00024640: 6469 6e61 7465 2063 6f6e 7369 7374 696e  dinate consistin
+00024650: 6720 6f66 2061 2073 696e 676c 6520 7661  g of a single va
+00024660: 6c75 652e 0a0a 2020 2020 2020 2020 5061  lue...        Pa
+00024670: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00024680: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00024690: 2020 2020 6469 6d20 3a20 6861 7368 6162      dim : hashab
+000246a0: 6c65 2c20 7365 7175 656e 6365 206f 6620  le, sequence of 
+000246b0: 6861 7368 6162 6c65 2c20 6d61 7070 696e  hashable, mappin
+000246c0: 672c 206f 7220 4e6f 6e65 0a20 2020 2020  g, or None.     
+000246d0: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
+000246e0: 7320 746f 2069 6e63 6c75 6465 206f 6e20  s to include on 
+000246f0: 7468 6520 6e65 7720 7661 7269 6162 6c65  the new variable
+00024700: 2e20 4966 2070 726f 7669 6465 6420 6173  . If provided as
+00024710: 2068 6173 6861 626c 650a 2020 2020 2020   hashable.      
+00024720: 2020 2020 2020 6f72 2073 6571 7565 6e63        or sequenc
+00024730: 6520 6f66 2068 6173 6861 626c 652c 2074  e of hashable, t
+00024740: 6865 6e20 6469 6d65 6e73 696f 6e73 2061  hen dimensions a
+00024750: 7265 2069 6e73 6572 7465 6420 7769 7468  re inserted with
+00024760: 206c 656e 6774 680a 2020 2020 2020 2020   length.        
+00024770: 2020 2020 312e 2049 6620 7072 6f76 6964      1. If provid
+00024780: 6564 2061 7320 6120 6d61 7070 696e 672c  ed as a mapping,
+00024790: 2074 6865 6e20 7468 6520 6b65 7973 2061   then the keys a
+000247a0: 7265 2074 6865 206e 6577 2064 696d 656e  re the new dimen
+000247b0: 7369 6f6e 730a 2020 2020 2020 2020 2020  sions.          
+000247c0: 2020 616e 6420 7468 6520 7661 6c75 6573    and the values
+000247d0: 2061 7265 2065 6974 6865 7220 696e 7465   are either inte
+000247e0: 6765 7273 2028 6769 7669 6e67 2074 6865  gers (giving the
+000247f0: 206c 656e 6774 6820 6f66 2074 6865 206e   length of the n
+00024800: 6577 0a20 2020 2020 2020 2020 2020 2064  ew.            d
+00024810: 696d 656e 7369 6f6e 7329 206f 7220 6172  imensions) or ar
+00024820: 7261 792d 6c69 6b65 2028 6769 7669 6e67  ray-like (giving
+00024830: 2074 6865 2063 6f6f 7264 696e 6174 6573   the coordinates
+00024840: 206f 6620 7468 6520 6e65 770a 2020 2020   of the new.    
+00024850: 2020 2020 2020 2020 6469 6d65 6e73 696f          dimensio
+00024860: 6e73 292e 0a20 2020 2020 2020 2061 7869  ns)..        axi
+00024870: 7320 3a20 696e 742c 2073 6571 7565 6e63  s : int, sequenc
+00024880: 6520 6f66 2069 6e74 2c20 6f72 204e 6f6e  e of int, or Non
+00024890: 652c 2064 6566 6175 6c74 3a20 4e6f 6e65  e, default: None
+000248a0: 0a20 2020 2020 2020 2020 2020 2041 7869  .            Axi
+000248b0: 7320 706f 7369 7469 6f6e 2873 2920 7768  s position(s) wh
+000248c0: 6572 6520 6e65 7720 6178 6973 2069 7320  ere new axis is 
+000248d0: 746f 2062 6520 696e 7365 7274 6564 2028  to be inserted (
+000248e0: 706f 7369 7469 6f6e 2873 2920 6f6e 0a20  position(s) on. 
+000248f0: 2020 2020 2020 2020 2020 2074 6865 2072             the r
+00024900: 6573 756c 7420 6172 7261 7929 2e20 4966  esult array). If
+00024910: 2061 2073 6571 7565 6e63 6520 6f66 2069   a sequence of i
+00024920: 6e74 6567 6572 7320 6973 2070 6173 7365  ntegers is passe
+00024930: 642c 0a20 2020 2020 2020 2020 2020 206d  d,.            m
+00024940: 756c 7469 706c 6520 6178 6573 2061 7265  ultiple axes are
+00024950: 2069 6e73 6572 7465 642e 2049 6e20 7468   inserted. In th
+00024960: 6973 2063 6173 652c 2064 696d 2061 7267  is case, dim arg
+00024970: 756d 656e 7473 2073 686f 756c 6420 6265  uments should be
+00024980: 0a20 2020 2020 2020 2020 2020 2073 616d  .            sam
+00024990: 6520 6c65 6e67 7468 206c 6973 742e 2049  e length list. I
+000249a0: 6620 6178 6973 3d4e 6f6e 6520 6973 2070  f axis=None is p
+000249b0: 6173 7365 642c 2061 6c6c 2074 6865 2061  assed, all the a
+000249c0: 7865 7320 7769 6c6c 2062 650a 2020 2020  xes will be.    
+000249d0: 2020 2020 2020 2020 696e 7365 7274 6564          inserted
+000249e0: 2074 6f20 7468 6520 7374 6172 7420 6f66   to the start of
+000249f0: 2074 6865 2072 6573 756c 7420 6172 7261   the result arra
+00024a00: 792e 0a20 2020 2020 2020 202a 2a64 696d  y..        **dim
+00024a10: 5f6b 7761 7267 7320 3a20 696e 7420 6f72  _kwargs : int or
+00024a20: 2073 6571 7565 6e63 6520 6f72 206e 6461   sequence or nda
+00024a30: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00024a40: 2054 6865 206b 6579 776f 7264 7320 6172   The keywords ar
+00024a50: 6520 6172 6269 7472 6172 7920 6469 6d65  e arbitrary dime
+00024a60: 6e73 696f 6e73 2062 6569 6e67 2069 6e73  nsions being ins
+00024a70: 6572 7465 6420 616e 6420 7468 6520 7661  erted and the va
+00024a80: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
+00024a90: 2061 7265 2065 6974 6865 7220 7468 6520   are either the 
+00024aa0: 6c65 6e67 7468 7320 6f66 2074 6865 206e  lengths of the n
+00024ab0: 6577 2064 696d 7320 2869 6620 696e 7420  ew dims (if int 
+00024ac0: 6973 2067 6976 656e 292c 206f 7220 7468  is given), or th
+00024ad0: 6569 720a 2020 2020 2020 2020 2020 2020  eir.            
+00024ae0: 636f 6f72 6469 6e61 7465 732e 204e 6f74  coordinates. Not
+00024af0: 652c 2074 6869 7320 6973 2061 6e20 616c  e, this is an al
+00024b00: 7465 726e 6174 6976 6520 746f 2070 6173  ternative to pas
+00024b10: 7369 6e67 2061 2064 6963 7420 746f 2074  sing a dict to t
+00024b20: 6865 0a20 2020 2020 2020 2020 2020 2064  he.            d
+00024b30: 696d 206b 7761 7267 2061 6e64 2077 696c  im kwarg and wil
+00024b40: 6c20 6f6e 6c79 2062 6520 7573 6564 2069  l only be used i
+00024b50: 6620 6469 6d20 6973 204e 6f6e 652e 0a0a  f dim is None...
+00024b60: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00024b70: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00024b80: 2020 2020 2020 2020 6578 7061 6e64 6564          expanded
+00024b90: 203a 2044 6174 6173 6574 0a20 2020 2020   : Dataset.     
+00024ba0: 2020 2020 2020 2054 6869 7320 6f62 6a65         This obje
+00024bb0: 6374 2c20 6275 7420 7769 7468 2061 6464  ct, but with add
+00024bc0: 6974 696f 6e61 6c20 6469 6d65 6e73 696f  itional dimensio
+00024bd0: 6e28 7329 2e0a 0a20 2020 2020 2020 2053  n(s)...        S
+00024be0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+00024bf0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00024c00: 2044 6174 6141 7272 6179 2e65 7870 616e   DataArray.expan
+00024c10: 645f 6469 6d73 0a20 2020 2020 2020 2022  d_dims.        "
+00024c20: 2222 0a20 2020 2020 2020 2069 6620 6469  "".        if di
+00024c30: 6d20 6973 204e 6f6e 653a 0a20 2020 2020  m is None:.     
+00024c40: 2020 2020 2020 2070 6173 730a 2020 2020         pass.    
+00024c50: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00024c60: 6e63 6528 6469 6d2c 204d 6170 7069 6e67  nce(dim, Mapping
+00024c70: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
+00024c80: 2057 6527 7265 206c 6174 6572 2067 6f69   We're later goi
+00024c90: 6e67 2074 6f20 6d6f 6469 6679 2064 696d  ng to modify dim
+00024ca0: 2069 6e20 706c 6163 653b 2064 6f6e 2774   in place; don't
+00024cb0: 2074 616d 7065 7220 7769 7468 0a20 2020   tamper with.   
+00024cc0: 2020 2020 2020 2020 2023 2074 6865 2069           # the i
+00024cd0: 6e70 7574 0a20 2020 2020 2020 2020 2020  nput.           
+00024ce0: 2064 696d 203d 2064 6963 7428 6469 6d29   dim = dict(dim)
+00024cf0: 0a20 2020 2020 2020 2065 6c69 6620 6973  .        elif is
+00024d00: 696e 7374 616e 6365 2864 696d 2c20 696e  instance(dim, in
+00024d10: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
+00024d20: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00024d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024d40: 2022 6469 6d20 7368 6f75 6c64 2062 6520   "dim should be 
+00024d50: 6861 7368 6162 6c65 206f 7220 7365 7175  hashable or sequ
+00024d60: 656e 6365 206f 6620 6861 7368 6162 6c65  ence of hashable
+00024d70: 7320 6f72 206d 6170 7069 6e67 220a 2020  s or mapping".  
+00024d80: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00024d90: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00024da0: 6e63 6528 6469 6d2c 2073 7472 2920 6f72  nce(dim, str) or
+00024db0: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+00024dc0: 6469 6d2c 2053 6571 7565 6e63 6529 3a0a  dim, Sequence):.
+00024dd0: 2020 2020 2020 2020 2020 2020 6469 6d20              dim 
+00024de0: 3d20 7b64 696d 3a20 317d 0a20 2020 2020  = {dim: 1}.     
+00024df0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
+00024e00: 6365 2864 696d 2c20 5365 7175 656e 6365  ce(dim, Sequence
+00024e10: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00024e20: 6620 6c65 6e28 6469 6d29 2021 3d20 6c65  f len(dim) != le
+00024e30: 6e28 7365 7428 6469 6d29 293a 0a20 2020  n(set(dim)):.   
+00024e40: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00024e50: 7365 2056 616c 7565 4572 726f 7228 2264  se ValueError("d
+00024e60: 696d 7320 7368 6f75 6c64 206e 6f74 2063  ims should not c
+00024e70: 6f6e 7461 696e 2064 7570 6c69 6361 7465  ontain duplicate
+00024e80: 2076 616c 7565 732e 2229 0a20 2020 2020   values.").     
+00024e90: 2020 2020 2020 2064 696d 203d 207b 643a         dim = {d:
+00024ea0: 2031 2066 6f72 2064 2069 6e20 6469 6d7d   1 for d in dim}
+00024eb0: 0a0a 2020 2020 2020 2020 6469 6d20 3d20  ..        dim = 
+00024ec0: 6569 7468 6572 5f64 6963 745f 6f72 5f6b  either_dict_or_k
+00024ed0: 7761 7267 7328 6469 6d2c 2064 696d 5f6b  wargs(dim, dim_k
+00024ee0: 7761 7267 732c 2022 6578 7061 6e64 5f64  wargs, "expand_d
+00024ef0: 696d 7322 290a 2020 2020 2020 2020 6173  ims").        as
+00024f00: 7365 7274 2069 7369 6e73 7461 6e63 6528  sert isinstance(
+00024f10: 6469 6d2c 204d 7574 6162 6c65 4d61 7070  dim, MutableMapp
+00024f20: 696e 6729 0a0a 2020 2020 2020 2020 6966  ing)..        if
+00024f30: 2061 7869 7320 6973 204e 6f6e 653a 0a20   axis is None:. 
+00024f40: 2020 2020 2020 2020 2020 2061 7869 7320             axis 
+00024f50: 3d20 6c69 7374 2872 616e 6765 286c 656e  = list(range(len
+00024f60: 2864 696d 2929 290a 2020 2020 2020 2020  (dim))).        
+00024f70: 656c 6966 206e 6f74 2069 7369 6e73 7461  elif not isinsta
+00024f80: 6e63 6528 6178 6973 2c20 5365 7175 656e  nce(axis, Sequen
+00024f90: 6365 293a 0a20 2020 2020 2020 2020 2020  ce):.           
+00024fa0: 2061 7869 7320 3d20 5b61 7869 735d 0a0a   axis = [axis]..
+00024fb0: 2020 2020 2020 2020 6966 206c 656e 2864          if len(d
+00024fc0: 696d 2920 213d 206c 656e 2861 7869 7329  im) != len(axis)
+00024fd0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00024fe0: 6973 6520 5661 6c75 6545 7272 6f72 2822  ise ValueError("
+00024ff0: 6c65 6e67 7468 7320 6f66 2064 696d 2061  lengths of dim a
+00025000: 6e64 2061 7869 7320 7368 6f75 6c64 2062  nd axis should b
+00025010: 6520 6964 656e 7469 6361 6c2e 2229 0a20  e identical."). 
+00025020: 2020 2020 2020 2066 6f72 2064 2069 6e20         for d in 
+00025030: 6469 6d3a 0a20 2020 2020 2020 2020 2020  dim:.           
+00025040: 2069 6620 6420 696e 2073 656c 662e 6469   if d in self.di
+00025050: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
+00025060: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00025070: 7272 6f72 2866 2244 696d 656e 7369 6f6e  rror(f"Dimension
+00025080: 207b 647d 2061 6c72 6561 6479 2065 7869   {d} already exi
+00025090: 7374 732e 2229 0a20 2020 2020 2020 2020  sts.").         
+000250a0: 2020 2069 6620 6420 696e 2073 656c 662e     if d in self.
+000250b0: 5f76 6172 6961 626c 6573 2061 6e64 206e  _variables and n
+000250c0: 6f74 2075 7469 6c73 2e69 735f 7363 616c  ot utils.is_scal
+000250d0: 6172 2873 656c 662e 5f76 6172 6961 626c  ar(self._variabl
+000250e0: 6573 5b64 5d29 3a0a 2020 2020 2020 2020  es[d]):.        
+000250f0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00025100: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00025110: 2020 2020 2020 2020 2020 2020 2020 227b                "{
+00025120: 6469 6d7d 2061 6c72 6561 6479 2065 7869  dim} already exi
+00025130: 7374 7320 6173 2063 6f6f 7264 696e 6174  sts as coordinat
+00025140: 6520 6f72 220a 2020 2020 2020 2020 2020  e or".          
+00025150: 2020 2020 2020 2020 2020 2220 7661 7269            " vari
+00025160: 6162 6c65 206e 616d 652e 222e 666f 726d  able name.".form
+00025170: 6174 2864 696d 3d64 290a 2020 2020 2020  at(dim=d).      
+00025180: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00025190: 2020 2020 2076 6172 6961 626c 6573 3a20       variables: 
+000251a0: 6469 6374 5b48 6173 6861 626c 652c 2056  dict[Hashable, V
+000251b0: 6172 6961 626c 655d 203d 207b 7d0a 2020  ariable] = {}.  
+000251c0: 2020 2020 2020 696e 6465 7865 733a 2064        indexes: d
+000251d0: 6963 745b 4861 7368 6162 6c65 2c20 496e  ict[Hashable, In
+000251e0: 6465 785d 203d 2064 6963 7428 7365 6c66  dex] = dict(self
+000251f0: 2e5f 696e 6465 7865 7329 0a20 2020 2020  ._indexes).     
+00025200: 2020 2063 6f6f 7264 5f6e 616d 6573 203d     coord_names =
+00025210: 2073 656c 662e 5f63 6f6f 7264 5f6e 616d   self._coord_nam
+00025220: 6573 2e63 6f70 7928 290a 2020 2020 2020  es.copy().      
+00025230: 2020 2320 4966 2064 696d 2069 7320 6120    # If dim is a 
+00025240: 6469 6374 2c20 7468 656e 2065 6e73 7572  dict, then ensur
+00025250: 6520 7468 6174 2074 6865 2076 616c 7565  e that the value
+00025260: 7320 6172 6520 6569 7468 6572 2069 6e74  s are either int
+00025270: 6567 6572 730a 2020 2020 2020 2020 2320  egers.        # 
+00025280: 6f72 2069 7465 7261 626c 6573 2e0a 2020  or iterables..  
+00025290: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
+000252a0: 6e20 6469 6d2e 6974 656d 7328 293a 0a20  n dim.items():. 
+000252b0: 2020 2020 2020 2020 2020 2069 6620 6861             if ha
+000252c0: 7361 7474 7228 762c 2022 5f5f 6974 6572  sattr(v, "__iter
+000252d0: 5f5f 2229 3a0a 2020 2020 2020 2020 2020  __"):.          
+000252e0: 2020 2020 2020 2320 4966 2074 6865 2076        # If the v
+000252f0: 616c 7565 2066 6f72 2074 6865 206e 6577  alue for the new
+00025300: 2064 696d 656e 7369 6f6e 2069 7320 616e   dimension is an
+00025310: 2069 7465 7261 626c 652c 2074 6865 6e0a   iterable, then.
+00025320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025330: 2320 7361 7665 2074 6865 2063 6f6f 7264  # save the coord
+00025340: 696e 6174 6573 2074 6f20 7468 6520 7661  inates to the va
+00025350: 7269 6162 6c65 7320 6469 6374 2c20 616e  riables dict, an
+00025360: 6420 7365 7420 7468 650a 2020 2020 2020  d set the.      
+00025370: 2020 2020 2020 2020 2020 2320 7661 6c75            # valu
+00025380: 6520 7769 7468 696e 2074 6865 2064 696d  e within the dim
+00025390: 2064 6963 7420 746f 2074 6865 206c 656e   dict to the len
+000253a0: 6774 6820 6f66 2074 6865 2069 7465 7261  gth of the itera
+000253b0: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
+000253c0: 2020 2020 2320 666f 7220 6c61 7465 7220      # for later 
+000253d0: 7573 652e 0a20 2020 2020 2020 2020 2020  use..           
+000253e0: 2020 2020 2069 6e64 6578 203d 2050 616e       index = Pan
+000253f0: 6461 7349 6e64 6578 2876 2c20 6b29 0a20  dasIndex(v, k). 
+00025400: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00025410: 6e64 6578 6573 5b6b 5d20 3d20 696e 6465  ndexes[k] = inde
+00025420: 780a 2020 2020 2020 2020 2020 2020 2020  x.              
+00025430: 2020 7661 7269 6162 6c65 732e 7570 6461    variables.upda
+00025440: 7465 2869 6e64 6578 2e63 7265 6174 655f  te(index.create_
+00025450: 7661 7269 6162 6c65 7328 2929 0a20 2020  variables()).   
+00025460: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+00025470: 7264 5f6e 616d 6573 2e61 6464 286b 290a  rd_names.add(k).
+00025480: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025490: 6469 6d5b 6b5d 203d 2076 6172 6961 626c  dim[k] = variabl
+000254a0: 6573 5b6b 5d2e 7369 7a65 0a20 2020 2020  es[k].size.     
+000254b0: 2020 2020 2020 2065 6c69 6620 6973 696e         elif isin
+000254c0: 7374 616e 6365 2876 2c20 696e 7429 3a0a  stance(v, int):.
+000254d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000254e0: 7061 7373 2020 2320 446f 206e 6f74 6869  pass  # Do nothi
+000254f0: 6e67 2069 6620 7468 6520 6469 6d65 6e73  ng if the dimens
+00025500: 696f 6e73 2076 616c 7565 2069 7320 6a75  ions value is ju
+00025510: 7374 2061 6e20 696e 740a 2020 2020 2020  st an int.      
+00025520: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00025530: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00025540: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+00025550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025560: 2022 5468 6520 7661 6c75 6520 6f66 206e   "The value of n
+00025570: 6577 2064 696d 656e 7369 6f6e 207b 6b7d  ew dimension {k}
+00025580: 206d 7573 7420 6265 2022 0a20 2020 2020   must be ".     
+00025590: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000255a0: 616e 2069 7465 7261 626c 6520 6f72 2061  an iterable or a
+000255b0: 6e20 696e 7422 2e66 6f72 6d61 7428 6b3d  n int".format(k=
+000255c0: 6b29 0a20 2020 2020 2020 2020 2020 2020  k).             
+000255d0: 2020 2029 0a0a 2020 2020 2020 2020 666f     )..        fo
+000255e0: 7220 6b2c 2076 2069 6e20 7365 6c66 2e5f  r k, v in self._
+000255f0: 7661 7269 6162 6c65 732e 6974 656d 7328  variables.items(
+00025600: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+00025610: 6620 6b20 6e6f 7420 696e 2064 696d 3a0a  f k not in dim:.
+00025620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025630: 6966 206b 2069 6e20 636f 6f72 645f 6e61  if k in coord_na
+00025640: 6d65 733a 2020 2320 446f 206e 6f74 2063  mes:  # Do not c
+00025650: 6861 6e67 6520 636f 6f72 6469 6e61 7465  hange coordinate
+00025660: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00025670: 2020 2020 2020 7661 7269 6162 6c65 735b        variables[
+00025680: 6b5d 203d 2076 0a20 2020 2020 2020 2020  k] = v.         
+00025690: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+000256a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000256b0: 2072 6573 756c 745f 6e64 696d 203d 206c   result_ndim = l
+000256c0: 656e 2876 2e64 696d 7329 202b 206c 656e  en(v.dims) + len
+000256d0: 2861 7869 7329 0a20 2020 2020 2020 2020  (axis).         
+000256e0: 2020 2020 2020 2020 2020 2066 6f72 2061             for a
+000256f0: 2069 6e20 6178 6973 3a0a 2020 2020 2020   in axis:.      
 00025700: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025710: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00025720: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025730: 2020 2061 7869 735f 706f 7320 3d20 5b61     axis_pos = [a
-00025740: 2069 6620 6120 3e3d 2030 2065 6c73 6520   if a >= 0 else 
-00025750: 7265 7375 6c74 5f6e 6469 6d20 2b20 6120  result_ndim + a 
-00025760: 666f 7220 6120 696e 2061 7869 735d 0a20  for a in axis]. 
+00025710: 2020 6966 2061 203c 202d 7265 7375 6c74    if a < -result
+00025720: 5f6e 6469 6d20 6f72 2072 6573 756c 745f  _ndim or result_
+00025730: 6e64 696d 202d 2031 203c 2061 3a0a 2020  ndim - 1 < a:.  
+00025740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025750: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00025760: 496e 6465 7845 7272 6f72 280a 2020 2020  IndexError(.    
 00025770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025780: 2020 2069 6620 6c65 6e28 6178 6973 5f70     if len(axis_p
-00025790: 6f73 2920 213d 206c 656e 2873 6574 2861  os) != len(set(a
-000257a0: 7869 735f 706f 7329 293a 0a20 2020 2020  xis_pos)):.     
-000257b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000257c0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000257d0: 726f 7228 2261 7869 7320 7368 6f75 6c64  ror("axis should
-000257e0: 206e 6f74 2063 6f6e 7461 696e 2064 7570   not contain dup
-000257f0: 6c69 6361 7465 2076 616c 7565 7322 290a  licate values").
-00025800: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025810: 2020 2020 2320 5765 206e 6565 6420 746f      # We need to
-00025820: 2073 6f72 7420 7468 656d 2074 6f20 6d61   sort them to ma
-00025830: 6b65 2073 7572 6520 6061 7869 7360 2065  ke sure `axis` e
-00025840: 7175 616c 7320 746f 2074 6865 0a20 2020  quals to the.   
-00025850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025860: 2023 2061 7869 7320 706f 7369 7469 6f6e   # axis position
-00025870: 7320 6f66 2074 6865 2072 6573 756c 7420  s of the result 
-00025880: 6172 7261 792e 0a20 2020 2020 2020 2020  array..         
-00025890: 2020 2020 2020 2020 2020 207a 6970 5f61             zip_a
-000258a0: 7869 735f 6469 6d20 3d20 736f 7274 6564  xis_dim = sorted
-000258b0: 287a 6970 2861 7869 735f 706f 732c 2064  (zip(axis_pos, d
-000258c0: 696d 2e69 7465 6d73 2829 2929 0a0a 2020  im.items()))..  
-000258d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000258e0: 2020 616c 6c5f 6469 6d73 203d 206c 6973    all_dims = lis
-000258f0: 7428 7a69 7028 762e 6469 6d73 2c20 762e  t(zip(v.dims, v.
-00025900: 7368 6170 6529 290a 2020 2020 2020 2020  shape)).        
-00025910: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00025920: 642c 2063 2069 6e20 7a69 705f 6178 6973  d, c in zip_axis
-00025930: 5f64 696d 3a0a 2020 2020 2020 2020 2020  _dim:.          
-00025940: 2020 2020 2020 2020 2020 2020 2020 616c                al
-00025950: 6c5f 6469 6d73 2e69 6e73 6572 7428 642c  l_dims.insert(d,
-00025960: 2063 290a 2020 2020 2020 2020 2020 2020   c).            
-00025970: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-00025980: 735b 6b5d 203d 2076 2e73 6574 5f64 696d  s[k] = v.set_dim
-00025990: 7328 6469 6374 2861 6c6c 5f64 696d 7329  s(dict(all_dims)
-000259a0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-000259b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000259c0: 2020 2020 6966 206b 206e 6f74 2069 6e20      if k not in 
-000259d0: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
-000259e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-000259f0: 2049 6620 6469 6d73 2069 6e63 6c75 6465   If dims include
-00025a00: 7320 6120 6c61 6265 6c20 6f66 2061 206e  s a label of a n
-00025a10: 6f6e 2d64 696d 656e 7369 6f6e 2063 6f6f  on-dimension coo
-00025a20: 7264 696e 6174 652c 0a20 2020 2020 2020  rdinate,.       
-00025a30: 2020 2020 2020 2020 2020 2020 2023 2069               # i
-00025a40: 7420 7769 6c6c 2062 6520 7072 6f6d 6f74  t will be promot
-00025a50: 6564 2074 6f20 6120 3144 2063 6f6f 7264  ed to a 1D coord
-00025a60: 696e 6174 6520 7769 7468 2061 2073 696e  inate with a sin
-00025a70: 676c 6520 7661 6c75 652e 0a20 2020 2020  gle value..     
-00025a80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00025a90: 6e64 6578 2c20 696e 6465 785f 7661 7273  ndex, index_vars
-00025aa0: 203d 2063 7265 6174 655f 6465 6661 756c   = create_defaul
-00025ab0: 745f 696e 6465 785f 696d 706c 6963 6974  t_index_implicit
-00025ac0: 2876 2e73 6574 5f64 696d 7328 6b29 290a  (v.set_dims(k)).
-00025ad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025ae0: 2020 2020 696e 6465 7865 735b 6b5d 203d      indexes[k] =
-00025af0: 2069 6e64 6578 0a20 2020 2020 2020 2020   index.         
-00025b00: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-00025b10: 626c 6573 2e75 7064 6174 6528 696e 6465  bles.update(inde
-00025b20: 785f 7661 7273 290a 0a20 2020 2020 2020  x_vars)..       
-00025b30: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
-00025b40: 706c 6163 655f 7769 7468 5f6e 6577 5f64  place_with_new_d
-00025b50: 696d 7328 0a20 2020 2020 2020 2020 2020  ims(.           
-00025b60: 2076 6172 6961 626c 6573 2c20 636f 6f72   variables, coor
-00025b70: 645f 6e61 6d65 733d 636f 6f72 645f 6e61  d_names=coord_na
-00025b80: 6d65 732c 2069 6e64 6578 6573 3d69 6e64  mes, indexes=ind
-00025b90: 6578 6573 0a20 2020 2020 2020 2029 0a0a  exes.        )..
-00025ba0: 2020 2020 2320 6368 616e 6765 2074 7970      # change typ
-00025bb0: 6520 6f66 2073 656c 6620 616e 6420 7265  e of self and re
-00025bc0: 7475 726e 2074 6f20 545f 4461 7461 7365  turn to T_Datase
-00025bd0: 7420 6f6e 6365 0a20 2020 2023 2068 7474  t once.    # htt
-00025be0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-00025bf0: 7079 7468 6f6e 2f6d 7970 792f 6973 7375  python/mypy/issu
-00025c00: 6573 2f31 3238 3436 2069 7320 7265 736f  es/12846 is reso
-00025c10: 6c76 6564 0a20 2020 2064 6566 2073 6574  lved.    def set
-00025c20: 5f69 6e64 6578 280a 2020 2020 2020 2020  _index(.        
-00025c30: 7365 6c66 2c0a 2020 2020 2020 2020 696e  self,.        in
-00025c40: 6465 7865 733a 204d 6170 7069 6e67 5b41  dexes: Mapping[A
-00025c50: 6e79 2c20 4861 7368 6162 6c65 207c 2053  ny, Hashable | S
-00025c60: 6571 7565 6e63 655b 4861 7368 6162 6c65  equence[Hashable
-00025c70: 5d5d 207c 204e 6f6e 6520 3d20 4e6f 6e65  ]] | None = None
-00025c80: 2c0a 2020 2020 2020 2020 6170 7065 6e64  ,.        append
-00025c90: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-00025ca0: 2020 2020 2020 2020 2a2a 696e 6465 7865          **indexe
-00025cb0: 735f 6b77 6172 6773 3a20 4861 7368 6162  s_kwargs: Hashab
-00025cc0: 6c65 207c 2053 6571 7565 6e63 655b 4861  le | Sequence[Ha
-00025cd0: 7368 6162 6c65 5d2c 0a20 2020 2029 202d  shable],.    ) -
-00025ce0: 3e20 4461 7461 7365 743a 0a20 2020 2020  > Dataset:.     
-00025cf0: 2020 2022 2222 5365 7420 4461 7461 7365     """Set Datase
-00025d00: 7420 286d 756c 7469 2d29 696e 6465 7865  t (multi-)indexe
-00025d10: 7320 7573 696e 6720 6f6e 6520 6f72 206d  s using one or m
-00025d20: 6f72 6520 6578 6973 7469 6e67 2063 6f6f  ore existing coo
-00025d30: 7264 696e 6174 6573 0a20 2020 2020 2020  rdinates.       
-00025d40: 206f 7220 7661 7269 6162 6c65 732e 0a0a   or variables...
-00025d50: 2020 2020 2020 2020 5468 6973 206c 6567          This leg
-00025d60: 6163 7920 6d65 7468 6f64 2069 7320 6c69  acy method is li
-00025d70: 6d69 7465 6420 746f 2070 616e 6461 7320  mited to pandas 
-00025d80: 286d 756c 7469 2d29 696e 6465 7865 7320  (multi-)indexes 
-00025d90: 616e 640a 2020 2020 2020 2020 312d 6469  and.        1-di
-00025da0: 6d65 6e73 696f 6e61 6c20 2264 696d 656e  mensional "dimen
-00025db0: 7369 6f6e 2220 636f 6f72 6469 6e61 7465  sion" coordinate
-00025dc0: 732e 2053 6565 0a20 2020 2020 2020 203a  s. See.        :
-00025dd0: 7079 3a6d 6574 683a 607e 4461 7461 7365  py:meth:`~Datase
-00025de0: 742e 7365 745f 7869 6e64 6578 6020 666f  t.set_xindex` fo
-00025df0: 7220 7365 7474 696e 6720 6120 7061 6e64  r setting a pand
-00025e00: 6173 206f 7220 6120 6375 7374 6f6d 0a20  as or a custom. 
-00025e10: 2020 2020 2020 2058 6172 7261 792d 636f         Xarray-co
-00025e20: 6d70 6174 6962 6c65 2069 6e64 6578 2066  mpatible index f
-00025e30: 726f 6d20 6f6e 6520 6f72 206d 6f72 6520  rom one or more 
-00025e40: 6172 6269 7472 6172 7920 636f 6f72 6469  arbitrary coordi
-00025e50: 6e61 7465 732e 0a0a 2020 2020 2020 2020  nates...        
-00025e60: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00025e70: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00025e80: 2020 2020 2020 696e 6465 7865 7320 3a20        indexes : 
-00025e90: 7b64 696d 3a20 696e 6465 782c 202e 2e2e  {dim: index, ...
-00025ea0: 7d0a 2020 2020 2020 2020 2020 2020 4d61  }.            Ma
-00025eb0: 7070 696e 6720 6672 6f6d 206e 616d 6573  pping from names
-00025ec0: 206d 6174 6368 696e 6720 6469 6d65 6e73   matching dimens
-00025ed0: 696f 6e73 2061 6e64 2076 616c 7565 7320  ions and values 
-00025ee0: 6769 7665 6e0a 2020 2020 2020 2020 2020  given.          
-00025ef0: 2020 6279 2028 6c69 7374 7320 6f66 2920    by (lists of) 
-00025f00: 7468 6520 6e61 6d65 7320 6f66 2065 7869  the names of exi
-00025f10: 7374 696e 6720 636f 6f72 6469 6e61 7465  sting coordinate
-00025f20: 7320 6f72 2076 6172 6961 626c 6573 2074  s or variables t
-00025f30: 6f20 7365 740a 2020 2020 2020 2020 2020  o set.          
-00025f40: 2020 6173 206e 6577 2028 6d75 6c74 692d    as new (multi-
-00025f50: 2969 6e64 6578 2e0a 2020 2020 2020 2020  )index..        
-00025f60: 6170 7065 6e64 203a 2062 6f6f 6c2c 2064  append : bool, d
-00025f70: 6566 6175 6c74 3a20 4661 6c73 650a 2020  efault: False.  
-00025f80: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
-00025f90: 652c 2061 7070 656e 6420 7468 6520 7375  e, append the su
-00025fa0: 7070 6c69 6564 2069 6e64 6578 2865 7329  pplied index(es)
-00025fb0: 2074 6f20 7468 6520 6578 6973 7469 6e67   to the existing
-00025fc0: 2069 6e64 6578 2865 7329 2e0a 2020 2020   index(es)..    
-00025fd0: 2020 2020 2020 2020 4f74 6865 7277 6973          Otherwis
-00025fe0: 6520 7265 706c 6163 6520 7468 6520 6578  e replace the ex
-00025ff0: 6973 7469 6e67 2069 6e64 6578 2865 7329  isting index(es)
-00026000: 2028 6465 6661 756c 7429 2e0a 2020 2020   (default)..    
-00026010: 2020 2020 2a2a 696e 6465 7865 735f 6b77      **indexes_kw
-00026020: 6172 6773 203a 206f 7074 696f 6e61 6c0a  args : optional.
-00026030: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-00026040: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
-00026050: 7320 666f 726d 206f 6620 6060 696e 6465  s form of ``inde
-00026060: 7865 7360 602e 0a20 2020 2020 2020 2020  xes``..         
-00026070: 2020 204f 6e65 206f 6620 696e 6465 7865     One of indexe
-00026080: 7320 6f72 2069 6e64 6578 6573 5f6b 7761  s or indexes_kwa
-00026090: 7267 7320 6d75 7374 2062 6520 7072 6f76  rgs must be prov
-000260a0: 6964 6564 2e0a 0a20 2020 2020 2020 2052  ided...        R
-000260b0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-000260c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206f  ------.        o
-000260d0: 626a 203a 2044 6174 6173 6574 0a20 2020  bj : Dataset.   
-000260e0: 2020 2020 2020 2020 2041 6e6f 7468 6572           Another
-000260f0: 2064 6174 6173 6574 2c20 7769 7468 2074   dataset, with t
-00026100: 6869 7320 6461 7461 7365 7427 7320 6461  his dataset's da
-00026110: 7461 2062 7574 2072 6570 6c61 6365 6420  ta but replaced 
-00026120: 636f 6f72 6469 6e61 7465 732e 0a0a 2020  coordinates...  
-00026130: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-00026140: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00026150: 2020 2020 2020 2020 3e3e 3e20 6172 7220          >>> arr 
-00026160: 3d20 7872 2e44 6174 6141 7272 6179 280a  = xr.DataArray(.
-00026170: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-00026180: 6461 7461 3d6e 702e 6f6e 6573 2828 322c  data=np.ones((2,
-00026190: 2033 2929 2c0a 2020 2020 2020 2020 2e2e   3)),.        ..
-000261a0: 2e20 2020 2020 6469 6d73 3d5b 2278 222c  .     dims=["x",
-000261b0: 2022 7922 5d2c 0a20 2020 2020 2020 202e   "y"],.        .
-000261c0: 2e2e 2020 2020 2063 6f6f 7264 733d 7b22  ..     coords={"
-000261d0: 7822 3a20 7261 6e67 6528 3229 2c20 2279  x": range(2), "y
-000261e0: 223a 2072 616e 6765 2833 292c 2022 6122  ": range(3), "a"
-000261f0: 3a20 2822 7822 2c20 5b33 2c20 345d 297d  : ("x", [3, 4])}
-00026200: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
-00026210: 2020 2020 2020 2020 3e3e 3e20 6473 203d          >>> ds =
-00026220: 2078 722e 4461 7461 7365 7428 7b22 7622   xr.Dataset({"v"
-00026230: 3a20 6172 727d 290a 2020 2020 2020 2020  : arr}).        
-00026240: 3e3e 3e20 6473 0a20 2020 2020 2020 203c  >>> ds.        <
-00026250: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
-00026260: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
-00026270: 6e73 3a20 2028 783a 2032 2c20 793a 2033  ns:  (x: 2, y: 3
-00026280: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
-00026290: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
-000262a0: 202a 2078 2020 2020 2020 2020 2878 2920   * x        (x) 
-000262b0: 696e 7436 3420 3020 310a 2020 2020 2020  int64 0 1.      
-000262c0: 2020 2020 2a20 7920 2020 2020 2020 2028      * y        (
-000262d0: 7929 2069 6e74 3634 2030 2031 2032 0a20  y) int64 0 1 2. 
-000262e0: 2020 2020 2020 2020 2020 2061 2020 2020             a    
-000262f0: 2020 2020 2878 2920 696e 7436 3420 3320      (x) int64 3 
-00026300: 340a 2020 2020 2020 2020 4461 7461 2076  4.        Data v
-00026310: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
-00026320: 2020 2020 2020 7620 2020 2020 2020 2028        v        (
-00026330: 782c 2079 2920 666c 6f61 7436 3420 312e  x, y) float64 1.
-00026340: 3020 312e 3020 312e 3020 312e 3020 312e  0 1.0 1.0 1.0 1.
-00026350: 3020 312e 300a 2020 2020 2020 2020 3e3e  0 1.0.        >>
-00026360: 3e20 6473 2e73 6574 5f69 6e64 6578 2878  > ds.set_index(x
-00026370: 3d22 6122 290a 2020 2020 2020 2020 3c78  ="a").        <x
-00026380: 6172 7261 792e 4461 7461 7365 743e 0a20  array.Dataset>. 
-00026390: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
-000263a0: 733a 2020 2878 3a20 322c 2079 3a20 3329  s:  (x: 2, y: 3)
-000263b0: 0a20 2020 2020 2020 2043 6f6f 7264 696e  .        Coordin
-000263c0: 6174 6573 3a0a 2020 2020 2020 2020 2020  ates:.          
-000263d0: 2a20 7820 2020 2020 2020 2028 7829 2069  * x        (x) i
-000263e0: 6e74 3634 2033 2034 0a20 2020 2020 2020  nt64 3 4.       
-000263f0: 2020 202a 2079 2020 2020 2020 2020 2879     * y        (y
-00026400: 2920 696e 7436 3420 3020 3120 320a 2020  ) int64 0 1 2.  
-00026410: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
-00026420: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
-00026430: 2020 7620 2020 2020 2020 2028 782c 2079    v        (x, y
-00026440: 2920 666c 6f61 7436 3420 312e 3020 312e  ) float64 1.0 1.
-00026450: 3020 312e 3020 312e 3020 312e 3020 312e  0 1.0 1.0 1.0 1.
-00026460: 300a 0a20 2020 2020 2020 2053 6565 2041  0..        See A
-00026470: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-00026480: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
-00026490: 6173 6574 2e72 6573 6574 5f69 6e64 6578  aset.reset_index
-000264a0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
-000264b0: 2e73 6574 5f78 696e 6465 780a 2020 2020  .set_xindex.    
-000264c0: 2020 2020 4461 7461 7365 742e 7377 6170      Dataset.swap
-000264d0: 5f64 696d 730a 2020 2020 2020 2020 2222  _dims.        ""
-000264e0: 220a 2020 2020 2020 2020 6469 6d5f 636f  ".        dim_co
-000264f0: 6f72 6473 203d 2065 6974 6865 725f 6469  ords = either_di
-00026500: 6374 5f6f 725f 6b77 6172 6773 2869 6e64  ct_or_kwargs(ind
-00026510: 6578 6573 2c20 696e 6465 7865 735f 6b77  exes, indexes_kw
-00026520: 6172 6773 2c20 2273 6574 5f69 6e64 6578  args, "set_index
-00026530: 2229 0a0a 2020 2020 2020 2020 6e65 775f  ")..        new_
-00026540: 696e 6465 7865 733a 2064 6963 745b 4861  indexes: dict[Ha
-00026550: 7368 6162 6c65 2c20 496e 6465 785d 203d  shable, Index] =
-00026560: 207b 7d0a 2020 2020 2020 2020 6e65 775f   {}.        new_
-00026570: 7661 7269 6162 6c65 733a 2064 6963 745b  variables: dict[
-00026580: 4861 7368 6162 6c65 2c20 5661 7269 6162  Hashable, Variab
-00026590: 6c65 5d20 3d20 7b7d 0a20 2020 2020 2020  le] = {}.       
-000265a0: 2064 726f 705f 696e 6465 7865 733a 2073   drop_indexes: s
-000265b0: 6574 5b48 6173 6861 626c 655d 203d 2073  et[Hashable] = s
-000265c0: 6574 2829 0a20 2020 2020 2020 2064 726f  et().        dro
-000265d0: 705f 7661 7269 6162 6c65 733a 2073 6574  p_variables: set
-000265e0: 5b48 6173 6861 626c 655d 203d 2073 6574  [Hashable] = set
-000265f0: 2829 0a20 2020 2020 2020 2072 6570 6c61  ().        repla
-00026600: 6365 5f64 696d 733a 2064 6963 745b 4861  ce_dims: dict[Ha
-00026610: 7368 6162 6c65 2c20 4861 7368 6162 6c65  shable, Hashable
-00026620: 5d20 3d20 7b7d 0a20 2020 2020 2020 2061  ] = {}.        a
-00026630: 6c6c 5f76 6172 5f6e 616d 6573 3a20 7365  ll_var_names: se
-00026640: 745b 4861 7368 6162 6c65 5d20 3d20 7365  t[Hashable] = se
-00026650: 7428 290a 0a20 2020 2020 2020 2066 6f72  t()..        for
-00026660: 2064 696d 2c20 5f76 6172 5f6e 616d 6573   dim, _var_names
-00026670: 2069 6e20 6469 6d5f 636f 6f72 6473 2e69   in dim_coords.i
-00026680: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
-00026690: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-000266a0: 6528 5f76 6172 5f6e 616d 6573 2c20 7374  e(_var_names, st
-000266b0: 7229 206f 7220 6e6f 7420 6973 696e 7374  r) or not isinst
-000266c0: 616e 6365 285f 7661 725f 6e61 6d65 732c  ance(_var_names,
-000266d0: 2053 6571 7565 6e63 6529 3a0a 2020 2020   Sequence):.    
-000266e0: 2020 2020 2020 2020 2020 2020 7661 725f              var_
-000266f0: 6e61 6d65 7320 3d20 5b5f 7661 725f 6e61  names = [_var_na
-00026700: 6d65 735d 0a20 2020 2020 2020 2020 2020  mes].           
-00026710: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00026720: 2020 2020 2020 2076 6172 5f6e 616d 6573         var_names
-00026730: 203d 206c 6973 7428 5f76 6172 5f6e 616d   = list(_var_nam
-00026740: 6573 290a 0a20 2020 2020 2020 2020 2020  es)..           
-00026750: 2069 6e76 616c 6964 5f76 6172 7320 3d20   invalid_vars = 
-00026760: 7365 7428 7661 725f 6e61 6d65 7329 202d  set(var_names) -
-00026770: 2073 6574 2873 656c 662e 5f76 6172 6961   set(self._varia
-00026780: 626c 6573 290a 2020 2020 2020 2020 2020  bles).          
-00026790: 2020 6966 2069 6e76 616c 6964 5f76 6172    if invalid_var
-000267a0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-000267b0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000267c0: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
-000267d0: 2020 2020 2020 2020 2022 2c20 222e 6a6f           ", ".jo
-000267e0: 696e 285b 7374 7228 7629 2066 6f72 2076  in([str(v) for v
-000267f0: 2069 6e20 696e 7661 6c69 645f 7661 7273   in invalid_vars
-00026800: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
-00026810: 2020 2020 2020 202b 2022 2076 6172 6961         + " varia
-00026820: 626c 6528 7329 2064 6f20 6e6f 7420 6578  ble(s) do not ex
-00026830: 6973 7422 0a20 2020 2020 2020 2020 2020  ist".           
-00026840: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-00026850: 2020 2020 616c 6c5f 7661 725f 6e61 6d65      all_var_name
-00026860: 732e 7570 6461 7465 2876 6172 5f6e 616d  s.update(var_nam
-00026870: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-00026880: 6472 6f70 5f76 6172 6961 626c 6573 2e75  drop_variables.u
-00026890: 7064 6174 6528 7661 725f 6e61 6d65 7329  pdate(var_names)
-000268a0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-000268b0: 6472 6f70 2061 6e79 2070 7265 2d65 7869  drop any pre-exi
-000268c0: 7374 696e 6720 696e 6465 7820 696e 766f  sting index invo
-000268d0: 6c76 6564 2061 6e64 2069 7473 2063 6f72  lved and its cor
-000268e0: 7265 7370 6f6e 6469 6e67 2063 6f6f 7264  responding coord
-000268f0: 696e 6174 6573 0a20 2020 2020 2020 2020  inates.         
-00026900: 2020 2069 6e64 6578 5f63 6f6f 7264 5f6e     index_coord_n
-00026910: 616d 6573 203d 2073 656c 662e 7869 6e64  ames = self.xind
-00026920: 6578 6573 2e67 6574 5f61 6c6c 5f63 6f6f  exes.get_all_coo
-00026930: 7264 7328 6469 6d2c 2065 7272 6f72 733d  rds(dim, errors=
-00026940: 2269 676e 6f72 6522 290a 2020 2020 2020  "ignore").      
-00026950: 2020 2020 2020 616c 6c5f 696e 6465 785f        all_index_
-00026960: 636f 6f72 645f 6e61 6d65 7320 3d20 7365  coord_names = se
-00026970: 7428 696e 6465 785f 636f 6f72 645f 6e61  t(index_coord_na
-00026980: 6d65 7329 0a20 2020 2020 2020 2020 2020  mes).           
-00026990: 2066 6f72 206b 2069 6e20 7661 725f 6e61   for k in var_na
-000269a0: 6d65 733a 0a20 2020 2020 2020 2020 2020  mes:.           
-000269b0: 2020 2020 2061 6c6c 5f69 6e64 6578 5f63       all_index_c
-000269c0: 6f6f 7264 5f6e 616d 6573 2e75 7064 6174  oord_names.updat
-000269d0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-000269e0: 2020 2020 2020 2073 656c 662e 7869 6e64         self.xind
-000269f0: 6578 6573 2e67 6574 5f61 6c6c 5f63 6f6f  exes.get_all_coo
-00026a00: 7264 7328 6b2c 2065 7272 6f72 733d 2269  rds(k, errors="i
-00026a10: 676e 6f72 6522 290a 2020 2020 2020 2020  gnore").        
-00026a20: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00026a30: 2020 2020 2020 2064 726f 705f 696e 6465         drop_inde
-00026a40: 7865 732e 7570 6461 7465 2861 6c6c 5f69  xes.update(all_i
-00026a50: 6e64 6578 5f63 6f6f 7264 5f6e 616d 6573  ndex_coord_names
-00026a60: 290a 2020 2020 2020 2020 2020 2020 6472  ).            dr
-00026a70: 6f70 5f76 6172 6961 626c 6573 2e75 7064  op_variables.upd
-00026a80: 6174 6528 616c 6c5f 696e 6465 785f 636f  ate(all_index_co
-00026a90: 6f72 645f 6e61 6d65 7329 0a0a 2020 2020  ord_names)..    
-00026aa0: 2020 2020 2020 2020 6966 206c 656e 2876          if len(v
-00026ab0: 6172 5f6e 616d 6573 2920 3d3d 2031 2061  ar_names) == 1 a
-00026ac0: 6e64 2028 6e6f 7420 6170 7065 6e64 206f  nd (not append o
-00026ad0: 7220 6469 6d20 6e6f 7420 696e 2073 656c  r dim not in sel
-00026ae0: 662e 5f69 6e64 6578 6573 293a 0a20 2020  f._indexes):.   
-00026af0: 2020 2020 2020 2020 2020 2020 2076 6172               var
-00026b00: 5f6e 616d 6520 3d20 7661 725f 6e61 6d65  _name = var_name
-00026b10: 735b 305d 0a20 2020 2020 2020 2020 2020  s[0].           
-00026b20: 2020 2020 2076 6172 203d 2073 656c 662e       var = self.
-00026b30: 5f76 6172 6961 626c 6573 5b76 6172 5f6e  _variables[var_n
-00026b40: 616d 655d 0a20 2020 2020 2020 2020 2020  ame].           
-00026b50: 2020 2020 2069 6620 7661 722e 6469 6d73       if var.dims
-00026b60: 2021 3d20 2864 696d 2c29 3a0a 2020 2020   != (dim,):.    
-00026b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026b80: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00026b90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00026ba0: 2020 2020 2020 2020 2020 6622 6469 6d65            f"dime
-00026bb0: 6e73 696f 6e20 6d69 736d 6174 6368 3a20  nsion mismatch: 
-00026bc0: 7472 7920 7365 7474 696e 6720 616e 2069  try setting an i
-00026bd0: 6e64 6578 2066 6f72 2064 696d 656e 7369  ndex for dimensi
-00026be0: 6f6e 207b 6469 6d21 727d 2077 6974 6820  on {dim!r} with 
-00026bf0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00026c00: 2020 2020 2020 2020 2020 6622 7661 7269            f"vari
-00026c10: 6162 6c65 207b 7661 725f 6e61 6d65 2172  able {var_name!r
-00026c20: 7d20 7468 6174 2068 6173 2064 696d 656e  } that has dimen
-00026c30: 7369 6f6e 7320 7b76 6172 2e64 696d 737d  sions {var.dims}
-00026c40: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00026c50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026c60: 2020 2020 2020 2020 6964 7820 3d20 5061          idx = Pa
-00026c70: 6e64 6173 496e 6465 782e 6672 6f6d 5f76  ndasIndex.from_v
-00026c80: 6172 6961 626c 6573 287b 6469 6d3a 2076  ariables({dim: v
-00026c90: 6172 7d2c 206f 7074 696f 6e73 3d7b 7d29  ar}, options={})
-00026ca0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026cb0: 2069 6478 5f76 6172 7320 3d20 6964 782e   idx_vars = idx.
-00026cc0: 6372 6561 7465 5f76 6172 6961 626c 6573  create_variables
-00026cd0: 287b 7661 725f 6e61 6d65 3a20 7661 727d  ({var_name: var}
-00026ce0: 290a 0a20 2020 2020 2020 2020 2020 2020  )..             
-00026cf0: 2020 2023 2074 7269 636b 2074 6f20 7072     # trick to pr
-00026d00: 6573 6572 7665 2063 6f6f 7264 696e 6174  eserve coordinat
-00026d10: 6520 6f72 6465 7220 696e 2074 6869 7320  e order in this 
-00026d20: 6361 7365 0a20 2020 2020 2020 2020 2020  case.           
-00026d30: 2020 2020 2069 6620 6469 6d20 696e 2073       if dim in s
-00026d40: 656c 662e 5f63 6f6f 7264 5f6e 616d 6573  elf._coord_names
-00026d50: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00026d60: 2020 2020 2020 6472 6f70 5f76 6172 6961        drop_varia
-00026d70: 626c 6573 2e72 656d 6f76 6528 6469 6d29  bles.remove(dim)
-00026d80: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00026d90: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
-00026da0: 2020 2069 6620 6170 7065 6e64 3a0a 2020     if append:.  
-00026db0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026dc0: 2020 6375 7272 656e 745f 7661 7269 6162    current_variab
-00026dd0: 6c65 7320 3d20 7b0a 2020 2020 2020 2020  les = {.        
-00026de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026df0: 6b3a 2073 656c 662e 5f76 6172 6961 626c  k: self._variabl
-00026e00: 6573 5b6b 5d20 666f 7220 6b20 696e 2069  es[k] for k in i
-00026e10: 6e64 6578 5f63 6f6f 7264 5f6e 616d 6573  ndex_coord_names
-00026e20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00026e30: 2020 2020 207d 0a20 2020 2020 2020 2020       }.         
-00026e40: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00026e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026e60: 2063 7572 7265 6e74 5f76 6172 6961 626c   current_variabl
-00026e70: 6573 203d 207b 7d0a 2020 2020 2020 2020  es = {}.        
-00026e80: 2020 2020 2020 2020 6964 782c 2069 6478          idx, idx
-00026e90: 5f76 6172 7320 3d20 5061 6e64 6173 4d75  _vars = PandasMu
-00026ea0: 6c74 6949 6e64 6578 2e66 726f 6d5f 7661  ltiIndex.from_va
-00026eb0: 7269 6162 6c65 735f 6d61 7962 655f 6578  riables_maybe_ex
-00026ec0: 7061 6e64 280a 2020 2020 2020 2020 2020  pand(.          
-00026ed0: 2020 2020 2020 2020 2020 6469 6d2c 0a20            dim,. 
-00026ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00026ef0: 2020 2063 7572 7265 6e74 5f76 6172 6961     current_varia
-00026f00: 626c 6573 2c0a 2020 2020 2020 2020 2020  bles,.          
-00026f10: 2020 2020 2020 2020 2020 7b6b 3a20 7365            {k: se
-00026f20: 6c66 2e5f 7661 7269 6162 6c65 735b 6b5d  lf._variables[k]
-00026f30: 2066 6f72 206b 2069 6e20 7661 725f 6e61   for k in var_na
-00026f40: 6d65 737d 2c0a 2020 2020 2020 2020 2020  mes},.          
-00026f50: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00026f60: 2020 2020 2020 2020 666f 7220 6e20 696e          for n in
-00026f70: 2069 6478 2e69 6e64 6578 2e6e 616d 6573   idx.index.names
-00026f80: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00026f90: 2020 2020 2020 7265 706c 6163 655f 6469        replace_di
-00026fa0: 6d73 5b6e 5d20 3d20 6469 6d0a 0a20 2020  ms[n] = dim..   
-00026fb0: 2020 2020 2020 2020 206e 6577 5f69 6e64           new_ind
-00026fc0: 6578 6573 2e75 7064 6174 6528 7b6b 3a20  exes.update({k: 
-00026fd0: 6964 7820 666f 7220 6b20 696e 2069 6478  idx for k in idx
-00026fe0: 5f76 6172 737d 290a 2020 2020 2020 2020  _vars}).        
-00026ff0: 2020 2020 6e65 775f 7661 7269 6162 6c65      new_variable
-00027000: 732e 7570 6461 7465 2869 6478 5f76 6172  s.update(idx_var
-00027010: 7329 0a0a 2020 2020 2020 2020 2320 7265  s)..        # re
-00027020: 2d61 6464 2064 6569 6e64 6578 6564 2063  -add deindexed c
-00027030: 6f6f 7264 696e 6174 6573 2028 636f 6e76  oordinates (conv
-00027040: 6572 7420 746f 2062 6173 6520 7661 7269  ert to base vari
-00027050: 6162 6c65 7329 0a20 2020 2020 2020 2066  ables).        f
-00027060: 6f72 206b 2069 6e20 6472 6f70 5f76 6172  or k in drop_var
-00027070: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
-00027080: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
-00027090: 2020 2020 2020 2020 206b 206e 6f74 2069           k not i
-000270a0: 6e20 6e65 775f 7661 7269 6162 6c65 730a  n new_variables.
-000270b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000270c0: 616e 6420 6b20 6e6f 7420 696e 2061 6c6c  and k not in all
-000270d0: 5f76 6172 5f6e 616d 6573 0a20 2020 2020  _var_names.     
-000270e0: 2020 2020 2020 2020 2020 2061 6e64 206b             and k
-000270f0: 2069 6e20 7365 6c66 2e5f 636f 6f72 645f   in self._coord_
-00027100: 6e61 6d65 730a 2020 2020 2020 2020 2020  names.          
-00027110: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-00027120: 2020 2020 206e 6577 5f76 6172 6961 626c       new_variabl
-00027130: 6573 5b6b 5d20 3d20 7365 6c66 2e5f 7661  es[k] = self._va
-00027140: 7269 6162 6c65 735b 6b5d 2e74 6f5f 6261  riables[k].to_ba
-00027150: 7365 5f76 6172 6961 626c 6528 290a 0a20  se_variable().. 
-00027160: 2020 2020 2020 2069 6e64 6578 6573 5f3a         indexes_:
-00027170: 2064 6963 745b 416e 792c 2049 6e64 6578   dict[Any, Index
-00027180: 5d20 3d20 7b0a 2020 2020 2020 2020 2020  ] = {.          
-00027190: 2020 6b3a 2076 2066 6f72 206b 2c20 7620    k: v for k, v 
-000271a0: 696e 2073 656c 662e 5f69 6e64 6578 6573  in self._indexes
-000271b0: 2e69 7465 6d73 2829 2069 6620 6b20 6e6f  .items() if k no
-000271c0: 7420 696e 2064 726f 705f 696e 6465 7865  t in drop_indexe
-000271d0: 730a 2020 2020 2020 2020 7d0a 2020 2020  s.        }.    
-000271e0: 2020 2020 696e 6465 7865 735f 2e75 7064      indexes_.upd
-000271f0: 6174 6528 6e65 775f 696e 6465 7865 7329  ate(new_indexes)
-00027200: 0a0a 2020 2020 2020 2020 7661 7269 6162  ..        variab
-00027210: 6c65 7320 3d20 7b0a 2020 2020 2020 2020  les = {.        
-00027220: 2020 2020 6b3a 2076 2066 6f72 206b 2c20      k: v for k, 
-00027230: 7620 696e 2073 656c 662e 5f76 6172 6961  v in self._varia
-00027240: 626c 6573 2e69 7465 6d73 2829 2069 6620  bles.items() if 
-00027250: 6b20 6e6f 7420 696e 2064 726f 705f 7661  k not in drop_va
-00027260: 7269 6162 6c65 730a 2020 2020 2020 2020  riables.        
-00027270: 7d0a 2020 2020 2020 2020 7661 7269 6162  }.        variab
-00027280: 6c65 732e 7570 6461 7465 286e 6577 5f76  les.update(new_v
-00027290: 6172 6961 626c 6573 290a 0a20 2020 2020  ariables)..     
-000272a0: 2020 2023 2075 7064 6174 6520 6469 6d65     # update dime
-000272b0: 6e73 696f 6e73 2069 6620 6e65 6365 7373  nsions if necess
-000272c0: 6172 792c 2047 483a 2033 3531 320a 2020  ary, GH: 3512.  
-000272d0: 2020 2020 2020 666f 7220 6b2c 2076 2069        for k, v i
-000272e0: 6e20 7661 7269 6162 6c65 732e 6974 656d  n variables.item
-000272f0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-00027300: 2069 6620 616e 7928 6420 696e 2072 6570   if any(d in rep
-00027310: 6c61 6365 5f64 696d 7320 666f 7220 6420  lace_dims for d 
-00027320: 696e 2076 2e64 696d 7329 3a0a 2020 2020  in v.dims):.    
-00027330: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-00027340: 6469 6d73 203d 205b 7265 706c 6163 655f  dims = [replace_
-00027350: 6469 6d73 2e67 6574 2864 2c20 6429 2066  dims.get(d, d) f
-00027360: 6f72 2064 2069 6e20 762e 6469 6d73 5d0a  or d in v.dims].
-00027370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027380: 7661 7269 6162 6c65 735b 6b5d 203d 2076  variables[k] = v
-00027390: 2e5f 7265 706c 6163 6528 6469 6d73 3d6e  ._replace(dims=n
-000273a0: 6577 5f64 696d 7329 0a0a 2020 2020 2020  ew_dims)..      
-000273b0: 2020 636f 6f72 645f 6e61 6d65 7320 3d20    coord_names = 
-000273c0: 7365 6c66 2e5f 636f 6f72 645f 6e61 6d65  self._coord_name
-000273d0: 7320 2d20 6472 6f70 5f76 6172 6961 626c  s - drop_variabl
-000273e0: 6573 207c 2073 6574 286e 6577 5f76 6172  es | set(new_var
-000273f0: 6961 626c 6573 290a 0a20 2020 2020 2020  iables)..       
-00027400: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
-00027410: 706c 6163 655f 7769 7468 5f6e 6577 5f64  place_with_new_d
-00027420: 696d 7328 0a20 2020 2020 2020 2020 2020  ims(.           
-00027430: 2076 6172 6961 626c 6573 2c20 636f 6f72   variables, coor
-00027440: 645f 6e61 6d65 733d 636f 6f72 645f 6e61  d_names=coord_na
-00027450: 6d65 732c 2069 6e64 6578 6573 3d69 6e64  mes, indexes=ind
-00027460: 6578 6573 5f0a 2020 2020 2020 2020 290a  exes_.        ).
-00027470: 0a20 2020 2064 6566 2072 6573 6574 5f69  .    def reset_i
-00027480: 6e64 6578 280a 2020 2020 2020 2020 7365  ndex(.        se
-00027490: 6c66 3a20 545f 4461 7461 7365 742c 0a20  lf: T_Dataset,. 
-000274a0: 2020 2020 2020 2064 696d 735f 6f72 5f6c         dims_or_l
-000274b0: 6576 656c 733a 2048 6173 6861 626c 6520  evels: Hashable 
-000274c0: 7c20 5365 7175 656e 6365 5b48 6173 6861  | Sequence[Hasha
-000274d0: 626c 655d 2c0a 2020 2020 2020 2020 6472  ble],.        dr
-000274e0: 6f70 3a20 626f 6f6c 203d 2046 616c 7365  op: bool = False
-000274f0: 2c0a 2020 2020 2920 2d3e 2054 5f44 6174  ,.    ) -> T_Dat
-00027500: 6173 6574 3a0a 2020 2020 2020 2020 2222  aset:.        ""
-00027510: 2252 6573 6574 2074 6865 2073 7065 6369  "Reset the speci
-00027520: 6669 6564 2069 6e64 6578 2865 7329 206f  fied index(es) o
-00027530: 7220 6d75 6c74 692d 696e 6465 7820 6c65  r multi-index le
-00027540: 7665 6c28 7329 2e0a 0a20 2020 2020 2020  vel(s)...       
-00027550: 2054 6869 7320 6c65 6761 6379 206d 6574   This legacy met
-00027560: 686f 6420 6973 2073 7065 6369 6669 6320  hod is specific 
-00027570: 746f 2070 616e 6461 7320 286d 756c 7469  to pandas (multi
-00027580: 2d29 696e 6465 7865 7320 616e 640a 2020  -)indexes and.  
-00027590: 2020 2020 2020 312d 6469 6d65 6e73 696f        1-dimensio
-000275a0: 6e61 6c20 2264 696d 656e 7369 6f6e 2220  nal "dimension" 
-000275b0: 636f 6f72 6469 6e61 7465 732e 2053 6565  coordinates. See
-000275c0: 2074 6865 206d 6f72 6520 6765 6e65 7269   the more generi
-000275d0: 630a 2020 2020 2020 2020 3a70 793a 6d65  c.        :py:me
-000275e0: 7468 3a60 7e44 6174 6173 6574 2e64 726f  th:`~Dataset.dro
-000275f0: 705f 696e 6465 7865 7360 2061 6e64 203a  p_indexes` and :
-00027600: 7079 3a6d 6574 683a 607e 4461 7461 7365  py:meth:`~Datase
-00027610: 742e 7365 745f 7869 6e64 6578 600a 2020  t.set_xindex`.  
-00027620: 2020 2020 2020 6d65 7468 6f64 2074 6f20        method to 
-00027630: 7265 7370 6563 7469 7665 6c79 2064 726f  respectively dro
-00027640: 7020 616e 6420 7365 7420 7061 6e64 6173  p and set pandas
-00027650: 206f 7220 6375 7374 6f6d 2069 6e64 6578   or custom index
-00027660: 6573 2066 6f72 0a20 2020 2020 2020 2061  es for.        a
-00027670: 7262 6974 7261 7279 2063 6f6f 7264 696e  rbitrary coordin
-00027680: 6174 6573 2e0a 0a20 2020 2020 2020 2050  ates...        P
-00027690: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-000276a0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-000276b0: 2020 2020 2064 696d 735f 6f72 5f6c 6576       dims_or_lev
-000276c0: 656c 7320 3a20 4861 7368 6162 6c65 206f  els : Hashable o
-000276d0: 7220 5365 7175 656e 6365 206f 6620 4861  r Sequence of Ha
-000276e0: 7368 6162 6c65 0a20 2020 2020 2020 2020  shable.         
-000276f0: 2020 204e 616d 6528 7329 206f 6620 7468     Name(s) of th
-00027700: 6520 6469 6d65 6e73 696f 6e28 7329 2061  e dimension(s) a
-00027710: 6e64 2f6f 7220 6d75 6c74 692d 696e 6465  nd/or multi-inde
-00027720: 7820 6c65 7665 6c28 7329 2074 6861 7420  x level(s) that 
-00027730: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
-00027740: 2062 6520 7265 7365 742e 0a20 2020 2020   be reset..     
-00027750: 2020 2064 726f 7020 3a20 626f 6f6c 2c20     drop : bool, 
-00027760: 6465 6661 756c 743a 2046 616c 7365 0a20  default: False. 
-00027770: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
-00027780: 7565 2c20 7265 6d6f 7665 2074 6865 2073  ue, remove the s
-00027790: 7065 6369 6669 6564 2069 6e64 6578 6573  pecified indexes
-000277a0: 2061 6e64 2f6f 7220 6d75 6c74 692d 696e   and/or multi-in
-000277b0: 6465 7820 6c65 7665 6c73 0a20 2020 2020  dex levels.     
-000277c0: 2020 2020 2020 2069 6e73 7465 6164 206f         instead o
-000277d0: 6620 6578 7472 6163 7469 6e67 2074 6865  f extracting the
-000277e0: 6d20 6173 206e 6577 2063 6f6f 7264 696e  m as new coordin
-000277f0: 6174 6573 2028 6465 6661 756c 743a 2046  ates (default: F
-00027800: 616c 7365 292e 0a0a 2020 2020 2020 2020  alse)...        
-00027810: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00027820: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-00027830: 6f62 6a20 3a20 4461 7461 7365 740a 2020  obj : Dataset.  
-00027840: 2020 2020 2020 2020 2020 416e 6f74 6865            Anothe
-00027850: 7220 6461 7461 7365 742c 2077 6974 6820  r dataset, with 
-00027860: 7468 6973 2064 6174 6173 6574 2773 2064  this dataset's d
-00027870: 6174 6120 6275 7420 7265 706c 6163 6564  ata but replaced
-00027880: 2063 6f6f 7264 696e 6174 6573 2e0a 0a20   coordinates... 
-00027890: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-000278a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000278b0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
-000278c0: 2e73 6574 5f69 6e64 6578 0a20 2020 2020  .set_index.     
-000278d0: 2020 2044 6174 6173 6574 2e73 6574 5f78     Dataset.set_x
-000278e0: 696e 6465 780a 2020 2020 2020 2020 4461  index.        Da
-000278f0: 7461 7365 742e 6472 6f70 5f69 6e64 6578  taset.drop_index
-00027900: 6573 0a20 2020 2020 2020 2022 2222 0a20  es.        """. 
-00027910: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00027920: 616e 6365 2864 696d 735f 6f72 5f6c 6576  ance(dims_or_lev
-00027930: 656c 732c 2073 7472 2920 6f72 206e 6f74  els, str) or not
-00027940: 2069 7369 6e73 7461 6e63 6528 6469 6d73   isinstance(dims
-00027950: 5f6f 725f 6c65 7665 6c73 2c20 5365 7175  _or_levels, Sequ
-00027960: 656e 6365 293a 0a20 2020 2020 2020 2020  ence):.         
-00027970: 2020 2064 696d 735f 6f72 5f6c 6576 656c     dims_or_level
-00027980: 7320 3d20 5b64 696d 735f 6f72 5f6c 6576  s = [dims_or_lev
-00027990: 656c 735d 0a0a 2020 2020 2020 2020 696e  els]..        in
-000279a0: 7661 6c69 645f 636f 6f72 6473 203d 2073  valid_coords = s
-000279b0: 6574 2864 696d 735f 6f72 5f6c 6576 656c  et(dims_or_level
-000279c0: 7329 202d 2073 6574 2873 656c 662e 5f69  s) - set(self._i
-000279d0: 6e64 6578 6573 290a 2020 2020 2020 2020  ndexes).        
-000279e0: 6966 2069 6e76 616c 6964 5f63 6f6f 7264  if invalid_coord
-000279f0: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-00027a00: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00027a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00027a20: 2066 227b 7475 706c 6528 696e 7661 6c69   f"{tuple(invali
-00027a30: 645f 636f 6f72 6473 297d 2061 7265 206e  d_coords)} are n
-00027a40: 6f74 2063 6f6f 7264 696e 6174 6573 2077  ot coordinates w
-00027a50: 6974 6820 616e 2069 6e64 6578 220a 2020  ith an index".  
-00027a60: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00027a70: 2020 2020 2064 726f 705f 696e 6465 7865       drop_indexe
-00027a80: 733a 2073 6574 5b48 6173 6861 626c 655d  s: set[Hashable]
-00027a90: 203d 2073 6574 2829 0a20 2020 2020 2020   = set().       
-00027aa0: 2064 726f 705f 7661 7269 6162 6c65 733a   drop_variables:
-00027ab0: 2073 6574 5b48 6173 6861 626c 655d 203d   set[Hashable] =
-00027ac0: 2073 6574 2829 0a20 2020 2020 2020 2073   set().        s
-00027ad0: 6565 6e3a 2073 6574 5b49 6e64 6578 5d20  een: set[Index] 
-00027ae0: 3d20 7365 7428 290a 2020 2020 2020 2020  = set().        
-00027af0: 6e65 775f 696e 6465 7865 733a 2064 6963  new_indexes: dic
-00027b00: 745b 4861 7368 6162 6c65 2c20 496e 6465  t[Hashable, Inde
-00027b10: 785d 203d 207b 7d0a 2020 2020 2020 2020  x] = {}.        
-00027b20: 6e65 775f 7661 7269 6162 6c65 733a 2064  new_variables: d
-00027b30: 6963 745b 4861 7368 6162 6c65 2c20 5661  ict[Hashable, Va
-00027b40: 7269 6162 6c65 5d20 3d20 7b7d 0a0a 2020  riable] = {}..  
-00027b50: 2020 2020 2020 6465 6620 6472 6f70 5f6f        def drop_o
-00027b60: 725f 636f 6e76 6572 7428 7661 725f 6e61  r_convert(var_na
-00027b70: 6d65 7329 3a0a 2020 2020 2020 2020 2020  mes):.          
-00027b80: 2020 6966 2064 726f 703a 0a20 2020 2020    if drop:.     
-00027b90: 2020 2020 2020 2020 2020 2064 726f 705f             drop_
-00027ba0: 7661 7269 6162 6c65 732e 7570 6461 7465  variables.update
-00027bb0: 2876 6172 5f6e 616d 6573 290a 2020 2020  (var_names).    
-00027bc0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00027bd0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-00027be0: 7365 5f76 6172 7320 3d20 7b0a 2020 2020  se_vars = {.    
-00027bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027c00: 6b3a 2073 656c 662e 5f76 6172 6961 626c  k: self._variabl
-00027c10: 6573 5b6b 5d2e 746f 5f62 6173 655f 7661  es[k].to_base_va
-00027c20: 7269 6162 6c65 2829 2066 6f72 206b 2069  riable() for k i
-00027c30: 6e20 7661 725f 6e61 6d65 730a 2020 2020  n var_names.    
-00027c40: 2020 2020 2020 2020 2020 2020 7d0a 2020              }.  
-00027c50: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-00027c60: 775f 7661 7269 6162 6c65 732e 7570 6461  w_variables.upda
-00027c70: 7465 2862 6173 655f 7661 7273 290a 0a20  te(base_vars).. 
-00027c80: 2020 2020 2020 2066 6f72 206e 616d 6520         for name 
-00027c90: 696e 2064 696d 735f 6f72 5f6c 6576 656c  in dims_or_level
-00027ca0: 733a 0a20 2020 2020 2020 2020 2020 2069  s:.            i
-00027cb0: 6e64 6578 203d 2073 656c 662e 5f69 6e64  ndex = self._ind
-00027cc0: 6578 6573 5b6e 616d 655d 0a0a 2020 2020  exes[name]..    
-00027cd0: 2020 2020 2020 2020 6966 2069 6e64 6578          if index
-00027ce0: 2069 6e20 7365 656e 3a0a 2020 2020 2020   in seen:.      
-00027cf0: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
-00027d00: 7565 0a20 2020 2020 2020 2020 2020 2073  ue.            s
-00027d10: 6565 6e2e 6164 6428 696e 6465 7829 0a0a  een.add(index)..
-00027d20: 2020 2020 2020 2020 2020 2020 6964 785f              idx_
-00027d30: 7661 725f 6e61 6d65 7320 3d20 7365 7428  var_names = set(
-00027d40: 7365 6c66 2e78 696e 6465 7865 732e 6765  self.xindexes.ge
-00027d50: 745f 616c 6c5f 636f 6f72 6473 286e 616d  t_all_coords(nam
-00027d60: 6529 290a 2020 2020 2020 2020 2020 2020  e)).            
-00027d70: 6472 6f70 5f69 6e64 6578 6573 2e75 7064  drop_indexes.upd
-00027d80: 6174 6528 6964 785f 7661 725f 6e61 6d65  ate(idx_var_name
-00027d90: 7329 0a0a 2020 2020 2020 2020 2020 2020  s)..            
-00027da0: 6966 2069 7369 6e73 7461 6e63 6528 696e  if isinstance(in
-00027db0: 6465 782c 2050 616e 6461 734d 756c 7469  dex, PandasMulti
-00027dc0: 496e 6465 7829 3a0a 2020 2020 2020 2020  Index):.        
-00027dd0: 2020 2020 2020 2020 2320 7370 6563 6961          # specia
-00027de0: 6c20 6361 7365 2066 6f72 2070 642e 4d75  l case for pd.Mu
-00027df0: 6c74 6949 6e64 6578 0a20 2020 2020 2020  ltiIndex.       
-00027e00: 2020 2020 2020 2020 206c 6576 656c 5f6e           level_n
-00027e10: 616d 6573 203d 2069 6e64 6578 2e69 6e64  ames = index.ind
-00027e20: 6578 2e6e 616d 6573 0a20 2020 2020 2020  ex.names.       
-00027e30: 2020 2020 2020 2020 206b 6565 705f 6c65           keep_le
-00027e40: 7665 6c5f 7661 7273 203d 207b 0a20 2020  vel_vars = {.   
-00027e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027e60: 206b 3a20 7365 6c66 2e5f 7661 7269 6162   k: self._variab
-00027e70: 6c65 735b 6b5d 0a20 2020 2020 2020 2020  les[k].         
-00027e80: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
-00027e90: 2069 6e20 6c65 7665 6c5f 6e61 6d65 730a   in level_names.
-00027ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027eb0: 2020 2020 6966 206b 206e 6f74 2069 6e20      if k not in 
-00027ec0: 6469 6d73 5f6f 725f 6c65 7665 6c73 0a20  dims_or_levels. 
-00027ed0: 2020 2020 2020 2020 2020 2020 2020 207d                 }
-00027ee0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00027ef0: 2020 6966 2069 6e64 6578 2e64 696d 206e    if index.dim n
-00027f00: 6f74 2069 6e20 6469 6d73 5f6f 725f 6c65  ot in dims_or_le
-00027f10: 7665 6c73 2061 6e64 206b 6565 705f 6c65  vels and keep_le
-00027f20: 7665 6c5f 7661 7273 3a0a 2020 2020 2020  vel_vars:.      
-00027f30: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-00027f40: 646f 206e 6f74 2064 726f 7020 7468 6520  do not drop the 
-00027f50: 6d75 6c74 692d 696e 6465 7820 636f 6d70  multi-index comp
-00027f60: 6c65 7465 6c79 0a20 2020 2020 2020 2020  letely.         
-00027f70: 2020 2020 2020 2020 2020 2023 2069 6e73             # ins
-00027f80: 7465 6164 2072 6570 6c61 6365 2069 7420  tead replace it 
-00027f90: 6279 2061 206e 6577 2028 6d75 6c74 692d  by a new (multi-
-00027fa0: 2969 6e64 6578 2077 6974 6820 6472 6f70  )index with drop
-00027fb0: 7065 6420 6c65 7665 6c28 7329 0a20 2020  ped level(s).   
-00027fc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00027fd0: 2069 6478 203d 2069 6e64 6578 2e6b 6565   idx = index.kee
-00027fe0: 705f 6c65 7665 6c73 286b 6565 705f 6c65  p_levels(keep_le
-00027ff0: 7665 6c5f 7661 7273 290a 2020 2020 2020  vel_vars).      
-00028000: 2020 2020 2020 2020 2020 2020 2020 6964                id
-00028010: 785f 7661 7273 203d 2069 6478 2e63 7265  x_vars = idx.cre
-00028020: 6174 655f 7661 7269 6162 6c65 7328 6b65  ate_variables(ke
-00028030: 6570 5f6c 6576 656c 5f76 6172 7329 0a20  ep_level_vars). 
-00028040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028050: 2020 206e 6577 5f69 6e64 6578 6573 2e75     new_indexes.u
-00028060: 7064 6174 6528 7b6b 3a20 6964 7820 666f  pdate({k: idx fo
-00028070: 7220 6b20 696e 2069 6478 5f76 6172 737d  r k in idx_vars}
-00028080: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00028090: 2020 2020 2020 6e65 775f 7661 7269 6162        new_variab
-000280a0: 6c65 732e 7570 6461 7465 2869 6478 5f76  les.update(idx_v
-000280b0: 6172 7329 0a20 2020 2020 2020 2020 2020  ars).           
-000280c0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-000280d0: 6973 696e 7374 616e 6365 2869 6478 2c20  isinstance(idx, 
-000280e0: 5061 6e64 6173 4d75 6c74 6949 6e64 6578  PandasMultiIndex
-000280f0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00028100: 2020 2020 2020 2020 2020 2023 206d 756c             # mul
-00028110: 7469 2d69 6e64 6578 2072 6564 7563 6564  ti-index reduced
-00028120: 2074 6f20 7369 6e67 6c65 2069 6e64 6578   to single index
-00028130: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028140: 2020 2020 2020 2020 2023 2062 6163 6b77           # backw
-00028150: 6172 6420 636f 6d70 6174 6962 696c 6974  ard compatibilit
-00028160: 793a 2075 6e69 7175 6520 6c65 7665 6c20  y: unique level 
-00028170: 636f 6f72 6469 6e61 7465 2072 656e 616d  coordinate renam
-00028180: 6564 2074 6f20 6469 6d65 6e73 696f 6e0a  ed to dimension.
+00025780: 2020 2020 2020 2020 2020 2020 6622 4178              f"Ax
+00025790: 6973 207b 617d 206f 6620 7661 7269 6162  is {a} of variab
+000257a0: 6c65 207b 6b7d 2069 7320 6f75 7420 6f66  le {k} is out of
+000257b0: 2062 6f75 6e64 7320 6f66 2074 6865 2022   bounds of the "
+000257c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000257d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000257e0: 2066 2265 7870 616e 6465 6420 6469 6d65   f"expanded dime
+000257f0: 6e73 696f 6e20 7369 7a65 207b 7265 7375  nsion size {resu
+00025800: 6c74 5f6e 6469 6d7d 220a 2020 2020 2020  lt_ndim}".      
+00025810: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025820: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00025830: 2020 2020 2020 2020 2020 2020 2061 7869               axi
+00025840: 735f 706f 7320 3d20 5b61 2069 6620 6120  s_pos = [a if a 
+00025850: 3e3d 2030 2065 6c73 6520 7265 7375 6c74  >= 0 else result
+00025860: 5f6e 6469 6d20 2b20 6120 666f 7220 6120  _ndim + a for a 
+00025870: 696e 2061 7869 735d 0a20 2020 2020 2020  in axis].       
+00025880: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00025890: 6c65 6e28 6178 6973 5f70 6f73 2920 213d  len(axis_pos) !=
+000258a0: 206c 656e 2873 6574 2861 7869 735f 706f   len(set(axis_po
+000258b0: 7329 293a 0a20 2020 2020 2020 2020 2020  s)):.           
+000258c0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000258d0: 7365 2056 616c 7565 4572 726f 7228 2261  se ValueError("a
+000258e0: 7869 7320 7368 6f75 6c64 206e 6f74 2063  xis should not c
+000258f0: 6f6e 7461 696e 2064 7570 6c69 6361 7465  ontain duplicate
+00025900: 2076 616c 7565 7322 290a 2020 2020 2020   values").      
+00025910: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00025920: 5765 206e 6565 6420 746f 2073 6f72 7420  We need to sort 
+00025930: 7468 656d 2074 6f20 6d61 6b65 2073 7572  them to make sur
+00025940: 6520 6061 7869 7360 2065 7175 616c 7320  e `axis` equals 
+00025950: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
+00025960: 2020 2020 2020 2020 2020 2023 2061 7869             # axi
+00025970: 7320 706f 7369 7469 6f6e 7320 6f66 2074  s positions of t
+00025980: 6865 2072 6573 756c 7420 6172 7261 792e  he result array.
+00025990: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000259a0: 2020 2020 207a 6970 5f61 7869 735f 6469       zip_axis_di
+000259b0: 6d20 3d20 736f 7274 6564 287a 6970 2861  m = sorted(zip(a
+000259c0: 7869 735f 706f 732c 2064 696d 2e69 7465  xis_pos, dim.ite
+000259d0: 6d73 2829 2929 0a0a 2020 2020 2020 2020  ms()))..        
+000259e0: 2020 2020 2020 2020 2020 2020 616c 6c5f              all_
+000259f0: 6469 6d73 203d 206c 6973 7428 7a69 7028  dims = list(zip(
+00025a00: 762e 6469 6d73 2c20 762e 7368 6170 6529  v.dims, v.shape)
+00025a10: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00025a20: 2020 2020 2020 666f 7220 642c 2063 2069        for d, c i
+00025a30: 6e20 7a69 705f 6178 6973 5f64 696d 3a0a  n zip_axis_dim:.
+00025a40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025a50: 2020 2020 2020 2020 616c 6c5f 6469 6d73          all_dims
+00025a60: 2e69 6e73 6572 7428 642c 2063 290a 2020  .insert(d, c).  
+00025a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025a80: 2020 7661 7269 6162 6c65 735b 6b5d 203d    variables[k] =
+00025a90: 2076 2e73 6574 5f64 696d 7328 6469 6374   v.set_dims(dict
+00025aa0: 2861 6c6c 5f64 696d 7329 290a 2020 2020  (all_dims)).    
+00025ab0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00025ac0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00025ad0: 206b 206e 6f74 2069 6e20 7661 7269 6162   k not in variab
+00025ae0: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
+00025af0: 2020 2020 2020 2020 2023 2049 6620 6469           # If di
+00025b00: 6d73 2069 6e63 6c75 6465 7320 6120 6c61  ms includes a la
+00025b10: 6265 6c20 6f66 2061 206e 6f6e 2d64 696d  bel of a non-dim
+00025b20: 656e 7369 6f6e 2063 6f6f 7264 696e 6174  ension coordinat
+00025b30: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+00025b40: 2020 2020 2020 2023 2069 7420 7769 6c6c         # it will
+00025b50: 2062 6520 7072 6f6d 6f74 6564 2074 6f20   be promoted to 
+00025b60: 6120 3144 2063 6f6f 7264 696e 6174 6520  a 1D coordinate 
+00025b70: 7769 7468 2061 2073 696e 676c 6520 7661  with a single va
+00025b80: 6c75 652e 0a20 2020 2020 2020 2020 2020  lue..           
+00025b90: 2020 2020 2020 2020 2069 6e64 6578 2c20           index, 
+00025ba0: 696e 6465 785f 7661 7273 203d 2063 7265  index_vars = cre
+00025bb0: 6174 655f 6465 6661 756c 745f 696e 6465  ate_default_inde
+00025bc0: 785f 696d 706c 6963 6974 2876 2e73 6574  x_implicit(v.set
+00025bd0: 5f64 696d 7328 6b29 290a 2020 2020 2020  _dims(k)).      
+00025be0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00025bf0: 6465 7865 735b 6b5d 203d 2069 6e64 6578  dexes[k] = index
+00025c00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025c10: 2020 2020 2076 6172 6961 626c 6573 2e75       variables.u
+00025c20: 7064 6174 6528 696e 6465 785f 7661 7273  pdate(index_vars
+00025c30: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00025c40: 6e20 7365 6c66 2e5f 7265 706c 6163 655f  n self._replace_
+00025c50: 7769 7468 5f6e 6577 5f64 696d 7328 0a20  with_new_dims(. 
+00025c60: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00025c70: 626c 6573 2c20 636f 6f72 645f 6e61 6d65  bles, coord_name
+00025c80: 733d 636f 6f72 645f 6e61 6d65 732c 2069  s=coord_names, i
+00025c90: 6e64 6578 6573 3d69 6e64 6578 6573 0a20  ndexes=indexes. 
+00025ca0: 2020 2020 2020 2029 0a0a 2020 2020 2320         )..    # 
+00025cb0: 6368 616e 6765 2074 7970 6520 6f66 2073  change type of s
+00025cc0: 656c 6620 616e 6420 7265 7475 726e 2074  elf and return t
+00025cd0: 6f20 545f 4461 7461 7365 7420 6f6e 6365  o T_Dataset once
+00025ce0: 0a20 2020 2023 2068 7474 7073 3a2f 2f67  .    # https://g
+00025cf0: 6974 6875 622e 636f 6d2f 7079 7468 6f6e  ithub.com/python
+00025d00: 2f6d 7970 792f 6973 7375 6573 2f31 3238  /mypy/issues/128
+00025d10: 3436 2069 7320 7265 736f 6c76 6564 0a20  46 is resolved. 
+00025d20: 2020 2064 6566 2073 6574 5f69 6e64 6578     def set_index
+00025d30: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00025d40: 2020 2020 2020 2020 696e 6465 7865 733a          indexes:
+00025d50: 204d 6170 7069 6e67 5b41 6e79 2c20 4861   Mapping[Any, Ha
+00025d60: 7368 6162 6c65 207c 2053 6571 7565 6e63  shable | Sequenc
+00025d70: 655b 4861 7368 6162 6c65 5d5d 207c 204e  e[Hashable]] | N
+00025d80: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+00025d90: 2020 2020 6170 7065 6e64 3a20 626f 6f6c      append: bool
+00025da0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+00025db0: 2020 2a2a 696e 6465 7865 735f 6b77 6172    **indexes_kwar
+00025dc0: 6773 3a20 4861 7368 6162 6c65 207c 2053  gs: Hashable | S
+00025dd0: 6571 7565 6e63 655b 4861 7368 6162 6c65  equence[Hashable
+00025de0: 5d2c 0a20 2020 2029 202d 3e20 4461 7461  ],.    ) -> Data
+00025df0: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+00025e00: 5365 7420 4461 7461 7365 7420 286d 756c  Set Dataset (mul
+00025e10: 7469 2d29 696e 6465 7865 7320 7573 696e  ti-)indexes usin
+00025e20: 6720 6f6e 6520 6f72 206d 6f72 6520 6578  g one or more ex
+00025e30: 6973 7469 6e67 2063 6f6f 7264 696e 6174  isting coordinat
+00025e40: 6573 0a20 2020 2020 2020 206f 7220 7661  es.        or va
+00025e50: 7269 6162 6c65 732e 0a0a 2020 2020 2020  riables...      
+00025e60: 2020 5468 6973 206c 6567 6163 7920 6d65    This legacy me
+00025e70: 7468 6f64 2069 7320 6c69 6d69 7465 6420  thod is limited 
+00025e80: 746f 2070 616e 6461 7320 286d 756c 7469  to pandas (multi
+00025e90: 2d29 696e 6465 7865 7320 616e 640a 2020  -)indexes and.  
+00025ea0: 2020 2020 2020 312d 6469 6d65 6e73 696f        1-dimensio
+00025eb0: 6e61 6c20 2264 696d 656e 7369 6f6e 2220  nal "dimension" 
+00025ec0: 636f 6f72 6469 6e61 7465 732e 2053 6565  coordinates. See
+00025ed0: 0a20 2020 2020 2020 203a 7079 3a6d 6574  .        :py:met
+00025ee0: 683a 607e 4461 7461 7365 742e 7365 745f  h:`~Dataset.set_
+00025ef0: 7869 6e64 6578 6020 666f 7220 7365 7474  xindex` for sett
+00025f00: 696e 6720 6120 7061 6e64 6173 206f 7220  ing a pandas or 
+00025f10: 6120 6375 7374 6f6d 0a20 2020 2020 2020  a custom.       
+00025f20: 2058 6172 7261 792d 636f 6d70 6174 6962   Xarray-compatib
+00025f30: 6c65 2069 6e64 6578 2066 726f 6d20 6f6e  le index from on
+00025f40: 6520 6f72 206d 6f72 6520 6172 6269 7472  e or more arbitr
+00025f50: 6172 7920 636f 6f72 6469 6e61 7465 732e  ary coordinates.
+00025f60: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00025f70: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00025f80: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00025f90: 696e 6465 7865 7320 3a20 7b64 696d 3a20  indexes : {dim: 
+00025fa0: 696e 6465 782c 202e 2e2e 7d0a 2020 2020  index, ...}.    
+00025fb0: 2020 2020 2020 2020 4d61 7070 696e 6720          Mapping 
+00025fc0: 6672 6f6d 206e 616d 6573 206d 6174 6368  from names match
+00025fd0: 696e 6720 6469 6d65 6e73 696f 6e73 2061  ing dimensions a
+00025fe0: 6e64 2076 616c 7565 7320 6769 7665 6e0a  nd values given.
+00025ff0: 2020 2020 2020 2020 2020 2020 6279 2028              by (
+00026000: 6c69 7374 7320 6f66 2920 7468 6520 6e61  lists of) the na
+00026010: 6d65 7320 6f66 2065 7869 7374 696e 6720  mes of existing 
+00026020: 636f 6f72 6469 6e61 7465 7320 6f72 2076  coordinates or v
+00026030: 6172 6961 626c 6573 2074 6f20 7365 740a  ariables to set.
+00026040: 2020 2020 2020 2020 2020 2020 6173 206e              as n
+00026050: 6577 2028 6d75 6c74 692d 2969 6e64 6578  ew (multi-)index
+00026060: 2e0a 2020 2020 2020 2020 6170 7065 6e64  ..        append
+00026070: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
+00026080: 3a20 4661 6c73 650a 2020 2020 2020 2020  : False.        
+00026090: 2020 2020 4966 2054 7275 652c 2061 7070      If True, app
+000260a0: 656e 6420 7468 6520 7375 7070 6c69 6564  end the supplied
+000260b0: 2069 6e64 6578 2865 7329 2074 6f20 7468   index(es) to th
+000260c0: 6520 6578 6973 7469 6e67 2069 6e64 6578  e existing index
+000260d0: 2865 7329 2e0a 2020 2020 2020 2020 2020  (es)..          
+000260e0: 2020 4f74 6865 7277 6973 6520 7265 706c    Otherwise repl
+000260f0: 6163 6520 7468 6520 6578 6973 7469 6e67  ace the existing
+00026100: 2069 6e64 6578 2865 7329 2028 6465 6661   index(es) (defa
+00026110: 756c 7429 2e0a 2020 2020 2020 2020 2a2a  ult)..        **
+00026120: 696e 6465 7865 735f 6b77 6172 6773 203a  indexes_kwargs :
+00026130: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00026140: 2020 2020 2020 5468 6520 6b65 7977 6f72        The keywor
+00026150: 6420 6172 6775 6d65 6e74 7320 666f 726d  d arguments form
+00026160: 206f 6620 6060 696e 6465 7865 7360 602e   of ``indexes``.
+00026170: 0a20 2020 2020 2020 2020 2020 204f 6e65  .            One
+00026180: 206f 6620 696e 6465 7865 7320 6f72 2069   of indexes or i
+00026190: 6e64 6578 6573 5f6b 7761 7267 7320 6d75  ndexes_kwargs mu
+000261a0: 7374 2062 6520 7072 6f76 6964 6564 2e0a  st be provided..
+000261b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+000261c0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000261d0: 0a20 2020 2020 2020 206f 626a 203a 2044  .        obj : D
+000261e0: 6174 6173 6574 0a20 2020 2020 2020 2020  ataset.         
+000261f0: 2020 2041 6e6f 7468 6572 2064 6174 6173     Another datas
+00026200: 6574 2c20 7769 7468 2074 6869 7320 6461  et, with this da
+00026210: 7461 7365 7427 7320 6461 7461 2062 7574  taset's data but
+00026220: 2072 6570 6c61 6365 6420 636f 6f72 6469   replaced coordi
+00026230: 6e61 7465 732e 0a0a 2020 2020 2020 2020  nates...        
+00026240: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+00026250: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+00026260: 2020 3e3e 3e20 6172 7220 3d20 7872 2e44    >>> arr = xr.D
+00026270: 6174 6141 7272 6179 280a 2020 2020 2020  ataArray(.      
+00026280: 2020 2e2e 2e20 2020 2020 6461 7461 3d6e    ...     data=n
+00026290: 702e 6f6e 6573 2828 322c 2033 2929 2c0a  p.ones((2, 3)),.
+000262a0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+000262b0: 6469 6d73 3d5b 2278 222c 2022 7922 5d2c  dims=["x", "y"],
+000262c0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+000262d0: 2063 6f6f 7264 733d 7b22 7822 3a20 7261   coords={"x": ra
+000262e0: 6e67 6528 3229 2c20 2279 223a 2072 616e  nge(2), "y": ran
+000262f0: 6765 2833 292c 2022 6122 3a20 2822 7822  ge(3), "a": ("x"
+00026300: 2c20 5b33 2c20 345d 297d 2c0a 2020 2020  , [3, 4])},.    
+00026310: 2020 2020 2e2e 2e20 290a 2020 2020 2020      ... ).      
+00026320: 2020 3e3e 3e20 6473 203d 2078 722e 4461    >>> ds = xr.Da
+00026330: 7461 7365 7428 7b22 7622 3a20 6172 727d  taset({"v": arr}
+00026340: 290a 2020 2020 2020 2020 3e3e 3e20 6473  ).        >>> ds
+00026350: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
+00026360: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
+00026370: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
+00026380: 783a 2032 2c20 793a 2033 290a 2020 2020  x: 2, y: 3).    
+00026390: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
+000263a0: 0a20 2020 2020 2020 2020 202a 2078 2020  .          * x  
+000263b0: 2020 2020 2020 2878 2920 696e 7436 3420        (x) int64 
+000263c0: 3020 310a 2020 2020 2020 2020 2020 2a20  0 1.          * 
+000263d0: 7920 2020 2020 2020 2028 7929 2069 6e74  y        (y) int
+000263e0: 3634 2030 2031 2032 0a20 2020 2020 2020  64 0 1 2.       
+000263f0: 2020 2020 2061 2020 2020 2020 2020 2878       a        (x
+00026400: 2920 696e 7436 3420 3320 340a 2020 2020  ) int64 3 4.    
+00026410: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
+00026420: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00026430: 7620 2020 2020 2020 2028 782c 2079 2920  v        (x, y) 
+00026440: 666c 6f61 7436 3420 312e 3020 312e 3020  float64 1.0 1.0 
+00026450: 312e 3020 312e 3020 312e 3020 312e 300a  1.0 1.0 1.0 1.0.
+00026460: 2020 2020 2020 2020 3e3e 3e20 6473 2e73          >>> ds.s
+00026470: 6574 5f69 6e64 6578 2878 3d22 6122 290a  et_index(x="a").
+00026480: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
+00026490: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
+000264a0: 2044 696d 656e 7369 6f6e 733a 2020 2878   Dimensions:  (x
+000264b0: 3a20 322c 2079 3a20 3329 0a20 2020 2020  : 2, y: 3).     
+000264c0: 2020 2043 6f6f 7264 696e 6174 6573 3a0a     Coordinates:.
+000264d0: 2020 2020 2020 2020 2020 2a20 7820 2020            * x   
+000264e0: 2020 2020 2028 7829 2069 6e74 3634 2033       (x) int64 3
+000264f0: 2034 0a20 2020 2020 2020 2020 202a 2079   4.          * y
+00026500: 2020 2020 2020 2020 2879 2920 696e 7436          (y) int6
+00026510: 3420 3020 3120 320a 2020 2020 2020 2020  4 0 1 2.        
+00026520: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
+00026530: 2020 2020 2020 2020 2020 2020 7620 2020              v   
+00026540: 2020 2020 2028 782c 2079 2920 666c 6f61       (x, y) floa
+00026550: 7436 3420 312e 3020 312e 3020 312e 3020  t64 1.0 1.0 1.0 
+00026560: 312e 3020 312e 3020 312e 300a 0a20 2020  1.0 1.0 1.0..   
+00026570: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+00026580: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00026590: 2020 2020 2020 2044 6174 6173 6574 2e72         Dataset.r
+000265a0: 6573 6574 5f69 6e64 6578 0a20 2020 2020  eset_index.     
+000265b0: 2020 2044 6174 6173 6574 2e73 6574 5f78     Dataset.set_x
+000265c0: 696e 6465 780a 2020 2020 2020 2020 4461  index.        Da
+000265d0: 7461 7365 742e 7377 6170 5f64 696d 730a  taset.swap_dims.
+000265e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000265f0: 2020 2020 6469 6d5f 636f 6f72 6473 203d      dim_coords =
+00026600: 2065 6974 6865 725f 6469 6374 5f6f 725f   either_dict_or_
+00026610: 6b77 6172 6773 2869 6e64 6578 6573 2c20  kwargs(indexes, 
+00026620: 696e 6465 7865 735f 6b77 6172 6773 2c20  indexes_kwargs, 
+00026630: 2273 6574 5f69 6e64 6578 2229 0a0a 2020  "set_index")..  
+00026640: 2020 2020 2020 6e65 775f 696e 6465 7865        new_indexe
+00026650: 733a 2064 6963 745b 4861 7368 6162 6c65  s: dict[Hashable
+00026660: 2c20 496e 6465 785d 203d 207b 7d0a 2020  , Index] = {}.  
+00026670: 2020 2020 2020 6e65 775f 7661 7269 6162        new_variab
+00026680: 6c65 733a 2064 6963 745b 4861 7368 6162  les: dict[Hashab
+00026690: 6c65 2c20 5661 7269 6162 6c65 5d20 3d20  le, Variable] = 
+000266a0: 7b7d 0a20 2020 2020 2020 2064 726f 705f  {}.        drop_
+000266b0: 696e 6465 7865 733a 2073 6574 5b48 6173  indexes: set[Has
+000266c0: 6861 626c 655d 203d 2073 6574 2829 0a20  hable] = set(). 
+000266d0: 2020 2020 2020 2064 726f 705f 7661 7269         drop_vari
+000266e0: 6162 6c65 733a 2073 6574 5b48 6173 6861  ables: set[Hasha
+000266f0: 626c 655d 203d 2073 6574 2829 0a20 2020  ble] = set().   
+00026700: 2020 2020 2072 6570 6c61 6365 5f64 696d       replace_dim
+00026710: 733a 2064 6963 745b 4861 7368 6162 6c65  s: dict[Hashable
+00026720: 2c20 4861 7368 6162 6c65 5d20 3d20 7b7d  , Hashable] = {}
+00026730: 0a20 2020 2020 2020 2061 6c6c 5f76 6172  .        all_var
+00026740: 5f6e 616d 6573 3a20 7365 745b 4861 7368  _names: set[Hash
+00026750: 6162 6c65 5d20 3d20 7365 7428 290a 0a20  able] = set().. 
+00026760: 2020 2020 2020 2066 6f72 2064 696d 2c20         for dim, 
+00026770: 5f76 6172 5f6e 616d 6573 2069 6e20 6469  _var_names in di
+00026780: 6d5f 636f 6f72 6473 2e69 7465 6d73 2829  m_coords.items()
+00026790: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+000267a0: 2069 7369 6e73 7461 6e63 6528 5f76 6172   isinstance(_var
+000267b0: 5f6e 616d 6573 2c20 7374 7229 206f 7220  _names, str) or 
+000267c0: 6e6f 7420 6973 696e 7374 616e 6365 285f  not isinstance(_
+000267d0: 7661 725f 6e61 6d65 732c 2053 6571 7565  var_names, Seque
+000267e0: 6e63 6529 3a0a 2020 2020 2020 2020 2020  nce):.          
+000267f0: 2020 2020 2020 7661 725f 6e61 6d65 7320        var_names 
+00026800: 3d20 5b5f 7661 725f 6e61 6d65 735d 0a20  = [_var_names]. 
+00026810: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00026820: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026830: 2076 6172 5f6e 616d 6573 203d 206c 6973   var_names = lis
+00026840: 7428 5f76 6172 5f6e 616d 6573 290a 0a20  t(_var_names).. 
+00026850: 2020 2020 2020 2020 2020 2069 6e76 616c             inval
+00026860: 6964 5f76 6172 7320 3d20 7365 7428 7661  id_vars = set(va
+00026870: 725f 6e61 6d65 7329 202d 2073 6574 2873  r_names) - set(s
+00026880: 656c 662e 5f76 6172 6961 626c 6573 290a  elf._variables).
+00026890: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+000268a0: 6e76 616c 6964 5f76 6172 733a 0a20 2020  nvalid_vars:.   
+000268b0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+000268c0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+000268d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000268e0: 2020 2022 2c20 222e 6a6f 696e 285b 7374     ", ".join([st
+000268f0: 7228 7629 2066 6f72 2076 2069 6e20 696e  r(v) for v in in
+00026900: 7661 6c69 645f 7661 7273 5d29 0a20 2020  valid_vars]).   
+00026910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026920: 202b 2022 2076 6172 6961 626c 6528 7329   + " variable(s)
+00026930: 2064 6f20 6e6f 7420 6578 6973 7422 0a20   do not exist". 
+00026940: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00026950: 0a0a 2020 2020 2020 2020 2020 2020 616c  ..            al
+00026960: 6c5f 7661 725f 6e61 6d65 732e 7570 6461  l_var_names.upda
+00026970: 7465 2876 6172 5f6e 616d 6573 290a 2020  te(var_names).  
+00026980: 2020 2020 2020 2020 2020 6472 6f70 5f76            drop_v
+00026990: 6172 6961 626c 6573 2e75 7064 6174 6528  ariables.update(
+000269a0: 7661 725f 6e61 6d65 7329 0a0a 2020 2020  var_names)..    
+000269b0: 2020 2020 2020 2020 2320 6472 6f70 2061          # drop a
+000269c0: 6e79 2070 7265 2d65 7869 7374 696e 6720  ny pre-existing 
+000269d0: 696e 6465 7820 696e 766f 6c76 6564 2061  index involved a
+000269e0: 6e64 2069 7473 2063 6f72 7265 7370 6f6e  nd its correspon
+000269f0: 6469 6e67 2063 6f6f 7264 696e 6174 6573  ding coordinates
+00026a00: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+00026a10: 6578 5f63 6f6f 7264 5f6e 616d 6573 203d  ex_coord_names =
+00026a20: 2073 656c 662e 7869 6e64 6578 6573 2e67   self.xindexes.g
+00026a30: 6574 5f61 6c6c 5f63 6f6f 7264 7328 6469  et_all_coords(di
+00026a40: 6d2c 2065 7272 6f72 733d 2269 676e 6f72  m, errors="ignor
+00026a50: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
+00026a60: 616c 6c5f 696e 6465 785f 636f 6f72 645f  all_index_coord_
+00026a70: 6e61 6d65 7320 3d20 7365 7428 696e 6465  names = set(inde
+00026a80: 785f 636f 6f72 645f 6e61 6d65 7329 0a20  x_coord_names). 
+00026a90: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+00026aa0: 2069 6e20 7661 725f 6e61 6d65 733a 0a20   in var_names:. 
+00026ab0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00026ac0: 6c6c 5f69 6e64 6578 5f63 6f6f 7264 5f6e  ll_index_coord_n
+00026ad0: 616d 6573 2e75 7064 6174 6528 0a20 2020  ames.update(.   
+00026ae0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026af0: 2073 656c 662e 7869 6e64 6578 6573 2e67   self.xindexes.g
+00026b00: 6574 5f61 6c6c 5f63 6f6f 7264 7328 6b2c  et_all_coords(k,
+00026b10: 2065 7272 6f72 733d 2269 676e 6f72 6522   errors="ignore"
+00026b20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00026b30: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00026b40: 2064 726f 705f 696e 6465 7865 732e 7570   drop_indexes.up
+00026b50: 6461 7465 2861 6c6c 5f69 6e64 6578 5f63  date(all_index_c
+00026b60: 6f6f 7264 5f6e 616d 6573 290a 2020 2020  oord_names).    
+00026b70: 2020 2020 2020 2020 6472 6f70 5f76 6172          drop_var
+00026b80: 6961 626c 6573 2e75 7064 6174 6528 616c  iables.update(al
+00026b90: 6c5f 696e 6465 785f 636f 6f72 645f 6e61  l_index_coord_na
+00026ba0: 6d65 7329 0a0a 2020 2020 2020 2020 2020  mes)..          
+00026bb0: 2020 6966 206c 656e 2876 6172 5f6e 616d    if len(var_nam
+00026bc0: 6573 2920 3d3d 2031 2061 6e64 2028 6e6f  es) == 1 and (no
+00026bd0: 7420 6170 7065 6e64 206f 7220 6469 6d20  t append or dim 
+00026be0: 6e6f 7420 696e 2073 656c 662e 5f69 6e64  not in self._ind
+00026bf0: 6578 6573 293a 0a20 2020 2020 2020 2020  exes):.         
+00026c00: 2020 2020 2020 2076 6172 5f6e 616d 6520         var_name 
+00026c10: 3d20 7661 725f 6e61 6d65 735b 305d 0a20  = var_names[0]. 
+00026c20: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00026c30: 6172 203d 2073 656c 662e 5f76 6172 6961  ar = self._varia
+00026c40: 626c 6573 5b76 6172 5f6e 616d 655d 0a20  bles[var_name]. 
+00026c50: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00026c60: 6620 7661 722e 6469 6d73 2021 3d20 2864  f var.dims != (d
+00026c70: 696d 2c29 3a0a 2020 2020 2020 2020 2020  im,):.          
+00026c80: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00026c90: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00026ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026cb0: 2020 2020 6622 6469 6d65 6e73 696f 6e20      f"dimension 
+00026cc0: 6d69 736d 6174 6368 3a20 7472 7920 7365  mismatch: try se
+00026cd0: 7474 696e 6720 616e 2069 6e64 6578 2066  tting an index f
+00026ce0: 6f72 2064 696d 656e 7369 6f6e 207b 6469  or dimension {di
+00026cf0: 6d21 727d 2077 6974 6820 220a 2020 2020  m!r} with ".    
+00026d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d10: 2020 2020 6622 7661 7269 6162 6c65 207b      f"variable {
+00026d20: 7661 725f 6e61 6d65 2172 7d20 7468 6174  var_name!r} that
+00026d30: 2068 6173 2064 696d 656e 7369 6f6e 7320   has dimensions 
+00026d40: 7b76 6172 2e64 696d 737d 220a 2020 2020  {var.dims}".    
+00026d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026d60: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00026d70: 2020 6964 7820 3d20 5061 6e64 6173 496e    idx = PandasIn
+00026d80: 6465 782e 6672 6f6d 5f76 6172 6961 626c  dex.from_variabl
+00026d90: 6573 287b 6469 6d3a 2076 6172 7d2c 206f  es({dim: var}, o
+00026da0: 7074 696f 6e73 3d7b 7d29 0a20 2020 2020  ptions={}).     
+00026db0: 2020 2020 2020 2020 2020 2069 6478 5f76             idx_v
+00026dc0: 6172 7320 3d20 6964 782e 6372 6561 7465  ars = idx.create
+00026dd0: 5f76 6172 6961 626c 6573 287b 7661 725f  _variables({var_
+00026de0: 6e61 6d65 3a20 7661 727d 290a 0a20 2020  name: var})..   
+00026df0: 2020 2020 2020 2020 2020 2020 2023 2074               # t
+00026e00: 7269 636b 2074 6f20 7072 6573 6572 7665  rick to preserve
+00026e10: 2063 6f6f 7264 696e 6174 6520 6f72 6465   coordinate orde
+00026e20: 7220 696e 2074 6869 7320 6361 7365 0a20  r in this case. 
+00026e30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00026e40: 6620 6469 6d20 696e 2073 656c 662e 5f63  f dim in self._c
+00026e50: 6f6f 7264 5f6e 616d 6573 3a0a 2020 2020  oord_names:.    
+00026e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026e70: 6472 6f70 5f76 6172 6961 626c 6573 2e72  drop_variables.r
+00026e80: 656d 6f76 6528 6469 6d29 0a20 2020 2020  emove(dim).     
+00026e90: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00026ea0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00026eb0: 6170 7065 6e64 3a0a 2020 2020 2020 2020  append:.        
+00026ec0: 2020 2020 2020 2020 2020 2020 6375 7272              curr
+00026ed0: 656e 745f 7661 7269 6162 6c65 7320 3d20  ent_variables = 
+00026ee0: 7b0a 2020 2020 2020 2020 2020 2020 2020  {.              
+00026ef0: 2020 2020 2020 2020 2020 6b3a 2073 656c            k: sel
+00026f00: 662e 5f76 6172 6961 626c 6573 5b6b 5d20  f._variables[k] 
+00026f10: 666f 7220 6b20 696e 2069 6e64 6578 5f63  for k in index_c
+00026f20: 6f6f 7264 5f6e 616d 6573 0a20 2020 2020  oord_names.     
+00026f30: 2020 2020 2020 2020 2020 2020 2020 207d                 }
+00026f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00026f50: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00026f60: 2020 2020 2020 2020 2020 2063 7572 7265             curre
+00026f70: 6e74 5f76 6172 6961 626c 6573 203d 207b  nt_variables = {
+00026f80: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00026f90: 2020 6964 782c 2069 6478 5f76 6172 7320    idx, idx_vars 
+00026fa0: 3d20 5061 6e64 6173 4d75 6c74 6949 6e64  = PandasMultiInd
+00026fb0: 6578 2e66 726f 6d5f 7661 7269 6162 6c65  ex.from_variable
+00026fc0: 735f 6d61 7962 655f 6578 7061 6e64 280a  s_maybe_expand(.
+00026fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00026fe0: 2020 2020 6469 6d2c 0a20 2020 2020 2020      dim,.       
+00026ff0: 2020 2020 2020 2020 2020 2020 2063 7572               cur
+00027000: 7265 6e74 5f76 6172 6961 626c 6573 2c0a  rent_variables,.
+00027010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027020: 2020 2020 7b6b 3a20 7365 6c66 2e5f 7661      {k: self._va
+00027030: 7269 6162 6c65 735b 6b5d 2066 6f72 206b  riables[k] for k
+00027040: 2069 6e20 7661 725f 6e61 6d65 737d 2c0a   in var_names},.
+00027050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00027060: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00027070: 2020 666f 7220 6e20 696e 2069 6478 2e69    for n in idx.i
+00027080: 6e64 6578 2e6e 616d 6573 3a0a 2020 2020  ndex.names:.    
+00027090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000270a0: 7265 706c 6163 655f 6469 6d73 5b6e 5d20  replace_dims[n] 
+000270b0: 3d20 6469 6d0a 0a20 2020 2020 2020 2020  = dim..         
+000270c0: 2020 206e 6577 5f69 6e64 6578 6573 2e75     new_indexes.u
+000270d0: 7064 6174 6528 7b6b 3a20 6964 7820 666f  pdate({k: idx fo
+000270e0: 7220 6b20 696e 2069 6478 5f76 6172 737d  r k in idx_vars}
+000270f0: 290a 2020 2020 2020 2020 2020 2020 6e65  ).            ne
+00027100: 775f 7661 7269 6162 6c65 732e 7570 6461  w_variables.upda
+00027110: 7465 2869 6478 5f76 6172 7329 0a0a 2020  te(idx_vars)..  
+00027120: 2020 2020 2020 2320 7265 2d61 6464 2064        # re-add d
+00027130: 6569 6e64 6578 6564 2063 6f6f 7264 696e  eindexed coordin
+00027140: 6174 6573 2028 636f 6e76 6572 7420 746f  ates (convert to
+00027150: 2062 6173 6520 7661 7269 6162 6c65 7329   base variables)
+00027160: 0a20 2020 2020 2020 2066 6f72 206b 2069  .        for k i
+00027170: 6e20 6472 6f70 5f76 6172 6961 626c 6573  n drop_variables
+00027180: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00027190: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+000271a0: 2020 206b 206e 6f74 2069 6e20 6e65 775f     k not in new_
+000271b0: 7661 7269 6162 6c65 730a 2020 2020 2020  variables.      
+000271c0: 2020 2020 2020 2020 2020 616e 6420 6b20            and k 
+000271d0: 6e6f 7420 696e 2061 6c6c 5f76 6172 5f6e  not in all_var_n
+000271e0: 616d 6573 0a20 2020 2020 2020 2020 2020  ames.           
+000271f0: 2020 2020 2061 6e64 206b 2069 6e20 7365       and k in se
+00027200: 6c66 2e5f 636f 6f72 645f 6e61 6d65 730a  lf._coord_names.
+00027210: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
+00027220: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+00027230: 6577 5f76 6172 6961 626c 6573 5b6b 5d20  ew_variables[k] 
+00027240: 3d20 7365 6c66 2e5f 7661 7269 6162 6c65  = self._variable
+00027250: 735b 6b5d 2e74 6f5f 6261 7365 5f76 6172  s[k].to_base_var
+00027260: 6961 626c 6528 290a 0a20 2020 2020 2020  iable()..       
+00027270: 2069 6e64 6578 6573 5f3a 2064 6963 745b   indexes_: dict[
+00027280: 416e 792c 2049 6e64 6578 5d20 3d20 7b0a  Any, Index] = {.
+00027290: 2020 2020 2020 2020 2020 2020 6b3a 2076              k: v
+000272a0: 2066 6f72 206b 2c20 7620 696e 2073 656c   for k, v in sel
+000272b0: 662e 5f69 6e64 6578 6573 2e69 7465 6d73  f._indexes.items
+000272c0: 2829 2069 6620 6b20 6e6f 7420 696e 2064  () if k not in d
+000272d0: 726f 705f 696e 6465 7865 730a 2020 2020  rop_indexes.    
+000272e0: 2020 2020 7d0a 2020 2020 2020 2020 696e      }.        in
+000272f0: 6465 7865 735f 2e75 7064 6174 6528 6e65  dexes_.update(ne
+00027300: 775f 696e 6465 7865 7329 0a0a 2020 2020  w_indexes)..    
+00027310: 2020 2020 7661 7269 6162 6c65 7320 3d20      variables = 
+00027320: 7b0a 2020 2020 2020 2020 2020 2020 6b3a  {.            k:
+00027330: 2076 2066 6f72 206b 2c20 7620 696e 2073   v for k, v in s
+00027340: 656c 662e 5f76 6172 6961 626c 6573 2e69  elf._variables.i
+00027350: 7465 6d73 2829 2069 6620 6b20 6e6f 7420  tems() if k not 
+00027360: 696e 2064 726f 705f 7661 7269 6162 6c65  in drop_variable
+00027370: 730a 2020 2020 2020 2020 7d0a 2020 2020  s.        }.    
+00027380: 2020 2020 7661 7269 6162 6c65 732e 7570      variables.up
+00027390: 6461 7465 286e 6577 5f76 6172 6961 626c  date(new_variabl
+000273a0: 6573 290a 0a20 2020 2020 2020 2023 2075  es)..        # u
+000273b0: 7064 6174 6520 6469 6d65 6e73 696f 6e73  pdate dimensions
+000273c0: 2069 6620 6e65 6365 7373 6172 792c 2047   if necessary, G
+000273d0: 483a 2033 3531 320a 2020 2020 2020 2020  H: 3512.        
+000273e0: 666f 7220 6b2c 2076 2069 6e20 7661 7269  for k, v in vari
+000273f0: 6162 6c65 732e 6974 656d 7328 293a 0a20  ables.items():. 
+00027400: 2020 2020 2020 2020 2020 2069 6620 616e             if an
+00027410: 7928 6420 696e 2072 6570 6c61 6365 5f64  y(d in replace_d
+00027420: 696d 7320 666f 7220 6420 696e 2076 2e64  ims for d in v.d
+00027430: 696d 7329 3a0a 2020 2020 2020 2020 2020  ims):.          
+00027440: 2020 2020 2020 6e65 775f 6469 6d73 203d        new_dims =
+00027450: 205b 7265 706c 6163 655f 6469 6d73 2e67   [replace_dims.g
+00027460: 6574 2864 2c20 6429 2066 6f72 2064 2069  et(d, d) for d i
+00027470: 6e20 762e 6469 6d73 5d0a 2020 2020 2020  n v.dims].      
+00027480: 2020 2020 2020 2020 2020 7661 7269 6162            variab
+00027490: 6c65 735b 6b5d 203d 2076 2e5f 7265 706c  les[k] = v._repl
+000274a0: 6163 6528 6469 6d73 3d6e 6577 5f64 696d  ace(dims=new_dim
+000274b0: 7329 0a0a 2020 2020 2020 2020 636f 6f72  s)..        coor
+000274c0: 645f 6e61 6d65 7320 3d20 7365 6c66 2e5f  d_names = self._
+000274d0: 636f 6f72 645f 6e61 6d65 7320 2d20 6472  coord_names - dr
+000274e0: 6f70 5f76 6172 6961 626c 6573 207c 2073  op_variables | s
+000274f0: 6574 286e 6577 5f76 6172 6961 626c 6573  et(new_variables
+00027500: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+00027510: 6e20 7365 6c66 2e5f 7265 706c 6163 655f  n self._replace_
+00027520: 7769 7468 5f6e 6577 5f64 696d 7328 0a20  with_new_dims(. 
+00027530: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00027540: 626c 6573 2c20 636f 6f72 645f 6e61 6d65  bles, coord_name
+00027550: 733d 636f 6f72 645f 6e61 6d65 732c 2069  s=coord_names, i
+00027560: 6e64 6578 6573 3d69 6e64 6578 6573 5f0a  ndexes=indexes_.
+00027570: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00027580: 6566 2072 6573 6574 5f69 6e64 6578 280a  ef reset_index(.
+00027590: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
+000275a0: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
+000275b0: 2064 696d 735f 6f72 5f6c 6576 656c 733a   dims_or_levels:
+000275c0: 2048 6173 6861 626c 6520 7c20 5365 7175   Hashable | Sequ
+000275d0: 656e 6365 5b48 6173 6861 626c 655d 2c0a  ence[Hashable],.
+000275e0: 2020 2020 2020 2020 6472 6f70 3a20 626f          drop: bo
+000275f0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
+00027600: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
+00027610: 2020 2020 2020 2020 2222 2252 6573 6574          """Reset
+00027620: 2074 6865 2073 7065 6369 6669 6564 2069   the specified i
+00027630: 6e64 6578 2865 7329 206f 7220 6d75 6c74  ndex(es) or mult
+00027640: 692d 696e 6465 7820 6c65 7665 6c28 7329  i-index level(s)
+00027650: 2e0a 0a20 2020 2020 2020 2054 6869 7320  ...        This 
+00027660: 6c65 6761 6379 206d 6574 686f 6420 6973  legacy method is
+00027670: 2073 7065 6369 6669 6320 746f 2070 616e   specific to pan
+00027680: 6461 7320 286d 756c 7469 2d29 696e 6465  das (multi-)inde
+00027690: 7865 7320 616e 640a 2020 2020 2020 2020  xes and.        
+000276a0: 312d 6469 6d65 6e73 696f 6e61 6c20 2264  1-dimensional "d
+000276b0: 696d 656e 7369 6f6e 2220 636f 6f72 6469  imension" coordi
+000276c0: 6e61 7465 732e 2053 6565 2074 6865 206d  nates. See the m
+000276d0: 6f72 6520 6765 6e65 7269 630a 2020 2020  ore generic.    
+000276e0: 2020 2020 3a70 793a 6d65 7468 3a60 7e44      :py:meth:`~D
+000276f0: 6174 6173 6574 2e64 726f 705f 696e 6465  ataset.drop_inde
+00027700: 7865 7360 2061 6e64 203a 7079 3a6d 6574  xes` and :py:met
+00027710: 683a 607e 4461 7461 7365 742e 7365 745f  h:`~Dataset.set_
+00027720: 7869 6e64 6578 600a 2020 2020 2020 2020  xindex`.        
+00027730: 6d65 7468 6f64 2074 6f20 7265 7370 6563  method to respec
+00027740: 7469 7665 6c79 2064 726f 7020 616e 6420  tively drop and 
+00027750: 7365 7420 7061 6e64 6173 206f 7220 6375  set pandas or cu
+00027760: 7374 6f6d 2069 6e64 6578 6573 2066 6f72  stom indexes for
+00027770: 0a20 2020 2020 2020 2061 7262 6974 7261  .        arbitra
+00027780: 7279 2063 6f6f 7264 696e 6174 6573 2e0a  ry coordinates..
+00027790: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000277a0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+000277b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+000277c0: 696d 735f 6f72 5f6c 6576 656c 7320 3a20  ims_or_levels : 
+000277d0: 4861 7368 6162 6c65 206f 7220 5365 7175  Hashable or Sequ
+000277e0: 656e 6365 206f 6620 4861 7368 6162 6c65  ence of Hashable
+000277f0: 0a20 2020 2020 2020 2020 2020 204e 616d  .            Nam
+00027800: 6528 7329 206f 6620 7468 6520 6469 6d65  e(s) of the dime
+00027810: 6e73 696f 6e28 7329 2061 6e64 2f6f 7220  nsion(s) and/or 
+00027820: 6d75 6c74 692d 696e 6465 7820 6c65 7665  multi-index leve
+00027830: 6c28 7329 2074 6861 7420 7769 6c6c 0a20  l(s) that will. 
+00027840: 2020 2020 2020 2020 2020 2062 6520 7265             be re
+00027850: 7365 742e 0a20 2020 2020 2020 2064 726f  set..        dro
+00027860: 7020 3a20 626f 6f6c 2c20 6465 6661 756c  p : bool, defaul
+00027870: 743a 2046 616c 7365 0a20 2020 2020 2020  t: False.       
+00027880: 2020 2020 2049 6620 5472 7565 2c20 7265       If True, re
+00027890: 6d6f 7665 2074 6865 2073 7065 6369 6669  move the specifi
+000278a0: 6564 2069 6e64 6578 6573 2061 6e64 2f6f  ed indexes and/o
+000278b0: 7220 6d75 6c74 692d 696e 6465 7820 6c65  r multi-index le
+000278c0: 7665 6c73 0a20 2020 2020 2020 2020 2020  vels.           
+000278d0: 2069 6e73 7465 6164 206f 6620 6578 7472   instead of extr
+000278e0: 6163 7469 6e67 2074 6865 6d20 6173 206e  acting them as n
+000278f0: 6577 2063 6f6f 7264 696e 6174 6573 2028  ew coordinates (
+00027900: 6465 6661 756c 743a 2046 616c 7365 292e  default: False).
+00027910: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00027920: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00027930: 2d0a 2020 2020 2020 2020 6f62 6a20 3a20  -.        obj : 
+00027940: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
+00027950: 2020 2020 416e 6f74 6865 7220 6461 7461      Another data
+00027960: 7365 742c 2077 6974 6820 7468 6973 2064  set, with this d
+00027970: 6174 6173 6574 2773 2064 6174 6120 6275  ataset's data bu
+00027980: 7420 7265 706c 6163 6564 2063 6f6f 7264  t replaced coord
+00027990: 696e 6174 6573 2e0a 0a20 2020 2020 2020  inates...       
+000279a0: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+000279b0: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+000279c0: 2020 2044 6174 6173 6574 2e73 6574 5f69     Dataset.set_i
+000279d0: 6e64 6578 0a20 2020 2020 2020 2044 6174  ndex.        Dat
+000279e0: 6173 6574 2e73 6574 5f78 696e 6465 780a  aset.set_xindex.
+000279f0: 2020 2020 2020 2020 4461 7461 7365 742e          Dataset.
+00027a00: 6472 6f70 5f69 6e64 6578 6573 0a20 2020  drop_indexes.   
+00027a10: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00027a20: 2069 6620 6973 696e 7374 616e 6365 2864   if isinstance(d
+00027a30: 696d 735f 6f72 5f6c 6576 656c 732c 2073  ims_or_levels, s
+00027a40: 7472 2920 6f72 206e 6f74 2069 7369 6e73  tr) or not isins
+00027a50: 7461 6e63 6528 6469 6d73 5f6f 725f 6c65  tance(dims_or_le
+00027a60: 7665 6c73 2c20 5365 7175 656e 6365 293a  vels, Sequence):
+00027a70: 0a20 2020 2020 2020 2020 2020 2064 696d  .            dim
+00027a80: 735f 6f72 5f6c 6576 656c 7320 3d20 5b64  s_or_levels = [d
+00027a90: 696d 735f 6f72 5f6c 6576 656c 735d 0a0a  ims_or_levels]..
+00027aa0: 2020 2020 2020 2020 696e 7661 6c69 645f          invalid_
+00027ab0: 636f 6f72 6473 203d 2073 6574 2864 696d  coords = set(dim
+00027ac0: 735f 6f72 5f6c 6576 656c 7329 202d 2073  s_or_levels) - s
+00027ad0: 6574 2873 656c 662e 5f69 6e64 6578 6573  et(self._indexes
+00027ae0: 290a 2020 2020 2020 2020 6966 2069 6e76  ).        if inv
+00027af0: 616c 6964 5f63 6f6f 7264 733a 0a20 2020  alid_coords:.   
+00027b00: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00027b10: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+00027b20: 2020 2020 2020 2020 2020 2066 227b 7475             f"{tu
+00027b30: 706c 6528 696e 7661 6c69 645f 636f 6f72  ple(invalid_coor
+00027b40: 6473 297d 2061 7265 206e 6f74 2063 6f6f  ds)} are not coo
+00027b50: 7264 696e 6174 6573 2077 6974 6820 616e  rdinates with an
+00027b60: 2069 6e64 6578 220a 2020 2020 2020 2020   index".        
+00027b70: 2020 2020 290a 0a20 2020 2020 2020 2064      )..        d
+00027b80: 726f 705f 696e 6465 7865 733a 2073 6574  rop_indexes: set
+00027b90: 5b48 6173 6861 626c 655d 203d 2073 6574  [Hashable] = set
+00027ba0: 2829 0a20 2020 2020 2020 2064 726f 705f  ().        drop_
+00027bb0: 7661 7269 6162 6c65 733a 2073 6574 5b48  variables: set[H
+00027bc0: 6173 6861 626c 655d 203d 2073 6574 2829  ashable] = set()
+00027bd0: 0a20 2020 2020 2020 2073 6565 6e3a 2073  .        seen: s
+00027be0: 6574 5b49 6e64 6578 5d20 3d20 7365 7428  et[Index] = set(
+00027bf0: 290a 2020 2020 2020 2020 6e65 775f 696e  ).        new_in
+00027c00: 6465 7865 733a 2064 6963 745b 4861 7368  dexes: dict[Hash
+00027c10: 6162 6c65 2c20 496e 6465 785d 203d 207b  able, Index] = {
+00027c20: 7d0a 2020 2020 2020 2020 6e65 775f 7661  }.        new_va
+00027c30: 7269 6162 6c65 733a 2064 6963 745b 4861  riables: dict[Ha
+00027c40: 7368 6162 6c65 2c20 5661 7269 6162 6c65  shable, Variable
+00027c50: 5d20 3d20 7b7d 0a0a 2020 2020 2020 2020  ] = {}..        
+00027c60: 6465 6620 6472 6f70 5f6f 725f 636f 6e76  def drop_or_conv
+00027c70: 6572 7428 7661 725f 6e61 6d65 7329 3a0a  ert(var_names):.
+00027c80: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+00027c90: 726f 703a 0a20 2020 2020 2020 2020 2020  rop:.           
+00027ca0: 2020 2020 2064 726f 705f 7661 7269 6162       drop_variab
+00027cb0: 6c65 732e 7570 6461 7465 2876 6172 5f6e  les.update(var_n
+00027cc0: 616d 6573 290a 2020 2020 2020 2020 2020  ames).          
+00027cd0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00027ce0: 2020 2020 2020 2020 6261 7365 5f76 6172          base_var
+00027cf0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00027d00: 2020 2020 2020 2020 2020 6b3a 2073 656c            k: sel
+00027d10: 662e 5f76 6172 6961 626c 6573 5b6b 5d2e  f._variables[k].
+00027d20: 746f 5f62 6173 655f 7661 7269 6162 6c65  to_base_variable
+00027d30: 2829 2066 6f72 206b 2069 6e20 7661 725f  () for k in var_
+00027d40: 6e61 6d65 730a 2020 2020 2020 2020 2020  names.          
+00027d50: 2020 2020 2020 7d0a 2020 2020 2020 2020        }.        
+00027d60: 2020 2020 2020 2020 6e65 775f 7661 7269          new_vari
+00027d70: 6162 6c65 732e 7570 6461 7465 2862 6173  ables.update(bas
+00027d80: 655f 7661 7273 290a 0a20 2020 2020 2020  e_vars)..       
+00027d90: 2066 6f72 206e 616d 6520 696e 2064 696d   for name in dim
+00027da0: 735f 6f72 5f6c 6576 656c 733a 0a20 2020  s_or_levels:.   
+00027db0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+00027dc0: 2073 656c 662e 5f69 6e64 6578 6573 5b6e   self._indexes[n
+00027dd0: 616d 655d 0a0a 2020 2020 2020 2020 2020  ame]..          
+00027de0: 2020 6966 2069 6e64 6578 2069 6e20 7365    if index in se
+00027df0: 656e 3a0a 2020 2020 2020 2020 2020 2020  en:.            
+00027e00: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+00027e10: 2020 2020 2020 2020 2073 6565 6e2e 6164           seen.ad
+00027e20: 6428 696e 6465 7829 0a0a 2020 2020 2020  d(index)..      
+00027e30: 2020 2020 2020 6964 785f 7661 725f 6e61        idx_var_na
+00027e40: 6d65 7320 3d20 7365 7428 7365 6c66 2e78  mes = set(self.x
+00027e50: 696e 6465 7865 732e 6765 745f 616c 6c5f  indexes.get_all_
+00027e60: 636f 6f72 6473 286e 616d 6529 290a 2020  coords(name)).  
+00027e70: 2020 2020 2020 2020 2020 6472 6f70 5f69            drop_i
+00027e80: 6e64 6578 6573 2e75 7064 6174 6528 6964  ndexes.update(id
+00027e90: 785f 7661 725f 6e61 6d65 7329 0a0a 2020  x_var_names)..  
+00027ea0: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
+00027eb0: 6e73 7461 6e63 6528 696e 6465 782c 2050  nstance(index, P
+00027ec0: 616e 6461 734d 756c 7469 496e 6465 7829  andasMultiIndex)
+00027ed0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00027ee0: 2020 2320 7370 6563 6961 6c20 6361 7365    # special case
+00027ef0: 2066 6f72 2070 642e 4d75 6c74 6949 6e64   for pd.MultiInd
+00027f00: 6578 0a20 2020 2020 2020 2020 2020 2020  ex.             
+00027f10: 2020 206c 6576 656c 5f6e 616d 6573 203d     level_names =
+00027f20: 2069 6e64 6578 2e69 6e64 6578 2e6e 616d   index.index.nam
+00027f30: 6573 0a20 2020 2020 2020 2020 2020 2020  es.             
+00027f40: 2020 206b 6565 705f 6c65 7665 6c5f 7661     keep_level_va
+00027f50: 7273 203d 207b 0a20 2020 2020 2020 2020  rs = {.         
+00027f60: 2020 2020 2020 2020 2020 206b 3a20 7365             k: se
+00027f70: 6c66 2e5f 7661 7269 6162 6c65 735b 6b5d  lf._variables[k]
+00027f80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00027f90: 2020 2020 2066 6f72 206b 2069 6e20 6c65       for k in le
+00027fa0: 7665 6c5f 6e61 6d65 730a 2020 2020 2020  vel_names.      
+00027fb0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00027fc0: 206b 206e 6f74 2069 6e20 6469 6d73 5f6f   k not in dims_o
+00027fd0: 725f 6c65 7665 6c73 0a20 2020 2020 2020  r_levels.       
+00027fe0: 2020 2020 2020 2020 207d 0a0a 2020 2020           }..    
+00027ff0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+00028000: 6e64 6578 2e64 696d 206e 6f74 2069 6e20  ndex.dim not in 
+00028010: 6469 6d73 5f6f 725f 6c65 7665 6c73 2061  dims_or_levels a
+00028020: 6e64 206b 6565 705f 6c65 7665 6c5f 7661  nd keep_level_va
+00028030: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+00028040: 2020 2020 2020 2020 2320 646f 206e 6f74          # do not
+00028050: 2064 726f 7020 7468 6520 6d75 6c74 692d   drop the multi-
+00028060: 696e 6465 7820 636f 6d70 6c65 7465 6c79  index completely
+00028070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028080: 2020 2020 2023 2069 6e73 7465 6164 2072       # instead r
+00028090: 6570 6c61 6365 2069 7420 6279 2061 206e  eplace it by a n
+000280a0: 6577 2028 6d75 6c74 692d 2969 6e64 6578  ew (multi-)index
+000280b0: 2077 6974 6820 6472 6f70 7065 6420 6c65   with dropped le
+000280c0: 7665 6c28 7329 0a20 2020 2020 2020 2020  vel(s).         
+000280d0: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
+000280e0: 2069 6e64 6578 2e6b 6565 705f 6c65 7665   index.keep_leve
+000280f0: 6c73 286b 6565 705f 6c65 7665 6c5f 7661  ls(keep_level_va
+00028100: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
+00028110: 2020 2020 2020 2020 6964 785f 7661 7273          idx_vars
+00028120: 203d 2069 6478 2e63 7265 6174 655f 7661   = idx.create_va
+00028130: 7269 6162 6c65 7328 6b65 6570 5f6c 6576  riables(keep_lev
+00028140: 656c 5f76 6172 7329 0a20 2020 2020 2020  el_vars).       
+00028150: 2020 2020 2020 2020 2020 2020 206e 6577               new
+00028160: 5f69 6e64 6578 6573 2e75 7064 6174 6528  _indexes.update(
+00028170: 7b6b 3a20 6964 7820 666f 7220 6b20 696e  {k: idx for k in
+00028180: 2069 6478 5f76 6172 737d 290a 2020 2020   idx_vars}).    
 00028190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000281a0: 2020 2020 2020 2020 6472 6f70 5f76 6172          drop_var
-000281b0: 6961 626c 6573 2e75 7064 6174 6528 6b65  iables.update(ke
-000281c0: 6570 5f6c 6576 656c 5f76 6172 7329 0a20  ep_level_vars). 
-000281d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000281e0: 2020 2064 726f 705f 6f72 5f63 6f6e 7665     drop_or_conve
-000281f0: 7274 280a 2020 2020 2020 2020 2020 2020  rt(.            
-00028200: 2020 2020 2020 2020 2020 2020 5b6b 2066              [k f
-00028210: 6f72 206b 2069 6e20 6c65 7665 6c5f 6e61  or k in level_na
-00028220: 6d65 7320 6966 206b 206e 6f74 2069 6e20  mes if k not in 
-00028230: 6b65 6570 5f6c 6576 656c 5f76 6172 735d  keep_level_vars]
-00028240: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00028250: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00028260: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00028270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00028280: 2023 2061 6c77 6179 7320 6472 6f70 2074   # always drop t
-00028290: 6865 206d 756c 7469 2d69 6e64 6578 2064  he multi-index d
-000282a0: 696d 656e 7369 6f6e 2076 6172 6961 626c  imension variabl
-000282b0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-000282c0: 2020 2020 2020 6472 6f70 5f76 6172 6961        drop_varia
-000282d0: 626c 6573 2e61 6464 2869 6e64 6578 2e64  bles.add(index.d
-000282e0: 696d 290a 2020 2020 2020 2020 2020 2020  im).            
-000282f0: 2020 2020 2020 2020 6472 6f70 5f6f 725f          drop_or_
-00028300: 636f 6e76 6572 7428 6c65 7665 6c5f 6e61  convert(level_na
-00028310: 6d65 7329 0a20 2020 2020 2020 2020 2020  mes).           
-00028320: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00028330: 2020 2020 2020 2064 726f 705f 6f72 5f63         drop_or_c
-00028340: 6f6e 7665 7274 2869 6478 5f76 6172 5f6e  onvert(idx_var_n
-00028350: 616d 6573 290a 0a20 2020 2020 2020 2069  ames)..        i
-00028360: 6e64 6578 6573 203d 207b 6b3a 2076 2066  ndexes = {k: v f
-00028370: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
-00028380: 5f69 6e64 6578 6573 2e69 7465 6d73 2829  _indexes.items()
-00028390: 2069 6620 6b20 6e6f 7420 696e 2064 726f   if k not in dro
-000283a0: 705f 696e 6465 7865 737d 0a20 2020 2020  p_indexes}.     
-000283b0: 2020 2069 6e64 6578 6573 2e75 7064 6174     indexes.updat
-000283c0: 6528 6e65 775f 696e 6465 7865 7329 0a0a  e(new_indexes)..
-000283d0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-000283e0: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
-000283f0: 2020 6b3a 2076 2066 6f72 206b 2c20 7620    k: v for k, v 
-00028400: 696e 2073 656c 662e 5f76 6172 6961 626c  in self._variabl
-00028410: 6573 2e69 7465 6d73 2829 2069 6620 6b20  es.items() if k 
-00028420: 6e6f 7420 696e 2064 726f 705f 7661 7269  not in drop_vari
-00028430: 6162 6c65 730a 2020 2020 2020 2020 7d0a  ables.        }.
-00028440: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-00028450: 732e 7570 6461 7465 286e 6577 5f76 6172  s.update(new_var
-00028460: 6961 626c 6573 290a 0a20 2020 2020 2020  iables)..       
-00028470: 2063 6f6f 7264 5f6e 616d 6573 203d 2073   coord_names = s
-00028480: 656c 662e 5f63 6f6f 7264 5f6e 616d 6573  elf._coord_names
-00028490: 202d 2064 726f 705f 7661 7269 6162 6c65   - drop_variable
-000284a0: 730a 0a20 2020 2020 2020 2072 6574 7572  s..        retur
-000284b0: 6e20 7365 6c66 2e5f 7265 706c 6163 655f  n self._replace_
-000284c0: 7769 7468 5f6e 6577 5f64 696d 7328 0a20  with_new_dims(. 
-000284d0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-000284e0: 626c 6573 2c20 636f 6f72 645f 6e61 6d65  bles, coord_name
-000284f0: 733d 636f 6f72 645f 6e61 6d65 732c 2069  s=coord_names, i
-00028500: 6e64 6578 6573 3d69 6e64 6578 6573 0a20  ndexes=indexes. 
-00028510: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-00028520: 6620 7365 745f 7869 6e64 6578 280a 2020  f set_xindex(.  
-00028530: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
-00028540: 7461 7365 742c 0a20 2020 2020 2020 2063  taset,.        c
-00028550: 6f6f 7264 5f6e 616d 6573 3a20 7374 7220  oord_names: str 
-00028560: 7c20 5365 7175 656e 6365 5b48 6173 6861  | Sequence[Hasha
-00028570: 626c 655d 2c0a 2020 2020 2020 2020 696e  ble],.        in
-00028580: 6465 785f 636c 733a 2074 7970 655b 496e  dex_cls: type[In
-00028590: 6465 785d 207c 204e 6f6e 6520 3d20 4e6f  dex] | None = No
-000285a0: 6e65 2c0a 2020 2020 2020 2020 2a2a 6f70  ne,.        **op
-000285b0: 7469 6f6e 732c 0a20 2020 2029 202d 3e20  tions,.    ) -> 
-000285c0: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
-000285d0: 2020 2022 2222 5365 7420 6120 6e65 772c     """Set a new,
-000285e0: 2058 6172 7261 792d 636f 6d70 6174 6962   Xarray-compatib
-000285f0: 6c65 2069 6e64 6578 2066 726f 6d20 6f6e  le index from on
-00028600: 6520 6f72 206d 6f72 6520 6578 6973 7469  e or more existi
-00028610: 6e67 0a20 2020 2020 2020 2063 6f6f 7264  ng.        coord
-00028620: 696e 6174 6528 7329 2e0a 0a20 2020 2020  inate(s)...     
-00028630: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00028640: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000281a0: 6e65 775f 7661 7269 6162 6c65 732e 7570  new_variables.up
+000281b0: 6461 7465 2869 6478 5f76 6172 7329 0a20  date(idx_vars). 
+000281c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000281d0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+000281e0: 616e 6365 2869 6478 2c20 5061 6e64 6173  ance(idx, Pandas
+000281f0: 4d75 6c74 6949 6e64 6578 293a 0a20 2020  MultiIndex):.   
+00028200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028210: 2020 2020 2023 206d 756c 7469 2d69 6e64       # multi-ind
+00028220: 6578 2072 6564 7563 6564 2074 6f20 7369  ex reduced to si
+00028230: 6e67 6c65 2069 6e64 6578 0a20 2020 2020  ngle index.     
+00028240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028250: 2020 2023 2062 6163 6b77 6172 6420 636f     # backward co
+00028260: 6d70 6174 6962 696c 6974 793a 2075 6e69  mpatibility: uni
+00028270: 7175 6520 6c65 7665 6c20 636f 6f72 6469  que level coordi
+00028280: 6e61 7465 2072 656e 616d 6564 2074 6f20  nate renamed to 
+00028290: 6469 6d65 6e73 696f 6e0a 2020 2020 2020  dimension.      
+000282a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000282b0: 2020 6472 6f70 5f76 6172 6961 626c 6573    drop_variables
+000282c0: 2e75 7064 6174 6528 6b65 6570 5f6c 6576  .update(keep_lev
+000282d0: 656c 5f76 6172 7329 0a20 2020 2020 2020  el_vars).       
+000282e0: 2020 2020 2020 2020 2020 2020 2064 726f               dro
+000282f0: 705f 6f72 5f63 6f6e 7665 7274 280a 2020  p_or_convert(.  
+00028300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028310: 2020 2020 2020 5b6b 2066 6f72 206b 2069        [k for k i
+00028320: 6e20 6c65 7665 6c5f 6e61 6d65 7320 6966  n level_names if
+00028330: 206b 206e 6f74 2069 6e20 6b65 6570 5f6c   k not in keep_l
+00028340: 6576 656c 5f76 6172 735d 0a20 2020 2020  evel_vars].     
+00028350: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00028360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028370: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00028380: 2020 2020 2020 2020 2020 2023 2061 6c77             # alw
+00028390: 6179 7320 6472 6f70 2074 6865 206d 756c  ays drop the mul
+000283a0: 7469 2d69 6e64 6578 2064 696d 656e 7369  ti-index dimensi
+000283b0: 6f6e 2076 6172 6961 626c 650a 2020 2020  on variable.    
+000283c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000283d0: 6472 6f70 5f76 6172 6961 626c 6573 2e61  drop_variables.a
+000283e0: 6464 2869 6e64 6578 2e64 696d 290a 2020  dd(index.dim).  
+000283f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00028400: 2020 6472 6f70 5f6f 725f 636f 6e76 6572    drop_or_conver
+00028410: 7428 6c65 7665 6c5f 6e61 6d65 7329 0a20  t(level_names). 
+00028420: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00028430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028440: 2064 726f 705f 6f72 5f63 6f6e 7665 7274   drop_or_convert
+00028450: 2869 6478 5f76 6172 5f6e 616d 6573 290a  (idx_var_names).
+00028460: 0a20 2020 2020 2020 2069 6e64 6578 6573  .        indexes
+00028470: 203d 207b 6b3a 2076 2066 6f72 206b 2c20   = {k: v for k, 
+00028480: 7620 696e 2073 656c 662e 5f69 6e64 6578  v in self._index
+00028490: 6573 2e69 7465 6d73 2829 2069 6620 6b20  es.items() if k 
+000284a0: 6e6f 7420 696e 2064 726f 705f 696e 6465  not in drop_inde
+000284b0: 7865 737d 0a20 2020 2020 2020 2069 6e64  xes}.        ind
+000284c0: 6578 6573 2e75 7064 6174 6528 6e65 775f  exes.update(new_
+000284d0: 696e 6465 7865 7329 0a0a 2020 2020 2020  indexes)..      
+000284e0: 2020 7661 7269 6162 6c65 7320 3d20 7b0a    variables = {.
+000284f0: 2020 2020 2020 2020 2020 2020 6b3a 2076              k: v
+00028500: 2066 6f72 206b 2c20 7620 696e 2073 656c   for k, v in sel
+00028510: 662e 5f76 6172 6961 626c 6573 2e69 7465  f._variables.ite
+00028520: 6d73 2829 2069 6620 6b20 6e6f 7420 696e  ms() if k not in
+00028530: 2064 726f 705f 7661 7269 6162 6c65 730a   drop_variables.
+00028540: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+00028550: 2020 7661 7269 6162 6c65 732e 7570 6461    variables.upda
+00028560: 7465 286e 6577 5f76 6172 6961 626c 6573  te(new_variables
+00028570: 290a 0a20 2020 2020 2020 2063 6f6f 7264  )..        coord
+00028580: 5f6e 616d 6573 203d 2073 656c 662e 5f63  _names = self._c
+00028590: 6f6f 7264 5f6e 616d 6573 202d 2064 726f  oord_names - dro
+000285a0: 705f 7661 7269 6162 6c65 730a 0a20 2020  p_variables..   
+000285b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000285c0: 2e5f 7265 706c 6163 655f 7769 7468 5f6e  ._replace_with_n
+000285d0: 6577 5f64 696d 7328 0a20 2020 2020 2020  ew_dims(.       
+000285e0: 2020 2020 2076 6172 6961 626c 6573 2c20       variables, 
+000285f0: 636f 6f72 645f 6e61 6d65 733d 636f 6f72  coord_names=coor
+00028600: 645f 6e61 6d65 732c 2069 6e64 6578 6573  d_names, indexes
+00028610: 3d69 6e64 6578 6573 0a20 2020 2020 2020  =indexes.       
+00028620: 2029 0a0a 2020 2020 6465 6620 7365 745f   )..    def set_
+00028630: 7869 6e64 6578 280a 2020 2020 2020 2020  xindex(.        
+00028640: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
 00028650: 0a20 2020 2020 2020 2063 6f6f 7264 5f6e  .        coord_n
-00028660: 616d 6573 203a 2073 7472 206f 7220 6c69  ames : str or li
-00028670: 7374 0a20 2020 2020 2020 2020 2020 204e  st.            N
-00028680: 616d 6528 7329 206f 6620 7468 6520 636f  ame(s) of the co
-00028690: 6f72 6469 6e61 7465 2873 2920 7573 6564  ordinate(s) used
-000286a0: 2074 6f20 6275 696c 6420 7468 6520 696e   to build the in
-000286b0: 6465 782e 0a20 2020 2020 2020 2020 2020  dex..           
-000286c0: 2049 6620 7365 7665 7261 6c20 6e61 6d65   If several name
-000286d0: 7320 6172 6520 6769 7665 6e2c 2074 6865  s are given, the
-000286e0: 6972 206f 7264 6572 206d 6174 7465 7273  ir order matters
-000286f0: 2e0a 2020 2020 2020 2020 696e 6465 785f  ..        index_
-00028700: 636c 7320 3a20 7375 6263 6c61 7373 206f  cls : subclass o
-00028710: 6620 3a63 6c61 7373 3a60 7e78 6172 7261  f :class:`~xarra
-00028720: 792e 696e 6465 7865 732e 496e 6465 7860  y.indexes.Index`
-00028730: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-00028740: 2020 2020 2020 2054 6865 2074 7970 6520         The type 
-00028750: 6f66 2069 6e64 6578 2074 6f20 6372 6561  of index to crea
-00028760: 7465 2e20 4279 2064 6566 6175 6c74 2c20  te. By default, 
-00028770: 7472 7920 7365 7474 696e 670a 2020 2020  try setting.    
-00028780: 2020 2020 2020 2020 6120 6060 5061 6e64          a ``Pand
-00028790: 6173 496e 6465 7860 6020 6966 2060 606c  asIndex`` if ``l
-000287a0: 656e 2863 6f6f 7264 5f6e 616d 6573 2920  en(coord_names) 
-000287b0: 3d3d 2031 6060 2c0a 2020 2020 2020 2020  == 1``,.        
-000287c0: 2020 2020 6f74 6865 7277 6973 6520 6120      otherwise a 
-000287d0: 6060 5061 6e64 6173 4d75 6c74 6949 6e64  ``PandasMultiInd
-000287e0: 6578 6060 2e0a 2020 2020 2020 2020 2a2a  ex``..        **
-000287f0: 6f70 7469 6f6e 730a 2020 2020 2020 2020  options.        
-00028800: 2020 2020 4f70 7469 6f6e 7320 7061 7373      Options pass
-00028810: 6564 2074 6f20 7468 6520 696e 6465 7820  ed to the index 
-00028820: 636f 6e73 7472 7563 746f 722e 0a0a 2020  constructor...  
-00028830: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00028840: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00028850: 2020 2020 2020 6f62 6a20 3a20 4461 7461        obj : Data
-00028860: 7365 740a 2020 2020 2020 2020 2020 2020  set.            
-00028870: 416e 6f74 6865 7220 6461 7461 7365 742c  Another dataset,
-00028880: 2077 6974 6820 7468 6973 2064 6174 6173   with this datas
-00028890: 6574 2773 2064 6174 6120 616e 6420 7769  et's data and wi
-000288a0: 7468 2061 206e 6577 2069 6e64 6578 2e0a  th a new index..
-000288b0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-000288c0: 2020 2020 2023 2074 6865 2053 6571 7565       # the Seque
-000288d0: 6e63 6520 6368 6563 6b20 6973 2072 6571  nce check is req
-000288e0: 7569 7265 6420 666f 7220 6d79 7079 0a20  uired for mypy. 
-000288f0: 2020 2020 2020 2069 6620 6973 5f73 6361         if is_sca
-00028900: 6c61 7228 636f 6f72 645f 6e61 6d65 7329  lar(coord_names)
-00028910: 206f 7220 6e6f 7420 6973 696e 7374 616e   or not isinstan
-00028920: 6365 2863 6f6f 7264 5f6e 616d 6573 2c20  ce(coord_names, 
-00028930: 5365 7175 656e 6365 293a 0a20 2020 2020  Sequence):.     
-00028940: 2020 2020 2020 2063 6f6f 7264 5f6e 616d         coord_nam
-00028950: 6573 203d 205b 636f 6f72 645f 6e61 6d65  es = [coord_name
-00028960: 735d 0a0a 2020 2020 2020 2020 6966 2069  s]..        if i
-00028970: 6e64 6578 5f63 6c73 2069 7320 4e6f 6e65  ndex_cls is None
-00028980: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00028990: 206c 656e 2863 6f6f 7264 5f6e 616d 6573   len(coord_names
-000289a0: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
-000289b0: 2020 2020 2020 2020 696e 6465 785f 636c          index_cl
-000289c0: 7320 3d20 5061 6e64 6173 496e 6465 780a  s = PandasIndex.
-000289d0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-000289e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000289f0: 2020 696e 6465 785f 636c 7320 3d20 5061    index_cls = Pa
-00028a00: 6e64 6173 4d75 6c74 6949 6e64 6578 0a20  ndasMultiIndex. 
-00028a10: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00028a20: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00028a30: 6973 7375 6263 6c61 7373 2869 6e64 6578  issubclass(index
-00028a40: 5f63 6c73 2c20 496e 6465 7829 3a0a 2020  _cls, Index):.  
-00028a50: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00028a60: 6973 6520 5479 7065 4572 726f 7228 6622  ise TypeError(f"
-00028a70: 7b69 6e64 6578 5f63 6c73 7d20 6973 206e  {index_cls} is n
-00028a80: 6f74 2061 2073 7562 636c 6173 7320 6f66  ot a subclass of
-00028a90: 2078 6172 7261 792e 496e 6465 7822 290a   xarray.Index").
-00028aa0: 0a20 2020 2020 2020 2069 6e76 616c 6964  .        invalid
-00028ab0: 5f63 6f6f 7264 7320 3d20 7365 7428 636f  _coords = set(co
-00028ac0: 6f72 645f 6e61 6d65 7329 202d 2073 656c  ord_names) - sel
-00028ad0: 662e 5f63 6f6f 7264 5f6e 616d 6573 0a0a  f._coord_names..
-00028ae0: 2020 2020 2020 2020 6966 2069 6e76 616c          if inval
-00028af0: 6964 5f63 6f6f 7264 733a 0a20 2020 2020  id_coords:.     
-00028b00: 2020 2020 2020 206d 7367 203d 205b 2269         msg = ["i
-00028b10: 6e76 616c 6964 2063 6f6f 7264 696e 6174  nvalid coordinat
-00028b20: 6528 7329 225d 0a20 2020 2020 2020 2020  e(s)"].         
-00028b30: 2020 206e 6f5f 7661 7273 203d 2069 6e76     no_vars = inv
-00028b40: 616c 6964 5f63 6f6f 7264 7320 2d20 7365  alid_coords - se
-00028b50: 7428 7365 6c66 2e5f 7661 7269 6162 6c65  t(self._variable
-00028b60: 7329 0a20 2020 2020 2020 2020 2020 2064  s).            d
-00028b70: 6174 615f 7661 7273 203d 2069 6e76 616c  ata_vars = inval
-00028b80: 6964 5f63 6f6f 7264 7320 2d20 6e6f 5f76  id_coords - no_v
-00028b90: 6172 730a 2020 2020 2020 2020 2020 2020  ars.            
-00028ba0: 6966 206e 6f5f 7661 7273 3a0a 2020 2020  if no_vars:.    
-00028bb0: 2020 2020 2020 2020 2020 2020 6d73 672e              msg.
-00028bc0: 6170 7065 6e64 2866 2274 686f 7365 2076  append(f"those v
-00028bd0: 6172 6961 626c 6573 2064 6f6e 2774 2065  ariables don't e
-00028be0: 7869 7374 3a20 7b6e 6f5f 7661 7273 7d22  xist: {no_vars}"
-00028bf0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
-00028c00: 2064 6174 615f 7661 7273 3a0a 2020 2020   data_vars:.    
-00028c10: 2020 2020 2020 2020 2020 2020 6d73 672e              msg.
-00028c20: 6170 7065 6e64 280a 2020 2020 2020 2020  append(.        
-00028c30: 2020 2020 2020 2020 2020 2020 6622 7468              f"th
-00028c40: 6f73 6520 7661 7269 6162 6c65 7320 6172  ose variables ar
-00028c50: 6520 6461 7461 2076 6172 6961 626c 6573  e data variables
-00028c60: 3a20 7b64 6174 615f 7661 7273 7d2c 2075  : {data_vars}, u
-00028c70: 7365 2060 7365 745f 636f 6f72 6473 6020  se `set_coords` 
-00028c80: 6669 7273 7422 0a20 2020 2020 2020 2020  first".         
-00028c90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00028ca0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00028cb0: 4572 726f 7228 225c 6e22 2e6a 6f69 6e28  Error("\n".join(
-00028cc0: 6d73 6729 290a 0a20 2020 2020 2020 2023  msg))..        #
-00028cd0: 2077 6520 636f 756c 6420 6265 206d 6f72   we could be mor
-00028ce0: 6520 636c 6576 6572 2068 6572 6520 2865  e clever here (e
-00028cf0: 2e67 2e2c 2064 726f 702d 696e 2069 6e64  .g., drop-in ind
-00028d00: 6578 2072 6570 6c61 6365 6d65 6e74 2069  ex replacement i
-00028d10: 6620 696e 6465 780a 2020 2020 2020 2020  f index.        
-00028d20: 2320 636f 6f72 6469 6e61 7465 7320 646f  # coordinates do
-00028d30: 206e 6f74 2063 6f6e 666c 6963 7429 2c20   not conflict), 
-00028d40: 6275 7420 6c65 7427 7320 6e6f 7420 616c  but let's not al
-00028d50: 6c6f 7720 7468 6973 2066 6f72 206e 6f77  low this for now
-00028d60: 0a20 2020 2020 2020 2069 6e64 6578 6564  .        indexed
-00028d70: 5f63 6f6f 7264 7320 3d20 7365 7428 636f  _coords = set(co
-00028d80: 6f72 645f 6e61 6d65 7329 2026 2073 6574  ord_names) & set
-00028d90: 2873 656c 662e 5f69 6e64 6578 6573 290a  (self._indexes).
-00028da0: 0a20 2020 2020 2020 2069 6620 696e 6465  .        if inde
-00028db0: 7865 645f 636f 6f72 6473 3a0a 2020 2020  xed_coords:.    
-00028dc0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00028dd0: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00028de0: 2020 2020 2020 2020 2020 6622 7468 6f73            f"thos
-00028df0: 6520 636f 6f72 6469 6e61 7465 7320 616c  e coordinates al
-00028e00: 7265 6164 7920 6861 7665 2061 6e20 696e  ready have an in
-00028e10: 6465 783a 207b 696e 6465 7865 645f 636f  dex: {indexed_co
-00028e20: 6f72 6473 7d22 0a20 2020 2020 2020 2020  ords}".         
-00028e30: 2020 2029 0a0a 2020 2020 2020 2020 636f     )..        co
-00028e40: 6f72 645f 7661 7273 203d 207b 6e61 6d65  ord_vars = {name
-00028e50: 3a20 7365 6c66 2e5f 7661 7269 6162 6c65  : self._variable
-00028e60: 735b 6e61 6d65 5d20 666f 7220 6e61 6d65  s[name] for name
-00028e70: 2069 6e20 636f 6f72 645f 6e61 6d65 737d   in coord_names}
-00028e80: 0a0a 2020 2020 2020 2020 696e 6465 7820  ..        index 
-00028e90: 3d20 696e 6465 785f 636c 732e 6672 6f6d  = index_cls.from
-00028ea0: 5f76 6172 6961 626c 6573 2863 6f6f 7264  _variables(coord
-00028eb0: 5f76 6172 732c 206f 7074 696f 6e73 3d6f  _vars, options=o
-00028ec0: 7074 696f 6e73 290a 0a20 2020 2020 2020  ptions)..       
-00028ed0: 206e 6577 5f63 6f6f 7264 5f76 6172 7320   new_coord_vars 
-00028ee0: 3d20 696e 6465 782e 6372 6561 7465 5f76  = index.create_v
-00028ef0: 6172 6961 626c 6573 2863 6f6f 7264 5f76  ariables(coord_v
-00028f00: 6172 7329 0a0a 2020 2020 2020 2020 2320  ars)..        # 
-00028f10: 7370 6563 6961 6c20 6361 7365 2066 6f72  special case for
-00028f20: 2073 6574 7469 6e67 2061 2070 616e 6461   setting a panda
-00028f30: 7320 6d75 6c74 692d 696e 6465 7820 6672  s multi-index fr
-00028f40: 6f6d 206c 6576 656c 2063 6f6f 7264 696e  om level coordin
-00028f50: 6174 6573 0a20 2020 2020 2020 2023 2054  ates.        # T
-00028f60: 4f44 4f3a 2072 656d 6f76 6520 6974 206f  ODO: remove it o
-00028f70: 6e63 6520 7765 2064 6570 7265 6369 6174  nce we depreciat
-00028f80: 6520 7061 6e64 6173 206d 756c 7469 2d69  e pandas multi-i
-00028f90: 6e64 6578 2064 696d 656e 7369 6f6e 2028  ndex dimension (
-00028fa0: 7475 706c 650a 2020 2020 2020 2020 2320  tuple.        # 
-00028fb0: 656c 656d 656e 7473 2920 636f 6f72 6469  elements) coordi
-00028fc0: 6e61 7465 0a20 2020 2020 2020 2069 6620  nate.        if 
-00028fd0: 6973 696e 7374 616e 6365 2869 6e64 6578  isinstance(index
-00028fe0: 2c20 5061 6e64 6173 4d75 6c74 6949 6e64  , PandasMultiInd
-00028ff0: 6578 293a 0a20 2020 2020 2020 2020 2020  ex):.           
-00029000: 2063 6f6f 7264 5f6e 616d 6573 203d 205b   coord_names = [
-00029010: 696e 6465 782e 6469 6d5d 202b 206c 6973  index.dim] + lis
-00029020: 7428 636f 6f72 645f 6e61 6d65 7329 0a0a  t(coord_names)..
-00029030: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-00029040: 733a 2064 6963 745b 4861 7368 6162 6c65  s: dict[Hashable
-00029050: 2c20 5661 7269 6162 6c65 5d0a 2020 2020  , Variable].    
-00029060: 2020 2020 696e 6465 7865 733a 2064 6963      indexes: dic
-00029070: 745b 4861 7368 6162 6c65 2c20 496e 6465  t[Hashable, Inde
-00029080: 785d 0a0a 2020 2020 2020 2020 6966 206c  x]..        if l
-00029090: 656e 2863 6f6f 7264 5f6e 616d 6573 2920  en(coord_names) 
-000290a0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-000290b0: 2020 7661 7269 6162 6c65 7320 3d20 7365    variables = se
-000290c0: 6c66 2e5f 7661 7269 6162 6c65 732e 636f  lf._variables.co
-000290d0: 7079 2829 0a20 2020 2020 2020 2020 2020  py().           
-000290e0: 2069 6e64 6578 6573 203d 2073 656c 662e   indexes = self.
-000290f0: 5f69 6e64 6578 6573 2e63 6f70 7928 290a  _indexes.copy().
-00029100: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00029110: 6520 3d20 6c69 7374 2863 6f6f 7264 5f6e  e = list(coord_n
-00029120: 616d 6573 292e 706f 7028 290a 2020 2020  ames).pop().    
-00029130: 2020 2020 2020 2020 6966 206e 616d 6520          if name 
-00029140: 696e 206e 6577 5f63 6f6f 7264 5f76 6172  in new_coord_var
-00029150: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00029160: 2020 2076 6172 6961 626c 6573 5b6e 616d     variables[nam
-00029170: 655d 203d 206e 6577 5f63 6f6f 7264 5f76  e] = new_coord_v
-00029180: 6172 735b 6e61 6d65 5d0a 2020 2020 2020  ars[name].      
-00029190: 2020 2020 2020 696e 6465 7865 735b 6e61        indexes[na
-000291a0: 6d65 5d20 3d20 696e 6465 780a 2020 2020  me] = index.    
-000291b0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000291c0: 2020 2020 2020 2320 7265 6f72 6465 7220        # reorder 
-000291d0: 7661 7269 6162 6c65 7320 616e 6420 696e  variables and in
-000291e0: 6465 7865 7320 736f 2074 6861 7420 636f  dexes so that co
-000291f0: 6f72 6469 6e61 7465 7320 6861 7669 6e67  ordinates having
-00029200: 2074 6865 2073 616d 650a 2020 2020 2020   the same.      
-00029210: 2020 2020 2020 2320 696e 6465 7820 6172        # index ar
-00029220: 6520 6e65 7874 2074 6f20 6561 6368 206f  e next to each o
-00029230: 7468 6572 0a20 2020 2020 2020 2020 2020  ther.           
-00029240: 2076 6172 6961 626c 6573 203d 207b 7d0a   variables = {}.
-00029250: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00029260: 6e61 6d65 2c20 7661 7220 696e 2073 656c  name, var in sel
-00029270: 662e 5f76 6172 6961 626c 6573 2e69 7465  f._variables.ite
-00029280: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
-00029290: 2020 2020 2020 6966 206e 616d 6520 6e6f        if name no
-000292a0: 7420 696e 2063 6f6f 7264 5f6e 616d 6573  t in coord_names
-000292b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000292c0: 2020 2020 2020 7661 7269 6162 6c65 735b        variables[
-000292d0: 6e61 6d65 5d20 3d20 7661 720a 0a20 2020  name] = var..   
-000292e0: 2020 2020 2020 2020 2069 6e64 6578 6573           indexes
-000292f0: 203d 207b 7d0a 2020 2020 2020 2020 2020   = {}.          
-00029300: 2020 666f 7220 6e61 6d65 2c20 6964 7820    for name, idx 
-00029310: 696e 2073 656c 662e 5f69 6e64 6578 6573  in self._indexes
-00029320: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-00029330: 2020 2020 2020 2020 2020 6966 206e 616d            if nam
-00029340: 6520 6e6f 7420 696e 2063 6f6f 7264 5f6e  e not in coord_n
-00029350: 616d 6573 3a0a 2020 2020 2020 2020 2020  ames:.          
-00029360: 2020 2020 2020 2020 2020 696e 6465 7865            indexe
-00029370: 735b 6e61 6d65 5d20 3d20 6964 780a 0a20  s[name] = idx.. 
-00029380: 2020 2020 2020 2020 2020 2066 6f72 206e             for n
-00029390: 616d 6520 696e 2063 6f6f 7264 5f6e 616d  ame in coord_nam
-000293a0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-000293b0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-000293c0: 2020 2020 2020 2020 2020 2020 2076 6172               var
-000293d0: 6961 626c 6573 5b6e 616d 655d 203d 206e  iables[name] = n
-000293e0: 6577 5f63 6f6f 7264 5f76 6172 735b 6e61  ew_coord_vars[na
-000293f0: 6d65 5d0a 2020 2020 2020 2020 2020 2020  me].            
-00029400: 2020 2020 6578 6365 7074 204b 6579 4572      except KeyEr
-00029410: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
-00029420: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
-00029430: 6573 5b6e 616d 655d 203d 2073 656c 662e  es[name] = self.
-00029440: 5f76 6172 6961 626c 6573 5b6e 616d 655d  _variables[name]
-00029450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00029460: 2069 6e64 6578 6573 5b6e 616d 655d 203d   indexes[name] =
-00029470: 2069 6e64 6578 0a0a 2020 2020 2020 2020   index..        
-00029480: 7265 7475 726e 2073 656c 662e 5f72 6570  return self._rep
-00029490: 6c61 6365 280a 2020 2020 2020 2020 2020  lace(.          
-000294a0: 2020 7661 7269 6162 6c65 733d 7661 7269    variables=vari
-000294b0: 6162 6c65 732c 0a20 2020 2020 2020 2020  ables,.         
-000294c0: 2020 2063 6f6f 7264 5f6e 616d 6573 3d73     coord_names=s
-000294d0: 656c 662e 5f63 6f6f 7264 5f6e 616d 6573  elf._coord_names
-000294e0: 207c 2073 6574 2863 6f6f 7264 5f6e 616d   | set(coord_nam
-000294f0: 6573 292c 0a20 2020 2020 2020 2020 2020  es),.           
-00029500: 2069 6e64 6578 6573 3d69 6e64 6578 6573   indexes=indexes
-00029510: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00029520: 2064 6566 2072 656f 7264 6572 5f6c 6576   def reorder_lev
-00029530: 656c 7328 0a20 2020 2020 2020 2073 656c  els(.        sel
-00029540: 663a 2054 5f44 6174 6173 6574 2c0a 2020  f: T_Dataset,.  
-00029550: 2020 2020 2020 6469 6d5f 6f72 6465 723a        dim_order:
-00029560: 204d 6170 7069 6e67 5b41 6e79 2c20 5365   Mapping[Any, Se
-00029570: 7175 656e 6365 5b69 6e74 207c 2048 6173  quence[int | Has
-00029580: 6861 626c 655d 5d20 7c20 4e6f 6e65 203d  hable]] | None =
-00029590: 204e 6f6e 652c 0a20 2020 2020 2020 202a   None,.        *
-000295a0: 2a64 696d 5f6f 7264 6572 5f6b 7761 7267  *dim_order_kwarg
-000295b0: 733a 2053 6571 7565 6e63 655b 696e 7420  s: Sequence[int 
-000295c0: 7c20 4861 7368 6162 6c65 5d2c 0a20 2020  | Hashable],.   
-000295d0: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
-000295e0: 0a20 2020 2020 2020 2022 2222 5265 6172  .        """Rear
-000295f0: 7261 6e67 6520 696e 6465 7820 6c65 7665  range index leve
-00029600: 6c73 2075 7369 6e67 2069 6e70 7574 206f  ls using input o
-00029610: 7264 6572 2e0a 0a20 2020 2020 2020 2050  rder...        P
-00029620: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00029630: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00029640: 2020 2020 2064 696d 5f6f 7264 6572 203a       dim_order :
-00029650: 2064 6963 742d 6c69 6b65 206f 6620 4861   dict-like of Ha
-00029660: 7368 6162 6c65 2074 6f20 5365 7175 656e  shable to Sequen
-00029670: 6365 206f 6620 696e 7420 6f72 2048 6173  ce of int or Has
-00029680: 6861 626c 652c 206f 7074 696f 6e61 6c0a  hable, optional.
-00029690: 2020 2020 2020 2020 2020 2020 4d61 7070              Mapp
-000296a0: 696e 6720 6672 6f6d 206e 616d 6573 206d  ing from names m
-000296b0: 6174 6368 696e 6720 6469 6d65 6e73 696f  atching dimensio
-000296c0: 6e73 2061 6e64 2076 616c 7565 7320 6769  ns and values gi
-000296d0: 7665 6e0a 2020 2020 2020 2020 2020 2020  ven.            
-000296e0: 6279 206c 6973 7473 2072 6570 7265 7365  by lists represe
-000296f0: 6e74 696e 6720 6e65 7720 6c65 7665 6c20  nting new level 
-00029700: 6f72 6465 7273 2e20 4576 6572 7920 6769  orders. Every gi
-00029710: 7665 6e20 6469 6d65 6e73 696f 6e0a 2020  ven dimension.  
-00029720: 2020 2020 2020 2020 2020 6d75 7374 2068            must h
-00029730: 6176 6520 6120 6d75 6c74 692d 696e 6465  ave a multi-inde
-00029740: 782e 0a20 2020 2020 2020 202a 2a64 696d  x..        **dim
-00029750: 5f6f 7264 6572 5f6b 7761 7267 7320 3a20  _order_kwargs : 
-00029760: 5365 7175 656e 6365 206f 6620 696e 7420  Sequence of int 
-00029770: 6f72 2048 6173 6861 626c 652c 206f 7074  or Hashable, opt
-00029780: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00029790: 2020 5468 6520 6b65 7977 6f72 6420 6172    The keyword ar
-000297a0: 6775 6d65 6e74 7320 666f 726d 206f 6620  guments form of 
-000297b0: 6060 6469 6d5f 6f72 6465 7260 602e 0a20  ``dim_order``.. 
-000297c0: 2020 2020 2020 2020 2020 204f 6e65 206f             One o
-000297d0: 6620 6469 6d5f 6f72 6465 7220 6f72 2064  f dim_order or d
-000297e0: 696d 5f6f 7264 6572 5f6b 7761 7267 7320  im_order_kwargs 
-000297f0: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
-00029800: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00029810: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-00029820: 2d2d 0a20 2020 2020 2020 206f 626a 203a  --.        obj :
-00029830: 2044 6174 6173 6574 0a20 2020 2020 2020   Dataset.       
-00029840: 2020 2020 2041 6e6f 7468 6572 2064 6174       Another dat
-00029850: 6173 6574 2c20 7769 7468 2074 6869 7320  aset, with this 
-00029860: 6461 7461 7365 7427 7320 6461 7461 2062  dataset's data b
-00029870: 7574 2072 6570 6c61 6365 640a 2020 2020  ut replaced.    
-00029880: 2020 2020 2020 2020 636f 6f72 6469 6e61          coordina
-00029890: 7465 732e 0a20 2020 2020 2020 2022 2222  tes..        """
-000298a0: 0a20 2020 2020 2020 2064 696d 5f6f 7264  .        dim_ord
-000298b0: 6572 203d 2065 6974 6865 725f 6469 6374  er = either_dict
-000298c0: 5f6f 725f 6b77 6172 6773 2864 696d 5f6f  _or_kwargs(dim_o
-000298d0: 7264 6572 2c20 6469 6d5f 6f72 6465 725f  rder, dim_order_
-000298e0: 6b77 6172 6773 2c20 2272 656f 7264 6572  kwargs, "reorder
-000298f0: 5f6c 6576 656c 7322 290a 2020 2020 2020  _levels").      
-00029900: 2020 7661 7269 6162 6c65 7320 3d20 7365    variables = se
-00029910: 6c66 2e5f 7661 7269 6162 6c65 732e 636f  lf._variables.co
-00029920: 7079 2829 0a20 2020 2020 2020 2069 6e64  py().        ind
-00029930: 6578 6573 203d 2064 6963 7428 7365 6c66  exes = dict(self
-00029940: 2e5f 696e 6465 7865 7329 0a20 2020 2020  ._indexes).     
-00029950: 2020 206e 6577 5f69 6e64 6578 6573 3a20     new_indexes: 
-00029960: 6469 6374 5b48 6173 6861 626c 652c 2049  dict[Hashable, I
-00029970: 6e64 6578 5d20 3d20 7b7d 0a20 2020 2020  ndex] = {}.     
-00029980: 2020 206e 6577 5f76 6172 6961 626c 6573     new_variables
-00029990: 3a20 6469 6374 5b48 6173 6861 626c 652c  : dict[Hashable,
-000299a0: 2049 6e64 6578 5661 7269 6162 6c65 5d20   IndexVariable] 
-000299b0: 3d20 7b7d 0a0a 2020 2020 2020 2020 666f  = {}..        fo
-000299c0: 7220 6469 6d2c 206f 7264 6572 2069 6e20  r dim, order in 
-000299d0: 6469 6d5f 6f72 6465 722e 6974 656d 7328  dim_order.items(
-000299e0: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-000299f0: 6e64 6578 203d 2073 656c 662e 5f69 6e64  ndex = self._ind
-00029a00: 6578 6573 5b64 696d 5d0a 0a20 2020 2020  exes[dim]..     
-00029a10: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
-00029a20: 696e 7374 616e 6365 2869 6e64 6578 2c20  instance(index, 
-00029a30: 5061 6e64 6173 4d75 6c74 6949 6e64 6578  PandasMultiIndex
-00029a40: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00029a50: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00029a60: 726f 7228 6622 636f 6f72 6469 6e61 7465  ror(f"coordinate
-00029a70: 207b 6469 6d7d 2068 6173 206e 6f20 4d75   {dim} has no Mu
-00029a80: 6c74 6949 6e64 6578 2229 0a0a 2020 2020  ltiIndex")..    
-00029a90: 2020 2020 2020 2020 6c65 7665 6c5f 7661          level_va
-00029aa0: 7273 203d 207b 6b3a 2073 656c 662e 5f76  rs = {k: self._v
-00029ab0: 6172 6961 626c 6573 5b6b 5d20 666f 7220  ariables[k] for 
-00029ac0: 6b20 696e 206f 7264 6572 7d0a 2020 2020  k in order}.    
-00029ad0: 2020 2020 2020 2020 6964 7820 3d20 696e          idx = in
-00029ae0: 6465 782e 7265 6f72 6465 725f 6c65 7665  dex.reorder_leve
-00029af0: 6c73 286c 6576 656c 5f76 6172 7329 0a20  ls(level_vars). 
-00029b00: 2020 2020 2020 2020 2020 2069 6478 5f76             idx_v
-00029b10: 6172 7320 3d20 6964 782e 6372 6561 7465  ars = idx.create
-00029b20: 5f76 6172 6961 626c 6573 286c 6576 656c  _variables(level
-00029b30: 5f76 6172 7329 0a20 2020 2020 2020 2020  _vars).         
-00029b40: 2020 206e 6577 5f69 6e64 6578 6573 2e75     new_indexes.u
-00029b50: 7064 6174 6528 7b6b 3a20 6964 7820 666f  pdate({k: idx fo
-00029b60: 7220 6b20 696e 2069 6478 5f76 6172 737d  r k in idx_vars}
-00029b70: 290a 2020 2020 2020 2020 2020 2020 6e65  ).            ne
-00029b80: 775f 7661 7269 6162 6c65 732e 7570 6461  w_variables.upda
-00029b90: 7465 2869 6478 5f76 6172 7329 0a0a 2020  te(idx_vars)..  
-00029ba0: 2020 2020 2020 696e 6465 7865 7320 3d20        indexes = 
-00029bb0: 7b6b 3a20 7620 666f 7220 6b2c 2076 2069  {k: v for k, v i
-00029bc0: 6e20 7365 6c66 2e5f 696e 6465 7865 732e  n self._indexes.
-00029bd0: 6974 656d 7328 2920 6966 206b 206e 6f74  items() if k not
-00029be0: 2069 6e20 6e65 775f 696e 6465 7865 737d   in new_indexes}
-00029bf0: 0a20 2020 2020 2020 2069 6e64 6578 6573  .        indexes
-00029c00: 2e75 7064 6174 6528 6e65 775f 696e 6465  .update(new_inde
-00029c10: 7865 7329 0a0a 2020 2020 2020 2020 7661  xes)..        va
-00029c20: 7269 6162 6c65 7320 3d20 7b6b 3a20 7620  riables = {k: v 
-00029c30: 666f 7220 6b2c 2076 2069 6e20 7365 6c66  for k, v in self
-00029c40: 2e5f 7661 7269 6162 6c65 732e 6974 656d  ._variables.item
-00029c50: 7328 2920 6966 206b 206e 6f74 2069 6e20  s() if k not in 
-00029c60: 6e65 775f 7661 7269 6162 6c65 737d 0a20  new_variables}. 
-00029c70: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-00029c80: 2e75 7064 6174 6528 6e65 775f 7661 7269  .update(new_vari
-00029c90: 6162 6c65 7329 0a0a 2020 2020 2020 2020  ables)..        
-00029ca0: 7265 7475 726e 2073 656c 662e 5f72 6570  return self._rep
-00029cb0: 6c61 6365 2876 6172 6961 626c 6573 2c20  lace(variables, 
-00029cc0: 696e 6465 7865 733d 696e 6465 7865 7329  indexes=indexes)
-00029cd0: 0a0a 2020 2020 6465 6620 5f67 6574 5f73  ..    def _get_s
-00029ce0: 7461 636b 5f69 6e64 6578 280a 2020 2020  tack_index(.    
-00029cf0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00029d00: 2020 6469 6d2c 0a20 2020 2020 2020 206d    dim,.        m
-00029d10: 756c 7469 3d46 616c 7365 2c0a 2020 2020  ulti=False,.    
-00029d20: 2020 2020 6372 6561 7465 5f69 6e64 6578      create_index
-00029d30: 3d46 616c 7365 2c0a 2020 2020 2920 2d3e  =False,.    ) ->
-00029d40: 2074 7570 6c65 5b49 6e64 6578 207c 204e   tuple[Index | N
-00029d50: 6f6e 652c 2064 6963 745b 4861 7368 6162  one, dict[Hashab
-00029d60: 6c65 2c20 5661 7269 6162 6c65 5d5d 3a0a  le, Variable]]:.
-00029d70: 2020 2020 2020 2020 2222 2255 7365 6420          """Used 
-00029d80: 6279 2073 7461 636b 2061 6e64 2075 6e73  by stack and uns
-00029d90: 7461 636b 2074 6f20 6765 7420 6f6e 6520  tack to get one 
-00029da0: 7061 6e64 6173 2028 6d75 6c74 692d 2969  pandas (multi-)i
-00029db0: 6e64 6578 2061 6d6f 6e67 0a20 2020 2020  ndex among.     
-00029dc0: 2020 2074 6865 2069 6e64 6578 6564 2063     the indexed c
-00029dd0: 6f6f 7264 696e 6174 6573 2061 6c6f 6e67  oordinates along
-00029de0: 2064 696d 656e 7369 6f6e 2060 6469 6d60   dimension `dim`
-00029df0: 2e0a 0a20 2020 2020 2020 2049 6620 6578  ...        If ex
-00029e00: 6163 746c 7920 6f6e 6520 696e 6465 7820  actly one index 
-00029e10: 6973 2066 6f75 6e64 2c20 7265 7475 726e  is found, return
-00029e20: 2069 7420 7769 7468 2069 7473 2063 6f72   it with its cor
-00029e30: 7265 7370 6f6e 6469 6e67 0a20 2020 2020  responding.     
-00029e40: 2020 2063 6f6f 7264 696e 6174 6520 7661     coordinate va
-00029e50: 7269 6162 6c65 7328 7329 2c20 6f74 6865  riables(s), othe
-00029e60: 7277 6973 6520 7265 7475 726e 204e 6f6e  rwise return Non
-00029e70: 6520 616e 6420 616e 2065 6d70 7479 2064  e and an empty d
-00029e80: 6963 742e 0a0a 2020 2020 2020 2020 4966  ict...        If
-00029e90: 2060 6372 6561 7465 5f69 6e64 6578 3d54   `create_index=T
-00029ea0: 7275 6560 2c20 6372 6561 7465 2061 206e  rue`, create a n
-00029eb0: 6577 2069 6e64 6578 2069 6620 6e6f 6e65  ew index if none
-00029ec0: 2069 7320 666f 756e 6420 6f72 2072 6169   is found or rai
-00029ed0: 7365 0a20 2020 2020 2020 2061 6e20 6572  se.        an er
-00029ee0: 726f 7220 6966 206d 756c 7469 706c 6520  ror if multiple 
-00029ef0: 696e 6465 7865 7320 6172 6520 666f 756e  indexes are foun
-00029f00: 642e 0a0a 2020 2020 2020 2020 2222 220a  d...        """.
-00029f10: 2020 2020 2020 2020 7374 6163 6b5f 696e          stack_in
-00029f20: 6465 783a 2049 6e64 6578 207c 204e 6f6e  dex: Index | Non
-00029f30: 6520 3d20 4e6f 6e65 0a20 2020 2020 2020  e = None.       
-00029f40: 2073 7461 636b 5f63 6f6f 7264 733a 2064   stack_coords: d
-00029f50: 6963 745b 4861 7368 6162 6c65 2c20 5661  ict[Hashable, Va
-00029f60: 7269 6162 6c65 5d20 3d20 7b7d 0a0a 2020  riable] = {}..  
-00029f70: 2020 2020 2020 666f 7220 6e61 6d65 2c20        for name, 
-00029f80: 696e 6465 7820 696e 2073 656c 662e 5f69  index in self._i
-00029f90: 6e64 6578 6573 2e69 7465 6d73 2829 3a0a  ndexes.items():.
-00029fa0: 2020 2020 2020 2020 2020 2020 7661 7220              var 
-00029fb0: 3d20 7365 6c66 2e5f 7661 7269 6162 6c65  = self._variable
-00029fc0: 735b 6e61 6d65 5d0a 2020 2020 2020 2020  s[name].        
-00029fd0: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
-00029fe0: 2020 2020 2020 2020 2076 6172 2e6e 6469           var.ndi
-00029ff0: 6d20 3d3d 2031 0a20 2020 2020 2020 2020  m == 1.         
-0002a000: 2020 2020 2020 2061 6e64 2076 6172 2e64         and var.d
-0002a010: 696d 735b 305d 203d 3d20 6469 6d0a 2020  ims[0] == dim.  
-0002a020: 2020 2020 2020 2020 2020 2020 2020 616e                an
-0002a030: 6420 280a 2020 2020 2020 2020 2020 2020  d (.            
-0002a040: 2020 2020 2020 2020 2320 7374 6163 6b3a          # stack:
-0002a050: 206d 7573 7420 6265 2061 2073 696e 676c   must be a singl
-0002a060: 6520 636f 6f72 6469 6e61 7465 2069 6e64  e coordinate ind
-0002a070: 6578 0a20 2020 2020 2020 2020 2020 2020  ex.             
-0002a080: 2020 2020 2020 206e 6f74 206d 756c 7469         not multi
-0002a090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a0a0: 2020 2020 2061 6e64 206e 6f74 2073 656c       and not sel
-0002a0b0: 662e 7869 6e64 6578 6573 2e69 735f 6d75  f.xindexes.is_mu
-0002a0c0: 6c74 6928 6e61 6d65 290a 2020 2020 2020  lti(name).      
-0002a0d0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0002a0e0: 756e 7374 6163 6b3a 206d 7573 7420 6265  unstack: must be
-0002a0f0: 2061 6e20 696e 6465 7820 7468 6174 2069   an index that i
-0002a100: 6d70 6c65 6d65 6e74 7320 2e75 6e73 7461  mplements .unsta
-0002a110: 636b 0a20 2020 2020 2020 2020 2020 2020  ck.             
-0002a120: 2020 2020 2020 206f 7220 6d75 6c74 690a         or multi.
-0002a130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a140: 2020 2020 616e 6420 7479 7065 2869 6e64      and type(ind
-0002a150: 6578 292e 756e 7374 6163 6b20 6973 206e  ex).unstack is n
-0002a160: 6f74 2049 6e64 6578 2e75 6e73 7461 636b  ot Index.unstack
-0002a170: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a180: 2029 0a20 2020 2020 2020 2020 2020 2029   ).            )
-0002a190: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002a1a0: 2020 6966 2073 7461 636b 5f69 6e64 6578    if stack_index
-0002a1b0: 2069 7320 6e6f 7420 4e6f 6e65 2061 6e64   is not None and
-0002a1c0: 2069 6e64 6578 2069 7320 6e6f 7420 7374   index is not st
-0002a1d0: 6163 6b5f 696e 6465 783a 0a20 2020 2020  ack_index:.     
-0002a1e0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0002a1f0: 206d 6f72 6520 7468 616e 206f 6e65 2069   more than one i
-0002a200: 6e64 6578 2066 6f75 6e64 2c20 7374 6f70  ndex found, stop
-0002a210: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002a220: 2020 2020 2069 6620 6372 6561 7465 5f69       if create_i
-0002a230: 6e64 6578 3a0a 2020 2020 2020 2020 2020  ndex:.          
-0002a240: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0002a250: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-0002a260: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a270: 2020 2020 2020 2020 2020 2020 6622 6361              f"ca
-0002a280: 6e6e 6f74 2073 7461 636b 2064 696d 656e  nnot stack dimen
-0002a290: 7369 6f6e 207b 6469 6d21 727d 2077 6974  sion {dim!r} wit
-0002a2a0: 6820 6063 7265 6174 655f 696e 6465 783d  h `create_index=
-0002a2b0: 5472 7565 6020 220a 2020 2020 2020 2020  True` ".        
-0002a2c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a2d0: 2020 2020 2261 6e64 2077 6974 6820 6d6f      "and with mo
-0002a2e0: 7265 2074 6861 6e20 6f6e 6520 696e 6465  re than one inde
-0002a2f0: 7820 666f 756e 6420 616c 6f6e 6720 7468  x found along th
-0002a300: 6174 2064 696d 656e 7369 6f6e 220a 2020  at dimension".  
-0002a310: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a320: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0002a330: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-0002a340: 726e 204e 6f6e 652c 207b 7d0a 2020 2020  rn None, {}.    
-0002a350: 2020 2020 2020 2020 2020 2020 7374 6163              stac
-0002a360: 6b5f 696e 6465 7820 3d20 696e 6465 780a  k_index = index.
+00028660: 616d 6573 3a20 7374 7220 7c20 5365 7175  ames: str | Sequ
+00028670: 656e 6365 5b48 6173 6861 626c 655d 2c0a  ence[Hashable],.
+00028680: 2020 2020 2020 2020 696e 6465 785f 636c          index_cl
+00028690: 733a 2074 7970 655b 496e 6465 785d 207c  s: type[Index] |
+000286a0: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+000286b0: 2020 2020 2020 2a2a 6f70 7469 6f6e 732c        **options,
+000286c0: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
+000286d0: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+000286e0: 5365 7420 6120 6e65 772c 2058 6172 7261  Set a new, Xarra
+000286f0: 792d 636f 6d70 6174 6962 6c65 2069 6e64  y-compatible ind
+00028700: 6578 2066 726f 6d20 6f6e 6520 6f72 206d  ex from one or m
+00028710: 6f72 6520 6578 6973 7469 6e67 0a20 2020  ore existing.   
+00028720: 2020 2020 2063 6f6f 7264 696e 6174 6528       coordinate(
+00028730: 7329 2e0a 0a20 2020 2020 2020 2050 6172  s)...        Par
+00028740: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00028750: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00028760: 2020 2063 6f6f 7264 5f6e 616d 6573 203a     coord_names :
+00028770: 2073 7472 206f 7220 6c69 7374 0a20 2020   str or list.   
+00028780: 2020 2020 2020 2020 204e 616d 6528 7329           Name(s)
+00028790: 206f 6620 7468 6520 636f 6f72 6469 6e61   of the coordina
+000287a0: 7465 2873 2920 7573 6564 2074 6f20 6275  te(s) used to bu
+000287b0: 696c 6420 7468 6520 696e 6465 782e 0a20  ild the index.. 
+000287c0: 2020 2020 2020 2020 2020 2049 6620 7365             If se
+000287d0: 7665 7261 6c20 6e61 6d65 7320 6172 6520  veral names are 
+000287e0: 6769 7665 6e2c 2074 6865 6972 206f 7264  given, their ord
+000287f0: 6572 206d 6174 7465 7273 2e0a 2020 2020  er matters..    
+00028800: 2020 2020 696e 6465 785f 636c 7320 3a20      index_cls : 
+00028810: 7375 6263 6c61 7373 206f 6620 3a63 6c61  subclass of :cla
+00028820: 7373 3a60 7e78 6172 7261 792e 696e 6465  ss:`~xarray.inde
+00028830: 7865 732e 496e 6465 7860 2c20 6f70 7469  xes.Index`, opti
+00028840: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00028850: 2054 6865 2074 7970 6520 6f66 2069 6e64   The type of ind
+00028860: 6578 2074 6f20 6372 6561 7465 2e20 4279  ex to create. By
+00028870: 2064 6566 6175 6c74 2c20 7472 7920 7365   default, try se
+00028880: 7474 696e 670a 2020 2020 2020 2020 2020  tting.          
+00028890: 2020 6120 6060 5061 6e64 6173 496e 6465    a ``PandasInde
+000288a0: 7860 6020 6966 2060 606c 656e 2863 6f6f  x`` if ``len(coo
+000288b0: 7264 5f6e 616d 6573 2920 3d3d 2031 6060  rd_names) == 1``
+000288c0: 2c0a 2020 2020 2020 2020 2020 2020 6f74  ,.            ot
+000288d0: 6865 7277 6973 6520 6120 6060 5061 6e64  herwise a ``Pand
+000288e0: 6173 4d75 6c74 6949 6e64 6578 6060 2e0a  asMultiIndex``..
+000288f0: 2020 2020 2020 2020 2a2a 6f70 7469 6f6e          **option
+00028900: 730a 2020 2020 2020 2020 2020 2020 4f70  s.            Op
+00028910: 7469 6f6e 7320 7061 7373 6564 2074 6f20  tions passed to 
+00028920: 7468 6520 696e 6465 7820 636f 6e73 7472  the index constr
+00028930: 7563 746f 722e 0a0a 2020 2020 2020 2020  uctor...        
+00028940: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00028950: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00028960: 6f62 6a20 3a20 4461 7461 7365 740a 2020  obj : Dataset.  
+00028970: 2020 2020 2020 2020 2020 416e 6f74 6865            Anothe
+00028980: 7220 6461 7461 7365 742c 2077 6974 6820  r dataset, with 
+00028990: 7468 6973 2064 6174 6173 6574 2773 2064  this dataset's d
+000289a0: 6174 6120 616e 6420 7769 7468 2061 206e  ata and with a n
+000289b0: 6577 2069 6e64 6578 2e0a 0a20 2020 2020  ew index...     
+000289c0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
+000289d0: 2074 6865 2053 6571 7565 6e63 6520 6368   the Sequence ch
+000289e0: 6563 6b20 6973 2072 6571 7569 7265 6420  eck is required 
+000289f0: 666f 7220 6d79 7079 0a20 2020 2020 2020  for mypy.       
+00028a00: 2069 6620 6973 5f73 6361 6c61 7228 636f   if is_scalar(co
+00028a10: 6f72 645f 6e61 6d65 7329 206f 7220 6e6f  ord_names) or no
+00028a20: 7420 6973 696e 7374 616e 6365 2863 6f6f  t isinstance(coo
+00028a30: 7264 5f6e 616d 6573 2c20 5365 7175 656e  rd_names, Sequen
+00028a40: 6365 293a 0a20 2020 2020 2020 2020 2020  ce):.           
+00028a50: 2063 6f6f 7264 5f6e 616d 6573 203d 205b   coord_names = [
+00028a60: 636f 6f72 645f 6e61 6d65 735d 0a0a 2020  coord_names]..  
+00028a70: 2020 2020 2020 6966 2069 6e64 6578 5f63        if index_c
+00028a80: 6c73 2069 7320 4e6f 6e65 3a0a 2020 2020  ls is None:.    
+00028a90: 2020 2020 2020 2020 6966 206c 656e 2863          if len(c
+00028aa0: 6f6f 7264 5f6e 616d 6573 2920 3d3d 2031  oord_names) == 1
+00028ab0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00028ac0: 2020 696e 6465 785f 636c 7320 3d20 5061    index_cls = Pa
+00028ad0: 6e64 6173 496e 6465 780a 2020 2020 2020  ndasIndex.      
+00028ae0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00028af0: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+00028b00: 785f 636c 7320 3d20 5061 6e64 6173 4d75  x_cls = PandasMu
+00028b10: 6c74 6949 6e64 6578 0a20 2020 2020 2020  ltiIndex.       
+00028b20: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00028b30: 2020 2069 6620 6e6f 7420 6973 7375 6263     if not issubc
+00028b40: 6c61 7373 2869 6e64 6578 5f63 6c73 2c20  lass(index_cls, 
+00028b50: 496e 6465 7829 3a0a 2020 2020 2020 2020  Index):.        
+00028b60: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00028b70: 7065 4572 726f 7228 6622 7b69 6e64 6578  peError(f"{index
+00028b80: 5f63 6c73 7d20 6973 206e 6f74 2061 2073  _cls} is not a s
+00028b90: 7562 636c 6173 7320 6f66 2078 6172 7261  ubclass of xarra
+00028ba0: 792e 496e 6465 7822 290a 0a20 2020 2020  y.Index")..     
+00028bb0: 2020 2069 6e76 616c 6964 5f63 6f6f 7264     invalid_coord
+00028bc0: 7320 3d20 7365 7428 636f 6f72 645f 6e61  s = set(coord_na
+00028bd0: 6d65 7329 202d 2073 656c 662e 5f63 6f6f  mes) - self._coo
+00028be0: 7264 5f6e 616d 6573 0a0a 2020 2020 2020  rd_names..      
+00028bf0: 2020 6966 2069 6e76 616c 6964 5f63 6f6f    if invalid_coo
+00028c00: 7264 733a 0a20 2020 2020 2020 2020 2020  rds:.           
+00028c10: 206d 7367 203d 205b 2269 6e76 616c 6964   msg = ["invalid
+00028c20: 2063 6f6f 7264 696e 6174 6528 7329 225d   coordinate(s)"]
+00028c30: 0a20 2020 2020 2020 2020 2020 206e 6f5f  .            no_
+00028c40: 7661 7273 203d 2069 6e76 616c 6964 5f63  vars = invalid_c
+00028c50: 6f6f 7264 7320 2d20 7365 7428 7365 6c66  oords - set(self
+00028c60: 2e5f 7661 7269 6162 6c65 7329 0a20 2020  ._variables).   
+00028c70: 2020 2020 2020 2020 2064 6174 615f 7661           data_va
+00028c80: 7273 203d 2069 6e76 616c 6964 5f63 6f6f  rs = invalid_coo
+00028c90: 7264 7320 2d20 6e6f 5f76 6172 730a 2020  rds - no_vars.  
+00028ca0: 2020 2020 2020 2020 2020 6966 206e 6f5f            if no_
+00028cb0: 7661 7273 3a0a 2020 2020 2020 2020 2020  vars:.          
+00028cc0: 2020 2020 2020 6d73 672e 6170 7065 6e64        msg.append
+00028cd0: 2866 2274 686f 7365 2076 6172 6961 626c  (f"those variabl
+00028ce0: 6573 2064 6f6e 2774 2065 7869 7374 3a20  es don't exist: 
+00028cf0: 7b6e 6f5f 7661 7273 7d22 290a 2020 2020  {no_vars}").    
+00028d00: 2020 2020 2020 2020 6966 2064 6174 615f          if data_
+00028d10: 7661 7273 3a0a 2020 2020 2020 2020 2020  vars:.          
+00028d20: 2020 2020 2020 6d73 672e 6170 7065 6e64        msg.append
+00028d30: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00028d40: 2020 2020 2020 6622 7468 6f73 6520 7661        f"those va
+00028d50: 7269 6162 6c65 7320 6172 6520 6461 7461  riables are data
+00028d60: 2076 6172 6961 626c 6573 3a20 7b64 6174   variables: {dat
+00028d70: 615f 7661 7273 7d2c 2075 7365 2060 7365  a_vars}, use `se
+00028d80: 745f 636f 6f72 6473 6020 6669 7273 7422  t_coords` first"
+00028d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00028da0: 2029 0a20 2020 2020 2020 2020 2020 2072   ).            r
+00028db0: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00028dc0: 225c 6e22 2e6a 6f69 6e28 6d73 6729 290a  "\n".join(msg)).
+00028dd0: 0a20 2020 2020 2020 2023 2077 6520 636f  .        # we co
+00028de0: 756c 6420 6265 206d 6f72 6520 636c 6576  uld be more clev
+00028df0: 6572 2068 6572 6520 2865 2e67 2e2c 2064  er here (e.g., d
+00028e00: 726f 702d 696e 2069 6e64 6578 2072 6570  rop-in index rep
+00028e10: 6c61 6365 6d65 6e74 2069 6620 696e 6465  lacement if inde
+00028e20: 780a 2020 2020 2020 2020 2320 636f 6f72  x.        # coor
+00028e30: 6469 6e61 7465 7320 646f 206e 6f74 2063  dinates do not c
+00028e40: 6f6e 666c 6963 7429 2c20 6275 7420 6c65  onflict), but le
+00028e50: 7427 7320 6e6f 7420 616c 6c6f 7720 7468  t's not allow th
+00028e60: 6973 2066 6f72 206e 6f77 0a20 2020 2020  is for now.     
+00028e70: 2020 2069 6e64 6578 6564 5f63 6f6f 7264     indexed_coord
+00028e80: 7320 3d20 7365 7428 636f 6f72 645f 6e61  s = set(coord_na
+00028e90: 6d65 7329 2026 2073 6574 2873 656c 662e  mes) & set(self.
+00028ea0: 5f69 6e64 6578 6573 290a 0a20 2020 2020  _indexes)..     
+00028eb0: 2020 2069 6620 696e 6465 7865 645f 636f     if indexed_co
+00028ec0: 6f72 6473 3a0a 2020 2020 2020 2020 2020  ords:.          
+00028ed0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00028ee0: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00028ef0: 2020 2020 6622 7468 6f73 6520 636f 6f72      f"those coor
+00028f00: 6469 6e61 7465 7320 616c 7265 6164 7920  dinates already 
+00028f10: 6861 7665 2061 6e20 696e 6465 783a 207b  have an index: {
+00028f20: 696e 6465 7865 645f 636f 6f72 6473 7d22  indexed_coords}"
+00028f30: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00028f40: 2020 2020 2020 2020 636f 6f72 645f 7661          coord_va
+00028f50: 7273 203d 207b 6e61 6d65 3a20 7365 6c66  rs = {name: self
+00028f60: 2e5f 7661 7269 6162 6c65 735b 6e61 6d65  ._variables[name
+00028f70: 5d20 666f 7220 6e61 6d65 2069 6e20 636f  ] for name in co
+00028f80: 6f72 645f 6e61 6d65 737d 0a0a 2020 2020  ord_names}..    
+00028f90: 2020 2020 696e 6465 7820 3d20 696e 6465      index = inde
+00028fa0: 785f 636c 732e 6672 6f6d 5f76 6172 6961  x_cls.from_varia
+00028fb0: 626c 6573 2863 6f6f 7264 5f76 6172 732c  bles(coord_vars,
+00028fc0: 206f 7074 696f 6e73 3d6f 7074 696f 6e73   options=options
+00028fd0: 290a 0a20 2020 2020 2020 206e 6577 5f63  )..        new_c
+00028fe0: 6f6f 7264 5f76 6172 7320 3d20 696e 6465  oord_vars = inde
+00028ff0: 782e 6372 6561 7465 5f76 6172 6961 626c  x.create_variabl
+00029000: 6573 2863 6f6f 7264 5f76 6172 7329 0a0a  es(coord_vars)..
+00029010: 2020 2020 2020 2020 2320 7370 6563 6961          # specia
+00029020: 6c20 6361 7365 2066 6f72 2073 6574 7469  l case for setti
+00029030: 6e67 2061 2070 616e 6461 7320 6d75 6c74  ng a pandas mult
+00029040: 692d 696e 6465 7820 6672 6f6d 206c 6576  i-index from lev
+00029050: 656c 2063 6f6f 7264 696e 6174 6573 0a20  el coordinates. 
+00029060: 2020 2020 2020 2023 2054 4f44 4f3a 2072         # TODO: r
+00029070: 656d 6f76 6520 6974 206f 6e63 6520 7765  emove it once we
+00029080: 2064 6570 7265 6369 6174 6520 7061 6e64   depreciate pand
+00029090: 6173 206d 756c 7469 2d69 6e64 6578 2064  as multi-index d
+000290a0: 696d 656e 7369 6f6e 2028 7475 706c 650a  imension (tuple.
+000290b0: 2020 2020 2020 2020 2320 656c 656d 656e          # elemen
+000290c0: 7473 2920 636f 6f72 6469 6e61 7465 0a20  ts) coordinate. 
+000290d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000290e0: 616e 6365 2869 6e64 6578 2c20 5061 6e64  ance(index, Pand
+000290f0: 6173 4d75 6c74 6949 6e64 6578 293a 0a20  asMultiIndex):. 
+00029100: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
+00029110: 5f6e 616d 6573 203d 205b 696e 6465 782e  _names = [index.
+00029120: 6469 6d5d 202b 206c 6973 7428 636f 6f72  dim] + list(coor
+00029130: 645f 6e61 6d65 7329 0a0a 2020 2020 2020  d_names)..      
+00029140: 2020 7661 7269 6162 6c65 733a 2064 6963    variables: dic
+00029150: 745b 4861 7368 6162 6c65 2c20 5661 7269  t[Hashable, Vari
+00029160: 6162 6c65 5d0a 2020 2020 2020 2020 696e  able].        in
+00029170: 6465 7865 733a 2064 6963 745b 4861 7368  dexes: dict[Hash
+00029180: 6162 6c65 2c20 496e 6465 785d 0a0a 2020  able, Index]..  
+00029190: 2020 2020 2020 6966 206c 656e 2863 6f6f        if len(coo
+000291a0: 7264 5f6e 616d 6573 2920 3d3d 2031 3a0a  rd_names) == 1:.
+000291b0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+000291c0: 6162 6c65 7320 3d20 7365 6c66 2e5f 7661  ables = self._va
+000291d0: 7269 6162 6c65 732e 636f 7079 2829 0a20  riables.copy(). 
+000291e0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+000291f0: 6573 203d 2073 656c 662e 5f69 6e64 6578  es = self._index
+00029200: 6573 2e63 6f70 7928 290a 0a20 2020 2020  es.copy()..     
+00029210: 2020 2020 2020 206e 616d 6520 3d20 6c69         name = li
+00029220: 7374 2863 6f6f 7264 5f6e 616d 6573 292e  st(coord_names).
+00029230: 706f 7028 290a 2020 2020 2020 2020 2020  pop().          
+00029240: 2020 6966 206e 616d 6520 696e 206e 6577    if name in new
+00029250: 5f63 6f6f 7264 5f76 6172 733a 0a20 2020  _coord_vars:.   
+00029260: 2020 2020 2020 2020 2020 2020 2076 6172               var
+00029270: 6961 626c 6573 5b6e 616d 655d 203d 206e  iables[name] = n
+00029280: 6577 5f63 6f6f 7264 5f76 6172 735b 6e61  ew_coord_vars[na
+00029290: 6d65 5d0a 2020 2020 2020 2020 2020 2020  me].            
+000292a0: 696e 6465 7865 735b 6e61 6d65 5d20 3d20  indexes[name] = 
+000292b0: 696e 6465 780a 2020 2020 2020 2020 656c  index.        el
+000292c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000292d0: 2320 7265 6f72 6465 7220 7661 7269 6162  # reorder variab
+000292e0: 6c65 7320 616e 6420 696e 6465 7865 7320  les and indexes 
+000292f0: 736f 2074 6861 7420 636f 6f72 6469 6e61  so that coordina
+00029300: 7465 7320 6861 7669 6e67 2074 6865 2073  tes having the s
+00029310: 616d 650a 2020 2020 2020 2020 2020 2020  ame.            
+00029320: 2320 696e 6465 7820 6172 6520 6e65 7874  # index are next
+00029330: 2074 6f20 6561 6368 206f 7468 6572 0a20   to each other. 
+00029340: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00029350: 626c 6573 203d 207b 7d0a 2020 2020 2020  bles = {}.      
+00029360: 2020 2020 2020 666f 7220 6e61 6d65 2c20        for name, 
+00029370: 7661 7220 696e 2073 656c 662e 5f76 6172  var in self._var
+00029380: 6961 626c 6573 2e69 7465 6d73 2829 3a0a  iables.items():.
+00029390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293a0: 6966 206e 616d 6520 6e6f 7420 696e 2063  if name not in c
+000293b0: 6f6f 7264 5f6e 616d 6573 3a0a 2020 2020  oord_names:.    
+000293c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000293d0: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
+000293e0: 3d20 7661 720a 0a20 2020 2020 2020 2020  = var..         
+000293f0: 2020 2069 6e64 6578 6573 203d 207b 7d0a     indexes = {}.
+00029400: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00029410: 6e61 6d65 2c20 6964 7820 696e 2073 656c  name, idx in sel
+00029420: 662e 5f69 6e64 6578 6573 2e69 7465 6d73  f._indexes.items
+00029430: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00029440: 2020 2020 6966 206e 616d 6520 6e6f 7420      if name not 
+00029450: 696e 2063 6f6f 7264 5f6e 616d 6573 3a0a  in coord_names:.
+00029460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029470: 2020 2020 696e 6465 7865 735b 6e61 6d65      indexes[name
+00029480: 5d20 3d20 6964 780a 0a20 2020 2020 2020  ] = idx..       
+00029490: 2020 2020 2066 6f72 206e 616d 6520 696e       for name in
+000294a0: 2063 6f6f 7264 5f6e 616d 6573 3a0a 2020   coord_names:.  
+000294b0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
+000294c0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+000294d0: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+000294e0: 5b6e 616d 655d 203d 206e 6577 5f63 6f6f  [name] = new_coo
+000294f0: 7264 5f76 6172 735b 6e61 6d65 5d0a 2020  rd_vars[name].  
+00029500: 2020 2020 2020 2020 2020 2020 2020 6578                ex
+00029510: 6365 7074 204b 6579 4572 726f 723a 0a20  cept KeyError:. 
+00029520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00029530: 2020 2076 6172 6961 626c 6573 5b6e 616d     variables[nam
+00029540: 655d 203d 2073 656c 662e 5f76 6172 6961  e] = self._varia
+00029550: 626c 6573 5b6e 616d 655d 0a20 2020 2020  bles[name].     
+00029560: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00029570: 6573 5b6e 616d 655d 203d 2069 6e64 6578  es[name] = index
+00029580: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00029590: 2073 656c 662e 5f72 6570 6c61 6365 280a   self._replace(.
+000295a0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+000295b0: 6162 6c65 733d 7661 7269 6162 6c65 732c  ables=variables,
+000295c0: 0a20 2020 2020 2020 2020 2020 2063 6f6f  .            coo
+000295d0: 7264 5f6e 616d 6573 3d73 656c 662e 5f63  rd_names=self._c
+000295e0: 6f6f 7264 5f6e 616d 6573 207c 2073 6574  oord_names | set
+000295f0: 2863 6f6f 7264 5f6e 616d 6573 292c 0a20  (coord_names),. 
+00029600: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+00029610: 6573 3d69 6e64 6578 6573 2c0a 2020 2020  es=indexes,.    
+00029620: 2020 2020 290a 0a20 2020 2064 6566 2072      )..    def r
+00029630: 656f 7264 6572 5f6c 6576 656c 7328 0a20  eorder_levels(. 
+00029640: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
+00029650: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
+00029660: 6469 6d5f 6f72 6465 723a 204d 6170 7069  dim_order: Mappi
+00029670: 6e67 5b41 6e79 2c20 5365 7175 656e 6365  ng[Any, Sequence
+00029680: 5b69 6e74 207c 2048 6173 6861 626c 655d  [int | Hashable]
+00029690: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
+000296a0: 0a20 2020 2020 2020 202a 2a64 696d 5f6f  .        **dim_o
+000296b0: 7264 6572 5f6b 7761 7267 733a 2053 6571  rder_kwargs: Seq
+000296c0: 7565 6e63 655b 696e 7420 7c20 4861 7368  uence[int | Hash
+000296d0: 6162 6c65 5d2c 0a20 2020 2029 202d 3e20  able],.    ) -> 
+000296e0: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
+000296f0: 2020 2022 2222 5265 6172 7261 6e67 6520     """Rearrange 
+00029700: 696e 6465 7820 6c65 7665 6c73 2075 7369  index levels usi
+00029710: 6e67 2069 6e70 7574 206f 7264 6572 2e0a  ng input order..
+00029720: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00029730: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00029740: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+00029750: 696d 5f6f 7264 6572 203a 2064 6963 742d  im_order : dict-
+00029760: 6c69 6b65 206f 6620 4861 7368 6162 6c65  like of Hashable
+00029770: 2074 6f20 5365 7175 656e 6365 206f 6620   to Sequence of 
+00029780: 696e 7420 6f72 2048 6173 6861 626c 652c  int or Hashable,
+00029790: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+000297a0: 2020 2020 2020 4d61 7070 696e 6720 6672        Mapping fr
+000297b0: 6f6d 206e 616d 6573 206d 6174 6368 696e  om names matchin
+000297c0: 6720 6469 6d65 6e73 696f 6e73 2061 6e64  g dimensions and
+000297d0: 2076 616c 7565 7320 6769 7665 6e0a 2020   values given.  
+000297e0: 2020 2020 2020 2020 2020 6279 206c 6973            by lis
+000297f0: 7473 2072 6570 7265 7365 6e74 696e 6720  ts representing 
+00029800: 6e65 7720 6c65 7665 6c20 6f72 6465 7273  new level orders
+00029810: 2e20 4576 6572 7920 6769 7665 6e20 6469  . Every given di
+00029820: 6d65 6e73 696f 6e0a 2020 2020 2020 2020  mension.        
+00029830: 2020 2020 6d75 7374 2068 6176 6520 6120      must have a 
+00029840: 6d75 6c74 692d 696e 6465 782e 0a20 2020  multi-index..   
+00029850: 2020 2020 202a 2a64 696d 5f6f 7264 6572       **dim_order
+00029860: 5f6b 7761 7267 7320 3a20 5365 7175 656e  _kwargs : Sequen
+00029870: 6365 206f 6620 696e 7420 6f72 2048 6173  ce of int or Has
+00029880: 6861 626c 652c 206f 7074 696f 6e61 6c0a  hable, optional.
+00029890: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+000298a0: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+000298b0: 7320 666f 726d 206f 6620 6060 6469 6d5f  s form of ``dim_
+000298c0: 6f72 6465 7260 602e 0a20 2020 2020 2020  order``..       
+000298d0: 2020 2020 204f 6e65 206f 6620 6469 6d5f       One of dim_
+000298e0: 6f72 6465 7220 6f72 2064 696d 5f6f 7264  order or dim_ord
+000298f0: 6572 5f6b 7761 7267 7320 6d75 7374 2062  er_kwargs must b
+00029900: 6520 7072 6f76 6964 6564 2e0a 0a20 2020  e provided...   
+00029910: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+00029920: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+00029930: 2020 2020 206f 626a 203a 2044 6174 6173       obj : Datas
+00029940: 6574 0a20 2020 2020 2020 2020 2020 2041  et.            A
+00029950: 6e6f 7468 6572 2064 6174 6173 6574 2c20  nother dataset, 
+00029960: 7769 7468 2074 6869 7320 6461 7461 7365  with this datase
+00029970: 7427 7320 6461 7461 2062 7574 2072 6570  t's data but rep
+00029980: 6c61 6365 640a 2020 2020 2020 2020 2020  laced.          
+00029990: 2020 636f 6f72 6469 6e61 7465 732e 0a20    coordinates.. 
+000299a0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000299b0: 2020 2064 696d 5f6f 7264 6572 203d 2065     dim_order = e
+000299c0: 6974 6865 725f 6469 6374 5f6f 725f 6b77  ither_dict_or_kw
+000299d0: 6172 6773 2864 696d 5f6f 7264 6572 2c20  args(dim_order, 
+000299e0: 6469 6d5f 6f72 6465 725f 6b77 6172 6773  dim_order_kwargs
+000299f0: 2c20 2272 656f 7264 6572 5f6c 6576 656c  , "reorder_level
+00029a00: 7322 290a 2020 2020 2020 2020 7661 7269  s").        vari
+00029a10: 6162 6c65 7320 3d20 7365 6c66 2e5f 7661  ables = self._va
+00029a20: 7269 6162 6c65 732e 636f 7079 2829 0a20  riables.copy(). 
+00029a30: 2020 2020 2020 2069 6e64 6578 6573 203d         indexes =
+00029a40: 2064 6963 7428 7365 6c66 2e5f 696e 6465   dict(self._inde
+00029a50: 7865 7329 0a20 2020 2020 2020 206e 6577  xes).        new
+00029a60: 5f69 6e64 6578 6573 3a20 6469 6374 5b48  _indexes: dict[H
+00029a70: 6173 6861 626c 652c 2049 6e64 6578 5d20  ashable, Index] 
+00029a80: 3d20 7b7d 0a20 2020 2020 2020 206e 6577  = {}.        new
+00029a90: 5f76 6172 6961 626c 6573 3a20 6469 6374  _variables: dict
+00029aa0: 5b48 6173 6861 626c 652c 2049 6e64 6578  [Hashable, Index
+00029ab0: 5661 7269 6162 6c65 5d20 3d20 7b7d 0a0a  Variable] = {}..
+00029ac0: 2020 2020 2020 2020 666f 7220 6469 6d2c          for dim,
+00029ad0: 206f 7264 6572 2069 6e20 6469 6d5f 6f72   order in dim_or
+00029ae0: 6465 722e 6974 656d 7328 293a 0a20 2020  der.items():.   
+00029af0: 2020 2020 2020 2020 2069 6e64 6578 203d           index =
+00029b00: 2073 656c 662e 5f69 6e64 6578 6573 5b64   self._indexes[d
+00029b10: 696d 5d0a 0a20 2020 2020 2020 2020 2020  im]..           
+00029b20: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00029b30: 6365 2869 6e64 6578 2c20 5061 6e64 6173  ce(index, Pandas
+00029b40: 4d75 6c74 6949 6e64 6578 293a 0a20 2020  MultiIndex):.   
+00029b50: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00029b60: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+00029b70: 636f 6f72 6469 6e61 7465 207b 6469 6d7d  coordinate {dim}
+00029b80: 2068 6173 206e 6f20 4d75 6c74 6949 6e64   has no MultiInd
+00029b90: 6578 2229 0a0a 2020 2020 2020 2020 2020  ex")..          
+00029ba0: 2020 6c65 7665 6c5f 7661 7273 203d 207b    level_vars = {
+00029bb0: 6b3a 2073 656c 662e 5f76 6172 6961 626c  k: self._variabl
+00029bc0: 6573 5b6b 5d20 666f 7220 6b20 696e 206f  es[k] for k in o
+00029bd0: 7264 6572 7d0a 2020 2020 2020 2020 2020  rder}.          
+00029be0: 2020 6964 7820 3d20 696e 6465 782e 7265    idx = index.re
+00029bf0: 6f72 6465 725f 6c65 7665 6c73 286c 6576  order_levels(lev
+00029c00: 656c 5f76 6172 7329 0a20 2020 2020 2020  el_vars).       
+00029c10: 2020 2020 2069 6478 5f76 6172 7320 3d20       idx_vars = 
+00029c20: 6964 782e 6372 6561 7465 5f76 6172 6961  idx.create_varia
+00029c30: 626c 6573 286c 6576 656c 5f76 6172 7329  bles(level_vars)
+00029c40: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
+00029c50: 5f69 6e64 6578 6573 2e75 7064 6174 6528  _indexes.update(
+00029c60: 7b6b 3a20 6964 7820 666f 7220 6b20 696e  {k: idx for k in
+00029c70: 2069 6478 5f76 6172 737d 290a 2020 2020   idx_vars}).    
+00029c80: 2020 2020 2020 2020 6e65 775f 7661 7269          new_vari
+00029c90: 6162 6c65 732e 7570 6461 7465 2869 6478  ables.update(idx
+00029ca0: 5f76 6172 7329 0a0a 2020 2020 2020 2020  _vars)..        
+00029cb0: 696e 6465 7865 7320 3d20 7b6b 3a20 7620  indexes = {k: v 
+00029cc0: 666f 7220 6b2c 2076 2069 6e20 7365 6c66  for k, v in self
+00029cd0: 2e5f 696e 6465 7865 732e 6974 656d 7328  ._indexes.items(
+00029ce0: 2920 6966 206b 206e 6f74 2069 6e20 6e65  ) if k not in ne
+00029cf0: 775f 696e 6465 7865 737d 0a20 2020 2020  w_indexes}.     
+00029d00: 2020 2069 6e64 6578 6573 2e75 7064 6174     indexes.updat
+00029d10: 6528 6e65 775f 696e 6465 7865 7329 0a0a  e(new_indexes)..
+00029d20: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+00029d30: 7320 3d20 7b6b 3a20 7620 666f 7220 6b2c  s = {k: v for k,
+00029d40: 2076 2069 6e20 7365 6c66 2e5f 7661 7269   v in self._vari
+00029d50: 6162 6c65 732e 6974 656d 7328 2920 6966  ables.items() if
+00029d60: 206b 206e 6f74 2069 6e20 6e65 775f 7661   k not in new_va
+00029d70: 7269 6162 6c65 737d 0a20 2020 2020 2020  riables}.       
+00029d80: 2076 6172 6961 626c 6573 2e75 7064 6174   variables.updat
+00029d90: 6528 6e65 775f 7661 7269 6162 6c65 7329  e(new_variables)
+00029da0: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+00029db0: 2073 656c 662e 5f72 6570 6c61 6365 2876   self._replace(v
+00029dc0: 6172 6961 626c 6573 2c20 696e 6465 7865  ariables, indexe
+00029dd0: 733d 696e 6465 7865 7329 0a0a 2020 2020  s=indexes)..    
+00029de0: 6465 6620 5f67 6574 5f73 7461 636b 5f69  def _get_stack_i
+00029df0: 6e64 6578 280a 2020 2020 2020 2020 7365  ndex(.        se
+00029e00: 6c66 2c0a 2020 2020 2020 2020 6469 6d2c  lf,.        dim,
+00029e10: 0a20 2020 2020 2020 206d 756c 7469 3d46  .        multi=F
+00029e20: 616c 7365 2c0a 2020 2020 2020 2020 6372  alse,.        cr
+00029e30: 6561 7465 5f69 6e64 6578 3d46 616c 7365  eate_index=False
+00029e40: 2c0a 2020 2020 2920 2d3e 2074 7570 6c65  ,.    ) -> tuple
+00029e50: 5b49 6e64 6578 207c 204e 6f6e 652c 2064  [Index | None, d
+00029e60: 6963 745b 4861 7368 6162 6c65 2c20 5661  ict[Hashable, Va
+00029e70: 7269 6162 6c65 5d5d 3a0a 2020 2020 2020  riable]]:.      
+00029e80: 2020 2222 2255 7365 6420 6279 2073 7461    """Used by sta
+00029e90: 636b 2061 6e64 2075 6e73 7461 636b 2074  ck and unstack t
+00029ea0: 6f20 6765 7420 6f6e 6520 7061 6e64 6173  o get one pandas
+00029eb0: 2028 6d75 6c74 692d 2969 6e64 6578 2061   (multi-)index a
+00029ec0: 6d6f 6e67 0a20 2020 2020 2020 2074 6865  mong.        the
+00029ed0: 2069 6e64 6578 6564 2063 6f6f 7264 696e   indexed coordin
+00029ee0: 6174 6573 2061 6c6f 6e67 2064 696d 656e  ates along dimen
+00029ef0: 7369 6f6e 2060 6469 6d60 2e0a 0a20 2020  sion `dim`...   
+00029f00: 2020 2020 2049 6620 6578 6163 746c 7920       If exactly 
+00029f10: 6f6e 6520 696e 6465 7820 6973 2066 6f75  one index is fou
+00029f20: 6e64 2c20 7265 7475 726e 2069 7420 7769  nd, return it wi
+00029f30: 7468 2069 7473 2063 6f72 7265 7370 6f6e  th its correspon
+00029f40: 6469 6e67 0a20 2020 2020 2020 2063 6f6f  ding.        coo
+00029f50: 7264 696e 6174 6520 7661 7269 6162 6c65  rdinate variable
+00029f60: 7328 7329 2c20 6f74 6865 7277 6973 6520  s(s), otherwise 
+00029f70: 7265 7475 726e 204e 6f6e 6520 616e 6420  return None and 
+00029f80: 616e 2065 6d70 7479 2064 6963 742e 0a0a  an empty dict...
+00029f90: 2020 2020 2020 2020 4966 2060 6372 6561          If `crea
+00029fa0: 7465 5f69 6e64 6578 3d54 7275 6560 2c20  te_index=True`, 
+00029fb0: 6372 6561 7465 2061 206e 6577 2069 6e64  create a new ind
+00029fc0: 6578 2069 6620 6e6f 6e65 2069 7320 666f  ex if none is fo
+00029fd0: 756e 6420 6f72 2072 6169 7365 0a20 2020  und or raise.   
+00029fe0: 2020 2020 2061 6e20 6572 726f 7220 6966       an error if
+00029ff0: 206d 756c 7469 706c 6520 696e 6465 7865   multiple indexe
+0002a000: 7320 6172 6520 666f 756e 642e 0a0a 2020  s are found...  
+0002a010: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002a020: 2020 7374 6163 6b5f 696e 6465 783a 2049    stack_index: I
+0002a030: 6e64 6578 207c 204e 6f6e 6520 3d20 4e6f  ndex | None = No
+0002a040: 6e65 0a20 2020 2020 2020 2073 7461 636b  ne.        stack
+0002a050: 5f63 6f6f 7264 733a 2064 6963 745b 4861  _coords: dict[Ha
+0002a060: 7368 6162 6c65 2c20 5661 7269 6162 6c65  shable, Variable
+0002a070: 5d20 3d20 7b7d 0a0a 2020 2020 2020 2020  ] = {}..        
+0002a080: 666f 7220 6e61 6d65 2c20 696e 6465 7820  for name, index 
+0002a090: 696e 2073 656c 662e 5f69 6e64 6578 6573  in self._indexes
+0002a0a0: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+0002a0b0: 2020 2020 2020 7661 7220 3d20 7365 6c66        var = self
+0002a0c0: 2e5f 7661 7269 6162 6c65 735b 6e61 6d65  ._variables[name
+0002a0d0: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+0002a0e0: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+0002a0f0: 2020 2076 6172 2e6e 6469 6d20 3d3d 2031     var.ndim == 1
+0002a100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a110: 2061 6e64 2076 6172 2e64 696d 735b 305d   and var.dims[0]
+0002a120: 203d 3d20 6469 6d0a 2020 2020 2020 2020   == dim.        
+0002a130: 2020 2020 2020 2020 616e 6420 280a 2020          and (.  
+0002a140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a150: 2020 2320 7374 6163 6b3a 206d 7573 7420    # stack: must 
+0002a160: 6265 2061 2073 696e 676c 6520 636f 6f72  be a single coor
+0002a170: 6469 6e61 7465 2069 6e64 6578 0a20 2020  dinate index.   
+0002a180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a190: 206e 6f74 206d 756c 7469 0a20 2020 2020   not multi.     
+0002a1a0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0002a1b0: 6e64 206e 6f74 2073 656c 662e 7869 6e64  nd not self.xind
+0002a1c0: 6578 6573 2e69 735f 6d75 6c74 6928 6e61  exes.is_multi(na
+0002a1d0: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
+0002a1e0: 2020 2020 2020 2020 2320 756e 7374 6163          # unstac
+0002a1f0: 6b3a 206d 7573 7420 6265 2061 6e20 696e  k: must be an in
+0002a200: 6465 7820 7468 6174 2069 6d70 6c65 6d65  dex that impleme
+0002a210: 6e74 7320 2e75 6e73 7461 636b 0a20 2020  nts .unstack.   
+0002a220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a230: 206f 7220 6d75 6c74 690a 2020 2020 2020   or multi.      
+0002a240: 2020 2020 2020 2020 2020 2020 2020 616e                an
+0002a250: 6420 7479 7065 2869 6e64 6578 292e 756e  d type(index).un
+0002a260: 7374 6163 6b20 6973 206e 6f74 2049 6e64  stack is not Ind
+0002a270: 6578 2e75 6e73 7461 636b 0a20 2020 2020  ex.unstack.     
+0002a280: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0002a290: 2020 2020 2020 2020 2029 3a0a 2020 2020           ):.    
+0002a2a0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+0002a2b0: 7461 636b 5f69 6e64 6578 2069 7320 6e6f  tack_index is no
+0002a2c0: 7420 4e6f 6e65 2061 6e64 2069 6e64 6578  t None and index
+0002a2d0: 2069 7320 6e6f 7420 7374 6163 6b5f 696e   is not stack_in
+0002a2e0: 6465 783a 0a20 2020 2020 2020 2020 2020  dex:.           
+0002a2f0: 2020 2020 2020 2020 2023 206d 6f72 6520           # more 
+0002a300: 7468 616e 206f 6e65 2069 6e64 6578 2066  than one index f
+0002a310: 6f75 6e64 2c20 7374 6f70 0a20 2020 2020  ound, stop.     
+0002a320: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002a330: 6620 6372 6561 7465 5f69 6e64 6578 3a0a  f create_index:.
+0002a340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a350: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0002a360: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
 0002a370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002a380: 7374 6163 6b5f 636f 6f72 6473 5b6e 616d  stack_coords[nam
-0002a390: 655d 203d 2076 6172 0a0a 2020 2020 2020  e] = var..      
-0002a3a0: 2020 6966 2063 7265 6174 655f 696e 6465    if create_inde
-0002a3b0: 7820 616e 6420 7374 6163 6b5f 696e 6465  x and stack_inde
-0002a3c0: 7820 6973 204e 6f6e 653a 0a20 2020 2020  x is None:.     
-0002a3d0: 2020 2020 2020 2069 6620 6469 6d20 696e         if dim in
-0002a3e0: 2073 656c 662e 5f76 6172 6961 626c 6573   self._variables
-0002a3f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002a400: 2020 7661 7220 3d20 7365 6c66 2e5f 7661    var = self._va
-0002a410: 7269 6162 6c65 735b 6469 6d5d 0a20 2020  riables[dim].   
-0002a420: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0002a430: 2020 2020 2020 2020 2020 2020 2020 205f                 _
-0002a440: 2c20 5f2c 2076 6172 203d 205f 6765 745f  , _, var = _get_
-0002a450: 7669 7274 7561 6c5f 7661 7269 6162 6c65  virtual_variable
-0002a460: 2873 656c 662e 5f76 6172 6961 626c 6573  (self._variables
-0002a470: 2c20 6469 6d2c 2073 656c 662e 6469 6d73  , dim, self.dims
-0002a480: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-0002a490: 6475 6d6d 7920 696e 6465 7820 286f 6e6c  dummy index (onl
-0002a4a0: 7920 6073 7461 636b 5f63 6f6f 7264 7360  y `stack_coords`
-0002a4b0: 2077 696c 6c20 6265 2075 7365 6420 746f   will be used to
-0002a4c0: 2063 6f6e 7374 7275 6374 2074 6865 206d   construct the m
-0002a4d0: 756c 7469 2d69 6e64 6578 290a 2020 2020  ulti-index).    
-0002a4e0: 2020 2020 2020 2020 7374 6163 6b5f 696e          stack_in
-0002a4f0: 6465 7820 3d20 5061 6e64 6173 496e 6465  dex = PandasInde
-0002a500: 7828 5b30 5d2c 2064 696d 290a 2020 2020  x([0], dim).    
-0002a510: 2020 2020 2020 2020 7374 6163 6b5f 636f          stack_co
-0002a520: 6f72 6473 203d 207b 6469 6d3a 2076 6172  ords = {dim: var
-0002a530: 7d0a 0a20 2020 2020 2020 2072 6574 7572  }..        retur
-0002a540: 6e20 7374 6163 6b5f 696e 6465 782c 2073  n stack_index, s
-0002a550: 7461 636b 5f63 6f6f 7264 730a 0a20 2020  tack_coords..   
-0002a560: 2064 6566 205f 7374 6163 6b5f 6f6e 6365   def _stack_once
-0002a570: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
-0002a580: 545f 4461 7461 7365 742c 0a20 2020 2020  T_Dataset,.     
-0002a590: 2020 2064 696d 733a 2053 6571 7565 6e63     dims: Sequenc
-0002a5a0: 655b 4861 7368 6162 6c65 207c 2065 6c6c  e[Hashable | ell
-0002a5b0: 6970 7369 735d 2c0a 2020 2020 2020 2020  ipsis],.        
-0002a5c0: 6e65 775f 6469 6d3a 2048 6173 6861 626c  new_dim: Hashabl
-0002a5d0: 652c 0a20 2020 2020 2020 2069 6e64 6578  e,.        index
-0002a5e0: 5f63 6c73 3a20 7479 7065 5b49 6e64 6578  _cls: type[Index
-0002a5f0: 5d2c 0a20 2020 2020 2020 2063 7265 6174  ],.        creat
-0002a600: 655f 696e 6465 783a 2062 6f6f 6c20 7c20  e_index: bool | 
-0002a610: 4e6f 6e65 203d 2054 7275 652c 0a20 2020  None = True,.   
-0002a620: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
-0002a630: 0a20 2020 2020 2020 2069 6620 6469 6d73  .        if dims
-0002a640: 203d 3d20 2e2e 2e3a 0a20 2020 2020 2020   == ...:.       
-0002a650: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0002a660: 4572 726f 7228 2250 6c65 6173 6520 7573  Error("Please us
-0002a670: 6520 5b2e 2e2e 5d20 666f 7220 6469 6d73  e [...] for dims
-0002a680: 2c20 7261 7468 6572 2074 6861 6e20 6a75  , rather than ju
-0002a690: 7374 202e 2e2e 2229 0a20 2020 2020 2020  st ...").       
-0002a6a0: 2069 6620 2e2e 2e20 696e 2064 696d 733a   if ... in dims:
-0002a6b0: 0a20 2020 2020 2020 2020 2020 2064 696d  .            dim
-0002a6c0: 7320 3d20 6c69 7374 2869 6e66 6978 5f64  s = list(infix_d
-0002a6d0: 696d 7328 6469 6d73 2c20 7365 6c66 2e64  ims(dims, self.d
-0002a6e0: 696d 7329 290a 0a20 2020 2020 2020 206e  ims))..        n
-0002a6f0: 6577 5f76 6172 6961 626c 6573 3a20 6469  ew_variables: di
-0002a700: 6374 5b48 6173 6861 626c 652c 2056 6172  ct[Hashable, Var
-0002a710: 6961 626c 655d 203d 207b 7d0a 2020 2020  iable] = {}.    
-0002a720: 2020 2020 7374 6163 6b65 645f 7661 725f      stacked_var_
-0002a730: 6e61 6d65 733a 206c 6973 745b 4861 7368  names: list[Hash
-0002a740: 6162 6c65 5d20 3d20 5b5d 0a20 2020 2020  able] = [].     
-0002a750: 2020 2064 726f 705f 696e 6465 7865 733a     drop_indexes:
-0002a760: 206c 6973 745b 4861 7368 6162 6c65 5d20   list[Hashable] 
-0002a770: 3d20 5b5d 0a0a 2020 2020 2020 2020 666f  = []..        fo
-0002a780: 7220 6e61 6d65 2c20 7661 7220 696e 2073  r name, var in s
-0002a790: 656c 662e 7661 7269 6162 6c65 732e 6974  elf.variables.it
-0002a7a0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-0002a7b0: 2020 2069 6620 616e 7928 6420 696e 2076     if any(d in v
-0002a7c0: 6172 2e64 696d 7320 666f 7220 6420 696e  ar.dims for d in
-0002a7d0: 2064 696d 7329 3a0a 2020 2020 2020 2020   dims):.        
-0002a7e0: 2020 2020 2020 2020 6164 645f 6469 6d73          add_dims
-0002a7f0: 203d 205b 6420 666f 7220 6420 696e 2064   = [d for d in d
-0002a800: 696d 7320 6966 2064 206e 6f74 2069 6e20  ims if d not in 
-0002a810: 7661 722e 6469 6d73 5d0a 2020 2020 2020  var.dims].      
-0002a820: 2020 2020 2020 2020 2020 7664 696d 7320            vdims 
-0002a830: 3d20 6c69 7374 2876 6172 2e64 696d 7329  = list(var.dims)
-0002a840: 202b 2061 6464 5f64 696d 730a 2020 2020   + add_dims.    
-0002a850: 2020 2020 2020 2020 2020 2020 7368 6170              shap
-0002a860: 6520 3d20 5b73 656c 662e 6469 6d73 5b64  e = [self.dims[d
-0002a870: 5d20 666f 7220 6420 696e 2076 6469 6d73  ] for d in vdims
-0002a880: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0002a890: 2020 6578 705f 7661 7220 3d20 7661 722e    exp_var = var.
-0002a8a0: 7365 745f 6469 6d73 2876 6469 6d73 2c20  set_dims(vdims, 
-0002a8b0: 7368 6170 6529 0a20 2020 2020 2020 2020  shape).         
-0002a8c0: 2020 2020 2020 2073 7461 636b 6564 5f76         stacked_v
-0002a8d0: 6172 203d 2065 7870 5f76 6172 2e73 7461  ar = exp_var.sta
-0002a8e0: 636b 282a 2a7b 6e65 775f 6469 6d3a 2064  ck(**{new_dim: d
-0002a8f0: 696d 737d 290a 2020 2020 2020 2020 2020  ims}).          
-0002a900: 2020 2020 2020 6e65 775f 7661 7269 6162        new_variab
-0002a910: 6c65 735b 6e61 6d65 5d20 3d20 7374 6163  les[name] = stac
-0002a920: 6b65 645f 7661 720a 2020 2020 2020 2020  ked_var.        
-0002a930: 2020 2020 2020 2020 7374 6163 6b65 645f          stacked_
-0002a940: 7661 725f 6e61 6d65 732e 6170 7065 6e64  var_names.append
-0002a950: 286e 616d 6529 0a20 2020 2020 2020 2020  (name).         
-0002a960: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-0002a970: 2020 2020 2020 2020 206e 6577 5f76 6172           new_var
-0002a980: 6961 626c 6573 5b6e 616d 655d 203d 2076  iables[name] = v
-0002a990: 6172 2e63 6f70 7928 6465 6570 3d46 616c  ar.copy(deep=Fal
-0002a9a0: 7365 290a 0a20 2020 2020 2020 2023 2064  se)..        # d
-0002a9b0: 726f 7020 696e 6465 7865 7320 6f66 2073  rop indexes of s
-0002a9c0: 7461 636b 6564 2063 6f6f 7264 696e 6174  tacked coordinat
-0002a9d0: 6573 2028 6966 2061 6e79 290a 2020 2020  es (if any).    
-0002a9e0: 2020 2020 666f 7220 6e61 6d65 2069 6e20      for name in 
-0002a9f0: 7374 6163 6b65 645f 7661 725f 6e61 6d65  stacked_var_name
-0002aa00: 733a 0a20 2020 2020 2020 2020 2020 2064  s:.            d
-0002aa10: 726f 705f 696e 6465 7865 7320 2b3d 206c  rop_indexes += l
-0002aa20: 6973 7428 7365 6c66 2e78 696e 6465 7865  ist(self.xindexe
-0002aa30: 732e 6765 745f 616c 6c5f 636f 6f72 6473  s.get_all_coords
-0002aa40: 286e 616d 652c 2065 7272 6f72 733d 2269  (name, errors="i
-0002aa50: 676e 6f72 6522 2929 0a0a 2020 2020 2020  gnore"))..      
-0002aa60: 2020 6e65 775f 696e 6465 7865 7320 3d20    new_indexes = 
-0002aa70: 7b7d 0a20 2020 2020 2020 206e 6577 5f63  {}.        new_c
-0002aa80: 6f6f 7264 5f6e 616d 6573 203d 2073 6574  oord_names = set
-0002aa90: 2873 656c 662e 5f63 6f6f 7264 5f6e 616d  (self._coord_nam
-0002aaa0: 6573 290a 2020 2020 2020 2020 6966 2063  es).        if c
-0002aab0: 7265 6174 655f 696e 6465 7820 6f72 2063  reate_index or c
-0002aac0: 7265 6174 655f 696e 6465 7820 6973 204e  reate_index is N
-0002aad0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0002aae0: 2070 726f 6475 6374 5f76 6172 733a 2064   product_vars: d
-0002aaf0: 6963 745b 416e 792c 2056 6172 6961 626c  ict[Any, Variabl
-0002ab00: 655d 203d 207b 7d0a 2020 2020 2020 2020  e] = {}.        
-0002ab10: 2020 2020 666f 7220 6469 6d20 696e 2064      for dim in d
-0002ab20: 696d 733a 0a20 2020 2020 2020 2020 2020  ims:.           
-0002ab30: 2020 2020 2069 6478 2c20 6964 785f 7661       idx, idx_va
-0002ab40: 7273 203d 2073 656c 662e 5f67 6574 5f73  rs = self._get_s
-0002ab50: 7461 636b 5f69 6e64 6578 2864 696d 2c20  tack_index(dim, 
-0002ab60: 6372 6561 7465 5f69 6e64 6578 3d63 7265  create_index=cre
-0002ab70: 6174 655f 696e 6465 7829 0a20 2020 2020  ate_index).     
-0002ab80: 2020 2020 2020 2020 2020 2069 6620 6964             if id
-0002ab90: 7820 6973 206e 6f74 204e 6f6e 653a 0a20  x is not None:. 
-0002aba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002abb0: 2020 2070 726f 6475 6374 5f76 6172 732e     product_vars.
-0002abc0: 7570 6461 7465 2869 6478 5f76 6172 7329  update(idx_vars)
-0002abd0: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0002abe0: 206c 656e 2870 726f 6475 6374 5f76 6172   len(product_var
-0002abf0: 7329 203d 3d20 6c65 6e28 6469 6d73 293a  s) == len(dims):
-0002ac00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002ac10: 2069 6478 203d 2069 6e64 6578 5f63 6c73   idx = index_cls
-0002ac20: 2e73 7461 636b 2870 726f 6475 6374 5f76  .stack(product_v
-0002ac30: 6172 732c 206e 6577 5f64 696d 290a 2020  ars, new_dim).  
-0002ac40: 2020 2020 2020 2020 2020 2020 2020 6e65                ne
-0002ac50: 775f 696e 6465 7865 735b 6e65 775f 6469  w_indexes[new_di
-0002ac60: 6d5d 203d 2069 6478 0a20 2020 2020 2020  m] = idx.       
-0002ac70: 2020 2020 2020 2020 206e 6577 5f69 6e64           new_ind
-0002ac80: 6578 6573 2e75 7064 6174 6528 7b6b 3a20  exes.update({k: 
-0002ac90: 6964 7820 666f 7220 6b20 696e 2070 726f  idx for k in pro
-0002aca0: 6475 6374 5f76 6172 737d 290a 2020 2020  duct_vars}).    
-0002acb0: 2020 2020 2020 2020 2020 2020 6964 785f              idx_
-0002acc0: 7661 7273 203d 2069 6478 2e63 7265 6174  vars = idx.creat
-0002acd0: 655f 7661 7269 6162 6c65 7328 7072 6f64  e_variables(prod
-0002ace0: 7563 745f 7661 7273 290a 2020 2020 2020  uct_vars).      
-0002acf0: 2020 2020 2020 2020 2020 2320 6b65 6570            # keep
-0002ad00: 2063 6f6e 7369 7374 656e 7420 6d75 6c74   consistent mult
-0002ad10: 692d 696e 6465 7820 636f 6f72 6469 6e61  i-index coordina
-0002ad20: 7465 206f 7264 6572 0a20 2020 2020 2020  te order.       
-0002ad30: 2020 2020 2020 2020 2066 6f72 206b 2069           for k i
-0002ad40: 6e20 6964 785f 7661 7273 3a0a 2020 2020  n idx_vars:.    
-0002ad50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ad60: 6e65 775f 7661 7269 6162 6c65 732e 706f  new_variables.po
-0002ad70: 7028 6b2c 204e 6f6e 6529 0a20 2020 2020  p(k, None).     
-0002ad80: 2020 2020 2020 2020 2020 206e 6577 5f76             new_v
-0002ad90: 6172 6961 626c 6573 2e75 7064 6174 6528  ariables.update(
-0002ada0: 6964 785f 7661 7273 290a 2020 2020 2020  idx_vars).      
-0002adb0: 2020 2020 2020 2020 2020 6e65 775f 636f            new_co
-0002adc0: 6f72 645f 6e61 6d65 732e 7570 6461 7465  ord_names.update
-0002add0: 2869 6478 5f76 6172 7329 0a0a 2020 2020  (idx_vars)..    
-0002ade0: 2020 2020 696e 6465 7865 7320 3d20 7b6b      indexes = {k
-0002adf0: 3a20 7620 666f 7220 6b2c 2076 2069 6e20  : v for k, v in 
-0002ae00: 7365 6c66 2e5f 696e 6465 7865 732e 6974  self._indexes.it
-0002ae10: 656d 7328 2920 6966 206b 206e 6f74 2069  ems() if k not i
-0002ae20: 6e20 6472 6f70 5f69 6e64 6578 6573 7d0a  n drop_indexes}.
-0002ae30: 2020 2020 2020 2020 696e 6465 7865 732e          indexes.
-0002ae40: 7570 6461 7465 286e 6577 5f69 6e64 6578  update(new_index
-0002ae50: 6573 290a 0a20 2020 2020 2020 2072 6574  es)..        ret
-0002ae60: 7572 6e20 7365 6c66 2e5f 7265 706c 6163  urn self._replac
-0002ae70: 655f 7769 7468 5f6e 6577 5f64 696d 7328  e_with_new_dims(
-0002ae80: 0a20 2020 2020 2020 2020 2020 206e 6577  .            new
-0002ae90: 5f76 6172 6961 626c 6573 2c20 636f 6f72  _variables, coor
-0002aea0: 645f 6e61 6d65 733d 6e65 775f 636f 6f72  d_names=new_coor
-0002aeb0: 645f 6e61 6d65 732c 2069 6e64 6578 6573  d_names, indexes
-0002aec0: 3d69 6e64 6578 6573 0a20 2020 2020 2020  =indexes.       
-0002aed0: 2029 0a0a 2020 2020 6465 6620 7374 6163   )..    def stac
-0002aee0: 6b28 0a20 2020 2020 2020 2073 656c 663a  k(.        self:
-0002aef0: 2054 5f44 6174 6173 6574 2c0a 2020 2020   T_Dataset,.    
-0002af00: 2020 2020 6469 6d65 6e73 696f 6e73 3a20      dimensions: 
-0002af10: 4d61 7070 696e 675b 416e 792c 2053 6571  Mapping[Any, Seq
-0002af20: 7565 6e63 655b 4861 7368 6162 6c65 207c  uence[Hashable |
-0002af30: 2065 6c6c 6970 7369 735d 5d20 7c20 4e6f   ellipsis]] | No
-0002af40: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
-0002af50: 2020 2063 7265 6174 655f 696e 6465 783a     create_index:
-0002af60: 2062 6f6f 6c20 7c20 4e6f 6e65 203d 2054   bool | None = T
-0002af70: 7275 652c 0a20 2020 2020 2020 2069 6e64  rue,.        ind
-0002af80: 6578 5f63 6c73 3a20 7479 7065 5b49 6e64  ex_cls: type[Ind
-0002af90: 6578 5d20 3d20 5061 6e64 6173 4d75 6c74  ex] = PandasMult
-0002afa0: 6949 6e64 6578 2c0a 2020 2020 2020 2020  iIndex,.        
-0002afb0: 2a2a 6469 6d65 6e73 696f 6e73 5f6b 7761  **dimensions_kwa
-0002afc0: 7267 733a 2053 6571 7565 6e63 655b 4861  rgs: Sequence[Ha
-0002afd0: 7368 6162 6c65 207c 2065 6c6c 6970 7369  shable | ellipsi
-0002afe0: 735d 2c0a 2020 2020 2920 2d3e 2054 5f44  s],.    ) -> T_D
-0002aff0: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
-0002b000: 2222 220a 2020 2020 2020 2020 5374 6163  """.        Stac
-0002b010: 6b20 616e 7920 6e75 6d62 6572 206f 6620  k any number of 
-0002b020: 6578 6973 7469 6e67 2064 696d 656e 7369  existing dimensi
-0002b030: 6f6e 7320 696e 746f 2061 2073 696e 676c  ons into a singl
-0002b040: 6520 6e65 7720 6469 6d65 6e73 696f 6e2e  e new dimension.
-0002b050: 0a0a 2020 2020 2020 2020 4e65 7720 6469  ..        New di
-0002b060: 6d65 6e73 696f 6e73 2077 696c 6c20 6265  mensions will be
-0002b070: 2061 6464 6564 2061 7420 7468 6520 656e   added at the en
-0002b080: 642c 2061 6e64 2062 7920 6465 6661 756c  d, and by defaul
-0002b090: 7420 7468 6520 636f 7272 6573 706f 6e64  t the correspond
-0002b0a0: 696e 670a 2020 2020 2020 2020 636f 6f72  ing.        coor
-0002b0b0: 6469 6e61 7465 2076 6172 6961 626c 6573  dinate variables
-0002b0c0: 2077 696c 6c20 6265 2063 6f6d 6269 6e65   will be combine
-0002b0d0: 6420 696e 746f 2061 204d 756c 7469 496e  d into a MultiIn
-0002b0e0: 6465 782e 0a0a 2020 2020 2020 2020 5061  dex...        Pa
-0002b0f0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0002b100: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0002b110: 2020 2020 6469 6d65 6e73 696f 6e73 203a      dimensions :
-0002b120: 206d 6170 7069 6e67 206f 6620 6861 7368   mapping of hash
-0002b130: 6162 6c65 2074 6f20 7365 7175 656e 6365  able to sequence
-0002b140: 206f 6620 6861 7368 6162 6c65 0a20 2020   of hashable.   
-0002b150: 2020 2020 2020 2020 204d 6170 7069 6e67           Mapping
-0002b160: 206f 6620 7468 6520 666f 726d 2060 6e65   of the form `ne
-0002b170: 775f 6e61 6d65 3d28 6469 6d31 2c20 6469  w_name=(dim1, di
-0002b180: 6d32 2c20 2e2e 2e29 602e 204e 616d 6573  m2, ...)`. Names
-0002b190: 206f 6620 6e65 770a 2020 2020 2020 2020   of new.        
-0002b1a0: 2020 2020 6469 6d65 6e73 696f 6e73 2c20      dimensions, 
-0002b1b0: 616e 6420 7468 6520 6578 6973 7469 6e67  and the existing
-0002b1c0: 2064 696d 656e 7369 6f6e 7320 7468 6174   dimensions that
-0002b1d0: 2074 6865 7920 7265 706c 6163 652e 2041   they replace. A
-0002b1e0: 6e0a 2020 2020 2020 2020 2020 2020 656c  n.            el
-0002b1f0: 6c69 7073 6973 2028 602e 2e2e 6029 2077  lipsis (`...`) w
-0002b200: 696c 6c20 6265 2072 6570 6c61 6365 6420  ill be replaced 
-0002b210: 6279 2061 6c6c 2075 6e6c 6973 7465 6420  by all unlisted 
-0002b220: 6469 6d65 6e73 696f 6e73 2e0a 2020 2020  dimensions..    
-0002b230: 2020 2020 2020 2020 5061 7373 696e 6720          Passing 
-0002b240: 6120 6c69 7374 2063 6f6e 7461 696e 696e  a list containin
-0002b250: 6720 616e 2065 6c6c 6970 7369 7320 2860  g an ellipsis (`
-0002b260: 7374 6163 6b65 645f 6469 6d3d 5b2e 2e2e  stacked_dim=[...
-0002b270: 5d60 2920 7769 6c6c 2073 7461 636b 206f  ]`) will stack o
-0002b280: 7665 720a 2020 2020 2020 2020 2020 2020  ver.            
-0002b290: 616c 6c20 6469 6d65 6e73 696f 6e73 2e0a  all dimensions..
-0002b2a0: 2020 2020 2020 2020 6372 6561 7465 5f69          create_i
-0002b2b0: 6e64 6578 203a 2062 6f6f 6c20 6f72 204e  ndex : bool or N
-0002b2c0: 6f6e 652c 2064 6566 6175 6c74 3a20 5472  one, default: Tr
-0002b2d0: 7565 0a0a 2020 2020 2020 2020 2020 2020  ue..            
-0002b2e0: 2d20 5472 7565 3a20 6372 6561 7465 2061  - True: create a
-0002b2f0: 206d 756c 7469 2d69 6e64 6578 2066 6f72   multi-index for
-0002b300: 2065 6163 6820 6f66 2074 6865 2073 7461   each of the sta
-0002b310: 636b 6564 2064 696d 656e 7369 6f6e 732e  cked dimensions.
-0002b320: 0a20 2020 2020 2020 2020 2020 202d 2046  .            - F
-0002b330: 616c 7365 3a20 646f 6e27 7420 6372 6561  alse: don't crea
-0002b340: 7465 2061 6e79 2069 6e64 6578 2e0a 2020  te any index..  
-0002b350: 2020 2020 2020 2020 2020 2d20 4e6f 6e65            - None
-0002b360: 2e20 6372 6561 7465 2061 206d 756c 7469  . create a multi
-0002b370: 2d69 6e64 6578 206f 6e6c 7920 6966 2065  -index only if e
-0002b380: 7861 6374 6c79 206f 6e65 2073 696e 676c  xactly one singl
-0002b390: 6520 2831 2d64 2920 636f 6f72 6469 6e61  e (1-d) coordina
-0002b3a0: 7465 0a20 2020 2020 2020 2020 2020 2020  te.             
-0002b3b0: 2069 6e64 6578 2069 7320 666f 756e 6420   index is found 
-0002b3c0: 666f 7220 6576 6572 7920 6469 6d65 6e73  for every dimens
-0002b3d0: 696f 6e20 746f 2073 7461 636b 2e0a 0a20  ion to stack... 
-0002b3e0: 2020 2020 2020 2069 6e64 6578 5f63 6c73         index_cls
-0002b3f0: 3a20 496e 6465 782d 636c 6173 732c 2064  : Index-class, d
-0002b400: 6566 6175 6c74 3a20 5061 6e64 6173 4d75  efault: PandasMu
-0002b410: 6c74 6949 6e64 6578 0a20 2020 2020 2020  ltiIndex.       
-0002b420: 2020 2020 2043 616e 2062 6520 7573 6564       Can be used
-0002b430: 2074 6f20 7061 7373 2061 2063 7573 746f   to pass a custo
-0002b440: 6d20 6d75 6c74 692d 696e 6465 7820 7479  m multi-index ty
-0002b450: 7065 2028 6d75 7374 2062 6520 616e 2058  pe (must be an X
-0002b460: 6172 7261 7920 696e 6465 7820 7468 6174  array index that
-0002b470: 0a20 2020 2020 2020 2020 2020 2069 6d70  .            imp
-0002b480: 6c65 6d65 6e74 7320 602e 7374 6163 6b28  lements `.stack(
-0002b490: 2960 292e 2042 7920 6465 6661 756c 742c  )`). By default,
-0002b4a0: 2061 2070 616e 6461 7320 6d75 6c74 692d   a pandas multi-
-0002b4b0: 696e 6465 7820 7772 6170 7065 7220 6973  index wrapper is
-0002b4c0: 2075 7365 642e 0a20 2020 2020 2020 202a   used..        *
-0002b4d0: 2a64 696d 656e 7369 6f6e 735f 6b77 6172  *dimensions_kwar
-0002b4e0: 6773 0a20 2020 2020 2020 2020 2020 2054  gs.            T
-0002b4f0: 6865 206b 6579 776f 7264 2061 7267 756d  he keyword argum
-0002b500: 656e 7473 2066 6f72 6d20 6f66 2060 6064  ents form of ``d
-0002b510: 696d 656e 7369 6f6e 7360 602e 0a20 2020  imensions``..   
-0002b520: 2020 2020 2020 2020 204f 6e65 206f 6620           One of 
-0002b530: 6469 6d65 6e73 696f 6e73 206f 7220 6469  dimensions or di
-0002b540: 6d65 6e73 696f 6e73 5f6b 7761 7267 7320  mensions_kwargs 
-0002b550: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
-0002b560: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-0002b570: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-0002b580: 2d2d 0a20 2020 2020 2020 2073 7461 636b  --.        stack
-0002b590: 6564 203a 2044 6174 6173 6574 0a20 2020  ed : Dataset.   
-0002b5a0: 2020 2020 2020 2020 2044 6174 6173 6574           Dataset
-0002b5b0: 2077 6974 6820 7374 6163 6b65 6420 6461   with stacked da
-0002b5c0: 7461 2e0a 0a20 2020 2020 2020 2053 6565  ta...        See
-0002b5d0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-0002b5e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-0002b5f0: 6174 6173 6574 2e75 6e73 7461 636b 0a20  ataset.unstack. 
-0002b600: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0002b610: 2020 2064 696d 656e 7369 6f6e 7320 3d20     dimensions = 
-0002b620: 6569 7468 6572 5f64 6963 745f 6f72 5f6b  either_dict_or_k
-0002b630: 7761 7267 7328 6469 6d65 6e73 696f 6e73  wargs(dimensions
-0002b640: 2c20 6469 6d65 6e73 696f 6e73 5f6b 7761  , dimensions_kwa
-0002b650: 7267 732c 2022 7374 6163 6b22 290a 2020  rgs, "stack").  
-0002b660: 2020 2020 2020 7265 7375 6c74 203d 2073        result = s
-0002b670: 656c 660a 2020 2020 2020 2020 666f 7220  elf.        for 
-0002b680: 6e65 775f 6469 6d2c 2064 696d 7320 696e  new_dim, dims in
-0002b690: 2064 696d 656e 7369 6f6e 732e 6974 656d   dimensions.item
-0002b6a0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-0002b6b0: 2072 6573 756c 7420 3d20 7265 7375 6c74   result = result
-0002b6c0: 2e5f 7374 6163 6b5f 6f6e 6365 2864 696d  ._stack_once(dim
-0002b6d0: 732c 206e 6577 5f64 696d 2c20 696e 6465  s, new_dim, inde
-0002b6e0: 785f 636c 732c 2063 7265 6174 655f 696e  x_cls, create_in
-0002b6f0: 6465 7829 0a20 2020 2020 2020 2072 6574  dex).        ret
-0002b700: 7572 6e20 7265 7375 6c74 0a0a 2020 2020  urn result..    
-0002b710: 6465 6620 746f 5f73 7461 636b 6564 5f61  def to_stacked_a
-0002b720: 7272 6179 280a 2020 2020 2020 2020 7365  rray(.        se
-0002b730: 6c66 2c0a 2020 2020 2020 2020 6e65 775f  lf,.        new_
-0002b740: 6469 6d3a 2048 6173 6861 626c 652c 0a20  dim: Hashable,. 
-0002b750: 2020 2020 2020 2073 616d 706c 655f 6469         sample_di
-0002b760: 6d73 3a20 436f 6c6c 6563 7469 6f6e 5b48  ms: Collection[H
-0002b770: 6173 6861 626c 655d 2c0a 2020 2020 2020  ashable],.      
-0002b780: 2020 7661 7269 6162 6c65 5f64 696d 3a20    variable_dim: 
-0002b790: 4861 7368 6162 6c65 203d 2022 7661 7269  Hashable = "vari
-0002b7a0: 6162 6c65 222c 0a20 2020 2020 2020 206e  able",.        n
-0002b7b0: 616d 653a 2048 6173 6861 626c 6520 7c20  ame: Hashable | 
-0002b7c0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-0002b7d0: 2029 202d 3e20 4461 7461 4172 7261 793a   ) -> DataArray:
-0002b7e0: 0a20 2020 2020 2020 2022 2222 436f 6d62  .        """Comb
-0002b7f0: 696e 6520 7661 7269 6162 6c65 7320 6f66  ine variables of
-0002b800: 2064 6966 6665 7269 6e67 2064 696d 656e   differing dimen
-0002b810: 7369 6f6e 616c 6974 7920 696e 746f 2061  sionality into a
-0002b820: 2044 6174 6141 7272 6179 0a20 2020 2020   DataArray.     
-0002b830: 2020 2077 6974 686f 7574 2062 726f 6164     without broad
-0002b840: 6361 7374 696e 672e 0a0a 2020 2020 2020  casting...      
-0002b850: 2020 5468 6973 206d 6574 686f 6420 6973    This method is
-0002b860: 2073 696d 696c 6172 2074 6f20 4461 7461   similar to Data
-0002b870: 7365 742e 746f 5f61 7272 6179 2062 7574  set.to_array but
-0002b880: 2064 6f65 7320 6e6f 7420 6272 6f61 6463   does not broadc
-0002b890: 6173 7420 7468 650a 2020 2020 2020 2020  ast the.        
-0002b8a0: 7661 7269 6162 6c65 732e 0a0a 2020 2020  variables...    
-0002b8b0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-0002b8c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0002b8d0: 2d0a 2020 2020 2020 2020 6e65 775f 6469  -.        new_di
-0002b8e0: 6d20 3a20 6861 7368 6162 6c65 0a20 2020  m : hashable.   
-0002b8f0: 2020 2020 2020 2020 204e 616d 6520 6f66           Name of
-0002b900: 2074 6865 206e 6577 2073 7461 636b 6564   the new stacked
-0002b910: 2063 6f6f 7264 696e 6174 650a 2020 2020   coordinate.    
-0002b920: 2020 2020 7361 6d70 6c65 5f64 696d 7320      sample_dims 
-0002b930: 3a20 436f 6c6c 6563 7469 6f6e 206f 6620  : Collection of 
-0002b940: 6861 7368 6162 6c65 730a 2020 2020 2020  hashables.      
-0002b950: 2020 2020 2020 4c69 7374 206f 6620 6469        List of di
-0002b960: 6d65 6e73 696f 6e73 2074 6861 7420 2a2a  mensions that **
-0002b970: 7769 6c6c 206e 6f74 2a2a 2062 6520 7374  will not** be st
-0002b980: 6163 6b65 642e 2045 6163 6820 6172 7261  acked. Each arra
-0002b990: 7920 696e 2074 6865 0a20 2020 2020 2020  y in the.       
-0002b9a0: 2020 2020 2064 6174 6173 6574 206d 7573       dataset mus
-0002b9b0: 7420 7368 6172 6520 7468 6573 6520 6469  t share these di
-0002b9c0: 6d65 6e73 696f 6e73 2e20 466f 7220 6d61  mensions. For ma
-0002b9d0: 6368 696e 6520 6c65 6172 6e69 6e67 0a20  chine learning. 
-0002b9e0: 2020 2020 2020 2020 2020 2061 7070 6c69             appli
-0002b9f0: 6361 7469 6f6e 732c 2074 6865 7365 2064  cations, these d
-0002ba00: 6566 696e 6520 7468 6520 6469 6d65 6e73  efine the dimens
-0002ba10: 696f 6e73 206f 7665 7220 7768 6963 6820  ions over which 
-0002ba20: 7361 6d70 6c65 7320 6172 650a 2020 2020  samples are.    
-0002ba30: 2020 2020 2020 2020 6472 6177 6e2e 0a20          drawn.. 
-0002ba40: 2020 2020 2020 2076 6172 6961 626c 655f         variable_
-0002ba50: 6469 6d20 3a20 6861 7368 6162 6c65 2c20  dim : hashable, 
-0002ba60: 6465 6661 756c 743a 2022 7661 7269 6162  default: "variab
-0002ba70: 6c65 220a 2020 2020 2020 2020 2020 2020  le".            
-0002ba80: 4e61 6d65 206f 6620 7468 6520 6c65 7665  Name of the leve
-0002ba90: 6c20 696e 2074 6865 2073 7461 636b 6564  l in the stacked
-0002baa0: 2063 6f6f 7264 696e 6174 6520 7768 6963   coordinate whic
-0002bab0: 6820 636f 7272 6573 706f 6e64 7320 746f  h corresponds to
-0002bac0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0002bad0: 2076 6172 6961 626c 6573 2e0a 2020 2020   variables..    
-0002bae0: 2020 2020 6e61 6d65 203a 2068 6173 6861      name : hasha
-0002baf0: 626c 652c 206f 7074 696f 6e61 6c0a 2020  ble, optional.  
-0002bb00: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
-0002bb10: 6620 7468 6520 6e65 7720 6461 7461 2061  f the new data a
-0002bb20: 7272 6179 2e0a 0a20 2020 2020 2020 2052  rray...        R
-0002bb30: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-0002bb40: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2073  ------.        s
-0002bb50: 7461 636b 6564 203a 2044 6174 6141 7272  tacked : DataArr
-0002bb60: 6179 0a20 2020 2020 2020 2020 2020 2044  ay.            D
-0002bb70: 6174 6141 7272 6179 2077 6974 6820 7468  ataArray with th
-0002bb80: 6520 7370 6563 6966 6965 6420 6469 6d65  e specified dime
-0002bb90: 6e73 696f 6e73 2061 6e64 2064 6174 6120  nsions and data 
-0002bba0: 7661 7269 6162 6c65 730a 2020 2020 2020  variables.      
-0002bbb0: 2020 2020 2020 7374 6163 6b65 6420 746f        stacked to
-0002bbc0: 6765 7468 6572 2e20 5468 6520 7374 6163  gether. The stac
-0002bbd0: 6b65 6420 636f 6f72 6469 6e61 7465 2069  ked coordinate i
-0002bbe0: 7320 6e61 6d65 6420 6060 6e65 775f 6469  s named ``new_di
-0002bbf0: 6d60 600a 2020 2020 2020 2020 2020 2020  m``.            
-0002bc00: 616e 6420 7265 7072 6573 656e 7465 6420  and represented 
-0002bc10: 6279 2061 204d 756c 7469 496e 6465 7820  by a MultiIndex 
-0002bc20: 6f62 6a65 6374 2077 6974 6820 6120 6c65  object with a le
-0002bc30: 7665 6c20 636f 6e74 6169 6e69 6e67 2074  vel containing t
-0002bc40: 6865 0a20 2020 2020 2020 2020 2020 2064  he.            d
-0002bc50: 6174 6120 7661 7269 6162 6c65 206e 616d  ata variable nam
-0002bc60: 6573 2e20 5468 6520 6e61 6d65 206f 6620  es. The name of 
-0002bc70: 7468 6973 206c 6576 656c 2069 7320 636f  this level is co
-0002bc80: 6e74 726f 6c6c 6564 2075 7369 6e67 0a20  ntrolled using. 
-0002bc90: 2020 2020 2020 2020 2020 2074 6865 2060             the `
-0002bca0: 6076 6172 6961 626c 655f 6469 6d60 6020  `variable_dim`` 
-0002bcb0: 6172 6775 6d65 6e74 2e0a 0a20 2020 2020  argument...     
-0002bcc0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-0002bcd0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0002bce0: 2020 2020 2044 6174 6173 6574 2e74 6f5f       Dataset.to_
-0002bcf0: 6172 7261 790a 2020 2020 2020 2020 4461  array.        Da
-0002bd00: 7461 7365 742e 7374 6163 6b0a 2020 2020  taset.stack.    
-0002bd10: 2020 2020 4461 7461 4172 7261 792e 746f      DataArray.to
-0002bd20: 5f75 6e73 7461 636b 6564 5f64 6174 6173  _unstacked_datas
-0002bd30: 6574 0a0a 2020 2020 2020 2020 4578 616d  et..        Exam
-0002bd40: 706c 6573 0a20 2020 2020 2020 202d 2d2d  ples.        ---
-0002bd50: 2d2d 2d2d 2d0a 2020 2020 2020 2020 3e3e  -----.        >>
-0002bd60: 3e20 6461 7461 203d 2078 722e 4461 7461  > data = xr.Data
-0002bd70: 7365 7428 0a20 2020 2020 2020 202e 2e2e  set(.        ...
-0002bd80: 2020 2020 2064 6174 615f 7661 7273 3d7b       data_vars={
-0002bd90: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0002bda0: 2020 2020 2022 6122 3a20 2828 2278 222c       "a": (("x",
-0002bdb0: 2022 7922 292c 205b 5b30 2c20 312c 2032   "y"), [[0, 1, 2
-0002bdc0: 5d2c 205b 332c 2034 2c20 355d 5d29 2c0a  ], [3, 4, 5]]),.
-0002bdd0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0002bde0: 2020 2020 2262 223a 2028 2278 222c 205b      "b": ("x", [
-0002bdf0: 362c 2037 5d29 2c0a 2020 2020 2020 2020  6, 7]),.        
-0002be00: 2e2e 2e20 2020 2020 7d2c 0a20 2020 2020  ...     },.     
-0002be10: 2020 202e 2e2e 2020 2020 2063 6f6f 7264     ...     coord
-0002be20: 733d 7b22 7922 3a20 5b22 7522 2c20 2276  s={"y": ["u", "v
-0002be30: 222c 2022 7722 5d7d 2c0a 2020 2020 2020  ", "w"]},.      
-0002be40: 2020 2e2e 2e20 290a 0a20 2020 2020 2020    ... )..       
-0002be50: 203e 3e3e 2064 6174 610a 2020 2020 2020   >>> data.      
-0002be60: 2020 3c78 6172 7261 792e 4461 7461 7365    <xarray.Datase
-0002be70: 743e 0a20 2020 2020 2020 2044 696d 656e  t>.        Dimen
-0002be80: 7369 6f6e 733a 2020 2878 3a20 322c 2079  sions:  (x: 2, y
-0002be90: 3a20 3329 0a20 2020 2020 2020 2043 6f6f  : 3).        Coo
-0002bea0: 7264 696e 6174 6573 3a0a 2020 2020 2020  rdinates:.      
-0002beb0: 2020 2020 2a20 7920 2020 2020 2020 2028      * y        (
-0002bec0: 7929 203c 5531 2027 7527 2027 7627 2027  y) <U1 'u' 'v' '
-0002bed0: 7727 0a20 2020 2020 2020 2044 696d 656e  w'.        Dimen
-0002bee0: 7369 6f6e 7320 7769 7468 6f75 7420 636f  sions without co
-0002bef0: 6f72 6469 6e61 7465 733a 2078 0a20 2020  ordinates: x.   
-0002bf00: 2020 2020 2044 6174 6120 7661 7269 6162       Data variab
-0002bf10: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
-0002bf20: 2061 2020 2020 2020 2020 2878 2c20 7929   a        (x, y)
-0002bf30: 2069 6e74 3634 2030 2031 2032 2033 2034   int64 0 1 2 3 4
-0002bf40: 2035 0a20 2020 2020 2020 2020 2020 2062   5.            b
-0002bf50: 2020 2020 2020 2020 2878 2920 696e 7436          (x) int6
-0002bf60: 3420 3620 370a 0a20 2020 2020 2020 203e  4 6 7..        >
-0002bf70: 3e3e 2064 6174 612e 746f 5f73 7461 636b  >> data.to_stack
-0002bf80: 6564 5f61 7272 6179 2822 7a22 2c20 7361  ed_array("z", sa
-0002bf90: 6d70 6c65 5f64 696d 733d 5b22 7822 5d29  mple_dims=["x"])
-0002bfa0: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
-0002bfb0: 2e44 6174 6141 7272 6179 2027 6127 2028  .DataArray 'a' (
-0002bfc0: 783a 2032 2c20 7a3a 2034 293e 0a20 2020  x: 2, z: 4)>.   
-0002bfd0: 2020 2020 2061 7272 6179 285b 5b30 2c20       array([[0, 
-0002bfe0: 312c 2032 2c20 365d 2c0a 2020 2020 2020  1, 2, 6],.      
-0002bff0: 2020 2020 2020 2020 205b 332c 2034 2c20           [3, 4, 
-0002c000: 352c 2037 5d5d 290a 2020 2020 2020 2020  5, 7]]).        
-0002c010: 436f 6f72 6469 6e61 7465 733a 0a20 2020  Coordinates:.   
-0002c020: 2020 2020 2020 202a 207a 2020 2020 2020         * z      
-0002c030: 2020 2028 7a29 206f 626a 6563 7420 4d75     (z) object Mu
-0002c040: 6c74 6949 6e64 6578 0a20 2020 2020 2020  ltiIndex.       
-0002c050: 2020 202a 2076 6172 6961 626c 6520 2028     * variable  (
-0002c060: 7a29 206f 626a 6563 7420 2761 2720 2761  z) object 'a' 'a
-0002c070: 2720 2761 2720 2762 270a 2020 2020 2020  ' 'a' 'b'.      
-0002c080: 2020 2020 2a20 7920 2020 2020 2020 2020      * y         
-0002c090: 287a 2920 6f62 6a65 6374 2027 7527 2027  (z) object 'u' '
-0002c0a0: 7627 2027 7727 206e 616e 0a20 2020 2020  v' 'w' nan.     
-0002c0b0: 2020 2044 696d 656e 7369 6f6e 7320 7769     Dimensions wi
-0002c0c0: 7468 6f75 7420 636f 6f72 6469 6e61 7465  thout coordinate
-0002c0d0: 733a 2078 0a0a 2020 2020 2020 2020 2222  s: x..        ""
-0002c0e0: 220a 2020 2020 2020 2020 6672 6f6d 2078  ".        from x
-0002c0f0: 6172 7261 792e 636f 7265 2e63 6f6e 6361  array.core.conca
-0002c100: 7420 696d 706f 7274 2063 6f6e 6361 740a  t import concat.
-0002c110: 0a20 2020 2020 2020 2073 7461 636b 696e  .        stackin
-0002c120: 675f 6469 6d73 203d 2074 7570 6c65 2864  g_dims = tuple(d
-0002c130: 696d 2066 6f72 2064 696d 2069 6e20 7365  im for dim in se
-0002c140: 6c66 2e64 696d 7320 6966 2064 696d 206e  lf.dims if dim n
-0002c150: 6f74 2069 6e20 7361 6d70 6c65 5f64 696d  ot in sample_dim
-0002c160: 7329 0a0a 2020 2020 2020 2020 666f 7220  s)..        for 
-0002c170: 7661 7269 6162 6c65 2069 6e20 7365 6c66  variable in self
-0002c180: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-0002c190: 6d73 203d 2073 656c 665b 7661 7269 6162  ms = self[variab
-0002c1a0: 6c65 5d2e 6469 6d73 0a20 2020 2020 2020  le].dims.       
-0002c1b0: 2020 2020 2064 696d 735f 696e 636c 7564       dims_includ
-0002c1c0: 655f 7361 6d70 6c65 5f64 696d 7320 3d20  e_sample_dims = 
-0002c1d0: 7365 7428 7361 6d70 6c65 5f64 696d 7329  set(sample_dims)
-0002c1e0: 203c 3d20 7365 7428 6469 6d73 290a 2020   <= set(dims).  
-0002c1f0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0002c200: 2064 696d 735f 696e 636c 7564 655f 7361   dims_include_sa
-0002c210: 6d70 6c65 5f64 696d 733a 0a20 2020 2020  mple_dims:.     
-0002c220: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0002c230: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-0002c240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c250: 2022 416c 6c20 7661 7269 6162 6c65 7320   "All variables 
-0002c260: 696e 2074 6865 2064 6174 6173 6574 206d  in the dataset m
-0002c270: 7573 7420 636f 6e74 6169 6e20 7468 6520  ust contain the 
-0002c280: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0002c290: 2020 2020 2020 2264 696d 656e 7369 6f6e        "dimension
-0002c2a0: 7320 7b7d 2e22 2e66 6f72 6d61 7428 6469  s {}.".format(di
-0002c2b0: 6d73 290a 2020 2020 2020 2020 2020 2020  ms).            
-0002c2c0: 2020 2020 290a 0a20 2020 2020 2020 2064      )..        d
-0002c2d0: 6566 2065 6e73 7572 655f 7374 6163 6b61  ef ensure_stacka
-0002c2e0: 626c 6528 7661 6c29 3a0a 2020 2020 2020  ble(val):.      
-0002c2f0: 2020 2020 2020 6173 7369 676e 5f63 6f6f        assign_coo
-0002c300: 7264 7320 3d20 7b76 6172 6961 626c 655f  rds = {variable_
-0002c310: 6469 6d3a 2076 616c 2e6e 616d 657d 0a20  dim: val.name}. 
-0002c320: 2020 2020 2020 2020 2020 2066 6f72 2064             for d
-0002c330: 696d 2069 6e20 7374 6163 6b69 6e67 5f64  im in stacking_d
-0002c340: 696d 733a 0a20 2020 2020 2020 2020 2020  ims:.           
-0002c350: 2020 2020 2069 6620 6469 6d20 6e6f 7420       if dim not 
-0002c360: 696e 2076 616c 2e64 696d 733a 0a20 2020  in val.dims:.   
-0002c370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c380: 2061 7373 6967 6e5f 636f 6f72 6473 5b64   assign_coords[d
-0002c390: 696d 5d20 3d20 4e6f 6e65 0a0a 2020 2020  im] = None..    
-0002c3a0: 2020 2020 2020 2020 6578 7061 6e64 5f64          expand_d
-0002c3b0: 696d 7320 3d20 7365 7428 7374 6163 6b69  ims = set(stacki
-0002c3c0: 6e67 5f64 696d 7329 2e64 6966 6665 7265  ng_dims).differe
-0002c3d0: 6e63 6528 7365 7428 7661 6c2e 6469 6d73  nce(set(val.dims
-0002c3e0: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
-0002c3f0: 7870 616e 645f 6469 6d73 2e61 6464 2876  xpand_dims.add(v
-0002c400: 6172 6961 626c 655f 6469 6d29 0a20 2020  ariable_dim).   
-0002c410: 2020 2020 2020 2020 2023 206d 7573 7420           # must 
-0002c420: 6265 206c 6973 7420 666f 7220 2e65 7870  be list for .exp
-0002c430: 616e 645f 6469 6d73 0a20 2020 2020 2020  and_dims.       
-0002c440: 2020 2020 2065 7870 616e 645f 6469 6d73       expand_dims
-0002c450: 203d 206c 6973 7428 6578 7061 6e64 5f64   = list(expand_d
-0002c460: 696d 7329 0a0a 2020 2020 2020 2020 2020  ims)..          
-0002c470: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-0002c480: 2020 2020 2020 2020 2020 2076 616c 2e61             val.a
-0002c490: 7373 6967 6e5f 636f 6f72 6473 282a 2a61  ssign_coords(**a
-0002c4a0: 7373 6967 6e5f 636f 6f72 6473 290a 2020  ssign_coords).  
-0002c4b0: 2020 2020 2020 2020 2020 2020 2020 2e65                .e
-0002c4c0: 7870 616e 645f 6469 6d73 2865 7870 616e  xpand_dims(expan
-0002c4d0: 645f 6469 6d73 290a 2020 2020 2020 2020  d_dims).        
-0002c4e0: 2020 2020 2020 2020 2e73 7461 636b 287b          .stack({
-0002c4f0: 6e65 775f 6469 6d3a 2028 7661 7269 6162  new_dim: (variab
-0002c500: 6c65 5f64 696d 2c29 202b 2073 7461 636b  le_dim,) + stack
-0002c510: 696e 675f 6469 6d73 7d29 0a20 2020 2020  ing_dims}).     
-0002c520: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0002c530: 2020 2320 636f 6e63 6174 656e 6174 6520    # concatenate 
-0002c540: 7468 6520 6172 7261 7973 0a20 2020 2020  the arrays.     
-0002c550: 2020 2073 7461 636b 6162 6c65 5f76 6172     stackable_var
-0002c560: 7320 3d20 5b65 6e73 7572 655f 7374 6163  s = [ensure_stac
-0002c570: 6b61 626c 6528 7365 6c66 5b6b 6579 5d29  kable(self[key])
-0002c580: 2066 6f72 206b 6579 2069 6e20 7365 6c66   for key in self
-0002c590: 2e64 6174 615f 7661 7273 5d0a 2020 2020  .data_vars].    
-0002c5a0: 2020 2020 6461 7461 5f61 7272 6179 203d      data_array =
-0002c5b0: 2063 6f6e 6361 7428 7374 6163 6b61 626c   concat(stackabl
-0002c5c0: 655f 7661 7273 2c20 6469 6d3d 6e65 775f  e_vars, dim=new_
-0002c5d0: 6469 6d29 0a0a 2020 2020 2020 2020 6966  dim)..        if
-0002c5e0: 206e 616d 6520 6973 206e 6f74 204e 6f6e   name is not Non
-0002c5f0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-0002c600: 6174 615f 6172 7261 792e 6e61 6d65 203d  ata_array.name =
-0002c610: 206e 616d 650a 0a20 2020 2020 2020 2072   name..        r
-0002c620: 6574 7572 6e20 6461 7461 5f61 7272 6179  eturn data_array
-0002c630: 0a0a 2020 2020 6465 6620 5f75 6e73 7461  ..    def _unsta
-0002c640: 636b 5f6f 6e63 6528 0a20 2020 2020 2020  ck_once(.       
-0002c650: 2073 656c 663a 2054 5f44 6174 6173 6574   self: T_Dataset
-0002c660: 2c0a 2020 2020 2020 2020 6469 6d3a 2048  ,.        dim: H
-0002c670: 6173 6861 626c 652c 0a20 2020 2020 2020  ashable,.       
-0002c680: 2069 6e64 6578 5f61 6e64 5f76 6172 733a   index_and_vars:
-0002c690: 2074 7570 6c65 5b49 6e64 6578 2c20 6469   tuple[Index, di
-0002c6a0: 6374 5b48 6173 6861 626c 652c 2056 6172  ct[Hashable, Var
-0002c6b0: 6961 626c 655d 5d2c 0a20 2020 2020 2020  iable]],.       
-0002c6c0: 2066 696c 6c5f 7661 6c75 652c 0a20 2020   fill_value,.   
-0002c6d0: 2020 2020 2073 7061 7273 653a 2062 6f6f       sparse: boo
-0002c6e0: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
-0002c6f0: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
-0002c700: 2020 2020 2020 2069 6e64 6578 2c20 696e         index, in
-0002c710: 6465 785f 7661 7273 203d 2069 6e64 6578  dex_vars = index
-0002c720: 5f61 6e64 5f76 6172 730a 2020 2020 2020  _and_vars.      
-0002c730: 2020 7661 7269 6162 6c65 733a 2064 6963    variables: dic
-0002c740: 745b 4861 7368 6162 6c65 2c20 5661 7269  t[Hashable, Vari
-0002c750: 6162 6c65 5d20 3d20 7b7d 0a20 2020 2020  able] = {}.     
-0002c760: 2020 2069 6e64 6578 6573 203d 207b 6b3a     indexes = {k:
-0002c770: 2076 2066 6f72 206b 2c20 7620 696e 2073   v for k, v in s
-0002c780: 656c 662e 5f69 6e64 6578 6573 2e69 7465  elf._indexes.ite
-0002c790: 6d73 2829 2069 6620 6b20 213d 2064 696d  ms() if k != dim
-0002c7a0: 7d0a 0a20 2020 2020 2020 206e 6577 5f69  }..        new_i
-0002c7b0: 6e64 6578 6573 2c20 636c 6561 6e5f 696e  ndexes, clean_in
-0002c7c0: 6465 7820 3d20 696e 6465 782e 756e 7374  dex = index.unst
-0002c7d0: 6163 6b28 290a 2020 2020 2020 2020 696e  ack().        in
-0002c7e0: 6465 7865 732e 7570 6461 7465 286e 6577  dexes.update(new
-0002c7f0: 5f69 6e64 6578 6573 290a 0a20 2020 2020  _indexes)..     
-0002c800: 2020 2066 6f72 206e 616d 652c 2069 6478     for name, idx
-0002c810: 2069 6e20 6e65 775f 696e 6465 7865 732e   in new_indexes.
-0002c820: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-0002c830: 2020 2020 2076 6172 6961 626c 6573 2e75       variables.u
-0002c840: 7064 6174 6528 6964 782e 6372 6561 7465  pdate(idx.create
-0002c850: 5f76 6172 6961 626c 6573 2869 6e64 6578  _variables(index
-0002c860: 5f76 6172 7329 290a 0a20 2020 2020 2020  _vars))..       
-0002c870: 2066 6f72 206e 616d 652c 2076 6172 2069   for name, var i
-0002c880: 6e20 7365 6c66 2e76 6172 6961 626c 6573  n self.variables
-0002c890: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-0002c8a0: 2020 2020 2020 6966 206e 616d 6520 6e6f        if name no
-0002c8b0: 7420 696e 2069 6e64 6578 5f76 6172 733a  t in index_vars:
-0002c8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002c8d0: 2069 6620 6469 6d20 696e 2076 6172 2e64   if dim in var.d
-0002c8e0: 696d 733a 0a20 2020 2020 2020 2020 2020  ims:.           
-0002c8f0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-0002c900: 7374 616e 6365 2866 696c 6c5f 7661 6c75  stance(fill_valu
-0002c910: 652c 204d 6170 7069 6e67 293a 0a20 2020  e, Mapping):.   
-0002c920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c930: 2020 2020 2066 696c 6c5f 7661 6c75 655f       fill_value_
-0002c940: 203d 2066 696c 6c5f 7661 6c75 655b 6e61   = fill_value[na
-0002c950: 6d65 5d0a 2020 2020 2020 2020 2020 2020  me].            
-0002c960: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0002c970: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c980: 2020 2020 2020 6669 6c6c 5f76 616c 7565        fill_value
-0002c990: 5f20 3d20 6669 6c6c 5f76 616c 7565 0a0a  _ = fill_value..
-0002c9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9b0: 2020 2020 7661 7269 6162 6c65 735b 6e61      variables[na
-0002c9c0: 6d65 5d20 3d20 7661 722e 5f75 6e73 7461  me] = var._unsta
-0002c9d0: 636b 5f6f 6e63 6528 0a20 2020 2020 2020  ck_once(.       
-0002c9e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002c9f0: 2069 6e64 6578 3d63 6c65 616e 5f69 6e64   index=clean_ind
-0002ca00: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-0002ca10: 2020 2020 2020 2020 2020 2020 6469 6d3d              dim=
-0002ca20: 6469 6d2c 0a20 2020 2020 2020 2020 2020  dim,.           
-0002ca30: 2020 2020 2020 2020 2020 2020 2066 696c               fil
-0002ca40: 6c5f 7661 6c75 653d 6669 6c6c 5f76 616c  l_value=fill_val
-0002ca50: 7565 5f2c 0a20 2020 2020 2020 2020 2020  ue_,.           
-0002ca60: 2020 2020 2020 2020 2020 2020 2073 7061               spa
-0002ca70: 7273 653d 7370 6172 7365 2c0a 2020 2020  rse=sparse,.    
+0002a380: 2020 2020 2020 6622 6361 6e6e 6f74 2073        f"cannot s
+0002a390: 7461 636b 2064 696d 656e 7369 6f6e 207b  tack dimension {
+0002a3a0: 6469 6d21 727d 2077 6974 6820 6063 7265  dim!r} with `cre
+0002a3b0: 6174 655f 696e 6465 783d 5472 7565 6020  ate_index=True` 
+0002a3c0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0002a3d0: 2020 2020 2020 2020 2020 2020 2020 2261                "a
+0002a3e0: 6e64 2077 6974 6820 6d6f 7265 2074 6861  nd with more tha
+0002a3f0: 6e20 6f6e 6520 696e 6465 7820 666f 756e  n one index foun
+0002a400: 6420 616c 6f6e 6720 7468 6174 2064 696d  d along that dim
+0002a410: 656e 7369 6f6e 220a 2020 2020 2020 2020  ension".        
+0002a420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002a430: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002a440: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+0002a450: 652c 207b 7d0a 2020 2020 2020 2020 2020  e, {}.          
+0002a460: 2020 2020 2020 7374 6163 6b5f 696e 6465        stack_inde
+0002a470: 7820 3d20 696e 6465 780a 2020 2020 2020  x = index.      
+0002a480: 2020 2020 2020 2020 2020 7374 6163 6b5f            stack_
+0002a490: 636f 6f72 6473 5b6e 616d 655d 203d 2076  coords[name] = v
+0002a4a0: 6172 0a0a 2020 2020 2020 2020 6966 2063  ar..        if c
+0002a4b0: 7265 6174 655f 696e 6465 7820 616e 6420  reate_index and 
+0002a4c0: 7374 6163 6b5f 696e 6465 7820 6973 204e  stack_index is N
+0002a4d0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+0002a4e0: 2069 6620 6469 6d20 696e 2073 656c 662e   if dim in self.
+0002a4f0: 5f76 6172 6961 626c 6573 3a0a 2020 2020  _variables:.    
+0002a500: 2020 2020 2020 2020 2020 2020 7661 7220              var 
+0002a510: 3d20 7365 6c66 2e5f 7661 7269 6162 6c65  = self._variable
+0002a520: 735b 6469 6d5d 0a20 2020 2020 2020 2020  s[dim].         
+0002a530: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002a540: 2020 2020 2020 2020 205f 2c20 5f2c 2076           _, _, v
+0002a550: 6172 203d 205f 6765 745f 7669 7274 7561  ar = _get_virtua
+0002a560: 6c5f 7661 7269 6162 6c65 2873 656c 662e  l_variable(self.
+0002a570: 5f76 6172 6961 626c 6573 2c20 6469 6d2c  _variables, dim,
+0002a580: 2073 656c 662e 6469 6d73 290a 2020 2020   self.dims).    
+0002a590: 2020 2020 2020 2020 2320 6475 6d6d 7920          # dummy 
+0002a5a0: 696e 6465 7820 286f 6e6c 7920 6073 7461  index (only `sta
+0002a5b0: 636b 5f63 6f6f 7264 7360 2077 696c 6c20  ck_coords` will 
+0002a5c0: 6265 2075 7365 6420 746f 2063 6f6e 7374  be used to const
+0002a5d0: 7275 6374 2074 6865 206d 756c 7469 2d69  ruct the multi-i
+0002a5e0: 6e64 6578 290a 2020 2020 2020 2020 2020  ndex).          
+0002a5f0: 2020 7374 6163 6b5f 696e 6465 7820 3d20    stack_index = 
+0002a600: 5061 6e64 6173 496e 6465 7828 5b30 5d2c  PandasIndex([0],
+0002a610: 2064 696d 290a 2020 2020 2020 2020 2020   dim).          
+0002a620: 2020 7374 6163 6b5f 636f 6f72 6473 203d    stack_coords =
+0002a630: 207b 6469 6d3a 2076 6172 7d0a 0a20 2020   {dim: var}..   
+0002a640: 2020 2020 2072 6574 7572 6e20 7374 6163       return stac
+0002a650: 6b5f 696e 6465 782c 2073 7461 636b 5f63  k_index, stack_c
+0002a660: 6f6f 7264 730a 0a20 2020 2064 6566 205f  oords..    def _
+0002a670: 7374 6163 6b5f 6f6e 6365 280a 2020 2020  stack_once(.    
+0002a680: 2020 2020 7365 6c66 3a20 545f 4461 7461      self: T_Data
+0002a690: 7365 742c 0a20 2020 2020 2020 2064 696d  set,.        dim
+0002a6a0: 733a 2053 6571 7565 6e63 655b 4861 7368  s: Sequence[Hash
+0002a6b0: 6162 6c65 207c 2065 6c6c 6970 7369 735d  able | ellipsis]
+0002a6c0: 2c0a 2020 2020 2020 2020 6e65 775f 6469  ,.        new_di
+0002a6d0: 6d3a 2048 6173 6861 626c 652c 0a20 2020  m: Hashable,.   
+0002a6e0: 2020 2020 2069 6e64 6578 5f63 6c73 3a20       index_cls: 
+0002a6f0: 7479 7065 5b49 6e64 6578 5d2c 0a20 2020  type[Index],.   
+0002a700: 2020 2020 2063 7265 6174 655f 696e 6465       create_inde
+0002a710: 783a 2062 6f6f 6c20 7c20 4e6f 6e65 203d  x: bool | None =
+0002a720: 2054 7275 652c 0a20 2020 2029 202d 3e20   True,.    ) -> 
+0002a730: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
+0002a740: 2020 2069 6620 6469 6d73 203d 3d20 2e2e     if dims == ..
+0002a750: 2e3a 0a20 2020 2020 2020 2020 2020 2072  .:.            r
+0002a760: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0002a770: 2250 6c65 6173 6520 7573 6520 5b2e 2e2e  "Please use [...
+0002a780: 5d20 666f 7220 6469 6d73 2c20 7261 7468  ] for dims, rath
+0002a790: 6572 2074 6861 6e20 6a75 7374 202e 2e2e  er than just ...
+0002a7a0: 2229 0a20 2020 2020 2020 2069 6620 2e2e  ").        if ..
+0002a7b0: 2e20 696e 2064 696d 733a 0a20 2020 2020  . in dims:.     
+0002a7c0: 2020 2020 2020 2064 696d 7320 3d20 6c69         dims = li
+0002a7d0: 7374 2869 6e66 6978 5f64 696d 7328 6469  st(infix_dims(di
+0002a7e0: 6d73 2c20 7365 6c66 2e64 696d 7329 290a  ms, self.dims)).
+0002a7f0: 0a20 2020 2020 2020 206e 6577 5f76 6172  .        new_var
+0002a800: 6961 626c 6573 3a20 6469 6374 5b48 6173  iables: dict[Has
+0002a810: 6861 626c 652c 2056 6172 6961 626c 655d  hable, Variable]
+0002a820: 203d 207b 7d0a 2020 2020 2020 2020 7374   = {}.        st
+0002a830: 6163 6b65 645f 7661 725f 6e61 6d65 733a  acked_var_names:
+0002a840: 206c 6973 745b 4861 7368 6162 6c65 5d20   list[Hashable] 
+0002a850: 3d20 5b5d 0a20 2020 2020 2020 2064 726f  = [].        dro
+0002a860: 705f 696e 6465 7865 733a 206c 6973 745b  p_indexes: list[
+0002a870: 4861 7368 6162 6c65 5d20 3d20 5b5d 0a0a  Hashable] = []..
+0002a880: 2020 2020 2020 2020 666f 7220 6e61 6d65          for name
+0002a890: 2c20 7661 7220 696e 2073 656c 662e 7661  , var in self.va
+0002a8a0: 7269 6162 6c65 732e 6974 656d 7328 293a  riables.items():
+0002a8b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002a8c0: 616e 7928 6420 696e 2076 6172 2e64 696d  any(d in var.dim
+0002a8d0: 7320 666f 7220 6420 696e 2064 696d 7329  s for d in dims)
+0002a8e0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002a8f0: 2020 6164 645f 6469 6d73 203d 205b 6420    add_dims = [d 
+0002a900: 666f 7220 6420 696e 2064 696d 7320 6966  for d in dims if
+0002a910: 2064 206e 6f74 2069 6e20 7661 722e 6469   d not in var.di
+0002a920: 6d73 5d0a 2020 2020 2020 2020 2020 2020  ms].            
+0002a930: 2020 2020 7664 696d 7320 3d20 6c69 7374      vdims = list
+0002a940: 2876 6172 2e64 696d 7329 202b 2061 6464  (var.dims) + add
+0002a950: 5f64 696d 730a 2020 2020 2020 2020 2020  _dims.          
+0002a960: 2020 2020 2020 7368 6170 6520 3d20 5b73        shape = [s
+0002a970: 656c 662e 6469 6d73 5b64 5d20 666f 7220  elf.dims[d] for 
+0002a980: 6420 696e 2076 6469 6d73 5d0a 2020 2020  d in vdims].    
+0002a990: 2020 2020 2020 2020 2020 2020 6578 705f              exp_
+0002a9a0: 7661 7220 3d20 7661 722e 7365 745f 6469  var = var.set_di
+0002a9b0: 6d73 2876 6469 6d73 2c20 7368 6170 6529  ms(vdims, shape)
+0002a9c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002a9d0: 2073 7461 636b 6564 5f76 6172 203d 2065   stacked_var = e
+0002a9e0: 7870 5f76 6172 2e73 7461 636b 282a 2a7b  xp_var.stack(**{
+0002a9f0: 6e65 775f 6469 6d3a 2064 696d 737d 290a  new_dim: dims}).
+0002aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002aa10: 6e65 775f 7661 7269 6162 6c65 735b 6e61  new_variables[na
+0002aa20: 6d65 5d20 3d20 7374 6163 6b65 645f 7661  me] = stacked_va
+0002aa30: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
+0002aa40: 2020 7374 6163 6b65 645f 7661 725f 6e61    stacked_var_na
+0002aa50: 6d65 732e 6170 7065 6e64 286e 616d 6529  mes.append(name)
+0002aa60: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0002aa70: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0002aa80: 2020 206e 6577 5f76 6172 6961 626c 6573     new_variables
+0002aa90: 5b6e 616d 655d 203d 2076 6172 2e63 6f70  [name] = var.cop
+0002aaa0: 7928 6465 6570 3d46 616c 7365 290a 0a20  y(deep=False).. 
+0002aab0: 2020 2020 2020 2023 2064 726f 7020 696e         # drop in
+0002aac0: 6465 7865 7320 6f66 2073 7461 636b 6564  dexes of stacked
+0002aad0: 2063 6f6f 7264 696e 6174 6573 2028 6966   coordinates (if
+0002aae0: 2061 6e79 290a 2020 2020 2020 2020 666f   any).        fo
+0002aaf0: 7220 6e61 6d65 2069 6e20 7374 6163 6b65  r name in stacke
+0002ab00: 645f 7661 725f 6e61 6d65 733a 0a20 2020  d_var_names:.   
+0002ab10: 2020 2020 2020 2020 2064 726f 705f 696e           drop_in
+0002ab20: 6465 7865 7320 2b3d 206c 6973 7428 7365  dexes += list(se
+0002ab30: 6c66 2e78 696e 6465 7865 732e 6765 745f  lf.xindexes.get_
+0002ab40: 616c 6c5f 636f 6f72 6473 286e 616d 652c  all_coords(name,
+0002ab50: 2065 7272 6f72 733d 2269 676e 6f72 6522   errors="ignore"
+0002ab60: 2929 0a0a 2020 2020 2020 2020 6e65 775f  ))..        new_
+0002ab70: 696e 6465 7865 7320 3d20 7b7d 0a20 2020  indexes = {}.   
+0002ab80: 2020 2020 206e 6577 5f63 6f6f 7264 5f6e       new_coord_n
+0002ab90: 616d 6573 203d 2073 6574 2873 656c 662e  ames = set(self.
+0002aba0: 5f63 6f6f 7264 5f6e 616d 6573 290a 2020  _coord_names).  
+0002abb0: 2020 2020 2020 6966 2063 7265 6174 655f        if create_
+0002abc0: 696e 6465 7820 6f72 2063 7265 6174 655f  index or create_
+0002abd0: 696e 6465 7820 6973 204e 6f6e 653a 0a20  index is None:. 
+0002abe0: 2020 2020 2020 2020 2020 2070 726f 6475             produ
+0002abf0: 6374 5f76 6172 733a 2064 6963 745b 416e  ct_vars: dict[An
+0002ac00: 792c 2056 6172 6961 626c 655d 203d 207b  y, Variable] = {
+0002ac10: 7d0a 2020 2020 2020 2020 2020 2020 666f  }.            fo
+0002ac20: 7220 6469 6d20 696e 2064 696d 733a 0a20  r dim in dims:. 
+0002ac30: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002ac40: 6478 2c20 6964 785f 7661 7273 203d 2073  dx, idx_vars = s
+0002ac50: 656c 662e 5f67 6574 5f73 7461 636b 5f69  elf._get_stack_i
+0002ac60: 6e64 6578 2864 696d 2c20 6372 6561 7465  ndex(dim, create
+0002ac70: 5f69 6e64 6578 3d63 7265 6174 655f 696e  _index=create_in
+0002ac80: 6465 7829 0a20 2020 2020 2020 2020 2020  dex).           
+0002ac90: 2020 2020 2069 6620 6964 7820 6973 206e       if idx is n
+0002aca0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+0002acb0: 2020 2020 2020 2020 2020 2020 2070 726f               pro
+0002acc0: 6475 6374 5f76 6172 732e 7570 6461 7465  duct_vars.update
+0002acd0: 2869 6478 5f76 6172 7329 0a0a 2020 2020  (idx_vars)..    
+0002ace0: 2020 2020 2020 2020 6966 206c 656e 2870          if len(p
+0002acf0: 726f 6475 6374 5f76 6172 7329 203d 3d20  roduct_vars) == 
+0002ad00: 6c65 6e28 6469 6d73 293a 0a20 2020 2020  len(dims):.     
+0002ad10: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
+0002ad20: 2069 6e64 6578 5f63 6c73 2e73 7461 636b   index_cls.stack
+0002ad30: 2870 726f 6475 6374 5f76 6172 732c 206e  (product_vars, n
+0002ad40: 6577 5f64 696d 290a 2020 2020 2020 2020  ew_dim).        
+0002ad50: 2020 2020 2020 2020 6e65 775f 696e 6465          new_inde
+0002ad60: 7865 735b 6e65 775f 6469 6d5d 203d 2069  xes[new_dim] = i
+0002ad70: 6478 0a20 2020 2020 2020 2020 2020 2020  dx.             
+0002ad80: 2020 206e 6577 5f69 6e64 6578 6573 2e75     new_indexes.u
+0002ad90: 7064 6174 6528 7b6b 3a20 6964 7820 666f  pdate({k: idx fo
+0002ada0: 7220 6b20 696e 2070 726f 6475 6374 5f76  r k in product_v
+0002adb0: 6172 737d 290a 2020 2020 2020 2020 2020  ars}).          
+0002adc0: 2020 2020 2020 6964 785f 7661 7273 203d        idx_vars =
+0002add0: 2069 6478 2e63 7265 6174 655f 7661 7269   idx.create_vari
+0002ade0: 6162 6c65 7328 7072 6f64 7563 745f 7661  ables(product_va
+0002adf0: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
+0002ae00: 2020 2020 2320 6b65 6570 2063 6f6e 7369      # keep consi
+0002ae10: 7374 656e 7420 6d75 6c74 692d 696e 6465  stent multi-inde
+0002ae20: 7820 636f 6f72 6469 6e61 7465 206f 7264  x coordinate ord
+0002ae30: 6572 0a20 2020 2020 2020 2020 2020 2020  er.             
+0002ae40: 2020 2066 6f72 206b 2069 6e20 6964 785f     for k in idx_
+0002ae50: 7661 7273 3a0a 2020 2020 2020 2020 2020  vars:.          
+0002ae60: 2020 2020 2020 2020 2020 6e65 775f 7661            new_va
+0002ae70: 7269 6162 6c65 732e 706f 7028 6b2c 204e  riables.pop(k, N
+0002ae80: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
+0002ae90: 2020 2020 206e 6577 5f76 6172 6961 626c       new_variabl
+0002aea0: 6573 2e75 7064 6174 6528 6964 785f 7661  es.update(idx_va
+0002aeb0: 7273 290a 2020 2020 2020 2020 2020 2020  rs).            
+0002aec0: 2020 2020 6e65 775f 636f 6f72 645f 6e61      new_coord_na
+0002aed0: 6d65 732e 7570 6461 7465 2869 6478 5f76  mes.update(idx_v
+0002aee0: 6172 7329 0a0a 2020 2020 2020 2020 696e  ars)..        in
+0002aef0: 6465 7865 7320 3d20 7b6b 3a20 7620 666f  dexes = {k: v fo
+0002af00: 7220 6b2c 2076 2069 6e20 7365 6c66 2e5f  r k, v in self._
+0002af10: 696e 6465 7865 732e 6974 656d 7328 2920  indexes.items() 
+0002af20: 6966 206b 206e 6f74 2069 6e20 6472 6f70  if k not in drop
+0002af30: 5f69 6e64 6578 6573 7d0a 2020 2020 2020  _indexes}.      
+0002af40: 2020 696e 6465 7865 732e 7570 6461 7465    indexes.update
+0002af50: 286e 6577 5f69 6e64 6578 6573 290a 0a20  (new_indexes).. 
+0002af60: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0002af70: 6c66 2e5f 7265 706c 6163 655f 7769 7468  lf._replace_with
+0002af80: 5f6e 6577 5f64 696d 7328 0a20 2020 2020  _new_dims(.     
+0002af90: 2020 2020 2020 206e 6577 5f76 6172 6961         new_varia
+0002afa0: 626c 6573 2c20 636f 6f72 645f 6e61 6d65  bles, coord_name
+0002afb0: 733d 6e65 775f 636f 6f72 645f 6e61 6d65  s=new_coord_name
+0002afc0: 732c 2069 6e64 6578 6573 3d69 6e64 6578  s, indexes=index
+0002afd0: 6573 0a20 2020 2020 2020 2029 0a0a 2020  es.        )..  
+0002afe0: 2020 6465 6620 7374 6163 6b28 0a20 2020    def stack(.   
+0002aff0: 2020 2020 2073 656c 663a 2054 5f44 6174       self: T_Dat
+0002b000: 6173 6574 2c0a 2020 2020 2020 2020 6469  aset,.        di
+0002b010: 6d65 6e73 696f 6e73 3a20 4d61 7070 696e  mensions: Mappin
+0002b020: 675b 416e 792c 2053 6571 7565 6e63 655b  g[Any, Sequence[
+0002b030: 4861 7368 6162 6c65 207c 2065 6c6c 6970  Hashable | ellip
+0002b040: 7369 735d 5d20 7c20 4e6f 6e65 203d 204e  sis]] | None = N
+0002b050: 6f6e 652c 0a20 2020 2020 2020 2063 7265  one,.        cre
+0002b060: 6174 655f 696e 6465 783a 2062 6f6f 6c20  ate_index: bool 
+0002b070: 7c20 4e6f 6e65 203d 2054 7275 652c 0a20  | None = True,. 
+0002b080: 2020 2020 2020 2069 6e64 6578 5f63 6c73         index_cls
+0002b090: 3a20 7479 7065 5b49 6e64 6578 5d20 3d20  : type[Index] = 
+0002b0a0: 5061 6e64 6173 4d75 6c74 6949 6e64 6578  PandasMultiIndex
+0002b0b0: 2c0a 2020 2020 2020 2020 2a2a 6469 6d65  ,.        **dime
+0002b0c0: 6e73 696f 6e73 5f6b 7761 7267 733a 2053  nsions_kwargs: S
+0002b0d0: 6571 7565 6e63 655b 4861 7368 6162 6c65  equence[Hashable
+0002b0e0: 207c 2065 6c6c 6970 7369 735d 2c0a 2020   | ellipsis],.  
+0002b0f0: 2020 2920 2d3e 2054 5f44 6174 6173 6574    ) -> T_Dataset
+0002b100: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0002b110: 2020 2020 2020 5374 6163 6b20 616e 7920        Stack any 
+0002b120: 6e75 6d62 6572 206f 6620 6578 6973 7469  number of existi
+0002b130: 6e67 2064 696d 656e 7369 6f6e 7320 696e  ng dimensions in
+0002b140: 746f 2061 2073 696e 676c 6520 6e65 7720  to a single new 
+0002b150: 6469 6d65 6e73 696f 6e2e 0a0a 2020 2020  dimension...    
+0002b160: 2020 2020 4e65 7720 6469 6d65 6e73 696f      New dimensio
+0002b170: 6e73 2077 696c 6c20 6265 2061 6464 6564  ns will be added
+0002b180: 2061 7420 7468 6520 656e 642c 2061 6e64   at the end, and
+0002b190: 2062 7920 6465 6661 756c 7420 7468 6520   by default the 
+0002b1a0: 636f 7272 6573 706f 6e64 696e 670a 2020  corresponding.  
+0002b1b0: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+0002b1c0: 2076 6172 6961 626c 6573 2077 696c 6c20   variables will 
+0002b1d0: 6265 2063 6f6d 6269 6e65 6420 696e 746f  be combined into
+0002b1e0: 2061 204d 756c 7469 496e 6465 782e 0a0a   a MultiIndex...
+0002b1f0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0002b200: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0002b210: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6469  -----.        di
+0002b220: 6d65 6e73 696f 6e73 203a 206d 6170 7069  mensions : mappi
+0002b230: 6e67 206f 6620 6861 7368 6162 6c65 2074  ng of hashable t
+0002b240: 6f20 7365 7175 656e 6365 206f 6620 6861  o sequence of ha
+0002b250: 7368 6162 6c65 0a20 2020 2020 2020 2020  shable.         
+0002b260: 2020 204d 6170 7069 6e67 206f 6620 7468     Mapping of th
+0002b270: 6520 666f 726d 2060 6e65 775f 6e61 6d65  e form `new_name
+0002b280: 3d28 6469 6d31 2c20 6469 6d32 2c20 2e2e  =(dim1, dim2, ..
+0002b290: 2e29 602e 204e 616d 6573 206f 6620 6e65  .)`. Names of ne
+0002b2a0: 770a 2020 2020 2020 2020 2020 2020 6469  w.            di
+0002b2b0: 6d65 6e73 696f 6e73 2c20 616e 6420 7468  mensions, and th
+0002b2c0: 6520 6578 6973 7469 6e67 2064 696d 656e  e existing dimen
+0002b2d0: 7369 6f6e 7320 7468 6174 2074 6865 7920  sions that they 
+0002b2e0: 7265 706c 6163 652e 2041 6e0a 2020 2020  replace. An.    
+0002b2f0: 2020 2020 2020 2020 656c 6c69 7073 6973          ellipsis
+0002b300: 2028 602e 2e2e 6029 2077 696c 6c20 6265   (`...`) will be
+0002b310: 2072 6570 6c61 6365 6420 6279 2061 6c6c   replaced by all
+0002b320: 2075 6e6c 6973 7465 6420 6469 6d65 6e73   unlisted dimens
+0002b330: 696f 6e73 2e0a 2020 2020 2020 2020 2020  ions..          
+0002b340: 2020 5061 7373 696e 6720 6120 6c69 7374    Passing a list
+0002b350: 2063 6f6e 7461 696e 696e 6720 616e 2065   containing an e
+0002b360: 6c6c 6970 7369 7320 2860 7374 6163 6b65  llipsis (`stacke
+0002b370: 645f 6469 6d3d 5b2e 2e2e 5d60 2920 7769  d_dim=[...]`) wi
+0002b380: 6c6c 2073 7461 636b 206f 7665 720a 2020  ll stack over.  
+0002b390: 2020 2020 2020 2020 2020 616c 6c20 6469            all di
+0002b3a0: 6d65 6e73 696f 6e73 2e0a 2020 2020 2020  mensions..      
+0002b3b0: 2020 6372 6561 7465 5f69 6e64 6578 203a    create_index :
+0002b3c0: 2062 6f6f 6c20 6f72 204e 6f6e 652c 2064   bool or None, d
+0002b3d0: 6566 6175 6c74 3a20 5472 7565 0a0a 2020  efault: True..  
+0002b3e0: 2020 2020 2020 2020 2020 2d20 5472 7565            - True
+0002b3f0: 3a20 6372 6561 7465 2061 206d 756c 7469  : create a multi
+0002b400: 2d69 6e64 6578 2066 6f72 2065 6163 6820  -index for each 
+0002b410: 6f66 2074 6865 2073 7461 636b 6564 2064  of the stacked d
+0002b420: 696d 656e 7369 6f6e 732e 0a20 2020 2020  imensions..     
+0002b430: 2020 2020 2020 202d 2046 616c 7365 3a20         - False: 
+0002b440: 646f 6e27 7420 6372 6561 7465 2061 6e79  don't create any
+0002b450: 2069 6e64 6578 2e0a 2020 2020 2020 2020   index..        
+0002b460: 2020 2020 2d20 4e6f 6e65 2e20 6372 6561      - None. crea
+0002b470: 7465 2061 206d 756c 7469 2d69 6e64 6578  te a multi-index
+0002b480: 206f 6e6c 7920 6966 2065 7861 6374 6c79   only if exactly
+0002b490: 206f 6e65 2073 696e 676c 6520 2831 2d64   one single (1-d
+0002b4a0: 2920 636f 6f72 6469 6e61 7465 0a20 2020  ) coordinate.   
+0002b4b0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+0002b4c0: 2069 7320 666f 756e 6420 666f 7220 6576   is found for ev
+0002b4d0: 6572 7920 6469 6d65 6e73 696f 6e20 746f  ery dimension to
+0002b4e0: 2073 7461 636b 2e0a 0a20 2020 2020 2020   stack...       
+0002b4f0: 2069 6e64 6578 5f63 6c73 3a20 496e 6465   index_cls: Inde
+0002b500: 782d 636c 6173 732c 2064 6566 6175 6c74  x-class, default
+0002b510: 3a20 5061 6e64 6173 4d75 6c74 6949 6e64  : PandasMultiInd
+0002b520: 6578 0a20 2020 2020 2020 2020 2020 2043  ex.            C
+0002b530: 616e 2062 6520 7573 6564 2074 6f20 7061  an be used to pa
+0002b540: 7373 2061 2063 7573 746f 6d20 6d75 6c74  ss a custom mult
+0002b550: 692d 696e 6465 7820 7479 7065 2028 6d75  i-index type (mu
+0002b560: 7374 2062 6520 616e 2058 6172 7261 7920  st be an Xarray 
+0002b570: 696e 6465 7820 7468 6174 0a20 2020 2020  index that.     
+0002b580: 2020 2020 2020 2069 6d70 6c65 6d65 6e74         implement
+0002b590: 7320 602e 7374 6163 6b28 2960 292e 2042  s `.stack()`). B
+0002b5a0: 7920 6465 6661 756c 742c 2061 2070 616e  y default, a pan
+0002b5b0: 6461 7320 6d75 6c74 692d 696e 6465 7820  das multi-index 
+0002b5c0: 7772 6170 7065 7220 6973 2075 7365 642e  wrapper is used.
+0002b5d0: 0a20 2020 2020 2020 202a 2a64 696d 656e  .        **dimen
+0002b5e0: 7369 6f6e 735f 6b77 6172 6773 0a20 2020  sions_kwargs.   
+0002b5f0: 2020 2020 2020 2020 2054 6865 206b 6579           The key
+0002b600: 776f 7264 2061 7267 756d 656e 7473 2066  word arguments f
+0002b610: 6f72 6d20 6f66 2060 6064 696d 656e 7369  orm of ``dimensi
+0002b620: 6f6e 7360 602e 0a20 2020 2020 2020 2020  ons``..         
+0002b630: 2020 204f 6e65 206f 6620 6469 6d65 6e73     One of dimens
+0002b640: 696f 6e73 206f 7220 6469 6d65 6e73 696f  ions or dimensio
+0002b650: 6e73 5f6b 7761 7267 7320 6d75 7374 2062  ns_kwargs must b
+0002b660: 6520 7072 6f76 6964 6564 2e0a 0a20 2020  e provided...   
+0002b670: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+0002b680: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+0002b690: 2020 2020 2073 7461 636b 6564 203a 2044       stacked : D
+0002b6a0: 6174 6173 6574 0a20 2020 2020 2020 2020  ataset.         
+0002b6b0: 2020 2044 6174 6173 6574 2077 6974 6820     Dataset with 
+0002b6c0: 7374 6163 6b65 6420 6461 7461 2e0a 0a20  stacked data... 
+0002b6d0: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+0002b6e0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002b6f0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
+0002b700: 2e75 6e73 7461 636b 0a20 2020 2020 2020  .unstack.       
+0002b710: 2022 2222 0a20 2020 2020 2020 2064 696d   """.        dim
+0002b720: 656e 7369 6f6e 7320 3d20 6569 7468 6572  ensions = either
+0002b730: 5f64 6963 745f 6f72 5f6b 7761 7267 7328  _dict_or_kwargs(
+0002b740: 6469 6d65 6e73 696f 6e73 2c20 6469 6d65  dimensions, dime
+0002b750: 6e73 696f 6e73 5f6b 7761 7267 732c 2022  nsions_kwargs, "
+0002b760: 7374 6163 6b22 290a 2020 2020 2020 2020  stack").        
+0002b770: 7265 7375 6c74 203d 2073 656c 660a 2020  result = self.  
+0002b780: 2020 2020 2020 666f 7220 6e65 775f 6469        for new_di
+0002b790: 6d2c 2064 696d 7320 696e 2064 696d 656e  m, dims in dimen
+0002b7a0: 7369 6f6e 732e 6974 656d 7328 293a 0a20  sions.items():. 
+0002b7b0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+0002b7c0: 7420 3d20 7265 7375 6c74 2e5f 7374 6163  t = result._stac
+0002b7d0: 6b5f 6f6e 6365 2864 696d 732c 206e 6577  k_once(dims, new
+0002b7e0: 5f64 696d 2c20 696e 6465 785f 636c 732c  _dim, index_cls,
+0002b7f0: 2063 7265 6174 655f 696e 6465 7829 0a20   create_index). 
+0002b800: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+0002b810: 7375 6c74 0a0a 2020 2020 6465 6620 746f  sult..    def to
+0002b820: 5f73 7461 636b 6564 5f61 7272 6179 280a  _stacked_array(.
+0002b830: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0002b840: 2020 2020 2020 6e65 775f 6469 6d3a 2048        new_dim: H
+0002b850: 6173 6861 626c 652c 0a20 2020 2020 2020  ashable,.       
+0002b860: 2073 616d 706c 655f 6469 6d73 3a20 436f   sample_dims: Co
+0002b870: 6c6c 6563 7469 6f6e 5b48 6173 6861 626c  llection[Hashabl
+0002b880: 655d 2c0a 2020 2020 2020 2020 7661 7269  e],.        vari
+0002b890: 6162 6c65 5f64 696d 3a20 4861 7368 6162  able_dim: Hashab
+0002b8a0: 6c65 203d 2022 7661 7269 6162 6c65 222c  le = "variable",
+0002b8b0: 0a20 2020 2020 2020 206e 616d 653a 2048  .        name: H
+0002b8c0: 6173 6861 626c 6520 7c20 4e6f 6e65 203d  ashable | None =
+0002b8d0: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
+0002b8e0: 4461 7461 4172 7261 793a 0a20 2020 2020  DataArray:.     
+0002b8f0: 2020 2022 2222 436f 6d62 696e 6520 7661     """Combine va
+0002b900: 7269 6162 6c65 7320 6f66 2064 6966 6665  riables of diffe
+0002b910: 7269 6e67 2064 696d 656e 7369 6f6e 616c  ring dimensional
+0002b920: 6974 7920 696e 746f 2061 2044 6174 6141  ity into a DataA
+0002b930: 7272 6179 0a20 2020 2020 2020 2077 6974  rray.        wit
+0002b940: 686f 7574 2062 726f 6164 6361 7374 696e  hout broadcastin
+0002b950: 672e 0a0a 2020 2020 2020 2020 5468 6973  g...        This
+0002b960: 206d 6574 686f 6420 6973 2073 696d 696c   method is simil
+0002b970: 6172 2074 6f20 4461 7461 7365 742e 746f  ar to Dataset.to
+0002b980: 5f61 7272 6179 2062 7574 2064 6f65 7320  _array but does 
+0002b990: 6e6f 7420 6272 6f61 6463 6173 7420 7468  not broadcast th
+0002b9a0: 650a 2020 2020 2020 2020 7661 7269 6162  e.        variab
+0002b9b0: 6c65 732e 0a0a 2020 2020 2020 2020 5061  les...        Pa
+0002b9c0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+0002b9d0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+0002b9e0: 2020 2020 6e65 775f 6469 6d20 3a20 6861      new_dim : ha
+0002b9f0: 7368 6162 6c65 0a20 2020 2020 2020 2020  shable.         
+0002ba00: 2020 204e 616d 6520 6f66 2074 6865 206e     Name of the n
+0002ba10: 6577 2073 7461 636b 6564 2063 6f6f 7264  ew stacked coord
+0002ba20: 696e 6174 650a 2020 2020 2020 2020 7361  inate.        sa
+0002ba30: 6d70 6c65 5f64 696d 7320 3a20 436f 6c6c  mple_dims : Coll
+0002ba40: 6563 7469 6f6e 206f 6620 6861 7368 6162  ection of hashab
+0002ba50: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
+0002ba60: 4c69 7374 206f 6620 6469 6d65 6e73 696f  List of dimensio
+0002ba70: 6e73 2074 6861 7420 2a2a 7769 6c6c 206e  ns that **will n
+0002ba80: 6f74 2a2a 2062 6520 7374 6163 6b65 642e  ot** be stacked.
+0002ba90: 2045 6163 6820 6172 7261 7920 696e 2074   Each array in t
+0002baa0: 6865 0a20 2020 2020 2020 2020 2020 2064  he.            d
+0002bab0: 6174 6173 6574 206d 7573 7420 7368 6172  ataset must shar
+0002bac0: 6520 7468 6573 6520 6469 6d65 6e73 696f  e these dimensio
+0002bad0: 6e73 2e20 466f 7220 6d61 6368 696e 6520  ns. For machine 
+0002bae0: 6c65 6172 6e69 6e67 0a20 2020 2020 2020  learning.       
+0002baf0: 2020 2020 2061 7070 6c69 6361 7469 6f6e       application
+0002bb00: 732c 2074 6865 7365 2064 6566 696e 6520  s, these define 
+0002bb10: 7468 6520 6469 6d65 6e73 696f 6e73 206f  the dimensions o
+0002bb20: 7665 7220 7768 6963 6820 7361 6d70 6c65  ver which sample
+0002bb30: 7320 6172 650a 2020 2020 2020 2020 2020  s are.          
+0002bb40: 2020 6472 6177 6e2e 0a20 2020 2020 2020    drawn..       
+0002bb50: 2076 6172 6961 626c 655f 6469 6d20 3a20   variable_dim : 
+0002bb60: 6861 7368 6162 6c65 2c20 6465 6661 756c  hashable, defaul
+0002bb70: 743a 2022 7661 7269 6162 6c65 220a 2020  t: "variable".  
+0002bb80: 2020 2020 2020 2020 2020 4e61 6d65 206f            Name o
+0002bb90: 6620 7468 6520 6c65 7665 6c20 696e 2074  f the level in t
+0002bba0: 6865 2073 7461 636b 6564 2063 6f6f 7264  he stacked coord
+0002bbb0: 696e 6174 6520 7768 6963 6820 636f 7272  inate which corr
+0002bbc0: 6573 706f 6e64 7320 746f 0a20 2020 2020  esponds to.     
+0002bbd0: 2020 2020 2020 2074 6865 2076 6172 6961         the varia
+0002bbe0: 626c 6573 2e0a 2020 2020 2020 2020 6e61  bles..        na
+0002bbf0: 6d65 203a 2068 6173 6861 626c 652c 206f  me : hashable, o
+0002bc00: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0002bc10: 2020 2020 4e61 6d65 206f 6620 7468 6520      Name of the 
+0002bc20: 6e65 7720 6461 7461 2061 7272 6179 2e0a  new data array..
+0002bc30: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0002bc40: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0002bc50: 0a20 2020 2020 2020 2073 7461 636b 6564  .        stacked
+0002bc60: 203a 2044 6174 6141 7272 6179 0a20 2020   : DataArray.   
+0002bc70: 2020 2020 2020 2020 2044 6174 6141 7272           DataArr
+0002bc80: 6179 2077 6974 6820 7468 6520 7370 6563  ay with the spec
+0002bc90: 6966 6965 6420 6469 6d65 6e73 696f 6e73  ified dimensions
+0002bca0: 2061 6e64 2064 6174 6120 7661 7269 6162   and data variab
+0002bcb0: 6c65 730a 2020 2020 2020 2020 2020 2020  les.            
+0002bcc0: 7374 6163 6b65 6420 746f 6765 7468 6572  stacked together
+0002bcd0: 2e20 5468 6520 7374 6163 6b65 6420 636f  . The stacked co
+0002bce0: 6f72 6469 6e61 7465 2069 7320 6e61 6d65  ordinate is name
+0002bcf0: 6420 6060 6e65 775f 6469 6d60 600a 2020  d ``new_dim``.  
+0002bd00: 2020 2020 2020 2020 2020 616e 6420 7265            and re
+0002bd10: 7072 6573 656e 7465 6420 6279 2061 204d  presented by a M
+0002bd20: 756c 7469 496e 6465 7820 6f62 6a65 6374  ultiIndex object
+0002bd30: 2077 6974 6820 6120 6c65 7665 6c20 636f   with a level co
+0002bd40: 6e74 6169 6e69 6e67 2074 6865 0a20 2020  ntaining the.   
+0002bd50: 2020 2020 2020 2020 2064 6174 6120 7661           data va
+0002bd60: 7269 6162 6c65 206e 616d 6573 2e20 5468  riable names. Th
+0002bd70: 6520 6e61 6d65 206f 6620 7468 6973 206c  e name of this l
+0002bd80: 6576 656c 2069 7320 636f 6e74 726f 6c6c  evel is controll
+0002bd90: 6564 2075 7369 6e67 0a20 2020 2020 2020  ed using.       
+0002bda0: 2020 2020 2074 6865 2060 6076 6172 6961       the ``varia
+0002bdb0: 626c 655f 6469 6d60 6020 6172 6775 6d65  ble_dim`` argume
+0002bdc0: 6e74 2e0a 0a20 2020 2020 2020 2053 6565  nt...        See
+0002bdd0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+0002bde0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
+0002bdf0: 6174 6173 6574 2e74 6f5f 6172 7261 790a  ataset.to_array.
+0002be00: 2020 2020 2020 2020 4461 7461 7365 742e          Dataset.
+0002be10: 7374 6163 6b0a 2020 2020 2020 2020 4461  stack.        Da
+0002be20: 7461 4172 7261 792e 746f 5f75 6e73 7461  taArray.to_unsta
+0002be30: 636b 6564 5f64 6174 6173 6574 0a0a 2020  cked_dataset..  
+0002be40: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
+0002be50: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+0002be60: 2020 2020 2020 2020 3e3e 3e20 6461 7461          >>> data
+0002be70: 203d 2078 722e 4461 7461 7365 7428 0a20   = xr.Dataset(. 
+0002be80: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
+0002be90: 6174 615f 7661 7273 3d7b 0a20 2020 2020  ata_vars={.     
+0002bea0: 2020 202e 2e2e 2020 2020 2020 2020 2022     ...         "
+0002beb0: 6122 3a20 2828 2278 222c 2022 7922 292c  a": (("x", "y"),
+0002bec0: 205b 5b30 2c20 312c 2032 5d2c 205b 332c   [[0, 1, 2], [3,
+0002bed0: 2034 2c20 355d 5d29 2c0a 2020 2020 2020   4, 5]]),.      
+0002bee0: 2020 2e2e 2e20 2020 2020 2020 2020 2262    ...         "b
+0002bef0: 223a 2028 2278 222c 205b 362c 2037 5d29  ": ("x", [6, 7])
+0002bf00: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+0002bf10: 2020 7d2c 0a20 2020 2020 2020 202e 2e2e    },.        ...
+0002bf20: 2020 2020 2063 6f6f 7264 733d 7b22 7922       coords={"y"
+0002bf30: 3a20 5b22 7522 2c20 2276 222c 2022 7722  : ["u", "v", "w"
+0002bf40: 5d7d 2c0a 2020 2020 2020 2020 2e2e 2e20  ]},.        ... 
+0002bf50: 290a 0a20 2020 2020 2020 203e 3e3e 2064  )..        >>> d
+0002bf60: 6174 610a 2020 2020 2020 2020 3c78 6172  ata.        <xar
+0002bf70: 7261 792e 4461 7461 7365 743e 0a20 2020  ray.Dataset>.   
+0002bf80: 2020 2020 2044 696d 656e 7369 6f6e 733a       Dimensions:
+0002bf90: 2020 2878 3a20 322c 2079 3a20 3329 0a20    (x: 2, y: 3). 
+0002bfa0: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
+0002bfb0: 6573 3a0a 2020 2020 2020 2020 2020 2a20  es:.          * 
+0002bfc0: 7920 2020 2020 2020 2028 7929 203c 5531  y        (y) <U1
+0002bfd0: 2027 7527 2027 7627 2027 7727 0a20 2020   'u' 'v' 'w'.   
+0002bfe0: 2020 2020 2044 696d 656e 7369 6f6e 7320       Dimensions 
+0002bff0: 7769 7468 6f75 7420 636f 6f72 6469 6e61  without coordina
+0002c000: 7465 733a 2078 0a20 2020 2020 2020 2044  tes: x.        D
+0002c010: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
+0002c020: 2020 2020 2020 2020 2020 2061 2020 2020             a    
+0002c030: 2020 2020 2878 2c20 7929 2069 6e74 3634      (x, y) int64
+0002c040: 2030 2031 2032 2033 2034 2035 0a20 2020   0 1 2 3 4 5.   
+0002c050: 2020 2020 2020 2020 2062 2020 2020 2020           b      
+0002c060: 2020 2878 2920 696e 7436 3420 3620 370a    (x) int64 6 7.
+0002c070: 0a20 2020 2020 2020 203e 3e3e 2064 6174  .        >>> dat
+0002c080: 612e 746f 5f73 7461 636b 6564 5f61 7272  a.to_stacked_arr
+0002c090: 6179 2822 7a22 2c20 7361 6d70 6c65 5f64  ay("z", sample_d
+0002c0a0: 696d 733d 5b22 7822 5d29 0a20 2020 2020  ims=["x"]).     
+0002c0b0: 2020 203c 7861 7272 6179 2e44 6174 6141     <xarray.DataA
+0002c0c0: 7272 6179 2027 6127 2028 783a 2032 2c20  rray 'a' (x: 2, 
+0002c0d0: 7a3a 2034 293e 0a20 2020 2020 2020 2061  z: 4)>.        a
+0002c0e0: 7272 6179 285b 5b30 2c20 312c 2032 2c20  rray([[0, 1, 2, 
+0002c0f0: 365d 2c0a 2020 2020 2020 2020 2020 2020  6],.            
+0002c100: 2020 205b 332c 2034 2c20 352c 2037 5d5d     [3, 4, 5, 7]]
+0002c110: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
+0002c120: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
+0002c130: 202a 207a 2020 2020 2020 2020 2028 7a29   * z         (z)
+0002c140: 206f 626a 6563 7420 4d75 6c74 6949 6e64   object MultiInd
+0002c150: 6578 0a20 2020 2020 2020 2020 202a 2076  ex.          * v
+0002c160: 6172 6961 626c 6520 2028 7a29 206f 626a  ariable  (z) obj
+0002c170: 6563 7420 2761 2720 2761 2720 2761 2720  ect 'a' 'a' 'a' 
+0002c180: 2762 270a 2020 2020 2020 2020 2020 2a20  'b'.          * 
+0002c190: 7920 2020 2020 2020 2020 287a 2920 6f62  y         (z) ob
+0002c1a0: 6a65 6374 2027 7527 2027 7627 2027 7727  ject 'u' 'v' 'w'
+0002c1b0: 206e 616e 0a20 2020 2020 2020 2044 696d   nan.        Dim
+0002c1c0: 656e 7369 6f6e 7320 7769 7468 6f75 7420  ensions without 
+0002c1d0: 636f 6f72 6469 6e61 7465 733a 2078 0a0a  coordinates: x..
+0002c1e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+0002c1f0: 2020 2020 6672 6f6d 2078 6172 7261 792e      from xarray.
+0002c200: 636f 7265 2e63 6f6e 6361 7420 696d 706f  core.concat impo
+0002c210: 7274 2063 6f6e 6361 740a 0a20 2020 2020  rt concat..     
+0002c220: 2020 2073 7461 636b 696e 675f 6469 6d73     stacking_dims
+0002c230: 203d 2074 7570 6c65 2864 696d 2066 6f72   = tuple(dim for
+0002c240: 2064 696d 2069 6e20 7365 6c66 2e64 696d   dim in self.dim
+0002c250: 7320 6966 2064 696d 206e 6f74 2069 6e20  s if dim not in 
+0002c260: 7361 6d70 6c65 5f64 696d 7329 0a0a 2020  sample_dims)..  
+0002c270: 2020 2020 2020 666f 7220 7661 7269 6162        for variab
+0002c280: 6c65 2069 6e20 7365 6c66 3a0a 2020 2020  le in self:.    
+0002c290: 2020 2020 2020 2020 6469 6d73 203d 2073          dims = s
+0002c2a0: 656c 665b 7661 7269 6162 6c65 5d2e 6469  elf[variable].di
+0002c2b0: 6d73 0a20 2020 2020 2020 2020 2020 2064  ms.            d
+0002c2c0: 696d 735f 696e 636c 7564 655f 7361 6d70  ims_include_samp
+0002c2d0: 6c65 5f64 696d 7320 3d20 7365 7428 7361  le_dims = set(sa
+0002c2e0: 6d70 6c65 5f64 696d 7329 203c 3d20 7365  mple_dims) <= se
+0002c2f0: 7428 6469 6d73 290a 2020 2020 2020 2020  t(dims).        
+0002c300: 2020 2020 6966 206e 6f74 2064 696d 735f      if not dims_
+0002c310: 696e 636c 7564 655f 7361 6d70 6c65 5f64  include_sample_d
+0002c320: 696d 733a 0a20 2020 2020 2020 2020 2020  ims:.           
+0002c330: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0002c340: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+0002c350: 2020 2020 2020 2020 2020 2022 416c 6c20             "All 
+0002c360: 7661 7269 6162 6c65 7320 696e 2074 6865  variables in the
+0002c370: 2064 6174 6173 6574 206d 7573 7420 636f   dataset must co
+0002c380: 6e74 6169 6e20 7468 6520 220a 2020 2020  ntain the ".    
+0002c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002c3a0: 2264 696d 656e 7369 6f6e 7320 7b7d 2e22  "dimensions {}."
+0002c3b0: 2e66 6f72 6d61 7428 6469 6d73 290a 2020  .format(dims).  
+0002c3c0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0002c3d0: 0a20 2020 2020 2020 2064 6566 2065 6e73  .        def ens
+0002c3e0: 7572 655f 7374 6163 6b61 626c 6528 7661  ure_stackable(va
+0002c3f0: 6c29 3a0a 2020 2020 2020 2020 2020 2020  l):.            
+0002c400: 6173 7369 676e 5f63 6f6f 7264 7320 3d20  assign_coords = 
+0002c410: 7b76 6172 6961 626c 655f 6469 6d3a 2076  {variable_dim: v
+0002c420: 616c 2e6e 616d 657d 0a20 2020 2020 2020  al.name}.       
+0002c430: 2020 2020 2066 6f72 2064 696d 2069 6e20       for dim in 
+0002c440: 7374 6163 6b69 6e67 5f64 696d 733a 0a20  stacking_dims:. 
+0002c450: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0002c460: 6620 6469 6d20 6e6f 7420 696e 2076 616c  f dim not in val
+0002c470: 2e64 696d 733a 0a20 2020 2020 2020 2020  .dims:.         
+0002c480: 2020 2020 2020 2020 2020 2061 7373 6967             assig
+0002c490: 6e5f 636f 6f72 6473 5b64 696d 5d20 3d20  n_coords[dim] = 
+0002c4a0: 4e6f 6e65 0a0a 2020 2020 2020 2020 2020  None..          
+0002c4b0: 2020 6578 7061 6e64 5f64 696d 7320 3d20    expand_dims = 
+0002c4c0: 7365 7428 7374 6163 6b69 6e67 5f64 696d  set(stacking_dim
+0002c4d0: 7329 2e64 6966 6665 7265 6e63 6528 7365  s).difference(se
+0002c4e0: 7428 7661 6c2e 6469 6d73 2929 0a20 2020  t(val.dims)).   
+0002c4f0: 2020 2020 2020 2020 2065 7870 616e 645f           expand_
+0002c500: 6469 6d73 2e61 6464 2876 6172 6961 626c  dims.add(variabl
+0002c510: 655f 6469 6d29 0a20 2020 2020 2020 2020  e_dim).         
+0002c520: 2020 2023 206d 7573 7420 6265 206c 6973     # must be lis
+0002c530: 7420 666f 7220 2e65 7870 616e 645f 6469  t for .expand_di
+0002c540: 6d73 0a20 2020 2020 2020 2020 2020 2065  ms.            e
+0002c550: 7870 616e 645f 6469 6d73 203d 206c 6973  xpand_dims = lis
+0002c560: 7428 6578 7061 6e64 5f64 696d 7329 0a0a  t(expand_dims)..
+0002c570: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+0002c580: 726e 2028 0a20 2020 2020 2020 2020 2020  rn (.           
+0002c590: 2020 2020 2076 616c 2e61 7373 6967 6e5f       val.assign_
+0002c5a0: 636f 6f72 6473 282a 2a61 7373 6967 6e5f  coords(**assign_
+0002c5b0: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
+0002c5c0: 2020 2020 2020 2020 2e65 7870 616e 645f          .expand_
+0002c5d0: 6469 6d73 2865 7870 616e 645f 6469 6d73  dims(expand_dims
+0002c5e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0002c5f0: 2020 2e73 7461 636b 287b 6e65 775f 6469    .stack({new_di
+0002c600: 6d3a 2028 7661 7269 6162 6c65 5f64 696d  m: (variable_dim
+0002c610: 2c29 202b 2073 7461 636b 696e 675f 6469  ,) + stacking_di
+0002c620: 6d73 7d29 0a20 2020 2020 2020 2020 2020  ms}).           
+0002c630: 2029 0a0a 2020 2020 2020 2020 2320 636f   )..        # co
+0002c640: 6e63 6174 656e 6174 6520 7468 6520 6172  ncatenate the ar
+0002c650: 7261 7973 0a20 2020 2020 2020 2073 7461  rays.        sta
+0002c660: 636b 6162 6c65 5f76 6172 7320 3d20 5b65  ckable_vars = [e
+0002c670: 6e73 7572 655f 7374 6163 6b61 626c 6528  nsure_stackable(
+0002c680: 7365 6c66 5b6b 6579 5d29 2066 6f72 206b  self[key]) for k
+0002c690: 6579 2069 6e20 7365 6c66 2e64 6174 615f  ey in self.data_
+0002c6a0: 7661 7273 5d0a 2020 2020 2020 2020 6461  vars].        da
+0002c6b0: 7461 5f61 7272 6179 203d 2063 6f6e 6361  ta_array = conca
+0002c6c0: 7428 7374 6163 6b61 626c 655f 7661 7273  t(stackable_vars
+0002c6d0: 2c20 6469 6d3d 6e65 775f 6469 6d29 0a0a  , dim=new_dim)..
+0002c6e0: 2020 2020 2020 2020 6966 206e 616d 6520          if name 
+0002c6f0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+0002c700: 2020 2020 2020 2020 2064 6174 615f 6172           data_ar
+0002c710: 7261 792e 6e61 6d65 203d 206e 616d 650a  ray.name = name.
+0002c720: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002c730: 6461 7461 5f61 7272 6179 0a0a 2020 2020  data_array..    
+0002c740: 6465 6620 5f75 6e73 7461 636b 5f6f 6e63  def _unstack_onc
+0002c750: 6528 0a20 2020 2020 2020 2073 656c 663a  e(.        self:
+0002c760: 2054 5f44 6174 6173 6574 2c0a 2020 2020   T_Dataset,.    
+0002c770: 2020 2020 6469 6d3a 2048 6173 6861 626c      dim: Hashabl
+0002c780: 652c 0a20 2020 2020 2020 2069 6e64 6578  e,.        index
+0002c790: 5f61 6e64 5f76 6172 733a 2074 7570 6c65  _and_vars: tuple
+0002c7a0: 5b49 6e64 6578 2c20 6469 6374 5b48 6173  [Index, dict[Has
+0002c7b0: 6861 626c 652c 2056 6172 6961 626c 655d  hable, Variable]
+0002c7c0: 5d2c 0a20 2020 2020 2020 2066 696c 6c5f  ],.        fill_
+0002c7d0: 7661 6c75 652c 0a20 2020 2020 2020 2073  value,.        s
+0002c7e0: 7061 7273 653a 2062 6f6f 6c20 3d20 4661  parse: bool = Fa
+0002c7f0: 6c73 652c 0a20 2020 2029 202d 3e20 545f  lse,.    ) -> T_
+0002c800: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
+0002c810: 2069 6e64 6578 2c20 696e 6465 785f 7661   index, index_va
+0002c820: 7273 203d 2069 6e64 6578 5f61 6e64 5f76  rs = index_and_v
+0002c830: 6172 730a 2020 2020 2020 2020 7661 7269  ars.        vari
+0002c840: 6162 6c65 733a 2064 6963 745b 4861 7368  ables: dict[Hash
+0002c850: 6162 6c65 2c20 5661 7269 6162 6c65 5d20  able, Variable] 
+0002c860: 3d20 7b7d 0a20 2020 2020 2020 2069 6e64  = {}.        ind
+0002c870: 6578 6573 203d 207b 6b3a 2076 2066 6f72  exes = {k: v for
+0002c880: 206b 2c20 7620 696e 2073 656c 662e 5f69   k, v in self._i
+0002c890: 6e64 6578 6573 2e69 7465 6d73 2829 2069  ndexes.items() i
+0002c8a0: 6620 6b20 213d 2064 696d 7d0a 0a20 2020  f k != dim}..   
+0002c8b0: 2020 2020 206e 6577 5f69 6e64 6578 6573       new_indexes
+0002c8c0: 2c20 636c 6561 6e5f 696e 6465 7820 3d20  , clean_index = 
+0002c8d0: 696e 6465 782e 756e 7374 6163 6b28 290a  index.unstack().
+0002c8e0: 2020 2020 2020 2020 696e 6465 7865 732e          indexes.
+0002c8f0: 7570 6461 7465 286e 6577 5f69 6e64 6578  update(new_index
+0002c900: 6573 290a 0a20 2020 2020 2020 2066 6f72  es)..        for
+0002c910: 206e 616d 652c 2069 6478 2069 6e20 6e65   name, idx in ne
+0002c920: 775f 696e 6465 7865 732e 6974 656d 7328  w_indexes.items(
+0002c930: 293a 0a20 2020 2020 2020 2020 2020 2076  ):.            v
+0002c940: 6172 6961 626c 6573 2e75 7064 6174 6528  ariables.update(
+0002c950: 6964 782e 6372 6561 7465 5f76 6172 6961  idx.create_varia
+0002c960: 626c 6573 2869 6e64 6578 5f76 6172 7329  bles(index_vars)
+0002c970: 290a 0a20 2020 2020 2020 2066 6f72 206e  )..        for n
+0002c980: 616d 652c 2076 6172 2069 6e20 7365 6c66  ame, var in self
+0002c990: 2e76 6172 6961 626c 6573 2e69 7465 6d73  .variables.items
+0002c9a0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+0002c9b0: 6966 206e 616d 6520 6e6f 7420 696e 2069  if name not in i
+0002c9c0: 6e64 6578 5f76 6172 733a 0a20 2020 2020  ndex_vars:.     
+0002c9d0: 2020 2020 2020 2020 2020 2069 6620 6469             if di
+0002c9e0: 6d20 696e 2076 6172 2e64 696d 733a 0a20  m in var.dims:. 
+0002c9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ca00: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+0002ca10: 2866 696c 6c5f 7661 6c75 652c 204d 6170  (fill_value, Map
+0002ca20: 7069 6e67 293a 0a20 2020 2020 2020 2020  ping):.         
+0002ca30: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0002ca40: 696c 6c5f 7661 6c75 655f 203d 2066 696c  ill_value_ = fil
+0002ca50: 6c5f 7661 6c75 655b 6e61 6d65 5d0a 2020  l_value[name].  
+0002ca60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ca70: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
 0002ca80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002ca90: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0002caa0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0002cab0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
-0002cac0: 6162 6c65 735b 6e61 6d65 5d20 3d20 7661  ables[name] = va
-0002cad0: 720a 0a20 2020 2020 2020 2063 6f6f 7264  r..        coord
-0002cae0: 5f6e 616d 6573 203d 2073 6574 2873 656c  _names = set(sel
-0002caf0: 662e 5f63 6f6f 7264 5f6e 616d 6573 2920  f._coord_names) 
-0002cb00: 2d20 7b64 696d 7d20 7c20 7365 7428 6e65  - {dim} | set(ne
-0002cb10: 775f 696e 6465 7865 7329 0a0a 2020 2020  w_indexes)..    
-0002cb20: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0002cb30: 5f72 6570 6c61 6365 5f77 6974 685f 6e65  _replace_with_ne
-0002cb40: 775f 6469 6d73 280a 2020 2020 2020 2020  w_dims(.        
-0002cb50: 2020 2020 7661 7269 6162 6c65 732c 2063      variables, c
-0002cb60: 6f6f 7264 5f6e 616d 6573 3d63 6f6f 7264  oord_names=coord
-0002cb70: 5f6e 616d 6573 2c20 696e 6465 7865 733d  _names, indexes=
-0002cb80: 696e 6465 7865 730a 2020 2020 2020 2020  indexes.        
-0002cb90: 290a 0a20 2020 2064 6566 205f 756e 7374  )..    def _unst
-0002cba0: 6163 6b5f 6675 6c6c 5f72 6569 6e64 6578  ack_full_reindex
-0002cbb0: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
-0002cbc0: 545f 4461 7461 7365 742c 0a20 2020 2020  T_Dataset,.     
-0002cbd0: 2020 2064 696d 3a20 4861 7368 6162 6c65     dim: Hashable
-0002cbe0: 2c0a 2020 2020 2020 2020 696e 6465 785f  ,.        index_
-0002cbf0: 616e 645f 7661 7273 3a20 7475 706c 655b  and_vars: tuple[
-0002cc00: 496e 6465 782c 2064 6963 745b 4861 7368  Index, dict[Hash
-0002cc10: 6162 6c65 2c20 5661 7269 6162 6c65 5d5d  able, Variable]]
-0002cc20: 2c0a 2020 2020 2020 2020 6669 6c6c 5f76  ,.        fill_v
-0002cc30: 616c 7565 2c0a 2020 2020 2020 2020 7370  alue,.        sp
-0002cc40: 6172 7365 3a20 626f 6f6c 2c0a 2020 2020  arse: bool,.    
-0002cc50: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
-0002cc60: 2020 2020 2020 2020 696e 6465 782c 2069          index, i
-0002cc70: 6e64 6578 5f76 6172 7320 3d20 696e 6465  ndex_vars = inde
-0002cc80: 785f 616e 645f 7661 7273 0a20 2020 2020  x_and_vars.     
-0002cc90: 2020 2076 6172 6961 626c 6573 3a20 6469     variables: di
-0002cca0: 6374 5b48 6173 6861 626c 652c 2056 6172  ct[Hashable, Var
-0002ccb0: 6961 626c 655d 203d 207b 7d0a 2020 2020  iable] = {}.    
-0002ccc0: 2020 2020 696e 6465 7865 7320 3d20 7b6b      indexes = {k
-0002ccd0: 3a20 7620 666f 7220 6b2c 2076 2069 6e20  : v for k, v in 
-0002cce0: 7365 6c66 2e5f 696e 6465 7865 732e 6974  self._indexes.it
-0002ccf0: 656d 7328 2920 6966 206b 2021 3d20 6469  ems() if k != di
-0002cd00: 6d7d 0a0a 2020 2020 2020 2020 6e65 775f  m}..        new_
-0002cd10: 696e 6465 7865 732c 2063 6c65 616e 5f69  indexes, clean_i
-0002cd20: 6e64 6578 203d 2069 6e64 6578 2e75 6e73  ndex = index.uns
-0002cd30: 7461 636b 2829 0a20 2020 2020 2020 2069  tack().        i
-0002cd40: 6e64 6578 6573 2e75 7064 6174 6528 6e65  ndexes.update(ne
-0002cd50: 775f 696e 6465 7865 7329 0a0a 2020 2020  w_indexes)..    
-0002cd60: 2020 2020 6e65 775f 696e 6465 785f 7661      new_index_va
-0002cd70: 7269 6162 6c65 7320 3d20 7b7d 0a20 2020  riables = {}.   
-0002cd80: 2020 2020 2066 6f72 206e 616d 652c 2069       for name, i
-0002cd90: 6478 2069 6e20 6e65 775f 696e 6465 7865  dx in new_indexe
-0002cda0: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-0002cdb0: 2020 2020 2020 206e 6577 5f69 6e64 6578         new_index
-0002cdc0: 5f76 6172 6961 626c 6573 2e75 7064 6174  _variables.updat
-0002cdd0: 6528 6964 782e 6372 6561 7465 5f76 6172  e(idx.create_var
-0002cde0: 6961 626c 6573 2869 6e64 6578 5f76 6172  iables(index_var
-0002cdf0: 7329 290a 0a20 2020 2020 2020 206e 6577  s))..        new
-0002ce00: 5f64 696d 5f73 697a 6573 203d 207b 6b3a  _dim_sizes = {k:
-0002ce10: 2076 2e73 697a 6520 666f 7220 6b2c 2076   v.size for k, v
-0002ce20: 2069 6e20 6e65 775f 696e 6465 785f 7661   in new_index_va
-0002ce30: 7269 6162 6c65 732e 6974 656d 7328 297d  riables.items()}
-0002ce40: 0a20 2020 2020 2020 2076 6172 6961 626c  .        variabl
-0002ce50: 6573 2e75 7064 6174 6528 6e65 775f 696e  es.update(new_in
-0002ce60: 6465 785f 7661 7269 6162 6c65 7329 0a0a  dex_variables)..
-0002ce70: 2020 2020 2020 2020 2320 7461 6b65 2061          # take a
-0002ce80: 2073 686f 7274 6375 7420 696e 2063 6173   shortcut in cas
-0002ce90: 6520 7468 6520 4d75 6c74 6949 6e64 6578  e the MultiIndex
-0002cea0: 2077 6173 206e 6f74 206d 6f64 6966 6965   was not modifie
-0002ceb0: 642e 0a20 2020 2020 2020 2066 756c 6c5f  d..        full_
-0002cec0: 6964 7820 3d20 7064 2e4d 756c 7469 496e  idx = pd.MultiIn
-0002ced0: 6465 782e 6672 6f6d 5f70 726f 6475 6374  dex.from_product
-0002cee0: 280a 2020 2020 2020 2020 2020 2020 636c  (.            cl
-0002cef0: 6561 6e5f 696e 6465 782e 6c65 7665 6c73  ean_index.levels
-0002cf00: 2c20 6e61 6d65 733d 636c 6561 6e5f 696e  , names=clean_in
-0002cf10: 6465 782e 6e61 6d65 730a 2020 2020 2020  dex.names.      
-0002cf20: 2020 290a 2020 2020 2020 2020 6966 2063    ).        if c
-0002cf30: 6c65 616e 5f69 6e64 6578 2e65 7175 616c  lean_index.equal
-0002cf40: 7328 6675 6c6c 5f69 6478 293a 0a20 2020  s(full_idx):.   
-0002cf50: 2020 2020 2020 2020 206f 626a 203d 2073           obj = s
-0002cf60: 656c 660a 2020 2020 2020 2020 656c 7365  elf.        else
-0002cf70: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
-0002cf80: 544f 444f 3a20 7765 206d 6179 2064 6570  TODO: we may dep
-0002cf90: 7265 6369 6174 6520 696d 706c 6963 6974  reciate implicit
-0002cfa0: 2072 652d 696e 6465 7869 6e67 2077 6974   re-indexing wit
-0002cfb0: 6820 6120 7061 6e64 6173 2e4d 756c 7469  h a pandas.Multi
-0002cfc0: 496e 6465 780a 2020 2020 2020 2020 2020  Index.          
-0002cfd0: 2020 7872 5f66 756c 6c5f 6964 7820 3d20    xr_full_idx = 
-0002cfe0: 5061 6e64 6173 4d75 6c74 6949 6e64 6578  PandasMultiIndex
-0002cff0: 2866 756c 6c5f 6964 782c 2064 696d 290a  (full_idx, dim).
-0002d000: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-0002d010: 7865 7273 203d 2049 6e64 6578 6573 280a  xers = Indexes(.
-0002d020: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d030: 7b6b 3a20 7872 5f66 756c 6c5f 6964 7820  {k: xr_full_idx 
-0002d040: 666f 7220 6b20 696e 2069 6e64 6578 5f76  for k in index_v
-0002d050: 6172 737d 2c0a 2020 2020 2020 2020 2020  ars},.          
-0002d060: 2020 2020 2020 7872 5f66 756c 6c5f 6964        xr_full_id
-0002d070: 782e 6372 6561 7465 5f76 6172 6961 626c  x.create_variabl
-0002d080: 6573 2869 6e64 6578 5f76 6172 7329 2c0a  es(index_vars),.
-0002d090: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0002d0a0: 2020 2020 2020 2020 2020 6f62 6a20 3d20            obj = 
-0002d0b0: 7365 6c66 2e5f 7265 696e 6465 7828 0a20  self._reindex(. 
-0002d0c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002d0d0: 6e64 6578 6572 732c 2063 6f70 793d 4661  ndexers, copy=Fa
-0002d0e0: 6c73 652c 2066 696c 6c5f 7661 6c75 653d  lse, fill_value=
-0002d0f0: 6669 6c6c 5f76 616c 7565 2c20 7370 6172  fill_value, spar
-0002d100: 7365 3d73 7061 7273 650a 2020 2020 2020  se=sparse.      
-0002d110: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-0002d120: 2066 6f72 206e 616d 652c 2076 6172 2069   for name, var i
-0002d130: 6e20 6f62 6a2e 7661 7269 6162 6c65 732e  n obj.variables.
-0002d140: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-0002d150: 2020 2020 2069 6620 6e61 6d65 206e 6f74       if name not
-0002d160: 2069 6e20 696e 6465 785f 7661 7273 3a0a   in index_vars:.
-0002d170: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002d180: 6966 2064 696d 2069 6e20 7661 722e 6469  if dim in var.di
-0002d190: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
-0002d1a0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-0002d1b0: 735b 6e61 6d65 5d20 3d20 7661 722e 756e  s[name] = var.un
-0002d1c0: 7374 6163 6b28 7b64 696d 3a20 6e65 775f  stack({dim: new_
-0002d1d0: 6469 6d5f 7369 7a65 737d 290a 2020 2020  dim_sizes}).    
-0002d1e0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0002d1f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0002d200: 2020 2020 2020 7661 7269 6162 6c65 735b        variables[
-0002d210: 6e61 6d65 5d20 3d20 7661 720a 0a20 2020  name] = var..   
-0002d220: 2020 2020 2063 6f6f 7264 5f6e 616d 6573       coord_names
-0002d230: 203d 2073 6574 2873 656c 662e 5f63 6f6f   = set(self._coo
-0002d240: 7264 5f6e 616d 6573 2920 2d20 7b64 696d  rd_names) - {dim
-0002d250: 7d20 7c20 7365 7428 6e65 775f 6469 6d5f  } | set(new_dim_
-0002d260: 7369 7a65 7329 0a0a 2020 2020 2020 2020  sizes)..        
-0002d270: 7265 7475 726e 2073 656c 662e 5f72 6570  return self._rep
-0002d280: 6c61 6365 5f77 6974 685f 6e65 775f 6469  lace_with_new_di
-0002d290: 6d73 280a 2020 2020 2020 2020 2020 2020  ms(.            
-0002d2a0: 7661 7269 6162 6c65 732c 2063 6f6f 7264  variables, coord
-0002d2b0: 5f6e 616d 6573 3d63 6f6f 7264 5f6e 616d  _names=coord_nam
-0002d2c0: 6573 2c20 696e 6465 7865 733d 696e 6465  es, indexes=inde
-0002d2d0: 7865 730a 2020 2020 2020 2020 290a 0a20  xes.        ).. 
-0002d2e0: 2020 2064 6566 2075 6e73 7461 636b 280a     def unstack(.
-0002d2f0: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
-0002d300: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
-0002d310: 2064 696d 3a20 4469 6d73 203d 204e 6f6e   dim: Dims = Non
-0002d320: 652c 0a20 2020 2020 2020 2066 696c 6c5f  e,.        fill_
-0002d330: 7661 6c75 653a 2041 6e79 203d 2078 7264  value: Any = xrd
-0002d340: 7479 7065 732e 4e41 2c0a 2020 2020 2020  types.NA,.      
-0002d350: 2020 7370 6172 7365 3a20 626f 6f6c 203d    sparse: bool =
-0002d360: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
-0002d370: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
-0002d380: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0002d390: 556e 7374 6163 6b20 6578 6973 7469 6e67  Unstack existing
-0002d3a0: 2064 696d 656e 7369 6f6e 7320 636f 7272   dimensions corr
-0002d3b0: 6573 706f 6e64 696e 6720 746f 204d 756c  esponding to Mul
-0002d3c0: 7469 496e 6465 7865 7320 696e 746f 0a20  tiIndexes into. 
-0002d3d0: 2020 2020 2020 206d 756c 7469 706c 6520         multiple 
-0002d3e0: 6e65 7720 6469 6d65 6e73 696f 6e73 2e0a  new dimensions..
-0002d3f0: 0a20 2020 2020 2020 204e 6577 2064 696d  .        New dim
-0002d400: 656e 7369 6f6e 7320 7769 6c6c 2062 6520  ensions will be 
-0002d410: 6164 6465 6420 6174 2074 6865 2065 6e64  added at the end
-0002d420: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0002d430: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-0002d440: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002d450: 2064 696d 203a 2073 7472 2c20 4974 6572   dim : str, Iter
-0002d460: 6162 6c65 206f 6620 4861 7368 6162 6c65  able of Hashable
-0002d470: 206f 7220 4e6f 6e65 2c20 6f70 7469 6f6e   or None, option
-0002d480: 616c 0a20 2020 2020 2020 2020 2020 2044  al.            D
-0002d490: 696d 656e 7369 6f6e 2873 2920 6f76 6572  imension(s) over
-0002d4a0: 2077 6869 6368 2074 6f20 756e 7374 6163   which to unstac
-0002d4b0: 6b2e 2042 7920 6465 6661 756c 7420 756e  k. By default un
-0002d4c0: 7374 6163 6b73 2061 6c6c 0a20 2020 2020  stacks all.     
-0002d4d0: 2020 2020 2020 204d 756c 7469 496e 6465         MultiInde
-0002d4e0: 7865 732e 0a20 2020 2020 2020 2066 696c  xes..        fil
-0002d4f0: 6c5f 7661 6c75 6520 3a20 7363 616c 6172  l_value : scalar
-0002d500: 206f 7220 6469 6374 2d6c 696b 652c 2064   or dict-like, d
-0002d510: 6566 6175 6c74 3a20 6e61 6e0a 2020 2020  efault: nan.    
-0002d520: 2020 2020 2020 2020 7661 6c75 6520 746f          value to
-0002d530: 2062 6520 6669 6c6c 6564 2e20 4966 2061   be filled. If a
-0002d540: 2064 6963 742d 6c69 6b65 2c20 6d61 7073   dict-like, maps
-0002d550: 2076 6172 6961 626c 6520 6e61 6d65 7320   variable names 
-0002d560: 746f 0a20 2020 2020 2020 2020 2020 2066  to.            f
-0002d570: 696c 6c20 7661 6c75 6573 2e20 4966 206e  ill values. If n
-0002d580: 6f74 2070 726f 7669 6465 6420 6f72 2069  ot provided or i
-0002d590: 6620 7468 6520 6469 6374 2d6c 696b 6520  f the dict-like 
-0002d5a0: 646f 6573 206e 6f74 0a20 2020 2020 2020  does not.       
-0002d5b0: 2020 2020 2063 6f6e 7461 696e 2061 6c6c       contain all
-0002d5c0: 2076 6172 6961 626c 6573 2c20 7468 6520   variables, the 
-0002d5d0: 6474 7970 6527 7320 4e41 2076 616c 7565  dtype's NA value
-0002d5e0: 2077 696c 6c20 6265 2075 7365 642e 0a20   will be used.. 
-0002d5f0: 2020 2020 2020 2073 7061 7273 6520 3a20         sparse : 
-0002d600: 626f 6f6c 2c20 6465 6661 756c 743a 2046  bool, default: F
-0002d610: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-0002d620: 2075 7365 2073 7061 7273 652d 6172 7261   use sparse-arra
-0002d630: 7920 6966 2054 7275 650a 0a20 2020 2020  y if True..     
-0002d640: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-0002d650: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-0002d660: 2020 2075 6e73 7461 636b 6564 203a 2044     unstacked : D
-0002d670: 6174 6173 6574 0a20 2020 2020 2020 2020  ataset.         
-0002d680: 2020 2044 6174 6173 6574 2077 6974 6820     Dataset with 
-0002d690: 756e 7374 6163 6b65 6420 6461 7461 2e0a  unstacked data..
-0002d6a0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-0002d6b0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-0002d6c0: 2d2d 0a20 2020 2020 2020 2044 6174 6173  --.        Datas
-0002d6d0: 6574 2e73 7461 636b 0a20 2020 2020 2020  et.stack.       
-0002d6e0: 2022 2222 0a0a 2020 2020 2020 2020 6966   """..        if
-0002d6f0: 2064 696d 2069 7320 4e6f 6e65 3a0a 2020   dim is None:.  
-0002d700: 2020 2020 2020 2020 2020 6469 6d73 203d            dims =
-0002d710: 206c 6973 7428 7365 6c66 2e64 696d 7329   list(self.dims)
-0002d720: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0002d730: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0002d740: 696e 7374 616e 6365 2864 696d 2c20 7374  instance(dim, st
-0002d750: 7229 206f 7220 6e6f 7420 6973 696e 7374  r) or not isinst
-0002d760: 616e 6365 2864 696d 2c20 4974 6572 6162  ance(dim, Iterab
-0002d770: 6c65 293a 0a20 2020 2020 2020 2020 2020  le):.           
-0002d780: 2020 2020 2064 696d 7320 3d20 5b64 696d       dims = [dim
-0002d790: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-0002d7a0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0002d7b0: 2020 2020 6469 6d73 203d 206c 6973 7428      dims = list(
-0002d7c0: 6469 6d29 0a0a 2020 2020 2020 2020 2020  dim)..          
-0002d7d0: 2020 6d69 7373 696e 675f 6469 6d73 203d    missing_dims =
-0002d7e0: 205b 6420 666f 7220 6420 696e 2064 696d   [d for d in dim
-0002d7f0: 7320 6966 2064 206e 6f74 2069 6e20 7365  s if d not in se
-0002d800: 6c66 2e64 696d 735d 0a20 2020 2020 2020  lf.dims].       
-0002d810: 2020 2020 2069 6620 6d69 7373 696e 675f       if missing_
-0002d820: 6469 6d73 3a0a 2020 2020 2020 2020 2020  dims:.          
-0002d830: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0002d840: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0002d850: 2020 2020 2020 2020 2020 2020 6622 4461              f"Da
-0002d860: 7461 7365 7420 646f 6573 206e 6f74 2063  taset does not c
-0002d870: 6f6e 7461 696e 2074 6865 2064 696d 656e  ontain the dimen
-0002d880: 7369 6f6e 733a 207b 6d69 7373 696e 675f  sions: {missing_
-0002d890: 6469 6d73 7d22 0a20 2020 2020 2020 2020  dims}".         
-0002d8a0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-0002d8b0: 2020 2320 6561 6368 2073 7065 6369 6669    # each specifi
-0002d8c0: 6564 2064 696d 656e 7369 6f6e 206d 7573  ed dimension mus
-0002d8d0: 7420 6861 7665 2065 7861 6374 6c79 206f  t have exactly o
-0002d8e0: 6e65 206d 756c 7469 2d69 6e64 6578 0a20  ne multi-index. 
-0002d8f0: 2020 2020 2020 2073 7461 636b 6564 5f69         stacked_i
-0002d900: 6e64 6578 6573 3a20 6469 6374 5b41 6e79  ndexes: dict[Any
-0002d910: 2c20 7475 706c 655b 496e 6465 782c 2064  , tuple[Index, d
-0002d920: 6963 745b 4861 7368 6162 6c65 2c20 5661  ict[Hashable, Va
-0002d930: 7269 6162 6c65 5d5d 5d20 3d20 7b7d 0a20  riable]]] = {}. 
-0002d940: 2020 2020 2020 2066 6f72 2064 2069 6e20         for d in 
-0002d950: 6469 6d73 3a0a 2020 2020 2020 2020 2020  dims:.          
-0002d960: 2020 6964 782c 2069 6478 5f76 6172 7320    idx, idx_vars 
-0002d970: 3d20 7365 6c66 2e5f 6765 745f 7374 6163  = self._get_stac
-0002d980: 6b5f 696e 6465 7828 642c 206d 756c 7469  k_index(d, multi
-0002d990: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
-0002d9a0: 2020 2069 6620 6964 7820 6973 206e 6f74     if idx is not
-0002d9b0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0002d9c0: 2020 2020 2020 2073 7461 636b 6564 5f69         stacked_i
-0002d9d0: 6e64 6578 6573 5b64 5d20 3d20 6964 782c  ndexes[d] = idx,
-0002d9e0: 2069 6478 5f76 6172 730a 0a20 2020 2020   idx_vars..     
-0002d9f0: 2020 2069 6620 6469 6d20 6973 204e 6f6e     if dim is Non
-0002da00: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
-0002da10: 696d 7320 3d20 6c69 7374 2873 7461 636b  ims = list(stack
-0002da20: 6564 5f69 6e64 6578 6573 290a 2020 2020  ed_indexes).    
-0002da30: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0002da40: 2020 2020 2020 6e6f 6e5f 6d75 6c74 695f        non_multi_
-0002da50: 6469 6d73 203d 2073 6574 2864 696d 7329  dims = set(dims)
-0002da60: 202d 2073 6574 2873 7461 636b 6564 5f69   - set(stacked_i
-0002da70: 6e64 6578 6573 290a 2020 2020 2020 2020  ndexes).        
-0002da80: 2020 2020 6966 206e 6f6e 5f6d 756c 7469      if non_multi
-0002da90: 5f64 696d 733a 0a20 2020 2020 2020 2020  _dims:.         
-0002daa0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0002dab0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
-0002dac0: 2020 2020 2020 2020 2020 2020 2022 6361               "ca
-0002dad0: 6e6e 6f74 2075 6e73 7461 636b 2064 696d  nnot unstack dim
-0002dae0: 656e 7369 6f6e 7320 7468 6174 2064 6f20  ensions that do 
-0002daf0: 6e6f 7420 220a 2020 2020 2020 2020 2020  not ".          
-0002db00: 2020 2020 2020 2020 2020 6622 6861 7665            f"have
-0002db10: 2065 7861 6374 6c79 206f 6e65 206d 756c   exactly one mul
-0002db20: 7469 2d69 6e64 6578 3a20 7b74 7570 6c65  ti-index: {tuple
-0002db30: 286e 6f6e 5f6d 756c 7469 5f64 696d 7329  (non_multi_dims)
-0002db40: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
-0002db50: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
-0002db60: 7375 6c74 203d 2073 656c 662e 636f 7079  sult = self.copy
-0002db70: 2864 6565 703d 4661 6c73 6529 0a0a 2020  (deep=False)..  
-0002db80: 2020 2020 2020 2320 7765 2077 616e 7420        # we want 
-0002db90: 746f 2061 766f 6964 2061 6c6c 6f63 6174  to avoid allocat
-0002dba0: 696e 6720 616e 206f 626a 6563 742d 6474  ing an object-dt
-0002dbb0: 7970 6520 6e64 6172 7261 7920 666f 7220  ype ndarray for 
-0002dbc0: 6120 4d75 6c74 6949 6e64 6578 2c0a 2020  a MultiIndex,.  
-0002dbd0: 2020 2020 2020 2320 736f 2077 6520 6361        # so we ca
-0002dbe0: 6e27 7420 6a75 7374 2061 6363 6573 7320  n't just access 
-0002dbf0: 7365 6c66 2e76 6172 6961 626c 6573 5b76  self.variables[v
-0002dc00: 5d2e 6461 7461 2066 6f72 2065 7665 7279  ].data for every
-0002dc10: 2076 6172 6961 626c 652e 0a20 2020 2020   variable..     
-0002dc20: 2020 2023 2057 6520 6f6e 6c79 2063 6865     # We only che
-0002dc30: 636b 2074 6865 206e 6f6e 2d69 6e64 6578  ck the non-index
-0002dc40: 2076 6172 6961 626c 6573 2e0a 2020 2020   variables..    
-0002dc50: 2020 2020 2320 6874 7470 733a 2f2f 6769      # https://gi
-0002dc60: 7468 7562 2e63 6f6d 2f70 7964 6174 612f  thub.com/pydata/
-0002dc70: 7861 7272 6179 2f69 7373 7565 732f 3539  xarray/issues/59
-0002dc80: 3032 0a20 2020 2020 2020 206e 6f6e 696e  02.        nonin
-0002dc90: 6465 7865 7320 3d20 5b0a 2020 2020 2020  dexes = [.      
-0002dca0: 2020 2020 2020 7365 6c66 2e76 6172 6961        self.varia
-0002dcb0: 626c 6573 5b6b 5d20 666f 7220 6b20 696e  bles[k] for k in
-0002dcc0: 2073 6574 2873 656c 662e 7661 7269 6162   set(self.variab
-0002dcd0: 6c65 7329 202d 2073 6574 2873 656c 662e  les) - set(self.
-0002dce0: 5f69 6e64 6578 6573 290a 2020 2020 2020  _indexes).      
-0002dcf0: 2020 5d0a 2020 2020 2020 2020 2320 4e6f    ].        # No
-0002dd00: 7465 7320 666f 7220 6561 6368 206f 6620  tes for each of 
-0002dd10: 7468 6573 6520 6361 7365 733a 0a20 2020  these cases:.   
-0002dd20: 2020 2020 2023 2031 2e20 4461 736b 2061       # 1. Dask a
-0002dd30: 7272 6179 7320 646f 6e27 7420 7375 7070  rrays don't supp
-0002dd40: 6f72 7420 6173 7369 676e 6d65 6e74 2062  ort assignment b
-0002dd50: 7920 696e 6465 782c 2077 6869 6368 2074  y index, which t
-0002dd60: 6865 2066 6173 7420 756e 7374 6163 6b0a  he fast unstack.
-0002dd70: 2020 2020 2020 2020 2320 2020 2066 756e          #    fun
-0002dd80: 6374 696f 6e20 7265 7175 6972 6573 2e0a  ction requires..
-0002dd90: 2020 2020 2020 2020 2320 2020 2068 7474          #    htt
-0002dda0: 7073 3a2f 2f67 6974 6875 622e 636f 6d2f  ps://github.com/
-0002ddb0: 7079 6461 7461 2f78 6172 7261 792f 7075  pydata/xarray/pu
-0002ddc0: 6c6c 2f34 3734 3623 6973 7375 6563 6f6d  ll/4746#issuecom
-0002ddd0: 6d65 6e74 2d37 3533 3238 3231 3235 0a20  ment-753282125. 
-0002dde0: 2020 2020 2020 2023 2032 2e20 5370 6172         # 2. Spar
-0002ddf0: 7365 2064 6f65 736e 2774 2063 7572 7265  se doesn't curre
-0002de00: 6e74 6c79 2073 7570 706f 7274 2028 7468  ntly support (th
-0002de10: 6f75 6768 2077 6520 636f 756c 6420 7370  ough we could sp
-0002de20: 6563 6961 6c2d 6361 7365 2069 7429 0a20  ecial-case it). 
-0002de30: 2020 2020 2020 2023 2020 2020 6874 7470         #    http
-0002de40: 733a 2f2f 6769 7468 7562 2e63 6f6d 2f70  s://github.com/p
-0002de50: 7964 6174 612f 7370 6172 7365 2f69 7373  ydata/sparse/iss
-0002de60: 7565 732f 3432 320a 2020 2020 2020 2020  ues/422.        
-0002de70: 2320 332e 2070 696e 7420 7265 7175 6972  # 3. pint requir
-0002de80: 6573 2063 6865 636b 696e 6720 6966 2069  es checking if i
-0002de90: 7427 7320 6120 4e75 6d50 7920 6172 7261  t's a NumPy arra
-0002dea0: 7920 756e 7469 6c0a 2020 2020 2020 2020  y until.        
-0002deb0: 2320 2020 2068 7474 7073 3a2f 2f67 6974  #    https://git
-0002dec0: 6875 622e 636f 6d2f 7079 6461 7461 2f78  hub.com/pydata/x
-0002ded0: 6172 7261 792f 7075 6c6c 2f34 3735 3120  array/pull/4751 
-0002dee0: 6973 2072 6573 6f6c 7665 642c 0a20 2020  is resolved,.   
-0002def0: 2020 2020 2023 2020 2020 4f6e 6365 2074       #    Once t
-0002df00: 6861 7420 6973 2072 6573 6f6c 7665 642c  hat is resolved,
-0002df10: 2065 7870 6c69 6369 746c 7920 6578 636c   explicitly excl
-0002df20: 7564 6520 7069 6e74 2061 7272 6179 732e  ude pint arrays.
-0002df30: 0a20 2020 2020 2020 2023 2020 2020 7069  .        #    pi
-0002df40: 6e74 2064 6f65 736e 2774 2069 6d70 6c65  nt doesn't imple
-0002df50: 6d65 6e74 2060 6e70 2e66 756c 6c5f 6c69  ment `np.full_li
-0002df60: 6b65 6020 696e 2061 2077 6179 2074 6861  ke` in a way tha
-0002df70: 7427 730a 2020 2020 2020 2020 2320 2020  t's.        #   
-0002df80: 2063 7572 7265 6e74 6c79 2063 6f6d 7061   currently compa
-0002df90: 7469 626c 652e 0a20 2020 2020 2020 2073  tible..        s
-0002dfa0: 7061 7273 655f 6172 7261 795f 7479 7065  parse_array_type
-0002dfb0: 203d 2061 7272 6179 5f74 7970 6528 2273   = array_type("s
-0002dfc0: 7061 7273 6522 290a 2020 2020 2020 2020  parse").        
-0002dfd0: 6e65 6564 735f 6675 6c6c 5f72 6569 6e64  needs_full_reind
-0002dfe0: 6578 203d 2061 6e79 280a 2020 2020 2020  ex = any(.      
-0002dff0: 2020 2020 2020 6973 5f64 7563 6b5f 6461        is_duck_da
-0002e000: 736b 5f61 7272 6179 2876 2e64 6174 6129  sk_array(v.data)
-0002e010: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-0002e020: 6973 696e 7374 616e 6365 2876 2e64 6174  isinstance(v.dat
-0002e030: 612c 2073 7061 7273 655f 6172 7261 795f  a, sparse_array_
-0002e040: 7479 7065 290a 2020 2020 2020 2020 2020  type).          
-0002e050: 2020 6f72 206e 6f74 2069 7369 6e73 7461    or not isinsta
-0002e060: 6e63 6528 762e 6461 7461 2c20 6e70 2e6e  nce(v.data, np.n
-0002e070: 6461 7272 6179 290a 2020 2020 2020 2020  darray).        
-0002e080: 2020 2020 666f 7220 7620 696e 206e 6f6e      for v in non
-0002e090: 696e 6465 7865 730a 2020 2020 2020 2020  indexes.        
-0002e0a0: 290a 0a20 2020 2020 2020 2066 6f72 2064  )..        for d
-0002e0b0: 2069 6e20 6469 6d73 3a0a 2020 2020 2020   in dims:.      
-0002e0c0: 2020 2020 2020 6966 206e 6565 6473 5f66        if needs_f
-0002e0d0: 756c 6c5f 7265 696e 6465 783a 0a20 2020  ull_reindex:.   
-0002e0e0: 2020 2020 2020 2020 2020 2020 2072 6573               res
-0002e0f0: 756c 7420 3d20 7265 7375 6c74 2e5f 756e  ult = result._un
-0002e100: 7374 6163 6b5f 6675 6c6c 5f72 6569 6e64  stack_full_reind
-0002e110: 6578 280a 2020 2020 2020 2020 2020 2020  ex(.            
-0002e120: 2020 2020 2020 2020 642c 2073 7461 636b          d, stack
-0002e130: 6564 5f69 6e64 6578 6573 5b64 5d2c 2066  ed_indexes[d], f
-0002e140: 696c 6c5f 7661 6c75 652c 2073 7061 7273  ill_value, spars
-0002e150: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-0002e160: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-0002e170: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-0002e180: 2020 2020 2020 7265 7375 6c74 203d 2072        result = r
-0002e190: 6573 756c 742e 5f75 6e73 7461 636b 5f6f  esult._unstack_o
-0002e1a0: 6e63 6528 642c 2073 7461 636b 6564 5f69  nce(d, stacked_i
-0002e1b0: 6e64 6578 6573 5b64 5d2c 2066 696c 6c5f  ndexes[d], fill_
-0002e1c0: 7661 6c75 652c 2073 7061 7273 6529 0a20  value, sparse). 
-0002e1d0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
-0002e1e0: 7375 6c74 0a0a 2020 2020 6465 6620 7570  sult..    def up
-0002e1f0: 6461 7465 2873 656c 663a 2054 5f44 6174  date(self: T_Dat
-0002e200: 6173 6574 2c20 6f74 6865 723a 2043 6f65  aset, other: Coe
-0002e210: 7263 6962 6c65 4d61 7070 696e 6729 202d  rcibleMapping) -
-0002e220: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
-0002e230: 2020 2020 2022 2222 5570 6461 7465 2074       """Update t
-0002e240: 6869 7320 6461 7461 7365 7427 7320 7661  his dataset's va
-0002e250: 7269 6162 6c65 7320 7769 7468 2074 686f  riables with tho
-0002e260: 7365 2066 726f 6d20 616e 6f74 6865 7220  se from another 
-0002e270: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
-0002e280: 2020 4a75 7374 206c 696b 6520 3a70 793a    Just like :py:
-0002e290: 6d65 7468 3a60 6469 6374 2e75 7064 6174  meth:`dict.updat
-0002e2a0: 6560 2074 6869 7320 6973 2061 2069 6e2d  e` this is a in-
-0002e2b0: 706c 6163 6520 6f70 6572 6174 696f 6e2e  place operation.
-0002e2c0: 0a20 2020 2020 2020 2046 6f72 2061 206e  .        For a n
-0002e2d0: 6f6e 2d69 6e70 6c61 6365 2076 6572 7369  on-inplace versi
-0002e2e0: 6f6e 2c20 7365 6520 3a70 793a 6d65 7468  on, see :py:meth
-0002e2f0: 3a60 4461 7461 7365 742e 6d65 7267 6560  :`Dataset.merge`
-0002e300: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0002e310: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-0002e320: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0002e330: 206f 7468 6572 203a 2044 6174 6173 6574   other : Dataset
-0002e340: 206f 7220 6d61 7070 696e 670a 2020 2020   or mapping.    
-0002e350: 2020 2020 2020 2020 5661 7269 6162 6c65          Variable
-0002e360: 7320 7769 7468 2077 6869 6368 2074 6f20  s with which to 
-0002e370: 7570 6461 7465 2074 6869 7320 6461 7461  update this data
-0002e380: 7365 742e 204f 6e65 206f 663a 0a0a 2020  set. One of:..  
-0002e390: 2020 2020 2020 2020 2020 2d20 4461 7461            - Data
-0002e3a0: 7365 740a 2020 2020 2020 2020 2020 2020  set.            
-0002e3b0: 2d20 6d61 7070 696e 6720 7b76 6172 206e  - mapping {var n
-0002e3c0: 616d 653a 2044 6174 6141 7272 6179 7d0a  ame: DataArray}.
-0002e3d0: 2020 2020 2020 2020 2020 2020 2d20 6d61              - ma
-0002e3e0: 7070 696e 6720 7b76 6172 206e 616d 653a  pping {var name:
-0002e3f0: 2056 6172 6961 626c 657d 0a20 2020 2020   Variable}.     
-0002e400: 2020 2020 2020 202d 206d 6170 7069 6e67         - mapping
-0002e410: 207b 7661 7220 6e61 6d65 3a20 2864 696d   {var name: (dim
-0002e420: 656e 7369 6f6e 206e 616d 652c 2061 7272  ension name, arr
-0002e430: 6179 2d6c 696b 6529 7d0a 2020 2020 2020  ay-like)}.      
-0002e440: 2020 2020 2020 2d20 6d61 7070 696e 6720        - mapping 
-0002e450: 7b76 6172 206e 616d 653a 2028 7475 706c  {var name: (tupl
-0002e460: 6520 6f66 2064 696d 656e 7369 6f6e 206e  e of dimension n
-0002e470: 616d 6573 2c20 6172 7261 792d 6c69 6b65  ames, array-like
-0002e480: 297d 0a0a 2020 2020 2020 2020 5265 7475  )}..        Retu
-0002e490: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-0002e4a0: 2d2d 2d0a 2020 2020 2020 2020 7570 6461  ---.        upda
-0002e4b0: 7465 6420 3a20 4461 7461 7365 740a 2020  ted : Dataset.  
-0002e4c0: 2020 2020 2020 2020 2020 5570 6461 7465            Update
-0002e4d0: 6420 6461 7461 7365 742e 204e 6f74 6520  d dataset. Note 
-0002e4e0: 7468 6174 2073 696e 6365 2074 6865 2075  that since the u
-0002e4f0: 7064 6174 6520 6973 2069 6e2d 706c 6163  pdate is in-plac
-0002e500: 6520 7468 6973 2069 7320 7468 6520 696e  e this is the in
-0002e510: 7075 740a 2020 2020 2020 2020 2020 2020  put.            
-0002e520: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
-0002e530: 2020 2020 2020 4974 2069 7320 6465 7072        It is depr
-0002e540: 6563 6174 6564 2073 696e 6365 2076 6572  ecated since ver
-0002e550: 7369 6f6e 2030 2e31 3720 616e 6420 7363  sion 0.17 and sc
-0002e560: 6865 6475 6c65 6420 746f 2062 6520 7265  heduled to be re
-0002e570: 6d6f 7665 6420 696e 2030 2e32 312e 0a0a  moved in 0.21...
-0002e580: 2020 2020 2020 2020 5261 6973 6573 0a20          Raises. 
-0002e590: 2020 2020 2020 202d 2d2d 2d2d 2d0a 2020         ------.  
-0002e5a0: 2020 2020 2020 5661 6c75 6545 7272 6f72        ValueError
-0002e5b0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-0002e5c0: 616e 7920 6469 6d65 6e73 696f 6e73 2077  any dimensions w
-0002e5d0: 6f75 6c64 2068 6176 6520 696e 636f 6e73  ould have incons
-0002e5e0: 6973 7465 6e74 2073 697a 6573 2069 6e20  istent sizes in 
-0002e5f0: 7468 6520 7570 6461 7465 640a 2020 2020  the updated.    
-0002e600: 2020 2020 2020 2020 6461 7461 7365 742e          dataset.
-0002e610: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-0002e620: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-0002e630: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
-0002e640: 7365 742e 6173 7369 676e 0a20 2020 2020  set.assign.     
-0002e650: 2020 2044 6174 6173 6574 2e6d 6572 6765     Dataset.merge
-0002e660: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0002e670: 2020 2020 206d 6572 6765 5f72 6573 756c       merge_resul
-0002e680: 7420 3d20 6461 7461 7365 745f 7570 6461  t = dataset_upda
-0002e690: 7465 5f6d 6574 686f 6428 7365 6c66 2c20  te_method(self, 
-0002e6a0: 6f74 6865 7229 0a20 2020 2020 2020 2072  other).        r
-0002e6b0: 6574 7572 6e20 7365 6c66 2e5f 7265 706c  eturn self._repl
-0002e6c0: 6163 6528 696e 706c 6163 653d 5472 7565  ace(inplace=True
-0002e6d0: 2c20 2a2a 6d65 7267 655f 7265 7375 6c74  , **merge_result
-0002e6e0: 2e5f 6173 6469 6374 2829 290a 0a20 2020  ._asdict())..   
-0002e6f0: 2064 6566 206d 6572 6765 280a 2020 2020   def merge(.    
-0002e700: 2020 2020 7365 6c66 3a20 545f 4461 7461      self: T_Data
-0002e710: 7365 742c 0a20 2020 2020 2020 206f 7468  set,.        oth
-0002e720: 6572 3a20 436f 6572 6369 626c 654d 6170  er: CoercibleMap
-0002e730: 7069 6e67 207c 2044 6174 6141 7272 6179  ping | DataArray
-0002e740: 2c0a 2020 2020 2020 2020 6f76 6572 7772  ,.        overwr
-0002e750: 6974 655f 7661 7273 3a20 4861 7368 6162  ite_vars: Hashab
-0002e760: 6c65 207c 2049 7465 7261 626c 655b 4861  le | Iterable[Ha
-0002e770: 7368 6162 6c65 5d20 3d20 6672 6f7a 656e  shable] = frozen
-0002e780: 7365 7428 292c 0a20 2020 2020 2020 2063  set(),.        c
-0002e790: 6f6d 7061 743a 2043 6f6d 7061 744f 7074  ompat: CompatOpt
-0002e7a0: 696f 6e73 203d 2022 6e6f 5f63 6f6e 666c  ions = "no_confl
-0002e7b0: 6963 7473 222c 0a20 2020 2020 2020 206a  icts",.        j
-0002e7c0: 6f69 6e3a 204a 6f69 6e4f 7074 696f 6e73  oin: JoinOptions
-0002e7d0: 203d 2022 6f75 7465 7222 2c0a 2020 2020   = "outer",.    
-0002e7e0: 2020 2020 6669 6c6c 5f76 616c 7565 3a20      fill_value: 
-0002e7f0: 416e 7920 3d20 7872 6474 7970 6573 2e4e  Any = xrdtypes.N
-0002e800: 412c 0a20 2020 2020 2020 2063 6f6d 6269  A,.        combi
-0002e810: 6e65 5f61 7474 7273 3a20 436f 6d62 696e  ne_attrs: Combin
-0002e820: 6541 7474 7273 4f70 7469 6f6e 7320 3d20  eAttrsOptions = 
-0002e830: 226f 7665 7272 6964 6522 2c0a 2020 2020  "override",.    
-0002e840: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
-0002e850: 2020 2020 2020 2020 2222 224d 6572 6765          """Merge
-0002e860: 2074 6865 2061 7272 6179 7320 6f66 2074   the arrays of t
-0002e870: 776f 2064 6174 6173 6574 7320 696e 746f  wo datasets into
-0002e880: 2061 2073 696e 676c 6520 6461 7461 7365   a single datase
-0002e890: 742e 0a0a 2020 2020 2020 2020 5468 6973  t...        This
-0002e8a0: 206d 6574 686f 6420 6765 6e65 7261 6c6c   method generall
-0002e8b0: 7920 646f 6573 206e 6f74 2061 6c6c 6f77  y does not allow
-0002e8c0: 2066 6f72 206f 7665 7272 6964 696e 6720   for overriding 
-0002e8d0: 6461 7461 2c20 7769 7468 2074 6865 0a20  data, with the. 
-0002e8e0: 2020 2020 2020 2065 7863 6570 7469 6f6e         exception
-0002e8f0: 206f 6620 6174 7472 6962 7574 6573 2c20   of attributes, 
-0002e900: 7768 6963 6820 6172 6520 6967 6e6f 7265  which are ignore
-0002e910: 6420 6f6e 2074 6865 2073 6563 6f6e 6420  d on the second 
-0002e920: 6461 7461 7365 742e 0a20 2020 2020 2020  dataset..       
-0002e930: 2056 6172 6961 626c 6573 2077 6974 6820   Variables with 
-0002e940: 7468 6520 7361 6d65 206e 616d 6520 6172  the same name ar
-0002e950: 6520 6368 6563 6b65 6420 666f 7220 636f  e checked for co
-0002e960: 6e66 6c69 6374 7320 7669 6120 7468 6520  nflicts via the 
-0002e970: 6571 7561 6c73 0a20 2020 2020 2020 206f  equals.        o
-0002e980: 7220 6964 656e 7469 6361 6c20 6d65 7468  r identical meth
-0002e990: 6f64 732e 0a0a 2020 2020 2020 2020 5061  ods...        Pa
-0002e9a0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-0002e9b0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-0002e9c0: 2020 2020 6f74 6865 7220 3a20 4461 7461      other : Data
-0002e9d0: 7365 7420 6f72 206d 6170 7069 6e67 0a20  set or mapping. 
-0002e9e0: 2020 2020 2020 2020 2020 2044 6174 6173             Datas
-0002e9f0: 6574 206f 7220 7661 7269 6162 6c65 7320  et or variables 
-0002ea00: 746f 206d 6572 6765 2077 6974 6820 7468  to merge with th
-0002ea10: 6973 2064 6174 6173 6574 2e0a 2020 2020  is dataset..    
-0002ea20: 2020 2020 6f76 6572 7772 6974 655f 7661      overwrite_va
-0002ea30: 7273 203a 2068 6173 6861 626c 6520 6f72  rs : hashable or
-0002ea40: 2069 7465 7261 626c 6520 6f66 2068 6173   iterable of has
-0002ea50: 6861 626c 652c 206f 7074 696f 6e61 6c0a  hable, optional.
-0002ea60: 2020 2020 2020 2020 2020 2020 4966 2070              If p
-0002ea70: 726f 7669 6465 642c 2075 7064 6174 6520  rovided, update 
-0002ea80: 7661 7269 6162 6c65 7320 6f66 2074 6865  variables of the
-0002ea90: 7365 206e 616d 6528 7329 2077 6974 686f  se name(s) witho
-0002eaa0: 7574 2063 6865 636b 696e 6720 666f 720a  ut checking for.
-0002eab0: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-0002eac0: 6c69 6374 7320 696e 2074 6869 7320 6461  licts in this da
-0002ead0: 7461 7365 742e 0a20 2020 2020 2020 2063  taset..        c
-0002eae0: 6f6d 7061 7420 3a20 7b22 6964 656e 7469  ompat : {"identi
-0002eaf0: 6361 6c22 2c20 2265 7175 616c 7322 2c20  cal", "equals", 
-0002eb00: 2262 726f 6164 6361 7374 5f65 7175 616c  "broadcast_equal
-0002eb10: 7322 2c20 5c0a 2020 2020 2020 2020 2020  s", \.          
-0002eb20: 2020 2020 2020 2020 226e 6f5f 636f 6e66          "no_conf
-0002eb30: 6c69 6374 7322 2c20 226f 7665 7272 6964  licts", "overrid
-0002eb40: 6522 2c20 226d 696e 696d 616c 227d 2c20  e", "minimal"}, 
-0002eb50: 6465 6661 756c 743a 2022 6e6f 5f63 6f6e  default: "no_con
-0002eb60: 666c 6963 7473 220a 2020 2020 2020 2020  flicts".        
-0002eb70: 2020 2020 5374 7269 6e67 2069 6e64 6963      String indic
-0002eb80: 6174 696e 6720 686f 7720 746f 2063 6f6d  ating how to com
-0002eb90: 7061 7265 2076 6172 6961 626c 6573 206f  pare variables o
-0002eba0: 6620 7468 6520 7361 6d65 206e 616d 6520  f the same name 
-0002ebb0: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
-0002ebc0: 706f 7465 6e74 6961 6c20 636f 6e66 6c69  potential confli
-0002ebd0: 6374 733a 0a0a 2020 2020 2020 2020 2020  cts:..          
-0002ebe0: 2020 2d20 2769 6465 6e74 6963 616c 273a    - 'identical':
-0002ebf0: 2061 6c6c 2076 616c 7565 732c 2064 696d   all values, dim
-0002ec00: 656e 7369 6f6e 7320 616e 6420 6174 7472  ensions and attr
-0002ec10: 6962 7574 6573 206d 7573 7420 6265 2074  ibutes must be t
-0002ec20: 6865 0a20 2020 2020 2020 2020 2020 2020  he.             
-0002ec30: 2073 616d 652e 0a20 2020 2020 2020 2020   same..         
-0002ec40: 2020 202d 2027 6571 7561 6c73 273a 2061     - 'equals': a
-0002ec50: 6c6c 2076 616c 7565 7320 616e 6420 6469  ll values and di
-0002ec60: 6d65 6e73 696f 6e73 206d 7573 7420 6265  mensions must be
-0002ec70: 2074 6865 2073 616d 652e 0a20 2020 2020   the same..     
-0002ec80: 2020 2020 2020 202d 2027 6272 6f61 6463         - 'broadc
-0002ec90: 6173 745f 6571 7561 6c73 273a 2061 6c6c  ast_equals': all
-0002eca0: 2076 616c 7565 7320 6d75 7374 2062 6520   values must be 
-0002ecb0: 6571 7561 6c20 7768 656e 2076 6172 6961  equal when varia
-0002ecc0: 626c 6573 2061 7265 0a20 2020 2020 2020  bles are.       
-0002ecd0: 2020 2020 2020 2062 726f 6164 6361 7374         broadcast
-0002ece0: 2061 6761 696e 7374 2065 6163 6820 6f74   against each ot
-0002ecf0: 6865 7220 746f 2065 6e73 7572 6520 636f  her to ensure co
-0002ed00: 6d6d 6f6e 2064 696d 656e 7369 6f6e 732e  mmon dimensions.
-0002ed10: 0a20 2020 2020 2020 2020 2020 202d 2027  .            - '
-0002ed20: 6e6f 5f63 6f6e 666c 6963 7473 273a 206f  no_conflicts': o
-0002ed30: 6e6c 7920 7661 6c75 6573 2077 6869 6368  nly values which
-0002ed40: 2061 7265 206e 6f74 206e 756c 6c20 696e   are not null in
-0002ed50: 2062 6f74 6820 6461 7461 7365 7473 0a20   both datasets. 
-0002ed60: 2020 2020 2020 2020 2020 2020 206d 7573               mus
-0002ed70: 7420 6265 2065 7175 616c 2e20 5468 6520  t be equal. The 
-0002ed80: 7265 7475 726e 6564 2064 6174 6173 6574  returned dataset
-0002ed90: 2074 6865 6e20 636f 6e74 6169 6e73 2074   then contains t
-0002eda0: 6865 2063 6f6d 6269 6e61 7469 6f6e 0a20  he combination. 
-0002edb0: 2020 2020 2020 2020 2020 2020 206f 6620               of 
-0002edc0: 616c 6c20 6e6f 6e2d 6e75 6c6c 2076 616c  all non-null val
-0002edd0: 7565 732e 0a20 2020 2020 2020 2020 2020  ues..           
-0002ede0: 202d 2027 6f76 6572 7269 6465 273a 2073   - 'override': s
-0002edf0: 6b69 7020 636f 6d70 6172 696e 6720 616e  kip comparing an
-0002ee00: 6420 7069 636b 2076 6172 6961 626c 6520  d pick variable 
-0002ee10: 6672 6f6d 2066 6972 7374 2064 6174 6173  from first datas
-0002ee20: 6574 0a20 2020 2020 2020 2020 2020 202d  et.            -
-0002ee30: 2027 6d69 6e69 6d61 6c27 3a20 6472 6f70   'minimal': drop
-0002ee40: 2063 6f6e 666c 6963 7469 6e67 2063 6f6f   conflicting coo
-0002ee50: 7264 696e 6174 6573 0a0a 2020 2020 2020  rdinates..      
-0002ee60: 2020 6a6f 696e 203a 207b 226f 7574 6572    join : {"outer
-0002ee70: 222c 2022 696e 6e65 7222 2c20 226c 6566  ", "inner", "lef
-0002ee80: 7422 2c20 2272 6967 6874 222c 2022 6578  t", "right", "ex
-0002ee90: 6163 7422 2c20 226f 7665 7272 6964 6522  act", "override"
-0002eea0: 7d2c 205c 0a20 2020 2020 2020 2020 2020  }, \.           
-0002eeb0: 2020 2020 6465 6661 756c 743a 2022 6f75      default: "ou
-0002eec0: 7465 7222 0a20 2020 2020 2020 2020 2020  ter".           
-0002eed0: 204d 6574 686f 6420 666f 7220 6a6f 696e   Method for join
-0002eee0: 696e 6720 6060 7365 6c66 6060 2061 6e64  ing ``self`` and
-0002eef0: 2060 606f 7468 6572 6060 2061 6c6f 6e67   ``other`` along
-0002ef00: 2073 6861 7265 6420 6469 6d65 6e73 696f   shared dimensio
-0002ef10: 6e73 3a0a 0a20 2020 2020 2020 2020 2020  ns:..           
-0002ef20: 202d 2027 6f75 7465 7227 3a20 7573 6520   - 'outer': use 
-0002ef30: 7468 6520 756e 696f 6e20 6f66 2074 6865  the union of the
-0002ef40: 2069 6e64 6578 6573 0a20 2020 2020 2020   indexes.       
-0002ef50: 2020 2020 202d 2027 696e 6e65 7227 3a20       - 'inner': 
-0002ef60: 7573 6520 7468 6520 696e 7465 7273 6563  use the intersec
-0002ef70: 7469 6f6e 206f 6620 7468 6520 696e 6465  tion of the inde
-0002ef80: 7865 730a 2020 2020 2020 2020 2020 2020  xes.            
-0002ef90: 2d20 276c 6566 7427 3a20 7573 6520 696e  - 'left': use in
-0002efa0: 6465 7865 7320 6672 6f6d 2060 6073 656c  dexes from ``sel
-0002efb0: 6660 600a 2020 2020 2020 2020 2020 2020  f``.            
-0002efc0: 2d20 2772 6967 6874 273a 2075 7365 2069  - 'right': use i
-0002efd0: 6e64 6578 6573 2066 726f 6d20 6060 6f74  ndexes from ``ot
-0002efe0: 6865 7260 600a 2020 2020 2020 2020 2020  her``.          
-0002eff0: 2020 2d20 2765 7861 6374 273a 2065 7272    - 'exact': err
-0002f000: 6f72 2069 6e73 7465 6164 206f 6620 616c  or instead of al
-0002f010: 6967 6e69 6e67 206e 6f6e 2d65 7175 616c  igning non-equal
-0002f020: 2069 6e64 6578 6573 0a20 2020 2020 2020   indexes.       
-0002f030: 2020 2020 202d 2027 6f76 6572 7269 6465       - 'override
-0002f040: 273a 2075 7365 2069 6e64 6578 6573 2066  ': use indexes f
-0002f050: 726f 6d20 6060 7365 6c66 6060 2074 6861  rom ``self`` tha
-0002f060: 7420 6172 6520 7468 6520 7361 6d65 2073  t are the same s
-0002f070: 697a 650a 2020 2020 2020 2020 2020 2020  ize.            
-0002f080: 2020 6173 2074 686f 7365 206f 6620 6060    as those of ``
-0002f090: 6f74 6865 7260 6020 696e 2074 6861 7420  other`` in that 
-0002f0a0: 6469 6d65 6e73 696f 6e0a 0a20 2020 2020  dimension..     
-0002f0b0: 2020 2066 696c 6c5f 7661 6c75 6520 3a20     fill_value : 
-0002f0c0: 7363 616c 6172 206f 7220 6469 6374 2d6c  scalar or dict-l
-0002f0d0: 696b 652c 206f 7074 696f 6e61 6c0a 2020  ike, optional.  
-0002f0e0: 2020 2020 2020 2020 2020 5661 6c75 6520            Value 
-0002f0f0: 746f 2075 7365 2066 6f72 206e 6577 6c79  to use for newly
-0002f100: 206d 6973 7369 6e67 2076 616c 7565 732e   missing values.
-0002f110: 2049 6620 6120 6469 6374 2d6c 696b 652c   If a dict-like,
-0002f120: 206d 6170 730a 2020 2020 2020 2020 2020   maps.          
-0002f130: 2020 7661 7269 6162 6c65 206e 616d 6573    variable names
-0002f140: 2028 696e 636c 7564 696e 6720 636f 6f72   (including coor
-0002f150: 6469 6e61 7465 7329 2074 6f20 6669 6c6c  dinates) to fill
-0002f160: 2076 616c 7565 732e 0a20 2020 2020 2020   values..       
-0002f170: 2063 6f6d 6269 6e65 5f61 7474 7273 203a   combine_attrs :
-0002f180: 207b 2264 726f 7022 2c20 2269 6465 6e74   {"drop", "ident
-0002f190: 6963 616c 222c 2022 6e6f 5f63 6f6e 666c  ical", "no_confl
-0002f1a0: 6963 7473 222c 2022 6472 6f70 5f63 6f6e  icts", "drop_con
-0002f1b0: 666c 6963 7473 222c 205c 0a20 2020 2020  flicts", \.     
-0002f1c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002f1d0: 2020 2020 226f 7665 7272 6964 6522 7d20      "override"} 
-0002f1e0: 6f72 2063 616c 6c61 626c 652c 2064 6566  or callable, def
-0002f1f0: 6175 6c74 3a20 226f 7665 7272 6964 6522  ault: "override"
-0002f200: 0a20 2020 2020 2020 2020 2020 2041 2063  .            A c
-0002f210: 616c 6c61 626c 6520 6f72 2061 2073 7472  allable or a str
-0002f220: 696e 6720 696e 6469 6361 7469 6e67 2068  ing indicating h
-0002f230: 6f77 2074 6f20 636f 6d62 696e 6520 6174  ow to combine at
-0002f240: 7472 7320 6f66 2074 6865 206f 626a 6563  trs of the objec
-0002f250: 7473 2062 6569 6e67 0a20 2020 2020 2020  ts being.       
-0002f260: 2020 2020 206d 6572 6765 643a 0a0a 2020       merged:..  
-0002f270: 2020 2020 2020 2020 2020 2d20 2264 726f            - "dro
-0002f280: 7022 3a20 656d 7074 7920 6174 7472 7320  p": empty attrs 
-0002f290: 6f6e 2072 6574 7572 6e65 6420 4461 7461  on returned Data
-0002f2a0: 7365 742e 0a20 2020 2020 2020 2020 2020  set..           
-0002f2b0: 202d 2022 6964 656e 7469 6361 6c22 3a20   - "identical": 
-0002f2c0: 616c 6c20 6174 7472 7320 6d75 7374 2062  all attrs must b
-0002f2d0: 6520 7468 6520 7361 6d65 206f 6e20 6576  e the same on ev
-0002f2e0: 6572 7920 6f62 6a65 6374 2e0a 2020 2020  ery object..    
-0002f2f0: 2020 2020 2020 2020 2d20 226e 6f5f 636f          - "no_co
-0002f300: 6e66 6c69 6374 7322 3a20 6174 7472 7320  nflicts": attrs 
-0002f310: 6672 6f6d 2061 6c6c 206f 626a 6563 7473  from all objects
-0002f320: 2061 7265 2063 6f6d 6269 6e65 642c 2061   are combined, a
-0002f330: 6e79 2074 6861 7420 6861 7665 0a20 2020  ny that have.   
-0002f340: 2020 2020 2020 2020 2020 2074 6865 2073             the s
-0002f350: 616d 6520 6e61 6d65 206d 7573 7420 616c  ame name must al
-0002f360: 736f 2068 6176 6520 7468 6520 7361 6d65  so have the same
-0002f370: 2076 616c 7565 2e0a 2020 2020 2020 2020   value..        
-0002f380: 2020 2020 2d20 2264 726f 705f 636f 6e66      - "drop_conf
-0002f390: 6c69 6374 7322 3a20 6174 7472 7320 6672  licts": attrs fr
-0002f3a0: 6f6d 2061 6c6c 206f 626a 6563 7473 2061  om all objects a
-0002f3b0: 7265 2063 6f6d 6269 6e65 642c 2061 6e79  re combined, any
-0002f3c0: 2074 6861 7420 6861 7665 0a20 2020 2020   that have.     
-0002f3d0: 2020 2020 2020 2020 2074 6865 2073 616d           the sam
-0002f3e0: 6520 6e61 6d65 2062 7574 2064 6966 6665  e name but diffe
-0002f3f0: 7265 6e74 2076 616c 7565 7320 6172 6520  rent values are 
-0002f400: 6472 6f70 7065 642e 0a20 2020 2020 2020  dropped..       
-0002f410: 2020 2020 202d 2022 6f76 6572 7269 6465       - "override
-0002f420: 223a 2073 6b69 7020 636f 6d70 6172 696e  ": skip comparin
-0002f430: 6720 616e 6420 636f 7079 2061 7474 7273  g and copy attrs
-0002f440: 2066 726f 6d20 7468 6520 6669 7273 7420   from the first 
-0002f450: 6461 7461 7365 7420 746f 0a20 2020 2020  dataset to.     
-0002f460: 2020 2020 2020 2020 2074 6865 2072 6573           the res
-0002f470: 756c 742e 0a0a 2020 2020 2020 2020 2020  ult...          
-0002f480: 2020 4966 2061 2063 616c 6c61 626c 652c    If a callable,
-0002f490: 2069 7420 6d75 7374 2065 7870 6563 7420   it must expect 
-0002f4a0: 6120 7365 7175 656e 6365 206f 6620 6060  a sequence of ``
-0002f4b0: 6174 7472 7360 6020 6469 6374 7320 616e  attrs`` dicts an
-0002f4c0: 6420 6120 636f 6e74 6578 7420 6f62 6a65  d a context obje
-0002f4d0: 6374 0a20 2020 2020 2020 2020 2020 2061  ct.            a
-0002f4e0: 7320 6974 7320 6f6e 6c79 2070 6172 616d  s its only param
-0002f4f0: 6574 6572 732e 0a0a 2020 2020 2020 2020  eters...        
-0002f500: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0002f510: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0002f520: 6d65 7267 6564 203a 2044 6174 6173 6574  merged : Dataset
-0002f530: 0a20 2020 2020 2020 2020 2020 204d 6572  .            Mer
-0002f540: 6765 6420 6461 7461 7365 742e 0a0a 2020  ged dataset...  
-0002f550: 2020 2020 2020 5261 6973 6573 0a20 2020        Raises.   
-0002f560: 2020 2020 202d 2d2d 2d2d 2d0a 2020 2020       ------.    
-0002f570: 2020 2020 4d65 7267 6545 7272 6f72 0a20      MergeError. 
-0002f580: 2020 2020 2020 2020 2020 2049 6620 616e             If an
-0002f590: 7920 7661 7269 6162 6c65 7320 636f 6e66  y variables conf
-0002f5a0: 6c69 6374 2028 7365 6520 6060 636f 6d70  lict (see ``comp
-0002f5b0: 6174 6060 292e 0a0a 2020 2020 2020 2020  at``)...        
-0002f5c0: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-0002f5d0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-0002f5e0: 2020 4461 7461 7365 742e 7570 6461 7465    Dataset.update
-0002f5f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0002f600: 2020 2020 2066 726f 6d20 7861 7272 6179       from xarray
-0002f610: 2e63 6f72 652e 6461 7461 6172 7261 7920  .core.dataarray 
-0002f620: 696d 706f 7274 2044 6174 6141 7272 6179  import DataArray
-0002f630: 0a0a 2020 2020 2020 2020 6f74 6865 7220  ..        other 
-0002f640: 3d20 6f74 6865 722e 746f 5f64 6174 6173  = other.to_datas
-0002f650: 6574 2829 2069 6620 6973 696e 7374 616e  et() if isinstan
-0002f660: 6365 286f 7468 6572 2c20 4461 7461 4172  ce(other, DataAr
-0002f670: 7261 7929 2065 6c73 6520 6f74 6865 720a  ray) else other.
-0002f680: 2020 2020 2020 2020 6d65 7267 655f 7265          merge_re
-0002f690: 7375 6c74 203d 2064 6174 6173 6574 5f6d  sult = dataset_m
-0002f6a0: 6572 6765 5f6d 6574 686f 6428 0a20 2020  erge_method(.   
-0002f6b0: 2020 2020 2020 2020 2073 656c 662c 0a20           self,. 
-0002f6c0: 2020 2020 2020 2020 2020 206f 7468 6572             other
-0002f6d0: 2c0a 2020 2020 2020 2020 2020 2020 6f76  ,.            ov
-0002f6e0: 6572 7772 6974 655f 7661 7273 3d6f 7665  erwrite_vars=ove
-0002f6f0: 7277 7269 7465 5f76 6172 732c 0a20 2020  rwrite_vars,.   
-0002f700: 2020 2020 2020 2020 2063 6f6d 7061 743d           compat=
-0002f710: 636f 6d70 6174 2c0a 2020 2020 2020 2020  compat,.        
-0002f720: 2020 2020 6a6f 696e 3d6a 6f69 6e2c 0a20      join=join,. 
-0002f730: 2020 2020 2020 2020 2020 2066 696c 6c5f             fill_
-0002f740: 7661 6c75 653d 6669 6c6c 5f76 616c 7565  value=fill_value
-0002f750: 2c0a 2020 2020 2020 2020 2020 2020 636f  ,.            co
-0002f760: 6d62 696e 655f 6174 7472 733d 636f 6d62  mbine_attrs=comb
-0002f770: 696e 655f 6174 7472 732c 0a20 2020 2020  ine_attrs,.     
-0002f780: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
-0002f790: 7572 6e20 7365 6c66 2e5f 7265 706c 6163  urn self._replac
-0002f7a0: 6528 2a2a 6d65 7267 655f 7265 7375 6c74  e(**merge_result
-0002f7b0: 2e5f 6173 6469 6374 2829 290a 0a20 2020  ._asdict())..   
-0002f7c0: 2064 6566 205f 6173 7365 7274 5f61 6c6c   def _assert_all
-0002f7d0: 5f69 6e5f 6461 7461 7365 7428 0a20 2020  _in_dataset(.   
-0002f7e0: 2020 2020 2073 656c 662c 206e 616d 6573       self, names
-0002f7f0: 3a20 4974 6572 6162 6c65 5b48 6173 6861  : Iterable[Hasha
-0002f800: 626c 655d 2c20 7669 7274 7561 6c5f 6f6b  ble], virtual_ok
-0002f810: 6179 3a20 626f 6f6c 203d 2046 616c 7365  ay: bool = False
-0002f820: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0002f830: 2020 2020 2020 2020 6261 645f 6e61 6d65          bad_name
-0002f840: 7320 3d20 7365 7428 6e61 6d65 7329 202d  s = set(names) -
-0002f850: 2073 6574 2873 656c 662e 5f76 6172 6961   set(self._varia
-0002f860: 626c 6573 290a 2020 2020 2020 2020 6966  bles).        if
-0002f870: 2076 6972 7475 616c 5f6f 6b61 793a 0a20   virtual_okay:. 
-0002f880: 2020 2020 2020 2020 2020 2062 6164 5f6e             bad_n
-0002f890: 616d 6573 202d 3d20 7365 6c66 2e76 6972  ames -= self.vir
-0002f8a0: 7475 616c 5f76 6172 6961 626c 6573 0a20  tual_variables. 
-0002f8b0: 2020 2020 2020 2069 6620 6261 645f 6e61         if bad_na
-0002f8c0: 6d65 733a 0a20 2020 2020 2020 2020 2020  mes:.           
-0002f8d0: 206f 7264 6572 6564 5f62 6164 5f6e 616d   ordered_bad_nam
-0002f8e0: 6573 203d 205b 6e61 6d65 2066 6f72 206e  es = [name for n
-0002f8f0: 616d 6520 696e 206e 616d 6573 2069 6620  ame in names if 
-0002f900: 6e61 6d65 2069 6e20 6261 645f 6e61 6d65  name in bad_name
-0002f910: 735d 0a20 2020 2020 2020 2020 2020 2072  s].            r
-0002f920: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0002f930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0002f940: 2066 2254 6865 7365 2076 6172 6961 626c   f"These variabl
-0002f950: 6573 2063 616e 6e6f 7420 6265 2066 6f75  es cannot be fou
-0002f960: 6e64 2069 6e20 7468 6973 2064 6174 6173  nd in this datas
-0002f970: 6574 3a20 7b6f 7264 6572 6564 5f62 6164  et: {ordered_bad
-0002f980: 5f6e 616d 6573 7d22 0a20 2020 2020 2020  _names}".       
-0002f990: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0002f9a0: 6472 6f70 5f76 6172 7328 0a20 2020 2020  drop_vars(.     
-0002f9b0: 2020 2073 656c 663a 2054 5f44 6174 6173     self: T_Datas
-0002f9c0: 6574 2c0a 2020 2020 2020 2020 6e61 6d65  et,.        name
-0002f9d0: 733a 2048 6173 6861 626c 6520 7c20 4974  s: Hashable | It
-0002f9e0: 6572 6162 6c65 5b48 6173 6861 626c 655d  erable[Hashable]
-0002f9f0: 2c0a 2020 2020 2020 2020 2a2c 0a20 2020  ,.        *,.   
-0002fa00: 2020 2020 2065 7272 6f72 733a 2045 7272       errors: Err
-0002fa10: 6f72 4f70 7469 6f6e 7320 3d20 2272 6169  orOptions = "rai
-0002fa20: 7365 222c 0a20 2020 2029 202d 3e20 545f  se",.    ) -> T_
-0002fa30: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
-0002fa40: 2022 2222 4472 6f70 2076 6172 6961 626c   """Drop variabl
-0002fa50: 6573 2066 726f 6d20 7468 6973 2064 6174  es from this dat
-0002fa60: 6173 6574 2e0a 0a20 2020 2020 2020 2050  aset...        P
-0002fa70: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-0002fa80: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-0002fa90: 2020 2020 206e 616d 6573 203a 2068 6173       names : has
-0002faa0: 6861 626c 6520 6f72 2069 7465 7261 626c  hable or iterabl
-0002fab0: 6520 6f66 2068 6173 6861 626c 650a 2020  e of hashable.  
-0002fac0: 2020 2020 2020 2020 2020 4e61 6d65 2873            Name(s
-0002fad0: 2920 6f66 2076 6172 6961 626c 6573 2074  ) of variables t
-0002fae0: 6f20 6472 6f70 2e0a 2020 2020 2020 2020  o drop..        
-0002faf0: 6572 726f 7273 203a 207b 2272 6169 7365  errors : {"raise
-0002fb00: 222c 2022 6967 6e6f 7265 227d 2c20 6465  ", "ignore"}, de
-0002fb10: 6661 756c 743a 2022 7261 6973 6522 0a20  fault: "raise". 
-0002fb20: 2020 2020 2020 2020 2020 2049 6620 2772             If 'r
-0002fb30: 6169 7365 272c 2072 6169 7365 7320 6120  aise', raises a 
-0002fb40: 5661 6c75 6545 7272 6f72 2065 7272 6f72  ValueError error
-0002fb50: 2069 6620 616e 7920 6f66 2074 6865 2076   if any of the v
-0002fb60: 6172 6961 626c 650a 2020 2020 2020 2020  ariable.        
-0002fb70: 2020 2020 7061 7373 6564 2061 7265 206e      passed are n
-0002fb80: 6f74 2069 6e20 7468 6520 6461 7461 7365  ot in the datase
-0002fb90: 742e 2049 6620 2769 676e 6f72 6527 2c20  t. If 'ignore', 
-0002fba0: 616e 7920 6769 7665 6e20 6e61 6d65 7320  any given names 
-0002fbb0: 7468 6174 2061 7265 2069 6e20 7468 650a  that are in the.
-0002fbc0: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0002fbd0: 7365 7420 6172 6520 6472 6f70 7065 6420  set are dropped 
-0002fbe0: 616e 6420 6e6f 2065 7272 6f72 2069 7320  and no error is 
-0002fbf0: 7261 6973 6564 2e0a 0a20 2020 2020 2020  raised...       
-0002fc00: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-0002fc10: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-0002fc20: 2064 726f 7070 6564 203a 2044 6174 6173   dropped : Datas
-0002fc30: 6574 0a0a 2020 2020 2020 2020 2222 220a  et..        """.
-0002fc40: 2020 2020 2020 2020 2320 7468 6520 4974          # the It
-0002fc50: 6572 6162 6c65 2063 6865 636b 2069 7320  erable check is 
-0002fc60: 7265 7175 6972 6564 2066 6f72 206d 7970  required for myp
-0002fc70: 790a 2020 2020 2020 2020 6966 2069 735f  y.        if is_
-0002fc80: 7363 616c 6172 286e 616d 6573 2920 6f72  scalar(names) or
-0002fc90: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-0002fca0: 6e61 6d65 732c 2049 7465 7261 626c 6529  names, Iterable)
-0002fcb0: 3a0a 2020 2020 2020 2020 2020 2020 6e61  :.            na
-0002fcc0: 6d65 7320 3d20 7b6e 616d 6573 7d0a 2020  mes = {names}.  
-0002fcd0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0002fce0: 2020 2020 2020 2020 6e61 6d65 7320 3d20          names = 
-0002fcf0: 7365 7428 6e61 6d65 7329 0a20 2020 2020  set(names).     
-0002fd00: 2020 2069 6620 6572 726f 7273 203d 3d20     if errors == 
-0002fd10: 2272 6169 7365 223a 0a20 2020 2020 2020  "raise":.       
-0002fd20: 2020 2020 2073 656c 662e 5f61 7373 6572       self._asser
-0002fd30: 745f 616c 6c5f 696e 5f64 6174 6173 6574  t_all_in_dataset
-0002fd40: 286e 616d 6573 290a 0a20 2020 2020 2020  (names)..       
-0002fd50: 2023 2047 4836 3530 350a 2020 2020 2020   # GH6505.      
-0002fd60: 2020 6f74 6865 725f 6e61 6d65 7320 3d20    other_names = 
-0002fd70: 7365 7428 290a 2020 2020 2020 2020 666f  set().        fo
-0002fd80: 7220 7661 7220 696e 206e 616d 6573 3a0a  r var in names:.
-0002fd90: 2020 2020 2020 2020 2020 2020 6d61 7962              mayb
-0002fda0: 655f 6d69 6478 203d 2073 656c 662e 5f69  e_midx = self._i
-0002fdb0: 6e64 6578 6573 2e67 6574 2876 6172 2c20  ndexes.get(var, 
-0002fdc0: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
-0002fdd0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-0002fde0: 6d61 7962 655f 6d69 6478 2c20 5061 6e64  maybe_midx, Pand
-0002fdf0: 6173 4d75 6c74 6949 6e64 6578 293a 0a20  asMultiIndex):. 
-0002fe00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0002fe10: 6478 5f63 6f6f 7264 5f6e 616d 6573 203d  dx_coord_names =
-0002fe20: 2073 6574 286d 6179 6265 5f6d 6964 782e   set(maybe_midx.
-0002fe30: 696e 6465 782e 6e61 6d65 7320 2b20 5b6d  index.names + [m
-0002fe40: 6179 6265 5f6d 6964 782e 6469 6d5d 290a  aybe_midx.dim]).
-0002fe50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0002fe60: 6964 785f 6f74 6865 725f 6e61 6d65 7320  idx_other_names 
-0002fe70: 3d20 6964 785f 636f 6f72 645f 6e61 6d65  = idx_coord_name
-0002fe80: 7320 2d20 7365 7428 6e61 6d65 7329 0a20  s - set(names). 
-0002fe90: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-0002fea0: 7468 6572 5f6e 616d 6573 2e75 7064 6174  ther_names.updat
-0002feb0: 6528 6964 785f 6f74 6865 725f 6e61 6d65  e(idx_other_name
-0002fec0: 7329 0a20 2020 2020 2020 2069 6620 6f74  s).        if ot
-0002fed0: 6865 725f 6e61 6d65 733a 0a20 2020 2020  her_names:.     
-0002fee0: 2020 2020 2020 206e 616d 6573 207c 3d20         names |= 
-0002fef0: 7365 7428 6f74 6865 725f 6e61 6d65 7329  set(other_names)
-0002ff00: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
-0002ff10: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
-0002ff20: 2020 2020 2020 2020 2020 2020 6622 4465              f"De
-0002ff30: 6c65 7469 6e67 2061 2073 696e 676c 6520  leting a single 
-0002ff40: 6c65 7665 6c20 6f66 2061 204d 756c 7469  level of a Multi
-0002ff50: 496e 6465 7820 6973 2064 6570 7265 6361  Index is depreca
-0002ff60: 7465 642e 2050 7265 7669 6f75 736c 792c  ted. Previously,
-0002ff70: 2074 6869 7320 6465 6c65 7465 6420 616c   this deleted al
-0002ff80: 6c20 6c65 7665 6c73 206f 6620 6120 4d75  l levels of a Mu
-0002ff90: 6c74 6949 6e64 6578 2e20 220a 2020 2020  ltiIndex. ".    
-0002ffa0: 2020 2020 2020 2020 2020 2020 6622 506c              f"Pl
-0002ffb0: 6561 7365 2061 6c73 6f20 6472 6f70 2074  ease also drop t
-0002ffc0: 6865 2066 6f6c 6c6f 7769 6e67 2076 6172  he following var
-0002ffd0: 6961 626c 6573 3a20 7b6f 7468 6572 5f6e  iables: {other_n
-0002ffe0: 616d 6573 2172 7d20 746f 2061 766f 6964  ames!r} to avoid
-0002fff0: 2061 6e20 6572 726f 7220 696e 2074 6865   an error in the
-00030000: 2066 7574 7572 652e 222c 0a20 2020 2020   future.",.     
-00030010: 2020 2020 2020 2020 2020 2044 6570 7265             Depre
-00030020: 6361 7469 6f6e 5761 726e 696e 672c 0a20  cationWarning,. 
-00030030: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00030040: 7461 636b 6c65 7665 6c3d 322c 0a20 2020  tacklevel=2,.   
-00030050: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00030060: 2020 2020 6173 7365 7274 5f6e 6f5f 696e      assert_no_in
-00030070: 6465 785f 636f 7272 7570 7465 6428 7365  dex_corrupted(se
-00030080: 6c66 2e78 696e 6465 7865 732c 206e 616d  lf.xindexes, nam
-00030090: 6573 290a 0a20 2020 2020 2020 2076 6172  es)..        var
-000300a0: 6961 626c 6573 203d 207b 6b3a 2076 2066  iables = {k: v f
-000300b0: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
-000300c0: 5f76 6172 6961 626c 6573 2e69 7465 6d73  _variables.items
-000300d0: 2829 2069 6620 6b20 6e6f 7420 696e 206e  () if k not in n
-000300e0: 616d 6573 7d0a 2020 2020 2020 2020 636f  ames}.        co
-000300f0: 6f72 645f 6e61 6d65 7320 3d20 7b6b 2066  ord_names = {k f
-00030100: 6f72 206b 2069 6e20 7365 6c66 2e5f 636f  or k in self._co
-00030110: 6f72 645f 6e61 6d65 7320 6966 206b 2069  ord_names if k i
-00030120: 6e20 7661 7269 6162 6c65 737d 0a20 2020  n variables}.   
-00030130: 2020 2020 2069 6e64 6578 6573 203d 207b       indexes = {
-00030140: 6b3a 2076 2066 6f72 206b 2c20 7620 696e  k: v for k, v in
-00030150: 2073 656c 662e 5f69 6e64 6578 6573 2e69   self._indexes.i
-00030160: 7465 6d73 2829 2069 6620 6b20 6e6f 7420  tems() if k not 
-00030170: 696e 206e 616d 6573 7d0a 2020 2020 2020  in names}.      
-00030180: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-00030190: 6570 6c61 6365 5f77 6974 685f 6e65 775f  eplace_with_new_
-000301a0: 6469 6d73 280a 2020 2020 2020 2020 2020  dims(.          
-000301b0: 2020 7661 7269 6162 6c65 732c 2063 6f6f    variables, coo
-000301c0: 7264 5f6e 616d 6573 3d63 6f6f 7264 5f6e  rd_names=coord_n
-000301d0: 616d 6573 2c20 696e 6465 7865 733d 696e  ames, indexes=in
-000301e0: 6465 7865 730a 2020 2020 2020 2020 290a  dexes.        ).
-000301f0: 0a20 2020 2064 6566 2064 726f 705f 696e  .    def drop_in
-00030200: 6465 7865 7328 0a20 2020 2020 2020 2073  dexes(.        s
-00030210: 656c 663a 2054 5f44 6174 6173 6574 2c0a  elf: T_Dataset,.
-00030220: 2020 2020 2020 2020 636f 6f72 645f 6e61          coord_na
-00030230: 6d65 733a 2048 6173 6861 626c 6520 7c20  mes: Hashable | 
-00030240: 4974 6572 6162 6c65 5b48 6173 6861 626c  Iterable[Hashabl
-00030250: 655d 2c0a 2020 2020 2020 2020 2a2c 0a20  e],.        *,. 
-00030260: 2020 2020 2020 2065 7272 6f72 733a 2045         errors: E
-00030270: 7272 6f72 4f70 7469 6f6e 7320 3d20 2272  rrorOptions = "r
-00030280: 6169 7365 222c 0a20 2020 2029 202d 3e20  aise",.    ) -> 
-00030290: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
-000302a0: 2020 2022 2222 4472 6f70 2074 6865 2069     """Drop the i
-000302b0: 6e64 6578 6573 2061 7373 6967 6e65 6420  ndexes assigned 
-000302c0: 746f 2074 6865 2067 6976 656e 2063 6f6f  to the given coo
-000302d0: 7264 696e 6174 6573 2e0a 0a20 2020 2020  rdinates...     
-000302e0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-000302f0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00030300: 0a20 2020 2020 2020 2063 6f6f 7264 5f6e  .        coord_n
-00030310: 616d 6573 203a 2068 6173 6861 626c 6520  ames : hashable 
-00030320: 6f72 2069 7465 7261 626c 6520 6f66 2068  or iterable of h
-00030330: 6173 6861 626c 650a 2020 2020 2020 2020  ashable.        
-00030340: 2020 2020 4e61 6d65 2873 2920 6f66 2074      Name(s) of t
-00030350: 6865 2063 6f6f 7264 696e 6174 6528 7329  he coordinate(s)
-00030360: 2066 6f72 2077 6869 6368 2074 6f20 6472   for which to dr
-00030370: 6f70 2074 6865 2069 6e64 6578 2e0a 2020  op the index..  
-00030380: 2020 2020 2020 6572 726f 7273 203a 207b        errors : {
-00030390: 2272 6169 7365 222c 2022 6967 6e6f 7265  "raise", "ignore
-000303a0: 227d 2c20 6465 6661 756c 743a 2022 7261  "}, default: "ra
-000303b0: 6973 6522 0a20 2020 2020 2020 2020 2020  ise".           
-000303c0: 2049 6620 2772 6169 7365 272c 2072 6169   If 'raise', rai
-000303d0: 7365 7320 6120 5661 6c75 6545 7272 6f72  ses a ValueError
-000303e0: 2065 7272 6f72 2069 6620 616e 7920 6f66   error if any of
-000303f0: 2074 6865 2063 6f6f 7264 696e 6174 6573   the coordinates
-00030400: 0a20 2020 2020 2020 2020 2020 2070 6173  .            pas
-00030410: 7365 6420 6861 7665 206e 6f20 696e 6465  sed have no inde
-00030420: 7820 6f72 2061 7265 206e 6f74 2069 6e20  x or are not in 
-00030430: 7468 6520 6461 7461 7365 742e 0a20 2020  the dataset..   
-00030440: 2020 2020 2020 2020 2049 6620 2769 676e           If 'ign
-00030450: 6f72 6527 2c20 6e6f 2065 7272 6f72 2069  ore', no error i
-00030460: 7320 7261 6973 6564 2e0a 0a20 2020 2020  s raised...     
-00030470: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00030480: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00030490: 2020 2064 726f 7070 6564 203a 2044 6174     dropped : Dat
-000304a0: 6173 6574 0a20 2020 2020 2020 2020 2020  aset.           
-000304b0: 2041 206e 6577 2064 6174 6173 6574 2077   A new dataset w
-000304c0: 6974 6820 6472 6f70 7065 6420 696e 6465  ith dropped inde
-000304d0: 7865 732e 0a0a 2020 2020 2020 2020 2222  xes...        ""
-000304e0: 220a 2020 2020 2020 2020 2320 7468 6520  ".        # the 
-000304f0: 4974 6572 6162 6c65 2063 6865 636b 2069  Iterable check i
-00030500: 7320 7265 7175 6972 6564 2066 6f72 206d  s required for m
-00030510: 7970 790a 2020 2020 2020 2020 6966 2069  ypy.        if i
-00030520: 735f 7363 616c 6172 2863 6f6f 7264 5f6e  s_scalar(coord_n
-00030530: 616d 6573 2920 6f72 206e 6f74 2069 7369  ames) or not isi
-00030540: 6e73 7461 6e63 6528 636f 6f72 645f 6e61  nstance(coord_na
-00030550: 6d65 732c 2049 7465 7261 626c 6529 3a0a  mes, Iterable):.
-00030560: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
-00030570: 645f 6e61 6d65 7320 3d20 7b63 6f6f 7264  d_names = {coord
-00030580: 5f6e 616d 6573 7d0a 2020 2020 2020 2020  _names}.        
-00030590: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000305a0: 2020 636f 6f72 645f 6e61 6d65 7320 3d20    coord_names = 
-000305b0: 7365 7428 636f 6f72 645f 6e61 6d65 7329  set(coord_names)
-000305c0: 0a0a 2020 2020 2020 2020 6966 2065 7272  ..        if err
-000305d0: 6f72 7320 3d3d 2022 7261 6973 6522 3a0a  ors == "raise":.
-000305e0: 2020 2020 2020 2020 2020 2020 696e 7661              inva
-000305f0: 6c69 645f 636f 6f72 6473 203d 2063 6f6f  lid_coords = coo
-00030600: 7264 5f6e 616d 6573 202d 2073 656c 662e  rd_names - self.
-00030610: 5f63 6f6f 7264 5f6e 616d 6573 0a20 2020  _coord_names.   
-00030620: 2020 2020 2020 2020 2069 6620 696e 7661           if inva
-00030630: 6c69 645f 636f 6f72 6473 3a0a 2020 2020  lid_coords:.    
-00030640: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00030650: 6520 5661 6c75 6545 7272 6f72 2866 2274  e ValueError(f"t
-00030660: 686f 7365 2063 6f6f 7264 696e 6174 6573  hose coordinates
-00030670: 2064 6f6e 2774 2065 7869 7374 3a20 7b69   don't exist: {i
-00030680: 6e76 616c 6964 5f63 6f6f 7264 737d 2229  nvalid_coords}")
-00030690: 0a0a 2020 2020 2020 2020 2020 2020 756e  ..            un
-000306a0: 696e 6465 7865 645f 636f 6f72 6473 203d  indexed_coords =
-000306b0: 2073 6574 2863 6f6f 7264 5f6e 616d 6573   set(coord_names
-000306c0: 2920 2d20 7365 7428 7365 6c66 2e5f 696e  ) - set(self._in
-000306d0: 6465 7865 7329 0a20 2020 2020 2020 2020  dexes).         
-000306e0: 2020 2069 6620 756e 696e 6465 7865 645f     if unindexed_
-000306f0: 636f 6f72 6473 3a0a 2020 2020 2020 2020  coords:.        
-00030700: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-00030710: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
-00030720: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00030730: 7468 6f73 6520 636f 6f72 6469 6e61 7465  those coordinate
-00030740: 7320 646f 206e 6f74 2068 6176 6520 616e  s do not have an
-00030750: 2069 6e64 6578 3a20 7b75 6e69 6e64 6578   index: {unindex
-00030760: 6564 5f63 6f6f 7264 737d 220a 2020 2020  ed_coords}".    
-00030770: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00030780: 2020 2020 2020 2061 7373 6572 745f 6e6f         assert_no
-00030790: 5f69 6e64 6578 5f63 6f72 7275 7074 6564  _index_corrupted
-000307a0: 2873 656c 662e 7869 6e64 6578 6573 2c20  (self.xindexes, 
-000307b0: 636f 6f72 645f 6e61 6d65 732c 2061 6374  coord_names, act
-000307c0: 696f 6e3d 2272 656d 6f76 6520 696e 6465  ion="remove inde
-000307d0: 7828 6573 2922 290a 0a20 2020 2020 2020  x(es)")..       
-000307e0: 2076 6172 6961 626c 6573 203d 207b 7d0a   variables = {}.
-000307f0: 2020 2020 2020 2020 666f 7220 6e61 6d65          for name
-00030800: 2c20 7661 7220 696e 2073 656c 662e 5f76  , var in self._v
-00030810: 6172 6961 626c 6573 2e69 7465 6d73 2829  ariables.items()
-00030820: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00030830: 206e 616d 6520 696e 2063 6f6f 7264 5f6e   name in coord_n
-00030840: 616d 6573 3a0a 2020 2020 2020 2020 2020  ames:.          
-00030850: 2020 2020 2020 7661 7269 6162 6c65 735b        variables[
-00030860: 6e61 6d65 5d20 3d20 7661 722e 746f 5f62  name] = var.to_b
-00030870: 6173 655f 7661 7269 6162 6c65 2829 0a20  ase_variable(). 
-00030880: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-00030890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000308a0: 2076 6172 6961 626c 6573 5b6e 616d 655d   variables[name]
-000308b0: 203d 2076 6172 0a0a 2020 2020 2020 2020   = var..        
-000308c0: 696e 6465 7865 7320 3d20 7b6b 3a20 7620  indexes = {k: v 
-000308d0: 666f 7220 6b2c 2076 2069 6e20 7365 6c66  for k, v in self
-000308e0: 2e5f 696e 6465 7865 732e 6974 656d 7328  ._indexes.items(
-000308f0: 2920 6966 206b 206e 6f74 2069 6e20 636f  ) if k not in co
-00030900: 6f72 645f 6e61 6d65 737d 0a0a 2020 2020  ord_names}..    
-00030910: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00030920: 5f72 6570 6c61 6365 2876 6172 6961 626c  _replace(variabl
-00030930: 6573 3d76 6172 6961 626c 6573 2c20 696e  es=variables, in
-00030940: 6465 7865 733d 696e 6465 7865 7329 0a0a  dexes=indexes)..
-00030950: 2020 2020 6465 6620 6472 6f70 280a 2020      def drop(.  
-00030960: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
-00030970: 7461 7365 742c 0a20 2020 2020 2020 206c  taset,.        l
-00030980: 6162 656c 733d 4e6f 6e65 2c0a 2020 2020  abels=None,.    
-00030990: 2020 2020 6469 6d3d 4e6f 6e65 2c0a 2020      dim=None,.  
-000309a0: 2020 2020 2020 2a2c 0a20 2020 2020 2020        *,.       
-000309b0: 2065 7272 6f72 733a 2045 7272 6f72 4f70   errors: ErrorOp
-000309c0: 7469 6f6e 7320 3d20 2272 6169 7365 222c  tions = "raise",
-000309d0: 0a20 2020 2020 2020 202a 2a6c 6162 656c  .        **label
-000309e0: 735f 6b77 6172 6773 2c0a 2020 2020 2920  s_kwargs,.    ) 
-000309f0: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-00030a00: 2020 2020 2020 2222 2242 6163 6b77 6172        """Backwar
-00030a10: 6420 636f 6d70 6174 6962 6c65 206d 6574  d compatible met
-00030a20: 686f 6420 6261 7365 6420 6f6e 2060 6472  hod based on `dr
-00030a30: 6f70 5f76 6172 7360 2061 6e64 2060 6472  op_vars` and `dr
-00030a40: 6f70 5f73 656c 600a 0a20 2020 2020 2020  op_sel`..       
-00030a50: 2055 7369 6e67 2065 6974 6865 7220 6064   Using either `d
-00030a60: 726f 705f 7661 7273 6020 6f72 2060 6472  rop_vars` or `dr
-00030a70: 6f70 5f73 656c 6020 6973 2065 6e63 6f75  op_sel` is encou
-00030a80: 7261 6765 640a 0a20 2020 2020 2020 2053  raged..        S
-00030a90: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-00030aa0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00030ab0: 2044 6174 6173 6574 2e64 726f 705f 7661   Dataset.drop_va
-00030ac0: 7273 0a20 2020 2020 2020 2044 6174 6173  rs.        Datas
-00030ad0: 6574 2e64 726f 705f 7365 6c0a 2020 2020  et.drop_sel.    
-00030ae0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00030af0: 6966 2065 7272 6f72 7320 6e6f 7420 696e  if errors not in
-00030b00: 205b 2272 6169 7365 222c 2022 6967 6e6f   ["raise", "igno
-00030b10: 7265 225d 3a0a 2020 2020 2020 2020 2020  re"]:.          
-00030b20: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-00030b30: 6f72 2827 6572 726f 7273 206d 7573 7420  or('errors must 
-00030b40: 6265 2065 6974 6865 7220 2272 6169 7365  be either "raise
-00030b50: 2220 6f72 2022 6967 6e6f 7265 2227 290a  " or "ignore"').
-00030b60: 0a20 2020 2020 2020 2069 6620 6973 5f64  .        if is_d
-00030b70: 6963 745f 6c69 6b65 286c 6162 656c 7329  ict_like(labels)
-00030b80: 2061 6e64 206e 6f74 2069 7369 6e73 7461   and not isinsta
-00030b90: 6e63 6528 6c61 6265 6c73 2c20 6469 6374  nce(labels, dict
-00030ba0: 293a 0a20 2020 2020 2020 2020 2020 2077  ):.            w
-00030bb0: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-00030bc0: 2020 2020 2020 2020 2020 2020 2020 2264                "d
-00030bd0: 726f 7070 696e 6720 636f 6f72 6469 6e61  ropping coordina
-00030be0: 7465 7320 7573 696e 6720 6064 726f 7060  tes using `drop`
-00030bf0: 2069 7320 6265 2064 6570 7265 6361 7465   is be deprecate
-00030c00: 643b 2075 7365 2064 726f 705f 7661 7273  d; use drop_vars
-00030c10: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
-00030c20: 2020 2020 4675 7475 7265 5761 726e 696e      FutureWarnin
-00030c30: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
-00030c40: 2020 2073 7461 636b 6c65 7665 6c3d 322c     stacklevel=2,
-00030c50: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00030c60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00030c70: 6e20 7365 6c66 2e64 726f 705f 7661 7273  n self.drop_vars
-00030c80: 286c 6162 656c 732c 2065 7272 6f72 733d  (labels, errors=
-00030c90: 6572 726f 7273 290a 0a20 2020 2020 2020  errors)..       
-00030ca0: 2069 6620 6c61 6265 6c73 5f6b 7761 7267   if labels_kwarg
-00030cb0: 7320 6f72 2069 7369 6e73 7461 6e63 6528  s or isinstance(
-00030cc0: 6c61 6265 6c73 2c20 6469 6374 293a 0a20  labels, dict):. 
-00030cd0: 2020 2020 2020 2020 2020 2069 6620 6469             if di
-00030ce0: 6d20 6973 206e 6f74 204e 6f6e 653a 0a20  m is not None:. 
-00030cf0: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00030d00: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00030d10: 2263 616e 6e6f 7420 7370 6563 6966 7920  "cannot specify 
-00030d20: 6469 6d20 616e 6420 6469 6374 2d6c 696b  dim and dict-lik
-00030d30: 6520 6172 6775 6d65 6e74 732e 2229 0a20  e arguments."). 
-00030d40: 2020 2020 2020 2020 2020 206c 6162 656c             label
-00030d50: 7320 3d20 6569 7468 6572 5f64 6963 745f  s = either_dict_
-00030d60: 6f72 5f6b 7761 7267 7328 6c61 6265 6c73  or_kwargs(labels
-00030d70: 2c20 6c61 6265 6c73 5f6b 7761 7267 732c  , labels_kwargs,
-00030d80: 2022 6472 6f70 2229 0a0a 2020 2020 2020   "drop")..      
-00030d90: 2020 6966 2064 696d 2069 7320 4e6f 6e65    if dim is None
-00030da0: 2061 6e64 2028 6973 5f73 6361 6c61 7228   and (is_scalar(
-00030db0: 6c61 6265 6c73 2920 6f72 2069 7369 6e73  labels) or isins
-00030dc0: 7461 6e63 6528 6c61 6265 6c73 2c20 4974  tance(labels, It
-00030dd0: 6572 6162 6c65 2929 3a0a 2020 2020 2020  erable)):.      
-00030de0: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00030df0: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00030e00: 2020 2020 2022 6472 6f70 7069 6e67 2076       "dropping v
-00030e10: 6172 6961 626c 6573 2075 7369 6e67 2060  ariables using `
-00030e20: 6472 6f70 6020 7769 6c6c 2062 6520 6465  drop` will be de
-00030e30: 7072 6563 6174 6564 3b20 7573 696e 6720  precated; using 
-00030e40: 6472 6f70 5f76 6172 7320 6973 2065 6e63  drop_vars is enc
-00030e50: 6f75 7261 6765 642e 222c 0a20 2020 2020  ouraged.",.     
-00030e60: 2020 2020 2020 2020 2020 2050 656e 6469             Pendi
-00030e70: 6e67 4465 7072 6563 6174 696f 6e57 6172  ngDeprecationWar
-00030e80: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-00030e90: 2020 2020 2020 7374 6163 6b6c 6576 656c        stacklevel
-00030ea0: 3d32 2c0a 2020 2020 2020 2020 2020 2020  =2,.            
-00030eb0: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-00030ec0: 7475 726e 2073 656c 662e 6472 6f70 5f76  turn self.drop_v
-00030ed0: 6172 7328 6c61 6265 6c73 2c20 6572 726f  ars(labels, erro
-00030ee0: 7273 3d65 7272 6f72 7329 0a20 2020 2020  rs=errors).     
-00030ef0: 2020 2069 6620 6469 6d20 6973 206e 6f74     if dim is not
-00030f00: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00030f10: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00030f20: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00030f30: 2020 2264 726f 7070 696e 6720 6c61 6265    "dropping labe
-00030f40: 6c73 2075 7369 6e67 206c 6973 742d 6c69  ls using list-li
-00030f50: 6b65 206c 6162 656c 7320 6973 2064 6570  ke labels is dep
-00030f60: 7265 6361 7465 643b 2075 7369 6e67 2022  recated; using "
-00030f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00030f80: 2022 6469 6374 2d6c 696b 6520 6172 6775   "dict-like argu
-00030f90: 6d65 6e74 7320 7769 7468 2060 6472 6f70  ments with `drop
-00030fa0: 5f73 656c 602c 2065 2e67 2e20 6064 732e  _sel`, e.g. `ds.
-00030fb0: 6472 6f70 5f73 656c 2864 696d 3d5b 6c61  drop_sel(dim=[la
-00030fc0: 6265 6c73 5d29 2e22 2c0a 2020 2020 2020  bels]).",.      
-00030fd0: 2020 2020 2020 2020 2020 4465 7072 6563            Deprec
-00030fe0: 6174 696f 6e57 6172 6e69 6e67 2c0a 2020  ationWarning,.  
-00030ff0: 2020 2020 2020 2020 2020 2020 2020 7374                st
-00031000: 6163 6b6c 6576 656c 3d32 2c0a 2020 2020  acklevel=2,.    
-00031010: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00031020: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00031030: 662e 6472 6f70 5f73 656c 287b 6469 6d3a  f.drop_sel({dim:
-00031040: 206c 6162 656c 737d 2c20 6572 726f 7273   labels}, errors
-00031050: 3d65 7272 6f72 732c 202a 2a6c 6162 656c  =errors, **label
-00031060: 735f 6b77 6172 6773 290a 0a20 2020 2020  s_kwargs)..     
-00031070: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00031080: 280a 2020 2020 2020 2020 2020 2020 2264  (.            "d
-00031090: 726f 7070 696e 6720 6c61 6265 6c73 2075  ropping labels u
-000310a0: 7369 6e67 2060 6472 6f70 6020 7769 6c6c  sing `drop` will
-000310b0: 2062 6520 6465 7072 6563 6174 6564 3b20   be deprecated; 
-000310c0: 7573 696e 6720 6472 6f70 5f73 656c 2069  using drop_sel i
-000310d0: 7320 656e 636f 7572 6167 6564 2e22 2c0a  s encouraged.",.
-000310e0: 2020 2020 2020 2020 2020 2020 5065 6e64              Pend
-000310f0: 696e 6744 6570 7265 6361 7469 6f6e 5761  ingDeprecationWa
-00031100: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
-00031110: 2020 2073 7461 636b 6c65 7665 6c3d 322c     stacklevel=2,
-00031120: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
-00031130: 2020 2072 6574 7572 6e20 7365 6c66 2e64     return self.d
-00031140: 726f 705f 7365 6c28 6c61 6265 6c73 2c20  rop_sel(labels, 
-00031150: 6572 726f 7273 3d65 7272 6f72 7329 0a0a  errors=errors)..
-00031160: 2020 2020 6465 6620 6472 6f70 5f73 656c      def drop_sel
-00031170: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
-00031180: 545f 4461 7461 7365 742c 206c 6162 656c  T_Dataset, label
-00031190: 733d 4e6f 6e65 2c20 2a2c 2065 7272 6f72  s=None, *, error
-000311a0: 733a 2045 7272 6f72 4f70 7469 6f6e 7320  s: ErrorOptions 
-000311b0: 3d20 2272 6169 7365 222c 202a 2a6c 6162  = "raise", **lab
-000311c0: 656c 735f 6b77 6172 6773 0a20 2020 2029  els_kwargs.    )
-000311d0: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
-000311e0: 2020 2020 2020 2022 2222 4472 6f70 2069         """Drop i
-000311f0: 6e64 6578 206c 6162 656c 7320 6672 6f6d  ndex labels from
-00031200: 2074 6869 7320 6461 7461 7365 742e 0a0a   this dataset...
-00031210: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00031220: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00031230: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6c61  -----.        la
-00031240: 6265 6c73 203a 206d 6170 7069 6e67 206f  bels : mapping o
-00031250: 6620 6861 7368 6162 6c65 2074 6f20 416e  f hashable to An
-00031260: 790a 2020 2020 2020 2020 2020 2020 496e  y.            In
-00031270: 6465 7820 6c61 6265 6c73 2074 6f20 6472  dex labels to dr
-00031280: 6f70 0a20 2020 2020 2020 2065 7272 6f72  op.        error
-00031290: 7320 3a20 7b22 7261 6973 6522 2c20 2269  s : {"raise", "i
-000312a0: 676e 6f72 6522 7d2c 2064 6566 6175 6c74  gnore"}, default
-000312b0: 3a20 2272 6169 7365 220a 2020 2020 2020  : "raise".      
-000312c0: 2020 2020 2020 4966 2027 7261 6973 6527        If 'raise'
-000312d0: 2c20 7261 6973 6573 2061 2056 616c 7565  , raises a Value
-000312e0: 4572 726f 7220 6572 726f 7220 6966 0a20  Error error if. 
-000312f0: 2020 2020 2020 2020 2020 2061 6e79 206f             any o
-00031300: 6620 7468 6520 696e 6465 7820 6c61 6265  f the index labe
-00031310: 6c73 2070 6173 7365 6420 6172 6520 6e6f  ls passed are no
-00031320: 740a 2020 2020 2020 2020 2020 2020 696e  t.            in
-00031330: 2074 6865 2064 6174 6173 6574 2e20 4966   the dataset. If
-00031340: 2027 6967 6e6f 7265 272c 2061 6e79 2067   'ignore', any g
-00031350: 6976 656e 206c 6162 656c 7320 7468 6174  iven labels that
-00031360: 2061 7265 2069 6e20 7468 650a 2020 2020   are in the.    
-00031370: 2020 2020 2020 2020 6461 7461 7365 7420          dataset 
-00031380: 6172 6520 6472 6f70 7065 6420 616e 6420  are dropped and 
-00031390: 6e6f 2065 7272 6f72 2069 7320 7261 6973  no error is rais
-000313a0: 6564 2e0a 2020 2020 2020 2020 2a2a 6c61  ed..        **la
-000313b0: 6265 6c73 5f6b 7761 7267 7320 3a20 7b64  bels_kwargs : {d
-000313c0: 696d 3a20 6c61 6265 6c2c 202e 2e2e 7d2c  im: label, ...},
-000313d0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000313e0: 2020 2020 2020 5468 6520 6b65 7977 6f72        The keywor
-000313f0: 6420 6172 6775 6d65 6e74 7320 666f 726d  d arguments form
-00031400: 206f 6620 6060 6469 6d60 6020 616e 6420   of ``dim`` and 
-00031410: 6060 6c61 6265 6c73 6060 0a0a 2020 2020  ``labels``..    
-00031420: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00031430: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00031440: 2020 2020 6472 6f70 7065 6420 3a20 4461      dropped : Da
-00031450: 7461 7365 740a 0a20 2020 2020 2020 2045  taset..        E
-00031460: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00031470: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00031480: 203e 3e3e 2064 6174 6120 3d20 6e70 2e61   >>> data = np.a
-00031490: 7261 6e67 6528 3629 2e72 6573 6861 7065  range(6).reshape
-000314a0: 2832 2c20 3329 0a20 2020 2020 2020 203e  (2, 3).        >
-000314b0: 3e3e 206c 6162 656c 7320 3d20 5b22 6122  >> labels = ["a"
-000314c0: 2c20 2262 222c 2022 6322 5d0a 2020 2020  , "b", "c"].    
-000314d0: 2020 2020 3e3e 3e20 6473 203d 2078 722e      >>> ds = xr.
-000314e0: 4461 7461 7365 7428 7b22 4122 3a20 285b  Dataset({"A": ([
-000314f0: 2278 222c 2022 7922 5d2c 2064 6174 6129  "x", "y"], data)
-00031500: 2c20 2279 223a 206c 6162 656c 737d 290a  , "y": labels}).
-00031510: 2020 2020 2020 2020 3e3e 3e20 6473 0a20          >>> ds. 
-00031520: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
-00031530: 6174 6173 6574 3e0a 2020 2020 2020 2020  ataset>.        
-00031540: 4469 6d65 6e73 696f 6e73 3a20 2028 783a  Dimensions:  (x:
-00031550: 2032 2c20 793a 2033 290a 2020 2020 2020   2, y: 3).      
-00031560: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
-00031570: 2020 2020 2020 2020 202a 2079 2020 2020           * y    
-00031580: 2020 2020 2879 2920 3c55 3120 2761 2720      (y) <U1 'a' 
-00031590: 2762 2720 2763 270a 2020 2020 2020 2020  'b' 'c'.        
-000315a0: 4469 6d65 6e73 696f 6e73 2077 6974 686f  Dimensions witho
-000315b0: 7574 2063 6f6f 7264 696e 6174 6573 3a20  ut coordinates: 
-000315c0: 780a 2020 2020 2020 2020 4461 7461 2076  x.        Data v
-000315d0: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
-000315e0: 2020 2020 2020 4120 2020 2020 2020 2028        A        (
-000315f0: 782c 2079 2920 696e 7436 3420 3020 3120  x, y) int64 0 1 
-00031600: 3220 3320 3420 350a 2020 2020 2020 2020  2 3 4 5.        
-00031610: 3e3e 3e20 6473 2e64 726f 705f 7365 6c28  >>> ds.drop_sel(
-00031620: 793d 5b22 6122 2c20 2263 225d 290a 2020  y=["a", "c"]).  
-00031630: 2020 2020 2020 3c78 6172 7261 792e 4461        <xarray.Da
-00031640: 7461 7365 743e 0a20 2020 2020 2020 2044  taset>.        D
-00031650: 696d 656e 7369 6f6e 733a 2020 2878 3a20  imensions:  (x: 
-00031660: 322c 2079 3a20 3129 0a20 2020 2020 2020  2, y: 1).       
-00031670: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
-00031680: 2020 2020 2020 2020 2a20 7920 2020 2020          * y     
-00031690: 2020 2028 7929 203c 5531 2027 6227 0a20     (y) <U1 'b'. 
-000316a0: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
-000316b0: 7320 7769 7468 6f75 7420 636f 6f72 6469  s without coordi
-000316c0: 6e61 7465 733a 2078 0a20 2020 2020 2020  nates: x.       
-000316d0: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
-000316e0: 0a20 2020 2020 2020 2020 2020 2041 2020  .            A  
-000316f0: 2020 2020 2020 2878 2c20 7929 2069 6e74        (x, y) int
-00031700: 3634 2031 2034 0a20 2020 2020 2020 203e  64 1 4.        >
-00031710: 3e3e 2064 732e 6472 6f70 5f73 656c 2879  >> ds.drop_sel(y
-00031720: 3d22 6222 290a 2020 2020 2020 2020 3c78  ="b").        <x
-00031730: 6172 7261 792e 4461 7461 7365 743e 0a20  array.Dataset>. 
-00031740: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
-00031750: 733a 2020 2878 3a20 322c 2079 3a20 3229  s:  (x: 2, y: 2)
-00031760: 0a20 2020 2020 2020 2043 6f6f 7264 696e  .        Coordin
-00031770: 6174 6573 3a0a 2020 2020 2020 2020 2020  ates:.          
-00031780: 2a20 7920 2020 2020 2020 2028 7929 203c  * y        (y) <
-00031790: 5531 2027 6127 2027 6327 0a20 2020 2020  U1 'a' 'c'.     
-000317a0: 2020 2044 696d 656e 7369 6f6e 7320 7769     Dimensions wi
-000317b0: 7468 6f75 7420 636f 6f72 6469 6e61 7465  thout coordinate
-000317c0: 733a 2078 0a20 2020 2020 2020 2044 6174  s: x.        Dat
-000317d0: 6120 7661 7269 6162 6c65 733a 0a20 2020  a variables:.   
-000317e0: 2020 2020 2020 2020 2041 2020 2020 2020           A      
-000317f0: 2020 2878 2c20 7929 2069 6e74 3634 2030    (x, y) int64 0
-00031800: 2032 2033 2035 0a20 2020 2020 2020 2022   2 3 5.        "
-00031810: 2222 0a20 2020 2020 2020 2069 6620 6572  "".        if er
-00031820: 726f 7273 206e 6f74 2069 6e20 5b22 7261  rors not in ["ra
-00031830: 6973 6522 2c20 2269 676e 6f72 6522 5d3a  ise", "ignore"]:
-00031840: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00031850: 7365 2056 616c 7565 4572 726f 7228 2765  se ValueError('e
-00031860: 7272 6f72 7320 6d75 7374 2062 6520 6569  rrors must be ei
-00031870: 7468 6572 2022 7261 6973 6522 206f 7220  ther "raise" or 
-00031880: 2269 676e 6f72 6522 2729 0a0a 2020 2020  "ignore"')..    
-00031890: 2020 2020 6c61 6265 6c73 203d 2065 6974      labels = eit
-000318a0: 6865 725f 6469 6374 5f6f 725f 6b77 6172  her_dict_or_kwar
-000318b0: 6773 286c 6162 656c 732c 206c 6162 656c  gs(labels, label
-000318c0: 735f 6b77 6172 6773 2c20 2264 726f 705f  s_kwargs, "drop_
-000318d0: 7365 6c22 290a 0a20 2020 2020 2020 2064  sel")..        d
-000318e0: 7320 3d20 7365 6c66 0a20 2020 2020 2020  s = self.       
-000318f0: 2066 6f72 2064 696d 2c20 6c61 6265 6c73   for dim, labels
-00031900: 5f66 6f72 5f64 696d 2069 6e20 6c61 6265  _for_dim in labe
-00031910: 6c73 2e69 7465 6d73 2829 3a0a 2020 2020  ls.items():.    
-00031920: 2020 2020 2020 2020 2320 446f 6e27 7420          # Don't 
-00031930: 6361 7374 2074 6f20 7365 742c 2061 7320  cast to set, as 
-00031940: 6974 2077 6f75 6c64 2068 6172 6d20 7065  it would harm pe
-00031950: 7266 6f72 6d61 6e63 6520 7768 656e 206c  rformance when l
-00031960: 6162 656c 730a 2020 2020 2020 2020 2020  abels.          
-00031970: 2020 2320 6973 2061 206c 6172 6765 206e    # is a large n
-00031980: 756d 7079 2061 7272 6179 0a20 2020 2020  umpy array.     
-00031990: 2020 2020 2020 2069 6620 7574 696c 732e         if utils.
-000319a0: 6973 5f73 6361 6c61 7228 6c61 6265 6c73  is_scalar(labels
-000319b0: 5f66 6f72 5f64 696d 293a 0a20 2020 2020  _for_dim):.     
-000319c0: 2020 2020 2020 2020 2020 206c 6162 656c             label
-000319d0: 735f 666f 725f 6469 6d20 3d20 5b6c 6162  s_for_dim = [lab
-000319e0: 656c 735f 666f 725f 6469 6d5d 0a20 2020  els_for_dim].   
-000319f0: 2020 2020 2020 2020 206c 6162 656c 735f           labels_
-00031a00: 666f 725f 6469 6d20 3d20 6e70 2e61 7361  for_dim = np.asa
-00031a10: 7272 6179 286c 6162 656c 735f 666f 725f  rray(labels_for_
-00031a20: 6469 6d29 0a20 2020 2020 2020 2020 2020  dim).           
-00031a30: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
-00031a40: 2020 2020 2020 696e 6465 7820 3d20 7365        index = se
-00031a50: 6c66 2e67 6574 5f69 6e64 6578 2864 696d  lf.get_index(dim
-00031a60: 290a 2020 2020 2020 2020 2020 2020 6578  ).            ex
-00031a70: 6365 7074 204b 6579 4572 726f 723a 0a20  cept KeyError:. 
-00031a80: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00031a90: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00031aa0: 6622 6469 6d65 6e73 696f 6e20 7b64 696d  f"dimension {dim
-00031ab0: 2172 7d20 646f 6573 206e 6f74 2068 6176  !r} does not hav
-00031ac0: 6520 636f 6f72 6469 6e61 7465 206c 6162  e coordinate lab
-00031ad0: 656c 7322 290a 2020 2020 2020 2020 2020  els").          
-00031ae0: 2020 6e65 775f 696e 6465 7820 3d20 696e    new_index = in
-00031af0: 6465 782e 6472 6f70 286c 6162 656c 735f  dex.drop(labels_
-00031b00: 666f 725f 6469 6d2c 2065 7272 6f72 733d  for_dim, errors=
-00031b10: 6572 726f 7273 290a 2020 2020 2020 2020  errors).        
-00031b20: 2020 2020 6473 203d 2064 732e 6c6f 635b      ds = ds.loc[
-00031b30: 7b64 696d 3a20 6e65 775f 696e 6465 787d  {dim: new_index}
-00031b40: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
-00031b50: 2064 730a 0a20 2020 2064 6566 2064 726f   ds..    def dro
-00031b60: 705f 6973 656c 2873 656c 663a 2054 5f44  p_isel(self: T_D
-00031b70: 6174 6173 6574 2c20 696e 6465 7865 7273  ataset, indexers
-00031b80: 3d4e 6f6e 652c 202a 2a69 6e64 6578 6572  =None, **indexer
-00031b90: 735f 6b77 6172 6773 2920 2d3e 2054 5f44  s_kwargs) -> T_D
-00031ba0: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
-00031bb0: 2222 2244 726f 7020 696e 6465 7820 706f  """Drop index po
-00031bc0: 7369 7469 6f6e 7320 6672 6f6d 2074 6869  sitions from thi
-00031bd0: 7320 4461 7461 7365 742e 0a0a 2020 2020  s Dataset...    
-00031be0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00031bf0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00031c00: 2d0a 2020 2020 2020 2020 696e 6465 7865  -.        indexe
-00031c10: 7273 203a 206d 6170 7069 6e67 206f 6620  rs : mapping of 
-00031c20: 6861 7368 6162 6c65 2074 6f20 416e 790a  hashable to Any.
-00031c30: 2020 2020 2020 2020 2020 2020 496e 6465              Inde
-00031c40: 7820 6c6f 6361 7469 6f6e 7320 746f 2064  x locations to d
-00031c50: 726f 700a 2020 2020 2020 2020 2a2a 696e  rop.        **in
-00031c60: 6465 7865 7273 5f6b 7761 7267 7320 3a20  dexers_kwargs : 
-00031c70: 7b64 696d 3a20 706f 7369 7469 6f6e 2c20  {dim: position, 
-00031c80: 2e2e 2e7d 2c20 6f70 7469 6f6e 616c 0a20  ...}, optional. 
-00031c90: 2020 2020 2020 2020 2020 2054 6865 206b             The k
-00031ca0: 6579 776f 7264 2061 7267 756d 656e 7473  eyword arguments
-00031cb0: 2066 6f72 6d20 6f66 2060 6064 696d 6060   form of ``dim``
-00031cc0: 2061 6e64 2060 6070 6f73 6974 696f 6e73   and ``positions
-00031cd0: 6060 0a0a 2020 2020 2020 2020 5265 7475  ``..        Retu
-00031ce0: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-00031cf0: 2d2d 2d0a 2020 2020 2020 2020 6472 6f70  ---.        drop
-00031d00: 7065 6420 3a20 4461 7461 7365 740a 0a20  ped : Dataset.. 
-00031d10: 2020 2020 2020 2052 6169 7365 730a 2020         Raises.  
-00031d20: 2020 2020 2020 2d2d 2d2d 2d2d 0a20 2020        ------.   
-00031d30: 2020 2020 2049 6e64 6578 4572 726f 720a       IndexError.
-00031d40: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-00031d50: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00031d60: 2d2d 0a20 2020 2020 2020 203e 3e3e 2064  --.        >>> d
-00031d70: 6174 6120 3d20 6e70 2e61 7261 6e67 6528  ata = np.arange(
-00031d80: 3629 2e72 6573 6861 7065 2832 2c20 3329  6).reshape(2, 3)
-00031d90: 0a20 2020 2020 2020 203e 3e3e 206c 6162  .        >>> lab
-00031da0: 656c 7320 3d20 5b22 6122 2c20 2262 222c  els = ["a", "b",
-00031db0: 2022 6322 5d0a 2020 2020 2020 2020 3e3e   "c"].        >>
-00031dc0: 3e20 6473 203d 2078 722e 4461 7461 7365  > ds = xr.Datase
-00031dd0: 7428 7b22 4122 3a20 285b 2278 222c 2022  t({"A": (["x", "
-00031de0: 7922 5d2c 2064 6174 6129 2c20 2279 223a  y"], data), "y":
-00031df0: 206c 6162 656c 737d 290a 2020 2020 2020   labels}).      
-00031e00: 2020 3e3e 3e20 6473 0a20 2020 2020 2020    >>> ds.       
-00031e10: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
-00031e20: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
-00031e30: 696f 6e73 3a20 2028 783a 2032 2c20 793a  ions:  (x: 2, y:
-00031e40: 2033 290a 2020 2020 2020 2020 436f 6f72   3).        Coor
-00031e50: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
-00031e60: 2020 202a 2079 2020 2020 2020 2020 2879     * y        (y
-00031e70: 2920 3c55 3120 2761 2720 2762 2720 2763  ) <U1 'a' 'b' 'c
-00031e80: 270a 2020 2020 2020 2020 4469 6d65 6e73  '.        Dimens
-00031e90: 696f 6e73 2077 6974 686f 7574 2063 6f6f  ions without coo
-00031ea0: 7264 696e 6174 6573 3a20 780a 2020 2020  rdinates: x.    
-00031eb0: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
-00031ec0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00031ed0: 4120 2020 2020 2020 2028 782c 2079 2920  A        (x, y) 
-00031ee0: 696e 7436 3420 3020 3120 3220 3320 3420  int64 0 1 2 3 4 
-00031ef0: 350a 2020 2020 2020 2020 3e3e 3e20 6473  5.        >>> ds
-00031f00: 2e64 726f 705f 6973 656c 2879 3d5b 302c  .drop_isel(y=[0,
-00031f10: 2032 5d29 0a20 2020 2020 2020 203c 7861   2]).        <xa
-00031f20: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
-00031f30: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
-00031f40: 3a20 2028 783a 2032 2c20 793a 2031 290a  :  (x: 2, y: 1).
-00031f50: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
-00031f60: 7465 733a 0a20 2020 2020 2020 2020 202a  tes:.          *
-00031f70: 2079 2020 2020 2020 2020 2879 2920 3c55   y        (y) <U
-00031f80: 3120 2762 270a 2020 2020 2020 2020 4469  1 'b'.        Di
-00031f90: 6d65 6e73 696f 6e73 2077 6974 686f 7574  mensions without
-00031fa0: 2063 6f6f 7264 696e 6174 6573 3a20 780a   coordinates: x.
-00031fb0: 2020 2020 2020 2020 4461 7461 2076 6172          Data var
-00031fc0: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
-00031fd0: 2020 2020 4120 2020 2020 2020 2028 782c      A        (x,
-00031fe0: 2079 2920 696e 7436 3420 3120 340a 2020   y) int64 1 4.  
-00031ff0: 2020 2020 2020 3e3e 3e20 6473 2e64 726f        >>> ds.dro
-00032000: 705f 6973 656c 2879 3d31 290a 2020 2020  p_isel(y=1).    
-00032010: 2020 2020 3c78 6172 7261 792e 4461 7461      <xarray.Data
-00032020: 7365 743e 0a20 2020 2020 2020 2044 696d  set>.        Dim
-00032030: 656e 7369 6f6e 733a 2020 2878 3a20 322c  ensions:  (x: 2,
-00032040: 2079 3a20 3229 0a20 2020 2020 2020 2043   y: 2).        C
-00032050: 6f6f 7264 696e 6174 6573 3a0a 2020 2020  oordinates:.    
-00032060: 2020 2020 2020 2a20 7920 2020 2020 2020        * y       
-00032070: 2028 7929 203c 5531 2027 6127 2027 6327   (y) <U1 'a' 'c'
-00032080: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
-00032090: 6f6e 7320 7769 7468 6f75 7420 636f 6f72  ons without coor
-000320a0: 6469 6e61 7465 733a 2078 0a20 2020 2020  dinates: x.     
-000320b0: 2020 2044 6174 6120 7661 7269 6162 6c65     Data variable
-000320c0: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
-000320d0: 2020 2020 2020 2020 2878 2c20 7929 2069          (x, y) i
-000320e0: 6e74 3634 2030 2032 2033 2035 0a20 2020  nt64 0 2 3 5.   
-000320f0: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
-00032100: 2020 696e 6465 7865 7273 203d 2065 6974    indexers = eit
-00032110: 6865 725f 6469 6374 5f6f 725f 6b77 6172  her_dict_or_kwar
-00032120: 6773 2869 6e64 6578 6572 732c 2069 6e64  gs(indexers, ind
-00032130: 6578 6572 735f 6b77 6172 6773 2c20 2264  exers_kwargs, "d
-00032140: 726f 705f 6973 656c 2229 0a0a 2020 2020  rop_isel")..    
-00032150: 2020 2020 6473 203d 2073 656c 660a 2020      ds = self.  
-00032160: 2020 2020 2020 6469 6d65 6e73 696f 6e5f        dimension_
-00032170: 696e 6465 7820 3d20 7b7d 0a20 2020 2020  index = {}.     
-00032180: 2020 2066 6f72 2064 696d 2c20 706f 735f     for dim, pos_
-00032190: 666f 725f 6469 6d20 696e 2069 6e64 6578  for_dim in index
-000321a0: 6572 732e 6974 656d 7328 293a 0a20 2020  ers.items():.   
-000321b0: 2020 2020 2020 2020 2023 2044 6f6e 2774           # Don't
-000321c0: 2063 6173 7420 746f 2073 6574 2c20 6173   cast to set, as
-000321d0: 2069 7420 776f 756c 6420 6861 726d 2070   it would harm p
-000321e0: 6572 666f 726d 616e 6365 2077 6865 6e20  erformance when 
-000321f0: 6c61 6265 6c73 0a20 2020 2020 2020 2020  labels.         
-00032200: 2020 2023 2069 7320 6120 6c61 7267 6520     # is a large 
-00032210: 6e75 6d70 7920 6172 7261 790a 2020 2020  numpy array.    
-00032220: 2020 2020 2020 2020 6966 2075 7469 6c73          if utils
-00032230: 2e69 735f 7363 616c 6172 2870 6f73 5f66  .is_scalar(pos_f
-00032240: 6f72 5f64 696d 293a 0a20 2020 2020 2020  or_dim):.       
-00032250: 2020 2020 2020 2020 2070 6f73 5f66 6f72           pos_for
-00032260: 5f64 696d 203d 205b 706f 735f 666f 725f  _dim = [pos_for_
-00032270: 6469 6d5d 0a20 2020 2020 2020 2020 2020  dim].           
-00032280: 2070 6f73 5f66 6f72 5f64 696d 203d 206e   pos_for_dim = n
-00032290: 702e 6173 6172 7261 7928 706f 735f 666f  p.asarray(pos_fo
-000322a0: 725f 6469 6d29 0a20 2020 2020 2020 2020  r_dim).         
-000322b0: 2020 2069 6e64 6578 203d 2073 656c 662e     index = self.
-000322c0: 6765 745f 696e 6465 7828 6469 6d29 0a20  get_index(dim). 
-000322d0: 2020 2020 2020 2020 2020 206e 6577 5f69             new_i
-000322e0: 6e64 6578 203d 2069 6e64 6578 2e64 656c  ndex = index.del
-000322f0: 6574 6528 706f 735f 666f 725f 6469 6d29  ete(pos_for_dim)
-00032300: 0a20 2020 2020 2020 2020 2020 2064 696d  .            dim
-00032310: 656e 7369 6f6e 5f69 6e64 6578 5b64 696d  ension_index[dim
-00032320: 5d20 3d20 6e65 775f 696e 6465 780a 2020  ] = new_index.  
-00032330: 2020 2020 2020 6473 203d 2064 732e 6c6f        ds = ds.lo
-00032340: 635b 6469 6d65 6e73 696f 6e5f 696e 6465  c[dimension_inde
-00032350: 785d 0a20 2020 2020 2020 2072 6574 7572  x].        retur
-00032360: 6e20 6473 0a0a 2020 2020 6465 6620 6472  n ds..    def dr
-00032370: 6f70 5f64 696d 7328 0a20 2020 2020 2020  op_dims(.       
-00032380: 2073 656c 663a 2054 5f44 6174 6173 6574   self: T_Dataset
-00032390: 2c0a 2020 2020 2020 2020 6472 6f70 5f64  ,.        drop_d
-000323a0: 696d 733a 2073 7472 207c 2049 7465 7261  ims: str | Itera
-000323b0: 626c 655b 4861 7368 6162 6c65 5d2c 0a20  ble[Hashable],. 
-000323c0: 2020 2020 2020 202a 2c0a 2020 2020 2020         *,.      
-000323d0: 2020 6572 726f 7273 3a20 4572 726f 724f    errors: ErrorO
-000323e0: 7074 696f 6e73 203d 2022 7261 6973 6522  ptions = "raise"
-000323f0: 2c0a 2020 2020 2920 2d3e 2054 5f44 6174  ,.    ) -> T_Dat
-00032400: 6173 6574 3a0a 2020 2020 2020 2020 2222  aset:.        ""
-00032410: 2244 726f 7020 6469 6d65 6e73 696f 6e73  "Drop dimensions
-00032420: 2061 6e64 2061 7373 6f63 6961 7465 6420   and associated 
-00032430: 7661 7269 6162 6c65 7320 6672 6f6d 2074  variables from t
-00032440: 6869 7320 6461 7461 7365 742e 0a0a 2020  his dataset...  
-00032450: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00032460: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00032470: 2d2d 2d0a 2020 2020 2020 2020 6472 6f70  ---.        drop
-00032480: 5f64 696d 7320 3a20 7374 7220 6f72 2049  _dims : str or I
-00032490: 7465 7261 626c 6520 6f66 2048 6173 6861  terable of Hasha
-000324a0: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
-000324b0: 4469 6d65 6e73 696f 6e20 6f72 2064 696d  Dimension or dim
-000324c0: 656e 7369 6f6e 7320 746f 2064 726f 702e  ensions to drop.
-000324d0: 0a20 2020 2020 2020 2065 7272 6f72 7320  .        errors 
-000324e0: 3a20 7b22 7261 6973 6522 2c20 2269 676e  : {"raise", "ign
-000324f0: 6f72 6522 7d2c 2064 6566 6175 6c74 3a20  ore"}, default: 
-00032500: 2272 6169 7365 220a 2020 2020 2020 2020  "raise".        
-00032510: 2020 2020 4966 2027 7261 6973 6527 2c20      If 'raise', 
-00032520: 7261 6973 6573 2061 2056 616c 7565 4572  raises a ValueEr
-00032530: 726f 7220 6572 726f 7220 6966 2061 6e79  ror error if any
-00032540: 206f 6620 7468 650a 2020 2020 2020 2020   of the.        
-00032550: 2020 2020 6469 6d65 6e73 696f 6e73 2070      dimensions p
-00032560: 6173 7365 6420 6172 6520 6e6f 7420 696e  assed are not in
-00032570: 2074 6865 2064 6174 6173 6574 2e20 4966   the dataset. If
-00032580: 2027 6967 6e6f 7265 272c 2061 6e79 2067   'ignore', any g
-00032590: 6976 656e 0a20 2020 2020 2020 2020 2020  iven.           
-000325a0: 2064 696d 656e 7369 6f6e 7320 7468 6174   dimensions that
-000325b0: 2061 7265 2069 6e20 7468 6520 6461 7461   are in the data
-000325c0: 7365 7420 6172 6520 6472 6f70 7065 6420  set are dropped 
-000325d0: 616e 6420 6e6f 2065 7272 6f72 2069 7320  and no error is 
-000325e0: 7261 6973 6564 2e0a 0a20 2020 2020 2020  raised...       
-000325f0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-00032600: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-00032610: 206f 626a 203a 2044 6174 6173 6574 0a20   obj : Dataset. 
-00032620: 2020 2020 2020 2020 2020 2054 6865 2064             The d
-00032630: 6174 6173 6574 2077 6974 686f 7574 2074  ataset without t
-00032640: 6865 2067 6976 656e 2064 696d 656e 7369  he given dimensi
-00032650: 6f6e 7320 286f 7220 616e 7920 7661 7269  ons (or any vari
-00032660: 6162 6c65 730a 2020 2020 2020 2020 2020  ables.          
-00032670: 2020 636f 6e74 6169 6e69 6e67 2074 686f    containing tho
-00032680: 7365 2064 696d 656e 7369 6f6e 7329 2e0a  se dimensions)..
-00032690: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000326a0: 2020 2020 6966 2065 7272 6f72 7320 6e6f      if errors no
-000326b0: 7420 696e 205b 2272 6169 7365 222c 2022  t in ["raise", "
-000326c0: 6967 6e6f 7265 225d 3a0a 2020 2020 2020  ignore"]:.      
-000326d0: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-000326e0: 6545 7272 6f72 2827 6572 726f 7273 206d  eError('errors m
-000326f0: 7573 7420 6265 2065 6974 6865 7220 2272  ust be either "r
-00032700: 6169 7365 2220 6f72 2022 6967 6e6f 7265  aise" or "ignore
-00032710: 2227 290a 0a20 2020 2020 2020 2069 6620  "')..        if 
-00032720: 6973 696e 7374 616e 6365 2864 726f 705f  isinstance(drop_
-00032730: 6469 6d73 2c20 7374 7229 206f 7220 6e6f  dims, str) or no
-00032740: 7420 6973 696e 7374 616e 6365 2864 726f  t isinstance(dro
-00032750: 705f 6469 6d73 2c20 4974 6572 6162 6c65  p_dims, Iterable
-00032760: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00032770: 726f 705f 6469 6d73 203d 207b 6472 6f70  rop_dims = {drop
-00032780: 5f64 696d 737d 0a20 2020 2020 2020 2065  _dims}.        e
-00032790: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000327a0: 2064 726f 705f 6469 6d73 203d 2073 6574   drop_dims = set
-000327b0: 2864 726f 705f 6469 6d73 290a 0a20 2020  (drop_dims)..   
-000327c0: 2020 2020 2069 6620 6572 726f 7273 203d       if errors =
-000327d0: 3d20 2272 6169 7365 223a 0a20 2020 2020  = "raise":.     
-000327e0: 2020 2020 2020 206d 6973 7369 6e67 5f64         missing_d
-000327f0: 696d 7320 3d20 6472 6f70 5f64 696d 7320  ims = drop_dims 
-00032800: 2d20 7365 7428 7365 6c66 2e64 696d 7329  - set(self.dims)
-00032810: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00032820: 6d69 7373 696e 675f 6469 6d73 3a0a 2020  missing_dims:.  
-00032830: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00032840: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00032850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00032860: 2020 2020 6622 4461 7461 7365 7420 646f      f"Dataset do
-00032870: 6573 206e 6f74 2063 6f6e 7461 696e 2074  es not contain t
-00032880: 6865 2064 696d 656e 7369 6f6e 733a 207b  he dimensions: {
-00032890: 6d69 7373 696e 675f 6469 6d73 7d22 0a20  missing_dims}". 
-000328a0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000328b0: 0a0a 2020 2020 2020 2020 6472 6f70 5f76  ..        drop_v
-000328c0: 6172 7320 3d20 7b6b 2066 6f72 206b 2c20  ars = {k for k, 
-000328d0: 7620 696e 2073 656c 662e 5f76 6172 6961  v in self._varia
-000328e0: 626c 6573 2e69 7465 6d73 2829 2069 6620  bles.items() if 
-000328f0: 7365 7428 762e 6469 6d73 2920 2620 6472  set(v.dims) & dr
-00032900: 6f70 5f64 696d 737d 0a20 2020 2020 2020  op_dims}.       
-00032910: 2072 6574 7572 6e20 7365 6c66 2e64 726f   return self.dro
-00032920: 705f 7661 7273 2864 726f 705f 7661 7273  p_vars(drop_vars
-00032930: 290a 0a20 2020 2064 6566 2074 7261 6e73  )..    def trans
-00032940: 706f 7365 280a 2020 2020 2020 2020 7365  pose(.        se
-00032950: 6c66 3a20 545f 4461 7461 7365 742c 0a20  lf: T_Dataset,. 
-00032960: 2020 2020 2020 202a 6469 6d73 3a20 4861         *dims: Ha
-00032970: 7368 6162 6c65 2c0a 2020 2020 2020 2020  shable,.        
-00032980: 6d69 7373 696e 675f 6469 6d73 3a20 4572  missing_dims: Er
-00032990: 726f 724f 7074 696f 6e73 5769 7468 5761  rorOptionsWithWa
-000329a0: 726e 203d 2022 7261 6973 6522 2c0a 2020  rn = "raise",.  
-000329b0: 2020 2920 2d3e 2054 5f44 6174 6173 6574    ) -> T_Dataset
-000329c0: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-000329d0: 7572 6e20 6120 6e65 7720 4461 7461 7365  urn a new Datase
-000329e0: 7420 6f62 6a65 6374 2077 6974 6820 616c  t object with al
-000329f0: 6c20 6172 7261 7920 6469 6d65 6e73 696f  l array dimensio
-00032a00: 6e73 2074 7261 6e73 706f 7365 642e 0a0a  ns transposed...
-00032a10: 2020 2020 2020 2020 416c 7468 6f75 6768          Although
-00032a20: 2074 6865 206f 7264 6572 206f 6620 6469   the order of di
-00032a30: 6d65 6e73 696f 6e73 206f 6e20 6561 6368  mensions on each
-00032a40: 2061 7272 6179 2077 696c 6c20 6368 616e   array will chan
-00032a50: 6765 2c20 7468 6520 6461 7461 7365 740a  ge, the dataset.
-00032a60: 2020 2020 2020 2020 6469 6d65 6e73 696f          dimensio
-00032a70: 6e73 2074 6865 6d73 656c 7665 7320 7769  ns themselves wi
-00032a80: 6c6c 2072 656d 6169 6e20 696e 2066 6978  ll remain in fix
-00032a90: 6564 2028 736f 7274 6564 2920 6f72 6465  ed (sorted) orde
-00032aa0: 722e 0a0a 2020 2020 2020 2020 5061 7261  r...        Para
-00032ab0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00032ac0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00032ad0: 2020 2a64 696d 7320 3a20 6861 7368 6162    *dims : hashab
-00032ae0: 6c65 2c20 6f70 7469 6f6e 616c 0a20 2020  le, optional.   
-00032af0: 2020 2020 2020 2020 2042 7920 6465 6661           By defa
-00032b00: 756c 742c 2072 6576 6572 7365 2074 6865  ult, reverse the
-00032b10: 2064 696d 656e 7369 6f6e 7320 6f6e 2065   dimensions on e
-00032b20: 6163 6820 6172 7261 792e 204f 7468 6572  ach array. Other
-00032b30: 7769 7365 2c0a 2020 2020 2020 2020 2020  wise,.          
-00032b40: 2020 7265 6f72 6465 7220 7468 6520 6469    reorder the di
-00032b50: 6d65 6e73 696f 6e73 2074 6f20 7468 6973  mensions to this
-00032b60: 206f 7264 6572 2e0a 2020 2020 2020 2020   order..        
-00032b70: 6d69 7373 696e 675f 6469 6d73 203a 207b  missing_dims : {
-00032b80: 2272 6169 7365 222c 2022 7761 726e 222c  "raise", "warn",
-00032b90: 2022 6967 6e6f 7265 227d 2c20 6465 6661   "ignore"}, defa
-00032ba0: 756c 743a 2022 7261 6973 6522 0a20 2020  ult: "raise".   
-00032bb0: 2020 2020 2020 2020 2057 6861 7420 746f           What to
-00032bc0: 2064 6f20 6966 2064 696d 656e 7369 6f6e   do if dimension
-00032bd0: 7320 7468 6174 2073 686f 756c 6420 6265  s that should be
-00032be0: 2073 656c 6563 7465 6420 6672 6f6d 2061   selected from a
-00032bf0: 7265 206e 6f74 2070 7265 7365 6e74 2069  re not present i
-00032c00: 6e20 7468 650a 2020 2020 2020 2020 2020  n the.          
-00032c10: 2020 4461 7461 7365 743a 0a20 2020 2020    Dataset:.     
-00032c20: 2020 2020 2020 202d 2022 7261 6973 6522         - "raise"
-00032c30: 3a20 7261 6973 6520 616e 2065 7863 6570  : raise an excep
-00032c40: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-00032c50: 202d 2022 7761 726e 223a 2072 6169 7365   - "warn": raise
-00032c60: 2061 2077 6172 6e69 6e67 2c20 616e 6420   a warning, and 
-00032c70: 6967 6e6f 7265 2074 6865 206d 6973 7369  ignore the missi
-00032c80: 6e67 2064 696d 656e 7369 6f6e 730a 2020  ng dimensions.  
-00032c90: 2020 2020 2020 2020 2020 2d20 2269 676e            - "ign
-00032ca0: 6f72 6522 3a20 6967 6e6f 7265 2074 6865  ore": ignore the
-00032cb0: 206d 6973 7369 6e67 2064 696d 656e 7369   missing dimensi
-00032cc0: 6f6e 730a 0a20 2020 2020 2020 2052 6574  ons..        Ret
-00032cd0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-00032ce0: 2d2d 2d2d 0a20 2020 2020 2020 2074 7261  ----.        tra
-00032cf0: 6e73 706f 7365 6420 3a20 4461 7461 7365  nsposed : Datase
-00032d00: 740a 2020 2020 2020 2020 2020 2020 4561  t.            Ea
-00032d10: 6368 2061 7272 6179 2069 6e20 7468 6520  ch array in the 
-00032d20: 6461 7461 7365 7420 2869 6e63 6c75 6469  dataset (includi
-00032d30: 6e67 2920 636f 6f72 6469 6e61 7465 7320  ng) coordinates 
-00032d40: 7769 6c6c 2062 650a 2020 2020 2020 2020  will be.        
-00032d50: 2020 2020 7472 616e 7370 6f73 6564 2074      transposed t
-00032d60: 6f20 7468 6520 6769 7665 6e20 6f72 6465  o the given orde
-00032d70: 722e 0a0a 2020 2020 2020 2020 4e6f 7465  r...        Note
-00032d80: 730a 2020 2020 2020 2020 2d2d 2d2d 2d0a  s.        -----.
-00032d90: 2020 2020 2020 2020 5468 6973 206f 7065          This ope
-00032da0: 7261 7469 6f6e 2072 6574 7572 6e73 2061  ration returns a
-00032db0: 2076 6965 7720 6f66 2065 6163 6820 6172   view of each ar
-00032dc0: 7261 7927 7320 6461 7461 2e20 4974 2069  ray's data. It i
-00032dd0: 730a 2020 2020 2020 2020 6c61 7a79 2066  s.        lazy f
-00032de0: 6f72 2064 6173 6b2d 6261 636b 6564 2044  or dask-backed D
-00032df0: 6174 6141 7272 6179 7320 6275 7420 6e6f  ataArrays but no
-00032e00: 7420 666f 7220 6e75 6d70 792d 6261 636b  t for numpy-back
-00032e10: 6564 2044 6174 6141 7272 6179 730a 2020  ed DataArrays.  
-00032e20: 2020 2020 2020 2d2d 2074 6865 2064 6174        -- the dat
-00032e30: 6120 7769 6c6c 2062 6520 6675 6c6c 7920  a will be fully 
-00032e40: 6c6f 6164 6564 2069 6e74 6f20 6d65 6d6f  loaded into memo
-00032e50: 7279 2e0a 0a20 2020 2020 2020 2053 6565  ry...        See
-00032e60: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00032e70: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
-00032e80: 756d 7079 2e74 7261 6e73 706f 7365 0a20  umpy.transpose. 
-00032e90: 2020 2020 2020 2044 6174 6141 7272 6179         DataArray
-00032ea0: 2e74 7261 6e73 706f 7365 0a20 2020 2020  .transpose.     
-00032eb0: 2020 2022 2222 0a20 2020 2020 2020 2023     """.        #
-00032ec0: 2052 6169 7365 2065 7272 6f72 2069 6620   Raise error if 
-00032ed0: 6c69 7374 2069 7320 7061 7373 6564 2061  list is passed a
-00032ee0: 7320 6469 6d73 0a20 2020 2020 2020 2069  s dims.        i
-00032ef0: 6620 286c 656e 2864 696d 7329 203e 2030  f (len(dims) > 0
-00032f00: 2920 616e 6420 2869 7369 6e73 7461 6e63  ) and (isinstanc
-00032f10: 6528 6469 6d73 5b30 5d2c 206c 6973 7429  e(dims[0], list)
-00032f20: 293a 0a20 2020 2020 2020 2020 2020 206c  ):.            l
-00032f30: 6973 745f 6669 7820 3d20 5b66 227b 7265  ist_fix = [f"{re
-00032f40: 7072 2878 297d 2220 6966 2069 7369 6e73  pr(x)}" if isins
-00032f50: 7461 6e63 6528 782c 2073 7472 2920 656c  tance(x, str) el
-00032f60: 7365 2066 227b 787d 2220 666f 7220 7820  se f"{x}" for x 
-00032f70: 696e 2064 696d 735b 305d 5d0a 2020 2020  in dims[0]].    
-00032f80: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00032f90: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
-00032fa0: 2020 2020 2020 2020 2066 2774 7261 6e73           f'trans
-00032fb0: 706f 7365 2072 6571 7569 7265 7320 6469  pose requires di
-00032fc0: 6d73 2074 6f20 6265 2070 6173 7365 6420  ms to be passed 
-00032fd0: 6173 206d 756c 7469 706c 6520 6172 6775  as multiple argu
-00032fe0: 6d65 6e74 732e 2045 7870 6563 7465 6420  ments. Expected 
-00032ff0: 607b 222c 2022 2e6a 6f69 6e28 6c69 7374  `{", ".join(list
-00033000: 5f66 6978 297d 602e 2052 6563 6569 7665  _fix)}`. Receive
-00033010: 6420 607b 6469 6d73 5b30 5d7d 6020 696e  d `{dims[0]}` in
-00033020: 7374 6561 6427 0a20 2020 2020 2020 2020  stead'.         
-00033030: 2020 2029 0a0a 2020 2020 2020 2020 2320     )..        # 
-00033040: 5573 6520 696e 6669 785f 6469 6d73 2074  Use infix_dims t
-00033050: 6f20 6368 6563 6b20 6f6e 6365 2066 6f72  o check once for
-00033060: 206d 6973 7369 6e67 2064 696d 656e 7369   missing dimensi
-00033070: 6f6e 730a 2020 2020 2020 2020 6966 206c  ons.        if l
-00033080: 656e 2864 696d 7329 2021 3d20 303a 0a20  en(dims) != 0:. 
-00033090: 2020 2020 2020 2020 2020 205f 203d 206c             _ = l
-000330a0: 6973 7428 696e 6669 785f 6469 6d73 2864  ist(infix_dims(d
-000330b0: 696d 732c 2073 656c 662e 6469 6d73 2c20  ims, self.dims, 
-000330c0: 6d69 7373 696e 675f 6469 6d73 2929 0a0a  missing_dims))..
-000330d0: 2020 2020 2020 2020 6473 203d 2073 656c          ds = sel
-000330e0: 662e 636f 7079 2829 0a20 2020 2020 2020  f.copy().       
-000330f0: 2066 6f72 206e 616d 652c 2076 6172 2069   for name, var i
-00033100: 6e20 7365 6c66 2e5f 7661 7269 6162 6c65  n self._variable
-00033110: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-00033120: 2020 2020 2020 2076 6172 5f64 696d 7320         var_dims 
-00033130: 3d20 7475 706c 6528 6469 6d20 666f 7220  = tuple(dim for 
-00033140: 6469 6d20 696e 2064 696d 7320 6966 2064  dim in dims if d
-00033150: 696d 2069 6e20 2876 6172 2e64 696d 7320  im in (var.dims 
-00033160: 2b20 282e 2e2e 2c29 2929 0a20 2020 2020  + (...,))).     
-00033170: 2020 2020 2020 2064 732e 5f76 6172 6961         ds._varia
-00033180: 626c 6573 5b6e 616d 655d 203d 2076 6172  bles[name] = var
-00033190: 2e74 7261 6e73 706f 7365 282a 7661 725f  .transpose(*var_
-000331a0: 6469 6d73 290a 2020 2020 2020 2020 7265  dims).        re
-000331b0: 7475 726e 2064 730a 0a20 2020 2064 6566  turn ds..    def
-000331c0: 2064 726f 706e 6128 0a20 2020 2020 2020   dropna(.       
-000331d0: 2073 656c 663a 2054 5f44 6174 6173 6574   self: T_Dataset
-000331e0: 2c0a 2020 2020 2020 2020 6469 6d3a 2048  ,.        dim: H
-000331f0: 6173 6861 626c 652c 0a20 2020 2020 2020  ashable,.       
-00033200: 2068 6f77 3a20 4c69 7465 7261 6c5b 2261   how: Literal["a
-00033210: 6e79 222c 2022 616c 6c22 5d20 3d20 2261  ny", "all"] = "a
-00033220: 6e79 222c 0a20 2020 2020 2020 2074 6872  ny",.        thr
-00033230: 6573 683a 2069 6e74 207c 204e 6f6e 6520  esh: int | None 
-00033240: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00033250: 7375 6273 6574 3a20 4974 6572 6162 6c65  subset: Iterable
-00033260: 5b48 6173 6861 626c 655d 207c 204e 6f6e  [Hashable] | Non
-00033270: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2920  e = None,.    ) 
-00033280: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-00033290: 2020 2020 2020 2222 2252 6574 7572 6e73        """Returns
-000332a0: 2061 206e 6577 2064 6174 6173 6574 2077   a new dataset w
-000332b0: 6974 6820 6472 6f70 7065 6420 6c61 6265  ith dropped labe
-000332c0: 6c73 2066 6f72 206d 6973 7369 6e67 2076  ls for missing v
-000332d0: 616c 7565 7320 616c 6f6e 670a 2020 2020  alues along.    
-000332e0: 2020 2020 7468 6520 7072 6f76 6964 6564      the provided
-000332f0: 2064 696d 656e 7369 6f6e 2e0a 0a20 2020   dimension...   
-00033300: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-00033310: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00033320: 2d2d 0a20 2020 2020 2020 2064 696d 203a  --.        dim :
-00033330: 2068 6173 6861 626c 650a 2020 2020 2020   hashable.      
-00033340: 2020 2020 2020 4469 6d65 6e73 696f 6e20        Dimension 
-00033350: 616c 6f6e 6720 7768 6963 6820 746f 2064  along which to d
-00033360: 726f 7020 6d69 7373 696e 6720 7661 6c75  rop missing valu
-00033370: 6573 2e20 4472 6f70 7069 6e67 2061 6c6f  es. Dropping alo
-00033380: 6e67 0a20 2020 2020 2020 2020 2020 206d  ng.            m
-00033390: 756c 7469 706c 6520 6469 6d65 6e73 696f  ultiple dimensio
-000333a0: 6e73 2073 696d 756c 7461 6e65 6f75 736c  ns simultaneousl
-000333b0: 7920 6973 206e 6f74 2079 6574 2073 7570  y is not yet sup
-000333c0: 706f 7274 6564 2e0a 2020 2020 2020 2020  ported..        
-000333d0: 686f 7720 3a20 7b22 616e 7922 2c20 2261  how : {"any", "a
-000333e0: 6c6c 227d 2c20 6465 6661 756c 743a 2022  ll"}, default: "
-000333f0: 616e 7922 0a20 2020 2020 2020 2020 2020  any".           
-00033400: 202d 2061 6e79 203a 2069 6620 616e 7920   - any : if any 
-00033410: 4e41 2076 616c 7565 7320 6172 6520 7072  NA values are pr
-00033420: 6573 656e 742c 2064 726f 7020 7468 6174  esent, drop that
-00033430: 206c 6162 656c 0a20 2020 2020 2020 2020   label.         
-00033440: 2020 202d 2061 6c6c 203a 2069 6620 616c     - all : if al
-00033450: 6c20 7661 6c75 6573 2061 7265 204e 412c  l values are NA,
-00033460: 2064 726f 7020 7468 6174 206c 6162 656c   drop that label
-00033470: 0a0a 2020 2020 2020 2020 7468 7265 7368  ..        thresh
-00033480: 203a 2069 6e74 206f 7220 4e6f 6e65 2c20   : int or None, 
-00033490: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-000334a0: 2020 2020 2049 6620 7375 7070 6c69 6564       If supplied
-000334b0: 2c20 7265 7175 6972 6520 7468 6973 206d  , require this m
-000334c0: 616e 7920 6e6f 6e2d 4e41 2076 616c 7565  any non-NA value
-000334d0: 7320 2873 756d 6d65 6420 6f76 6572 2061  s (summed over a
-000334e0: 6c6c 2074 6865 2073 7562 7365 7420 7661  ll the subset va
-000334f0: 7269 6162 6c65 7329 2e0a 2020 2020 2020  riables)..      
-00033500: 2020 7375 6273 6574 203a 2069 7465 7261    subset : itera
-00033510: 626c 6520 6f66 2068 6173 6861 626c 6520  ble of hashable 
-00033520: 6f72 204e 6f6e 652c 206f 7074 696f 6e61  or None, optiona
-00033530: 6c0a 2020 2020 2020 2020 2020 2020 5768  l.            Wh
-00033540: 6963 6820 7661 7269 6162 6c65 7320 746f  ich variables to
-00033550: 2063 6865 636b 2066 6f72 206d 6973 7369   check for missi
-00033560: 6e67 2076 616c 7565 732e 2042 7920 6465  ng values. By de
-00033570: 6661 756c 742c 2061 6c6c 0a20 2020 2020  fault, all.     
-00033580: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-00033590: 2069 6e20 7468 6520 6461 7461 7365 7420   in the dataset 
-000335a0: 6172 6520 6368 6563 6b65 642e 0a0a 2020  are checked...  
-000335b0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-000335c0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-000335d0: 2020 2020 2020 4461 7461 7365 740a 2020        Dataset.  
-000335e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000335f0: 2020 2320 544f 444f 3a20 636f 6e73 6964    # TODO: consid
-00033600: 6572 2073 7570 706f 7274 696e 6720 6d75  er supporting mu
-00033610: 6c74 6970 6c65 2064 696d 656e 7369 6f6e  ltiple dimension
-00033620: 733f 204f 7220 6e6f 742c 2067 6976 656e  s? Or not, given
-00033630: 2074 6861 740a 2020 2020 2020 2020 2320   that.        # 
-00033640: 7468 6572 6520 6172 6520 736f 6d65 2075  there are some u
-00033650: 676c 7920 6564 6765 2063 6173 6573 2c20  gly edge cases, 
-00033660: 652e 672e 2c20 7061 6e64 6173 2773 2064  e.g., pandas's d
-00033670: 726f 706e 6120 6469 6666 6572 730a 2020  ropna differs.  
-00033680: 2020 2020 2020 2320 6465 7065 6e64 696e        # dependin
-00033690: 6720 6f6e 2074 6865 206f 7264 6572 206f  g on the order o
-000336a0: 6620 7468 6520 7375 7070 6c69 6564 2061  f the supplied a
-000336b0: 7865 732e 0a0a 2020 2020 2020 2020 6966  xes...        if
-000336c0: 2064 696d 206e 6f74 2069 6e20 7365 6c66   dim not in self
-000336d0: 2e64 696d 733a 0a20 2020 2020 2020 2020  .dims:.         
-000336e0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-000336f0: 726f 7228 6622 7b64 696d 7d20 6d75 7374  ror(f"{dim} must
-00033700: 2062 6520 6120 7369 6e67 6c65 2064 6174   be a single dat
-00033710: 6173 6574 2064 696d 656e 7369 6f6e 2229  aset dimension")
-00033720: 0a0a 2020 2020 2020 2020 6966 2073 7562  ..        if sub
-00033730: 7365 7420 6973 204e 6f6e 653a 0a20 2020  set is None:.   
-00033740: 2020 2020 2020 2020 2073 7562 7365 7420           subset 
-00033750: 3d20 6974 6572 2873 656c 662e 6461 7461  = iter(self.data
-00033760: 5f76 6172 7329 0a0a 2020 2020 2020 2020  _vars)..        
-00033770: 636f 756e 7420 3d20 6e70 2e7a 6572 6f73  count = np.zeros
-00033780: 2873 656c 662e 6469 6d73 5b64 696d 5d2c  (self.dims[dim],
-00033790: 2064 7479 7065 3d6e 702e 696e 7436 3429   dtype=np.int64)
-000337a0: 0a20 2020 2020 2020 2073 697a 6520 3d20  .        size = 
-000337b0: 6e70 2e69 6e74 5f28 3029 2020 2320 666f  np.int_(0)  # fo
-000337c0: 7220 7479 7065 2063 6865 636b 696e 670a  r type checking.
-000337d0: 0a20 2020 2020 2020 2066 6f72 206b 2069  .        for k i
-000337e0: 6e20 7375 6273 6574 3a0a 2020 2020 2020  n subset:.      
-000337f0: 2020 2020 2020 6172 7261 7920 3d20 7365        array = se
-00033800: 6c66 2e5f 7661 7269 6162 6c65 735b 6b5d  lf._variables[k]
-00033810: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00033820: 6469 6d20 696e 2061 7272 6179 2e64 696d  dim in array.dim
-00033830: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00033840: 2020 2064 696d 7320 3d20 5b64 2066 6f72     dims = [d for
-00033850: 2064 2069 6e20 6172 7261 792e 6469 6d73   d in array.dims
-00033860: 2069 6620 6420 213d 2064 696d 5d0a 2020   if d != dim].  
-00033870: 2020 2020 2020 2020 2020 2020 2020 636f                co
-00033880: 756e 7420 2b3d 206e 702e 6173 6172 7261  unt += np.asarra
-00033890: 7928 6172 7261 792e 636f 756e 7428 6469  y(array.count(di
-000338a0: 6d73 2929 2020 2320 7479 7065 3a20 6967  ms))  # type: ig
-000338b0: 6e6f 7265 5b61 7474 722d 6465 6669 6e65  nore[attr-define
-000338c0: 645d 0a20 2020 2020 2020 2020 2020 2020  d].             
-000338d0: 2020 2073 697a 6520 2b3d 206d 6174 682e     size += math.
-000338e0: 7072 6f64 285b 7365 6c66 2e64 696d 735b  prod([self.dims[
-000338f0: 645d 2066 6f72 2064 2069 6e20 6469 6d73  d] for d in dims
-00033900: 5d29 0a0a 2020 2020 2020 2020 6966 2074  ])..        if t
-00033910: 6872 6573 6820 6973 206e 6f74 204e 6f6e  hresh is not Non
-00033920: 653a 0a20 2020 2020 2020 2020 2020 206d  e:.            m
-00033930: 6173 6b20 3d20 636f 756e 7420 3e3d 2074  ask = count >= t
-00033940: 6872 6573 680a 2020 2020 2020 2020 656c  hresh.        el
-00033950: 6966 2068 6f77 203d 3d20 2261 6e79 223a  if how == "any":
-00033960: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
-00033970: 6b20 3d20 636f 756e 7420 3d3d 2073 697a  k = count == siz
-00033980: 650a 2020 2020 2020 2020 656c 6966 2068  e.        elif h
-00033990: 6f77 203d 3d20 2261 6c6c 223a 0a20 2020  ow == "all":.   
-000339a0: 2020 2020 2020 2020 206d 6173 6b20 3d20           mask = 
-000339b0: 636f 756e 7420 3e20 300a 2020 2020 2020  count > 0.      
-000339c0: 2020 656c 6966 2068 6f77 2069 7320 6e6f    elif how is no
-000339d0: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-000339e0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-000339f0: 7272 6f72 2866 2269 6e76 616c 6964 2068  rror(f"invalid h
-00033a00: 6f77 206f 7074 696f 6e3a 207b 686f 777d  ow option: {how}
-00033a10: 2229 0a20 2020 2020 2020 2065 6c73 653a  ").        else:
-00033a20: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00033a30: 7365 2054 7970 6545 7272 6f72 2822 6d75  se TypeError("mu
-00033a40: 7374 2073 7065 6369 6679 2068 6f77 206f  st specify how o
-00033a50: 7220 7468 7265 7368 2229 0a0a 2020 2020  r thresh")..    
-00033a60: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00033a70: 6973 656c 287b 6469 6d3a 206d 6173 6b7d  isel({dim: mask}
-00033a80: 290a 0a20 2020 2064 6566 2066 696c 6c6e  )..    def filln
-00033a90: 6128 7365 6c66 3a20 545f 4461 7461 7365  a(self: T_Datase
-00033aa0: 742c 2076 616c 7565 3a20 416e 7929 202d  t, value: Any) -
-00033ab0: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
-00033ac0: 2020 2020 2022 2222 4669 6c6c 206d 6973       """Fill mis
-00033ad0: 7369 6e67 2076 616c 7565 7320 696e 2074  sing values in t
-00033ae0: 6869 7320 6f62 6a65 6374 2e0a 0a20 2020  his object...   
-00033af0: 2020 2020 2054 6869 7320 6f70 6572 6174       This operat
-00033b00: 696f 6e20 666f 6c6c 6f77 7320 7468 6520  ion follows the 
-00033b10: 6e6f 726d 616c 2062 726f 6164 6361 7374  normal broadcast
-00033b20: 696e 6720 616e 6420 616c 6967 6e6d 656e  ing and alignmen
-00033b30: 7420 7275 6c65 7320 7468 6174 0a20 2020  t rules that.   
-00033b40: 2020 2020 2078 6172 7261 7920 7573 6573       xarray uses
-00033b50: 2066 6f72 2062 696e 6172 7920 6172 6974   for binary arit
-00033b60: 686d 6574 6963 2c20 6578 6365 7074 2074  hmetic, except t
-00033b70: 6865 2072 6573 756c 7420 6973 2061 6c69  he result is ali
-00033b80: 676e 6564 2074 6f20 7468 6973 0a20 2020  gned to this.   
-00033b90: 2020 2020 206f 626a 6563 7420 2860 606a       object (``j
-00033ba0: 6f69 6e3d 276c 6566 7427 6060 2920 696e  oin='left'``) in
-00033bb0: 7374 6561 6420 6f66 2061 6c69 676e 6564  stead of aligned
-00033bc0: 2074 6f20 7468 6520 696e 7465 7273 6563   to the intersec
-00033bd0: 7469 6f6e 206f 660a 2020 2020 2020 2020  tion of.        
-00033be0: 696e 6465 7820 636f 6f72 6469 6e61 7465  index coordinate
-00033bf0: 7320 2860 606a 6f69 6e3d 2769 6e6e 6572  s (``join='inner
-00033c00: 2760 6029 2e0a 0a20 2020 2020 2020 2050  '``)...        P
-00033c10: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00033c20: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00033c30: 2020 2020 2076 616c 7565 203a 2073 6361       value : sca
-00033c40: 6c61 722c 206e 6461 7272 6179 2c20 4461  lar, ndarray, Da
-00033c50: 7461 4172 7261 792c 2064 6963 7420 6f72  taArray, dict or
-00033c60: 2044 6174 6173 6574 0a20 2020 2020 2020   Dataset.       
-00033c70: 2020 2020 2055 7365 6420 746f 2066 696c       Used to fil
-00033c80: 6c20 616c 6c20 6d61 7463 6869 6e67 206d  l all matching m
-00033c90: 6973 7369 6e67 2076 616c 7565 7320 696e  issing values in
-00033ca0: 2074 6869 7320 6461 7461 7365 7427 7320   this dataset's 
-00033cb0: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
-00033cc0: 2076 6172 6961 626c 6573 2e20 5363 616c   variables. Scal
-00033cd0: 6172 732c 206e 6461 7272 6179 7320 6f72  ars, ndarrays or
-00033ce0: 2044 6174 6141 7272 6179 7320 6172 6775   DataArrays argu
-00033cf0: 6d65 6e74 7320 6172 6520 7573 6564 2074  ments are used t
-00033d00: 6f0a 2020 2020 2020 2020 2020 2020 6669  o.            fi
-00033d10: 6c6c 2061 6c6c 2064 6174 6120 7769 7468  ll all data with
-00033d20: 2061 6c69 676e 6564 2063 6f6f 7264 696e   aligned coordin
-00033d30: 6174 6573 2028 666f 7220 4461 7461 4172  ates (for DataAr
-00033d40: 7261 7973 292e 0a20 2020 2020 2020 2020  rays)..         
-00033d50: 2020 2044 6963 7469 6f6e 6172 6965 7320     Dictionaries 
-00033d60: 6f72 2064 6174 6173 6574 7320 6d61 7463  or datasets matc
-00033d70: 6820 6461 7461 2076 6172 6961 626c 6573  h data variables
-00033d80: 2061 6e64 2074 6865 6e20 616c 6967 6e0a   and then align.
-00033d90: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
-00033da0: 6469 6e61 7465 7320 6966 206e 6563 6573  dinates if neces
-00033db0: 7361 7279 2e0a 0a20 2020 2020 2020 2052  sary...        R
-00033dc0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-00033dd0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-00033de0: 6174 6173 6574 0a0a 2020 2020 2020 2020  ataset..        
-00033df0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
-00033e00: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00033e10: 2020 3e3e 3e20 6473 203d 2078 722e 4461    >>> ds = xr.Da
-00033e20: 7461 7365 7428 0a20 2020 2020 2020 202e  taset(.        .
-00033e30: 2e2e 2020 2020 207b 0a20 2020 2020 2020  ..     {.       
-00033e40: 202e 2e2e 2020 2020 2020 2020 2022 4122   ...         "A"
-00033e50: 3a20 2822 7822 2c20 5b6e 702e 6e61 6e2c  : ("x", [np.nan,
-00033e60: 2032 2c20 6e70 2e6e 616e 2c20 305d 292c   2, np.nan, 0]),
-00033e70: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00033e80: 2020 2020 2022 4222 3a20 2822 7822 2c20       "B": ("x", 
-00033e90: 5b33 2c20 342c 206e 702e 6e61 6e2c 2031  [3, 4, np.nan, 1
-00033ea0: 5d29 2c0a 2020 2020 2020 2020 2e2e 2e20  ]),.        ... 
-00033eb0: 2020 2020 2020 2020 2243 223a 2028 2278          "C": ("x
-00033ec0: 222c 205b 6e70 2e6e 616e 2c20 6e70 2e6e  ", [np.nan, np.n
-00033ed0: 616e 2c20 6e70 2e6e 616e 2c20 355d 292c  an, np.nan, 5]),
-00033ee0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-00033ef0: 2020 2020 2022 4422 3a20 2822 7822 2c20       "D": ("x", 
-00033f00: 5b6e 702e 6e61 6e2c 2033 2c20 6e70 2e6e  [np.nan, 3, np.n
-00033f10: 616e 2c20 345d 292c 0a20 2020 2020 2020  an, 4]),.       
-00033f20: 202e 2e2e 2020 2020 207d 2c0a 2020 2020   ...     },.    
-00033f30: 2020 2020 2e2e 2e20 2020 2020 636f 6f72      ...     coor
-00033f40: 6473 3d7b 2278 223a 205b 302c 2031 2c20  ds={"x": [0, 1, 
-00033f50: 322c 2033 5d7d 2c0a 2020 2020 2020 2020  2, 3]},.        
-00033f60: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
-00033f70: 3e20 6473 0a20 2020 2020 2020 203c 7861  > ds.        <xa
-00033f80: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
-00033f90: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
-00033fa0: 3a20 2028 783a 2034 290a 2020 2020 2020  :  (x: 4).      
-00033fb0: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
-00033fc0: 2020 2020 2020 2020 202a 2078 2020 2020           * x    
-00033fd0: 2020 2020 2878 2920 696e 7436 3420 3020      (x) int64 0 
-00033fe0: 3120 3220 330a 2020 2020 2020 2020 4461  1 2 3.        Da
-00033ff0: 7461 2076 6172 6961 626c 6573 3a0a 2020  ta variables:.  
-00034000: 2020 2020 2020 2020 2020 4120 2020 2020            A     
-00034010: 2020 2028 7829 2066 6c6f 6174 3634 206e     (x) float64 n
-00034020: 616e 2032 2e30 206e 616e 2030 2e30 0a20  an 2.0 nan 0.0. 
-00034030: 2020 2020 2020 2020 2020 2042 2020 2020             B    
-00034040: 2020 2020 2878 2920 666c 6f61 7436 3420      (x) float64 
-00034050: 332e 3020 342e 3020 6e61 6e20 312e 300a  3.0 4.0 nan 1.0.
-00034060: 2020 2020 2020 2020 2020 2020 4320 2020              C   
-00034070: 2020 2020 2028 7829 2066 6c6f 6174 3634       (x) float64
-00034080: 206e 616e 206e 616e 206e 616e 2035 2e30   nan nan nan 5.0
-00034090: 0a20 2020 2020 2020 2020 2020 2044 2020  .            D  
-000340a0: 2020 2020 2020 2878 2920 666c 6f61 7436        (x) float6
-000340b0: 3420 6e61 6e20 332e 3020 6e61 6e20 342e  4 nan 3.0 nan 4.
-000340c0: 300a 0a20 2020 2020 2020 2052 6570 6c61  0..        Repla
-000340d0: 6365 2061 6c6c 2060 4e61 4e60 2076 616c  ce all `NaN` val
-000340e0: 7565 7320 7769 7468 2030 732e 0a0a 2020  ues with 0s...  
-000340f0: 2020 2020 2020 3e3e 3e20 6473 2e66 696c        >>> ds.fil
-00034100: 6c6e 6128 3029 0a20 2020 2020 2020 203c  lna(0).        <
-00034110: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
-00034120: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
-00034130: 6e73 3a20 2028 783a 2034 290a 2020 2020  ns:  (x: 4).    
-00034140: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
-00034150: 0a20 2020 2020 2020 2020 202a 2078 2020  .          * x  
-00034160: 2020 2020 2020 2878 2920 696e 7436 3420        (x) int64 
-00034170: 3020 3120 3220 330a 2020 2020 2020 2020  0 1 2 3.        
-00034180: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
-00034190: 2020 2020 2020 2020 2020 2020 4120 2020              A   
-000341a0: 2020 2020 2028 7829 2066 6c6f 6174 3634       (x) float64
-000341b0: 2030 2e30 2032 2e30 2030 2e30 2030 2e30   0.0 2.0 0.0 0.0
-000341c0: 0a20 2020 2020 2020 2020 2020 2042 2020  .            B  
-000341d0: 2020 2020 2020 2878 2920 666c 6f61 7436        (x) float6
-000341e0: 3420 332e 3020 342e 3020 302e 3020 312e  4 3.0 4.0 0.0 1.
-000341f0: 300a 2020 2020 2020 2020 2020 2020 4320  0.            C 
-00034200: 2020 2020 2020 2028 7829 2066 6c6f 6174         (x) float
-00034210: 3634 2030 2e30 2030 2e30 2030 2e30 2035  64 0.0 0.0 0.0 5
-00034220: 2e30 0a20 2020 2020 2020 2020 2020 2044  .0.            D
-00034230: 2020 2020 2020 2020 2878 2920 666c 6f61          (x) floa
-00034240: 7436 3420 302e 3020 332e 3020 302e 3020  t64 0.0 3.0 0.0 
-00034250: 342e 300a 0a20 2020 2020 2020 2052 6570  4.0..        Rep
-00034260: 6c61 6365 2061 6c6c 2060 4e61 4e60 2065  lace all `NaN` e
-00034270: 6c65 6d65 6e74 7320 696e 2063 6f6c 756d  lements in colum
-00034280: 6e20 e280 9841 e280 992c 20e2 8098 42e2  n ...A..., ...B.
-00034290: 8099 2c20 e280 9843 e280 992c 2061 6e64  .., ...C..., and
-000342a0: 20e2 8098 44e2 8099 2c20 7769 7468 2030   ...D..., with 0
-000342b0: 2c20 312c 2032 2c20 616e 6420 3320 7265  , 1, 2, and 3 re
-000342c0: 7370 6563 7469 7665 6c79 2e0a 0a20 2020  spectively...   
-000342d0: 2020 2020 203e 3e3e 2076 616c 7565 7320       >>> values 
-000342e0: 3d20 7b22 4122 3a20 302c 2022 4222 3a20  = {"A": 0, "B": 
-000342f0: 312c 2022 4322 3a20 322c 2022 4422 3a20  1, "C": 2, "D": 
-00034300: 337d 0a20 2020 2020 2020 203e 3e3e 2064  3}.        >>> d
-00034310: 732e 6669 6c6c 6e61 2876 616c 7565 3d76  s.fillna(value=v
-00034320: 616c 7565 7329 0a20 2020 2020 2020 203c  alues).        <
-00034330: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
-00034340: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
-00034350: 6e73 3a20 2028 783a 2034 290a 2020 2020  ns:  (x: 4).    
-00034360: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
-00034370: 0a20 2020 2020 2020 2020 202a 2078 2020  .          * x  
-00034380: 2020 2020 2020 2878 2920 696e 7436 3420        (x) int64 
-00034390: 3020 3120 3220 330a 2020 2020 2020 2020  0 1 2 3.        
-000343a0: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
-000343b0: 2020 2020 2020 2020 2020 2020 4120 2020              A   
-000343c0: 2020 2020 2028 7829 2066 6c6f 6174 3634       (x) float64
-000343d0: 2030 2e30 2032 2e30 2030 2e30 2030 2e30   0.0 2.0 0.0 0.0
-000343e0: 0a20 2020 2020 2020 2020 2020 2042 2020  .            B  
-000343f0: 2020 2020 2020 2878 2920 666c 6f61 7436        (x) float6
-00034400: 3420 332e 3020 342e 3020 312e 3020 312e  4 3.0 4.0 1.0 1.
-00034410: 300a 2020 2020 2020 2020 2020 2020 4320  0.            C 
-00034420: 2020 2020 2020 2028 7829 2066 6c6f 6174         (x) float
-00034430: 3634 2032 2e30 2032 2e30 2032 2e30 2035  64 2.0 2.0 2.0 5
-00034440: 2e30 0a20 2020 2020 2020 2020 2020 2044  .0.            D
-00034450: 2020 2020 2020 2020 2878 2920 666c 6f61          (x) floa
-00034460: 7436 3420 332e 3020 332e 3020 332e 3020  t64 3.0 3.0 3.0 
-00034470: 342e 300a 2020 2020 2020 2020 2222 220a  4.0.        """.
-00034480: 2020 2020 2020 2020 6966 2075 7469 6c73          if utils
-00034490: 2e69 735f 6469 6374 5f6c 696b 6528 7661  .is_dict_like(va
-000344a0: 6c75 6529 3a0a 2020 2020 2020 2020 2020  lue):.          
-000344b0: 2020 7661 6c75 655f 6b65 7973 203d 2067    value_keys = g
-000344c0: 6574 6174 7472 2876 616c 7565 2c20 2264  etattr(value, "d
-000344d0: 6174 615f 7661 7273 222c 2076 616c 7565  ata_vars", value
-000344e0: 292e 6b65 7973 2829 0a20 2020 2020 2020  ).keys().       
-000344f0: 2020 2020 2069 6620 6e6f 7420 7365 7428       if not set(
-00034500: 7661 6c75 655f 6b65 7973 2920 3c3d 2073  value_keys) <= s
-00034510: 6574 2873 656c 662e 6461 7461 5f76 6172  et(self.data_var
-00034520: 732e 6b65 7973 2829 293a 0a20 2020 2020  s.keys()):.     
-00034530: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00034540: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
-00034550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00034560: 2022 616c 6c20 7661 7269 6162 6c65 7320   "all variables 
-00034570: 696e 2074 6865 2061 7267 756d 656e 7420  in the argument 
-00034580: 746f 2060 6669 6c6c 6e61 6020 220a 2020  to `fillna` ".  
-00034590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000345a0: 2020 226d 7573 7420 6265 2063 6f6e 7461    "must be conta
-000345b0: 696e 6564 2069 6e20 7468 6520 6f72 6967  ined in the orig
-000345c0: 696e 616c 2064 6174 6173 6574 220a 2020  inal dataset".  
-000345d0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000345e0: 2020 2020 2020 2020 6f75 7420 3d20 6f70          out = op
-000345f0: 732e 6669 6c6c 6e61 2873 656c 662c 2076  s.fillna(self, v
-00034600: 616c 7565 290a 2020 2020 2020 2020 7265  alue).        re
-00034610: 7475 726e 206f 7574 0a0a 2020 2020 6465  turn out..    de
-00034620: 6620 696e 7465 7270 6f6c 6174 655f 6e61  f interpolate_na
-00034630: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
-00034640: 545f 4461 7461 7365 742c 0a20 2020 2020  T_Dataset,.     
-00034650: 2020 2064 696d 3a20 4861 7368 6162 6c65     dim: Hashable
-00034660: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
-00034670: 2020 2020 2020 2020 6d65 7468 6f64 3a20          method: 
-00034680: 496e 7465 7270 4f70 7469 6f6e 7320 3d20  InterpOptions = 
-00034690: 226c 696e 6561 7222 2c0a 2020 2020 2020  "linear",.      
-000346a0: 2020 6c69 6d69 743a 2069 6e74 207c 204e    limit: int | N
-000346b0: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-000346c0: 2020 2020 7573 655f 636f 6f72 6469 6e61      use_coordina
-000346d0: 7465 3a20 626f 6f6c 207c 2048 6173 6861  te: bool | Hasha
-000346e0: 626c 6520 3d20 5472 7565 2c0a 2020 2020  ble = True,.    
-000346f0: 2020 2020 6d61 785f 6761 703a 2028 0a20      max_gap: (. 
-00034700: 2020 2020 2020 2020 2020 2069 6e74 207c             int |
-00034710: 2066 6c6f 6174 207c 2073 7472 207c 2070   float | str | p
-00034720: 642e 5469 6d65 6465 6c74 6120 7c20 6e70  d.Timedelta | np
-00034730: 2e74 696d 6564 656c 7461 3634 207c 2064  .timedelta64 | d
-00034740: 6174 6574 696d 652e 7469 6d65 6465 6c74  atetime.timedelt
-00034750: 610a 2020 2020 2020 2020 2920 3d20 4e6f  a.        ) = No
-00034760: 6e65 2c0a 2020 2020 2020 2020 2a2a 6b77  ne,.        **kw
-00034770: 6172 6773 3a20 416e 792c 0a20 2020 2029  args: Any,.    )
-00034780: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
-00034790: 2020 2020 2020 2022 2222 4669 6c6c 2069         """Fill i
-000347a0: 6e20 4e61 4e73 2062 7920 696e 7465 7270  n NaNs by interp
-000347b0: 6f6c 6174 696e 6720 6163 636f 7264 696e  olating accordin
-000347c0: 6720 746f 2064 6966 6665 7265 6e74 206d  g to different m
-000347d0: 6574 686f 6473 2e0a 0a20 2020 2020 2020  ethods...       
-000347e0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-000347f0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00034800: 2020 2020 2020 2064 696d 203a 2048 6173         dim : Has
-00034810: 6861 626c 6520 6f72 204e 6f6e 652c 206f  hable or None, o
-00034820: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
-00034830: 2020 2020 5370 6563 6966 6965 7320 7468      Specifies th
-00034840: 6520 6469 6d65 6e73 696f 6e20 616c 6f6e  e dimension alon
-00034850: 6720 7768 6963 6820 746f 2069 6e74 6572  g which to inter
-00034860: 706f 6c61 7465 2e0a 2020 2020 2020 2020  polate..        
-00034870: 6d65 7468 6f64 203a 207b 226c 696e 6561  method : {"linea
-00034880: 7222 2c20 226e 6561 7265 7374 222c 2022  r", "nearest", "
-00034890: 7a65 726f 222c 2022 736c 696e 6561 7222  zero", "slinear"
-000348a0: 2c20 2271 7561 6472 6174 6963 222c 2022  , "quadratic", "
-000348b0: 6375 6269 6322 2c20 2270 6f6c 796e 6f6d  cubic", "polynom
-000348c0: 6961 6c22 2c20 5c0a 2020 2020 2020 2020  ial", \.        
-000348d0: 2020 2020 2262 6172 7963 656e 7472 6963      "barycentric
-000348e0: 222c 2022 6b72 6f67 222c 2022 7063 6869  ", "krog", "pchi
-000348f0: 7022 2c20 2273 706c 696e 6522 2c20 2261  p", "spline", "a
-00034900: 6b69 6d61 227d 2c20 6465 6661 756c 743a  kima"}, default:
-00034910: 2022 6c69 6e65 6172 220a 2020 2020 2020   "linear".      
-00034920: 2020 2020 2020 5374 7269 6e67 2069 6e64        String ind
-00034930: 6963 6174 696e 6720 7768 6963 6820 6d65  icating which me
-00034940: 7468 6f64 2074 6f20 7573 6520 666f 7220  thod to use for 
-00034950: 696e 7465 7270 6f6c 6174 696f 6e3a 0a0a  interpolation:..
-00034960: 2020 2020 2020 2020 2020 2020 2d20 276c              - 'l
-00034970: 696e 6561 7227 3a20 6c69 6e65 6172 2069  inear': linear i
-00034980: 6e74 6572 706f 6c61 7469 6f6e 2e20 4164  nterpolation. Ad
-00034990: 6469 7469 6f6e 616c 206b 6579 776f 7264  ditional keyword
-000349a0: 0a20 2020 2020 2020 2020 2020 2020 2061  .              a
-000349b0: 7267 756d 656e 7473 2061 7265 2070 6173  rguments are pas
-000349c0: 7365 6420 746f 203a 7079 3a66 756e 633a  sed to :py:func:
-000349d0: 606e 756d 7079 2e69 6e74 6572 7060 0a20  `numpy.interp`. 
-000349e0: 2020 2020 2020 2020 2020 202d 2027 6e65             - 'ne
-000349f0: 6172 6573 7427 2c20 277a 6572 6f27 2c20  arest', 'zero', 
-00034a00: 2773 6c69 6e65 6172 272c 2027 7175 6164  'slinear', 'quad
-00034a10: 7261 7469 6327 2c20 2763 7562 6963 272c  ratic', 'cubic',
-00034a20: 2027 706f 6c79 6e6f 6d69 616c 273a 0a20   'polynomial':. 
-00034a30: 2020 2020 2020 2020 2020 2020 2061 7265               are
-00034a40: 2070 6173 7365 6420 746f 203a 7079 3a66   passed to :py:f
-00034a50: 756e 633a 6073 6369 7079 2e69 6e74 6572  unc:`scipy.inter
-00034a60: 706f 6c61 7465 2e69 6e74 6572 7031 6460  polate.interp1d`
-00034a70: 2e20 4966 0a20 2020 2020 2020 2020 2020  . If.           
-00034a80: 2020 2060 606d 6574 686f 643d 2770 6f6c     ``method='pol
-00034a90: 796e 6f6d 6961 6c27 6060 2c20 7468 6520  ynomial'``, the 
-00034aa0: 6060 6f72 6465 7260 6020 6b65 7977 6f72  ``order`` keywor
-00034ab0: 6420 6172 6775 6d65 6e74 206d 7573 7420  d argument must 
-00034ac0: 616c 736f 2062 650a 2020 2020 2020 2020  also be.        
-00034ad0: 2020 2020 2020 7072 6f76 6964 6564 2e0a        provided..
-00034ae0: 2020 2020 2020 2020 2020 2020 2d20 2762              - 'b
-00034af0: 6172 7963 656e 7472 6963 272c 2027 6b72  arycentric', 'kr
-00034b00: 6f67 272c 2027 7063 6869 7027 2c20 2773  og', 'pchip', 's
-00034b10: 706c 696e 6527 2c20 2761 6b69 6d61 273a  pline', 'akima':
-00034b20: 2075 7365 2074 6865 6972 0a20 2020 2020   use their.     
-00034b30: 2020 2020 2020 2020 2072 6573 7065 6374           respect
-00034b40: 6976 6520 3a70 793a 636c 6173 733a 6073  ive :py:class:`s
-00034b50: 6369 7079 2e69 6e74 6572 706f 6c61 7465  cipy.interpolate
-00034b60: 6020 636c 6173 7365 732e 0a0a 2020 2020  ` classes...    
-00034b70: 2020 2020 7573 655f 636f 6f72 6469 6e61      use_coordina
-00034b80: 7465 203a 2062 6f6f 6c20 6f72 2048 6173  te : bool or Has
-00034b90: 6861 626c 652c 2064 6566 6175 6c74 3a20  hable, default: 
-00034ba0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-00034bb0: 2053 7065 6369 6669 6573 2077 6869 6368   Specifies which
-00034bc0: 2069 6e64 6578 2074 6f20 7573 6520 6173   index to use as
-00034bd0: 2074 6865 2078 2076 616c 7565 7320 696e   the x values in
-00034be0: 2074 6865 2069 6e74 6572 706f 6c61 7469   the interpolati
-00034bf0: 6f6e 0a20 2020 2020 2020 2020 2020 2066  on.            f
-00034c00: 6f72 6d75 6c61 7465 6420 6173 2060 7920  ormulated as `y 
-00034c10: 3d20 6628 7829 602e 2049 6620 4661 6c73  = f(x)`. If Fals
-00034c20: 652c 2076 616c 7565 7320 6172 6520 7472  e, values are tr
-00034c30: 6561 7465 6420 6173 2069 660a 2020 2020  eated as if.    
-00034c40: 2020 2020 2020 2020 6571 7561 6c6c 792d          equally-
-00034c50: 7370 6163 6564 2061 6c6f 6e67 2060 6064  spaced along ``d
-00034c60: 696d 6060 2e20 4966 2054 7275 652c 2074  im``. If True, t
-00034c70: 6865 2049 6e64 6578 5661 7269 6162 6c65  he IndexVariable
-00034c80: 2060 6469 6d60 2069 730a 2020 2020 2020   `dim` is.      
-00034c90: 2020 2020 2020 7573 6564 2e20 4966 2060        used. If `
-00034ca0: 6075 7365 5f63 6f6f 7264 696e 6174 6560  `use_coordinate`
-00034cb0: 6020 6973 2061 2073 7472 696e 672c 2069  ` is a string, i
-00034cc0: 7420 7370 6563 6966 6965 7320 7468 6520  t specifies the 
-00034cd0: 6e61 6d65 206f 6620 610a 2020 2020 2020  name of a.      
-00034ce0: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
-00034cf0: 2076 6172 6961 626c 6520 746f 2075 7365   variable to use
-00034d00: 2061 7320 7468 6520 696e 6465 782e 0a20   as the index.. 
-00034d10: 2020 2020 2020 206c 696d 6974 203a 2069         limit : i
-00034d20: 6e74 2c20 6465 6661 756c 743a 204e 6f6e  nt, default: Non
-00034d30: 650a 2020 2020 2020 2020 2020 2020 4d61  e.            Ma
-00034d40: 7869 6d75 6d20 6e75 6d62 6572 206f 6620  ximum number of 
-00034d50: 636f 6e73 6563 7574 6976 6520 4e61 4e73  consecutive NaNs
-00034d60: 2074 6f20 6669 6c6c 2e20 4d75 7374 2062   to fill. Must b
-00034d70: 6520 6772 6561 7465 7220 7468 616e 2030  e greater than 0
-00034d80: 0a20 2020 2020 2020 2020 2020 206f 7220  .            or 
-00034d90: 4e6f 6e65 2066 6f72 206e 6f20 6c69 6d69  None for no limi
-00034da0: 742e 2054 6869 7320 6669 6c6c 696e 6720  t. This filling 
-00034db0: 6973 2064 6f6e 6520 7265 6761 7264 6c65  is done regardle
-00034dc0: 7373 206f 6620 7468 6520 7369 7a65 206f  ss of the size o
-00034dd0: 660a 2020 2020 2020 2020 2020 2020 7468  f.            th
-00034de0: 6520 6761 7020 696e 2074 6865 2064 6174  e gap in the dat
-00034df0: 612e 2054 6f20 6f6e 6c79 2069 6e74 6572  a. To only inter
-00034e00: 706f 6c61 7465 206f 7665 7220 6761 7073  polate over gaps
-00034e10: 206c 6573 7320 7468 616e 2061 2067 6976   less than a giv
-00034e20: 656e 206c 656e 6774 682c 0a20 2020 2020  en length,.     
-00034e30: 2020 2020 2020 2073 6565 2060 606d 6178         see ``max
-00034e40: 5f67 6170 6060 2e0a 2020 2020 2020 2020  _gap``..        
-00034e50: 6d61 785f 6761 7020 3a20 696e 742c 2066  max_gap : int, f
-00034e60: 6c6f 6174 2c20 7374 722c 2070 616e 6461  loat, str, panda
-00034e70: 732e 5469 6d65 6465 6c74 612c 206e 756d  s.Timedelta, num
-00034e80: 7079 2e74 696d 6564 656c 7461 3634 2c20  py.timedelta64, 
-00034e90: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
-00034ea0: 7461 2c20 6465 6661 756c 743a 204e 6f6e  ta, default: Non
-00034eb0: 650a 2020 2020 2020 2020 2020 2020 4d61  e.            Ma
-00034ec0: 7869 6d75 6d20 7369 7a65 206f 6620 6761  ximum size of ga
-00034ed0: 702c 2061 2063 6f6e 7469 6e75 6f75 7320  p, a continuous 
-00034ee0: 7365 7175 656e 6365 206f 6620 4e61 4e73  sequence of NaNs
-00034ef0: 2c20 7468 6174 2077 696c 6c20 6265 2066  , that will be f
-00034f00: 696c 6c65 642e 0a20 2020 2020 2020 2020  illed..         
-00034f10: 2020 2055 7365 204e 6f6e 6520 666f 7220     Use None for 
-00034f20: 6e6f 206c 696d 6974 2e20 5768 656e 2069  no limit. When i
-00034f30: 6e74 6572 706f 6c61 7469 6e67 2061 6c6f  nterpolating alo
-00034f40: 6e67 2061 2064 6174 6574 696d 6536 3420  ng a datetime64 
-00034f50: 6469 6d65 6e73 696f 6e0a 2020 2020 2020  dimension.      
-00034f60: 2020 2020 2020 616e 6420 6060 7573 655f        and ``use_
-00034f70: 636f 6f72 6469 6e61 7465 3d54 7275 6560  coordinate=True`
-00034f80: 602c 2060 606d 6178 5f67 6170 6060 2063  `, ``max_gap`` c
-00034f90: 616e 2062 6520 6f6e 6520 6f66 2074 6865  an be one of the
-00034fa0: 2066 6f6c 6c6f 7769 6e67 3a0a 0a20 2020   following:..   
-00034fb0: 2020 2020 2020 2020 202d 2061 2073 7472           - a str
-00034fc0: 696e 6720 7468 6174 2069 7320 7661 6c69  ing that is vali
-00034fd0: 6420 696e 7075 7420 666f 7220 7061 6e64  d input for pand
-00034fe0: 6173 2e74 6f5f 7469 6d65 6465 6c74 610a  as.to_timedelta.
-00034ff0: 2020 2020 2020 2020 2020 2020 2d20 6120              - a 
-00035000: 3a70 793a 636c 6173 733a 606e 756d 7079  :py:class:`numpy
-00035010: 2e74 696d 6564 656c 7461 3634 6020 6f62  .timedelta64` ob
-00035020: 6a65 6374 0a20 2020 2020 2020 2020 2020  ject.           
-00035030: 202d 2061 203a 7079 3a63 6c61 7373 3a60   - a :py:class:`
-00035040: 7061 6e64 6173 2e54 696d 6564 656c 7461  pandas.Timedelta
-00035050: 6020 6f62 6a65 6374 0a20 2020 2020 2020  ` object.       
-00035060: 2020 2020 202d 2061 203a 7079 3a63 6c61       - a :py:cla
-00035070: 7373 3a60 6461 7465 7469 6d65 2e74 696d  ss:`datetime.tim
-00035080: 6564 656c 7461 6020 6f62 6a65 6374 0a0a  edelta` object..
-00035090: 2020 2020 2020 2020 2020 2020 4f74 6865              Othe
-000350a0: 7277 6973 652c 2060 606d 6178 5f67 6170  rwise, ``max_gap
-000350b0: 6060 206d 7573 7420 6265 2061 6e20 696e  `` must be an in
-000350c0: 7420 6f72 2061 2066 6c6f 6174 2e20 5573  t or a float. Us
-000350d0: 6520 6f66 2060 606d 6178 5f67 6170 6060  e of ``max_gap``
-000350e0: 2077 6974 6820 756e 6c61 6265 6c65 640a   with unlabeled.
-000350f0: 2020 2020 2020 2020 2020 2020 6469 6d65              dime
-00035100: 6e73 696f 6e73 2068 6173 206e 6f74 2062  nsions has not b
-00035110: 6565 6e20 696d 706c 656d 656e 7465 6420  een implemented 
-00035120: 7965 742e 2047 6170 206c 656e 6774 6820  yet. Gap length 
-00035130: 6973 2064 6566 696e 6564 2061 7320 7468  is defined as th
-00035140: 6520 6469 6666 6572 656e 6365 0a20 2020  e difference.   
-00035150: 2020 2020 2020 2020 2062 6574 7765 656e           between
-00035160: 2063 6f6f 7264 696e 6174 6520 7661 6c75   coordinate valu
-00035170: 6573 2061 7420 7468 6520 6669 7273 7420  es at the first 
-00035180: 6461 7461 2070 6f69 6e74 2061 6674 6572  data point after
-00035190: 2061 2067 6170 2061 6e64 2074 6865 206c   a gap and the l
-000351a0: 6173 7420 7661 6c75 650a 2020 2020 2020  ast value.      
-000351b0: 2020 2020 2020 6265 666f 7265 2061 2067        before a g
-000351c0: 6170 2e20 466f 7220 6761 7073 2061 7420  ap. For gaps at 
-000351d0: 7468 6520 6265 6769 6e6e 696e 6720 2865  the beginning (e
-000351e0: 6e64 292c 2067 6170 206c 656e 6774 6820  nd), gap length 
-000351f0: 6973 2064 6566 696e 6564 2061 7320 7468  is defined as th
-00035200: 6520 6469 6666 6572 656e 6365 0a20 2020  e difference.   
-00035210: 2020 2020 2020 2020 2062 6574 7765 656e           between
-00035220: 2063 6f6f 7264 696e 6174 6520 7661 6c75   coordinate valu
-00035230: 6573 2061 7420 7468 6520 6669 7273 7420  es at the first 
-00035240: 286c 6173 7429 2076 616c 6964 2064 6174  (last) valid dat
-00035250: 6120 706f 696e 7420 616e 6420 7468 6520  a point and the 
-00035260: 6669 7273 7420 286c 6173 7429 204e 614e  first (last) NaN
-00035270: 2e0a 2020 2020 2020 2020 2020 2020 466f  ..            Fo
-00035280: 7220 6578 616d 706c 652c 2063 6f6e 7369  r example, consi
-00035290: 6465 723a 3a0a 0a20 2020 2020 2020 2020  der::..         
-000352a0: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
-000352b0: 6174 6141 7272 6179 2028 783a 2039 293e  ataArray (x: 9)>
-000352c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000352d0: 2061 7272 6179 285b 6e61 6e2c 206e 616e   array([nan, nan
-000352e0: 2c20 6e61 6e2c 2020 312e 2c20 6e61 6e2c  , nan,  1., nan,
-000352f0: 206e 616e 2c20 2034 2e2c 206e 616e 2c20   nan,  4., nan, 
-00035300: 6e61 6e5d 290a 2020 2020 2020 2020 2020  nan]).          
-00035310: 2020 2020 2020 436f 6f72 6469 6e61 7465        Coordinate
-00035320: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00035330: 2020 2020 202a 2078 2020 2020 2020 2020       * x        
-00035340: 2878 2920 696e 7436 3420 3020 3120 3220  (x) int64 0 1 2 
-00035350: 3320 3420 3520 3620 3720 380a 0a20 2020  3 4 5 6 7 8..   
-00035360: 2020 2020 2020 2020 2054 6865 2067 6170           The gap
-00035370: 206c 656e 6774 6873 2061 7265 2033 2d30   lengths are 3-0
-00035380: 203d 2033 3b20 362d 3320 3d20 333b 2061   = 3; 6-3 = 3; a
-00035390: 6e64 2038 2d36 203d 2032 2072 6573 7065  nd 8-6 = 2 respe
-000353a0: 6374 6976 656c 790a 2020 2020 2020 2020  ctively.        
-000353b0: 2a2a 6b77 6172 6773 203a 2064 6963 742c  **kwargs : dict,
-000353c0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000353d0: 2020 2020 2020 7061 7261 6d65 7465 7273        parameters
-000353e0: 2070 6173 7365 6420 7665 7262 6174 696d   passed verbatim
-000353f0: 2074 6f20 7468 6520 756e 6465 726c 7969   to the underlyi
-00035400: 6e67 2069 6e74 6572 706f 6c61 7469 6f6e  ng interpolation
-00035410: 2066 756e 6374 696f 6e0a 0a20 2020 2020   function..     
-00035420: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00035430: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00035440: 2020 2069 6e74 6572 706f 6c61 7465 643a     interpolated:
-00035450: 2044 6174 6173 6574 0a20 2020 2020 2020   Dataset.       
-00035460: 2020 2020 2046 696c 6c65 6420 696e 2044       Filled in D
-00035470: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
-00035480: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-00035490: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-000354a0: 2020 206e 756d 7079 2e69 6e74 6572 700a     numpy.interp.
-000354b0: 2020 2020 2020 2020 7363 6970 792e 696e          scipy.in
-000354c0: 7465 7270 6f6c 6174 650a 0a20 2020 2020  terpolate..     
-000354d0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-000354e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-000354f0: 2020 2020 203e 3e3e 2064 7320 3d20 7872       >>> ds = xr
-00035500: 2e44 6174 6173 6574 280a 2020 2020 2020  .Dataset(.      
-00035510: 2020 2e2e 2e20 2020 2020 7b0a 2020 2020    ...     {.    
-00035520: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-00035530: 2241 223a 2028 2278 222c 205b 6e70 2e6e  "A": ("x", [np.n
-00035540: 616e 2c20 322c 2033 2c20 6e70 2e6e 616e  an, 2, 3, np.nan
-00035550: 2c20 305d 292c 0a20 2020 2020 2020 202e  , 0]),.        .
-00035560: 2e2e 2020 2020 2020 2020 2022 4222 3a20  ..         "B": 
-00035570: 2822 7822 2c20 5b33 2c20 342c 206e 702e  ("x", [3, 4, np.
-00035580: 6e61 6e2c 2031 2c20 375d 292c 0a20 2020  nan, 1, 7]),.   
-00035590: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-000355a0: 2022 4322 3a20 2822 7822 2c20 5b6e 702e   "C": ("x", [np.
-000355b0: 6e61 6e2c 206e 702e 6e61 6e2c 206e 702e  nan, np.nan, np.
-000355c0: 6e61 6e2c 2035 2c20 305d 292c 0a20 2020  nan, 5, 0]),.   
-000355d0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-000355e0: 2022 4422 3a20 2822 7822 2c20 5b6e 702e   "D": ("x", [np.
-000355f0: 6e61 6e2c 2033 2c20 6e70 2e6e 616e 2c20  nan, 3, np.nan, 
-00035600: 2d31 2c20 345d 292c 0a20 2020 2020 2020  -1, 4]),.       
-00035610: 202e 2e2e 2020 2020 207d 2c0a 2020 2020   ...     },.    
-00035620: 2020 2020 2e2e 2e20 2020 2020 636f 6f72      ...     coor
-00035630: 6473 3d7b 2278 223a 205b 302c 2031 2c20  ds={"x": [0, 1, 
-00035640: 322c 2033 2c20 345d 7d2c 0a20 2020 2020  2, 3, 4]},.     
-00035650: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
-00035660: 203e 3e3e 2064 730a 2020 2020 2020 2020   >>> ds.        
-00035670: 3c78 6172 7261 792e 4461 7461 7365 743e  <xarray.Dataset>
-00035680: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
-00035690: 6f6e 733a 2020 2878 3a20 3529 0a20 2020  ons:  (x: 5).   
-000356a0: 2020 2020 2043 6f6f 7264 696e 6174 6573       Coordinates
-000356b0: 3a0a 2020 2020 2020 2020 2020 2a20 7820  :.          * x 
-000356c0: 2020 2020 2020 2028 7829 2069 6e74 3634         (x) int64
-000356d0: 2030 2031 2032 2033 2034 0a20 2020 2020   0 1 2 3 4.     
-000356e0: 2020 2044 6174 6120 7661 7269 6162 6c65     Data variable
-000356f0: 733a 0a20 2020 2020 2020 2020 2020 2041  s:.            A
-00035700: 2020 2020 2020 2020 2878 2920 666c 6f61          (x) floa
-00035710: 7436 3420 6e61 6e20 322e 3020 332e 3020  t64 nan 2.0 3.0 
-00035720: 6e61 6e20 302e 300a 2020 2020 2020 2020  nan 0.0.        
-00035730: 2020 2020 4220 2020 2020 2020 2028 7829      B        (x)
-00035740: 2066 6c6f 6174 3634 2033 2e30 2034 2e30   float64 3.0 4.0
-00035750: 206e 616e 2031 2e30 2037 2e30 0a20 2020   nan 1.0 7.0.   
-00035760: 2020 2020 2020 2020 2043 2020 2020 2020           C      
-00035770: 2020 2878 2920 666c 6f61 7436 3420 6e61    (x) float64 na
-00035780: 6e20 6e61 6e20 6e61 6e20 352e 3020 302e  n nan nan 5.0 0.
-00035790: 300a 2020 2020 2020 2020 2020 2020 4420  0.            D 
-000357a0: 2020 2020 2020 2028 7829 2066 6c6f 6174         (x) float
-000357b0: 3634 206e 616e 2033 2e30 206e 616e 202d  64 nan 3.0 nan -
-000357c0: 312e 3020 342e 300a 0a20 2020 2020 2020  1.0 4.0..       
-000357d0: 203e 3e3e 2064 732e 696e 7465 7270 6f6c   >>> ds.interpol
-000357e0: 6174 655f 6e61 2864 696d 3d22 7822 2c20  ate_na(dim="x", 
-000357f0: 6d65 7468 6f64 3d22 6c69 6e65 6172 2229  method="linear")
-00035800: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
-00035810: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
-00035820: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
-00035830: 783a 2035 290a 2020 2020 2020 2020 436f  x: 5).        Co
-00035840: 6f72 6469 6e61 7465 733a 0a20 2020 2020  ordinates:.     
-00035850: 2020 2020 202a 2078 2020 2020 2020 2020       * x        
-00035860: 2878 2920 696e 7436 3420 3020 3120 3220  (x) int64 0 1 2 
-00035870: 3320 340a 2020 2020 2020 2020 4461 7461  3 4.        Data
-00035880: 2076 6172 6961 626c 6573 3a0a 2020 2020   variables:.    
-00035890: 2020 2020 2020 2020 4120 2020 2020 2020          A       
-000358a0: 2028 7829 2066 6c6f 6174 3634 206e 616e   (x) float64 nan
-000358b0: 2032 2e30 2033 2e30 2031 2e35 2030 2e30   2.0 3.0 1.5 0.0
-000358c0: 0a20 2020 2020 2020 2020 2020 2042 2020  .            B  
-000358d0: 2020 2020 2020 2878 2920 666c 6f61 7436        (x) float6
-000358e0: 3420 332e 3020 342e 3020 322e 3520 312e  4 3.0 4.0 2.5 1.
-000358f0: 3020 372e 300a 2020 2020 2020 2020 2020  0 7.0.          
-00035900: 2020 4320 2020 2020 2020 2028 7829 2066    C        (x) f
-00035910: 6c6f 6174 3634 206e 616e 206e 616e 206e  loat64 nan nan n
-00035920: 616e 2035 2e30 2030 2e30 0a20 2020 2020  an 5.0 0.0.     
-00035930: 2020 2020 2020 2044 2020 2020 2020 2020         D        
-00035940: 2878 2920 666c 6f61 7436 3420 6e61 6e20  (x) float64 nan 
-00035950: 332e 3020 312e 3020 2d31 2e30 2034 2e30  3.0 1.0 -1.0 4.0
-00035960: 0a0a 2020 2020 2020 2020 3e3e 3e20 6473  ..        >>> ds
-00035970: 2e69 6e74 6572 706f 6c61 7465 5f6e 6128  .interpolate_na(
-00035980: 6469 6d3d 2278 222c 206d 6574 686f 643d  dim="x", method=
-00035990: 226c 696e 6561 7222 2c20 6669 6c6c 5f76  "linear", fill_v
-000359a0: 616c 7565 3d22 6578 7472 6170 6f6c 6174  alue="extrapolat
-000359b0: 6522 290a 2020 2020 2020 2020 3c78 6172  e").        <xar
-000359c0: 7261 792e 4461 7461 7365 743e 0a20 2020  ray.Dataset>.   
-000359d0: 2020 2020 2044 696d 656e 7369 6f6e 733a       Dimensions:
-000359e0: 2020 2878 3a20 3529 0a20 2020 2020 2020    (x: 5).       
-000359f0: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
-00035a00: 2020 2020 2020 2020 2a20 7820 2020 2020          * x     
-00035a10: 2020 2028 7829 2069 6e74 3634 2030 2031     (x) int64 0 1
-00035a20: 2032 2033 2034 0a20 2020 2020 2020 2044   2 3 4.        D
-00035a30: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
-00035a40: 2020 2020 2020 2020 2020 2041 2020 2020             A    
-00035a50: 2020 2020 2878 2920 666c 6f61 7436 3420      (x) float64 
-00035a60: 312e 3020 322e 3020 332e 3020 312e 3520  1.0 2.0 3.0 1.5 
-00035a70: 302e 300a 2020 2020 2020 2020 2020 2020  0.0.            
-00035a80: 4220 2020 2020 2020 2028 7829 2066 6c6f  B        (x) flo
-00035a90: 6174 3634 2033 2e30 2034 2e30 2032 2e35  at64 3.0 4.0 2.5
-00035aa0: 2031 2e30 2037 2e30 0a20 2020 2020 2020   1.0 7.0.       
-00035ab0: 2020 2020 2043 2020 2020 2020 2020 2878       C        (x
-00035ac0: 2920 666c 6f61 7436 3420 3230 2e30 2031  ) float64 20.0 1
-00035ad0: 352e 3020 3130 2e30 2035 2e30 2030 2e30  5.0 10.0 5.0 0.0
-00035ae0: 0a20 2020 2020 2020 2020 2020 2044 2020  .            D  
-00035af0: 2020 2020 2020 2878 2920 666c 6f61 7436        (x) float6
-00035b00: 3420 352e 3020 332e 3020 312e 3020 2d31  4 5.0 3.0 1.0 -1
-00035b10: 2e30 2034 2e30 0a20 2020 2020 2020 2022  .0 4.0.        "
-00035b20: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
-00035b30: 7861 7272 6179 2e63 6f72 652e 6d69 7373  xarray.core.miss
-00035b40: 696e 6720 696d 706f 7274 205f 6170 706c  ing import _appl
-00035b50: 795f 6f76 6572 5f76 6172 735f 7769 7468  y_over_vars_with
-00035b60: 5f64 696d 2c20 696e 7465 7270 5f6e 610a  _dim, interp_na.
-00035b70: 0a20 2020 2020 2020 206e 6577 203d 205f  .        new = _
-00035b80: 6170 706c 795f 6f76 6572 5f76 6172 735f  apply_over_vars_
-00035b90: 7769 7468 5f64 696d 280a 2020 2020 2020  with_dim(.      
-00035ba0: 2020 2020 2020 696e 7465 7270 5f6e 612c        interp_na,
-00035bb0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00035bc0: 662c 0a20 2020 2020 2020 2020 2020 2064  f,.            d
-00035bd0: 696d 3d64 696d 2c0a 2020 2020 2020 2020  im=dim,.        
-00035be0: 2020 2020 6d65 7468 6f64 3d6d 6574 686f      method=metho
-00035bf0: 642c 0a20 2020 2020 2020 2020 2020 206c  d,.            l
-00035c00: 696d 6974 3d6c 696d 6974 2c0a 2020 2020  imit=limit,.    
-00035c10: 2020 2020 2020 2020 7573 655f 636f 6f72          use_coor
-00035c20: 6469 6e61 7465 3d75 7365 5f63 6f6f 7264  dinate=use_coord
-00035c30: 696e 6174 652c 0a20 2020 2020 2020 2020  inate,.         
-00035c40: 2020 206d 6178 5f67 6170 3d6d 6178 5f67     max_gap=max_g
-00035c50: 6170 2c0a 2020 2020 2020 2020 2020 2020  ap,.            
-00035c60: 2a2a 6b77 6172 6773 2c0a 2020 2020 2020  **kwargs,.      
-00035c70: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00035c80: 726e 206e 6577 0a0a 2020 2020 6465 6620  rn new..    def 
-00035c90: 6666 696c 6c28 7365 6c66 3a20 545f 4461  ffill(self: T_Da
-00035ca0: 7461 7365 742c 2064 696d 3a20 4861 7368  taset, dim: Hash
-00035cb0: 6162 6c65 2c20 6c69 6d69 743a 2069 6e74  able, limit: int
-00035cc0: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2920   | None = None) 
-00035cd0: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-00035ce0: 2020 2020 2020 2222 2246 696c 6c20 4e61        """Fill Na
-00035cf0: 4e20 7661 6c75 6573 2062 7920 7072 6f70  N values by prop
-00035d00: 6167 6174 696e 6720 7661 6c75 6573 2066  agating values f
-00035d10: 6f72 7761 7264 0a0a 2020 2020 2020 2020  orward..        
-00035d20: 2a52 6571 7569 7265 7320 626f 7474 6c65  *Requires bottle
-00035d30: 6e65 636b 2e2a 0a0a 2020 2020 2020 2020  neck.*..        
-00035d40: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00035d50: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00035d60: 2020 2020 2020 6469 6d20 3a20 4861 7368        dim : Hash
-00035d70: 6162 6c65 0a20 2020 2020 2020 2020 2020  able.           
-00035d80: 2053 7065 6369 6669 6573 2074 6865 2064   Specifies the d
-00035d90: 696d 656e 7369 6f6e 2061 6c6f 6e67 2077  imension along w
-00035da0: 6869 6368 2074 6f20 7072 6f70 6167 6174  hich to propagat
-00035db0: 6520 7661 6c75 6573 2077 6865 6e0a 2020  e values when.  
-00035dc0: 2020 2020 2020 2020 2020 6669 6c6c 696e            fillin
-00035dd0: 672e 0a20 2020 2020 2020 206c 696d 6974  g..        limit
-00035de0: 203a 2069 6e74 206f 7220 4e6f 6e65 2c20   : int or None, 
-00035df0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-00035e00: 2020 2020 2054 6865 206d 6178 696d 756d       The maximum
-00035e10: 206e 756d 6265 7220 6f66 2063 6f6e 7365   number of conse
-00035e20: 6375 7469 7665 204e 614e 2076 616c 7565  cutive NaN value
-00035e30: 7320 746f 2066 6f72 7761 7264 2066 696c  s to forward fil
-00035e40: 6c2e 2049 6e0a 2020 2020 2020 2020 2020  l. In.          
-00035e50: 2020 6f74 6865 7220 776f 7264 732c 2069    other words, i
-00035e60: 6620 7468 6572 6520 6973 2061 2067 6170  f there is a gap
-00035e70: 2077 6974 6820 6d6f 7265 2074 6861 6e20   with more than 
-00035e80: 7468 6973 206e 756d 6265 7220 6f66 0a20  this number of. 
-00035e90: 2020 2020 2020 2020 2020 2063 6f6e 7365             conse
-00035ea0: 6375 7469 7665 204e 614e 732c 2069 7420  cutive NaNs, it 
-00035eb0: 7769 6c6c 206f 6e6c 7920 6265 2070 6172  will only be par
-00035ec0: 7469 616c 6c79 2066 696c 6c65 642e 204d  tially filled. M
-00035ed0: 7573 7420 6265 2067 7265 6174 6572 0a20  ust be greater. 
-00035ee0: 2020 2020 2020 2020 2020 2074 6861 6e20             than 
-00035ef0: 3020 6f72 204e 6f6e 6520 666f 7220 6e6f  0 or None for no
-00035f00: 206c 696d 6974 2e20 4d75 7374 2062 6520   limit. Must be 
-00035f10: 4e6f 6e65 206f 7220 6772 6561 7465 7220  None or greater 
-00035f20: 7468 616e 206f 7220 6571 7561 6c0a 2020  than or equal.  
-00035f30: 2020 2020 2020 2020 2020 746f 2061 7869            to axi
-00035f40: 7320 6c65 6e67 7468 2069 6620 6669 6c6c  s length if fill
-00035f50: 696e 6720 616c 6f6e 6720 6368 756e 6b65  ing along chunke
-00035f60: 6420 6178 6573 2028 6469 6d65 6e73 696f  d axes (dimensio
-00035f70: 6e73 292e 0a0a 2020 2020 2020 2020 5265  ns)...        Re
-00035f80: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
-00035f90: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
-00035fa0: 7461 7365 740a 2020 2020 2020 2020 2222  taset.        ""
-00035fb0: 220a 2020 2020 2020 2020 6672 6f6d 2078  ".        from x
-00035fc0: 6172 7261 792e 636f 7265 2e6d 6973 7369  array.core.missi
-00035fd0: 6e67 2069 6d70 6f72 7420 5f61 7070 6c79  ng import _apply
-00035fe0: 5f6f 7665 725f 7661 7273 5f77 6974 685f  _over_vars_with_
-00035ff0: 6469 6d2c 2066 6669 6c6c 0a0a 2020 2020  dim, ffill..    
-00036000: 2020 2020 6e65 7720 3d20 5f61 7070 6c79      new = _apply
-00036010: 5f6f 7665 725f 7661 7273 5f77 6974 685f  _over_vars_with_
-00036020: 6469 6d28 6666 696c 6c2c 2073 656c 662c  dim(ffill, self,
-00036030: 2064 696d 3d64 696d 2c20 6c69 6d69 743d   dim=dim, limit=
-00036040: 6c69 6d69 7429 0a20 2020 2020 2020 2072  limit).        r
-00036050: 6574 7572 6e20 6e65 770a 0a20 2020 2064  eturn new..    d
-00036060: 6566 2062 6669 6c6c 2873 656c 663a 2054  ef bfill(self: T
-00036070: 5f44 6174 6173 6574 2c20 6469 6d3a 2048  _Dataset, dim: H
-00036080: 6173 6861 626c 652c 206c 696d 6974 3a20  ashable, limit: 
-00036090: 696e 7420 7c20 4e6f 6e65 203d 204e 6f6e  int | None = Non
-000360a0: 6529 202d 3e20 545f 4461 7461 7365 743a  e) -> T_Dataset:
-000360b0: 0a20 2020 2020 2020 2022 2222 4669 6c6c  .        """Fill
-000360c0: 204e 614e 2076 616c 7565 7320 6279 2070   NaN values by p
-000360d0: 726f 7061 6761 7469 6e67 2076 616c 7565  ropagating value
-000360e0: 7320 6261 636b 7761 7264 0a0a 2020 2020  s backward..    
-000360f0: 2020 2020 2a52 6571 7569 7265 7320 626f      *Requires bo
-00036100: 7474 6c65 6e65 636b 2e2a 0a0a 2020 2020  ttleneck.*..    
-00036110: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-00036120: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-00036130: 2d0a 2020 2020 2020 2020 6469 6d20 3a20  -.        dim : 
-00036140: 4861 7368 6162 6c65 0a20 2020 2020 2020  Hashable.       
-00036150: 2020 2020 2053 7065 6369 6669 6573 2074       Specifies t
-00036160: 6865 2064 696d 656e 7369 6f6e 2061 6c6f  he dimension alo
-00036170: 6e67 2077 6869 6368 2074 6f20 7072 6f70  ng which to prop
-00036180: 6167 6174 6520 7661 6c75 6573 2077 6865  agate values whe
-00036190: 6e0a 2020 2020 2020 2020 2020 2020 6669  n.            fi
-000361a0: 6c6c 696e 672e 0a20 2020 2020 2020 206c  lling..        l
-000361b0: 696d 6974 203a 2069 6e74 206f 7220 4e6f  imit : int or No
-000361c0: 6e65 2c20 6f70 7469 6f6e 616c 0a20 2020  ne, optional.   
-000361d0: 2020 2020 2020 2020 2054 6865 206d 6178           The max
-000361e0: 696d 756d 206e 756d 6265 7220 6f66 2063  imum number of c
-000361f0: 6f6e 7365 6375 7469 7665 204e 614e 2076  onsecutive NaN v
-00036200: 616c 7565 7320 746f 2062 6163 6b77 6172  alues to backwar
-00036210: 6420 6669 6c6c 2e20 496e 0a20 2020 2020  d fill. In.     
-00036220: 2020 2020 2020 206f 7468 6572 2077 6f72         other wor
-00036230: 6473 2c20 6966 2074 6865 7265 2069 7320  ds, if there is 
-00036240: 6120 6761 7020 7769 7468 206d 6f72 6520  a gap with more 
-00036250: 7468 616e 2074 6869 7320 6e75 6d62 6572  than this number
-00036260: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
-00036270: 636f 6e73 6563 7574 6976 6520 4e61 4e73  consecutive NaNs
-00036280: 2c20 6974 2077 696c 6c20 6f6e 6c79 2062  , it will only b
-00036290: 6520 7061 7274 6961 6c6c 7920 6669 6c6c  e partially fill
-000362a0: 6564 2e20 4d75 7374 2062 6520 6772 6561  ed. Must be grea
-000362b0: 7465 720a 2020 2020 2020 2020 2020 2020  ter.            
-000362c0: 7468 616e 2030 206f 7220 4e6f 6e65 2066  than 0 or None f
-000362d0: 6f72 206e 6f20 6c69 6d69 742e 204d 7573  or no limit. Mus
-000362e0: 7420 6265 204e 6f6e 6520 6f72 2067 7265  t be None or gre
-000362f0: 6174 6572 2074 6861 6e20 6f72 2065 7175  ater than or equ
-00036300: 616c 0a20 2020 2020 2020 2020 2020 2074  al.            t
-00036310: 6f20 6178 6973 206c 656e 6774 6820 6966  o axis length if
-00036320: 2066 696c 6c69 6e67 2061 6c6f 6e67 2063   filling along c
-00036330: 6875 6e6b 6564 2061 7865 7320 2864 696d  hunked axes (dim
-00036340: 656e 7369 6f6e 7329 2e0a 0a20 2020 2020  ensions)...     
-00036350: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-00036360: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-00036370: 2020 2044 6174 6173 6574 0a20 2020 2020     Dataset.     
-00036380: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00036390: 726f 6d20 7861 7272 6179 2e63 6f72 652e  rom xarray.core.
-000363a0: 6d69 7373 696e 6720 696d 706f 7274 205f  missing import _
-000363b0: 6170 706c 795f 6f76 6572 5f76 6172 735f  apply_over_vars_
-000363c0: 7769 7468 5f64 696d 2c20 6266 696c 6c0a  with_dim, bfill.
-000363d0: 0a20 2020 2020 2020 206e 6577 203d 205f  .        new = _
-000363e0: 6170 706c 795f 6f76 6572 5f76 6172 735f  apply_over_vars_
-000363f0: 7769 7468 5f64 696d 2862 6669 6c6c 2c20  with_dim(bfill, 
-00036400: 7365 6c66 2c20 6469 6d3d 6469 6d2c 206c  self, dim=dim, l
-00036410: 696d 6974 3d6c 696d 6974 290a 2020 2020  imit=limit).    
-00036420: 2020 2020 7265 7475 726e 206e 6577 0a0a      return new..
-00036430: 2020 2020 6465 6620 636f 6d62 696e 655f      def combine_
-00036440: 6669 7273 7428 7365 6c66 3a20 545f 4461  first(self: T_Da
-00036450: 7461 7365 742c 206f 7468 6572 3a20 545f  taset, other: T_
-00036460: 4461 7461 7365 7429 202d 3e20 545f 4461  Dataset) -> T_Da
-00036470: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-00036480: 2222 436f 6d62 696e 6520 7477 6f20 4461  ""Combine two Da
-00036490: 7461 7365 7473 2c20 6465 6661 756c 7420  tasets, default 
-000364a0: 746f 2064 6174 615f 7661 7273 206f 6620  to data_vars of 
-000364b0: 7365 6c66 2e0a 0a20 2020 2020 2020 2054  self...        T
-000364c0: 6865 206e 6577 2063 6f6f 7264 696e 6174  he new coordinat
-000364d0: 6573 2066 6f6c 6c6f 7720 7468 6520 6e6f  es follow the no
-000364e0: 726d 616c 2062 726f 6164 6361 7374 696e  rmal broadcastin
-000364f0: 6720 616e 6420 616c 6967 6e6d 656e 7420  g and alignment 
-00036500: 7275 6c65 730a 2020 2020 2020 2020 6f66  rules.        of
-00036510: 2060 606a 6f69 6e3d 276f 7574 6572 2760   ``join='outer'`
-00036520: 602e 2020 5661 6361 6e74 2063 656c 6c73  `.  Vacant cells
-00036530: 2069 6e20 7468 6520 6578 7061 6e64 6564   in the expanded
-00036540: 2063 6f6f 7264 696e 6174 6573 2061 7265   coordinates are
-00036550: 0a20 2020 2020 2020 2066 696c 6c65 6420  .        filled 
-00036560: 7769 7468 206e 702e 6e61 6e2e 0a0a 2020  with np.nan...  
-00036570: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00036580: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00036590: 2d2d 2d0a 2020 2020 2020 2020 6f74 6865  ---.        othe
-000365a0: 7220 3a20 4461 7461 7365 740a 2020 2020  r : Dataset.    
-000365b0: 2020 2020 2020 2020 5573 6564 2074 6f20          Used to 
-000365c0: 6669 6c6c 2061 6c6c 206d 6174 6368 696e  fill all matchin
-000365d0: 6720 6d69 7373 696e 6720 7661 6c75 6573  g missing values
-000365e0: 2069 6e20 7468 6973 2061 7272 6179 2e0a   in this array..
-000365f0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00036600: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00036610: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
-00036620: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00036630: 2020 2020 206f 7574 203d 206f 7073 2e66       out = ops.f
-00036640: 696c 6c6e 6128 7365 6c66 2c20 6f74 6865  illna(self, othe
-00036650: 722c 206a 6f69 6e3d 226f 7574 6572 222c  r, join="outer",
-00036660: 2064 6174 6173 6574 5f6a 6f69 6e3d 226f   dataset_join="o
-00036670: 7574 6572 2229 0a20 2020 2020 2020 2072  uter").        r
-00036680: 6574 7572 6e20 6f75 740a 0a20 2020 2064  eturn out..    d
-00036690: 6566 2072 6564 7563 6528 0a20 2020 2020  ef reduce(.     
-000366a0: 2020 2073 656c 663a 2054 5f44 6174 6173     self: T_Datas
-000366b0: 6574 2c0a 2020 2020 2020 2020 6675 6e63  et,.        func
-000366c0: 3a20 4361 6c6c 6162 6c65 2c0a 2020 2020  : Callable,.    
-000366d0: 2020 2020 6469 6d3a 2044 696d 7320 3d20      dim: Dims = 
-000366e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 2a2c  None,.        *,
-000366f0: 0a20 2020 2020 2020 206b 6565 705f 6174  .        keep_at
-00036700: 7472 733a 2062 6f6f 6c20 7c20 4e6f 6e65  trs: bool | None
-00036710: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00036720: 206b 6565 7064 696d 733a 2062 6f6f 6c20   keepdims: bool 
-00036730: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-00036740: 206e 756d 6572 6963 5f6f 6e6c 793a 2062   numeric_only: b
-00036750: 6f6f 6c20 3d20 4661 6c73 652c 0a20 2020  ool = False,.   
-00036760: 2020 2020 202a 2a6b 7761 7267 733a 2041       **kwargs: A
-00036770: 6e79 2c0a 2020 2020 2920 2d3e 2054 5f44  ny,.    ) -> T_D
-00036780: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
-00036790: 2222 2252 6564 7563 6520 7468 6973 2064  """Reduce this d
-000367a0: 6174 6173 6574 2062 7920 6170 706c 7969  ataset by applyi
-000367b0: 6e67 2060 6675 6e63 6020 616c 6f6e 6720  ng `func` along 
-000367c0: 736f 6d65 2064 696d 656e 7369 6f6e 2873  some dimension(s
-000367d0: 292e 0a0a 2020 2020 2020 2020 5061 7261  )...        Para
-000367e0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-000367f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00036800: 2020 6675 6e63 203a 2063 616c 6c61 626c    func : callabl
-00036810: 650a 2020 2020 2020 2020 2020 2020 4675  e.            Fu
-00036820: 6e63 7469 6f6e 2077 6869 6368 2063 616e  nction which can
-00036830: 2062 6520 6361 6c6c 6564 2069 6e20 7468   be called in th
-00036840: 6520 666f 726d 0a20 2020 2020 2020 2020  e form.         
-00036850: 2020 2060 6628 782c 2061 7869 733d 6178     `f(x, axis=ax
-00036860: 6973 2c20 2a2a 6b77 6172 6773 2960 2074  is, **kwargs)` t
-00036870: 6f20 7265 7475 726e 2074 6865 2072 6573  o return the res
-00036880: 756c 7420 6f66 2072 6564 7563 696e 6720  ult of reducing 
-00036890: 616e 0a20 2020 2020 2020 2020 2020 206e  an.            n
-000368a0: 702e 6e64 6172 7261 7920 6f76 6572 2061  p.ndarray over a
-000368b0: 6e20 696e 7465 6765 7220 7661 6c75 6564  n integer valued
-000368c0: 2061 7869 732e 0a20 2020 2020 2020 2064   axis..        d
-000368d0: 696d 203a 2073 7472 2c20 4974 6572 6162  im : str, Iterab
-000368e0: 6c65 206f 6620 4861 7368 6162 6c65 206f  le of Hashable o
-000368f0: 7220 4e6f 6e65 2c20 6f70 7469 6f6e 616c  r None, optional
-00036900: 0a20 2020 2020 2020 2020 2020 2044 696d  .            Dim
-00036910: 656e 7369 6f6e 2873 2920 6f76 6572 2077  ension(s) over w
-00036920: 6869 6368 2074 6f20 6170 706c 7920 6066  hich to apply `f
-00036930: 756e 6360 2e20 4279 2064 6566 6175 6c74  unc`. By default
-00036940: 2060 6675 6e63 6020 6973 0a20 2020 2020   `func` is.     
-00036950: 2020 2020 2020 2061 7070 6c69 6564 206f         applied o
-00036960: 7665 7220 616c 6c20 6469 6d65 6e73 696f  ver all dimensio
-00036970: 6e73 2e0a 2020 2020 2020 2020 6b65 6570  ns..        keep
-00036980: 5f61 7474 7273 203a 2062 6f6f 6c20 6f72  _attrs : bool or
-00036990: 204e 6f6e 652c 206f 7074 696f 6e61 6c0a   None, optional.
-000369a0: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-000369b0: 7275 652c 2074 6865 2064 6174 6173 6574  rue, the dataset
-000369c0: 2773 2061 7474 7269 6275 7465 7320 2860  's attributes (`
-000369d0: 6174 7472 7360 2920 7769 6c6c 2062 6520  attrs`) will be 
-000369e0: 636f 7069 6564 2066 726f 6d0a 2020 2020  copied from.    
-000369f0: 2020 2020 2020 2020 7468 6520 6f72 6967          the orig
-00036a00: 696e 616c 206f 626a 6563 7420 746f 2074  inal object to t
-00036a10: 6865 206e 6577 206f 6e65 2e20 2049 6620  he new one.  If 
-00036a20: 4661 6c73 6520 2864 6566 6175 6c74 292c  False (default),
-00036a30: 2074 6865 206e 6577 0a20 2020 2020 2020   the new.       
-00036a40: 2020 2020 206f 626a 6563 7420 7769 6c6c       object will
-00036a50: 2062 6520 7265 7475 726e 6564 2077 6974   be returned wit
-00036a60: 686f 7574 2061 7474 7269 6275 7465 732e  hout attributes.
-00036a70: 0a20 2020 2020 2020 206b 6565 7064 696d  .        keepdim
-00036a80: 7320 3a20 626f 6f6c 2c20 6465 6661 756c  s : bool, defaul
-00036a90: 743a 2046 616c 7365 0a20 2020 2020 2020  t: False.       
-00036aa0: 2020 2020 2049 6620 5472 7565 2c20 7468       If True, th
-00036ab0: 6520 6469 6d65 6e73 696f 6e73 2077 6869  e dimensions whi
-00036ac0: 6368 2061 7265 2072 6564 7563 6564 2061  ch are reduced a
-00036ad0: 7265 206c 6566 7420 696e 2074 6865 2072  re left in the r
-00036ae0: 6573 756c 740a 2020 2020 2020 2020 2020  esult.          
-00036af0: 2020 6173 2064 696d 656e 7369 6f6e 7320    as dimensions 
-00036b00: 6f66 2073 697a 6520 6f6e 652e 2043 6f6f  of size one. Coo
-00036b10: 7264 696e 6174 6573 2074 6861 7420 7573  rdinates that us
-00036b20: 6520 7468 6573 6520 6469 6d65 6e73 696f  e these dimensio
-00036b30: 6e73 0a20 2020 2020 2020 2020 2020 2061  ns.            a
-00036b40: 7265 2072 656d 6f76 6564 2e0a 2020 2020  re removed..    
-00036b50: 2020 2020 6e75 6d65 7269 635f 6f6e 6c79      numeric_only
-00036b60: 203a 2062 6f6f 6c2c 2064 6566 6175 6c74   : bool, default
-00036b70: 3a20 4661 6c73 650a 2020 2020 2020 2020  : False.        
-00036b80: 2020 2020 4966 2054 7275 652c 206f 6e6c      If True, onl
-00036b90: 7920 6170 706c 7920 6060 6675 6e63 6060  y apply ``func``
-00036ba0: 2074 6f20 7661 7269 6162 6c65 7320 7769   to variables wi
-00036bb0: 7468 2061 206e 756d 6572 6963 2064 7479  th a numeric dty
-00036bc0: 7065 2e0a 2020 2020 2020 2020 2a2a 6b77  pe..        **kw
-00036bd0: 6172 6773 203a 2041 6e79 0a20 2020 2020  args : Any.     
-00036be0: 2020 2020 2020 2041 6464 6974 696f 6e61         Additiona
-00036bf0: 6c20 6b65 7977 6f72 6420 6172 6775 6d65  l keyword argume
-00036c00: 6e74 7320 7061 7373 6564 206f 6e20 746f  nts passed on to
-00036c10: 2060 6066 756e 6360 602e 0a0a 2020 2020   ``func``...    
-00036c20: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-00036c30: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-00036c40: 2020 2020 7265 6475 6365 6420 3a20 4461      reduced : Da
-00036c50: 7461 7365 740a 2020 2020 2020 2020 2020  taset.          
-00036c60: 2020 4461 7461 7365 7420 7769 7468 2074    Dataset with t
-00036c70: 6869 7320 6f62 6a65 6374 2773 2044 6174  his object's Dat
-00036c80: 6141 7272 6179 7320 7265 706c 6163 6564  aArrays replaced
-00036c90: 2077 6974 6820 6e65 7720 4461 7461 4172   with new DataAr
-00036ca0: 7261 7973 0a20 2020 2020 2020 2020 2020  rays.           
-00036cb0: 206f 6620 7375 6d6d 6172 697a 6564 2064   of summarized d
-00036cc0: 6174 6120 616e 6420 7468 6520 696e 6469  ata and the indi
-00036cd0: 6361 7465 6420 6469 6d65 6e73 696f 6e28  cated dimension(
-00036ce0: 7329 2072 656d 6f76 6564 2e0a 2020 2020  s) removed..    
-00036cf0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00036d00: 6966 206b 7761 7267 732e 6765 7428 2261  if kwargs.get("a
-00036d10: 7869 7322 2c20 4e6f 6e65 2920 6973 206e  xis", None) is n
-00036d20: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
-00036d30: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-00036d40: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-00036d50: 2020 2020 2020 2022 7061 7373 696e 6720         "passing 
-00036d60: 2761 7869 7327 2074 6f20 4461 7461 7365  'axis' to Datase
-00036d70: 7420 7265 6475 6365 206d 6574 686f 6473  t reduce methods
-00036d80: 2069 7320 616d 6269 6775 6f75 732e 220a   is ambiguous.".
-00036d90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00036da0: 2220 506c 6561 7365 2075 7365 2027 6469  " Please use 'di
-00036db0: 6d27 2069 6e73 7465 6164 2e22 0a20 2020  m' instead.".   
-00036dc0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00036dd0: 2020 2020 6966 2064 696d 2069 7320 4e6f      if dim is No
-00036de0: 6e65 206f 7220 6469 6d20 6973 202e 2e2e  ne or dim is ...
-00036df0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
-00036e00: 6d73 203d 2073 6574 2873 656c 662e 6469  ms = set(self.di
-00036e10: 6d73 290a 2020 2020 2020 2020 656c 6966  ms).        elif
-00036e20: 2069 7369 6e73 7461 6e63 6528 6469 6d2c   isinstance(dim,
-00036e30: 2073 7472 2920 6f72 206e 6f74 2069 7369   str) or not isi
-00036e40: 6e73 7461 6e63 6528 6469 6d2c 2049 7465  nstance(dim, Ite
-00036e50: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
-00036e60: 2020 2020 6469 6d73 203d 207b 6469 6d7d      dims = {dim}
-00036e70: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00036e80: 2020 2020 2020 2020 2020 2064 696d 7320             dims 
-00036e90: 3d20 7365 7428 6469 6d29 0a0a 2020 2020  = set(dim)..    
-00036ea0: 2020 2020 6d69 7373 696e 675f 6469 6d65      missing_dime
-00036eb0: 6e73 696f 6e73 203d 205b 6420 666f 7220  nsions = [d for 
-00036ec0: 6420 696e 2064 696d 7320 6966 2064 206e  d in dims if d n
-00036ed0: 6f74 2069 6e20 7365 6c66 2e64 696d 735d  ot in self.dims]
-00036ee0: 0a20 2020 2020 2020 2069 6620 6d69 7373  .        if miss
-00036ef0: 696e 675f 6469 6d65 6e73 696f 6e73 3a0a  ing_dimensions:.
-00036f00: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00036f10: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-00036f20: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00036f30: 4461 7461 7365 7420 646f 6573 206e 6f74  Dataset does not
-00036f40: 2063 6f6e 7461 696e 2074 6865 2064 696d   contain the dim
-00036f50: 656e 7369 6f6e 733a 207b 6d69 7373 696e  ensions: {missin
-00036f60: 675f 6469 6d65 6e73 696f 6e73 7d22 0a20  g_dimensions}". 
-00036f70: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00036f80: 2020 2020 2020 6966 206b 6565 705f 6174        if keep_at
-00036f90: 7472 7320 6973 204e 6f6e 653a 0a20 2020  trs is None:.   
-00036fa0: 2020 2020 2020 2020 206b 6565 705f 6174           keep_at
-00036fb0: 7472 7320 3d20 5f67 6574 5f6b 6565 705f  trs = _get_keep_
-00036fc0: 6174 7472 7328 6465 6661 756c 743d 4661  attrs(default=Fa
-00036fd0: 6c73 6529 0a0a 2020 2020 2020 2020 7661  lse)..        va
-00036fe0: 7269 6162 6c65 733a 2064 6963 745b 4861  riables: dict[Ha
-00036ff0: 7368 6162 6c65 2c20 5661 7269 6162 6c65  shable, Variable
-00037000: 5d20 3d20 7b7d 0a20 2020 2020 2020 2066  ] = {}.        f
-00037010: 6f72 206e 616d 652c 2076 6172 2069 6e20  or name, var in 
-00037020: 7365 6c66 2e5f 7661 7269 6162 6c65 732e  self._variables.
-00037030: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-00037040: 2020 2020 2072 6564 7563 655f 6469 6d73       reduce_dims
-00037050: 203d 205b 6420 666f 7220 6420 696e 2076   = [d for d in v
-00037060: 6172 2e64 696d 7320 6966 2064 2069 6e20  ar.dims if d in 
-00037070: 6469 6d73 5d0a 2020 2020 2020 2020 2020  dims].          
-00037080: 2020 6966 206e 616d 6520 696e 2073 656c    if name in sel
-00037090: 662e 636f 6f72 6473 3a0a 2020 2020 2020  f.coords:.      
-000370a0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-000370b0: 2072 6564 7563 655f 6469 6d73 3a0a 2020   reduce_dims:.  
-000370c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000370d0: 2020 7661 7269 6162 6c65 735b 6e61 6d65    variables[name
-000370e0: 5d20 3d20 7661 720a 2020 2020 2020 2020  ] = var.        
-000370f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00037100: 2020 2020 2020 2020 2020 6966 2028 0a20            if (. 
-00037110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037120: 2020 2023 2053 6f6d 6520 7265 6475 6374     # Some reduct
-00037130: 696f 6e20 6675 6e63 7469 6f6e 7320 2865  ion functions (e
-00037140: 2e67 2e20 7374 642c 2076 6172 2920 6e65  .g. std, var) ne
-00037150: 6564 2074 6f20 7275 6e20 6f6e 2076 6172  ed to run on var
-00037160: 6961 626c 6573 0a20 2020 2020 2020 2020  iables.         
-00037170: 2020 2020 2020 2020 2020 2023 2074 6861             # tha
-00037180: 7420 646f 6e27 7420 6861 7665 2074 6865  t don't have the
-00037190: 2072 6564 7563 6520 6469 6d73 3a20 5052   reduce dims: PR
-000371a0: 3533 3933 0a20 2020 2020 2020 2020 2020  5393.           
-000371b0: 2020 2020 2020 2020 206e 6f74 2072 6564           not red
-000371c0: 7563 655f 6469 6d73 0a20 2020 2020 2020  uce_dims.       
-000371d0: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-000371e0: 6e6f 7420 6e75 6d65 7269 635f 6f6e 6c79  not numeric_only
-000371f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037200: 2020 2020 206f 7220 6e70 2e69 7373 7562       or np.issub
-00037210: 6474 7970 6528 7661 722e 6474 7970 652c  dtype(var.dtype,
-00037220: 206e 702e 6e75 6d62 6572 290a 2020 2020   np.number).    
-00037230: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037240: 6f72 2028 7661 722e 6474 7970 6520 3d3d  or (var.dtype ==
-00037250: 206e 702e 626f 6f6c 5f29 0a20 2020 2020   np.bool_).     
-00037260: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
-00037270: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037280: 2020 2320 7072 6566 6572 2074 6f20 6167    # prefer to ag
-00037290: 6772 6567 6174 6520 6f76 6572 2061 7869  gregate over axi
-000372a0: 733d 4e6f 6e65 2072 6174 6865 7220 7468  s=None rather th
-000372b0: 616e 0a20 2020 2020 2020 2020 2020 2020  an.             
-000372c0: 2020 2020 2020 2023 2061 7869 733d 2830         # axis=(0
-000372d0: 2c20 3129 2069 6620 7468 6579 2077 696c  , 1) if they wil
-000372e0: 6c20 6265 2065 7175 6976 616c 656e 742c  l be equivalent,
-000372f0: 2062 6563 6175 7365 0a20 2020 2020 2020   because.       
-00037300: 2020 2020 2020 2020 2020 2020 2023 2074               # t
-00037310: 6865 2066 6f72 6d65 7220 6973 206f 6674  he former is oft
-00037320: 656e 206d 6f72 6520 6566 6669 6369 656e  en more efficien
-00037330: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
-00037340: 2020 2020 2020 2320 6b65 6570 2073 696e        # keep sin
-00037350: 676c 652d 656c 656d 656e 7420 6469 6d73  gle-element dims
-00037360: 2061 7320 6c69 7374 2c20 746f 2073 7570   as list, to sup
-00037370: 706f 7274 2048 6173 6861 626c 6573 0a20  port Hashables. 
-00037380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037390: 2020 2072 6564 7563 655f 6d61 7962 655f     reduce_maybe_
-000373a0: 7369 6e67 6c65 203d 2028 0a20 2020 2020  single = (.     
-000373b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373c0: 2020 204e 6f6e 650a 2020 2020 2020 2020     None.        
-000373d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000373e0: 6966 206c 656e 2872 6564 7563 655f 6469  if len(reduce_di
-000373f0: 6d73 2920 3d3d 2076 6172 2e6e 6469 6d20  ms) == var.ndim 
-00037400: 616e 6420 7661 722e 6e64 696d 2021 3d20  and var.ndim != 
-00037410: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
-00037420: 2020 2020 2020 2020 2020 656c 7365 2072            else r
-00037430: 6564 7563 655f 6469 6d73 0a20 2020 2020  educe_dims.     
-00037440: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00037450: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037460: 2020 2020 2076 6172 6961 626c 6573 5b6e       variables[n
-00037470: 616d 655d 203d 2076 6172 2e72 6564 7563  ame] = var.reduc
-00037480: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00037490: 2020 2020 2020 2020 2020 2066 756e 632c             func,
-000374a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000374b0: 2020 2020 2020 2020 2064 696d 3d72 6564           dim=red
-000374c0: 7563 655f 6d61 7962 655f 7369 6e67 6c65  uce_maybe_single
-000374d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-000374e0: 2020 2020 2020 2020 2020 6b65 6570 5f61            keep_a
-000374f0: 7474 7273 3d6b 6565 705f 6174 7472 732c  ttrs=keep_attrs,
-00037500: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00037510: 2020 2020 2020 2020 206b 6565 7064 696d           keepdim
-00037520: 733d 6b65 6570 6469 6d73 2c0a 2020 2020  s=keepdims,.    
-00037530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037540: 2020 2020 2a2a 6b77 6172 6773 2c0a 2020      **kwargs,.  
-00037550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00037560: 2020 290a 0a20 2020 2020 2020 2063 6f6f    )..        coo
-00037570: 7264 5f6e 616d 6573 203d 207b 6b20 666f  rd_names = {k fo
-00037580: 7220 6b20 696e 2073 656c 662e 636f 6f72  r k in self.coor
-00037590: 6473 2069 6620 6b20 696e 2076 6172 6961  ds if k in varia
-000375a0: 626c 6573 7d0a 2020 2020 2020 2020 696e  bles}.        in
-000375b0: 6465 7865 7320 3d20 7b6b 3a20 7620 666f  dexes = {k: v fo
-000375c0: 7220 6b2c 2076 2069 6e20 7365 6c66 2e5f  r k, v in self._
-000375d0: 696e 6465 7865 732e 6974 656d 7328 2920  indexes.items() 
-000375e0: 6966 206b 2069 6e20 7661 7269 6162 6c65  if k in variable
-000375f0: 737d 0a20 2020 2020 2020 2061 7474 7273  s}.        attrs
-00037600: 203d 2073 656c 662e 6174 7472 7320 6966   = self.attrs if
-00037610: 206b 6565 705f 6174 7472 7320 656c 7365   keep_attrs else
-00037620: 204e 6f6e 650a 2020 2020 2020 2020 7265   None.        re
-00037630: 7475 726e 2073 656c 662e 5f72 6570 6c61  turn self._repla
-00037640: 6365 5f77 6974 685f 6e65 775f 6469 6d73  ce_with_new_dims
-00037650: 280a 2020 2020 2020 2020 2020 2020 7661  (.            va
-00037660: 7269 6162 6c65 732c 2063 6f6f 7264 5f6e  riables, coord_n
-00037670: 616d 6573 3d63 6f6f 7264 5f6e 616d 6573  ames=coord_names
-00037680: 2c20 6174 7472 733d 6174 7472 732c 2069  , attrs=attrs, i
-00037690: 6e64 6578 6573 3d69 6e64 6578 6573 0a20  ndexes=indexes. 
-000376a0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
-000376b0: 6620 6d61 7028 0a20 2020 2020 2020 2073  f map(.        s
-000376c0: 656c 663a 2054 5f44 6174 6173 6574 2c0a  elf: T_Dataset,.
-000376d0: 2020 2020 2020 2020 6675 6e63 3a20 4361          func: Ca
-000376e0: 6c6c 6162 6c65 2c0a 2020 2020 2020 2020  llable,.        
-000376f0: 6b65 6570 5f61 7474 7273 3a20 626f 6f6c  keep_attrs: bool
-00037700: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
-00037710: 2020 2020 2020 2020 6172 6773 3a20 4974          args: It
-00037720: 6572 6162 6c65 5b41 6e79 5d20 3d20 2829  erable[Any] = ()
-00037730: 2c0a 2020 2020 2020 2020 2a2a 6b77 6172  ,.        **kwar
-00037740: 6773 3a20 416e 792c 0a20 2020 2029 202d  gs: Any,.    ) -
-00037750: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
-00037760: 2020 2020 2022 2222 4170 706c 7920 6120       """Apply a 
-00037770: 6675 6e63 7469 6f6e 2074 6f20 6561 6368  function to each
-00037780: 2064 6174 6120 7661 7269 6162 6c65 2069   data variable i
-00037790: 6e20 7468 6973 2064 6174 6173 6574 0a0a  n this dataset..
-000377a0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-000377b0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-000377c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6675  -----.        fu
-000377d0: 6e63 203a 2063 616c 6c61 626c 650a 2020  nc : callable.  
-000377e0: 2020 2020 2020 2020 2020 4675 6e63 7469            Functi
-000377f0: 6f6e 2077 6869 6368 2063 616e 2062 6520  on which can be 
-00037800: 6361 6c6c 6564 2069 6e20 7468 6520 666f  called in the fo
-00037810: 726d 2060 6675 6e63 2878 2c20 2a61 7267  rm `func(x, *arg
-00037820: 732c 202a 2a6b 7761 7267 7329 600a 2020  s, **kwargs)`.  
-00037830: 2020 2020 2020 2020 2020 746f 2074 7261            to tra
-00037840: 6e73 666f 726d 2065 6163 6820 4461 7461  nsform each Data
-00037850: 4172 7261 7920 6078 6020 696e 2074 6869  Array `x` in thi
-00037860: 7320 6461 7461 7365 7420 696e 746f 2061  s dataset into a
-00037870: 6e6f 7468 6572 0a20 2020 2020 2020 2020  nother.         
-00037880: 2020 2044 6174 6141 7272 6179 2e0a 2020     DataArray..  
-00037890: 2020 2020 2020 6b65 6570 5f61 7474 7273        keep_attrs
-000378a0: 203a 2062 6f6f 6c20 6f72 204e 6f6e 652c   : bool or None,
-000378b0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000378c0: 2020 2020 2020 4966 2054 7275 652c 2062        If True, b
-000378d0: 6f74 6820 7468 6520 6461 7461 7365 7427  oth the dataset'
-000378e0: 7320 616e 6420 7661 7269 6162 6c65 7327  s and variables'
-000378f0: 2061 7474 7269 6275 7465 7320 2860 6174   attributes (`at
-00037900: 7472 7360 2920 7769 6c6c 2062 650a 2020  trs`) will be.  
-00037910: 2020 2020 2020 2020 2020 636f 7069 6564            copied
-00037920: 2066 726f 6d20 7468 6520 6f72 6967 696e   from the origin
-00037930: 616c 206f 626a 6563 7473 2074 6f20 7468  al objects to th
-00037940: 6520 6e65 7720 6f6e 6573 2e20 4966 2046  e new ones. If F
-00037950: 616c 7365 2c20 7468 6520 6e65 7720 6461  alse, the new da
-00037960: 7461 7365 740a 2020 2020 2020 2020 2020  taset.          
-00037970: 2020 616e 6420 7661 7269 6162 6c65 7320    and variables 
-00037980: 7769 6c6c 2062 6520 7265 7475 726e 6564  will be returned
-00037990: 2077 6974 686f 7574 2063 6f70 7969 6e67   without copying
-000379a0: 2074 6865 2061 7474 7269 6275 7465 732e   the attributes.
-000379b0: 0a20 2020 2020 2020 2061 7267 7320 3a20  .        args : 
-000379c0: 6974 6572 6162 6c65 2c20 6f70 7469 6f6e  iterable, option
-000379d0: 616c 0a20 2020 2020 2020 2020 2020 2050  al.            P
-000379e0: 6f73 6974 696f 6e61 6c20 6172 6775 6d65  ositional argume
-000379f0: 6e74 7320 7061 7373 6564 206f 6e20 746f  nts passed on to
-00037a00: 2060 6675 6e63 602e 0a20 2020 2020 2020   `func`..       
-00037a10: 202a 2a6b 7761 7267 7320 3a20 416e 790a   **kwargs : Any.
-00037a20: 2020 2020 2020 2020 2020 2020 4b65 7977              Keyw
-00037a30: 6f72 6420 6172 6775 6d65 6e74 7320 7061  ord arguments pa
-00037a40: 7373 6564 206f 6e20 746f 2060 6675 6e63  ssed on to `func
-00037a50: 602e 0a0a 2020 2020 2020 2020 5265 7475  `...        Retu
-00037a60: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-00037a70: 2d2d 2d0a 2020 2020 2020 2020 6170 706c  ---.        appl
-00037a80: 6965 6420 3a20 4461 7461 7365 740a 2020  ied : Dataset.  
-00037a90: 2020 2020 2020 2020 2020 5265 7375 6c74            Result
-00037aa0: 696e 6720 6461 7461 7365 7420 6672 6f6d  ing dataset from
-00037ab0: 2061 7070 6c79 696e 6720 6060 6675 6e63   applying ``func
-00037ac0: 6060 2074 6f20 6561 6368 2064 6174 6120  `` to each data 
-00037ad0: 7661 7269 6162 6c65 2e0a 0a20 2020 2020  variable...     
-00037ae0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-00037af0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00037b00: 2020 2020 203e 3e3e 2064 6120 3d20 7872       >>> da = xr
-00037b10: 2e44 6174 6141 7272 6179 286e 702e 7261  .DataArray(np.ra
-00037b20: 6e64 6f6d 2e72 616e 646e 2832 2c20 3329  ndom.randn(2, 3)
-00037b30: 290a 2020 2020 2020 2020 3e3e 3e20 6473  ).        >>> ds
-00037b40: 203d 2078 722e 4461 7461 7365 7428 7b22   = xr.Dataset({"
-00037b50: 666f 6f22 3a20 6461 2c20 2262 6172 223a  foo": da, "bar":
-00037b60: 2028 2278 222c 205b 2d31 2c20 325d 297d   ("x", [-1, 2])}
-00037b70: 290a 2020 2020 2020 2020 3e3e 3e20 6473  ).        >>> ds
-00037b80: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
-00037b90: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
-00037ba0: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
-00037bb0: 6469 6d5f 303a 2032 2c20 6469 6d5f 313a  dim_0: 2, dim_1:
-00037bc0: 2033 2c20 783a 2032 290a 2020 2020 2020   3, x: 2).      
-00037bd0: 2020 4469 6d65 6e73 696f 6e73 2077 6974    Dimensions wit
-00037be0: 686f 7574 2063 6f6f 7264 696e 6174 6573  hout coordinates
-00037bf0: 3a20 6469 6d5f 302c 2064 696d 5f31 2c20  : dim_0, dim_1, 
-00037c00: 780a 2020 2020 2020 2020 4461 7461 2076  x.        Data v
-00037c10: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
-00037c20: 2020 2020 2020 666f 6f20 2020 2020 2028        foo      (
-00037c30: 6469 6d5f 302c 2064 696d 5f31 2920 666c  dim_0, dim_1) fl
-00037c40: 6f61 7436 3420 312e 3736 3420 302e 3430  oat64 1.764 0.40
-00037c50: 3032 2030 2e39 3738 3720 322e 3234 3120  02 0.9787 2.241 
-00037c60: 312e 3836 3820 2d30 2e39 3737 330a 2020  1.868 -0.9773.  
-00037c70: 2020 2020 2020 2020 2020 6261 7220 2020            bar   
-00037c80: 2020 2028 7829 2069 6e74 3634 202d 3120     (x) int64 -1 
-00037c90: 320a 2020 2020 2020 2020 3e3e 3e20 6473  2.        >>> ds
-00037ca0: 2e6d 6170 286e 702e 6661 6273 290a 2020  .map(np.fabs).  
-00037cb0: 2020 2020 2020 3c78 6172 7261 792e 4461        <xarray.Da
-00037cc0: 7461 7365 743e 0a20 2020 2020 2020 2044  taset>.        D
-00037cd0: 696d 656e 7369 6f6e 733a 2020 2864 696d  imensions:  (dim
-00037ce0: 5f30 3a20 322c 2064 696d 5f31 3a20 332c  _0: 2, dim_1: 3,
-00037cf0: 2078 3a20 3229 0a20 2020 2020 2020 2044   x: 2).        D
-00037d00: 696d 656e 7369 6f6e 7320 7769 7468 6f75  imensions withou
-00037d10: 7420 636f 6f72 6469 6e61 7465 733a 2064  t coordinates: d
-00037d20: 696d 5f30 2c20 6469 6d5f 312c 2078 0a20  im_0, dim_1, x. 
-00037d30: 2020 2020 2020 2044 6174 6120 7661 7269         Data vari
-00037d40: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
-00037d50: 2020 2066 6f6f 2020 2020 2020 2864 696d     foo      (dim
-00037d60: 5f30 2c20 6469 6d5f 3129 2066 6c6f 6174  _0, dim_1) float
-00037d70: 3634 2031 2e37 3634 2030 2e34 3030 3220  64 1.764 0.4002 
-00037d80: 302e 3937 3837 2032 2e32 3431 2031 2e38  0.9787 2.241 1.8
-00037d90: 3638 2030 2e39 3737 330a 2020 2020 2020  68 0.9773.      
-00037da0: 2020 2020 2020 6261 7220 2020 2020 2028        bar      (
-00037db0: 7829 2066 6c6f 6174 3634 2031 2e30 2032  x) float64 1.0 2
-00037dc0: 2e30 0a20 2020 2020 2020 2022 2222 0a20  .0.        """. 
-00037dd0: 2020 2020 2020 2069 6620 6b65 6570 5f61         if keep_a
-00037de0: 7474 7273 2069 7320 4e6f 6e65 3a0a 2020  ttrs is None:.  
-00037df0: 2020 2020 2020 2020 2020 6b65 6570 5f61            keep_a
-00037e00: 7474 7273 203d 205f 6765 745f 6b65 6570  ttrs = _get_keep
-00037e10: 5f61 7474 7273 2864 6566 6175 6c74 3d46  _attrs(default=F
-00037e20: 616c 7365 290a 2020 2020 2020 2020 7661  alse).        va
-00037e30: 7269 6162 6c65 7320 3d20 7b0a 2020 2020  riables = {.    
-00037e40: 2020 2020 2020 2020 6b3a 206d 6179 6265          k: maybe
-00037e50: 5f77 7261 705f 6172 7261 7928 762c 2066  _wrap_array(v, f
-00037e60: 756e 6328 762c 202a 6172 6773 2c20 2a2a  unc(v, *args, **
-00037e70: 6b77 6172 6773 2929 0a20 2020 2020 2020  kwargs)).       
-00037e80: 2020 2020 2066 6f72 206b 2c20 7620 696e       for k, v in
-00037e90: 2073 656c 662e 6461 7461 5f76 6172 732e   self.data_vars.
-00037ea0: 6974 656d 7328 290a 2020 2020 2020 2020  items().        
-00037eb0: 7d0a 2020 2020 2020 2020 6966 206b 6565  }.        if kee
-00037ec0: 705f 6174 7472 733a 0a20 2020 2020 2020  p_attrs:.       
-00037ed0: 2020 2020 2066 6f72 206b 2c20 7620 696e       for k, v in
-00037ee0: 2076 6172 6961 626c 6573 2e69 7465 6d73   variables.items
-00037ef0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00037f00: 2020 2020 762e 5f63 6f70 795f 6174 7472      v._copy_attr
-00037f10: 735f 6672 6f6d 2873 656c 662e 6461 7461  s_from(self.data
-00037f20: 5f76 6172 735b 6b5d 290a 2020 2020 2020  _vars[k]).      
-00037f30: 2020 6174 7472 7320 3d20 7365 6c66 2e61    attrs = self.a
-00037f40: 7474 7273 2069 6620 6b65 6570 5f61 7474  ttrs if keep_att
-00037f50: 7273 2065 6c73 6520 4e6f 6e65 0a20 2020  rs else None.   
-00037f60: 2020 2020 2072 6574 7572 6e20 7479 7065       return type
-00037f70: 2873 656c 6629 2876 6172 6961 626c 6573  (self)(variables
-00037f80: 2c20 6174 7472 733d 6174 7472 7329 0a0a  , attrs=attrs)..
-00037f90: 2020 2020 6465 6620 6170 706c 7928 0a20      def apply(. 
-00037fa0: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
-00037fb0: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
-00037fc0: 6675 6e63 3a20 4361 6c6c 6162 6c65 2c0a  func: Callable,.
-00037fd0: 2020 2020 2020 2020 6b65 6570 5f61 7474          keep_att
-00037fe0: 7273 3a20 626f 6f6c 207c 204e 6f6e 6520  rs: bool | None 
-00037ff0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00038000: 6172 6773 3a20 4974 6572 6162 6c65 5b41  args: Iterable[A
-00038010: 6e79 5d20 3d20 2829 2c0a 2020 2020 2020  ny] = (),.      
-00038020: 2020 2a2a 6b77 6172 6773 3a20 416e 792c    **kwargs: Any,
-00038030: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
-00038040: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
-00038050: 0a20 2020 2020 2020 2042 6163 6b77 6172  .        Backwar
-00038060: 6420 636f 6d70 6174 6962 6c65 2069 6d70  d compatible imp
-00038070: 6c65 6d65 6e74 6174 696f 6e20 6f66 2060  lementation of `
-00038080: 606d 6170 6060 0a0a 2020 2020 2020 2020  `map``..        
-00038090: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-000380a0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-000380b0: 2020 4461 7461 7365 742e 6d61 700a 2020    Dataset.map.  
-000380c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000380d0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
-000380e0: 0a20 2020 2020 2020 2020 2020 2022 4461  .            "Da
-000380f0: 7461 7365 742e 6170 706c 7920 6d61 7920  taset.apply may 
-00038100: 6265 2064 6570 7265 6361 7465 6420 696e  be deprecated in
-00038110: 2074 6865 2066 7574 7572 652e 2055 7369   the future. Usi
-00038120: 6e67 2044 6174 6173 6574 2e6d 6170 2069  ng Dataset.map i
-00038130: 7320 656e 636f 7572 6167 6564 222c 0a20  s encouraged",. 
-00038140: 2020 2020 2020 2020 2020 2050 656e 6469             Pendi
-00038150: 6e67 4465 7072 6563 6174 696f 6e57 6172  ngDeprecationWar
-00038160: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
-00038170: 2020 7374 6163 6b6c 6576 656c 3d32 2c0a    stacklevel=2,.
-00038180: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00038190: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-000381a0: 7028 6675 6e63 2c20 6b65 6570 5f61 7474  p(func, keep_att
-000381b0: 7273 2c20 6172 6773 2c20 2a2a 6b77 6172  rs, args, **kwar
-000381c0: 6773 290a 0a20 2020 2064 6566 2061 7373  gs)..    def ass
-000381d0: 6967 6e28 0a20 2020 2020 2020 2073 656c  ign(.        sel
-000381e0: 663a 2054 5f44 6174 6173 6574 2c0a 2020  f: T_Dataset,.  
-000381f0: 2020 2020 2020 7661 7269 6162 6c65 733a        variables:
-00038200: 204d 6170 7069 6e67 5b41 6e79 2c20 416e   Mapping[Any, An
-00038210: 795d 207c 204e 6f6e 6520 3d20 4e6f 6e65  y] | None = None
-00038220: 2c0a 2020 2020 2020 2020 2a2a 7661 7269  ,.        **vari
-00038230: 6162 6c65 735f 6b77 6172 6773 3a20 416e  ables_kwargs: An
-00038240: 792c 0a20 2020 2029 202d 3e20 545f 4461  y,.    ) -> T_Da
-00038250: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-00038260: 2222 4173 7369 676e 206e 6577 2064 6174  ""Assign new dat
-00038270: 6120 7661 7269 6162 6c65 7320 746f 2061  a variables to a
-00038280: 2044 6174 6173 6574 2c20 7265 7475 726e   Dataset, return
-00038290: 696e 6720 6120 6e65 7720 6f62 6a65 6374  ing a new object
-000382a0: 0a20 2020 2020 2020 2077 6974 6820 616c  .        with al
-000382b0: 6c20 7468 6520 6f72 6967 696e 616c 2076  l the original v
-000382c0: 6172 6961 626c 6573 2069 6e20 6164 6469  ariables in addi
-000382d0: 7469 6f6e 2074 6f20 7468 6520 6e65 7720  tion to the new 
-000382e0: 6f6e 6573 2e0a 0a20 2020 2020 2020 2050  ones...        P
-000382f0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00038300: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00038310: 2020 2020 2076 6172 6961 626c 6573 203a       variables :
-00038320: 206d 6170 7069 6e67 206f 6620 6861 7368   mapping of hash
-00038330: 6162 6c65 2074 6f20 416e 790a 2020 2020  able to Any.    
-00038340: 2020 2020 2020 2020 4d61 7070 696e 6720          Mapping 
-00038350: 6672 6f6d 2076 6172 6961 626c 6573 206e  from variables n
-00038360: 616d 6573 2074 6f20 7468 6520 6e65 7720  ames to the new 
-00038370: 7661 6c75 6573 2e20 4966 2074 6865 206e  values. If the n
-00038380: 6577 2076 616c 7565 730a 2020 2020 2020  ew values.      
-00038390: 2020 2020 2020 6172 6520 6361 6c6c 6162        are callab
-000383a0: 6c65 2c20 7468 6579 2061 7265 2063 6f6d  le, they are com
-000383b0: 7075 7465 6420 6f6e 2074 6865 2044 6174  puted on the Dat
-000383c0: 6173 6574 2061 6e64 2061 7373 6967 6e65  aset and assigne
-000383d0: 6420 746f 206e 6577 0a20 2020 2020 2020  d to new.       
-000383e0: 2020 2020 2064 6174 6120 7661 7269 6162       data variab
-000383f0: 6c65 732e 2049 6620 7468 6520 7661 6c75  les. If the valu
-00038400: 6573 2061 7265 206e 6f74 2063 616c 6c61  es are not calla
-00038410: 626c 652c 2028 652e 672e 2061 2044 6174  ble, (e.g. a Dat
-00038420: 6141 7272 6179 2c0a 2020 2020 2020 2020  aArray,.        
-00038430: 2020 2020 7363 616c 6172 2c20 6f72 2061      scalar, or a
-00038440: 7272 6179 292c 2074 6865 7920 6172 6520  rray), they are 
-00038450: 7369 6d70 6c79 2061 7373 6967 6e65 642e  simply assigned.
-00038460: 0a20 2020 2020 2020 202a 2a76 6172 6961  .        **varia
-00038470: 626c 6573 5f6b 7761 7267 730a 2020 2020  bles_kwargs.    
-00038480: 2020 2020 2020 2020 5468 6520 6b65 7977          The keyw
-00038490: 6f72 6420 6172 6775 6d65 6e74 7320 666f  ord arguments fo
-000384a0: 726d 206f 6620 6060 7661 7269 6162 6c65  rm of ``variable
-000384b0: 7360 602e 0a20 2020 2020 2020 2020 2020  s``..           
-000384c0: 204f 6e65 206f 6620 7661 7269 6162 6c65   One of variable
-000384d0: 7320 6f72 2076 6172 6961 626c 6573 5f6b  s or variables_k
-000384e0: 7761 7267 7320 6d75 7374 2062 6520 7072  wargs must be pr
-000384f0: 6f76 6964 6564 2e0a 0a20 2020 2020 2020  ovided...       
-00038500: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-00038510: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
-00038520: 2064 7320 3a20 4461 7461 7365 740a 2020   ds : Dataset.  
-00038530: 2020 2020 2020 2020 2020 4120 6e65 7720            A new 
-00038540: 4461 7461 7365 7420 7769 7468 2074 6865  Dataset with the
-00038550: 206e 6577 2076 6172 6961 626c 6573 2069   new variables i
-00038560: 6e20 6164 6469 7469 6f6e 2074 6f20 616c  n addition to al
-00038570: 6c20 7468 650a 2020 2020 2020 2020 2020  l the.          
-00038580: 2020 6578 6973 7469 6e67 2076 6172 6961    existing varia
-00038590: 626c 6573 2e0a 0a20 2020 2020 2020 204e  bles...        N
-000385a0: 6f74 6573 0a20 2020 2020 2020 202d 2d2d  otes.        ---
-000385b0: 2d2d 0a20 2020 2020 2020 2053 696e 6365  --.        Since
-000385c0: 2060 606b 7761 7267 7360 6020 6973 2061   ``kwargs`` is a
-000385d0: 2064 6963 7469 6f6e 6172 792c 2074 6865   dictionary, the
-000385e0: 206f 7264 6572 206f 6620 796f 7572 2061   order of your a
-000385f0: 7267 756d 656e 7473 206d 6179 206e 6f74  rguments may not
-00038600: 0a20 2020 2020 2020 2062 6520 7072 6573  .        be pres
-00038610: 6572 7665 642c 2061 6e64 2073 6f20 7468  erved, and so th
-00038620: 6520 6f72 6465 7220 6f66 2074 6865 206e  e order of the n
-00038630: 6577 2076 6172 6961 626c 6573 2069 7320  ew variables is 
-00038640: 6e6f 7420 7765 6c6c 0a20 2020 2020 2020  not well.       
-00038650: 2064 6566 696e 6564 2e20 4173 7369 676e   defined. Assign
-00038660: 696e 6720 6d75 6c74 6970 6c65 2076 6172  ing multiple var
-00038670: 6961 626c 6573 2077 6974 6869 6e20 7468  iables within th
-00038680: 6520 7361 6d65 2060 6061 7373 6967 6e60  e same ``assign`
-00038690: 6020 6973 0a20 2020 2020 2020 2070 6f73  ` is.        pos
-000386a0: 7369 626c 652c 2062 7574 2079 6f75 2063  sible, but you c
-000386b0: 616e 6e6f 7420 7265 6665 7265 6e63 6520  annot reference 
-000386c0: 6f74 6865 7220 7661 7269 6162 6c65 7320  other variables 
-000386d0: 6372 6561 7465 6420 7769 7468 696e 2074  created within t
-000386e0: 6865 0a20 2020 2020 2020 2073 616d 6520  he.        same 
-000386f0: 6060 6173 7369 676e 6060 2063 616c 6c2e  ``assign`` call.
-00038700: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-00038710: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-00038720: 2d2d 2d0a 2020 2020 2020 2020 7061 6e64  ---.        pand
-00038730: 6173 2e44 6174 6146 7261 6d65 2e61 7373  as.DataFrame.ass
-00038740: 6967 6e0a 0a20 2020 2020 2020 2045 7861  ign..        Exa
-00038750: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-00038760: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-00038770: 3e3e 2078 203d 2078 722e 4461 7461 7365  >> x = xr.Datase
-00038780: 7428 0a20 2020 2020 2020 202e 2e2e 2020  t(.        ...  
-00038790: 2020 207b 0a20 2020 2020 2020 202e 2e2e     {.        ...
-000387a0: 2020 2020 2020 2020 2022 7465 6d70 6572           "temper
-000387b0: 6174 7572 655f 6322 3a20 280a 2020 2020  ature_c": (.    
-000387c0: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-000387d0: 2020 2020 2822 6c61 7422 2c20 226c 6f6e      ("lat", "lon
-000387e0: 2229 2c0a 2020 2020 2020 2020 2e2e 2e20  "),.        ... 
-000387f0: 2020 2020 2020 2020 2020 2020 3230 202a              20 *
-00038800: 206e 702e 7261 6e64 6f6d 2e72 616e 6428   np.random.rand(
-00038810: 3429 2e72 6573 6861 7065 2832 2c20 3229  4).reshape(2, 2)
-00038820: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00038830: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-00038840: 202e 2e2e 2020 2020 2020 2020 2022 7072   ...         "pr
-00038850: 6563 6970 6974 6174 696f 6e22 3a20 2828  ecipitation": ((
-00038860: 226c 6174 222c 2022 6c6f 6e22 292c 206e  "lat", "lon"), n
-00038870: 702e 7261 6e64 6f6d 2e72 616e 6428 3429  p.random.rand(4)
-00038880: 2e72 6573 6861 7065 2832 2c20 3229 292c  .reshape(2, 2)),
-00038890: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-000388a0: 207d 2c0a 2020 2020 2020 2020 2e2e 2e20   },.        ... 
-000388b0: 2020 2020 636f 6f72 6473 3d7b 226c 6174      coords={"lat
-000388c0: 223a 205b 3130 2c20 3230 5d2c 2022 6c6f  ": [10, 20], "lo
-000388d0: 6e22 3a20 5b31 3530 2c20 3136 305d 7d2c  n": [150, 160]},
-000388e0: 0a20 2020 2020 2020 202e 2e2e 2029 0a20  .        ... ). 
-000388f0: 2020 2020 2020 203e 3e3e 2078 0a20 2020         >>> x.   
-00038900: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
-00038910: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
-00038920: 6d65 6e73 696f 6e73 3a20 2020 2020 2020  mensions:       
-00038930: 2028 6c61 743a 2032 2c20 6c6f 6e3a 2032   (lat: 2, lon: 2
-00038940: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
-00038950: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
-00038960: 202a 206c 6174 2020 2020 2020 2020 2020   * lat          
-00038970: 2020 286c 6174 2920 696e 7436 3420 3130    (lat) int64 10
-00038980: 2032 300a 2020 2020 2020 2020 2020 2a20   20.          * 
-00038990: 6c6f 6e20 2020 2020 2020 2020 2020 2028  lon            (
-000389a0: 6c6f 6e29 2069 6e74 3634 2031 3530 2031  lon) int64 150 1
-000389b0: 3630 0a20 2020 2020 2020 2044 6174 6120  60.        Data 
-000389c0: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
-000389d0: 2020 2020 2020 2074 656d 7065 7261 7475         temperatu
-000389e0: 7265 5f63 2020 286c 6174 2c20 6c6f 6e29  re_c  (lat, lon)
-000389f0: 2066 6c6f 6174 3634 2031 302e 3938 2031   float64 10.98 1
-00038a00: 342e 3320 3132 2e30 3620 3130 2e39 0a20  4.3 12.06 10.9. 
-00038a10: 2020 2020 2020 2020 2020 2070 7265 6369             preci
-00038a20: 7069 7461 7469 6f6e 2020 286c 6174 2c20  pitation  (lat, 
-00038a30: 6c6f 6e29 2066 6c6f 6174 3634 2030 2e34  lon) float64 0.4
-00038a40: 3233 3720 302e 3634 3539 2030 2e34 3337  237 0.6459 0.437
-00038a50: 3620 302e 3839 3138 0a0a 2020 2020 2020  6 0.8918..      
-00038a60: 2020 5768 6572 6520 7468 6520 7661 6c75    Where the valu
-00038a70: 6520 6973 2061 2063 616c 6c61 626c 652c  e is a callable,
-00038a80: 2065 7661 6c75 6174 6564 206f 6e20 6461   evaluated on da
-00038a90: 7461 7365 743a 0a0a 2020 2020 2020 2020  taset:..        
-00038aa0: 3e3e 3e20 782e 6173 7369 676e 2874 656d  >>> x.assign(tem
-00038ab0: 7065 7261 7475 7265 5f66 3d6c 616d 6264  perature_f=lambd
-00038ac0: 6120 783a 2078 2e74 656d 7065 7261 7475  a x: x.temperatu
-00038ad0: 7265 5f63 202a 2039 202f 2035 202b 2033  re_c * 9 / 5 + 3
-00038ae0: 3229 0a20 2020 2020 2020 203c 7861 7272  2).        <xarr
-00038af0: 6179 2e44 6174 6173 6574 3e0a 2020 2020  ay.Dataset>.    
-00038b00: 2020 2020 4469 6d65 6e73 696f 6e73 3a20      Dimensions: 
-00038b10: 2020 2020 2020 2028 6c61 743a 2032 2c20         (lat: 2, 
-00038b20: 6c6f 6e3a 2032 290a 2020 2020 2020 2020  lon: 2).        
-00038b30: 436f 6f72 6469 6e61 7465 733a 0a20 2020  Coordinates:.   
-00038b40: 2020 2020 2020 202a 206c 6174 2020 2020         * lat    
-00038b50: 2020 2020 2020 2020 286c 6174 2920 696e          (lat) in
-00038b60: 7436 3420 3130 2032 300a 2020 2020 2020  t64 10 20.      
-00038b70: 2020 2020 2a20 6c6f 6e20 2020 2020 2020      * lon       
-00038b80: 2020 2020 2028 6c6f 6e29 2069 6e74 3634       (lon) int64
-00038b90: 2031 3530 2031 3630 0a20 2020 2020 2020   150 160.       
-00038ba0: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
-00038bb0: 0a20 2020 2020 2020 2020 2020 2074 656d  .            tem
-00038bc0: 7065 7261 7475 7265 5f63 2020 286c 6174  perature_c  (lat
-00038bd0: 2c20 6c6f 6e29 2066 6c6f 6174 3634 2031  , lon) float64 1
-00038be0: 302e 3938 2031 342e 3320 3132 2e30 3620  0.98 14.3 12.06 
-00038bf0: 3130 2e39 0a20 2020 2020 2020 2020 2020  10.9.           
-00038c00: 2070 7265 6369 7069 7461 7469 6f6e 2020   precipitation  
-00038c10: 286c 6174 2c20 6c6f 6e29 2066 6c6f 6174  (lat, lon) float
-00038c20: 3634 2030 2e34 3233 3720 302e 3634 3539  64 0.4237 0.6459
-00038c30: 2030 2e34 3337 3620 302e 3839 3138 0a20   0.4376 0.8918. 
-00038c40: 2020 2020 2020 2020 2020 2074 656d 7065             tempe
-00038c50: 7261 7475 7265 5f66 2020 286c 6174 2c20  rature_f  (lat, 
-00038c60: 6c6f 6e29 2066 6c6f 6174 3634 2035 312e  lon) float64 51.
-00038c70: 3736 2035 372e 3735 2035 332e 3720 3531  76 57.75 53.7 51
-00038c80: 2e36 320a 0a20 2020 2020 2020 2041 6c74  .62..        Alt
-00038c90: 6572 6e61 7469 7665 6c79 2c20 7468 6520  ernatively, the 
-00038ca0: 7361 6d65 2062 6568 6176 696f 7220 6361  same behavior ca
-00038cb0: 6e20 6265 2061 6368 6965 7665 6420 6279  n be achieved by
-00038cc0: 2064 6972 6563 746c 7920 7265 6665 7265   directly refere
-00038cd0: 6e63 696e 6720 616e 2065 7869 7374 696e  ncing an existin
-00038ce0: 6720 6461 7461 6172 7261 793a 0a0a 2020  g dataarray:..  
-00038cf0: 2020 2020 2020 3e3e 3e20 782e 6173 7369        >>> x.assi
-00038d00: 676e 2874 656d 7065 7261 7475 7265 5f66  gn(temperature_f
-00038d10: 3d78 5b22 7465 6d70 6572 6174 7572 655f  =x["temperature_
-00038d20: 6322 5d20 2a20 3920 2f20 3520 2b20 3332  c"] * 9 / 5 + 32
-00038d30: 290a 2020 2020 2020 2020 3c78 6172 7261  ).        <xarra
-00038d40: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
-00038d50: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
-00038d60: 2020 2020 2020 286c 6174 3a20 322c 206c        (lat: 2, l
-00038d70: 6f6e 3a20 3229 0a20 2020 2020 2020 2043  on: 2).        C
-00038d80: 6f6f 7264 696e 6174 6573 3a0a 2020 2020  oordinates:.    
-00038d90: 2020 2020 2020 2a20 6c61 7420 2020 2020        * lat     
-00038da0: 2020 2020 2020 2028 6c61 7429 2069 6e74         (lat) int
-00038db0: 3634 2031 3020 3230 0a20 2020 2020 2020  64 10 20.       
-00038dc0: 2020 202a 206c 6f6e 2020 2020 2020 2020     * lon        
-00038dd0: 2020 2020 286c 6f6e 2920 696e 7436 3420      (lon) int64 
-00038de0: 3135 3020 3136 300a 2020 2020 2020 2020  150 160.        
-00038df0: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
-00038e00: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
-00038e10: 6572 6174 7572 655f 6320 2028 6c61 742c  erature_c  (lat,
-00038e20: 206c 6f6e 2920 666c 6f61 7436 3420 3130   lon) float64 10
-00038e30: 2e39 3820 3134 2e33 2031 322e 3036 2031  .98 14.3 12.06 1
-00038e40: 302e 390a 2020 2020 2020 2020 2020 2020  0.9.            
-00038e50: 7072 6563 6970 6974 6174 696f 6e20 2028  precipitation  (
-00038e60: 6c61 742c 206c 6f6e 2920 666c 6f61 7436  lat, lon) float6
-00038e70: 3420 302e 3432 3337 2030 2e36 3435 3920  4 0.4237 0.6459 
-00038e80: 302e 3433 3736 2030 2e38 3931 380a 2020  0.4376 0.8918.  
-00038e90: 2020 2020 2020 2020 2020 7465 6d70 6572            temper
-00038ea0: 6174 7572 655f 6620 2028 6c61 742c 206c  ature_f  (lat, l
-00038eb0: 6f6e 2920 666c 6f61 7436 3420 3531 2e37  on) float64 51.7
-00038ec0: 3620 3537 2e37 3520 3533 2e37 2035 312e  6 57.75 53.7 51.
-00038ed0: 3632 0a0a 2020 2020 2020 2020 2222 220a  62..        """.
-00038ee0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-00038ef0: 7320 3d20 6569 7468 6572 5f64 6963 745f  s = either_dict_
-00038f00: 6f72 5f6b 7761 7267 7328 7661 7269 6162  or_kwargs(variab
-00038f10: 6c65 732c 2076 6172 6961 626c 6573 5f6b  les, variables_k
-00038f20: 7761 7267 732c 2022 6173 7369 676e 2229  wargs, "assign")
-00038f30: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-00038f40: 7365 6c66 2e63 6f70 7928 290a 2020 2020  self.copy().    
-00038f50: 2020 2020 2320 646f 2061 6c6c 2063 616c      # do all cal
-00038f60: 6375 6c61 7469 6f6e 7320 6669 7273 742e  culations first.
-00038f70: 2e2e 0a20 2020 2020 2020 2072 6573 756c  ...        resul
-00038f80: 7473 3a20 436f 6572 6369 626c 654d 6170  ts: CoercibleMap
-00038f90: 7069 6e67 203d 2064 6174 612e 5f63 616c  ping = data._cal
-00038fa0: 635f 6173 7369 676e 5f72 6573 756c 7473  c_assign_results
-00038fb0: 2876 6172 6961 626c 6573 290a 2020 2020  (variables).    
-00038fc0: 2020 2020 6461 7461 2e63 6f6f 7264 732e      data.coords.
-00038fd0: 5f6d 6179 6265 5f64 726f 705f 6d75 6c74  _maybe_drop_mult
-00038fe0: 6969 6e64 6578 5f63 6f6f 7264 7328 7365  iindex_coords(se
-00038ff0: 7428 7265 7375 6c74 732e 6b65 7973 2829  t(results.keys()
-00039000: 2929 0a20 2020 2020 2020 2023 202e 2e2e  )).        # ...
-00039010: 2061 6e64 2074 6865 6e20 6173 7369 676e   and then assign
-00039020: 0a20 2020 2020 2020 2064 6174 612e 7570  .        data.up
-00039030: 6461 7465 2872 6573 756c 7473 290a 2020  date(results).  
-00039040: 2020 2020 2020 7265 7475 726e 2064 6174        return dat
-00039050: 610a 0a20 2020 2064 6566 2074 6f5f 6172  a..    def to_ar
-00039060: 7261 7928 0a20 2020 2020 2020 2073 656c  ray(.        sel
-00039070: 662c 2064 696d 3a20 4861 7368 6162 6c65  f, dim: Hashable
-00039080: 203d 2022 7661 7269 6162 6c65 222c 206e   = "variable", n
-00039090: 616d 653a 2048 6173 6861 626c 6520 7c20  ame: Hashable | 
-000390a0: 4e6f 6e65 203d 204e 6f6e 650a 2020 2020  None = None.    
-000390b0: 2920 2d3e 2044 6174 6141 7272 6179 3a0a  ) -> DataArray:.
-000390c0: 2020 2020 2020 2020 2222 2243 6f6e 7665          """Conve
-000390d0: 7274 2074 6869 7320 6461 7461 7365 7420  rt this dataset 
-000390e0: 696e 746f 2061 6e20 7861 7272 6179 2e44  into an xarray.D
-000390f0: 6174 6141 7272 6179 0a0a 2020 2020 2020  ataArray..      
-00039100: 2020 5468 6520 6461 7461 2076 6172 6961    The data varia
-00039110: 626c 6573 206f 6620 7468 6973 2064 6174  bles of this dat
-00039120: 6173 6574 2077 696c 6c20 6265 2062 726f  aset will be bro
-00039130: 6164 6361 7374 2061 6761 696e 7374 2065  adcast against e
-00039140: 6163 6820 6f74 6865 720a 2020 2020 2020  ach other.      
-00039150: 2020 616e 6420 7374 6163 6b65 6420 616c    and stacked al
-00039160: 6f6e 6720 7468 6520 6669 7273 7420 6178  ong the first ax
-00039170: 6973 206f 6620 7468 6520 6e65 7720 6172  is of the new ar
-00039180: 7261 792e 2041 6c6c 2063 6f6f 7264 696e  ray. All coordin
-00039190: 6174 6573 206f 660a 2020 2020 2020 2020  ates of.        
-000391a0: 7468 6973 2064 6174 6173 6574 2077 696c  this dataset wil
-000391b0: 6c20 7265 6d61 696e 2063 6f6f 7264 696e  l remain coordin
-000391c0: 6174 6573 2e0a 0a20 2020 2020 2020 2050  ates...        P
-000391d0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-000391e0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-000391f0: 2020 2020 2064 696d 203a 2048 6173 6861       dim : Hasha
-00039200: 626c 652c 2064 6566 6175 6c74 3a20 2276  ble, default: "v
-00039210: 6172 6961 626c 6522 0a20 2020 2020 2020  ariable".       
-00039220: 2020 2020 204e 616d 6520 6f66 2074 6865       Name of the
-00039230: 206e 6577 2064 696d 656e 7369 6f6e 2e0a   new dimension..
-00039240: 2020 2020 2020 2020 6e61 6d65 203a 2048          name : H
-00039250: 6173 6861 626c 6520 6f72 204e 6f6e 652c  ashable or None,
-00039260: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00039270: 2020 2020 2020 4e61 6d65 206f 6620 7468        Name of th
-00039280: 6520 6e65 7720 6461 7461 2061 7272 6179  e new data array
-00039290: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-000392a0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-000392b0: 2d2d 0a20 2020 2020 2020 2061 7272 6179  --.        array
-000392c0: 203a 2078 6172 7261 792e 4461 7461 4172   : xarray.DataAr
-000392d0: 7261 790a 2020 2020 2020 2020 2222 220a  ray.        """.
-000392e0: 2020 2020 2020 2020 6672 6f6d 2078 6172          from xar
-000392f0: 7261 792e 636f 7265 2e64 6174 6161 7272  ray.core.dataarr
-00039300: 6179 2069 6d70 6f72 7420 4461 7461 4172  ay import DataAr
-00039310: 7261 790a 0a20 2020 2020 2020 2064 6174  ray..        dat
-00039320: 615f 7661 7273 203d 205b 7365 6c66 2e76  a_vars = [self.v
-00039330: 6172 6961 626c 6573 5b6b 5d20 666f 7220  ariables[k] for 
-00039340: 6b20 696e 2073 656c 662e 6461 7461 5f76  k in self.data_v
-00039350: 6172 735d 0a20 2020 2020 2020 2062 726f  ars].        bro
-00039360: 6164 6361 7374 5f76 6172 7320 3d20 6272  adcast_vars = br
-00039370: 6f61 6463 6173 745f 7661 7269 6162 6c65  oadcast_variable
-00039380: 7328 2a64 6174 615f 7661 7273 290a 2020  s(*data_vars).  
-00039390: 2020 2020 2020 6461 7461 203d 2064 7563        data = duc
-000393a0: 6b5f 6172 7261 795f 6f70 732e 7374 6163  k_array_ops.stac
-000393b0: 6b28 5b62 2e64 6174 6120 666f 7220 6220  k([b.data for b 
-000393c0: 696e 2062 726f 6164 6361 7374 5f76 6172  in broadcast_var
-000393d0: 735d 2c20 6178 6973 3d30 290a 0a20 2020  s], axis=0)..   
-000393e0: 2020 2020 2064 696d 7320 3d20 2864 696d       dims = (dim
-000393f0: 2c29 202b 2062 726f 6164 6361 7374 5f76  ,) + broadcast_v
-00039400: 6172 735b 305d 2e64 696d 730a 2020 2020  ars[0].dims.    
-00039410: 2020 2020 7661 7269 6162 6c65 203d 2056      variable = V
-00039420: 6172 6961 626c 6528 6469 6d73 2c20 6461  ariable(dims, da
-00039430: 7461 2c20 7365 6c66 2e61 7474 7273 2c20  ta, self.attrs, 
-00039440: 6661 7374 7061 7468 3d54 7275 6529 0a0a  fastpath=True)..
-00039450: 2020 2020 2020 2020 636f 6f72 6473 203d          coords =
-00039460: 207b 6b3a 2076 2e76 6172 6961 626c 6520   {k: v.variable 
-00039470: 666f 7220 6b2c 2076 2069 6e20 7365 6c66  for k, v in self
-00039480: 2e63 6f6f 7264 732e 6974 656d 7328 297d  .coords.items()}
-00039490: 0a20 2020 2020 2020 2069 6e64 6578 6573  .        indexes
-000394a0: 203d 2066 696c 7465 725f 696e 6465 7865   = filter_indexe
-000394b0: 735f 6672 6f6d 5f63 6f6f 7264 7328 7365  s_from_coords(se
-000394c0: 6c66 2e5f 696e 6465 7865 732c 2073 6574  lf._indexes, set
-000394d0: 2863 6f6f 7264 7329 290a 2020 2020 2020  (coords)).      
-000394e0: 2020 6e65 775f 6469 6d5f 696e 6465 7820    new_dim_index 
-000394f0: 3d20 5061 6e64 6173 496e 6465 7828 6c69  = PandasIndex(li
-00039500: 7374 2873 656c 662e 6461 7461 5f76 6172  st(self.data_var
-00039510: 7329 2c20 6469 6d29 0a20 2020 2020 2020  s), dim).       
-00039520: 2069 6e64 6578 6573 5b64 696d 5d20 3d20   indexes[dim] = 
-00039530: 6e65 775f 6469 6d5f 696e 6465 780a 2020  new_dim_index.  
-00039540: 2020 2020 2020 636f 6f72 6473 2e75 7064        coords.upd
-00039550: 6174 6528 6e65 775f 6469 6d5f 696e 6465  ate(new_dim_inde
-00039560: 782e 6372 6561 7465 5f76 6172 6961 626c  x.create_variabl
-00039570: 6573 2829 290a 0a20 2020 2020 2020 2072  es())..        r
-00039580: 6574 7572 6e20 4461 7461 4172 7261 792e  eturn DataArray.
-00039590: 5f63 6f6e 7374 7275 6374 5f64 6972 6563  _construct_direc
-000395a0: 7428 7661 7269 6162 6c65 2c20 636f 6f72  t(variable, coor
-000395b0: 6473 2c20 6e61 6d65 2c20 696e 6465 7865  ds, name, indexe
-000395c0: 7329 0a0a 2020 2020 6465 6620 5f6e 6f72  s)..    def _nor
-000395d0: 6d61 6c69 7a65 5f64 696d 5f6f 7264 6572  malize_dim_order
-000395e0: 280a 2020 2020 2020 2020 7365 6c66 2c20  (.        self, 
-000395f0: 6469 6d5f 6f72 6465 723a 2053 6571 7565  dim_order: Seque
-00039600: 6e63 655b 4861 7368 6162 6c65 5d20 7c20  nce[Hashable] | 
-00039610: 4e6f 6e65 203d 204e 6f6e 650a 2020 2020  None = None.    
-00039620: 2920 2d3e 2064 6963 745b 4861 7368 6162  ) -> dict[Hashab
-00039630: 6c65 2c20 696e 745d 3a0a 2020 2020 2020  le, int]:.      
-00039640: 2020 2222 220a 2020 2020 2020 2020 4368    """.        Ch
-00039650: 6563 6b20 7468 6520 7661 6c69 6469 7479  eck the validity
-00039660: 206f 6620 7468 6520 7072 6f76 6964 6564   of the provided
-00039670: 2064 696d 656e 7369 6f6e 7320 6966 2061   dimensions if a
-00039680: 6e79 2061 6e64 2072 6574 7572 6e20 7468  ny and return th
-00039690: 6520 6d61 7070 696e 670a 2020 2020 2020  e mapping.      
-000396a0: 2020 6265 7477 6565 6e20 6469 6d65 6e73    between dimens
-000396b0: 696f 6e20 6e61 6d65 2061 6e64 2074 6865  ion name and the
-000396c0: 6972 2073 697a 652e 0a0a 2020 2020 2020  ir size...      
-000396d0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-000396e0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-000396f0: 2020 2020 2020 2020 6469 6d5f 6f72 6465          dim_orde
-00039700: 723a 2053 6571 7565 6e63 6520 6f66 2048  r: Sequence of H
-00039710: 6173 6861 626c 6520 6f72 204e 6f6e 652c  ashable or None,
-00039720: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00039730: 2020 2020 2020 4469 6d65 6e73 696f 6e20        Dimension 
-00039740: 6f72 6465 7220 746f 2076 616c 6964 6174  order to validat
-00039750: 6520 2864 6566 6175 6c74 2074 6f20 7468  e (default to th
-00039760: 6520 616c 7068 6162 6574 6963 616c 206f  e alphabetical o
-00039770: 7264 6572 2069 6620 4e6f 6e65 292e 0a0a  rder if None)...
-00039780: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-00039790: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-000397a0: 2020 2020 2020 2020 7265 7375 6c74 203a          result :
-000397b0: 2064 6963 745b 4861 7368 6162 6c65 2c20   dict[Hashable, 
-000397c0: 696e 745d 0a20 2020 2020 2020 2020 2020  int].           
-000397d0: 2056 616c 6964 6174 6564 2064 696d 656e   Validated dimen
-000397e0: 7369 6f6e 7320 6d61 7070 696e 672e 0a0a  sions mapping...
-000397f0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00039800: 2020 2020 6966 2064 696d 5f6f 7264 6572      if dim_order
-00039810: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00039820: 2020 2020 2020 6469 6d5f 6f72 6465 7220        dim_order 
-00039830: 3d20 6c69 7374 2873 656c 662e 6469 6d73  = list(self.dims
-00039840: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
-00039850: 6574 2864 696d 5f6f 7264 6572 2920 213d  et(dim_order) !=
-00039860: 2073 6574 2873 656c 662e 6469 6d73 293a   set(self.dims):
-00039870: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00039880: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-00039890: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-000398a0: 6469 6d5f 6f72 6465 7220 7b7d 2064 6f65  dim_order {} doe
-000398b0: 7320 6e6f 7420 6d61 7463 6820 7468 6520  s not match the 
-000398c0: 7365 7420 6f66 2064 696d 656e 7369 6f6e  set of dimension
-000398d0: 7320 6f66 2074 6869 7320 220a 2020 2020  s of this ".    
-000398e0: 2020 2020 2020 2020 2020 2020 2244 6174              "Dat
-000398f0: 6173 6574 3a20 7b7d 222e 666f 726d 6174  aset: {}".format
-00039900: 2864 696d 5f6f 7264 6572 2c20 6c69 7374  (dim_order, list
-00039910: 2873 656c 662e 6469 6d73 2929 0a20 2020  (self.dims)).   
-00039920: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00039930: 2020 2020 6f72 6465 7265 645f 6469 6d73      ordered_dims
-00039940: 203d 207b 6b3a 2073 656c 662e 6469 6d73   = {k: self.dims
-00039950: 5b6b 5d20 666f 7220 6b20 696e 2064 696d  [k] for k in dim
-00039960: 5f6f 7264 6572 7d0a 0a20 2020 2020 2020  _order}..       
-00039970: 2072 6574 7572 6e20 6f72 6465 7265 645f   return ordered_
-00039980: 6469 6d73 0a0a 2020 2020 6465 6620 746f  dims..    def to
-00039990: 5f70 616e 6461 7328 7365 6c66 2920 2d3e  _pandas(self) ->
-000399a0: 2070 642e 5365 7269 6573 207c 2070 642e   pd.Series | pd.
-000399b0: 4461 7461 4672 616d 653a 0a20 2020 2020  DataFrame:.     
-000399c0: 2020 2022 2222 436f 6e76 6572 7420 7468     """Convert th
-000399d0: 6973 2064 6174 6173 6574 2069 6e74 6f20  is dataset into 
-000399e0: 6120 7061 6e64 6173 206f 626a 6563 7420  a pandas object 
-000399f0: 7769 7468 6f75 7420 6368 616e 6769 6e67  without changing
-00039a00: 2074 6865 206e 756d 6265 7220 6f66 2064   the number of d
-00039a10: 696d 656e 7369 6f6e 732e 0a0a 2020 2020  imensions...    
-00039a20: 2020 2020 5468 6520 7479 7065 206f 6620      The type of 
-00039a30: 7468 6520 7265 7475 726e 6564 206f 626a  the returned obj
-00039a40: 6563 7420 6465 7065 6e64 7320 6f6e 2074  ect depends on t
-00039a50: 6865 206e 756d 6265 7220 6f66 2044 6174  he number of Dat
-00039a60: 6173 6574 0a20 2020 2020 2020 2064 696d  aset.        dim
-00039a70: 656e 7369 6f6e 733a 0a0a 2020 2020 2020  ensions:..      
-00039a80: 2020 2a20 3044 202d 3e20 6070 616e 6461    * 0D -> `panda
-00039a90: 732e 5365 7269 6573 600a 2020 2020 2020  s.Series`.      
-00039aa0: 2020 2a20 3144 202d 3e20 6070 616e 6461    * 1D -> `panda
-00039ab0: 732e 4461 7461 4672 616d 6560 0a0a 2020  s.DataFrame`..  
-00039ac0: 2020 2020 2020 4f6e 6c79 2077 6f72 6b73        Only works
-00039ad0: 2066 6f72 2044 6174 6173 6574 7320 7769   for Datasets wi
-00039ae0: 7468 2031 206f 7220 6665 7765 7220 6469  th 1 or fewer di
-00039af0: 6d65 6e73 696f 6e73 2e0a 2020 2020 2020  mensions..      
-00039b00: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00039b10: 206c 656e 2873 656c 662e 6469 6d73 2920   len(self.dims) 
-00039b20: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
-00039b30: 2020 7265 7475 726e 2070 642e 5365 7269    return pd.Seri
-00039b40: 6573 287b 6b3a 2076 2e69 7465 6d28 2920  es({k: v.item() 
-00039b50: 666f 7220 6b2c 2076 2069 6e20 7365 6c66  for k, v in self
-00039b60: 2e69 7465 6d73 2829 7d29 0a20 2020 2020  .items()}).     
-00039b70: 2020 2069 6620 6c65 6e28 7365 6c66 2e64     if len(self.d
-00039b80: 696d 7329 203d 3d20 313a 0a20 2020 2020  ims) == 1:.     
-00039b90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00039ba0: 6c66 2e74 6f5f 6461 7461 6672 616d 6528  lf.to_dataframe(
-00039bb0: 290a 2020 2020 2020 2020 7261 6973 6520  ).        raise 
-00039bc0: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
-00039bd0: 2020 2020 2020 2020 2263 616e 6e6f 7420          "cannot 
-00039be0: 636f 6e76 6572 7420 4461 7461 7365 7473  convert Datasets
-00039bf0: 2077 6974 6820 2573 2064 696d 656e 7369   with %s dimensi
-00039c00: 6f6e 7320 696e 746f 2022 0a20 2020 2020  ons into ".     
-00039c10: 2020 2020 2020 2022 7061 6e64 6173 206f         "pandas o
-00039c20: 626a 6563 7473 2077 6974 686f 7574 2063  bjects without c
-00039c30: 6861 6e67 696e 6720 7468 6520 6e75 6d62  hanging the numb
-00039c40: 6572 206f 6620 6469 6d65 6e73 696f 6e73  er of dimensions
-00039c50: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-00039c60: 2250 6c65 6173 6520 7573 6520 4461 7461  "Please use Data
-00039c70: 7365 742e 746f 5f64 6174 6166 7261 6d65  set.to_dataframe
-00039c80: 2829 2069 6e73 7465 6164 2e22 2025 206c  () instead." % l
-00039c90: 656e 2873 656c 662e 6469 6d73 290a 2020  en(self.dims).  
-00039ca0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-00039cb0: 205f 746f 5f64 6174 6166 7261 6d65 2873   _to_dataframe(s
-00039cc0: 656c 662c 206f 7264 6572 6564 5f64 696d  elf, ordered_dim
-00039cd0: 733a 204d 6170 7069 6e67 5b41 6e79 2c20  s: Mapping[Any, 
-00039ce0: 696e 745d 293a 0a20 2020 2020 2020 2063  int]):.        c
-00039cf0: 6f6c 756d 6e73 203d 205b 6b20 666f 7220  olumns = [k for 
-00039d00: 6b20 696e 2073 656c 662e 7661 7269 6162  k in self.variab
-00039d10: 6c65 7320 6966 206b 206e 6f74 2069 6e20  les if k not in 
-00039d20: 7365 6c66 2e64 696d 735d 0a20 2020 2020  self.dims].     
-00039d30: 2020 2064 6174 6120 3d20 5b0a 2020 2020     data = [.    
-00039d40: 2020 2020 2020 2020 7365 6c66 2e5f 7661          self._va
-00039d50: 7269 6162 6c65 735b 6b5d 2e73 6574 5f64  riables[k].set_d
-00039d60: 696d 7328 6f72 6465 7265 645f 6469 6d73  ims(ordered_dims
-00039d70: 292e 7661 6c75 6573 2e72 6573 6861 7065  ).values.reshape
-00039d80: 282d 3129 0a20 2020 2020 2020 2020 2020  (-1).           
-00039d90: 2066 6f72 206b 2069 6e20 636f 6c75 6d6e   for k in column
-00039da0: 730a 2020 2020 2020 2020 5d0a 2020 2020  s.        ].    
-00039db0: 2020 2020 696e 6465 7820 3d20 7365 6c66      index = self
-00039dc0: 2e63 6f6f 7264 732e 746f 5f69 6e64 6578  .coords.to_index
-00039dd0: 285b 2a6f 7264 6572 6564 5f64 696d 735d  ([*ordered_dims]
-00039de0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00039df0: 2070 642e 4461 7461 4672 616d 6528 6469   pd.DataFrame(di
-00039e00: 6374 287a 6970 2863 6f6c 756d 6e73 2c20  ct(zip(columns, 
-00039e10: 6461 7461 2929 2c20 696e 6465 783d 696e  data)), index=in
-00039e20: 6465 7829 0a0a 2020 2020 6465 6620 746f  dex)..    def to
-00039e30: 5f64 6174 6166 7261 6d65 2873 656c 662c  _dataframe(self,
-00039e40: 2064 696d 5f6f 7264 6572 3a20 5365 7175   dim_order: Sequ
-00039e50: 656e 6365 5b48 6173 6861 626c 655d 207c  ence[Hashable] |
-00039e60: 204e 6f6e 6520 3d20 4e6f 6e65 2920 2d3e   None = None) ->
-00039e70: 2070 642e 4461 7461 4672 616d 653a 0a20   pd.DataFrame:. 
-00039e80: 2020 2020 2020 2022 2222 436f 6e76 6572         """Conver
-00039e90: 7420 7468 6973 2064 6174 6173 6574 2069  t this dataset i
-00039ea0: 6e74 6f20 6120 7061 6e64 6173 2e44 6174  nto a pandas.Dat
-00039eb0: 6146 7261 6d65 2e0a 0a20 2020 2020 2020  aFrame...       
-00039ec0: 204e 6f6e 2d69 6e64 6578 2076 6172 6961   Non-index varia
-00039ed0: 626c 6573 2069 6e20 7468 6973 2064 6174  bles in this dat
-00039ee0: 6173 6574 2066 6f72 6d20 7468 6520 636f  aset form the co
-00039ef0: 6c75 6d6e 7320 6f66 2074 6865 0a20 2020  lumns of the.   
-00039f00: 2020 2020 2044 6174 6146 7261 6d65 2e20       DataFrame. 
-00039f10: 5468 6520 4461 7461 4672 616d 6520 6973  The DataFrame is
-00039f20: 2069 6e64 6578 6564 2062 7920 7468 6520   indexed by the 
-00039f30: 4361 7274 6573 6961 6e20 7072 6f64 7563  Cartesian produc
-00039f40: 7420 6f66 0a20 2020 2020 2020 2074 6869  t of.        thi
-00039f50: 7320 6461 7461 7365 7427 7320 696e 6469  s dataset's indi
-00039f60: 6365 732e 0a0a 2020 2020 2020 2020 5061  ces...        Pa
-00039f70: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00039f80: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00039f90: 2020 2020 6469 6d5f 6f72 6465 723a 2053      dim_order: S
-00039fa0: 6571 7565 6e63 6520 6f66 2048 6173 6861  equence of Hasha
-00039fb0: 626c 6520 6f72 204e 6f6e 652c 206f 7074  ble or None, opt
-00039fc0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-00039fd0: 2020 4869 6572 6172 6368 6963 616c 2064    Hierarchical d
-00039fe0: 696d 656e 7369 6f6e 206f 7264 6572 2066  imension order f
-00039ff0: 6f72 2074 6865 2072 6573 756c 7469 6e67  or the resulting
-0003a000: 2064 6174 6166 7261 6d65 2e20 416c 6c0a   dataframe. All.
-0003a010: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-0003a020: 7973 2061 7265 2074 7261 6e73 706f 7365  ys are transpose
-0003a030: 6420 746f 2074 6869 7320 6f72 6465 7220  d to this order 
-0003a040: 616e 6420 7468 656e 2077 7269 7474 656e  and then written
-0003a050: 206f 7574 2061 7320 666c 6174 0a20 2020   out as flat.   
-0003a060: 2020 2020 2020 2020 2076 6563 746f 7273           vectors
-0003a070: 2069 6e20 636f 6e74 6967 756f 7573 206f   in contiguous o
-0003a080: 7264 6572 2c20 736f 2074 6865 206c 6173  rder, so the las
-0003a090: 7420 6469 6d65 6e73 696f 6e20 696e 2074  t dimension in t
-0003a0a0: 6869 7320 6c69 7374 0a20 2020 2020 2020  his list.       
-0003a0b0: 2020 2020 2077 696c 6c20 6265 2063 6f6e       will be con
-0003a0c0: 7469 6775 6f75 7320 696e 2074 6865 2072  tiguous in the r
-0003a0d0: 6573 756c 7469 6e67 2044 6174 6146 7261  esulting DataFra
-0003a0e0: 6d65 2e20 5468 6973 2068 6173 2061 206d  me. This has a m
-0003a0f0: 616a 6f72 0a20 2020 2020 2020 2020 2020  ajor.           
-0003a100: 2069 6e66 6c75 656e 6365 206f 6e20 7768   influence on wh
-0003a110: 6963 6820 6f70 6572 6174 696f 6e73 2061  ich operations a
-0003a120: 7265 2065 6666 6963 6965 6e74 206f 6e20  re efficient on 
-0003a130: 7468 6520 7265 7375 6c74 696e 670a 2020  the resulting.  
-0003a140: 2020 2020 2020 2020 2020 6461 7461 6672            datafr
-0003a150: 616d 652e 0a0a 2020 2020 2020 2020 2020  ame...          
-0003a160: 2020 4966 2070 726f 7669 6465 642c 206d    If provided, m
-0003a170: 7573 7420 696e 636c 7564 6520 616c 6c20  ust include all 
-0003a180: 6469 6d65 6e73 696f 6e73 206f 6620 7468  dimensions of th
-0003a190: 6973 2064 6174 6173 6574 2e20 4279 0a20  is dataset. By. 
-0003a1a0: 2020 2020 2020 2020 2020 2064 6566 6175             defau
-0003a1b0: 6c74 2c20 6469 6d65 6e73 696f 6e73 2061  lt, dimensions a
-0003a1c0: 7265 2073 6f72 7465 6420 616c 7068 6162  re sorted alphab
-0003a1d0: 6574 6963 616c 6c79 2e0a 0a20 2020 2020  etically...     
-0003a1e0: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
-0003a1f0: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
-0003a200: 2020 2072 6573 756c 7420 3a20 4461 7461     result : Data
-0003a210: 4672 616d 650a 2020 2020 2020 2020 2020  Frame.          
-0003a220: 2020 4461 7461 7365 7420 6173 2061 2070    Dataset as a p
-0003a230: 616e 6461 7320 4461 7461 4672 616d 652e  andas DataFrame.
-0003a240: 0a0a 2020 2020 2020 2020 2222 220a 0a20  ..        """.. 
-0003a250: 2020 2020 2020 206f 7264 6572 6564 5f64         ordered_d
-0003a260: 696d 7320 3d20 7365 6c66 2e5f 6e6f 726d  ims = self._norm
-0003a270: 616c 697a 655f 6469 6d5f 6f72 6465 7228  alize_dim_order(
-0003a280: 6469 6d5f 6f72 6465 723d 6469 6d5f 6f72  dim_order=dim_or
-0003a290: 6465 7229 0a0a 2020 2020 2020 2020 7265  der)..        re
-0003a2a0: 7475 726e 2073 656c 662e 5f74 6f5f 6461  turn self._to_da
-0003a2b0: 7461 6672 616d 6528 6f72 6465 7265 645f  taframe(ordered_
-0003a2c0: 6469 6d73 3d6f 7264 6572 6564 5f64 696d  dims=ordered_dim
-0003a2d0: 7329 0a0a 2020 2020 6465 6620 5f73 6574  s)..    def _set
-0003a2e0: 5f73 7061 7273 655f 6461 7461 5f66 726f  _sparse_data_fro
-0003a2f0: 6d5f 6461 7461 6672 616d 6528 0a20 2020  m_dataframe(.   
-0003a300: 2020 2020 2073 656c 662c 2069 6478 3a20       self, idx: 
-0003a310: 7064 2e49 6e64 6578 2c20 6172 7261 7973  pd.Index, arrays
-0003a320: 3a20 6c69 7374 5b74 7570 6c65 5b48 6173  : list[tuple[Has
-0003a330: 6861 626c 652c 206e 702e 6e64 6172 7261  hable, np.ndarra
-0003a340: 795d 5d2c 2064 696d 733a 2074 7570 6c65  y]], dims: tuple
-0003a350: 0a20 2020 2029 202d 3e20 4e6f 6e65 3a0a  .    ) -> None:.
-0003a360: 2020 2020 2020 2020 6672 6f6d 2073 7061          from spa
-0003a370: 7273 6520 696d 706f 7274 2043 4f4f 0a0a  rse import COO..
-0003a380: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0003a390: 7461 6e63 6528 6964 782c 2070 642e 4d75  tance(idx, pd.Mu
-0003a3a0: 6c74 6949 6e64 6578 293a 0a20 2020 2020  ltiIndex):.     
-0003a3b0: 2020 2020 2020 2063 6f6f 7264 7320 3d20         coords = 
-0003a3c0: 6e70 2e73 7461 636b 285b 6e70 2e61 7361  np.stack([np.asa
-0003a3d0: 7272 6179 2863 6f64 6529 2066 6f72 2063  rray(code) for c
-0003a3e0: 6f64 6520 696e 2069 6478 2e63 6f64 6573  ode in idx.codes
-0003a3f0: 5d2c 2061 7869 733d 3029 0a20 2020 2020  ], axis=0).     
-0003a400: 2020 2020 2020 2069 735f 736f 7274 6564         is_sorted
-0003a410: 203d 2069 6478 2e69 735f 6d6f 6e6f 746f   = idx.is_monoto
-0003a420: 6e69 635f 696e 6372 6561 7369 6e67 0a20  nic_increasing. 
-0003a430: 2020 2020 2020 2020 2020 2073 6861 7065             shape
-0003a440: 203d 2074 7570 6c65 286c 6576 2e73 697a   = tuple(lev.siz
-0003a450: 6520 666f 7220 6c65 7620 696e 2069 6478  e for lev in idx
-0003a460: 2e6c 6576 656c 7329 0a20 2020 2020 2020  .levels).       
-0003a470: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0003a480: 2020 2063 6f6f 7264 7320 3d20 6e70 2e61     coords = np.a
-0003a490: 7261 6e67 6528 6964 782e 7369 7a65 292e  range(idx.size).
-0003a4a0: 7265 7368 6170 6528 312c 202d 3129 0a20  reshape(1, -1). 
-0003a4b0: 2020 2020 2020 2020 2020 2069 735f 736f             is_so
-0003a4c0: 7274 6564 203d 2054 7275 650a 2020 2020  rted = True.    
-0003a4d0: 2020 2020 2020 2020 7368 6170 6520 3d20          shape = 
-0003a4e0: 2869 6478 2e73 697a 652c 290a 0a20 2020  (idx.size,)..   
-0003a4f0: 2020 2020 2066 6f72 206e 616d 652c 2076       for name, v
-0003a500: 616c 7565 7320 696e 2061 7272 6179 733a  alues in arrays:
-0003a510: 0a20 2020 2020 2020 2020 2020 2023 2049  .            # I
-0003a520: 6e20 7669 7274 7561 6c6c 7920 616c 6c20  n virtually all 
-0003a530: 7265 616c 2075 7365 2063 6173 6573 2c20  real use cases, 
-0003a540: 7468 6520 7370 6172 7365 2061 7272 6179  the sparse array
-0003a550: 2077 696c 6c20 6e6f 7720 6861 7665 0a20   will now have. 
-0003a560: 2020 2020 2020 2020 2020 2023 206d 6973             # mis
-0003a570: 7369 6e67 2076 616c 7565 7320 616e 6420  sing values and 
-0003a580: 6e65 6564 7320 6120 6669 6c6c 5f76 616c  needs a fill_val
-0003a590: 7565 2e20 466f 7220 636f 6e73 6973 7465  ue. For consiste
-0003a5a0: 6e63 792c 2064 6f6e 2774 0a20 2020 2020  ncy, don't.     
-0003a5b0: 2020 2020 2020 2023 2073 7065 6369 616c         # special
-0003a5c0: 2063 6173 6520 7468 6520 7261 7265 2065   case the rare e
-0003a5d0: 7863 6570 7469 6f6e 7320 2865 2e67 2e2c  xceptions (e.g.,
-0003a5e0: 2064 7479 7065 3d69 6e74 2077 6974 686f   dtype=int witho
-0003a5f0: 7574 2061 0a20 2020 2020 2020 2020 2020  ut a.           
-0003a600: 2023 204d 756c 7469 496e 6465 7829 2e0a   # MultiIndex)..
-0003a610: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
-0003a620: 652c 2066 696c 6c5f 7661 6c75 6520 3d20  e, fill_value = 
-0003a630: 7872 6474 7970 6573 2e6d 6179 6265 5f70  xrdtypes.maybe_p
-0003a640: 726f 6d6f 7465 2876 616c 7565 732e 6474  romote(values.dt
-0003a650: 7970 6529 0a20 2020 2020 2020 2020 2020  ype).           
-0003a660: 2076 616c 7565 7320 3d20 6e70 2e61 7361   values = np.asa
-0003a670: 7272 6179 2876 616c 7565 732c 2064 7479  rray(values, dty
-0003a680: 7065 3d64 7479 7065 290a 0a20 2020 2020  pe=dtype)..     
-0003a690: 2020 2020 2020 2064 6174 6120 3d20 434f         data = CO
-0003a6a0: 4f28 0a20 2020 2020 2020 2020 2020 2020  O(.             
-0003a6b0: 2020 2063 6f6f 7264 732c 0a20 2020 2020     coords,.     
-0003a6c0: 2020 2020 2020 2020 2020 2076 616c 7565             value
-0003a6d0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
-0003a6e0: 2020 2073 6861 7065 2c0a 2020 2020 2020     shape,.      
-0003a6f0: 2020 2020 2020 2020 2020 6861 735f 6475            has_du
-0003a700: 706c 6963 6174 6573 3d46 616c 7365 2c0a  plicates=False,.
-0003a710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a720: 736f 7274 6564 3d69 735f 736f 7274 6564  sorted=is_sorted
-0003a730: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0003a740: 2020 6669 6c6c 5f76 616c 7565 3d66 696c    fill_value=fil
-0003a750: 6c5f 7661 6c75 652c 0a20 2020 2020 2020  l_value,.       
-0003a760: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-0003a770: 2020 2073 656c 665b 6e61 6d65 5d20 3d20     self[name] = 
-0003a780: 2864 696d 732c 2064 6174 6129 0a0a 2020  (dims, data)..  
-0003a790: 2020 6465 6620 5f73 6574 5f6e 756d 7079    def _set_numpy
-0003a7a0: 5f64 6174 615f 6672 6f6d 5f64 6174 6166  _data_from_dataf
-0003a7b0: 7261 6d65 280a 2020 2020 2020 2020 7365  rame(.        se
-0003a7c0: 6c66 2c20 6964 783a 2070 642e 496e 6465  lf, idx: pd.Inde
-0003a7d0: 782c 2061 7272 6179 733a 206c 6973 745b  x, arrays: list[
-0003a7e0: 7475 706c 655b 4861 7368 6162 6c65 2c20  tuple[Hashable, 
-0003a7f0: 6e70 2e6e 6461 7272 6179 5d5d 2c20 6469  np.ndarray]], di
-0003a800: 6d73 3a20 7475 706c 650a 2020 2020 2920  ms: tuple.    ) 
-0003a810: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
-0003a820: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
-0003a830: 6365 2869 6478 2c20 7064 2e4d 756c 7469  ce(idx, pd.Multi
-0003a840: 496e 6465 7829 3a0a 2020 2020 2020 2020  Index):.        
-0003a850: 2020 2020 666f 7220 6e61 6d65 2c20 7661      for name, va
-0003a860: 6c75 6573 2069 6e20 6172 7261 7973 3a0a  lues in arrays:.
-0003a870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003a880: 7365 6c66 5b6e 616d 655d 203d 2028 6469  self[name] = (di
-0003a890: 6d73 2c20 7661 6c75 6573 290a 2020 2020  ms, values).    
-0003a8a0: 2020 2020 2020 2020 7265 7475 726e 0a0a          return..
-0003a8b0: 2020 2020 2020 2020 2320 4e42 3a20 7369          # NB: si
-0003a8c0: 6d69 6c61 722c 206d 6f72 6520 6765 6e65  milar, more gene
-0003a8d0: 7261 6c20 6c6f 6769 632c 206e 6f77 2065  ral logic, now e
-0003a8e0: 7869 7374 7320 696e 0a20 2020 2020 2020  xists in.       
-0003a8f0: 2023 2076 6172 6961 626c 652e 756e 7374   # variable.unst
-0003a900: 6163 6b5f 6f6e 6365 3b20 7765 2063 6f75  ack_once; we cou
-0003a910: 6c64 2063 6f6e 7369 6465 7220 636f 6d62  ld consider comb
-0003a920: 696e 696e 6720 7468 656d 2061 7420 736f  ining them at so
-0003a930: 6d65 0a20 2020 2020 2020 2023 2070 6f69  me.        # poi
-0003a940: 6e74 2e0a 0a20 2020 2020 2020 2073 6861  nt...        sha
-0003a950: 7065 203d 2074 7570 6c65 286c 6576 2e73  pe = tuple(lev.s
-0003a960: 697a 6520 666f 7220 6c65 7620 696e 2069  ize for lev in i
-0003a970: 6478 2e6c 6576 656c 7329 0a20 2020 2020  dx.levels).     
-0003a980: 2020 2069 6e64 6578 6572 203d 2074 7570     indexer = tup
-0003a990: 6c65 2869 6478 2e63 6f64 6573 290a 0a20  le(idx.codes).. 
-0003a9a0: 2020 2020 2020 2023 2057 6520 616c 7265         # We alre
-0003a9b0: 6164 7920 7665 7269 6669 6564 2074 6861  ady verified tha
-0003a9c0: 7420 7468 6520 4d75 6c74 6949 6e64 6578  t the MultiIndex
-0003a9d0: 2068 6173 2061 6c6c 2075 6e69 7175 6520   has all unique 
-0003a9e0: 7661 6c75 6573 2c20 736f 0a20 2020 2020  values, so.     
-0003a9f0: 2020 2023 2074 6865 7265 2061 7265 206d     # there are m
-0003aa00: 6973 7369 6e67 2076 616c 7565 7320 6966  issing values if
-0003aa10: 2061 6e64 206f 6e6c 7920 6966 2074 6865   and only if the
-0003aa20: 2073 697a 6520 6f66 206f 7574 7075 7420   size of output 
-0003aa30: 6172 7261 7973 2069 730a 2020 2020 2020  arrays is.      
-0003aa40: 2020 2320 6c61 7267 6572 2074 6861 7420    # larger that 
-0003aa50: 7468 6520 696e 6465 782e 0a20 2020 2020  the index..     
-0003aa60: 2020 206d 6973 7369 6e67 5f76 616c 7565     missing_value
-0003aa70: 7320 3d20 6d61 7468 2e70 726f 6428 7368  s = math.prod(sh
-0003aa80: 6170 6529 203e 2069 6478 2e73 6861 7065  ape) > idx.shape
-0003aa90: 5b30 5d0a 0a20 2020 2020 2020 2066 6f72  [0]..        for
-0003aaa0: 206e 616d 652c 2076 616c 7565 7320 696e   name, values in
-0003aab0: 2061 7272 6179 733a 0a20 2020 2020 2020   arrays:.       
-0003aac0: 2020 2020 2023 204e 756d 5079 2069 6e64       # NumPy ind
-0003aad0: 6578 696e 6720 6973 206d 7563 6820 6661  exing is much fa
-0003aae0: 7374 6572 2074 6861 6e20 7573 696e 6720  ster than using 
-0003aaf0: 4461 7461 4672 616d 652e 7265 696e 6465  DataFrame.reinde
-0003ab00: 7828 2920 746f 0a20 2020 2020 2020 2020  x() to.         
-0003ab10: 2020 2023 2066 696c 6c20 696e 206d 6973     # fill in mis
-0003ab20: 7369 6e67 2076 616c 7565 733a 0a20 2020  sing values:.   
-0003ab30: 2020 2020 2020 2020 2023 2068 7474 7073           # https
-0003ab40: 3a2f 2f73 7461 636b 6f76 6572 666c 6f77  ://stackoverflow
-0003ab50: 2e63 6f6d 2f61 2f33 3530 3439 3839 392f  .com/a/35049899/
-0003ab60: 3830 3937 3035 0a20 2020 2020 2020 2020  809705.         
-0003ab70: 2020 2069 6620 6d69 7373 696e 675f 7661     if missing_va
-0003ab80: 6c75 6573 3a0a 2020 2020 2020 2020 2020  lues:.          
-0003ab90: 2020 2020 2020 6474 7970 652c 2066 696c        dtype, fil
-0003aba0: 6c5f 7661 6c75 6520 3d20 7872 6474 7970  l_value = xrdtyp
-0003abb0: 6573 2e6d 6179 6265 5f70 726f 6d6f 7465  es.maybe_promote
-0003abc0: 2876 616c 7565 732e 6474 7970 6529 0a20  (values.dtype). 
-0003abd0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0003abe0: 6174 6120 3d20 6e70 2e66 756c 6c28 7368  ata = np.full(sh
-0003abf0: 6170 652c 2066 696c 6c5f 7661 6c75 652c  ape, fill_value,
-0003ac00: 2064 7479 7065 290a 2020 2020 2020 2020   dtype).        
-0003ac10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003ac20: 2020 2020 2020 2020 2020 2320 4966 2074            # If t
-0003ac30: 6865 7265 2061 7265 206e 6f20 6d69 7373  here are no miss
-0003ac40: 696e 6720 7661 6c75 6573 2c20 6b65 6570  ing values, keep
-0003ac50: 2074 6865 2065 7869 7374 696e 6720 6474   the existing dt
-0003ac60: 7970 650a 2020 2020 2020 2020 2020 2020  ype.            
-0003ac70: 2020 2020 2320 696e 7374 6561 6420 6f66      # instead of
-0003ac80: 2070 726f 6d6f 7469 6e67 2074 6f20 7375   promoting to su
-0003ac90: 7070 6f72 7420 4e41 2c20 652e 672e 2c20  pport NA, e.g., 
-0003aca0: 6b65 6570 2069 6e74 6567 6572 0a20 2020  keep integer.   
-0003acb0: 2020 2020 2020 2020 2020 2020 2023 2063               # c
-0003acc0: 6f6c 756d 6e73 2061 7320 696e 7465 6765  olumns as intege
-0003acd0: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
-0003ace0: 2020 2020 2320 544f 444f 3a20 636f 6e73      # TODO: cons
-0003acf0: 6964 6572 2072 656d 6f76 696e 6720 7468  ider removing th
-0003ad00: 6973 2073 7065 6369 616c 2063 6173 652c  is special case,
-0003ad10: 2077 6869 6368 2064 6f65 736e 2774 0a20   which doesn't. 
-0003ad20: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0003ad30: 2065 7869 7374 2066 6f72 2073 7061 7273   exist for spars
-0003ad40: 653d 5472 7565 2e0a 2020 2020 2020 2020  e=True..        
-0003ad50: 2020 2020 2020 2020 6461 7461 203d 206e          data = n
-0003ad60: 702e 7a65 726f 7328 7368 6170 652c 2076  p.zeros(shape, v
-0003ad70: 616c 7565 732e 6474 7970 6529 0a20 2020  alues.dtype).   
-0003ad80: 2020 2020 2020 2020 2064 6174 615b 696e           data[in
-0003ad90: 6465 7865 725d 203d 2076 616c 7565 730a  dexer] = values.
-0003ada0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0003adb0: 5b6e 616d 655d 203d 2028 6469 6d73 2c20  [name] = (dims, 
-0003adc0: 6461 7461 290a 0a20 2020 2040 636c 6173  data)..    @clas
-0003add0: 736d 6574 686f 640a 2020 2020 6465 6620  smethod.    def 
-0003ade0: 6672 6f6d 5f64 6174 6166 7261 6d65 280a  from_dataframe(.
-0003adf0: 2020 2020 2020 2020 636c 733a 2074 7970          cls: typ
-0003ae00: 655b 545f 4461 7461 7365 745d 2c20 6461  e[T_Dataset], da
-0003ae10: 7461 6672 616d 653a 2070 642e 4461 7461  taframe: pd.Data
-0003ae20: 4672 616d 652c 2073 7061 7273 653a 2062  Frame, sparse: b
-0003ae30: 6f6f 6c20 3d20 4661 6c73 650a 2020 2020  ool = False.    
-0003ae40: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
-0003ae50: 2020 2020 2020 2020 2222 2243 6f6e 7665          """Conve
-0003ae60: 7274 2061 2070 616e 6461 732e 4461 7461  rt a pandas.Data
-0003ae70: 4672 616d 6520 696e 746f 2061 6e20 7861  Frame into an xa
-0003ae80: 7272 6179 2e44 6174 6173 6574 0a0a 2020  rray.Dataset..  
-0003ae90: 2020 2020 2020 4561 6368 2063 6f6c 756d        Each colum
-0003aea0: 6e20 7769 6c6c 2062 6520 636f 6e76 6572  n will be conver
-0003aeb0: 7465 6420 696e 746f 2061 6e20 696e 6465  ted into an inde
-0003aec0: 7065 6e64 656e 7420 7661 7269 6162 6c65  pendent variable
-0003aed0: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
-0003aee0: 4461 7461 7365 742e 2049 6620 7468 6520  Dataset. If the 
-0003aef0: 6461 7461 6672 616d 6527 7320 696e 6465  dataframe's inde
-0003af00: 7820 6973 2061 204d 756c 7469 496e 6465  x is a MultiInde
-0003af10: 782c 2069 7420 7769 6c6c 2062 6520 6578  x, it will be ex
-0003af20: 7061 6e64 6564 0a20 2020 2020 2020 2069  panded.        i
-0003af30: 6e74 6f20 6120 7465 6e73 6f72 2070 726f  nto a tensor pro
-0003af40: 6475 6374 206f 6620 6f6e 652d 6469 6d65  duct of one-dime
-0003af50: 6e73 696f 6e61 6c20 696e 6469 6365 7320  nsional indices 
-0003af60: 2866 696c 6c69 6e67 2069 6e20 6d69 7373  (filling in miss
-0003af70: 696e 670a 2020 2020 2020 2020 7661 6c75  ing.        valu
-0003af80: 6573 2077 6974 6820 4e61 4e29 2e20 5468  es with NaN). Th
-0003af90: 6973 206d 6574 686f 6420 7769 6c6c 2070  is method will p
-0003afa0: 726f 6475 6365 2061 2044 6174 6173 6574  roduce a Dataset
-0003afb0: 2076 6572 7920 7369 6d69 6c61 7220 746f   very similar to
-0003afc0: 0a20 2020 2020 2020 2074 6861 7420 6f6e  .        that on
-0003afd0: 2077 6869 6368 2074 6865 2027 746f 5f64   which the 'to_d
-0003afe0: 6174 6166 7261 6d65 2720 6d65 7468 6f64  ataframe' method
-0003aff0: 2077 6173 2063 616c 6c65 642c 2065 7863   was called, exc
-0003b000: 6570 7420 7769 7468 0a20 2020 2020 2020  ept with.       
-0003b010: 2070 6f73 7369 626c 7920 7265 6475 6e64   possibly redund
-0003b020: 616e 7420 6469 6d65 6e73 696f 6e73 2028  ant dimensions (
-0003b030: 7369 6e63 6520 616c 6c20 6461 7461 7365  since all datase
-0003b040: 7420 7661 7269 6162 6c65 7320 7769 6c6c  t variables will
-0003b050: 2068 6176 650a 2020 2020 2020 2020 7468   have.        th
-0003b060: 6520 7361 6d65 2064 696d 656e 7369 6f6e  e same dimension
-0003b070: 616c 6974 7929 0a0a 2020 2020 2020 2020  ality)..        
-0003b080: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-0003b090: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-0003b0a0: 2020 2020 2020 6461 7461 6672 616d 6520        dataframe 
-0003b0b0: 3a20 4461 7461 4672 616d 650a 2020 2020  : DataFrame.    
-0003b0c0: 2020 2020 2020 2020 4461 7461 4672 616d          DataFram
-0003b0d0: 6520 6672 6f6d 2077 6869 6368 2074 6f20  e from which to 
-0003b0e0: 636f 7079 2064 6174 6120 616e 6420 696e  copy data and in
-0003b0f0: 6469 6365 732e 0a20 2020 2020 2020 2073  dices..        s
-0003b100: 7061 7273 6520 3a20 626f 6f6c 2c20 6465  parse : bool, de
-0003b110: 6661 756c 743a 2046 616c 7365 0a20 2020  fault: False.   
-0003b120: 2020 2020 2020 2020 2049 6620 7472 7565           If true
-0003b130: 2c20 6372 6561 7465 2061 2073 7061 7273  , create a spars
-0003b140: 6520 6172 7261 7973 2069 6e73 7465 6164  e arrays instead
-0003b150: 206f 6620 6465 6e73 6520 6e75 6d70 7920   of dense numpy 
-0003b160: 6172 7261 7973 2e20 5468 6973 0a20 2020  arrays. This.   
-0003b170: 2020 2020 2020 2020 2063 616e 2070 6f74           can pot
-0003b180: 656e 7469 616c 6c79 2073 6176 6520 6120  entially save a 
-0003b190: 6c61 7267 6520 616d 6f75 6e74 206f 6620  large amount of 
-0003b1a0: 6d65 6d6f 7279 2069 6620 7468 6520 4461  memory if the Da
-0003b1b0: 7461 4672 616d 6520 6861 730a 2020 2020  taFrame has.    
-0003b1c0: 2020 2020 2020 2020 6120 4d75 6c74 6949          a MultiI
-0003b1d0: 6e64 6578 2e20 5265 7175 6972 6573 2074  ndex. Requires t
-0003b1e0: 6865 2073 7061 7273 6520 7061 636b 6167  he sparse packag
-0003b1f0: 6520 2873 7061 7273 652e 7079 6461 7461  e (sparse.pydata
-0003b200: 2e6f 7267 292e 0a0a 2020 2020 2020 2020  .org)...        
-0003b210: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0003b220: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0003b230: 4e65 7720 4461 7461 7365 742e 0a0a 2020  New Dataset...  
-0003b240: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-0003b250: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-0003b260: 2020 2020 2020 2020 7861 7272 6179 2e44          xarray.D
-0003b270: 6174 6141 7272 6179 2e66 726f 6d5f 7365  ataArray.from_se
-0003b280: 7269 6573 0a20 2020 2020 2020 2070 616e  ries.        pan
-0003b290: 6461 732e 4461 7461 4672 616d 652e 746f  das.DataFrame.to
-0003b2a0: 5f78 6172 7261 790a 2020 2020 2020 2020  _xarray.        
-0003b2b0: 2222 220a 2020 2020 2020 2020 2320 544f  """.        # TO
-0003b2c0: 444f 3a20 4164 6420 616e 206f 7074 696f  DO: Add an optio
-0003b2d0: 6e20 746f 2072 656d 6f76 6520 6469 6d65  n to remove dime
-0003b2e0: 6e73 696f 6e73 2061 6c6f 6e67 2077 6869  nsions along whi
-0003b2f0: 6368 2074 6865 2076 6172 6961 626c 6573  ch the variables
-0003b300: 0a20 2020 2020 2020 2023 2061 7265 2063  .        # are c
-0003b310: 6f6e 7374 616e 742c 2074 6f20 656e 6162  onstant, to enab
-0003b320: 6c65 2063 6f6e 7369 7374 656e 7420 7365  le consistent se
-0003b330: 7269 616c 697a 6174 696f 6e20 746f 2f66  rialization to/f
-0003b340: 726f 6d20 6120 6461 7461 6672 616d 652c  rom a dataframe,
-0003b350: 0a20 2020 2020 2020 2023 2065 7665 6e20  .        # even 
-0003b360: 6966 2073 6f6d 6520 7661 7269 6162 6c65  if some variable
-0003b370: 7320 6861 7665 2064 6966 6665 7265 6e74  s have different
-0003b380: 2064 696d 656e 7369 6f6e 616c 6974 792e   dimensionality.
-0003b390: 0a0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0003b3a0: 2064 6174 6166 7261 6d65 2e63 6f6c 756d   dataframe.colum
-0003b3b0: 6e73 2e69 735f 756e 6971 7565 3a0a 2020  ns.is_unique:.  
-0003b3c0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0003b3d0: 5661 6c75 6545 7272 6f72 2822 6361 6e6e  ValueError("cann
-0003b3e0: 6f74 2063 6f6e 7665 7274 2044 6174 6146  ot convert DataF
-0003b3f0: 7261 6d65 2077 6974 6820 6e6f 6e2d 756e  rame with non-un
-0003b400: 6971 7565 2063 6f6c 756d 6e73 2229 0a0a  ique columns")..
-0003b410: 2020 2020 2020 2020 6964 7820 3d20 7265          idx = re
-0003b420: 6d6f 7665 5f75 6e75 7365 645f 6c65 7665  move_unused_leve
-0003b430: 6c73 5f63 6174 6567 6f72 6965 7328 6461  ls_categories(da
-0003b440: 7461 6672 616d 652e 696e 6465 7829 0a0a  taframe.index)..
-0003b450: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0003b460: 7461 6e63 6528 6964 782c 2070 642e 4d75  tance(idx, pd.Mu
-0003b470: 6c74 6949 6e64 6578 2920 616e 6420 6e6f  ltiIndex) and no
-0003b480: 7420 6964 782e 6973 5f75 6e69 7175 653a  t idx.is_unique:
-0003b490: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0003b4a0: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0003b4b0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003b4c0: 6361 6e6e 6f74 2063 6f6e 7665 7274 2061  cannot convert a
-0003b4d0: 2044 6174 6146 7261 6d65 2077 6974 6820   DataFrame with 
-0003b4e0: 6120 6e6f 6e2d 756e 6971 7565 204d 756c  a non-unique Mul
-0003b4f0: 7469 496e 6465 7820 696e 746f 2078 6172  tiIndex into xar
-0003b500: 7261 7922 0a20 2020 2020 2020 2020 2020  ray".           
-0003b510: 2029 0a0a 2020 2020 2020 2020 2320 4361   )..        # Ca
-0003b520: 7374 2074 6f20 6120 4e75 6d50 7920 6172  st to a NumPy ar
-0003b530: 7261 7920 6669 7273 742c 2069 6e20 6361  ray first, in ca
-0003b540: 7365 2074 6865 2053 6572 6965 7320 6973  se the Series is
-0003b550: 2061 2070 616e 6461 7320 4578 7465 6e73   a pandas Extens
-0003b560: 696f 6e0a 2020 2020 2020 2020 2320 6172  ion.        # ar
-0003b570: 7261 7920 2877 6869 6368 2064 6f65 736e  ray (which doesn
-0003b580: 2774 2068 6176 6520 6120 7661 6c69 6420  't have a valid 
-0003b590: 4e75 6d50 7920 6474 7970 6529 0a20 2020  NumPy dtype).   
-0003b5a0: 2020 2020 2023 2054 4f44 4f3a 2061 6c6c       # TODO: all
-0003b5b0: 6f77 2075 7365 7273 2074 6f20 636f 6e74  ow users to cont
-0003b5c0: 726f 6c20 686f 7720 7468 6973 2063 6173  rol how this cas
-0003b5d0: 7469 6e67 2068 6170 7065 6e73 2c20 652e  ting happens, e.
-0003b5e0: 672e 2c20 6279 0a20 2020 2020 2020 2023  g., by.        #
-0003b5f0: 2066 6f72 7761 7264 696e 6720 6172 6775   forwarding argu
-0003b600: 6d65 6e74 7320 746f 2070 616e 6461 732e  ments to pandas.
-0003b610: 5365 7269 6573 2e74 6f5f 6e75 6d70 793f  Series.to_numpy?
-0003b620: 0a20 2020 2020 2020 2061 7272 6179 7320  .        arrays 
-0003b630: 3d20 5b28 6b2c 206e 702e 6173 6172 7261  = [(k, np.asarra
-0003b640: 7928 7629 2920 666f 7220 6b2c 2076 2069  y(v)) for k, v i
-0003b650: 6e20 6461 7461 6672 616d 652e 6974 656d  n dataframe.item
-0003b660: 7328 295d 0a0a 2020 2020 2020 2020 696e  s()]..        in
-0003b670: 6465 7865 733a 2064 6963 745b 4861 7368  dexes: dict[Hash
-0003b680: 6162 6c65 2c20 496e 6465 785d 203d 207b  able, Index] = {
-0003b690: 7d0a 2020 2020 2020 2020 696e 6465 785f  }.        index_
-0003b6a0: 7661 7273 3a20 6469 6374 5b48 6173 6861  vars: dict[Hasha
-0003b6b0: 626c 652c 2056 6172 6961 626c 655d 203d  ble, Variable] =
-0003b6c0: 207b 7d0a 0a20 2020 2020 2020 2069 6620   {}..        if 
-0003b6d0: 6973 696e 7374 616e 6365 2869 6478 2c20  isinstance(idx, 
-0003b6e0: 7064 2e4d 756c 7469 496e 6465 7829 3a0a  pd.MultiIndex):.
-0003b6f0: 2020 2020 2020 2020 2020 2020 6469 6d73              dims
-0003b700: 203d 2074 7570 6c65 280a 2020 2020 2020   = tuple(.      
-0003b710: 2020 2020 2020 2020 2020 6e61 6d65 2069            name i
-0003b720: 6620 6e61 6d65 2069 7320 6e6f 7420 4e6f  f name is not No
-0003b730: 6e65 2065 6c73 6520 226c 6576 656c 5f25  ne else "level_%
-0003b740: 6922 2025 206e 0a20 2020 2020 2020 2020  i" % n.         
-0003b750: 2020 2020 2020 2066 6f72 206e 2c20 6e61         for n, na
-0003b760: 6d65 2069 6e20 656e 756d 6572 6174 6528  me in enumerate(
-0003b770: 6964 782e 6e61 6d65 7329 0a20 2020 2020  idx.names).     
-0003b780: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0003b790: 2020 2020 2066 6f72 2064 696d 2c20 6c65       for dim, le
-0003b7a0: 7620 696e 207a 6970 2864 696d 732c 2069  v in zip(dims, i
-0003b7b0: 6478 2e6c 6576 656c 7329 3a0a 2020 2020  dx.levels):.    
-0003b7c0: 2020 2020 2020 2020 2020 2020 7872 5f69              xr_i
-0003b7d0: 6478 203d 2050 616e 6461 7349 6e64 6578  dx = PandasIndex
-0003b7e0: 286c 6576 2c20 6469 6d29 0a20 2020 2020  (lev, dim).     
-0003b7f0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-0003b800: 6573 5b64 696d 5d20 3d20 7872 5f69 6478  es[dim] = xr_idx
-0003b810: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003b820: 2069 6e64 6578 5f76 6172 732e 7570 6461   index_vars.upda
-0003b830: 7465 2878 725f 6964 782e 6372 6561 7465  te(xr_idx.create
-0003b840: 5f76 6172 6961 626c 6573 2829 290a 2020  _variables()).  
-0003b850: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0003b860: 2020 2020 2020 2020 696e 6465 785f 6e61          index_na
-0003b870: 6d65 203d 2069 6478 2e6e 616d 6520 6966  me = idx.name if
-0003b880: 2069 6478 2e6e 616d 6520 6973 206e 6f74   idx.name is not
-0003b890: 204e 6f6e 6520 656c 7365 2022 696e 6465   None else "inde
-0003b8a0: 7822 0a20 2020 2020 2020 2020 2020 2064  x".            d
-0003b8b0: 696d 7320 3d20 2869 6e64 6578 5f6e 616d  ims = (index_nam
-0003b8c0: 652c 290a 2020 2020 2020 2020 2020 2020  e,).            
-0003b8d0: 7872 5f69 6478 203d 2050 616e 6461 7349  xr_idx = PandasI
-0003b8e0: 6e64 6578 2869 6478 2c20 696e 6465 785f  ndex(idx, index_
-0003b8f0: 6e61 6d65 290a 2020 2020 2020 2020 2020  name).          
-0003b900: 2020 696e 6465 7865 735b 696e 6465 785f    indexes[index_
-0003b910: 6e61 6d65 5d20 3d20 7872 5f69 6478 0a20  name] = xr_idx. 
+0002ca90: 6669 6c6c 5f76 616c 7565 5f20 3d20 6669  fill_value_ = fi
+0002caa0: 6c6c 5f76 616c 7565 0a0a 2020 2020 2020  ll_value..      
+0002cab0: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0002cac0: 7269 6162 6c65 735b 6e61 6d65 5d20 3d20  riables[name] = 
+0002cad0: 7661 722e 5f75 6e73 7461 636b 5f6f 6e63  var._unstack_onc
+0002cae0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+0002caf0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
+0002cb00: 3d63 6c65 616e 5f69 6e64 6578 2c0a 2020  =clean_index,.  
+0002cb10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb20: 2020 2020 2020 6469 6d3d 6469 6d2c 0a20        dim=dim,. 
+0002cb30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb40: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
+0002cb50: 653d 6669 6c6c 5f76 616c 7565 5f2c 0a20  e=fill_value_,. 
+0002cb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002cb70: 2020 2020 2020 2073 7061 7273 653d 7370         sparse=sp
+0002cb80: 6172 7365 2c0a 2020 2020 2020 2020 2020  arse,.          
+0002cb90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0002cba0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0002cbb0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0002cbc0: 2020 2020 2020 7661 7269 6162 6c65 735b        variables[
+0002cbd0: 6e61 6d65 5d20 3d20 7661 720a 0a20 2020  name] = var..   
+0002cbe0: 2020 2020 2063 6f6f 7264 5f6e 616d 6573       coord_names
+0002cbf0: 203d 2073 6574 2873 656c 662e 5f63 6f6f   = set(self._coo
+0002cc00: 7264 5f6e 616d 6573 2920 2d20 7b64 696d  rd_names) - {dim
+0002cc10: 7d20 7c20 7365 7428 6e65 775f 696e 6465  } | set(new_inde
+0002cc20: 7865 7329 0a0a 2020 2020 2020 2020 7265  xes)..        re
+0002cc30: 7475 726e 2073 656c 662e 5f72 6570 6c61  turn self._repla
+0002cc40: 6365 5f77 6974 685f 6e65 775f 6469 6d73  ce_with_new_dims
+0002cc50: 280a 2020 2020 2020 2020 2020 2020 7661  (.            va
+0002cc60: 7269 6162 6c65 732c 2063 6f6f 7264 5f6e  riables, coord_n
+0002cc70: 616d 6573 3d63 6f6f 7264 5f6e 616d 6573  ames=coord_names
+0002cc80: 2c20 696e 6465 7865 733d 696e 6465 7865  , indexes=indexe
+0002cc90: 730a 2020 2020 2020 2020 290a 0a20 2020  s.        )..   
+0002cca0: 2064 6566 205f 756e 7374 6163 6b5f 6675   def _unstack_fu
+0002ccb0: 6c6c 5f72 6569 6e64 6578 280a 2020 2020  ll_reindex(.    
+0002ccc0: 2020 2020 7365 6c66 3a20 545f 4461 7461      self: T_Data
+0002ccd0: 7365 742c 0a20 2020 2020 2020 2064 696d  set,.        dim
+0002cce0: 3a20 4861 7368 6162 6c65 2c0a 2020 2020  : Hashable,.    
+0002ccf0: 2020 2020 696e 6465 785f 616e 645f 7661      index_and_va
+0002cd00: 7273 3a20 7475 706c 655b 496e 6465 782c  rs: tuple[Index,
+0002cd10: 2064 6963 745b 4861 7368 6162 6c65 2c20   dict[Hashable, 
+0002cd20: 5661 7269 6162 6c65 5d5d 2c0a 2020 2020  Variable]],.    
+0002cd30: 2020 2020 6669 6c6c 5f76 616c 7565 2c0a      fill_value,.
+0002cd40: 2020 2020 2020 2020 7370 6172 7365 3a20          sparse: 
+0002cd50: 626f 6f6c 2c0a 2020 2020 2920 2d3e 2054  bool,.    ) -> T
+0002cd60: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
+0002cd70: 2020 696e 6465 782c 2069 6e64 6578 5f76    index, index_v
+0002cd80: 6172 7320 3d20 696e 6465 785f 616e 645f  ars = index_and_
+0002cd90: 7661 7273 0a20 2020 2020 2020 2076 6172  vars.        var
+0002cda0: 6961 626c 6573 3a20 6469 6374 5b48 6173  iables: dict[Has
+0002cdb0: 6861 626c 652c 2056 6172 6961 626c 655d  hable, Variable]
+0002cdc0: 203d 207b 7d0a 2020 2020 2020 2020 696e   = {}.        in
+0002cdd0: 6465 7865 7320 3d20 7b6b 3a20 7620 666f  dexes = {k: v fo
+0002cde0: 7220 6b2c 2076 2069 6e20 7365 6c66 2e5f  r k, v in self._
+0002cdf0: 696e 6465 7865 732e 6974 656d 7328 2920  indexes.items() 
+0002ce00: 6966 206b 2021 3d20 6469 6d7d 0a0a 2020  if k != dim}..  
+0002ce10: 2020 2020 2020 6e65 775f 696e 6465 7865        new_indexe
+0002ce20: 732c 2063 6c65 616e 5f69 6e64 6578 203d  s, clean_index =
+0002ce30: 2069 6e64 6578 2e75 6e73 7461 636b 2829   index.unstack()
+0002ce40: 0a20 2020 2020 2020 2069 6e64 6578 6573  .        indexes
+0002ce50: 2e75 7064 6174 6528 6e65 775f 696e 6465  .update(new_inde
+0002ce60: 7865 7329 0a0a 2020 2020 2020 2020 6e65  xes)..        ne
+0002ce70: 775f 696e 6465 785f 7661 7269 6162 6c65  w_index_variable
+0002ce80: 7320 3d20 7b7d 0a20 2020 2020 2020 2066  s = {}.        f
+0002ce90: 6f72 206e 616d 652c 2069 6478 2069 6e20  or name, idx in 
+0002cea0: 6e65 775f 696e 6465 7865 732e 6974 656d  new_indexes.item
+0002ceb0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+0002cec0: 206e 6577 5f69 6e64 6578 5f76 6172 6961   new_index_varia
+0002ced0: 626c 6573 2e75 7064 6174 6528 6964 782e  bles.update(idx.
+0002cee0: 6372 6561 7465 5f76 6172 6961 626c 6573  create_variables
+0002cef0: 2869 6e64 6578 5f76 6172 7329 290a 0a20  (index_vars)).. 
+0002cf00: 2020 2020 2020 206e 6577 5f64 696d 5f73         new_dim_s
+0002cf10: 697a 6573 203d 207b 6b3a 2076 2e73 697a  izes = {k: v.siz
+0002cf20: 6520 666f 7220 6b2c 2076 2069 6e20 6e65  e for k, v in ne
+0002cf30: 775f 696e 6465 785f 7661 7269 6162 6c65  w_index_variable
+0002cf40: 732e 6974 656d 7328 297d 0a20 2020 2020  s.items()}.     
+0002cf50: 2020 2076 6172 6961 626c 6573 2e75 7064     variables.upd
+0002cf60: 6174 6528 6e65 775f 696e 6465 785f 7661  ate(new_index_va
+0002cf70: 7269 6162 6c65 7329 0a0a 2020 2020 2020  riables)..      
+0002cf80: 2020 2320 7461 6b65 2061 2073 686f 7274    # take a short
+0002cf90: 6375 7420 696e 2063 6173 6520 7468 6520  cut in case the 
+0002cfa0: 4d75 6c74 6949 6e64 6578 2077 6173 206e  MultiIndex was n
+0002cfb0: 6f74 206d 6f64 6966 6965 642e 0a20 2020  ot modified..   
+0002cfc0: 2020 2020 2066 756c 6c5f 6964 7820 3d20       full_idx = 
+0002cfd0: 7064 2e4d 756c 7469 496e 6465 782e 6672  pd.MultiIndex.fr
+0002cfe0: 6f6d 5f70 726f 6475 6374 280a 2020 2020  om_product(.    
+0002cff0: 2020 2020 2020 2020 636c 6561 6e5f 696e          clean_in
+0002d000: 6465 782e 6c65 7665 6c73 2c20 6e61 6d65  dex.levels, name
+0002d010: 733d 636c 6561 6e5f 696e 6465 782e 6e61  s=clean_index.na
+0002d020: 6d65 730a 2020 2020 2020 2020 290a 2020  mes.        ).  
+0002d030: 2020 2020 2020 6966 2063 6c65 616e 5f69        if clean_i
+0002d040: 6e64 6578 2e65 7175 616c 7328 6675 6c6c  ndex.equals(full
+0002d050: 5f69 6478 293a 0a20 2020 2020 2020 2020  _idx):.         
+0002d060: 2020 206f 626a 203d 2073 656c 660a 2020     obj = self.  
+0002d070: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0002d080: 2020 2020 2020 2020 2320 544f 444f 3a20          # TODO: 
+0002d090: 7765 206d 6179 2064 6570 7265 6369 6174  we may depreciat
+0002d0a0: 6520 696d 706c 6963 6974 2072 652d 696e  e implicit re-in
+0002d0b0: 6465 7869 6e67 2077 6974 6820 6120 7061  dexing with a pa
+0002d0c0: 6e64 6173 2e4d 756c 7469 496e 6465 780a  ndas.MultiIndex.
+0002d0d0: 2020 2020 2020 2020 2020 2020 7872 5f66              xr_f
+0002d0e0: 756c 6c5f 6964 7820 3d20 5061 6e64 6173  ull_idx = Pandas
+0002d0f0: 4d75 6c74 6949 6e64 6578 2866 756c 6c5f  MultiIndex(full_
+0002d100: 6964 782c 2064 696d 290a 2020 2020 2020  idx, dim).      
+0002d110: 2020 2020 2020 696e 6465 7865 7273 203d        indexers =
+0002d120: 2049 6e64 6578 6573 280a 2020 2020 2020   Indexes(.      
+0002d130: 2020 2020 2020 2020 2020 7b6b 3a20 7872            {k: xr
+0002d140: 5f66 756c 6c5f 6964 7820 666f 7220 6b20  _full_idx for k 
+0002d150: 696e 2069 6e64 6578 5f76 6172 737d 2c0a  in index_vars},.
+0002d160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d170: 7872 5f66 756c 6c5f 6964 782e 6372 6561  xr_full_idx.crea
+0002d180: 7465 5f76 6172 6961 626c 6573 2869 6e64  te_variables(ind
+0002d190: 6578 5f76 6172 7329 2c0a 2020 2020 2020  ex_vars),.      
+0002d1a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0002d1b0: 2020 2020 6f62 6a20 3d20 7365 6c66 2e5f      obj = self._
+0002d1c0: 7265 696e 6465 7828 0a20 2020 2020 2020  reindex(.       
+0002d1d0: 2020 2020 2020 2020 2069 6e64 6578 6572           indexer
+0002d1e0: 732c 2063 6f70 793d 4661 6c73 652c 2066  s, copy=False, f
+0002d1f0: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
+0002d200: 616c 7565 2c20 7370 6172 7365 3d73 7061  alue, sparse=spa
+0002d210: 7273 650a 2020 2020 2020 2020 2020 2020  rse.            
+0002d220: 290a 0a20 2020 2020 2020 2066 6f72 206e  )..        for n
+0002d230: 616d 652c 2076 6172 2069 6e20 6f62 6a2e  ame, var in obj.
+0002d240: 7661 7269 6162 6c65 732e 6974 656d 7328  variables.items(
+0002d250: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0002d260: 6620 6e61 6d65 206e 6f74 2069 6e20 696e  f name not in in
+0002d270: 6465 785f 7661 7273 3a0a 2020 2020 2020  dex_vars:.      
+0002d280: 2020 2020 2020 2020 2020 6966 2064 696d            if dim
+0002d290: 2069 6e20 7661 722e 6469 6d73 3a0a 2020   in var.dims:.  
+0002d2a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d2b0: 2020 7661 7269 6162 6c65 735b 6e61 6d65    variables[name
+0002d2c0: 5d20 3d20 7661 722e 756e 7374 6163 6b28  ] = var.unstack(
+0002d2d0: 7b64 696d 3a20 6e65 775f 6469 6d5f 7369  {dim: new_dim_si
+0002d2e0: 7a65 737d 290a 2020 2020 2020 2020 2020  zes}).          
+0002d2f0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0002d300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d310: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
+0002d320: 3d20 7661 720a 0a20 2020 2020 2020 2063  = var..        c
+0002d330: 6f6f 7264 5f6e 616d 6573 203d 2073 6574  oord_names = set
+0002d340: 2873 656c 662e 5f63 6f6f 7264 5f6e 616d  (self._coord_nam
+0002d350: 6573 2920 2d20 7b64 696d 7d20 7c20 7365  es) - {dim} | se
+0002d360: 7428 6e65 775f 6469 6d5f 7369 7a65 7329  t(new_dim_sizes)
+0002d370: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0002d380: 2073 656c 662e 5f72 6570 6c61 6365 5f77   self._replace_w
+0002d390: 6974 685f 6e65 775f 6469 6d73 280a 2020  ith_new_dims(.  
+0002d3a0: 2020 2020 2020 2020 2020 7661 7269 6162            variab
+0002d3b0: 6c65 732c 2063 6f6f 7264 5f6e 616d 6573  les, coord_names
+0002d3c0: 3d63 6f6f 7264 5f6e 616d 6573 2c20 696e  =coord_names, in
+0002d3d0: 6465 7865 733d 696e 6465 7865 730a 2020  dexes=indexes.  
+0002d3e0: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0002d3f0: 2075 6e73 7461 636b 280a 2020 2020 2020   unstack(.      
+0002d400: 2020 7365 6c66 3a20 545f 4461 7461 7365    self: T_Datase
+0002d410: 742c 0a20 2020 2020 2020 2064 696d 3a20  t,.        dim: 
+0002d420: 4469 6d73 203d 204e 6f6e 652c 0a20 2020  Dims = None,.   
+0002d430: 2020 2020 2066 696c 6c5f 7661 6c75 653a       fill_value:
+0002d440: 2041 6e79 203d 2078 7264 7479 7065 732e   Any = xrdtypes.
+0002d450: 4e41 2c0a 2020 2020 2020 2020 7370 6172  NA,.        spar
+0002d460: 7365 3a20 626f 6f6c 203d 2046 616c 7365  se: bool = False
+0002d470: 2c0a 2020 2020 2920 2d3e 2054 5f44 6174  ,.    ) -> T_Dat
+0002d480: 6173 6574 3a0a 2020 2020 2020 2020 2222  aset:.        ""
+0002d490: 220a 2020 2020 2020 2020 556e 7374 6163  ".        Unstac
+0002d4a0: 6b20 6578 6973 7469 6e67 2064 696d 656e  k existing dimen
+0002d4b0: 7369 6f6e 7320 636f 7272 6573 706f 6e64  sions correspond
+0002d4c0: 696e 6720 746f 204d 756c 7469 496e 6465  ing to MultiInde
+0002d4d0: 7865 7320 696e 746f 0a20 2020 2020 2020  xes into.       
+0002d4e0: 206d 756c 7469 706c 6520 6e65 7720 6469   multiple new di
+0002d4f0: 6d65 6e73 696f 6e73 2e0a 0a20 2020 2020  mensions...     
+0002d500: 2020 204e 6577 2064 696d 656e 7369 6f6e     New dimension
+0002d510: 7320 7769 6c6c 2062 6520 6164 6465 6420  s will be added 
+0002d520: 6174 2074 6865 2065 6e64 2e0a 0a20 2020  at the end...   
+0002d530: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0002d540: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002d550: 2d2d 0a20 2020 2020 2020 2064 696d 203a  --.        dim :
+0002d560: 2073 7472 2c20 4974 6572 6162 6c65 206f   str, Iterable o
+0002d570: 6620 4861 7368 6162 6c65 206f 7220 4e6f  f Hashable or No
+0002d580: 6e65 2c20 6f70 7469 6f6e 616c 0a20 2020  ne, optional.   
+0002d590: 2020 2020 2020 2020 2044 696d 656e 7369           Dimensi
+0002d5a0: 6f6e 2873 2920 6f76 6572 2077 6869 6368  on(s) over which
+0002d5b0: 2074 6f20 756e 7374 6163 6b2e 2042 7920   to unstack. By 
+0002d5c0: 6465 6661 756c 7420 756e 7374 6163 6b73  default unstacks
+0002d5d0: 2061 6c6c 0a20 2020 2020 2020 2020 2020   all.           
+0002d5e0: 204d 756c 7469 496e 6465 7865 732e 0a20   MultiIndexes.. 
+0002d5f0: 2020 2020 2020 2066 696c 6c5f 7661 6c75         fill_valu
+0002d600: 6520 3a20 7363 616c 6172 206f 7220 6469  e : scalar or di
+0002d610: 6374 2d6c 696b 652c 2064 6566 6175 6c74  ct-like, default
+0002d620: 3a20 6e61 6e0a 2020 2020 2020 2020 2020  : nan.          
+0002d630: 2020 7661 6c75 6520 746f 2062 6520 6669    value to be fi
+0002d640: 6c6c 6564 2e20 4966 2061 2064 6963 742d  lled. If a dict-
+0002d650: 6c69 6b65 2c20 6d61 7073 2076 6172 6961  like, maps varia
+0002d660: 626c 6520 6e61 6d65 7320 746f 0a20 2020  ble names to.   
+0002d670: 2020 2020 2020 2020 2066 696c 6c20 7661           fill va
+0002d680: 6c75 6573 2e20 4966 206e 6f74 2070 726f  lues. If not pro
+0002d690: 7669 6465 6420 6f72 2069 6620 7468 6520  vided or if the 
+0002d6a0: 6469 6374 2d6c 696b 6520 646f 6573 206e  dict-like does n
+0002d6b0: 6f74 0a20 2020 2020 2020 2020 2020 2063  ot.            c
+0002d6c0: 6f6e 7461 696e 2061 6c6c 2076 6172 6961  ontain all varia
+0002d6d0: 626c 6573 2c20 7468 6520 6474 7970 6527  bles, the dtype'
+0002d6e0: 7320 4e41 2076 616c 7565 2077 696c 6c20  s NA value will 
+0002d6f0: 6265 2075 7365 642e 0a20 2020 2020 2020  be used..       
+0002d700: 2073 7061 7273 6520 3a20 626f 6f6c 2c20   sparse : bool, 
+0002d710: 6465 6661 756c 743a 2046 616c 7365 0a20  default: False. 
+0002d720: 2020 2020 2020 2020 2020 2075 7365 2073             use s
+0002d730: 7061 7273 652d 6172 7261 7920 6966 2054  parse-array if T
+0002d740: 7275 650a 0a20 2020 2020 2020 2052 6574  rue..        Ret
+0002d750: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+0002d760: 2d2d 2d2d 0a20 2020 2020 2020 2075 6e73  ----.        uns
+0002d770: 7461 636b 6564 203a 2044 6174 6173 6574  tacked : Dataset
+0002d780: 0a20 2020 2020 2020 2020 2020 2044 6174  .            Dat
+0002d790: 6173 6574 2077 6974 6820 756e 7374 6163  aset with unstac
+0002d7a0: 6b65 6420 6461 7461 2e0a 0a20 2020 2020  ked data...     
+0002d7b0: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
+0002d7c0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+0002d7d0: 2020 2020 2044 6174 6173 6574 2e73 7461       Dataset.sta
+0002d7e0: 636b 0a20 2020 2020 2020 2022 2222 0a0a  ck.        """..
+0002d7f0: 2020 2020 2020 2020 6966 2064 696d 2069          if dim i
+0002d800: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0002d810: 2020 2020 6469 6d73 203d 206c 6973 7428      dims = list(
+0002d820: 7365 6c66 2e64 696d 7329 0a20 2020 2020  self.dims).     
+0002d830: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0002d840: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+0002d850: 6365 2864 696d 2c20 7374 7229 206f 7220  ce(dim, str) or 
+0002d860: 6e6f 7420 6973 696e 7374 616e 6365 2864  not isinstance(d
+0002d870: 696d 2c20 4974 6572 6162 6c65 293a 0a20  im, Iterable):. 
+0002d880: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+0002d890: 696d 7320 3d20 5b64 696d 5d0a 2020 2020  ims = [dim].    
+0002d8a0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0002d8b0: 2020 2020 2020 2020 2020 2020 2020 6469                di
+0002d8c0: 6d73 203d 206c 6973 7428 6469 6d29 0a0a  ms = list(dim)..
+0002d8d0: 2020 2020 2020 2020 2020 2020 6d69 7373              miss
+0002d8e0: 696e 675f 6469 6d73 203d 205b 6420 666f  ing_dims = [d fo
+0002d8f0: 7220 6420 696e 2064 696d 7320 6966 2064  r d in dims if d
+0002d900: 206e 6f74 2069 6e20 7365 6c66 2e64 696d   not in self.dim
+0002d910: 735d 0a20 2020 2020 2020 2020 2020 2069  s].            i
+0002d920: 6620 6d69 7373 696e 675f 6469 6d73 3a0a  f missing_dims:.
+0002d930: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002d940: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+0002d950: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0002d960: 2020 2020 2020 6622 4461 7461 7365 7420        f"Dataset 
+0002d970: 646f 6573 206e 6f74 2063 6f6e 7461 696e  does not contain
+0002d980: 2074 6865 2064 696d 656e 7369 6f6e 733a   the dimensions:
+0002d990: 207b 6d69 7373 696e 675f 6469 6d73 7d22   {missing_dims}"
+0002d9a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002d9b0: 2029 0a0a 2020 2020 2020 2020 2320 6561   )..        # ea
+0002d9c0: 6368 2073 7065 6369 6669 6564 2064 696d  ch specified dim
+0002d9d0: 656e 7369 6f6e 206d 7573 7420 6861 7665  ension must have
+0002d9e0: 2065 7861 6374 6c79 206f 6e65 206d 756c   exactly one mul
+0002d9f0: 7469 2d69 6e64 6578 0a20 2020 2020 2020  ti-index.       
+0002da00: 2073 7461 636b 6564 5f69 6e64 6578 6573   stacked_indexes
+0002da10: 3a20 6469 6374 5b41 6e79 2c20 7475 706c  : dict[Any, tupl
+0002da20: 655b 496e 6465 782c 2064 6963 745b 4861  e[Index, dict[Ha
+0002da30: 7368 6162 6c65 2c20 5661 7269 6162 6c65  shable, Variable
+0002da40: 5d5d 5d20 3d20 7b7d 0a20 2020 2020 2020  ]]] = {}.       
+0002da50: 2066 6f72 2064 2069 6e20 6469 6d73 3a0a   for d in dims:.
+0002da60: 2020 2020 2020 2020 2020 2020 6964 782c              idx,
+0002da70: 2069 6478 5f76 6172 7320 3d20 7365 6c66   idx_vars = self
+0002da80: 2e5f 6765 745f 7374 6163 6b5f 696e 6465  ._get_stack_inde
+0002da90: 7828 642c 206d 756c 7469 3d54 7275 6529  x(d, multi=True)
+0002daa0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0002dab0: 6964 7820 6973 206e 6f74 204e 6f6e 653a  idx is not None:
+0002dac0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dad0: 2073 7461 636b 6564 5f69 6e64 6578 6573   stacked_indexes
+0002dae0: 5b64 5d20 3d20 6964 782c 2069 6478 5f76  [d] = idx, idx_v
+0002daf0: 6172 730a 0a20 2020 2020 2020 2069 6620  ars..        if 
+0002db00: 6469 6d20 6973 204e 6f6e 653a 0a20 2020  dim is None:.   
+0002db10: 2020 2020 2020 2020 2064 696d 7320 3d20           dims = 
+0002db20: 6c69 7374 2873 7461 636b 6564 5f69 6e64  list(stacked_ind
+0002db30: 6578 6573 290a 2020 2020 2020 2020 656c  exes).        el
+0002db40: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0002db50: 6e6f 6e5f 6d75 6c74 695f 6469 6d73 203d  non_multi_dims =
+0002db60: 2073 6574 2864 696d 7329 202d 2073 6574   set(dims) - set
+0002db70: 2873 7461 636b 6564 5f69 6e64 6578 6573  (stacked_indexes
+0002db80: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0002db90: 206e 6f6e 5f6d 756c 7469 5f64 696d 733a   non_multi_dims:
+0002dba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0002dbb0: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0002dbc0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+0002dbd0: 2020 2020 2020 2022 6361 6e6e 6f74 2075         "cannot u
+0002dbe0: 6e73 7461 636b 2064 696d 656e 7369 6f6e  nstack dimension
+0002dbf0: 7320 7468 6174 2064 6f20 6e6f 7420 220a  s that do not ".
+0002dc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002dc10: 2020 2020 6622 6861 7665 2065 7861 6374      f"have exact
+0002dc20: 6c79 206f 6e65 206d 756c 7469 2d69 6e64  ly one multi-ind
+0002dc30: 6578 3a20 7b74 7570 6c65 286e 6f6e 5f6d  ex: {tuple(non_m
+0002dc40: 756c 7469 5f64 696d 7329 7d22 0a20 2020  ulti_dims)}".   
+0002dc50: 2020 2020 2020 2020 2020 2020 2029 0a0a               )..
+0002dc60: 2020 2020 2020 2020 7265 7375 6c74 203d          result =
+0002dc70: 2073 656c 662e 636f 7079 2864 6565 703d   self.copy(deep=
+0002dc80: 4661 6c73 6529 0a0a 2020 2020 2020 2020  False)..        
+0002dc90: 2320 7765 2077 616e 7420 746f 2061 766f  # we want to avo
+0002dca0: 6964 2061 6c6c 6f63 6174 696e 6720 616e  id allocating an
+0002dcb0: 206f 626a 6563 742d 6474 7970 6520 6e64   object-dtype nd
+0002dcc0: 6172 7261 7920 666f 7220 6120 4d75 6c74  array for a Mult
+0002dcd0: 6949 6e64 6578 2c0a 2020 2020 2020 2020  iIndex,.        
+0002dce0: 2320 736f 2077 6520 6361 6e27 7420 6a75  # so we can't ju
+0002dcf0: 7374 2061 6363 6573 7320 7365 6c66 2e76  st access self.v
+0002dd00: 6172 6961 626c 6573 5b76 5d2e 6461 7461  ariables[v].data
+0002dd10: 2066 6f72 2065 7665 7279 2076 6172 6961   for every varia
+0002dd20: 626c 652e 0a20 2020 2020 2020 2023 2057  ble..        # W
+0002dd30: 6520 6f6e 6c79 2063 6865 636b 2074 6865  e only check the
+0002dd40: 206e 6f6e 2d69 6e64 6578 2076 6172 6961   non-index varia
+0002dd50: 626c 6573 2e0a 2020 2020 2020 2020 2320  bles..        # 
+0002dd60: 6874 7470 733a 2f2f 6769 7468 7562 2e63  https://github.c
+0002dd70: 6f6d 2f70 7964 6174 612f 7861 7272 6179  om/pydata/xarray
+0002dd80: 2f69 7373 7565 732f 3539 3032 0a20 2020  /issues/5902.   
+0002dd90: 2020 2020 206e 6f6e 696e 6465 7865 7320       nonindexes 
+0002dda0: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+0002ddb0: 7365 6c66 2e76 6172 6961 626c 6573 5b6b  self.variables[k
+0002ddc0: 5d20 666f 7220 6b20 696e 2073 6574 2873  ] for k in set(s
+0002ddd0: 656c 662e 7661 7269 6162 6c65 7329 202d  elf.variables) -
+0002dde0: 2073 6574 2873 656c 662e 5f69 6e64 6578   set(self._index
+0002ddf0: 6573 290a 2020 2020 2020 2020 5d0a 2020  es).        ].  
+0002de00: 2020 2020 2020 2320 4e6f 7465 7320 666f        # Notes fo
+0002de10: 7220 6561 6368 206f 6620 7468 6573 6520  r each of these 
+0002de20: 6361 7365 733a 0a20 2020 2020 2020 2023  cases:.        #
+0002de30: 2031 2e20 4461 736b 2061 7272 6179 7320   1. Dask arrays 
+0002de40: 646f 6e27 7420 7375 7070 6f72 7420 6173  don't support as
+0002de50: 7369 676e 6d65 6e74 2062 7920 696e 6465  signment by inde
+0002de60: 782c 2077 6869 6368 2074 6865 2066 6173  x, which the fas
+0002de70: 7420 756e 7374 6163 6b0a 2020 2020 2020  t unstack.      
+0002de80: 2020 2320 2020 2066 756e 6374 696f 6e20    #    function 
+0002de90: 7265 7175 6972 6573 2e0a 2020 2020 2020  requires..      
+0002dea0: 2020 2320 2020 2068 7474 7073 3a2f 2f67    #    https://g
+0002deb0: 6974 6875 622e 636f 6d2f 7079 6461 7461  ithub.com/pydata
+0002dec0: 2f78 6172 7261 792f 7075 6c6c 2f34 3734  /xarray/pull/474
+0002ded0: 3623 6973 7375 6563 6f6d 6d65 6e74 2d37  6#issuecomment-7
+0002dee0: 3533 3238 3231 3235 0a20 2020 2020 2020  53282125.       
+0002def0: 2023 2032 2e20 5370 6172 7365 2064 6f65   # 2. Sparse doe
+0002df00: 736e 2774 2063 7572 7265 6e74 6c79 2073  sn't currently s
+0002df10: 7570 706f 7274 2028 7468 6f75 6768 2077  upport (though w
+0002df20: 6520 636f 756c 6420 7370 6563 6961 6c2d  e could special-
+0002df30: 6361 7365 2069 7429 0a20 2020 2020 2020  case it).       
+0002df40: 2023 2020 2020 6874 7470 733a 2f2f 6769   #    https://gi
+0002df50: 7468 7562 2e63 6f6d 2f70 7964 6174 612f  thub.com/pydata/
+0002df60: 7370 6172 7365 2f69 7373 7565 732f 3432  sparse/issues/42
+0002df70: 320a 2020 2020 2020 2020 2320 332e 2070  2.        # 3. p
+0002df80: 696e 7420 7265 7175 6972 6573 2063 6865  int requires che
+0002df90: 636b 696e 6720 6966 2069 7427 7320 6120  cking if it's a 
+0002dfa0: 4e75 6d50 7920 6172 7261 7920 756e 7469  NumPy array unti
+0002dfb0: 6c0a 2020 2020 2020 2020 2320 2020 2068  l.        #    h
+0002dfc0: 7474 7073 3a2f 2f67 6974 6875 622e 636f  ttps://github.co
+0002dfd0: 6d2f 7079 6461 7461 2f78 6172 7261 792f  m/pydata/xarray/
+0002dfe0: 7075 6c6c 2f34 3735 3120 6973 2072 6573  pull/4751 is res
+0002dff0: 6f6c 7665 642c 0a20 2020 2020 2020 2023  olved,.        #
+0002e000: 2020 2020 4f6e 6365 2074 6861 7420 6973      Once that is
+0002e010: 2072 6573 6f6c 7665 642c 2065 7870 6c69   resolved, expli
+0002e020: 6369 746c 7920 6578 636c 7564 6520 7069  citly exclude pi
+0002e030: 6e74 2061 7272 6179 732e 0a20 2020 2020  nt arrays..     
+0002e040: 2020 2023 2020 2020 7069 6e74 2064 6f65     #    pint doe
+0002e050: 736e 2774 2069 6d70 6c65 6d65 6e74 2060  sn't implement `
+0002e060: 6e70 2e66 756c 6c5f 6c69 6b65 6020 696e  np.full_like` in
+0002e070: 2061 2077 6179 2074 6861 7427 730a 2020   a way that's.  
+0002e080: 2020 2020 2020 2320 2020 2063 7572 7265        #    curre
+0002e090: 6e74 6c79 2063 6f6d 7061 7469 626c 652e  ntly compatible.
+0002e0a0: 0a20 2020 2020 2020 2073 7061 7273 655f  .        sparse_
+0002e0b0: 6172 7261 795f 7479 7065 203d 2061 7272  array_type = arr
+0002e0c0: 6179 5f74 7970 6528 2273 7061 7273 6522  ay_type("sparse"
+0002e0d0: 290a 2020 2020 2020 2020 6e65 6564 735f  ).        needs_
+0002e0e0: 6675 6c6c 5f72 6569 6e64 6578 203d 2061  full_reindex = a
+0002e0f0: 6e79 280a 2020 2020 2020 2020 2020 2020  ny(.            
+0002e100: 6973 5f64 7563 6b5f 6461 736b 5f61 7272  is_duck_dask_arr
+0002e110: 6179 2876 2e64 6174 6129 0a20 2020 2020  ay(v.data).     
+0002e120: 2020 2020 2020 206f 7220 6973 696e 7374         or isinst
+0002e130: 616e 6365 2876 2e64 6174 612c 2073 7061  ance(v.data, spa
+0002e140: 7273 655f 6172 7261 795f 7479 7065 290a  rse_array_type).
+0002e150: 2020 2020 2020 2020 2020 2020 6f72 206e              or n
+0002e160: 6f74 2069 7369 6e73 7461 6e63 6528 762e  ot isinstance(v.
+0002e170: 6461 7461 2c20 6e70 2e6e 6461 7272 6179  data, np.ndarray
+0002e180: 290a 2020 2020 2020 2020 2020 2020 666f  ).            fo
+0002e190: 7220 7620 696e 206e 6f6e 696e 6465 7865  r v in nonindexe
+0002e1a0: 730a 2020 2020 2020 2020 290a 0a20 2020  s.        )..   
+0002e1b0: 2020 2020 2066 6f72 2064 2069 6e20 6469       for d in di
+0002e1c0: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
+0002e1d0: 6966 206e 6565 6473 5f66 756c 6c5f 7265  if needs_full_re
+0002e1e0: 696e 6465 783a 0a20 2020 2020 2020 2020  index:.         
+0002e1f0: 2020 2020 2020 2072 6573 756c 7420 3d20         result = 
+0002e200: 7265 7375 6c74 2e5f 756e 7374 6163 6b5f  result._unstack_
+0002e210: 6675 6c6c 5f72 6569 6e64 6578 280a 2020  full_reindex(.  
+0002e220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e230: 2020 642c 2073 7461 636b 6564 5f69 6e64    d, stacked_ind
+0002e240: 6578 6573 5b64 5d2c 2066 696c 6c5f 7661  exes[d], fill_va
+0002e250: 6c75 652c 2073 7061 7273 650a 2020 2020  lue, sparse.    
+0002e260: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0002e270: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0002e280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002e290: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
+0002e2a0: 5f75 6e73 7461 636b 5f6f 6e63 6528 642c  _unstack_once(d,
+0002e2b0: 2073 7461 636b 6564 5f69 6e64 6578 6573   stacked_indexes
+0002e2c0: 5b64 5d2c 2066 696c 6c5f 7661 6c75 652c  [d], fill_value,
+0002e2d0: 2073 7061 7273 6529 0a20 2020 2020 2020   sparse).       
+0002e2e0: 2072 6574 7572 6e20 7265 7375 6c74 0a0a   return result..
+0002e2f0: 2020 2020 6465 6620 7570 6461 7465 2873      def update(s
+0002e300: 656c 663a 2054 5f44 6174 6173 6574 2c20  elf: T_Dataset, 
+0002e310: 6f74 6865 723a 2043 6f65 7263 6962 6c65  other: Coercible
+0002e320: 4d61 7070 696e 6729 202d 3e20 545f 4461  Mapping) -> T_Da
+0002e330: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
+0002e340: 2222 5570 6461 7465 2074 6869 7320 6461  ""Update this da
+0002e350: 7461 7365 7427 7320 7661 7269 6162 6c65  taset's variable
+0002e360: 7320 7769 7468 2074 686f 7365 2066 726f  s with those fro
+0002e370: 6d20 616e 6f74 6865 7220 6461 7461 7365  m another datase
+0002e380: 742e 0a0a 2020 2020 2020 2020 4a75 7374  t...        Just
+0002e390: 206c 696b 6520 3a70 793a 6d65 7468 3a60   like :py:meth:`
+0002e3a0: 6469 6374 2e75 7064 6174 6560 2074 6869  dict.update` thi
+0002e3b0: 7320 6973 2061 2069 6e2d 706c 6163 6520  s is a in-place 
+0002e3c0: 6f70 6572 6174 696f 6e2e 0a20 2020 2020  operation..     
+0002e3d0: 2020 2046 6f72 2061 206e 6f6e 2d69 6e70     For a non-inp
+0002e3e0: 6c61 6365 2076 6572 7369 6f6e 2c20 7365  lace version, se
+0002e3f0: 6520 3a70 793a 6d65 7468 3a60 4461 7461  e :py:meth:`Data
+0002e400: 7365 742e 6d65 7267 6560 2e0a 0a20 2020  set.merge`...   
+0002e410: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0002e420: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0002e430: 2d2d 0a20 2020 2020 2020 206f 7468 6572  --.        other
+0002e440: 203a 2044 6174 6173 6574 206f 7220 6d61   : Dataset or ma
+0002e450: 7070 696e 670a 2020 2020 2020 2020 2020  pping.          
+0002e460: 2020 5661 7269 6162 6c65 7320 7769 7468    Variables with
+0002e470: 2077 6869 6368 2074 6f20 7570 6461 7465   which to update
+0002e480: 2074 6869 7320 6461 7461 7365 742e 204f   this dataset. O
+0002e490: 6e65 206f 663a 0a0a 2020 2020 2020 2020  ne of:..        
+0002e4a0: 2020 2020 2d20 4461 7461 7365 740a 2020      - Dataset.  
+0002e4b0: 2020 2020 2020 2020 2020 2d20 6d61 7070            - mapp
+0002e4c0: 696e 6720 7b76 6172 206e 616d 653a 2044  ing {var name: D
+0002e4d0: 6174 6141 7272 6179 7d0a 2020 2020 2020  ataArray}.      
+0002e4e0: 2020 2020 2020 2d20 6d61 7070 696e 6720        - mapping 
+0002e4f0: 7b76 6172 206e 616d 653a 2056 6172 6961  {var name: Varia
+0002e500: 626c 657d 0a20 2020 2020 2020 2020 2020  ble}.           
+0002e510: 202d 206d 6170 7069 6e67 207b 7661 7220   - mapping {var 
+0002e520: 6e61 6d65 3a20 2864 696d 656e 7369 6f6e  name: (dimension
+0002e530: 206e 616d 652c 2061 7272 6179 2d6c 696b   name, array-lik
+0002e540: 6529 7d0a 2020 2020 2020 2020 2020 2020  e)}.            
+0002e550: 2d20 6d61 7070 696e 6720 7b76 6172 206e  - mapping {var n
+0002e560: 616d 653a 2028 7475 706c 6520 6f66 2064  ame: (tuple of d
+0002e570: 696d 656e 7369 6f6e 206e 616d 6573 2c20  imension names, 
+0002e580: 6172 7261 792d 6c69 6b65 297d 0a0a 2020  array-like)}..  
+0002e590: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+0002e5a0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+0002e5b0: 2020 2020 2020 7570 6461 7465 6420 3a20        updated : 
+0002e5c0: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
+0002e5d0: 2020 2020 5570 6461 7465 6420 6461 7461      Updated data
+0002e5e0: 7365 742e 204e 6f74 6520 7468 6174 2073  set. Note that s
+0002e5f0: 696e 6365 2074 6865 2075 7064 6174 6520  ince the update 
+0002e600: 6973 2069 6e2d 706c 6163 6520 7468 6973  is in-place this
+0002e610: 2069 7320 7468 6520 696e 7075 740a 2020   is the input.  
+0002e620: 2020 2020 2020 2020 2020 6461 7461 7365            datase
+0002e630: 742e 0a0a 2020 2020 2020 2020 2020 2020  t...            
+0002e640: 4974 2069 7320 6465 7072 6563 6174 6564  It is deprecated
+0002e650: 2073 696e 6365 2076 6572 7369 6f6e 2030   since version 0
+0002e660: 2e31 3720 616e 6420 7363 6865 6475 6c65  .17 and schedule
+0002e670: 6420 746f 2062 6520 7265 6d6f 7665 6420  d to be removed 
+0002e680: 696e 2030 2e32 312e 0a0a 2020 2020 2020  in 0.21...      
+0002e690: 2020 5261 6973 6573 0a20 2020 2020 2020    Raises.       
+0002e6a0: 202d 2d2d 2d2d 2d0a 2020 2020 2020 2020   ------.        
+0002e6b0: 5661 6c75 6545 7272 6f72 0a20 2020 2020  ValueError.     
+0002e6c0: 2020 2020 2020 2049 6620 616e 7920 6469         If any di
+0002e6d0: 6d65 6e73 696f 6e73 2077 6f75 6c64 2068  mensions would h
+0002e6e0: 6176 6520 696e 636f 6e73 6973 7465 6e74  ave inconsistent
+0002e6f0: 2073 697a 6573 2069 6e20 7468 6520 7570   sizes in the up
+0002e700: 6461 7465 640a 2020 2020 2020 2020 2020  dated.          
+0002e710: 2020 6461 7461 7365 742e 0a0a 2020 2020    dataset...    
+0002e720: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+0002e730: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0002e740: 2020 2020 2020 4461 7461 7365 742e 6173        Dataset.as
+0002e750: 7369 676e 0a20 2020 2020 2020 2044 6174  sign.        Dat
+0002e760: 6173 6574 2e6d 6572 6765 0a20 2020 2020  aset.merge.     
+0002e770: 2020 2022 2222 0a20 2020 2020 2020 206d     """.        m
+0002e780: 6572 6765 5f72 6573 756c 7420 3d20 6461  erge_result = da
+0002e790: 7461 7365 745f 7570 6461 7465 5f6d 6574  taset_update_met
+0002e7a0: 686f 6428 7365 6c66 2c20 6f74 6865 7229  hod(self, other)
+0002e7b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0002e7c0: 7365 6c66 2e5f 7265 706c 6163 6528 696e  self._replace(in
+0002e7d0: 706c 6163 653d 5472 7565 2c20 2a2a 6d65  place=True, **me
+0002e7e0: 7267 655f 7265 7375 6c74 2e5f 6173 6469  rge_result._asdi
+0002e7f0: 6374 2829 290a 0a20 2020 2064 6566 206d  ct())..    def m
+0002e800: 6572 6765 280a 2020 2020 2020 2020 7365  erge(.        se
+0002e810: 6c66 3a20 545f 4461 7461 7365 742c 0a20  lf: T_Dataset,. 
+0002e820: 2020 2020 2020 206f 7468 6572 3a20 436f         other: Co
+0002e830: 6572 6369 626c 654d 6170 7069 6e67 207c  ercibleMapping |
+0002e840: 2044 6174 6141 7272 6179 2c0a 2020 2020   DataArray,.    
+0002e850: 2020 2020 6f76 6572 7772 6974 655f 7661      overwrite_va
+0002e860: 7273 3a20 4861 7368 6162 6c65 207c 2049  rs: Hashable | I
+0002e870: 7465 7261 626c 655b 4861 7368 6162 6c65  terable[Hashable
+0002e880: 5d20 3d20 6672 6f7a 656e 7365 7428 292c  ] = frozenset(),
+0002e890: 0a20 2020 2020 2020 2063 6f6d 7061 743a  .        compat:
+0002e8a0: 2043 6f6d 7061 744f 7074 696f 6e73 203d   CompatOptions =
+0002e8b0: 2022 6e6f 5f63 6f6e 666c 6963 7473 222c   "no_conflicts",
+0002e8c0: 0a20 2020 2020 2020 206a 6f69 6e3a 204a  .        join: J
+0002e8d0: 6f69 6e4f 7074 696f 6e73 203d 2022 6f75  oinOptions = "ou
+0002e8e0: 7465 7222 2c0a 2020 2020 2020 2020 6669  ter",.        fi
+0002e8f0: 6c6c 5f76 616c 7565 3a20 416e 7920 3d20  ll_value: Any = 
+0002e900: 7872 6474 7970 6573 2e4e 412c 0a20 2020  xrdtypes.NA,.   
+0002e910: 2020 2020 2063 6f6d 6269 6e65 5f61 7474       combine_att
+0002e920: 7273 3a20 436f 6d62 696e 6541 7474 7273  rs: CombineAttrs
+0002e930: 4f70 7469 6f6e 7320 3d20 226f 7665 7272  Options = "overr
+0002e940: 6964 6522 2c0a 2020 2020 2920 2d3e 2054  ide",.    ) -> T
+0002e950: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
+0002e960: 2020 2222 224d 6572 6765 2074 6865 2061    """Merge the a
+0002e970: 7272 6179 7320 6f66 2074 776f 2064 6174  rrays of two dat
+0002e980: 6173 6574 7320 696e 746f 2061 2073 696e  asets into a sin
+0002e990: 676c 6520 6461 7461 7365 742e 0a0a 2020  gle dataset...  
+0002e9a0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+0002e9b0: 6420 6765 6e65 7261 6c6c 7920 646f 6573  d generally does
+0002e9c0: 206e 6f74 2061 6c6c 6f77 2066 6f72 206f   not allow for o
+0002e9d0: 7665 7272 6964 696e 6720 6461 7461 2c20  verriding data, 
+0002e9e0: 7769 7468 2074 6865 0a20 2020 2020 2020  with the.       
+0002e9f0: 2065 7863 6570 7469 6f6e 206f 6620 6174   exception of at
+0002ea00: 7472 6962 7574 6573 2c20 7768 6963 6820  tributes, which 
+0002ea10: 6172 6520 6967 6e6f 7265 6420 6f6e 2074  are ignored on t
+0002ea20: 6865 2073 6563 6f6e 6420 6461 7461 7365  he second datase
+0002ea30: 742e 0a20 2020 2020 2020 2056 6172 6961  t..        Varia
+0002ea40: 626c 6573 2077 6974 6820 7468 6520 7361  bles with the sa
+0002ea50: 6d65 206e 616d 6520 6172 6520 6368 6563  me name are chec
+0002ea60: 6b65 6420 666f 7220 636f 6e66 6c69 6374  ked for conflict
+0002ea70: 7320 7669 6120 7468 6520 6571 7561 6c73  s via the equals
+0002ea80: 0a20 2020 2020 2020 206f 7220 6964 656e  .        or iden
+0002ea90: 7469 6361 6c20 6d65 7468 6f64 732e 0a0a  tical methods...
+0002eaa0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0002eab0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0002eac0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6f74  -----.        ot
+0002ead0: 6865 7220 3a20 4461 7461 7365 7420 6f72  her : Dataset or
+0002eae0: 206d 6170 7069 6e67 0a20 2020 2020 2020   mapping.       
+0002eaf0: 2020 2020 2044 6174 6173 6574 206f 7220       Dataset or 
+0002eb00: 7661 7269 6162 6c65 7320 746f 206d 6572  variables to mer
+0002eb10: 6765 2077 6974 6820 7468 6973 2064 6174  ge with this dat
+0002eb20: 6173 6574 2e0a 2020 2020 2020 2020 6f76  aset..        ov
+0002eb30: 6572 7772 6974 655f 7661 7273 203a 2068  erwrite_vars : h
+0002eb40: 6173 6861 626c 6520 6f72 2069 7465 7261  ashable or itera
+0002eb50: 626c 6520 6f66 2068 6173 6861 626c 652c  ble of hashable,
+0002eb60: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0002eb70: 2020 2020 2020 4966 2070 726f 7669 6465        If provide
+0002eb80: 642c 2075 7064 6174 6520 7661 7269 6162  d, update variab
+0002eb90: 6c65 7320 6f66 2074 6865 7365 206e 616d  les of these nam
+0002eba0: 6528 7329 2077 6974 686f 7574 2063 6865  e(s) without che
+0002ebb0: 636b 696e 6720 666f 720a 2020 2020 2020  cking for.      
+0002ebc0: 2020 2020 2020 636f 6e66 6c69 6374 7320        conflicts 
+0002ebd0: 696e 2074 6869 7320 6461 7461 7365 742e  in this dataset.
+0002ebe0: 0a20 2020 2020 2020 2063 6f6d 7061 7420  .        compat 
+0002ebf0: 3a20 7b22 6964 656e 7469 6361 6c22 2c20  : {"identical", 
+0002ec00: 2265 7175 616c 7322 2c20 2262 726f 6164  "equals", "broad
+0002ec10: 6361 7374 5f65 7175 616c 7322 2c20 5c0a  cast_equals", \.
+0002ec20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0002ec30: 2020 226e 6f5f 636f 6e66 6c69 6374 7322    "no_conflicts"
+0002ec40: 2c20 226f 7665 7272 6964 6522 2c20 226d  , "override", "m
+0002ec50: 696e 696d 616c 227d 2c20 6465 6661 756c  inimal"}, defaul
+0002ec60: 743a 2022 6e6f 5f63 6f6e 666c 6963 7473  t: "no_conflicts
+0002ec70: 220a 2020 2020 2020 2020 2020 2020 5374  ".            St
+0002ec80: 7269 6e67 2069 6e64 6963 6174 696e 6720  ring indicating 
+0002ec90: 686f 7720 746f 2063 6f6d 7061 7265 2076  how to compare v
+0002eca0: 6172 6961 626c 6573 206f 6620 7468 6520  ariables of the 
+0002ecb0: 7361 6d65 206e 616d 6520 666f 720a 2020  same name for.  
+0002ecc0: 2020 2020 2020 2020 2020 706f 7465 6e74            potent
+0002ecd0: 6961 6c20 636f 6e66 6c69 6374 733a 0a0a  ial conflicts:..
+0002ece0: 2020 2020 2020 2020 2020 2020 2d20 2769              - 'i
+0002ecf0: 6465 6e74 6963 616c 273a 2061 6c6c 2076  dentical': all v
+0002ed00: 616c 7565 732c 2064 696d 656e 7369 6f6e  alues, dimension
+0002ed10: 7320 616e 6420 6174 7472 6962 7574 6573  s and attributes
+0002ed20: 206d 7573 7420 6265 2074 6865 0a20 2020   must be the.   
+0002ed30: 2020 2020 2020 2020 2020 2073 616d 652e             same.
+0002ed40: 0a20 2020 2020 2020 2020 2020 202d 2027  .            - '
+0002ed50: 6571 7561 6c73 273a 2061 6c6c 2076 616c  equals': all val
+0002ed60: 7565 7320 616e 6420 6469 6d65 6e73 696f  ues and dimensio
+0002ed70: 6e73 206d 7573 7420 6265 2074 6865 2073  ns must be the s
+0002ed80: 616d 652e 0a20 2020 2020 2020 2020 2020  ame..           
+0002ed90: 202d 2027 6272 6f61 6463 6173 745f 6571   - 'broadcast_eq
+0002eda0: 7561 6c73 273a 2061 6c6c 2076 616c 7565  uals': all value
+0002edb0: 7320 6d75 7374 2062 6520 6571 7561 6c20  s must be equal 
+0002edc0: 7768 656e 2076 6172 6961 626c 6573 2061  when variables a
+0002edd0: 7265 0a20 2020 2020 2020 2020 2020 2020  re.             
+0002ede0: 2062 726f 6164 6361 7374 2061 6761 696e   broadcast again
+0002edf0: 7374 2065 6163 6820 6f74 6865 7220 746f  st each other to
+0002ee00: 2065 6e73 7572 6520 636f 6d6d 6f6e 2064   ensure common d
+0002ee10: 696d 656e 7369 6f6e 732e 0a20 2020 2020  imensions..     
+0002ee20: 2020 2020 2020 202d 2027 6e6f 5f63 6f6e         - 'no_con
+0002ee30: 666c 6963 7473 273a 206f 6e6c 7920 7661  flicts': only va
+0002ee40: 6c75 6573 2077 6869 6368 2061 7265 206e  lues which are n
+0002ee50: 6f74 206e 756c 6c20 696e 2062 6f74 6820  ot null in both 
+0002ee60: 6461 7461 7365 7473 0a20 2020 2020 2020  datasets.       
+0002ee70: 2020 2020 2020 206d 7573 7420 6265 2065         must be e
+0002ee80: 7175 616c 2e20 5468 6520 7265 7475 726e  qual. The return
+0002ee90: 6564 2064 6174 6173 6574 2074 6865 6e20  ed dataset then 
+0002eea0: 636f 6e74 6169 6e73 2074 6865 2063 6f6d  contains the com
+0002eeb0: 6269 6e61 7469 6f6e 0a20 2020 2020 2020  bination.       
+0002eec0: 2020 2020 2020 206f 6620 616c 6c20 6e6f         of all no
+0002eed0: 6e2d 6e75 6c6c 2076 616c 7565 732e 0a20  n-null values.. 
+0002eee0: 2020 2020 2020 2020 2020 202d 2027 6f76             - 'ov
+0002eef0: 6572 7269 6465 273a 2073 6b69 7020 636f  erride': skip co
+0002ef00: 6d70 6172 696e 6720 616e 6420 7069 636b  mparing and pick
+0002ef10: 2076 6172 6961 626c 6520 6672 6f6d 2066   variable from f
+0002ef20: 6972 7374 2064 6174 6173 6574 0a20 2020  irst dataset.   
+0002ef30: 2020 2020 2020 2020 202d 2027 6d69 6e69           - 'mini
+0002ef40: 6d61 6c27 3a20 6472 6f70 2063 6f6e 666c  mal': drop confl
+0002ef50: 6963 7469 6e67 2063 6f6f 7264 696e 6174  icting coordinat
+0002ef60: 6573 0a0a 2020 2020 2020 2020 6a6f 696e  es..        join
+0002ef70: 203a 207b 226f 7574 6572 222c 2022 696e   : {"outer", "in
+0002ef80: 6e65 7222 2c20 226c 6566 7422 2c20 2272  ner", "left", "r
+0002ef90: 6967 6874 222c 2022 6578 6163 7422 2c20  ight", "exact", 
+0002efa0: 226f 7665 7272 6964 6522 7d2c 205c 0a20  "override"}, \. 
+0002efb0: 2020 2020 2020 2020 2020 2020 2020 6465                de
+0002efc0: 6661 756c 743a 2022 6f75 7465 7222 0a20  fault: "outer". 
+0002efd0: 2020 2020 2020 2020 2020 204d 6574 686f             Metho
+0002efe0: 6420 666f 7220 6a6f 696e 696e 6720 6060  d for joining ``
+0002eff0: 7365 6c66 6060 2061 6e64 2060 606f 7468  self`` and ``oth
+0002f000: 6572 6060 2061 6c6f 6e67 2073 6861 7265  er`` along share
+0002f010: 6420 6469 6d65 6e73 696f 6e73 3a0a 0a20  d dimensions:.. 
+0002f020: 2020 2020 2020 2020 2020 202d 2027 6f75             - 'ou
+0002f030: 7465 7227 3a20 7573 6520 7468 6520 756e  ter': use the un
+0002f040: 696f 6e20 6f66 2074 6865 2069 6e64 6578  ion of the index
+0002f050: 6573 0a20 2020 2020 2020 2020 2020 202d  es.            -
+0002f060: 2027 696e 6e65 7227 3a20 7573 6520 7468   'inner': use th
+0002f070: 6520 696e 7465 7273 6563 7469 6f6e 206f  e intersection o
+0002f080: 6620 7468 6520 696e 6465 7865 730a 2020  f the indexes.  
+0002f090: 2020 2020 2020 2020 2020 2d20 276c 6566            - 'lef
+0002f0a0: 7427 3a20 7573 6520 696e 6465 7865 7320  t': use indexes 
+0002f0b0: 6672 6f6d 2060 6073 656c 6660 600a 2020  from ``self``.  
+0002f0c0: 2020 2020 2020 2020 2020 2d20 2772 6967            - 'rig
+0002f0d0: 6874 273a 2075 7365 2069 6e64 6578 6573  ht': use indexes
+0002f0e0: 2066 726f 6d20 6060 6f74 6865 7260 600a   from ``other``.
+0002f0f0: 2020 2020 2020 2020 2020 2020 2d20 2765              - 'e
+0002f100: 7861 6374 273a 2065 7272 6f72 2069 6e73  xact': error ins
+0002f110: 7465 6164 206f 6620 616c 6967 6e69 6e67  tead of aligning
+0002f120: 206e 6f6e 2d65 7175 616c 2069 6e64 6578   non-equal index
+0002f130: 6573 0a20 2020 2020 2020 2020 2020 202d  es.            -
+0002f140: 2027 6f76 6572 7269 6465 273a 2075 7365   'override': use
+0002f150: 2069 6e64 6578 6573 2066 726f 6d20 6060   indexes from ``
+0002f160: 7365 6c66 6060 2074 6861 7420 6172 6520  self`` that are 
+0002f170: 7468 6520 7361 6d65 2073 697a 650a 2020  the same size.  
+0002f180: 2020 2020 2020 2020 2020 2020 6173 2074              as t
+0002f190: 686f 7365 206f 6620 6060 6f74 6865 7260  hose of ``other`
+0002f1a0: 6020 696e 2074 6861 7420 6469 6d65 6e73  ` in that dimens
+0002f1b0: 696f 6e0a 0a20 2020 2020 2020 2066 696c  ion..        fil
+0002f1c0: 6c5f 7661 6c75 6520 3a20 7363 616c 6172  l_value : scalar
+0002f1d0: 206f 7220 6469 6374 2d6c 696b 652c 206f   or dict-like, o
+0002f1e0: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0002f1f0: 2020 2020 5661 6c75 6520 746f 2075 7365      Value to use
+0002f200: 2066 6f72 206e 6577 6c79 206d 6973 7369   for newly missi
+0002f210: 6e67 2076 616c 7565 732e 2049 6620 6120  ng values. If a 
+0002f220: 6469 6374 2d6c 696b 652c 206d 6170 730a  dict-like, maps.
+0002f230: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+0002f240: 6162 6c65 206e 616d 6573 2028 696e 636c  able names (incl
+0002f250: 7564 696e 6720 636f 6f72 6469 6e61 7465  uding coordinate
+0002f260: 7329 2074 6f20 6669 6c6c 2076 616c 7565  s) to fill value
+0002f270: 732e 0a20 2020 2020 2020 2063 6f6d 6269  s..        combi
+0002f280: 6e65 5f61 7474 7273 203a 207b 2264 726f  ne_attrs : {"dro
+0002f290: 7022 2c20 2269 6465 6e74 6963 616c 222c  p", "identical",
+0002f2a0: 2022 6e6f 5f63 6f6e 666c 6963 7473 222c   "no_conflicts",
+0002f2b0: 2022 6472 6f70 5f63 6f6e 666c 6963 7473   "drop_conflicts
+0002f2c0: 222c 205c 0a20 2020 2020 2020 2020 2020  ", \.           
+0002f2d0: 2020 2020 2020 2020 2020 2020 2020 226f                "o
+0002f2e0: 7665 7272 6964 6522 7d20 6f72 2063 616c  verride"} or cal
+0002f2f0: 6c61 626c 652c 2064 6566 6175 6c74 3a20  lable, default: 
+0002f300: 226f 7665 7272 6964 6522 0a20 2020 2020  "override".     
+0002f310: 2020 2020 2020 2041 2063 616c 6c61 626c         A callabl
+0002f320: 6520 6f72 2061 2073 7472 696e 6720 696e  e or a string in
+0002f330: 6469 6361 7469 6e67 2068 6f77 2074 6f20  dicating how to 
+0002f340: 636f 6d62 696e 6520 6174 7472 7320 6f66  combine attrs of
+0002f350: 2074 6865 206f 626a 6563 7473 2062 6569   the objects bei
+0002f360: 6e67 0a20 2020 2020 2020 2020 2020 206d  ng.            m
+0002f370: 6572 6765 643a 0a0a 2020 2020 2020 2020  erged:..        
+0002f380: 2020 2020 2d20 2264 726f 7022 3a20 656d      - "drop": em
+0002f390: 7074 7920 6174 7472 7320 6f6e 2072 6574  pty attrs on ret
+0002f3a0: 7572 6e65 6420 4461 7461 7365 742e 0a20  urned Dataset.. 
+0002f3b0: 2020 2020 2020 2020 2020 202d 2022 6964             - "id
+0002f3c0: 656e 7469 6361 6c22 3a20 616c 6c20 6174  entical": all at
+0002f3d0: 7472 7320 6d75 7374 2062 6520 7468 6520  trs must be the 
+0002f3e0: 7361 6d65 206f 6e20 6576 6572 7920 6f62  same on every ob
+0002f3f0: 6a65 6374 2e0a 2020 2020 2020 2020 2020  ject..          
+0002f400: 2020 2d20 226e 6f5f 636f 6e66 6c69 6374    - "no_conflict
+0002f410: 7322 3a20 6174 7472 7320 6672 6f6d 2061  s": attrs from a
+0002f420: 6c6c 206f 626a 6563 7473 2061 7265 2063  ll objects are c
+0002f430: 6f6d 6269 6e65 642c 2061 6e79 2074 6861  ombined, any tha
+0002f440: 7420 6861 7665 0a20 2020 2020 2020 2020  t have.         
+0002f450: 2020 2020 2074 6865 2073 616d 6520 6e61       the same na
+0002f460: 6d65 206d 7573 7420 616c 736f 2068 6176  me must also hav
+0002f470: 6520 7468 6520 7361 6d65 2076 616c 7565  e the same value
+0002f480: 2e0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0002f490: 2264 726f 705f 636f 6e66 6c69 6374 7322  "drop_conflicts"
+0002f4a0: 3a20 6174 7472 7320 6672 6f6d 2061 6c6c  : attrs from all
+0002f4b0: 206f 626a 6563 7473 2061 7265 2063 6f6d   objects are com
+0002f4c0: 6269 6e65 642c 2061 6e79 2074 6861 7420  bined, any that 
+0002f4d0: 6861 7665 0a20 2020 2020 2020 2020 2020  have.           
+0002f4e0: 2020 2074 6865 2073 616d 6520 6e61 6d65     the same name
+0002f4f0: 2062 7574 2064 6966 6665 7265 6e74 2076   but different v
+0002f500: 616c 7565 7320 6172 6520 6472 6f70 7065  alues are droppe
+0002f510: 642e 0a20 2020 2020 2020 2020 2020 202d  d..            -
+0002f520: 2022 6f76 6572 7269 6465 223a 2073 6b69   "override": ski
+0002f530: 7020 636f 6d70 6172 696e 6720 616e 6420  p comparing and 
+0002f540: 636f 7079 2061 7474 7273 2066 726f 6d20  copy attrs from 
+0002f550: 7468 6520 6669 7273 7420 6461 7461 7365  the first datase
+0002f560: 7420 746f 0a20 2020 2020 2020 2020 2020  t to.           
+0002f570: 2020 2074 6865 2072 6573 756c 742e 0a0a     the result...
+0002f580: 2020 2020 2020 2020 2020 2020 4966 2061              If a
+0002f590: 2063 616c 6c61 626c 652c 2069 7420 6d75   callable, it mu
+0002f5a0: 7374 2065 7870 6563 7420 6120 7365 7175  st expect a sequ
+0002f5b0: 656e 6365 206f 6620 6060 6174 7472 7360  ence of ``attrs`
+0002f5c0: 6020 6469 6374 7320 616e 6420 6120 636f  ` dicts and a co
+0002f5d0: 6e74 6578 7420 6f62 6a65 6374 0a20 2020  ntext object.   
+0002f5e0: 2020 2020 2020 2020 2061 7320 6974 7320           as its 
+0002f5f0: 6f6e 6c79 2070 6172 616d 6574 6572 732e  only parameters.
+0002f600: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0002f610: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0002f620: 2d0a 2020 2020 2020 2020 6d65 7267 6564  -.        merged
+0002f630: 203a 2044 6174 6173 6574 0a20 2020 2020   : Dataset.     
+0002f640: 2020 2020 2020 204d 6572 6765 6420 6461         Merged da
+0002f650: 7461 7365 742e 0a0a 2020 2020 2020 2020  taset...        
+0002f660: 5261 6973 6573 0a20 2020 2020 2020 202d  Raises.        -
+0002f670: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4d65  -----.        Me
+0002f680: 7267 6545 7272 6f72 0a20 2020 2020 2020  rgeError.       
+0002f690: 2020 2020 2049 6620 616e 7920 7661 7269       If any vari
+0002f6a0: 6162 6c65 7320 636f 6e66 6c69 6374 2028  ables conflict (
+0002f6b0: 7365 6520 6060 636f 6d70 6174 6060 292e  see ``compat``).
+0002f6c0: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+0002f6d0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+0002f6e0: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+0002f6f0: 7365 742e 7570 6461 7465 0a20 2020 2020  set.update.     
+0002f700: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
+0002f710: 726f 6d20 7861 7272 6179 2e63 6f72 652e  rom xarray.core.
+0002f720: 6461 7461 6172 7261 7920 696d 706f 7274  dataarray import
+0002f730: 2044 6174 6141 7272 6179 0a0a 2020 2020   DataArray..    
+0002f740: 2020 2020 6f74 6865 7220 3d20 6f74 6865      other = othe
+0002f750: 722e 746f 5f64 6174 6173 6574 2829 2069  r.to_dataset() i
+0002f760: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
+0002f770: 6572 2c20 4461 7461 4172 7261 7929 2065  er, DataArray) e
+0002f780: 6c73 6520 6f74 6865 720a 2020 2020 2020  lse other.      
+0002f790: 2020 6d65 7267 655f 7265 7375 6c74 203d    merge_result =
+0002f7a0: 2064 6174 6173 6574 5f6d 6572 6765 5f6d   dataset_merge_m
+0002f7b0: 6574 686f 6428 0a20 2020 2020 2020 2020  ethod(.         
+0002f7c0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+0002f7d0: 2020 2020 206f 7468 6572 2c0a 2020 2020       other,.    
+0002f7e0: 2020 2020 2020 2020 6f76 6572 7772 6974          overwrit
+0002f7f0: 655f 7661 7273 3d6f 7665 7277 7269 7465  e_vars=overwrite
+0002f800: 5f76 6172 732c 0a20 2020 2020 2020 2020  _vars,.         
+0002f810: 2020 2063 6f6d 7061 743d 636f 6d70 6174     compat=compat
+0002f820: 2c0a 2020 2020 2020 2020 2020 2020 6a6f  ,.            jo
+0002f830: 696e 3d6a 6f69 6e2c 0a20 2020 2020 2020  in=join,.       
+0002f840: 2020 2020 2066 696c 6c5f 7661 6c75 653d       fill_value=
+0002f850: 6669 6c6c 5f76 616c 7565 2c0a 2020 2020  fill_value,.    
+0002f860: 2020 2020 2020 2020 636f 6d62 696e 655f          combine_
+0002f870: 6174 7472 733d 636f 6d62 696e 655f 6174  attrs=combine_at
+0002f880: 7472 732c 0a20 2020 2020 2020 2029 0a20  trs,.        ). 
+0002f890: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0002f8a0: 6c66 2e5f 7265 706c 6163 6528 2a2a 6d65  lf._replace(**me
+0002f8b0: 7267 655f 7265 7375 6c74 2e5f 6173 6469  rge_result._asdi
+0002f8c0: 6374 2829 290a 0a20 2020 2064 6566 205f  ct())..    def _
+0002f8d0: 6173 7365 7274 5f61 6c6c 5f69 6e5f 6461  assert_all_in_da
+0002f8e0: 7461 7365 7428 0a20 2020 2020 2020 2073  taset(.        s
+0002f8f0: 656c 662c 206e 616d 6573 3a20 4974 6572  elf, names: Iter
+0002f900: 6162 6c65 5b48 6173 6861 626c 655d 2c20  able[Hashable], 
+0002f910: 7669 7274 7561 6c5f 6f6b 6179 3a20 626f  virtual_okay: bo
+0002f920: 6f6c 203d 2046 616c 7365 0a20 2020 2029  ol = False.    )
+0002f930: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0002f940: 2020 6261 645f 6e61 6d65 7320 3d20 7365    bad_names = se
+0002f950: 7428 6e61 6d65 7329 202d 2073 6574 2873  t(names) - set(s
+0002f960: 656c 662e 5f76 6172 6961 626c 6573 290a  elf._variables).
+0002f970: 2020 2020 2020 2020 6966 2076 6972 7475          if virtu
+0002f980: 616c 5f6f 6b61 793a 0a20 2020 2020 2020  al_okay:.       
+0002f990: 2020 2020 2062 6164 5f6e 616d 6573 202d       bad_names -
+0002f9a0: 3d20 7365 6c66 2e76 6972 7475 616c 5f76  = self.virtual_v
+0002f9b0: 6172 6961 626c 6573 0a20 2020 2020 2020  ariables.       
+0002f9c0: 2069 6620 6261 645f 6e61 6d65 733a 0a20   if bad_names:. 
+0002f9d0: 2020 2020 2020 2020 2020 206f 7264 6572             order
+0002f9e0: 6564 5f62 6164 5f6e 616d 6573 203d 205b  ed_bad_names = [
+0002f9f0: 6e61 6d65 2066 6f72 206e 616d 6520 696e  name for name in
+0002fa00: 206e 616d 6573 2069 6620 6e61 6d65 2069   names if name i
+0002fa10: 6e20 6261 645f 6e61 6d65 735d 0a20 2020  n bad_names].   
+0002fa20: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0002fa30: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
+0002fa40: 2020 2020 2020 2020 2020 2066 2254 6865             f"The
+0002fa50: 7365 2076 6172 6961 626c 6573 2063 616e  se variables can
+0002fa60: 6e6f 7420 6265 2066 6f75 6e64 2069 6e20  not be found in 
+0002fa70: 7468 6973 2064 6174 6173 6574 3a20 7b6f  this dataset: {o
+0002fa80: 7264 6572 6564 5f62 6164 5f6e 616d 6573  rdered_bad_names
+0002fa90: 7d22 0a20 2020 2020 2020 2020 2020 2029  }".            )
+0002faa0: 0a0a 2020 2020 6465 6620 6472 6f70 5f76  ..    def drop_v
+0002fab0: 6172 7328 0a20 2020 2020 2020 2073 656c  ars(.        sel
+0002fac0: 663a 2054 5f44 6174 6173 6574 2c0a 2020  f: T_Dataset,.  
+0002fad0: 2020 2020 2020 6e61 6d65 733a 2048 6173        names: Has
+0002fae0: 6861 626c 6520 7c20 4974 6572 6162 6c65  hable | Iterable
+0002faf0: 5b48 6173 6861 626c 655d 2c0a 2020 2020  [Hashable],.    
+0002fb00: 2020 2020 2a2c 0a20 2020 2020 2020 2065      *,.        e
+0002fb10: 7272 6f72 733a 2045 7272 6f72 4f70 7469  rrors: ErrorOpti
+0002fb20: 6f6e 7320 3d20 2272 6169 7365 222c 0a20  ons = "raise",. 
+0002fb30: 2020 2029 202d 3e20 545f 4461 7461 7365     ) -> T_Datase
+0002fb40: 743a 0a20 2020 2020 2020 2022 2222 4472  t:.        """Dr
+0002fb50: 6f70 2076 6172 6961 626c 6573 2066 726f  op variables fro
+0002fb60: 6d20 7468 6973 2064 6174 6173 6574 2e0a  m this dataset..
+0002fb70: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0002fb80: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+0002fb90: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
+0002fba0: 616d 6573 203a 2068 6173 6861 626c 6520  ames : hashable 
+0002fbb0: 6f72 2069 7465 7261 626c 6520 6f66 2068  or iterable of h
+0002fbc0: 6173 6861 626c 650a 2020 2020 2020 2020  ashable.        
+0002fbd0: 2020 2020 4e61 6d65 2873 2920 6f66 2076      Name(s) of v
+0002fbe0: 6172 6961 626c 6573 2074 6f20 6472 6f70  ariables to drop
+0002fbf0: 2e0a 2020 2020 2020 2020 6572 726f 7273  ..        errors
+0002fc00: 203a 207b 2272 6169 7365 222c 2022 6967   : {"raise", "ig
+0002fc10: 6e6f 7265 227d 2c20 6465 6661 756c 743a  nore"}, default:
+0002fc20: 2022 7261 6973 6522 0a20 2020 2020 2020   "raise".       
+0002fc30: 2020 2020 2049 6620 2772 6169 7365 272c       If 'raise',
+0002fc40: 2072 6169 7365 7320 6120 5661 6c75 6545   raises a ValueE
+0002fc50: 7272 6f72 2065 7272 6f72 2069 6620 616e  rror error if an
+0002fc60: 7920 6f66 2074 6865 2076 6172 6961 626c  y of the variabl
+0002fc70: 650a 2020 2020 2020 2020 2020 2020 7061  e.            pa
+0002fc80: 7373 6564 2061 7265 206e 6f74 2069 6e20  ssed are not in 
+0002fc90: 7468 6520 6461 7461 7365 742e 2049 6620  the dataset. If 
+0002fca0: 2769 676e 6f72 6527 2c20 616e 7920 6769  'ignore', any gi
+0002fcb0: 7665 6e20 6e61 6d65 7320 7468 6174 2061  ven names that a
+0002fcc0: 7265 2069 6e20 7468 650a 2020 2020 2020  re in the.      
+0002fcd0: 2020 2020 2020 6461 7461 7365 7420 6172        dataset ar
+0002fce0: 6520 6472 6f70 7065 6420 616e 6420 6e6f  e dropped and no
+0002fcf0: 2065 7272 6f72 2069 7320 7261 6973 6564   error is raised
+0002fd00: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0002fd10: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+0002fd20: 2d2d 0a20 2020 2020 2020 2064 726f 7070  --.        dropp
+0002fd30: 6564 203a 2044 6174 6173 6574 0a0a 2020  ed : Dataset..  
+0002fd40: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0002fd50: 2020 2320 7468 6520 4974 6572 6162 6c65    # the Iterable
+0002fd60: 2063 6865 636b 2069 7320 7265 7175 6972   check is requir
+0002fd70: 6564 2066 6f72 206d 7970 790a 2020 2020  ed for mypy.    
+0002fd80: 2020 2020 6966 2069 735f 7363 616c 6172      if is_scalar
+0002fd90: 286e 616d 6573 2920 6f72 206e 6f74 2069  (names) or not i
+0002fda0: 7369 6e73 7461 6e63 6528 6e61 6d65 732c  sinstance(names,
+0002fdb0: 2049 7465 7261 626c 6529 3a0a 2020 2020   Iterable):.    
+0002fdc0: 2020 2020 2020 2020 6e61 6d65 7320 3d20          names = 
+0002fdd0: 7b6e 616d 6573 7d0a 2020 2020 2020 2020  {names}.        
+0002fde0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0002fdf0: 2020 6e61 6d65 7320 3d20 7365 7428 6e61    names = set(na
+0002fe00: 6d65 7329 0a20 2020 2020 2020 2069 6620  mes).        if 
+0002fe10: 6572 726f 7273 203d 3d20 2272 6169 7365  errors == "raise
+0002fe20: 223a 0a20 2020 2020 2020 2020 2020 2073  ":.            s
+0002fe30: 656c 662e 5f61 7373 6572 745f 616c 6c5f  elf._assert_all_
+0002fe40: 696e 5f64 6174 6173 6574 286e 616d 6573  in_dataset(names
+0002fe50: 290a 0a20 2020 2020 2020 2023 2047 4836  )..        # GH6
+0002fe60: 3530 350a 2020 2020 2020 2020 6f74 6865  505.        othe
+0002fe70: 725f 6e61 6d65 7320 3d20 7365 7428 290a  r_names = set().
+0002fe80: 2020 2020 2020 2020 666f 7220 7661 7220          for var 
+0002fe90: 696e 206e 616d 6573 3a0a 2020 2020 2020  in names:.      
+0002fea0: 2020 2020 2020 6d61 7962 655f 6d69 6478        maybe_midx
+0002feb0: 203d 2073 656c 662e 5f69 6e64 6578 6573   = self._indexes
+0002fec0: 2e67 6574 2876 6172 2c20 4e6f 6e65 290a  .get(var, None).
+0002fed0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0002fee0: 7369 6e73 7461 6e63 6528 6d61 7962 655f  sinstance(maybe_
+0002fef0: 6d69 6478 2c20 5061 6e64 6173 4d75 6c74  midx, PandasMult
+0002ff00: 6949 6e64 6578 293a 0a20 2020 2020 2020  iIndex):.       
+0002ff10: 2020 2020 2020 2020 2069 6478 5f63 6f6f           idx_coo
+0002ff20: 7264 5f6e 616d 6573 203d 2073 6574 286d  rd_names = set(m
+0002ff30: 6179 6265 5f6d 6964 782e 696e 6465 782e  aybe_midx.index.
+0002ff40: 6e61 6d65 7320 2b20 5b6d 6179 6265 5f6d  names + [maybe_m
+0002ff50: 6964 782e 6469 6d5d 290a 2020 2020 2020  idx.dim]).      
+0002ff60: 2020 2020 2020 2020 2020 6964 785f 6f74            idx_ot
+0002ff70: 6865 725f 6e61 6d65 7320 3d20 6964 785f  her_names = idx_
+0002ff80: 636f 6f72 645f 6e61 6d65 7320 2d20 7365  coord_names - se
+0002ff90: 7428 6e61 6d65 7329 0a20 2020 2020 2020  t(names).       
+0002ffa0: 2020 2020 2020 2020 206f 7468 6572 5f6e           other_n
+0002ffb0: 616d 6573 2e75 7064 6174 6528 6964 785f  ames.update(idx_
+0002ffc0: 6f74 6865 725f 6e61 6d65 7329 0a20 2020  other_names).   
+0002ffd0: 2020 2020 2069 6620 6f74 6865 725f 6e61       if other_na
+0002ffe0: 6d65 733a 0a20 2020 2020 2020 2020 2020  mes:.           
+0002fff0: 206e 616d 6573 207c 3d20 7365 7428 6f74   names |= set(ot
+00030000: 6865 725f 6e61 6d65 7329 0a20 2020 2020  her_names).     
+00030010: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+00030020: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+00030030: 2020 2020 2020 6622 4465 6c65 7469 6e67        f"Deleting
+00030040: 2061 2073 696e 676c 6520 6c65 7665 6c20   a single level 
+00030050: 6f66 2061 204d 756c 7469 496e 6465 7820  of a MultiIndex 
+00030060: 6973 2064 6570 7265 6361 7465 642e 2050  is deprecated. P
+00030070: 7265 7669 6f75 736c 792c 2074 6869 7320  reviously, this 
+00030080: 6465 6c65 7465 6420 616c 6c20 6c65 7665  deleted all leve
+00030090: 6c73 206f 6620 6120 4d75 6c74 6949 6e64  ls of a MultiInd
+000300a0: 6578 2e20 220a 2020 2020 2020 2020 2020  ex. ".          
+000300b0: 2020 2020 2020 6622 506c 6561 7365 2061        f"Please a
+000300c0: 6c73 6f20 6472 6f70 2074 6865 2066 6f6c  lso drop the fol
+000300d0: 6c6f 7769 6e67 2076 6172 6961 626c 6573  lowing variables
+000300e0: 3a20 7b6f 7468 6572 5f6e 616d 6573 2172  : {other_names!r
+000300f0: 7d20 746f 2061 766f 6964 2061 6e20 6572  } to avoid an er
+00030100: 726f 7220 696e 2074 6865 2066 7574 7572  ror in the futur
+00030110: 652e 222c 0a20 2020 2020 2020 2020 2020  e.",.           
+00030120: 2020 2020 2044 6570 7265 6361 7469 6f6e       Deprecation
+00030130: 5761 726e 696e 672c 0a20 2020 2020 2020  Warning,.       
+00030140: 2020 2020 2020 2020 2073 7461 636b 6c65           stackle
+00030150: 7665 6c3d 322c 0a20 2020 2020 2020 2020  vel=2,.         
+00030160: 2020 2029 0a0a 2020 2020 2020 2020 6173     )..        as
+00030170: 7365 7274 5f6e 6f5f 696e 6465 785f 636f  sert_no_index_co
+00030180: 7272 7570 7465 6428 7365 6c66 2e78 696e  rrupted(self.xin
+00030190: 6465 7865 732c 206e 616d 6573 290a 0a20  dexes, names).. 
+000301a0: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+000301b0: 203d 207b 6b3a 2076 2066 6f72 206b 2c20   = {k: v for k, 
+000301c0: 7620 696e 2073 656c 662e 5f76 6172 6961  v in self._varia
+000301d0: 626c 6573 2e69 7465 6d73 2829 2069 6620  bles.items() if 
+000301e0: 6b20 6e6f 7420 696e 206e 616d 6573 7d0a  k not in names}.
+000301f0: 2020 2020 2020 2020 636f 6f72 645f 6e61          coord_na
+00030200: 6d65 7320 3d20 7b6b 2066 6f72 206b 2069  mes = {k for k i
+00030210: 6e20 7365 6c66 2e5f 636f 6f72 645f 6e61  n self._coord_na
+00030220: 6d65 7320 6966 206b 2069 6e20 7661 7269  mes if k in vari
+00030230: 6162 6c65 737d 0a20 2020 2020 2020 2069  ables}.        i
+00030240: 6e64 6578 6573 203d 207b 6b3a 2076 2066  ndexes = {k: v f
+00030250: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
+00030260: 5f69 6e64 6578 6573 2e69 7465 6d73 2829  _indexes.items()
+00030270: 2069 6620 6b20 6e6f 7420 696e 206e 616d   if k not in nam
+00030280: 6573 7d0a 2020 2020 2020 2020 7265 7475  es}.        retu
+00030290: 726e 2073 656c 662e 5f72 6570 6c61 6365  rn self._replace
+000302a0: 5f77 6974 685f 6e65 775f 6469 6d73 280a  _with_new_dims(.
+000302b0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+000302c0: 6162 6c65 732c 2063 6f6f 7264 5f6e 616d  ables, coord_nam
+000302d0: 6573 3d63 6f6f 7264 5f6e 616d 6573 2c20  es=coord_names, 
+000302e0: 696e 6465 7865 733d 696e 6465 7865 730a  indexes=indexes.
+000302f0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00030300: 6566 2064 726f 705f 696e 6465 7865 7328  ef drop_indexes(
+00030310: 0a20 2020 2020 2020 2073 656c 663a 2054  .        self: T
+00030320: 5f44 6174 6173 6574 2c0a 2020 2020 2020  _Dataset,.      
+00030330: 2020 636f 6f72 645f 6e61 6d65 733a 2048    coord_names: H
+00030340: 6173 6861 626c 6520 7c20 4974 6572 6162  ashable | Iterab
+00030350: 6c65 5b48 6173 6861 626c 655d 2c0a 2020  le[Hashable],.  
+00030360: 2020 2020 2020 2a2c 0a20 2020 2020 2020        *,.       
+00030370: 2065 7272 6f72 733a 2045 7272 6f72 4f70   errors: ErrorOp
+00030380: 7469 6f6e 7320 3d20 2272 6169 7365 222c  tions = "raise",
+00030390: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
+000303a0: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+000303b0: 4472 6f70 2074 6865 2069 6e64 6578 6573  Drop the indexes
+000303c0: 2061 7373 6967 6e65 6420 746f 2074 6865   assigned to the
+000303d0: 2067 6976 656e 2063 6f6f 7264 696e 6174   given coordinat
+000303e0: 6573 2e0a 0a20 2020 2020 2020 2050 6172  es...        Par
+000303f0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00030400: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00030410: 2020 2063 6f6f 7264 5f6e 616d 6573 203a     coord_names :
+00030420: 2068 6173 6861 626c 6520 6f72 2069 7465   hashable or ite
+00030430: 7261 626c 6520 6f66 2068 6173 6861 626c  rable of hashabl
+00030440: 650a 2020 2020 2020 2020 2020 2020 4e61  e.            Na
+00030450: 6d65 2873 2920 6f66 2074 6865 2063 6f6f  me(s) of the coo
+00030460: 7264 696e 6174 6528 7329 2066 6f72 2077  rdinate(s) for w
+00030470: 6869 6368 2074 6f20 6472 6f70 2074 6865  hich to drop the
+00030480: 2069 6e64 6578 2e0a 2020 2020 2020 2020   index..        
+00030490: 6572 726f 7273 203a 207b 2272 6169 7365  errors : {"raise
+000304a0: 222c 2022 6967 6e6f 7265 227d 2c20 6465  ", "ignore"}, de
+000304b0: 6661 756c 743a 2022 7261 6973 6522 0a20  fault: "raise". 
+000304c0: 2020 2020 2020 2020 2020 2049 6620 2772             If 'r
+000304d0: 6169 7365 272c 2072 6169 7365 7320 6120  aise', raises a 
+000304e0: 5661 6c75 6545 7272 6f72 2065 7272 6f72  ValueError error
+000304f0: 2069 6620 616e 7920 6f66 2074 6865 2063   if any of the c
+00030500: 6f6f 7264 696e 6174 6573 0a20 2020 2020  oordinates.     
+00030510: 2020 2020 2020 2070 6173 7365 6420 6861         passed ha
+00030520: 7665 206e 6f20 696e 6465 7820 6f72 2061  ve no index or a
+00030530: 7265 206e 6f74 2069 6e20 7468 6520 6461  re not in the da
+00030540: 7461 7365 742e 0a20 2020 2020 2020 2020  taset..         
+00030550: 2020 2049 6620 2769 676e 6f72 6527 2c20     If 'ignore', 
+00030560: 6e6f 2065 7272 6f72 2069 7320 7261 6973  no error is rais
+00030570: 6564 2e0a 0a20 2020 2020 2020 2052 6574  ed...        Ret
+00030580: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00030590: 2d2d 2d2d 0a20 2020 2020 2020 2064 726f  ----.        dro
+000305a0: 7070 6564 203a 2044 6174 6173 6574 0a20  pped : Dataset. 
+000305b0: 2020 2020 2020 2020 2020 2041 206e 6577             A new
+000305c0: 2064 6174 6173 6574 2077 6974 6820 6472   dataset with dr
+000305d0: 6f70 7065 6420 696e 6465 7865 732e 0a0a  opped indexes...
+000305e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000305f0: 2020 2020 2320 7468 6520 4974 6572 6162      # the Iterab
+00030600: 6c65 2063 6865 636b 2069 7320 7265 7175  le check is requ
+00030610: 6972 6564 2066 6f72 206d 7970 790a 2020  ired for mypy.  
+00030620: 2020 2020 2020 6966 2069 735f 7363 616c        if is_scal
+00030630: 6172 2863 6f6f 7264 5f6e 616d 6573 2920  ar(coord_names) 
+00030640: 6f72 206e 6f74 2069 7369 6e73 7461 6e63  or not isinstanc
+00030650: 6528 636f 6f72 645f 6e61 6d65 732c 2049  e(coord_names, I
+00030660: 7465 7261 626c 6529 3a0a 2020 2020 2020  terable):.      
+00030670: 2020 2020 2020 636f 6f72 645f 6e61 6d65        coord_name
+00030680: 7320 3d20 7b63 6f6f 7264 5f6e 616d 6573  s = {coord_names
+00030690: 7d0a 2020 2020 2020 2020 656c 7365 3a0a  }.        else:.
+000306a0: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
+000306b0: 645f 6e61 6d65 7320 3d20 7365 7428 636f  d_names = set(co
+000306c0: 6f72 645f 6e61 6d65 7329 0a0a 2020 2020  ord_names)..    
+000306d0: 2020 2020 6966 2065 7272 6f72 7320 3d3d      if errors ==
+000306e0: 2022 7261 6973 6522 3a0a 2020 2020 2020   "raise":.      
+000306f0: 2020 2020 2020 696e 7661 6c69 645f 636f        invalid_co
+00030700: 6f72 6473 203d 2063 6f6f 7264 5f6e 616d  ords = coord_nam
+00030710: 6573 202d 2073 656c 662e 5f63 6f6f 7264  es - self._coord
+00030720: 5f6e 616d 6573 0a20 2020 2020 2020 2020  _names.         
+00030730: 2020 2069 6620 696e 7661 6c69 645f 636f     if invalid_co
+00030740: 6f72 6473 3a0a 2020 2020 2020 2020 2020  ords:.          
+00030750: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00030760: 6545 7272 6f72 2866 2274 686f 7365 2063  eError(f"those c
+00030770: 6f6f 7264 696e 6174 6573 2064 6f6e 2774  oordinates don't
+00030780: 2065 7869 7374 3a20 7b69 6e76 616c 6964   exist: {invalid
+00030790: 5f63 6f6f 7264 737d 2229 0a0a 2020 2020  _coords}")..    
+000307a0: 2020 2020 2020 2020 756e 696e 6465 7865          unindexe
+000307b0: 645f 636f 6f72 6473 203d 2073 6574 2863  d_coords = set(c
+000307c0: 6f6f 7264 5f6e 616d 6573 2920 2d20 7365  oord_names) - se
+000307d0: 7428 7365 6c66 2e5f 696e 6465 7865 7329  t(self._indexes)
+000307e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000307f0: 756e 696e 6465 7865 645f 636f 6f72 6473  unindexed_coords
+00030800: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00030810: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00030820: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00030830: 2020 2020 2020 2020 6622 7468 6f73 6520          f"those 
+00030840: 636f 6f72 6469 6e61 7465 7320 646f 206e  coordinates do n
+00030850: 6f74 2068 6176 6520 616e 2069 6e64 6578  ot have an index
+00030860: 3a20 7b75 6e69 6e64 6578 6564 5f63 6f6f  : {unindexed_coo
+00030870: 7264 737d 220a 2020 2020 2020 2020 2020  rds}".          
+00030880: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00030890: 2061 7373 6572 745f 6e6f 5f69 6e64 6578   assert_no_index
+000308a0: 5f63 6f72 7275 7074 6564 2873 656c 662e  _corrupted(self.
+000308b0: 7869 6e64 6578 6573 2c20 636f 6f72 645f  xindexes, coord_
+000308c0: 6e61 6d65 732c 2061 6374 696f 6e3d 2272  names, action="r
+000308d0: 656d 6f76 6520 696e 6465 7828 6573 2922  emove index(es)"
+000308e0: 290a 0a20 2020 2020 2020 2076 6172 6961  )..        varia
+000308f0: 626c 6573 203d 207b 7d0a 2020 2020 2020  bles = {}.      
+00030900: 2020 666f 7220 6e61 6d65 2c20 7661 7220    for name, var 
+00030910: 696e 2073 656c 662e 5f76 6172 6961 626c  in self._variabl
+00030920: 6573 2e69 7465 6d73 2829 3a0a 2020 2020  es.items():.    
+00030930: 2020 2020 2020 2020 6966 206e 616d 6520          if name 
+00030940: 696e 2063 6f6f 7264 5f6e 616d 6573 3a0a  in coord_names:.
+00030950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030960: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
+00030970: 3d20 7661 722e 746f 5f62 6173 655f 7661  = var.to_base_va
+00030980: 7269 6162 6c65 2829 0a20 2020 2020 2020  riable().       
+00030990: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+000309a0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+000309b0: 626c 6573 5b6e 616d 655d 203d 2076 6172  bles[name] = var
+000309c0: 0a0a 2020 2020 2020 2020 696e 6465 7865  ..        indexe
+000309d0: 7320 3d20 7b6b 3a20 7620 666f 7220 6b2c  s = {k: v for k,
+000309e0: 2076 2069 6e20 7365 6c66 2e5f 696e 6465   v in self._inde
+000309f0: 7865 732e 6974 656d 7328 2920 6966 206b  xes.items() if k
+00030a00: 206e 6f74 2069 6e20 636f 6f72 645f 6e61   not in coord_na
+00030a10: 6d65 737d 0a0a 2020 2020 2020 2020 7265  mes}..        re
+00030a20: 7475 726e 2073 656c 662e 5f72 6570 6c61  turn self._repla
+00030a30: 6365 2876 6172 6961 626c 6573 3d76 6172  ce(variables=var
+00030a40: 6961 626c 6573 2c20 696e 6465 7865 733d  iables, indexes=
+00030a50: 696e 6465 7865 7329 0a0a 2020 2020 6465  indexes)..    de
+00030a60: 6620 6472 6f70 280a 2020 2020 2020 2020  f drop(.        
+00030a70: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+00030a80: 0a20 2020 2020 2020 206c 6162 656c 733d  .        labels=
+00030a90: 4e6f 6e65 2c0a 2020 2020 2020 2020 6469  None,.        di
+00030aa0: 6d3d 4e6f 6e65 2c0a 2020 2020 2020 2020  m=None,.        
+00030ab0: 2a2c 0a20 2020 2020 2020 2065 7272 6f72  *,.        error
+00030ac0: 733a 2045 7272 6f72 4f70 7469 6f6e 7320  s: ErrorOptions 
+00030ad0: 3d20 2272 6169 7365 222c 0a20 2020 2020  = "raise",.     
+00030ae0: 2020 202a 2a6c 6162 656c 735f 6b77 6172     **labels_kwar
+00030af0: 6773 2c0a 2020 2020 2920 2d3e 2054 5f44  gs,.    ) -> T_D
+00030b00: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00030b10: 2222 2242 6163 6b77 6172 6420 636f 6d70  """Backward comp
+00030b20: 6174 6962 6c65 206d 6574 686f 6420 6261  atible method ba
+00030b30: 7365 6420 6f6e 2060 6472 6f70 5f76 6172  sed on `drop_var
+00030b40: 7360 2061 6e64 2060 6472 6f70 5f73 656c  s` and `drop_sel
+00030b50: 600a 0a20 2020 2020 2020 2055 7369 6e67  `..        Using
+00030b60: 2065 6974 6865 7220 6064 726f 705f 7661   either `drop_va
+00030b70: 7273 6020 6f72 2060 6472 6f70 5f73 656c  rs` or `drop_sel
+00030b80: 6020 6973 2065 6e63 6f75 7261 6765 640a  ` is encouraged.
+00030b90: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+00030ba0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+00030bb0: 2d2d 0a20 2020 2020 2020 2044 6174 6173  --.        Datas
+00030bc0: 6574 2e64 726f 705f 7661 7273 0a20 2020  et.drop_vars.   
+00030bd0: 2020 2020 2044 6174 6173 6574 2e64 726f       Dataset.dro
+00030be0: 705f 7365 6c0a 2020 2020 2020 2020 2222  p_sel.        ""
+00030bf0: 220a 2020 2020 2020 2020 6966 2065 7272  ".        if err
+00030c00: 6f72 7320 6e6f 7420 696e 205b 2272 6169  ors not in ["rai
+00030c10: 7365 222c 2022 6967 6e6f 7265 225d 3a0a  se", "ignore"]:.
+00030c20: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00030c30: 6520 5661 6c75 6545 7272 6f72 2827 6572  e ValueError('er
+00030c40: 726f 7273 206d 7573 7420 6265 2065 6974  rors must be eit
+00030c50: 6865 7220 2272 6169 7365 2220 6f72 2022  her "raise" or "
+00030c60: 6967 6e6f 7265 2227 290a 0a20 2020 2020  ignore"')..     
+00030c70: 2020 2069 6620 6973 5f64 6963 745f 6c69     if is_dict_li
+00030c80: 6b65 286c 6162 656c 7329 2061 6e64 206e  ke(labels) and n
+00030c90: 6f74 2069 7369 6e73 7461 6e63 6528 6c61  ot isinstance(la
+00030ca0: 6265 6c73 2c20 6469 6374 293a 0a20 2020  bels, dict):.   
+00030cb0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+00030cc0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00030cd0: 2020 2020 2020 2020 2264 726f 7070 696e          "droppin
+00030ce0: 6720 636f 6f72 6469 6e61 7465 7320 7573  g coordinates us
+00030cf0: 696e 6720 6064 726f 7060 2069 7320 6265  ing `drop` is be
+00030d00: 2064 6570 7265 6361 7465 643b 2075 7365   deprecated; use
+00030d10: 2064 726f 705f 7661 7273 2e22 2c0a 2020   drop_vars.",.  
+00030d20: 2020 2020 2020 2020 2020 2020 2020 4675                Fu
+00030d30: 7475 7265 5761 726e 696e 672c 0a20 2020  tureWarning,.   
+00030d40: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+00030d50: 636b 6c65 7665 6c3d 322c 0a20 2020 2020  cklevel=2,.     
+00030d60: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00030d70: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00030d80: 2e64 726f 705f 7661 7273 286c 6162 656c  .drop_vars(label
+00030d90: 732c 2065 7272 6f72 733d 6572 726f 7273  s, errors=errors
+00030da0: 290a 0a20 2020 2020 2020 2069 6620 6c61  )..        if la
+00030db0: 6265 6c73 5f6b 7761 7267 7320 6f72 2069  bels_kwargs or i
+00030dc0: 7369 6e73 7461 6e63 6528 6c61 6265 6c73  sinstance(labels
+00030dd0: 2c20 6469 6374 293a 0a20 2020 2020 2020  , dict):.       
+00030de0: 2020 2020 2069 6620 6469 6d20 6973 206e       if dim is n
+00030df0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+00030e00: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00030e10: 616c 7565 4572 726f 7228 2263 616e 6e6f  alueError("canno
+00030e20: 7420 7370 6563 6966 7920 6469 6d20 616e  t specify dim an
+00030e30: 6420 6469 6374 2d6c 696b 6520 6172 6775  d dict-like argu
+00030e40: 6d65 6e74 732e 2229 0a20 2020 2020 2020  ments.").       
+00030e50: 2020 2020 206c 6162 656c 7320 3d20 6569       labels = ei
+00030e60: 7468 6572 5f64 6963 745f 6f72 5f6b 7761  ther_dict_or_kwa
+00030e70: 7267 7328 6c61 6265 6c73 2c20 6c61 6265  rgs(labels, labe
+00030e80: 6c73 5f6b 7761 7267 732c 2022 6472 6f70  ls_kwargs, "drop
+00030e90: 2229 0a0a 2020 2020 2020 2020 6966 2064  ")..        if d
+00030ea0: 696d 2069 7320 4e6f 6e65 2061 6e64 2028  im is None and (
+00030eb0: 6973 5f73 6361 6c61 7228 6c61 6265 6c73  is_scalar(labels
+00030ec0: 2920 6f72 2069 7369 6e73 7461 6e63 6528  ) or isinstance(
+00030ed0: 6c61 6265 6c73 2c20 4974 6572 6162 6c65  labels, Iterable
+00030ee0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00030ef0: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
+00030f00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00030f10: 6472 6f70 7069 6e67 2076 6172 6961 626c  dropping variabl
+00030f20: 6573 2075 7369 6e67 2060 6472 6f70 6020  es using `drop` 
+00030f30: 7769 6c6c 2062 6520 6465 7072 6563 6174  will be deprecat
+00030f40: 6564 3b20 7573 696e 6720 6472 6f70 5f76  ed; using drop_v
+00030f50: 6172 7320 6973 2065 6e63 6f75 7261 6765  ars is encourage
+00030f60: 642e 222c 0a20 2020 2020 2020 2020 2020  d.",.           
+00030f70: 2020 2020 2050 656e 6469 6e67 4465 7072       PendingDepr
+00030f80: 6563 6174 696f 6e57 6172 6e69 6e67 2c0a  ecationWarning,.
+00030f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00030fa0: 7374 6163 6b6c 6576 656c 3d32 2c0a 2020  stacklevel=2,.  
+00030fb0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00030fc0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00030fd0: 656c 662e 6472 6f70 5f76 6172 7328 6c61  elf.drop_vars(la
+00030fe0: 6265 6c73 2c20 6572 726f 7273 3d65 7272  bels, errors=err
+00030ff0: 6f72 7329 0a20 2020 2020 2020 2069 6620  ors).        if 
+00031000: 6469 6d20 6973 206e 6f74 204e 6f6e 653a  dim is not None:
+00031010: 0a20 2020 2020 2020 2020 2020 2077 6172  .            war
+00031020: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
+00031030: 2020 2020 2020 2020 2020 2020 2264 726f              "dro
+00031040: 7070 696e 6720 6c61 6265 6c73 2075 7369  pping labels usi
+00031050: 6e67 206c 6973 742d 6c69 6b65 206c 6162  ng list-like lab
+00031060: 656c 7320 6973 2064 6570 7265 6361 7465  els is deprecate
+00031070: 643b 2075 7369 6e67 2022 0a20 2020 2020  d; using ".     
+00031080: 2020 2020 2020 2020 2020 2022 6469 6374             "dict
+00031090: 2d6c 696b 6520 6172 6775 6d65 6e74 7320  -like arguments 
+000310a0: 7769 7468 2060 6472 6f70 5f73 656c 602c  with `drop_sel`,
+000310b0: 2065 2e67 2e20 6064 732e 6472 6f70 5f73   e.g. `ds.drop_s
+000310c0: 656c 2864 696d 3d5b 6c61 6265 6c73 5d29  el(dim=[labels])
+000310d0: 2e22 2c0a 2020 2020 2020 2020 2020 2020  .",.            
+000310e0: 2020 2020 4465 7072 6563 6174 696f 6e57      DeprecationW
+000310f0: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
+00031100: 2020 2020 2020 2020 7374 6163 6b6c 6576          stacklev
+00031110: 656c 3d32 2c0a 2020 2020 2020 2020 2020  el=2,.          
+00031120: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00031130: 7265 7475 726e 2073 656c 662e 6472 6f70  return self.drop
+00031140: 5f73 656c 287b 6469 6d3a 206c 6162 656c  _sel({dim: label
+00031150: 737d 2c20 6572 726f 7273 3d65 7272 6f72  s}, errors=error
+00031160: 732c 202a 2a6c 6162 656c 735f 6b77 6172  s, **labels_kwar
+00031170: 6773 290a 0a20 2020 2020 2020 2077 6172  gs)..        war
+00031180: 6e69 6e67 732e 7761 726e 280a 2020 2020  nings.warn(.    
+00031190: 2020 2020 2020 2020 2264 726f 7070 696e          "droppin
+000311a0: 6720 6c61 6265 6c73 2075 7369 6e67 2060  g labels using `
+000311b0: 6472 6f70 6020 7769 6c6c 2062 6520 6465  drop` will be de
+000311c0: 7072 6563 6174 6564 3b20 7573 696e 6720  precated; using 
+000311d0: 6472 6f70 5f73 656c 2069 7320 656e 636f  drop_sel is enco
+000311e0: 7572 6167 6564 2e22 2c0a 2020 2020 2020  uraged.",.      
+000311f0: 2020 2020 2020 5065 6e64 696e 6744 6570        PendingDep
+00031200: 7265 6361 7469 6f6e 5761 726e 696e 672c  recationWarning,
+00031210: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+00031220: 636b 6c65 7665 6c3d 322c 0a20 2020 2020  cklevel=2,.     
+00031230: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00031240: 7572 6e20 7365 6c66 2e64 726f 705f 7365  urn self.drop_se
+00031250: 6c28 6c61 6265 6c73 2c20 6572 726f 7273  l(labels, errors
+00031260: 3d65 7272 6f72 7329 0a0a 2020 2020 6465  =errors)..    de
+00031270: 6620 6472 6f70 5f73 656c 280a 2020 2020  f drop_sel(.    
+00031280: 2020 2020 7365 6c66 3a20 545f 4461 7461      self: T_Data
+00031290: 7365 742c 206c 6162 656c 733d 4e6f 6e65  set, labels=None
+000312a0: 2c20 2a2c 2065 7272 6f72 733a 2045 7272  , *, errors: Err
+000312b0: 6f72 4f70 7469 6f6e 7320 3d20 2272 6169  orOptions = "rai
+000312c0: 7365 222c 202a 2a6c 6162 656c 735f 6b77  se", **labels_kw
+000312d0: 6172 6773 0a20 2020 2029 202d 3e20 545f  args.    ) -> T_
+000312e0: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
+000312f0: 2022 2222 4472 6f70 2069 6e64 6578 206c   """Drop index l
+00031300: 6162 656c 7320 6672 6f6d 2074 6869 7320  abels from this 
+00031310: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
+00031320: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00031330: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00031340: 2020 2020 2020 2020 6c61 6265 6c73 203a          labels :
+00031350: 206d 6170 7069 6e67 206f 6620 6861 7368   mapping of hash
+00031360: 6162 6c65 2074 6f20 416e 790a 2020 2020  able to Any.    
+00031370: 2020 2020 2020 2020 496e 6465 7820 6c61          Index la
+00031380: 6265 6c73 2074 6f20 6472 6f70 0a20 2020  bels to drop.   
+00031390: 2020 2020 2065 7272 6f72 7320 3a20 7b22       errors : {"
+000313a0: 7261 6973 6522 2c20 2269 676e 6f72 6522  raise", "ignore"
+000313b0: 7d2c 2064 6566 6175 6c74 3a20 2272 6169  }, default: "rai
+000313c0: 7365 220a 2020 2020 2020 2020 2020 2020  se".            
+000313d0: 4966 2027 7261 6973 6527 2c20 7261 6973  If 'raise', rais
+000313e0: 6573 2061 2056 616c 7565 4572 726f 7220  es a ValueError 
+000313f0: 6572 726f 7220 6966 0a20 2020 2020 2020  error if.       
+00031400: 2020 2020 2061 6e79 206f 6620 7468 6520       any of the 
+00031410: 696e 6465 7820 6c61 6265 6c73 2070 6173  index labels pas
+00031420: 7365 6420 6172 6520 6e6f 740a 2020 2020  sed are not.    
+00031430: 2020 2020 2020 2020 696e 2074 6865 2064          in the d
+00031440: 6174 6173 6574 2e20 4966 2027 6967 6e6f  ataset. If 'igno
+00031450: 7265 272c 2061 6e79 2067 6976 656e 206c  re', any given l
+00031460: 6162 656c 7320 7468 6174 2061 7265 2069  abels that are i
+00031470: 6e20 7468 650a 2020 2020 2020 2020 2020  n the.          
+00031480: 2020 6461 7461 7365 7420 6172 6520 6472    dataset are dr
+00031490: 6f70 7065 6420 616e 6420 6e6f 2065 7272  opped and no err
+000314a0: 6f72 2069 7320 7261 6973 6564 2e0a 2020  or is raised..  
+000314b0: 2020 2020 2020 2a2a 6c61 6265 6c73 5f6b        **labels_k
+000314c0: 7761 7267 7320 3a20 7b64 696d 3a20 6c61  wargs : {dim: la
+000314d0: 6265 6c2c 202e 2e2e 7d2c 206f 7074 696f  bel, ...}, optio
+000314e0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+000314f0: 5468 6520 6b65 7977 6f72 6420 6172 6775  The keyword argu
+00031500: 6d65 6e74 7320 666f 726d 206f 6620 6060  ments form of ``
+00031510: 6469 6d60 6020 616e 6420 6060 6c61 6265  dim`` and ``labe
+00031520: 6c73 6060 0a0a 2020 2020 2020 2020 5265  ls``..        Re
+00031530: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+00031540: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6472  -----.        dr
+00031550: 6f70 7065 6420 3a20 4461 7461 7365 740a  opped : Dataset.
+00031560: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+00031570: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00031580: 2d2d 0a20 2020 2020 2020 203e 3e3e 2064  --.        >>> d
+00031590: 6174 6120 3d20 6e70 2e61 7261 6e67 6528  ata = np.arange(
+000315a0: 3629 2e72 6573 6861 7065 2832 2c20 3329  6).reshape(2, 3)
+000315b0: 0a20 2020 2020 2020 203e 3e3e 206c 6162  .        >>> lab
+000315c0: 656c 7320 3d20 5b22 6122 2c20 2262 222c  els = ["a", "b",
+000315d0: 2022 6322 5d0a 2020 2020 2020 2020 3e3e   "c"].        >>
+000315e0: 3e20 6473 203d 2078 722e 4461 7461 7365  > ds = xr.Datase
+000315f0: 7428 7b22 4122 3a20 285b 2278 222c 2022  t({"A": (["x", "
+00031600: 7922 5d2c 2064 6174 6129 2c20 2279 223a  y"], data), "y":
+00031610: 206c 6162 656c 737d 290a 2020 2020 2020   labels}).      
+00031620: 2020 3e3e 3e20 6473 0a20 2020 2020 2020    >>> ds.       
+00031630: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+00031640: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
+00031650: 696f 6e73 3a20 2028 783a 2032 2c20 793a  ions:  (x: 2, y:
+00031660: 2033 290a 2020 2020 2020 2020 436f 6f72   3).        Coor
+00031670: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
+00031680: 2020 202a 2079 2020 2020 2020 2020 2879     * y        (y
+00031690: 2920 3c55 3120 2761 2720 2762 2720 2763  ) <U1 'a' 'b' 'c
+000316a0: 270a 2020 2020 2020 2020 4469 6d65 6e73  '.        Dimens
+000316b0: 696f 6e73 2077 6974 686f 7574 2063 6f6f  ions without coo
+000316c0: 7264 696e 6174 6573 3a20 780a 2020 2020  rdinates: x.    
+000316d0: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
+000316e0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+000316f0: 4120 2020 2020 2020 2028 782c 2079 2920  A        (x, y) 
+00031700: 696e 7436 3420 3020 3120 3220 3320 3420  int64 0 1 2 3 4 
+00031710: 350a 2020 2020 2020 2020 3e3e 3e20 6473  5.        >>> ds
+00031720: 2e64 726f 705f 7365 6c28 793d 5b22 6122  .drop_sel(y=["a"
+00031730: 2c20 2263 225d 290a 2020 2020 2020 2020  , "c"]).        
+00031740: 3c78 6172 7261 792e 4461 7461 7365 743e  <xarray.Dataset>
+00031750: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
+00031760: 6f6e 733a 2020 2878 3a20 322c 2079 3a20  ons:  (x: 2, y: 
+00031770: 3129 0a20 2020 2020 2020 2043 6f6f 7264  1).        Coord
+00031780: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
+00031790: 2020 2a20 7920 2020 2020 2020 2028 7929    * y        (y)
+000317a0: 203c 5531 2027 6227 0a20 2020 2020 2020   <U1 'b'.       
+000317b0: 2044 696d 656e 7369 6f6e 7320 7769 7468   Dimensions with
+000317c0: 6f75 7420 636f 6f72 6469 6e61 7465 733a  out coordinates:
+000317d0: 2078 0a20 2020 2020 2020 2044 6174 6120   x.        Data 
+000317e0: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
+000317f0: 2020 2020 2020 2041 2020 2020 2020 2020         A        
+00031800: 2878 2c20 7929 2069 6e74 3634 2031 2034  (x, y) int64 1 4
+00031810: 0a20 2020 2020 2020 203e 3e3e 2064 732e  .        >>> ds.
+00031820: 6472 6f70 5f73 656c 2879 3d22 6222 290a  drop_sel(y="b").
+00031830: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
+00031840: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
+00031850: 2044 696d 656e 7369 6f6e 733a 2020 2878   Dimensions:  (x
+00031860: 3a20 322c 2079 3a20 3229 0a20 2020 2020  : 2, y: 2).     
+00031870: 2020 2043 6f6f 7264 696e 6174 6573 3a0a     Coordinates:.
+00031880: 2020 2020 2020 2020 2020 2a20 7920 2020            * y   
+00031890: 2020 2020 2028 7929 203c 5531 2027 6127       (y) <U1 'a'
+000318a0: 2027 6327 0a20 2020 2020 2020 2044 696d   'c'.        Dim
+000318b0: 656e 7369 6f6e 7320 7769 7468 6f75 7420  ensions without 
+000318c0: 636f 6f72 6469 6e61 7465 733a 2078 0a20  coordinates: x. 
+000318d0: 2020 2020 2020 2044 6174 6120 7661 7269         Data vari
+000318e0: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
+000318f0: 2020 2041 2020 2020 2020 2020 2878 2c20     A        (x, 
+00031900: 7929 2069 6e74 3634 2030 2032 2033 2035  y) int64 0 2 3 5
+00031910: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00031920: 2020 2020 2069 6620 6572 726f 7273 206e       if errors n
+00031930: 6f74 2069 6e20 5b22 7261 6973 6522 2c20  ot in ["raise", 
+00031940: 2269 676e 6f72 6522 5d3a 0a20 2020 2020  "ignore"]:.     
+00031950: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00031960: 7565 4572 726f 7228 2765 7272 6f72 7320  ueError('errors 
+00031970: 6d75 7374 2062 6520 6569 7468 6572 2022  must be either "
+00031980: 7261 6973 6522 206f 7220 2269 676e 6f72  raise" or "ignor
+00031990: 6522 2729 0a0a 2020 2020 2020 2020 6c61  e"')..        la
+000319a0: 6265 6c73 203d 2065 6974 6865 725f 6469  bels = either_di
+000319b0: 6374 5f6f 725f 6b77 6172 6773 286c 6162  ct_or_kwargs(lab
+000319c0: 656c 732c 206c 6162 656c 735f 6b77 6172  els, labels_kwar
+000319d0: 6773 2c20 2264 726f 705f 7365 6c22 290a  gs, "drop_sel").
+000319e0: 0a20 2020 2020 2020 2064 7320 3d20 7365  .        ds = se
+000319f0: 6c66 0a20 2020 2020 2020 2066 6f72 2064  lf.        for d
+00031a00: 696d 2c20 6c61 6265 6c73 5f66 6f72 5f64  im, labels_for_d
+00031a10: 696d 2069 6e20 6c61 6265 6c73 2e69 7465  im in labels.ite
+00031a20: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
+00031a30: 2020 2320 446f 6e27 7420 6361 7374 2074    # Don't cast t
+00031a40: 6f20 7365 742c 2061 7320 6974 2077 6f75  o set, as it wou
+00031a50: 6c64 2068 6172 6d20 7065 7266 6f72 6d61  ld harm performa
+00031a60: 6e63 6520 7768 656e 206c 6162 656c 730a  nce when labels.
+00031a70: 2020 2020 2020 2020 2020 2020 2320 6973              # is
+00031a80: 2061 206c 6172 6765 206e 756d 7079 2061   a large numpy a
+00031a90: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00031aa0: 2069 6620 7574 696c 732e 6973 5f73 6361   if utils.is_sca
+00031ab0: 6c61 7228 6c61 6265 6c73 5f66 6f72 5f64  lar(labels_for_d
+00031ac0: 696d 293a 0a20 2020 2020 2020 2020 2020  im):.           
+00031ad0: 2020 2020 206c 6162 656c 735f 666f 725f       labels_for_
+00031ae0: 6469 6d20 3d20 5b6c 6162 656c 735f 666f  dim = [labels_fo
+00031af0: 725f 6469 6d5d 0a20 2020 2020 2020 2020  r_dim].         
+00031b00: 2020 206c 6162 656c 735f 666f 725f 6469     labels_for_di
+00031b10: 6d20 3d20 6e70 2e61 7361 7272 6179 286c  m = np.asarray(l
+00031b20: 6162 656c 735f 666f 725f 6469 6d29 0a20  abels_for_dim). 
+00031b30: 2020 2020 2020 2020 2020 2074 7279 3a0a             try:.
+00031b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00031b50: 696e 6465 7820 3d20 7365 6c66 2e67 6574  index = self.get
+00031b60: 5f69 6e64 6578 2864 696d 290a 2020 2020  _index(dim).    
+00031b70: 2020 2020 2020 2020 6578 6365 7074 204b          except K
+00031b80: 6579 4572 726f 723a 0a20 2020 2020 2020  eyError:.       
+00031b90: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00031ba0: 616c 7565 4572 726f 7228 6622 6469 6d65  alueError(f"dime
+00031bb0: 6e73 696f 6e20 7b64 696d 2172 7d20 646f  nsion {dim!r} do
+00031bc0: 6573 206e 6f74 2068 6176 6520 636f 6f72  es not have coor
+00031bd0: 6469 6e61 7465 206c 6162 656c 7322 290a  dinate labels").
+00031be0: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
+00031bf0: 696e 6465 7820 3d20 696e 6465 782e 6472  index = index.dr
+00031c00: 6f70 286c 6162 656c 735f 666f 725f 6469  op(labels_for_di
+00031c10: 6d2c 2065 7272 6f72 733d 6572 726f 7273  m, errors=errors
+00031c20: 290a 2020 2020 2020 2020 2020 2020 6473  ).            ds
+00031c30: 203d 2064 732e 6c6f 635b 7b64 696d 3a20   = ds.loc[{dim: 
+00031c40: 6e65 775f 696e 6465 787d 5d0a 2020 2020  new_index}].    
+00031c50: 2020 2020 7265 7475 726e 2064 730a 0a20      return ds.. 
+00031c60: 2020 2064 6566 2064 726f 705f 6973 656c     def drop_isel
+00031c70: 2873 656c 663a 2054 5f44 6174 6173 6574  (self: T_Dataset
+00031c80: 2c20 696e 6465 7865 7273 3d4e 6f6e 652c  , indexers=None,
+00031c90: 202a 2a69 6e64 6578 6572 735f 6b77 6172   **indexers_kwar
+00031ca0: 6773 2920 2d3e 2054 5f44 6174 6173 6574  gs) -> T_Dataset
+00031cb0: 3a0a 2020 2020 2020 2020 2222 2244 726f  :.        """Dro
+00031cc0: 7020 696e 6465 7820 706f 7369 7469 6f6e  p index position
+00031cd0: 7320 6672 6f6d 2074 6869 7320 4461 7461  s from this Data
+00031ce0: 7365 742e 0a0a 2020 2020 2020 2020 5061  set...        Pa
+00031cf0: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00031d00: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00031d10: 2020 2020 696e 6465 7865 7273 203a 206d      indexers : m
+00031d20: 6170 7069 6e67 206f 6620 6861 7368 6162  apping of hashab
+00031d30: 6c65 2074 6f20 416e 790a 2020 2020 2020  le to Any.      
+00031d40: 2020 2020 2020 496e 6465 7820 6c6f 6361        Index loca
+00031d50: 7469 6f6e 7320 746f 2064 726f 700a 2020  tions to drop.  
+00031d60: 2020 2020 2020 2a2a 696e 6465 7865 7273        **indexers
+00031d70: 5f6b 7761 7267 7320 3a20 7b64 696d 3a20  _kwargs : {dim: 
+00031d80: 706f 7369 7469 6f6e 2c20 2e2e 2e7d 2c20  position, ...}, 
+00031d90: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+00031da0: 2020 2020 2054 6865 206b 6579 776f 7264       The keyword
+00031db0: 2061 7267 756d 656e 7473 2066 6f72 6d20   arguments form 
+00031dc0: 6f66 2060 6064 696d 6060 2061 6e64 2060  of ``dim`` and `
+00031dd0: 6070 6f73 6974 696f 6e73 6060 0a0a 2020  `positions``..  
+00031de0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00031df0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00031e00: 2020 2020 2020 6472 6f70 7065 6420 3a20        dropped : 
+00031e10: 4461 7461 7365 740a 0a20 2020 2020 2020  Dataset..       
+00031e20: 2052 6169 7365 730a 2020 2020 2020 2020   Raises.        
+00031e30: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2049  ------.        I
+00031e40: 6e64 6578 4572 726f 720a 0a20 2020 2020  ndexError..     
+00031e50: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
+00031e60: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+00031e70: 2020 2020 203e 3e3e 2064 6174 6120 3d20       >>> data = 
+00031e80: 6e70 2e61 7261 6e67 6528 3629 2e72 6573  np.arange(6).res
+00031e90: 6861 7065 2832 2c20 3329 0a20 2020 2020  hape(2, 3).     
+00031ea0: 2020 203e 3e3e 206c 6162 656c 7320 3d20     >>> labels = 
+00031eb0: 5b22 6122 2c20 2262 222c 2022 6322 5d0a  ["a", "b", "c"].
+00031ec0: 2020 2020 2020 2020 3e3e 3e20 6473 203d          >>> ds =
+00031ed0: 2078 722e 4461 7461 7365 7428 7b22 4122   xr.Dataset({"A"
+00031ee0: 3a20 285b 2278 222c 2022 7922 5d2c 2064  : (["x", "y"], d
+00031ef0: 6174 6129 2c20 2279 223a 206c 6162 656c  ata), "y": label
+00031f00: 737d 290a 2020 2020 2020 2020 3e3e 3e20  s}).        >>> 
+00031f10: 6473 0a20 2020 2020 2020 203c 7861 7272  ds.        <xarr
+00031f20: 6179 2e44 6174 6173 6574 3e0a 2020 2020  ay.Dataset>.    
+00031f30: 2020 2020 4469 6d65 6e73 696f 6e73 3a20      Dimensions: 
+00031f40: 2028 783a 2032 2c20 793a 2033 290a 2020   (x: 2, y: 3).  
+00031f50: 2020 2020 2020 436f 6f72 6469 6e61 7465        Coordinate
+00031f60: 733a 0a20 2020 2020 2020 2020 202a 2079  s:.          * y
+00031f70: 2020 2020 2020 2020 2879 2920 3c55 3120          (y) <U1 
+00031f80: 2761 2720 2762 2720 2763 270a 2020 2020  'a' 'b' 'c'.    
+00031f90: 2020 2020 4469 6d65 6e73 696f 6e73 2077      Dimensions w
+00031fa0: 6974 686f 7574 2063 6f6f 7264 696e 6174  ithout coordinat
+00031fb0: 6573 3a20 780a 2020 2020 2020 2020 4461  es: x.        Da
+00031fc0: 7461 2076 6172 6961 626c 6573 3a0a 2020  ta variables:.  
+00031fd0: 2020 2020 2020 2020 2020 4120 2020 2020            A     
+00031fe0: 2020 2028 782c 2079 2920 696e 7436 3420     (x, y) int64 
+00031ff0: 3020 3120 3220 3320 3420 350a 2020 2020  0 1 2 3 4 5.    
+00032000: 2020 2020 3e3e 3e20 6473 2e64 726f 705f      >>> ds.drop_
+00032010: 6973 656c 2879 3d5b 302c 2032 5d29 0a20  isel(y=[0, 2]). 
+00032020: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
+00032030: 6174 6173 6574 3e0a 2020 2020 2020 2020  ataset>.        
+00032040: 4469 6d65 6e73 696f 6e73 3a20 2028 783a  Dimensions:  (x:
+00032050: 2032 2c20 793a 2031 290a 2020 2020 2020   2, y: 1).      
+00032060: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
+00032070: 2020 2020 2020 2020 202a 2079 2020 2020           * y    
+00032080: 2020 2020 2879 2920 3c55 3120 2762 270a      (y) <U1 'b'.
+00032090: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+000320a0: 6e73 2077 6974 686f 7574 2063 6f6f 7264  ns without coord
+000320b0: 696e 6174 6573 3a20 780a 2020 2020 2020  inates: x.      
+000320c0: 2020 4461 7461 2076 6172 6961 626c 6573    Data variables
+000320d0: 3a0a 2020 2020 2020 2020 2020 2020 4120  :.            A 
+000320e0: 2020 2020 2020 2028 782c 2079 2920 696e         (x, y) in
+000320f0: 7436 3420 3120 340a 2020 2020 2020 2020  t64 1 4.        
+00032100: 3e3e 3e20 6473 2e64 726f 705f 6973 656c  >>> ds.drop_isel
+00032110: 2879 3d31 290a 2020 2020 2020 2020 3c78  (y=1).        <x
+00032120: 6172 7261 792e 4461 7461 7365 743e 0a20  array.Dataset>. 
+00032130: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
+00032140: 733a 2020 2878 3a20 322c 2079 3a20 3229  s:  (x: 2, y: 2)
+00032150: 0a20 2020 2020 2020 2043 6f6f 7264 696e  .        Coordin
+00032160: 6174 6573 3a0a 2020 2020 2020 2020 2020  ates:.          
+00032170: 2a20 7920 2020 2020 2020 2028 7929 203c  * y        (y) <
+00032180: 5531 2027 6127 2027 6327 0a20 2020 2020  U1 'a' 'c'.     
+00032190: 2020 2044 696d 656e 7369 6f6e 7320 7769     Dimensions wi
+000321a0: 7468 6f75 7420 636f 6f72 6469 6e61 7465  thout coordinate
+000321b0: 733a 2078 0a20 2020 2020 2020 2044 6174  s: x.        Dat
+000321c0: 6120 7661 7269 6162 6c65 733a 0a20 2020  a variables:.   
+000321d0: 2020 2020 2020 2020 2041 2020 2020 2020           A      
+000321e0: 2020 2878 2c20 7929 2069 6e74 3634 2030    (x, y) int64 0
+000321f0: 2032 2033 2035 0a20 2020 2020 2020 2022   2 3 5.        "
+00032200: 2222 0a0a 2020 2020 2020 2020 696e 6465  ""..        inde
+00032210: 7865 7273 203d 2065 6974 6865 725f 6469  xers = either_di
+00032220: 6374 5f6f 725f 6b77 6172 6773 2869 6e64  ct_or_kwargs(ind
+00032230: 6578 6572 732c 2069 6e64 6578 6572 735f  exers, indexers_
+00032240: 6b77 6172 6773 2c20 2264 726f 705f 6973  kwargs, "drop_is
+00032250: 656c 2229 0a0a 2020 2020 2020 2020 6473  el")..        ds
+00032260: 203d 2073 656c 660a 2020 2020 2020 2020   = self.        
+00032270: 6469 6d65 6e73 696f 6e5f 696e 6465 7820  dimension_index 
+00032280: 3d20 7b7d 0a20 2020 2020 2020 2066 6f72  = {}.        for
+00032290: 2064 696d 2c20 706f 735f 666f 725f 6469   dim, pos_for_di
+000322a0: 6d20 696e 2069 6e64 6578 6572 732e 6974  m in indexers.it
+000322b0: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+000322c0: 2020 2023 2044 6f6e 2774 2063 6173 7420     # Don't cast 
+000322d0: 746f 2073 6574 2c20 6173 2069 7420 776f  to set, as it wo
+000322e0: 756c 6420 6861 726d 2070 6572 666f 726d  uld harm perform
+000322f0: 616e 6365 2077 6865 6e20 6c61 6265 6c73  ance when labels
+00032300: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+00032310: 7320 6120 6c61 7267 6520 6e75 6d70 7920  s a large numpy 
+00032320: 6172 7261 790a 2020 2020 2020 2020 2020  array.          
+00032330: 2020 6966 2075 7469 6c73 2e69 735f 7363    if utils.is_sc
+00032340: 616c 6172 2870 6f73 5f66 6f72 5f64 696d  alar(pos_for_dim
+00032350: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00032360: 2020 2070 6f73 5f66 6f72 5f64 696d 203d     pos_for_dim =
+00032370: 205b 706f 735f 666f 725f 6469 6d5d 0a20   [pos_for_dim]. 
+00032380: 2020 2020 2020 2020 2020 2070 6f73 5f66             pos_f
+00032390: 6f72 5f64 696d 203d 206e 702e 6173 6172  or_dim = np.asar
+000323a0: 7261 7928 706f 735f 666f 725f 6469 6d29  ray(pos_for_dim)
+000323b0: 0a20 2020 2020 2020 2020 2020 2069 6e64  .            ind
+000323c0: 6578 203d 2073 656c 662e 6765 745f 696e  ex = self.get_in
+000323d0: 6465 7828 6469 6d29 0a20 2020 2020 2020  dex(dim).       
+000323e0: 2020 2020 206e 6577 5f69 6e64 6578 203d       new_index =
+000323f0: 2069 6e64 6578 2e64 656c 6574 6528 706f   index.delete(po
+00032400: 735f 666f 725f 6469 6d29 0a20 2020 2020  s_for_dim).     
+00032410: 2020 2020 2020 2064 696d 656e 7369 6f6e         dimension
+00032420: 5f69 6e64 6578 5b64 696d 5d20 3d20 6e65  _index[dim] = ne
+00032430: 775f 696e 6465 780a 2020 2020 2020 2020  w_index.        
+00032440: 6473 203d 2064 732e 6c6f 635b 6469 6d65  ds = ds.loc[dime
+00032450: 6e73 696f 6e5f 696e 6465 785d 0a20 2020  nsion_index].   
+00032460: 2020 2020 2072 6574 7572 6e20 6473 0a0a       return ds..
+00032470: 2020 2020 6465 6620 6472 6f70 5f64 696d      def drop_dim
+00032480: 7328 0a20 2020 2020 2020 2073 656c 663a  s(.        self:
+00032490: 2054 5f44 6174 6173 6574 2c0a 2020 2020   T_Dataset,.    
+000324a0: 2020 2020 6472 6f70 5f64 696d 733a 2073      drop_dims: s
+000324b0: 7472 207c 2049 7465 7261 626c 655b 4861  tr | Iterable[Ha
+000324c0: 7368 6162 6c65 5d2c 0a20 2020 2020 2020  shable],.       
+000324d0: 202a 2c0a 2020 2020 2020 2020 6572 726f   *,.        erro
+000324e0: 7273 3a20 4572 726f 724f 7074 696f 6e73  rs: ErrorOptions
+000324f0: 203d 2022 7261 6973 6522 2c0a 2020 2020   = "raise",.    
+00032500: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
+00032510: 2020 2020 2020 2020 2222 2244 726f 7020          """Drop 
+00032520: 6469 6d65 6e73 696f 6e73 2061 6e64 2061  dimensions and a
+00032530: 7373 6f63 6961 7465 6420 7661 7269 6162  ssociated variab
+00032540: 6c65 7320 6672 6f6d 2074 6869 7320 6461  les from this da
+00032550: 7461 7365 742e 0a0a 2020 2020 2020 2020  taset...        
+00032560: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00032570: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+00032580: 2020 2020 2020 6472 6f70 5f64 696d 7320        drop_dims 
+00032590: 3a20 7374 7220 6f72 2049 7465 7261 626c  : str or Iterabl
+000325a0: 6520 6f66 2048 6173 6861 626c 650a 2020  e of Hashable.  
+000325b0: 2020 2020 2020 2020 2020 4469 6d65 6e73            Dimens
+000325c0: 696f 6e20 6f72 2064 696d 656e 7369 6f6e  ion or dimension
+000325d0: 7320 746f 2064 726f 702e 0a20 2020 2020  s to drop..     
+000325e0: 2020 2065 7272 6f72 7320 3a20 7b22 7261     errors : {"ra
+000325f0: 6973 6522 2c20 2269 676e 6f72 6522 7d2c  ise", "ignore"},
+00032600: 2064 6566 6175 6c74 3a20 2272 6169 7365   default: "raise
+00032610: 220a 2020 2020 2020 2020 2020 2020 4966  ".            If
+00032620: 2027 7261 6973 6527 2c20 7261 6973 6573   'raise', raises
+00032630: 2061 2056 616c 7565 4572 726f 7220 6572   a ValueError er
+00032640: 726f 7220 6966 2061 6e79 206f 6620 7468  ror if any of th
+00032650: 650a 2020 2020 2020 2020 2020 2020 6469  e.            di
+00032660: 6d65 6e73 696f 6e73 2070 6173 7365 6420  mensions passed 
+00032670: 6172 6520 6e6f 7420 696e 2074 6865 2064  are not in the d
+00032680: 6174 6173 6574 2e20 4966 2027 6967 6e6f  ataset. If 'igno
+00032690: 7265 272c 2061 6e79 2067 6976 656e 0a20  re', any given. 
+000326a0: 2020 2020 2020 2020 2020 2064 696d 656e             dimen
+000326b0: 7369 6f6e 7320 7468 6174 2061 7265 2069  sions that are i
+000326c0: 6e20 7468 6520 6461 7461 7365 7420 6172  n the dataset ar
+000326d0: 6520 6472 6f70 7065 6420 616e 6420 6e6f  e dropped and no
+000326e0: 2065 7272 6f72 2069 7320 7261 6973 6564   error is raised
+000326f0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00032700: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+00032710: 2d2d 0a20 2020 2020 2020 206f 626a 203a  --.        obj :
+00032720: 2044 6174 6173 6574 0a20 2020 2020 2020   Dataset.       
+00032730: 2020 2020 2054 6865 2064 6174 6173 6574       The dataset
+00032740: 2077 6974 686f 7574 2074 6865 2067 6976   without the giv
+00032750: 656e 2064 696d 656e 7369 6f6e 7320 286f  en dimensions (o
+00032760: 7220 616e 7920 7661 7269 6162 6c65 730a  r any variables.
+00032770: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
+00032780: 6169 6e69 6e67 2074 686f 7365 2064 696d  aining those dim
+00032790: 656e 7369 6f6e 7329 2e0a 2020 2020 2020  ensions)..      
+000327a0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+000327b0: 2065 7272 6f72 7320 6e6f 7420 696e 205b   errors not in [
+000327c0: 2272 6169 7365 222c 2022 6967 6e6f 7265  "raise", "ignore
+000327d0: 225d 3a0a 2020 2020 2020 2020 2020 2020  "]:.            
+000327e0: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
+000327f0: 2827 6572 726f 7273 206d 7573 7420 6265  ('errors must be
+00032800: 2065 6974 6865 7220 2272 6169 7365 2220   either "raise" 
+00032810: 6f72 2022 6967 6e6f 7265 2227 290a 0a20  or "ignore"').. 
+00032820: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00032830: 616e 6365 2864 726f 705f 6469 6d73 2c20  ance(drop_dims, 
+00032840: 7374 7229 206f 7220 6e6f 7420 6973 696e  str) or not isin
+00032850: 7374 616e 6365 2864 726f 705f 6469 6d73  stance(drop_dims
+00032860: 2c20 4974 6572 6162 6c65 293a 0a20 2020  , Iterable):.   
+00032870: 2020 2020 2020 2020 2064 726f 705f 6469           drop_di
+00032880: 6d73 203d 207b 6472 6f70 5f64 696d 737d  ms = {drop_dims}
+00032890: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+000328a0: 2020 2020 2020 2020 2020 2064 726f 705f             drop_
+000328b0: 6469 6d73 203d 2073 6574 2864 726f 705f  dims = set(drop_
+000328c0: 6469 6d73 290a 0a20 2020 2020 2020 2069  dims)..        i
+000328d0: 6620 6572 726f 7273 203d 3d20 2272 6169  f errors == "rai
+000328e0: 7365 223a 0a20 2020 2020 2020 2020 2020  se":.           
+000328f0: 206d 6973 7369 6e67 5f64 696d 7320 3d20   missing_dims = 
+00032900: 6472 6f70 5f64 696d 7320 2d20 7365 7428  drop_dims - set(
+00032910: 7365 6c66 2e64 696d 7329 0a20 2020 2020  self.dims).     
+00032920: 2020 2020 2020 2069 6620 6d69 7373 696e         if missin
+00032930: 675f 6469 6d73 3a0a 2020 2020 2020 2020  g_dims:.        
+00032940: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00032950: 6c75 6545 7272 6f72 280a 2020 2020 2020  lueError(.      
+00032960: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00032970: 4461 7461 7365 7420 646f 6573 206e 6f74  Dataset does not
+00032980: 2063 6f6e 7461 696e 2074 6865 2064 696d   contain the dim
+00032990: 656e 7369 6f6e 733a 207b 6d69 7373 696e  ensions: {missin
+000329a0: 675f 6469 6d73 7d22 0a20 2020 2020 2020  g_dims}".       
+000329b0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000329c0: 2020 2020 6472 6f70 5f76 6172 7320 3d20      drop_vars = 
+000329d0: 7b6b 2066 6f72 206b 2c20 7620 696e 2073  {k for k, v in s
+000329e0: 656c 662e 5f76 6172 6961 626c 6573 2e69  elf._variables.i
+000329f0: 7465 6d73 2829 2069 6620 7365 7428 762e  tems() if set(v.
+00032a00: 6469 6d73 2920 2620 6472 6f70 5f64 696d  dims) & drop_dim
+00032a10: 737d 0a20 2020 2020 2020 2072 6574 7572  s}.        retur
+00032a20: 6e20 7365 6c66 2e64 726f 705f 7661 7273  n self.drop_vars
+00032a30: 2864 726f 705f 7661 7273 290a 0a20 2020  (drop_vars)..   
+00032a40: 2064 6566 2074 7261 6e73 706f 7365 280a   def transpose(.
+00032a50: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
+00032a60: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
+00032a70: 202a 6469 6d73 3a20 4861 7368 6162 6c65   *dims: Hashable
+00032a80: 2c0a 2020 2020 2020 2020 6d69 7373 696e  ,.        missin
+00032a90: 675f 6469 6d73 3a20 4572 726f 724f 7074  g_dims: ErrorOpt
+00032aa0: 696f 6e73 5769 7468 5761 726e 203d 2022  ionsWithWarn = "
+00032ab0: 7261 6973 6522 2c0a 2020 2020 2920 2d3e  raise",.    ) ->
+00032ac0: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
+00032ad0: 2020 2020 2222 2252 6574 7572 6e20 6120      """Return a 
+00032ae0: 6e65 7720 4461 7461 7365 7420 6f62 6a65  new Dataset obje
+00032af0: 6374 2077 6974 6820 616c 6c20 6172 7261  ct with all arra
+00032b00: 7920 6469 6d65 6e73 696f 6e73 2074 7261  y dimensions tra
+00032b10: 6e73 706f 7365 642e 0a0a 2020 2020 2020  nsposed...      
+00032b20: 2020 416c 7468 6f75 6768 2074 6865 206f    Although the o
+00032b30: 7264 6572 206f 6620 6469 6d65 6e73 696f  rder of dimensio
+00032b40: 6e73 206f 6e20 6561 6368 2061 7272 6179  ns on each array
+00032b50: 2077 696c 6c20 6368 616e 6765 2c20 7468   will change, th
+00032b60: 6520 6461 7461 7365 740a 2020 2020 2020  e dataset.      
+00032b70: 2020 6469 6d65 6e73 696f 6e73 2074 6865    dimensions the
+00032b80: 6d73 656c 7665 7320 7769 6c6c 2072 656d  mselves will rem
+00032b90: 6169 6e20 696e 2066 6978 6564 2028 736f  ain in fixed (so
+00032ba0: 7274 6564 2920 6f72 6465 722e 0a0a 2020  rted) order...  
+00032bb0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00032bc0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00032bd0: 2d2d 2d0a 2020 2020 2020 2020 2a64 696d  ---.        *dim
+00032be0: 7320 3a20 6861 7368 6162 6c65 2c20 6f70  s : hashable, op
+00032bf0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00032c00: 2020 2042 7920 6465 6661 756c 742c 2072     By default, r
+00032c10: 6576 6572 7365 2074 6865 2064 696d 656e  everse the dimen
+00032c20: 7369 6f6e 7320 6f6e 2065 6163 6820 6172  sions on each ar
+00032c30: 7261 792e 204f 7468 6572 7769 7365 2c0a  ray. Otherwise,.
+00032c40: 2020 2020 2020 2020 2020 2020 7265 6f72              reor
+00032c50: 6465 7220 7468 6520 6469 6d65 6e73 696f  der the dimensio
+00032c60: 6e73 2074 6f20 7468 6973 206f 7264 6572  ns to this order
+00032c70: 2e0a 2020 2020 2020 2020 6d69 7373 696e  ..        missin
+00032c80: 675f 6469 6d73 203a 207b 2272 6169 7365  g_dims : {"raise
+00032c90: 222c 2022 7761 726e 222c 2022 6967 6e6f  ", "warn", "igno
+00032ca0: 7265 227d 2c20 6465 6661 756c 743a 2022  re"}, default: "
+00032cb0: 7261 6973 6522 0a20 2020 2020 2020 2020  raise".         
+00032cc0: 2020 2057 6861 7420 746f 2064 6f20 6966     What to do if
+00032cd0: 2064 696d 656e 7369 6f6e 7320 7468 6174   dimensions that
+00032ce0: 2073 686f 756c 6420 6265 2073 656c 6563   should be selec
+00032cf0: 7465 6420 6672 6f6d 2061 7265 206e 6f74  ted from are not
+00032d00: 2070 7265 7365 6e74 2069 6e20 7468 650a   present in the.
+00032d10: 2020 2020 2020 2020 2020 2020 4461 7461              Data
+00032d20: 7365 743a 0a20 2020 2020 2020 2020 2020  set:.           
+00032d30: 202d 2022 7261 6973 6522 3a20 7261 6973   - "raise": rais
+00032d40: 6520 616e 2065 7863 6570 7469 6f6e 0a20  e an exception. 
+00032d50: 2020 2020 2020 2020 2020 202d 2022 7761             - "wa
+00032d60: 726e 223a 2072 6169 7365 2061 2077 6172  rn": raise a war
+00032d70: 6e69 6e67 2c20 616e 6420 6967 6e6f 7265  ning, and ignore
+00032d80: 2074 6865 206d 6973 7369 6e67 2064 696d   the missing dim
+00032d90: 656e 7369 6f6e 730a 2020 2020 2020 2020  ensions.        
+00032da0: 2020 2020 2d20 2269 676e 6f72 6522 3a20      - "ignore": 
+00032db0: 6967 6e6f 7265 2074 6865 206d 6973 7369  ignore the missi
+00032dc0: 6e67 2064 696d 656e 7369 6f6e 730a 0a20  ng dimensions.. 
+00032dd0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+00032de0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+00032df0: 2020 2020 2020 2074 7261 6e73 706f 7365         transpose
+00032e00: 6420 3a20 4461 7461 7365 740a 2020 2020  d : Dataset.    
+00032e10: 2020 2020 2020 2020 4561 6368 2061 7272          Each arr
+00032e20: 6179 2069 6e20 7468 6520 6461 7461 7365  ay in the datase
+00032e30: 7420 2869 6e63 6c75 6469 6e67 2920 636f  t (including) co
+00032e40: 6f72 6469 6e61 7465 7320 7769 6c6c 2062  ordinates will b
+00032e50: 650a 2020 2020 2020 2020 2020 2020 7472  e.            tr
+00032e60: 616e 7370 6f73 6564 2074 6f20 7468 6520  ansposed to the 
+00032e70: 6769 7665 6e20 6f72 6465 722e 0a0a 2020  given order...  
+00032e80: 2020 2020 2020 4e6f 7465 730a 2020 2020        Notes.    
+00032e90: 2020 2020 2d2d 2d2d 2d0a 2020 2020 2020      -----.      
+00032ea0: 2020 5468 6973 206f 7065 7261 7469 6f6e    This operation
+00032eb0: 2072 6574 7572 6e73 2061 2076 6965 7720   returns a view 
+00032ec0: 6f66 2065 6163 6820 6172 7261 7927 7320  of each array's 
+00032ed0: 6461 7461 2e20 4974 2069 730a 2020 2020  data. It is.    
+00032ee0: 2020 2020 6c61 7a79 2066 6f72 2064 6173      lazy for das
+00032ef0: 6b2d 6261 636b 6564 2044 6174 6141 7272  k-backed DataArr
+00032f00: 6179 7320 6275 7420 6e6f 7420 666f 7220  ays but not for 
+00032f10: 6e75 6d70 792d 6261 636b 6564 2044 6174  numpy-backed Dat
+00032f20: 6141 7272 6179 730a 2020 2020 2020 2020  aArrays.        
+00032f30: 2d2d 2074 6865 2064 6174 6120 7769 6c6c  -- the data will
+00032f40: 2062 6520 6675 6c6c 7920 6c6f 6164 6564   be fully loaded
+00032f50: 2069 6e74 6f20 6d65 6d6f 7279 2e0a 0a20   into memory... 
+00032f60: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00032f70: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00032f80: 0a20 2020 2020 2020 206e 756d 7079 2e74  .        numpy.t
+00032f90: 7261 6e73 706f 7365 0a20 2020 2020 2020  ranspose.       
+00032fa0: 2044 6174 6141 7272 6179 2e74 7261 6e73   DataArray.trans
+00032fb0: 706f 7365 0a20 2020 2020 2020 2022 2222  pose.        """
+00032fc0: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
+00032fd0: 2065 7272 6f72 2069 6620 6c69 7374 2069   error if list i
+00032fe0: 7320 7061 7373 6564 2061 7320 6469 6d73  s passed as dims
+00032ff0: 0a20 2020 2020 2020 2069 6620 286c 656e  .        if (len
+00033000: 2864 696d 7329 203e 2030 2920 616e 6420  (dims) > 0) and 
+00033010: 2869 7369 6e73 7461 6e63 6528 6469 6d73  (isinstance(dims
+00033020: 5b30 5d2c 206c 6973 7429 293a 0a20 2020  [0], list)):.   
+00033030: 2020 2020 2020 2020 206c 6973 745f 6669           list_fi
+00033040: 7820 3d20 5b66 227b 7265 7072 2878 297d  x = [f"{repr(x)}
+00033050: 2220 6966 2069 7369 6e73 7461 6e63 6528  " if isinstance(
+00033060: 782c 2073 7472 2920 656c 7365 2066 227b  x, str) else f"{
+00033070: 787d 2220 666f 7220 7820 696e 2064 696d  x}" for x in dim
+00033080: 735b 305d 5d0a 2020 2020 2020 2020 2020  s[0]].          
+00033090: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+000330a0: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+000330b0: 2020 2066 2774 7261 6e73 706f 7365 2072     f'transpose r
+000330c0: 6571 7569 7265 7320 6469 6d73 2074 6f20  equires dims to 
+000330d0: 6265 2070 6173 7365 6420 6173 206d 756c  be passed as mul
+000330e0: 7469 706c 6520 6172 6775 6d65 6e74 732e  tiple arguments.
+000330f0: 2045 7870 6563 7465 6420 607b 222c 2022   Expected `{", "
+00033100: 2e6a 6f69 6e28 6c69 7374 5f66 6978 297d  .join(list_fix)}
+00033110: 602e 2052 6563 6569 7665 6420 607b 6469  `. Received `{di
+00033120: 6d73 5b30 5d7d 6020 696e 7374 6561 6427  ms[0]}` instead'
+00033130: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+00033140: 2020 2020 2020 2020 2320 5573 6520 696e          # Use in
+00033150: 6669 785f 6469 6d73 2074 6f20 6368 6563  fix_dims to chec
+00033160: 6b20 6f6e 6365 2066 6f72 206d 6973 7369  k once for missi
+00033170: 6e67 2064 696d 656e 7369 6f6e 730a 2020  ng dimensions.  
+00033180: 2020 2020 2020 6966 206c 656e 2864 696d        if len(dim
+00033190: 7329 2021 3d20 303a 0a20 2020 2020 2020  s) != 0:.       
+000331a0: 2020 2020 205f 203d 206c 6973 7428 696e       _ = list(in
+000331b0: 6669 785f 6469 6d73 2864 696d 732c 2073  fix_dims(dims, s
+000331c0: 656c 662e 6469 6d73 2c20 6d69 7373 696e  elf.dims, missin
+000331d0: 675f 6469 6d73 2929 0a0a 2020 2020 2020  g_dims))..      
+000331e0: 2020 6473 203d 2073 656c 662e 636f 7079    ds = self.copy
+000331f0: 2829 0a20 2020 2020 2020 2066 6f72 206e  ().        for n
+00033200: 616d 652c 2076 6172 2069 6e20 7365 6c66  ame, var in self
+00033210: 2e5f 7661 7269 6162 6c65 732e 6974 656d  ._variables.item
+00033220: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+00033230: 2076 6172 5f64 696d 7320 3d20 7475 706c   var_dims = tupl
+00033240: 6528 6469 6d20 666f 7220 6469 6d20 696e  e(dim for dim in
+00033250: 2064 696d 7320 6966 2064 696d 2069 6e20   dims if dim in 
+00033260: 2876 6172 2e64 696d 7320 2b20 282e 2e2e  (var.dims + (...
+00033270: 2c29 2929 0a20 2020 2020 2020 2020 2020  ,))).           
+00033280: 2064 732e 5f76 6172 6961 626c 6573 5b6e   ds._variables[n
+00033290: 616d 655d 203d 2076 6172 2e74 7261 6e73  ame] = var.trans
+000332a0: 706f 7365 282a 7661 725f 6469 6d73 290a  pose(*var_dims).
+000332b0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+000332c0: 730a 0a20 2020 2064 6566 2064 726f 706e  s..    def dropn
+000332d0: 6128 0a20 2020 2020 2020 2073 656c 663a  a(.        self:
+000332e0: 2054 5f44 6174 6173 6574 2c0a 2020 2020   T_Dataset,.    
+000332f0: 2020 2020 6469 6d3a 2048 6173 6861 626c      dim: Hashabl
+00033300: 652c 0a20 2020 2020 2020 2068 6f77 3a20  e,.        how: 
+00033310: 4c69 7465 7261 6c5b 2261 6e79 222c 2022  Literal["any", "
+00033320: 616c 6c22 5d20 3d20 2261 6e79 222c 0a20  all"] = "any",. 
+00033330: 2020 2020 2020 2074 6872 6573 683a 2069         thresh: i
+00033340: 6e74 207c 204e 6f6e 6520 3d20 4e6f 6e65  nt | None = None
+00033350: 2c0a 2020 2020 2020 2020 7375 6273 6574  ,.        subset
+00033360: 3a20 4974 6572 6162 6c65 5b48 6173 6861  : Iterable[Hasha
+00033370: 626c 655d 207c 204e 6f6e 6520 3d20 4e6f  ble] | None = No
+00033380: 6e65 2c0a 2020 2020 2920 2d3e 2054 5f44  ne,.    ) -> T_D
+00033390: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+000333a0: 2222 2252 6574 7572 6e73 2061 206e 6577  """Returns a new
+000333b0: 2064 6174 6173 6574 2077 6974 6820 6472   dataset with dr
+000333c0: 6f70 7065 6420 6c61 6265 6c73 2066 6f72  opped labels for
+000333d0: 206d 6973 7369 6e67 2076 616c 7565 7320   missing values 
+000333e0: 616c 6f6e 670a 2020 2020 2020 2020 7468  along.        th
+000333f0: 6520 7072 6f76 6964 6564 2064 696d 656e  e provided dimen
+00033400: 7369 6f6e 2e0a 0a20 2020 2020 2020 2050  sion...        P
+00033410: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00033420: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00033430: 2020 2020 2064 696d 203a 2068 6173 6861       dim : hasha
+00033440: 626c 650a 2020 2020 2020 2020 2020 2020  ble.            
+00033450: 4469 6d65 6e73 696f 6e20 616c 6f6e 6720  Dimension along 
+00033460: 7768 6963 6820 746f 2064 726f 7020 6d69  which to drop mi
+00033470: 7373 696e 6720 7661 6c75 6573 2e20 4472  ssing values. Dr
+00033480: 6f70 7069 6e67 2061 6c6f 6e67 0a20 2020  opping along.   
+00033490: 2020 2020 2020 2020 206d 756c 7469 706c           multipl
+000334a0: 6520 6469 6d65 6e73 696f 6e73 2073 696d  e dimensions sim
+000334b0: 756c 7461 6e65 6f75 736c 7920 6973 206e  ultaneously is n
+000334c0: 6f74 2079 6574 2073 7570 706f 7274 6564  ot yet supported
+000334d0: 2e0a 2020 2020 2020 2020 686f 7720 3a20  ..        how : 
+000334e0: 7b22 616e 7922 2c20 2261 6c6c 227d 2c20  {"any", "all"}, 
+000334f0: 6465 6661 756c 743a 2022 616e 7922 0a20  default: "any". 
+00033500: 2020 2020 2020 2020 2020 202d 2061 6e79             - any
+00033510: 203a 2069 6620 616e 7920 4e41 2076 616c   : if any NA val
+00033520: 7565 7320 6172 6520 7072 6573 656e 742c  ues are present,
+00033530: 2064 726f 7020 7468 6174 206c 6162 656c   drop that label
+00033540: 0a20 2020 2020 2020 2020 2020 202d 2061  .            - a
+00033550: 6c6c 203a 2069 6620 616c 6c20 7661 6c75  ll : if all valu
+00033560: 6573 2061 7265 204e 412c 2064 726f 7020  es are NA, drop 
+00033570: 7468 6174 206c 6162 656c 0a0a 2020 2020  that label..    
+00033580: 2020 2020 7468 7265 7368 203a 2069 6e74      thresh : int
+00033590: 206f 7220 4e6f 6e65 2c20 6f70 7469 6f6e   or None, option
+000335a0: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+000335b0: 6620 7375 7070 6c69 6564 2c20 7265 7175  f supplied, requ
+000335c0: 6972 6520 7468 6973 206d 616e 7920 6e6f  ire this many no
+000335d0: 6e2d 4e41 2076 616c 7565 7320 2873 756d  n-NA values (sum
+000335e0: 6d65 6420 6f76 6572 2061 6c6c 2074 6865  med over all the
+000335f0: 2073 7562 7365 7420 7661 7269 6162 6c65   subset variable
+00033600: 7329 2e0a 2020 2020 2020 2020 7375 6273  s)..        subs
+00033610: 6574 203a 2069 7465 7261 626c 6520 6f66  et : iterable of
+00033620: 2068 6173 6861 626c 6520 6f72 204e 6f6e   hashable or Non
+00033630: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
+00033640: 2020 2020 2020 2020 5768 6963 6820 7661          Which va
+00033650: 7269 6162 6c65 7320 746f 2063 6865 636b  riables to check
+00033660: 2066 6f72 206d 6973 7369 6e67 2076 616c   for missing val
+00033670: 7565 732e 2042 7920 6465 6661 756c 742c  ues. By default,
+00033680: 2061 6c6c 0a20 2020 2020 2020 2020 2020   all.           
+00033690: 2076 6172 6961 626c 6573 2069 6e20 7468   variables in th
+000336a0: 6520 6461 7461 7365 7420 6172 6520 6368  e dataset are ch
+000336b0: 6563 6b65 642e 0a0a 2020 2020 2020 2020  ecked...        
+000336c0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+000336d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+000336e0: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
+000336f0: 2222 220a 2020 2020 2020 2020 2320 544f  """.        # TO
+00033700: 444f 3a20 636f 6e73 6964 6572 2073 7570  DO: consider sup
+00033710: 706f 7274 696e 6720 6d75 6c74 6970 6c65  porting multiple
+00033720: 2064 696d 656e 7369 6f6e 733f 204f 7220   dimensions? Or 
+00033730: 6e6f 742c 2067 6976 656e 2074 6861 740a  not, given that.
+00033740: 2020 2020 2020 2020 2320 7468 6572 6520          # there 
+00033750: 6172 6520 736f 6d65 2075 676c 7920 6564  are some ugly ed
+00033760: 6765 2063 6173 6573 2c20 652e 672e 2c20  ge cases, e.g., 
+00033770: 7061 6e64 6173 2773 2064 726f 706e 6120  pandas's dropna 
+00033780: 6469 6666 6572 730a 2020 2020 2020 2020  differs.        
+00033790: 2320 6465 7065 6e64 696e 6720 6f6e 2074  # depending on t
+000337a0: 6865 206f 7264 6572 206f 6620 7468 6520  he order of the 
+000337b0: 7375 7070 6c69 6564 2061 7865 732e 0a0a  supplied axes...
+000337c0: 2020 2020 2020 2020 6966 2064 696d 206e          if dim n
+000337d0: 6f74 2069 6e20 7365 6c66 2e64 696d 733a  ot in self.dims:
+000337e0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+000337f0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+00033800: 7b64 696d 7d20 6d75 7374 2062 6520 6120  {dim} must be a 
+00033810: 7369 6e67 6c65 2064 6174 6173 6574 2064  single dataset d
+00033820: 696d 656e 7369 6f6e 2229 0a0a 2020 2020  imension")..    
+00033830: 2020 2020 6966 2073 7562 7365 7420 6973      if subset is
+00033840: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+00033850: 2020 2073 7562 7365 7420 3d20 6974 6572     subset = iter
+00033860: 2873 656c 662e 6461 7461 5f76 6172 7329  (self.data_vars)
+00033870: 0a0a 2020 2020 2020 2020 636f 756e 7420  ..        count 
+00033880: 3d20 6e70 2e7a 6572 6f73 2873 656c 662e  = np.zeros(self.
+00033890: 6469 6d73 5b64 696d 5d2c 2064 7479 7065  dims[dim], dtype
+000338a0: 3d6e 702e 696e 7436 3429 0a20 2020 2020  =np.int64).     
+000338b0: 2020 2073 697a 6520 3d20 6e70 2e69 6e74     size = np.int
+000338c0: 5f28 3029 2020 2320 666f 7220 7479 7065  _(0)  # for type
+000338d0: 2063 6865 636b 696e 670a 0a20 2020 2020   checking..     
+000338e0: 2020 2066 6f72 206b 2069 6e20 7375 6273     for k in subs
+000338f0: 6574 3a0a 2020 2020 2020 2020 2020 2020  et:.            
+00033900: 6172 7261 7920 3d20 7365 6c66 2e5f 7661  array = self._va
+00033910: 7269 6162 6c65 735b 6b5d 0a20 2020 2020  riables[k].     
+00033920: 2020 2020 2020 2069 6620 6469 6d20 696e         if dim in
+00033930: 2061 7272 6179 2e64 696d 733a 0a20 2020   array.dims:.   
+00033940: 2020 2020 2020 2020 2020 2020 2064 696d               dim
+00033950: 7320 3d20 5b64 2066 6f72 2064 2069 6e20  s = [d for d in 
+00033960: 6172 7261 792e 6469 6d73 2069 6620 6420  array.dims if d 
+00033970: 213d 2064 696d 5d0a 2020 2020 2020 2020  != dim].        
+00033980: 2020 2020 2020 2020 636f 756e 7420 2b3d          count +=
+00033990: 206e 702e 6173 6172 7261 7928 6172 7261   np.asarray(arra
+000339a0: 792e 636f 756e 7428 6469 6d73 2929 2020  y.count(dims))  
+000339b0: 2320 7479 7065 3a20 6967 6e6f 7265 5b61  # type: ignore[a
+000339c0: 7474 722d 6465 6669 6e65 645d 0a20 2020  ttr-defined].   
+000339d0: 2020 2020 2020 2020 2020 2020 2073 697a               siz
+000339e0: 6520 2b3d 206d 6174 682e 7072 6f64 285b  e += math.prod([
+000339f0: 7365 6c66 2e64 696d 735b 645d 2066 6f72  self.dims[d] for
+00033a00: 2064 2069 6e20 6469 6d73 5d29 0a0a 2020   d in dims])..  
+00033a10: 2020 2020 2020 6966 2074 6872 6573 6820        if thresh 
+00033a20: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+00033a30: 2020 2020 2020 2020 206d 6173 6b20 3d20           mask = 
+00033a40: 636f 756e 7420 3e3d 2074 6872 6573 680a  count >= thresh.
+00033a50: 2020 2020 2020 2020 656c 6966 2068 6f77          elif how
+00033a60: 203d 3d20 2261 6e79 223a 0a20 2020 2020   == "any":.     
+00033a70: 2020 2020 2020 206d 6173 6b20 3d20 636f         mask = co
+00033a80: 756e 7420 3d3d 2073 697a 650a 2020 2020  unt == size.    
+00033a90: 2020 2020 656c 6966 2068 6f77 203d 3d20      elif how == 
+00033aa0: 2261 6c6c 223a 0a20 2020 2020 2020 2020  "all":.         
+00033ab0: 2020 206d 6173 6b20 3d20 636f 756e 7420     mask = count 
+00033ac0: 3e20 300a 2020 2020 2020 2020 656c 6966  > 0.        elif
+00033ad0: 2068 6f77 2069 7320 6e6f 7420 4e6f 6e65   how is not None
+00033ae0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00033af0: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
+00033b00: 2269 6e76 616c 6964 2068 6f77 206f 7074  "invalid how opt
+00033b10: 696f 6e3a 207b 686f 777d 2229 0a20 2020  ion: {how}").   
+00033b20: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00033b30: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00033b40: 6545 7272 6f72 2822 6d75 7374 2073 7065  eError("must spe
+00033b50: 6369 6679 2068 6f77 206f 7220 7468 7265  cify how or thre
+00033b60: 7368 2229 0a0a 2020 2020 2020 2020 7265  sh")..        re
+00033b70: 7475 726e 2073 656c 662e 6973 656c 287b  turn self.isel({
+00033b80: 6469 6d3a 206d 6173 6b7d 290a 0a20 2020  dim: mask})..   
+00033b90: 2064 6566 2066 696c 6c6e 6128 7365 6c66   def fillna(self
+00033ba0: 3a20 545f 4461 7461 7365 742c 2076 616c  : T_Dataset, val
+00033bb0: 7565 3a20 416e 7929 202d 3e20 545f 4461  ue: Any) -> T_Da
+00033bc0: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
+00033bd0: 2222 4669 6c6c 206d 6973 7369 6e67 2076  ""Fill missing v
+00033be0: 616c 7565 7320 696e 2074 6869 7320 6f62  alues in this ob
+00033bf0: 6a65 6374 2e0a 0a20 2020 2020 2020 2054  ject...        T
+00033c00: 6869 7320 6f70 6572 6174 696f 6e20 666f  his operation fo
+00033c10: 6c6c 6f77 7320 7468 6520 6e6f 726d 616c  llows the normal
+00033c20: 2062 726f 6164 6361 7374 696e 6720 616e   broadcasting an
+00033c30: 6420 616c 6967 6e6d 656e 7420 7275 6c65  d alignment rule
+00033c40: 7320 7468 6174 0a20 2020 2020 2020 2078  s that.        x
+00033c50: 6172 7261 7920 7573 6573 2066 6f72 2062  array uses for b
+00033c60: 696e 6172 7920 6172 6974 686d 6574 6963  inary arithmetic
+00033c70: 2c20 6578 6365 7074 2074 6865 2072 6573  , except the res
+00033c80: 756c 7420 6973 2061 6c69 676e 6564 2074  ult is aligned t
+00033c90: 6f20 7468 6973 0a20 2020 2020 2020 206f  o this.        o
+00033ca0: 626a 6563 7420 2860 606a 6f69 6e3d 276c  bject (``join='l
+00033cb0: 6566 7427 6060 2920 696e 7374 6561 6420  eft'``) instead 
+00033cc0: 6f66 2061 6c69 676e 6564 2074 6f20 7468  of aligned to th
+00033cd0: 6520 696e 7465 7273 6563 7469 6f6e 206f  e intersection o
+00033ce0: 660a 2020 2020 2020 2020 696e 6465 7820  f.        index 
+00033cf0: 636f 6f72 6469 6e61 7465 7320 2860 606a  coordinates (``j
+00033d00: 6f69 6e3d 2769 6e6e 6572 2760 6029 2e0a  oin='inner'``)..
+00033d10: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00033d20: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00033d30: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2076  ------.        v
+00033d40: 616c 7565 203a 2073 6361 6c61 722c 206e  alue : scalar, n
+00033d50: 6461 7272 6179 2c20 4461 7461 4172 7261  darray, DataArra
+00033d60: 792c 2064 6963 7420 6f72 2044 6174 6173  y, dict or Datas
+00033d70: 6574 0a20 2020 2020 2020 2020 2020 2055  et.            U
+00033d80: 7365 6420 746f 2066 696c 6c20 616c 6c20  sed to fill all 
+00033d90: 6d61 7463 6869 6e67 206d 6973 7369 6e67  matching missing
+00033da0: 2076 616c 7565 7320 696e 2074 6869 7320   values in this 
+00033db0: 6461 7461 7365 7427 7320 6461 7461 0a20  dataset's data. 
+00033dc0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00033dd0: 626c 6573 2e20 5363 616c 6172 732c 206e  bles. Scalars, n
+00033de0: 6461 7272 6179 7320 6f72 2044 6174 6141  darrays or DataA
+00033df0: 7272 6179 7320 6172 6775 6d65 6e74 7320  rrays arguments 
+00033e00: 6172 6520 7573 6564 2074 6f0a 2020 2020  are used to.    
+00033e10: 2020 2020 2020 2020 6669 6c6c 2061 6c6c          fill all
+00033e20: 2064 6174 6120 7769 7468 2061 6c69 676e   data with align
+00033e30: 6564 2063 6f6f 7264 696e 6174 6573 2028  ed coordinates (
+00033e40: 666f 7220 4461 7461 4172 7261 7973 292e  for DataArrays).
+00033e50: 0a20 2020 2020 2020 2020 2020 2044 6963  .            Dic
+00033e60: 7469 6f6e 6172 6965 7320 6f72 2064 6174  tionaries or dat
+00033e70: 6173 6574 7320 6d61 7463 6820 6461 7461  asets match data
+00033e80: 2076 6172 6961 626c 6573 2061 6e64 2074   variables and t
+00033e90: 6865 6e20 616c 6967 6e0a 2020 2020 2020  hen align.      
+00033ea0: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+00033eb0: 7320 6966 206e 6563 6573 7361 7279 2e0a  s if necessary..
+00033ec0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00033ed0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00033ee0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
+00033ef0: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
+00033f00: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+00033f10: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
+00033f20: 6473 203d 2078 722e 4461 7461 7365 7428  ds = xr.Dataset(
+00033f30: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00033f40: 207b 0a20 2020 2020 2020 202e 2e2e 2020   {.        ...  
+00033f50: 2020 2020 2020 2022 4122 3a20 2822 7822         "A": ("x"
+00033f60: 2c20 5b6e 702e 6e61 6e2c 2032 2c20 6e70  , [np.nan, 2, np
+00033f70: 2e6e 616e 2c20 305d 292c 0a20 2020 2020  .nan, 0]),.     
+00033f80: 2020 202e 2e2e 2020 2020 2020 2020 2022     ...         "
+00033f90: 4222 3a20 2822 7822 2c20 5b33 2c20 342c  B": ("x", [3, 4,
+00033fa0: 206e 702e 6e61 6e2c 2031 5d29 2c0a 2020   np.nan, 1]),.  
+00033fb0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00033fc0: 2020 2243 223a 2028 2278 222c 205b 6e70    "C": ("x", [np
+00033fd0: 2e6e 616e 2c20 6e70 2e6e 616e 2c20 6e70  .nan, np.nan, np
+00033fe0: 2e6e 616e 2c20 355d 292c 0a20 2020 2020  .nan, 5]),.     
+00033ff0: 2020 202e 2e2e 2020 2020 2020 2020 2022     ...         "
+00034000: 4422 3a20 2822 7822 2c20 5b6e 702e 6e61  D": ("x", [np.na
+00034010: 6e2c 2033 2c20 6e70 2e6e 616e 2c20 345d  n, 3, np.nan, 4]
+00034020: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
+00034030: 2020 207d 2c0a 2020 2020 2020 2020 2e2e     },.        ..
+00034040: 2e20 2020 2020 636f 6f72 6473 3d7b 2278  .     coords={"x
+00034050: 223a 205b 302c 2031 2c20 322c 2033 5d7d  ": [0, 1, 2, 3]}
+00034060: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
+00034070: 2020 2020 2020 2020 3e3e 3e20 6473 0a20          >>> ds. 
+00034080: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
+00034090: 6174 6173 6574 3e0a 2020 2020 2020 2020  ataset>.        
+000340a0: 4469 6d65 6e73 696f 6e73 3a20 2028 783a  Dimensions:  (x:
+000340b0: 2034 290a 2020 2020 2020 2020 436f 6f72   4).        Coor
+000340c0: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
+000340d0: 2020 202a 2078 2020 2020 2020 2020 2878     * x        (x
+000340e0: 2920 696e 7436 3420 3020 3120 3220 330a  ) int64 0 1 2 3.
+000340f0: 2020 2020 2020 2020 4461 7461 2076 6172          Data var
+00034100: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
+00034110: 2020 2020 4120 2020 2020 2020 2028 7829      A        (x)
+00034120: 2066 6c6f 6174 3634 206e 616e 2032 2e30   float64 nan 2.0
+00034130: 206e 616e 2030 2e30 0a20 2020 2020 2020   nan 0.0.       
+00034140: 2020 2020 2042 2020 2020 2020 2020 2878       B        (x
+00034150: 2920 666c 6f61 7436 3420 332e 3020 342e  ) float64 3.0 4.
+00034160: 3020 6e61 6e20 312e 300a 2020 2020 2020  0 nan 1.0.      
+00034170: 2020 2020 2020 4320 2020 2020 2020 2028        C        (
+00034180: 7829 2066 6c6f 6174 3634 206e 616e 206e  x) float64 nan n
+00034190: 616e 206e 616e 2035 2e30 0a20 2020 2020  an nan 5.0.     
+000341a0: 2020 2020 2020 2044 2020 2020 2020 2020         D        
+000341b0: 2878 2920 666c 6f61 7436 3420 6e61 6e20  (x) float64 nan 
+000341c0: 332e 3020 6e61 6e20 342e 300a 0a20 2020  3.0 nan 4.0..   
+000341d0: 2020 2020 2052 6570 6c61 6365 2061 6c6c       Replace all
+000341e0: 2060 4e61 4e60 2076 616c 7565 7320 7769   `NaN` values wi
+000341f0: 7468 2030 732e 0a0a 2020 2020 2020 2020  th 0s...        
+00034200: 3e3e 3e20 6473 2e66 696c 6c6e 6128 3029  >>> ds.fillna(0)
+00034210: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
+00034220: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
+00034230: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
+00034240: 783a 2034 290a 2020 2020 2020 2020 436f  x: 4).        Co
+00034250: 6f72 6469 6e61 7465 733a 0a20 2020 2020  ordinates:.     
+00034260: 2020 2020 202a 2078 2020 2020 2020 2020       * x        
+00034270: 2878 2920 696e 7436 3420 3020 3120 3220  (x) int64 0 1 2 
+00034280: 330a 2020 2020 2020 2020 4461 7461 2076  3.        Data v
+00034290: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
+000342a0: 2020 2020 2020 4120 2020 2020 2020 2028        A        (
+000342b0: 7829 2066 6c6f 6174 3634 2030 2e30 2032  x) float64 0.0 2
+000342c0: 2e30 2030 2e30 2030 2e30 0a20 2020 2020  .0 0.0 0.0.     
+000342d0: 2020 2020 2020 2042 2020 2020 2020 2020         B        
+000342e0: 2878 2920 666c 6f61 7436 3420 332e 3020  (x) float64 3.0 
+000342f0: 342e 3020 302e 3020 312e 300a 2020 2020  4.0 0.0 1.0.    
+00034300: 2020 2020 2020 2020 4320 2020 2020 2020          C       
+00034310: 2028 7829 2066 6c6f 6174 3634 2030 2e30   (x) float64 0.0
+00034320: 2030 2e30 2030 2e30 2035 2e30 0a20 2020   0.0 0.0 5.0.   
+00034330: 2020 2020 2020 2020 2044 2020 2020 2020           D      
+00034340: 2020 2878 2920 666c 6f61 7436 3420 302e    (x) float64 0.
+00034350: 3020 332e 3020 302e 3020 342e 300a 0a20  0 3.0 0.0 4.0.. 
+00034360: 2020 2020 2020 2052 6570 6c61 6365 2061         Replace a
+00034370: 6c6c 2060 4e61 4e60 2065 6c65 6d65 6e74  ll `NaN` element
+00034380: 7320 696e 2063 6f6c 756d 6e20 e280 9841  s in column ...A
+00034390: e280 992c 20e2 8098 42e2 8099 2c20 e280  ..., ...B..., ..
+000343a0: 9843 e280 992c 2061 6e64 20e2 8098 44e2  .C..., and ...D.
+000343b0: 8099 2c20 7769 7468 2030 2c20 312c 2032  .., with 0, 1, 2
+000343c0: 2c20 616e 6420 3320 7265 7370 6563 7469  , and 3 respecti
+000343d0: 7665 6c79 2e0a 0a20 2020 2020 2020 203e  vely...        >
+000343e0: 3e3e 2076 616c 7565 7320 3d20 7b22 4122  >> values = {"A"
+000343f0: 3a20 302c 2022 4222 3a20 312c 2022 4322  : 0, "B": 1, "C"
+00034400: 3a20 322c 2022 4422 3a20 337d 0a20 2020  : 2, "D": 3}.   
+00034410: 2020 2020 203e 3e3e 2064 732e 6669 6c6c       >>> ds.fill
+00034420: 6e61 2876 616c 7565 3d76 616c 7565 7329  na(value=values)
+00034430: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
+00034440: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
+00034450: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
+00034460: 783a 2034 290a 2020 2020 2020 2020 436f  x: 4).        Co
+00034470: 6f72 6469 6e61 7465 733a 0a20 2020 2020  ordinates:.     
+00034480: 2020 2020 202a 2078 2020 2020 2020 2020       * x        
+00034490: 2878 2920 696e 7436 3420 3020 3120 3220  (x) int64 0 1 2 
+000344a0: 330a 2020 2020 2020 2020 4461 7461 2076  3.        Data v
+000344b0: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
+000344c0: 2020 2020 2020 4120 2020 2020 2020 2028        A        (
+000344d0: 7829 2066 6c6f 6174 3634 2030 2e30 2032  x) float64 0.0 2
+000344e0: 2e30 2030 2e30 2030 2e30 0a20 2020 2020  .0 0.0 0.0.     
+000344f0: 2020 2020 2020 2042 2020 2020 2020 2020         B        
+00034500: 2878 2920 666c 6f61 7436 3420 332e 3020  (x) float64 3.0 
+00034510: 342e 3020 312e 3020 312e 300a 2020 2020  4.0 1.0 1.0.    
+00034520: 2020 2020 2020 2020 4320 2020 2020 2020          C       
+00034530: 2028 7829 2066 6c6f 6174 3634 2032 2e30   (x) float64 2.0
+00034540: 2032 2e30 2032 2e30 2035 2e30 0a20 2020   2.0 2.0 5.0.   
+00034550: 2020 2020 2020 2020 2044 2020 2020 2020           D      
+00034560: 2020 2878 2920 666c 6f61 7436 3420 332e    (x) float64 3.
+00034570: 3020 332e 3020 332e 3020 342e 300a 2020  0 3.0 3.0 4.0.  
+00034580: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00034590: 2020 6966 2075 7469 6c73 2e69 735f 6469    if utils.is_di
+000345a0: 6374 5f6c 696b 6528 7661 6c75 6529 3a0a  ct_like(value):.
+000345b0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+000345c0: 655f 6b65 7973 203d 2067 6574 6174 7472  e_keys = getattr
+000345d0: 2876 616c 7565 2c20 2264 6174 615f 7661  (value, "data_va
+000345e0: 7273 222c 2076 616c 7565 292e 6b65 7973  rs", value).keys
+000345f0: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
+00034600: 6620 6e6f 7420 7365 7428 7661 6c75 655f  f not set(value_
+00034610: 6b65 7973 2920 3c3d 2073 6574 2873 656c  keys) <= set(sel
+00034620: 662e 6461 7461 5f76 6172 732e 6b65 7973  f.data_vars.keys
+00034630: 2829 293a 0a20 2020 2020 2020 2020 2020  ()):.           
+00034640: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00034650: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00034660: 2020 2020 2020 2020 2020 2022 616c 6c20             "all 
+00034670: 7661 7269 6162 6c65 7320 696e 2074 6865  variables in the
+00034680: 2061 7267 756d 656e 7420 746f 2060 6669   argument to `fi
+00034690: 6c6c 6e61 6020 220a 2020 2020 2020 2020  llna` ".        
+000346a0: 2020 2020 2020 2020 2020 2020 226d 7573              "mus
+000346b0: 7420 6265 2063 6f6e 7461 696e 6564 2069  t be contained i
+000346c0: 6e20 7468 6520 6f72 6967 696e 616c 2064  n the original d
+000346d0: 6174 6173 6574 220a 2020 2020 2020 2020  ataset".        
+000346e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000346f0: 2020 6f75 7420 3d20 6f70 732e 6669 6c6c    out = ops.fill
+00034700: 6e61 2873 656c 662c 2076 616c 7565 290a  na(self, value).
+00034710: 2020 2020 2020 2020 7265 7475 726e 206f          return o
+00034720: 7574 0a0a 2020 2020 6465 6620 696e 7465  ut..    def inte
+00034730: 7270 6f6c 6174 655f 6e61 280a 2020 2020  rpolate_na(.    
+00034740: 2020 2020 7365 6c66 3a20 545f 4461 7461      self: T_Data
+00034750: 7365 742c 0a20 2020 2020 2020 2064 696d  set,.        dim
+00034760: 3a20 4861 7368 6162 6c65 207c 204e 6f6e  : Hashable | Non
+00034770: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+00034780: 2020 6d65 7468 6f64 3a20 496e 7465 7270    method: Interp
+00034790: 4f70 7469 6f6e 7320 3d20 226c 696e 6561  Options = "linea
+000347a0: 7222 2c0a 2020 2020 2020 2020 6c69 6d69  r",.        limi
+000347b0: 743a 2069 6e74 207c 204e 6f6e 6520 3d20  t: int | None = 
+000347c0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7573  None,.        us
+000347d0: 655f 636f 6f72 6469 6e61 7465 3a20 626f  e_coordinate: bo
+000347e0: 6f6c 207c 2048 6173 6861 626c 6520 3d20  ol | Hashable = 
+000347f0: 5472 7565 2c0a 2020 2020 2020 2020 6d61  True,.        ma
+00034800: 785f 6761 703a 2028 0a20 2020 2020 2020  x_gap: (.       
+00034810: 2020 2020 2069 6e74 207c 2066 6c6f 6174       int | float
+00034820: 207c 2073 7472 207c 2070 642e 5469 6d65   | str | pd.Time
+00034830: 6465 6c74 6120 7c20 6e70 2e74 696d 6564  delta | np.timed
+00034840: 656c 7461 3634 207c 2064 6174 6574 696d  elta64 | datetim
+00034850: 652e 7469 6d65 6465 6c74 610a 2020 2020  e.timedelta.    
+00034860: 2020 2020 2920 3d20 4e6f 6e65 2c0a 2020      ) = None,.  
+00034870: 2020 2020 2020 2a2a 6b77 6172 6773 3a20        **kwargs: 
+00034880: 416e 792c 0a20 2020 2029 202d 3e20 545f  Any,.    ) -> T_
+00034890: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
+000348a0: 2022 2222 4669 6c6c 2069 6e20 4e61 4e73   """Fill in NaNs
+000348b0: 2062 7920 696e 7465 7270 6f6c 6174 696e   by interpolatin
+000348c0: 6720 6163 636f 7264 696e 6720 746f 2064  g according to d
+000348d0: 6966 6665 7265 6e74 206d 6574 686f 6473  ifferent methods
+000348e0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+000348f0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00034900: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00034910: 2064 696d 203a 2048 6173 6861 626c 6520   dim : Hashable 
+00034920: 6f72 204e 6f6e 652c 206f 7074 696f 6e61  or None, optiona
+00034930: 6c0a 2020 2020 2020 2020 2020 2020 5370  l.            Sp
+00034940: 6563 6966 6965 7320 7468 6520 6469 6d65  ecifies the dime
+00034950: 6e73 696f 6e20 616c 6f6e 6720 7768 6963  nsion along whic
+00034960: 6820 746f 2069 6e74 6572 706f 6c61 7465  h to interpolate
+00034970: 2e0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
+00034980: 203a 207b 226c 696e 6561 7222 2c20 226e   : {"linear", "n
+00034990: 6561 7265 7374 222c 2022 7a65 726f 222c  earest", "zero",
+000349a0: 2022 736c 696e 6561 7222 2c20 2271 7561   "slinear", "qua
+000349b0: 6472 6174 6963 222c 2022 6375 6269 6322  dratic", "cubic"
+000349c0: 2c20 2270 6f6c 796e 6f6d 6961 6c22 2c20  , "polynomial", 
+000349d0: 5c0a 2020 2020 2020 2020 2020 2020 2262  \.            "b
+000349e0: 6172 7963 656e 7472 6963 222c 2022 6b72  arycentric", "kr
+000349f0: 6f67 222c 2022 7063 6869 7022 2c20 2273  og", "pchip", "s
+00034a00: 706c 696e 6522 2c20 2261 6b69 6d61 227d  pline", "akima"}
+00034a10: 2c20 6465 6661 756c 743a 2022 6c69 6e65  , default: "line
+00034a20: 6172 220a 2020 2020 2020 2020 2020 2020  ar".            
+00034a30: 5374 7269 6e67 2069 6e64 6963 6174 696e  String indicatin
+00034a40: 6720 7768 6963 6820 6d65 7468 6f64 2074  g which method t
+00034a50: 6f20 7573 6520 666f 7220 696e 7465 7270  o use for interp
+00034a60: 6f6c 6174 696f 6e3a 0a0a 2020 2020 2020  olation:..      
+00034a70: 2020 2020 2020 2d20 276c 696e 6561 7227        - 'linear'
+00034a80: 3a20 6c69 6e65 6172 2069 6e74 6572 706f  : linear interpo
+00034a90: 6c61 7469 6f6e 2e20 4164 6469 7469 6f6e  lation. Addition
+00034aa0: 616c 206b 6579 776f 7264 0a20 2020 2020  al keyword.     
+00034ab0: 2020 2020 2020 2020 2061 7267 756d 656e           argumen
+00034ac0: 7473 2061 7265 2070 6173 7365 6420 746f  ts are passed to
+00034ad0: 203a 7079 3a66 756e 633a 606e 756d 7079   :py:func:`numpy
+00034ae0: 2e69 6e74 6572 7060 0a20 2020 2020 2020  .interp`.       
+00034af0: 2020 2020 202d 2027 6e65 6172 6573 7427       - 'nearest'
+00034b00: 2c20 277a 6572 6f27 2c20 2773 6c69 6e65  , 'zero', 'sline
+00034b10: 6172 272c 2027 7175 6164 7261 7469 6327  ar', 'quadratic'
+00034b20: 2c20 2763 7562 6963 272c 2027 706f 6c79  , 'cubic', 'poly
+00034b30: 6e6f 6d69 616c 273a 0a20 2020 2020 2020  nomial':.       
+00034b40: 2020 2020 2020 2061 7265 2070 6173 7365         are passe
+00034b50: 6420 746f 203a 7079 3a66 756e 633a 6073  d to :py:func:`s
+00034b60: 6369 7079 2e69 6e74 6572 706f 6c61 7465  cipy.interpolate
+00034b70: 2e69 6e74 6572 7031 6460 2e20 4966 0a20  .interp1d`. If. 
+00034b80: 2020 2020 2020 2020 2020 2020 2060 606d               ``m
+00034b90: 6574 686f 643d 2770 6f6c 796e 6f6d 6961  ethod='polynomia
+00034ba0: 6c27 6060 2c20 7468 6520 6060 6f72 6465  l'``, the ``orde
+00034bb0: 7260 6020 6b65 7977 6f72 6420 6172 6775  r`` keyword argu
+00034bc0: 6d65 6e74 206d 7573 7420 616c 736f 2062  ment must also b
+00034bd0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00034be0: 7072 6f76 6964 6564 2e0a 2020 2020 2020  provided..      
+00034bf0: 2020 2020 2020 2d20 2762 6172 7963 656e        - 'barycen
+00034c00: 7472 6963 272c 2027 6b72 6f67 272c 2027  tric', 'krog', '
+00034c10: 7063 6869 7027 2c20 2773 706c 696e 6527  pchip', 'spline'
+00034c20: 2c20 2761 6b69 6d61 273a 2075 7365 2074  , 'akima': use t
+00034c30: 6865 6972 0a20 2020 2020 2020 2020 2020  heir.           
+00034c40: 2020 2072 6573 7065 6374 6976 6520 3a70     respective :p
+00034c50: 793a 636c 6173 733a 6073 6369 7079 2e69  y:class:`scipy.i
+00034c60: 6e74 6572 706f 6c61 7465 6020 636c 6173  nterpolate` clas
+00034c70: 7365 732e 0a0a 2020 2020 2020 2020 7573  ses...        us
+00034c80: 655f 636f 6f72 6469 6e61 7465 203a 2062  e_coordinate : b
+00034c90: 6f6f 6c20 6f72 2048 6173 6861 626c 652c  ool or Hashable,
+00034ca0: 2064 6566 6175 6c74 3a20 5472 7565 0a20   default: True. 
+00034cb0: 2020 2020 2020 2020 2020 2053 7065 6369             Speci
+00034cc0: 6669 6573 2077 6869 6368 2069 6e64 6578  fies which index
+00034cd0: 2074 6f20 7573 6520 6173 2074 6865 2078   to use as the x
+00034ce0: 2076 616c 7565 7320 696e 2074 6865 2069   values in the i
+00034cf0: 6e74 6572 706f 6c61 7469 6f6e 0a20 2020  nterpolation.   
+00034d00: 2020 2020 2020 2020 2066 6f72 6d75 6c61           formula
+00034d10: 7465 6420 6173 2060 7920 3d20 6628 7829  ted as `y = f(x)
+00034d20: 602e 2049 6620 4661 6c73 652c 2076 616c  `. If False, val
+00034d30: 7565 7320 6172 6520 7472 6561 7465 6420  ues are treated 
+00034d40: 6173 2069 660a 2020 2020 2020 2020 2020  as if.          
+00034d50: 2020 6571 7561 6c6c 792d 7370 6163 6564    equally-spaced
+00034d60: 2061 6c6f 6e67 2060 6064 696d 6060 2e20   along ``dim``. 
+00034d70: 4966 2054 7275 652c 2074 6865 2049 6e64  If True, the Ind
+00034d80: 6578 5661 7269 6162 6c65 2060 6469 6d60  exVariable `dim`
+00034d90: 2069 730a 2020 2020 2020 2020 2020 2020   is.            
+00034da0: 7573 6564 2e20 4966 2060 6075 7365 5f63  used. If ``use_c
+00034db0: 6f6f 7264 696e 6174 6560 6020 6973 2061  oordinate`` is a
+00034dc0: 2073 7472 696e 672c 2069 7420 7370 6563   string, it spec
+00034dd0: 6966 6965 7320 7468 6520 6e61 6d65 206f  ifies the name o
+00034de0: 6620 610a 2020 2020 2020 2020 2020 2020  f a.            
+00034df0: 636f 6f72 6469 6e61 7465 2076 6172 6961  coordinate varia
+00034e00: 626c 6520 746f 2075 7365 2061 7320 7468  ble to use as th
+00034e10: 6520 696e 6465 782e 0a20 2020 2020 2020  e index..       
+00034e20: 206c 696d 6974 203a 2069 6e74 2c20 6465   limit : int, de
+00034e30: 6661 756c 743a 204e 6f6e 650a 2020 2020  fault: None.    
+00034e40: 2020 2020 2020 2020 4d61 7869 6d75 6d20          Maximum 
+00034e50: 6e75 6d62 6572 206f 6620 636f 6e73 6563  number of consec
+00034e60: 7574 6976 6520 4e61 4e73 2074 6f20 6669  utive NaNs to fi
+00034e70: 6c6c 2e20 4d75 7374 2062 6520 6772 6561  ll. Must be grea
+00034e80: 7465 7220 7468 616e 2030 0a20 2020 2020  ter than 0.     
+00034e90: 2020 2020 2020 206f 7220 4e6f 6e65 2066         or None f
+00034ea0: 6f72 206e 6f20 6c69 6d69 742e 2054 6869  or no limit. Thi
+00034eb0: 7320 6669 6c6c 696e 6720 6973 2064 6f6e  s filling is don
+00034ec0: 6520 7265 6761 7264 6c65 7373 206f 6620  e regardless of 
+00034ed0: 7468 6520 7369 7a65 206f 660a 2020 2020  the size of.    
+00034ee0: 2020 2020 2020 2020 7468 6520 6761 7020          the gap 
+00034ef0: 696e 2074 6865 2064 6174 612e 2054 6f20  in the data. To 
+00034f00: 6f6e 6c79 2069 6e74 6572 706f 6c61 7465  only interpolate
+00034f10: 206f 7665 7220 6761 7073 206c 6573 7320   over gaps less 
+00034f20: 7468 616e 2061 2067 6976 656e 206c 656e  than a given len
+00034f30: 6774 682c 0a20 2020 2020 2020 2020 2020  gth,.           
+00034f40: 2073 6565 2060 606d 6178 5f67 6170 6060   see ``max_gap``
+00034f50: 2e0a 2020 2020 2020 2020 6d61 785f 6761  ..        max_ga
+00034f60: 7020 3a20 696e 742c 2066 6c6f 6174 2c20  p : int, float, 
+00034f70: 7374 722c 2070 616e 6461 732e 5469 6d65  str, pandas.Time
+00034f80: 6465 6c74 612c 206e 756d 7079 2e74 696d  delta, numpy.tim
+00034f90: 6564 656c 7461 3634 2c20 6461 7465 7469  edelta64, dateti
+00034fa0: 6d65 2e74 696d 6564 656c 7461 2c20 6465  me.timedelta, de
+00034fb0: 6661 756c 743a 204e 6f6e 650a 2020 2020  fault: None.    
+00034fc0: 2020 2020 2020 2020 4d61 7869 6d75 6d20          Maximum 
+00034fd0: 7369 7a65 206f 6620 6761 702c 2061 2063  size of gap, a c
+00034fe0: 6f6e 7469 6e75 6f75 7320 7365 7175 656e  ontinuous sequen
+00034ff0: 6365 206f 6620 4e61 4e73 2c20 7468 6174  ce of NaNs, that
+00035000: 2077 696c 6c20 6265 2066 696c 6c65 642e   will be filled.
+00035010: 0a20 2020 2020 2020 2020 2020 2055 7365  .            Use
+00035020: 204e 6f6e 6520 666f 7220 6e6f 206c 696d   None for no lim
+00035030: 6974 2e20 5768 656e 2069 6e74 6572 706f  it. When interpo
+00035040: 6c61 7469 6e67 2061 6c6f 6e67 2061 2064  lating along a d
+00035050: 6174 6574 696d 6536 3420 6469 6d65 6e73  atetime64 dimens
+00035060: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
+00035070: 616e 6420 6060 7573 655f 636f 6f72 6469  and ``use_coordi
+00035080: 6e61 7465 3d54 7275 6560 602c 2060 606d  nate=True``, ``m
+00035090: 6178 5f67 6170 6060 2063 616e 2062 6520  ax_gap`` can be 
+000350a0: 6f6e 6520 6f66 2074 6865 2066 6f6c 6c6f  one of the follo
+000350b0: 7769 6e67 3a0a 0a20 2020 2020 2020 2020  wing:..         
+000350c0: 2020 202d 2061 2073 7472 696e 6720 7468     - a string th
+000350d0: 6174 2069 7320 7661 6c69 6420 696e 7075  at is valid inpu
+000350e0: 7420 666f 7220 7061 6e64 6173 2e74 6f5f  t for pandas.to_
+000350f0: 7469 6d65 6465 6c74 610a 2020 2020 2020  timedelta.      
+00035100: 2020 2020 2020 2d20 6120 3a70 793a 636c        - a :py:cl
+00035110: 6173 733a 606e 756d 7079 2e74 696d 6564  ass:`numpy.timed
+00035120: 656c 7461 3634 6020 6f62 6a65 6374 0a20  elta64` object. 
+00035130: 2020 2020 2020 2020 2020 202d 2061 203a             - a :
+00035140: 7079 3a63 6c61 7373 3a60 7061 6e64 6173  py:class:`pandas
+00035150: 2e54 696d 6564 656c 7461 6020 6f62 6a65  .Timedelta` obje
+00035160: 6374 0a20 2020 2020 2020 2020 2020 202d  ct.            -
+00035170: 2061 203a 7079 3a63 6c61 7373 3a60 6461   a :py:class:`da
+00035180: 7465 7469 6d65 2e74 696d 6564 656c 7461  tetime.timedelta
+00035190: 6020 6f62 6a65 6374 0a0a 2020 2020 2020  ` object..      
+000351a0: 2020 2020 2020 4f74 6865 7277 6973 652c        Otherwise,
+000351b0: 2060 606d 6178 5f67 6170 6060 206d 7573   ``max_gap`` mus
+000351c0: 7420 6265 2061 6e20 696e 7420 6f72 2061  t be an int or a
+000351d0: 2066 6c6f 6174 2e20 5573 6520 6f66 2060   float. Use of `
+000351e0: 606d 6178 5f67 6170 6060 2077 6974 6820  `max_gap`` with 
+000351f0: 756e 6c61 6265 6c65 640a 2020 2020 2020  unlabeled.      
+00035200: 2020 2020 2020 6469 6d65 6e73 696f 6e73        dimensions
+00035210: 2068 6173 206e 6f74 2062 6565 6e20 696d   has not been im
+00035220: 706c 656d 656e 7465 6420 7965 742e 2047  plemented yet. G
+00035230: 6170 206c 656e 6774 6820 6973 2064 6566  ap length is def
+00035240: 696e 6564 2061 7320 7468 6520 6469 6666  ined as the diff
+00035250: 6572 656e 6365 0a20 2020 2020 2020 2020  erence.         
+00035260: 2020 2062 6574 7765 656e 2063 6f6f 7264     between coord
+00035270: 696e 6174 6520 7661 6c75 6573 2061 7420  inate values at 
+00035280: 7468 6520 6669 7273 7420 6461 7461 2070  the first data p
+00035290: 6f69 6e74 2061 6674 6572 2061 2067 6170  oint after a gap
+000352a0: 2061 6e64 2074 6865 206c 6173 7420 7661   and the last va
+000352b0: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+000352c0: 6265 666f 7265 2061 2067 6170 2e20 466f  before a gap. Fo
+000352d0: 7220 6761 7073 2061 7420 7468 6520 6265  r gaps at the be
+000352e0: 6769 6e6e 696e 6720 2865 6e64 292c 2067  ginning (end), g
+000352f0: 6170 206c 656e 6774 6820 6973 2064 6566  ap length is def
+00035300: 696e 6564 2061 7320 7468 6520 6469 6666  ined as the diff
+00035310: 6572 656e 6365 0a20 2020 2020 2020 2020  erence.         
+00035320: 2020 2062 6574 7765 656e 2063 6f6f 7264     between coord
+00035330: 696e 6174 6520 7661 6c75 6573 2061 7420  inate values at 
+00035340: 7468 6520 6669 7273 7420 286c 6173 7429  the first (last)
+00035350: 2076 616c 6964 2064 6174 6120 706f 696e   valid data poin
+00035360: 7420 616e 6420 7468 6520 6669 7273 7420  t and the first 
+00035370: 286c 6173 7429 204e 614e 2e0a 2020 2020  (last) NaN..    
+00035380: 2020 2020 2020 2020 466f 7220 6578 616d          For exam
+00035390: 706c 652c 2063 6f6e 7369 6465 723a 3a0a  ple, consider::.
+000353a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000353b0: 203c 7861 7272 6179 2e44 6174 6141 7272   <xarray.DataArr
+000353c0: 6179 2028 783a 2039 293e 0a20 2020 2020  ay (x: 9)>.     
+000353d0: 2020 2020 2020 2020 2020 2061 7272 6179             array
+000353e0: 285b 6e61 6e2c 206e 616e 2c20 6e61 6e2c  ([nan, nan, nan,
+000353f0: 2020 312e 2c20 6e61 6e2c 206e 616e 2c20    1., nan, nan, 
+00035400: 2034 2e2c 206e 616e 2c20 6e61 6e5d 290a   4., nan, nan]).
+00035410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00035420: 436f 6f72 6469 6e61 7465 733a 0a20 2020  Coordinates:.   
+00035430: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+00035440: 2078 2020 2020 2020 2020 2878 2920 696e   x        (x) in
+00035450: 7436 3420 3020 3120 3220 3320 3420 3520  t64 0 1 2 3 4 5 
+00035460: 3620 3720 380a 0a20 2020 2020 2020 2020  6 7 8..         
+00035470: 2020 2054 6865 2067 6170 206c 656e 6774     The gap lengt
+00035480: 6873 2061 7265 2033 2d30 203d 2033 3b20  hs are 3-0 = 3; 
+00035490: 362d 3320 3d20 333b 2061 6e64 2038 2d36  6-3 = 3; and 8-6
+000354a0: 203d 2032 2072 6573 7065 6374 6976 656c   = 2 respectivel
+000354b0: 790a 2020 2020 2020 2020 2a2a 6b77 6172  y.        **kwar
+000354c0: 6773 203a 2064 6963 742c 206f 7074 696f  gs : dict, optio
+000354d0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+000354e0: 7061 7261 6d65 7465 7273 2070 6173 7365  parameters passe
+000354f0: 6420 7665 7262 6174 696d 2074 6f20 7468  d verbatim to th
+00035500: 6520 756e 6465 726c 7969 6e67 2069 6e74  e underlying int
+00035510: 6572 706f 6c61 7469 6f6e 2066 756e 6374  erpolation funct
+00035520: 696f 6e0a 0a20 2020 2020 2020 2052 6574  ion..        Ret
+00035530: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00035540: 2d2d 2d2d 0a20 2020 2020 2020 2069 6e74  ----.        int
+00035550: 6572 706f 6c61 7465 643a 2044 6174 6173  erpolated: Datas
+00035560: 6574 0a20 2020 2020 2020 2020 2020 2046  et.            F
+00035570: 696c 6c65 6420 696e 2044 6174 6173 6574  illed in Dataset
+00035580: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+00035590: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+000355a0: 2d2d 2d2d 0a20 2020 2020 2020 206e 756d  ----.        num
+000355b0: 7079 2e69 6e74 6572 700a 2020 2020 2020  py.interp.      
+000355c0: 2020 7363 6970 792e 696e 7465 7270 6f6c    scipy.interpol
+000355d0: 6174 650a 0a20 2020 2020 2020 2045 7861  ate..        Exa
+000355e0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+000355f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00035600: 3e3e 2064 7320 3d20 7872 2e44 6174 6173  >> ds = xr.Datas
+00035610: 6574 280a 2020 2020 2020 2020 2e2e 2e20  et(.        ... 
+00035620: 2020 2020 7b0a 2020 2020 2020 2020 2e2e      {.        ..
+00035630: 2e20 2020 2020 2020 2020 2241 223a 2028  .         "A": (
+00035640: 2278 222c 205b 6e70 2e6e 616e 2c20 322c  "x", [np.nan, 2,
+00035650: 2033 2c20 6e70 2e6e 616e 2c20 305d 292c   3, np.nan, 0]),
+00035660: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+00035670: 2020 2020 2022 4222 3a20 2822 7822 2c20       "B": ("x", 
+00035680: 5b33 2c20 342c 206e 702e 6e61 6e2c 2031  [3, 4, np.nan, 1
+00035690: 2c20 375d 292c 0a20 2020 2020 2020 202e  , 7]),.        .
+000356a0: 2e2e 2020 2020 2020 2020 2022 4322 3a20  ..         "C": 
+000356b0: 2822 7822 2c20 5b6e 702e 6e61 6e2c 206e  ("x", [np.nan, n
+000356c0: 702e 6e61 6e2c 206e 702e 6e61 6e2c 2035  p.nan, np.nan, 5
+000356d0: 2c20 305d 292c 0a20 2020 2020 2020 202e  , 0]),.        .
+000356e0: 2e2e 2020 2020 2020 2020 2022 4422 3a20  ..         "D": 
+000356f0: 2822 7822 2c20 5b6e 702e 6e61 6e2c 2033  ("x", [np.nan, 3
+00035700: 2c20 6e70 2e6e 616e 2c20 2d31 2c20 345d  , np.nan, -1, 4]
+00035710: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
+00035720: 2020 207d 2c0a 2020 2020 2020 2020 2e2e     },.        ..
+00035730: 2e20 2020 2020 636f 6f72 6473 3d7b 2278  .     coords={"x
+00035740: 223a 205b 302c 2031 2c20 322c 2033 2c20  ": [0, 1, 2, 3, 
+00035750: 345d 7d2c 0a20 2020 2020 2020 202e 2e2e  4]},.        ...
+00035760: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
+00035770: 730a 2020 2020 2020 2020 3c78 6172 7261  s.        <xarra
+00035780: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
+00035790: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
+000357a0: 2878 3a20 3529 0a20 2020 2020 2020 2043  (x: 5).        C
+000357b0: 6f6f 7264 696e 6174 6573 3a0a 2020 2020  oordinates:.    
+000357c0: 2020 2020 2020 2a20 7820 2020 2020 2020        * x       
+000357d0: 2028 7829 2069 6e74 3634 2030 2031 2032   (x) int64 0 1 2
+000357e0: 2033 2034 0a20 2020 2020 2020 2044 6174   3 4.        Dat
+000357f0: 6120 7661 7269 6162 6c65 733a 0a20 2020  a variables:.   
+00035800: 2020 2020 2020 2020 2041 2020 2020 2020           A      
+00035810: 2020 2878 2920 666c 6f61 7436 3420 6e61    (x) float64 na
+00035820: 6e20 322e 3020 332e 3020 6e61 6e20 302e  n 2.0 3.0 nan 0.
+00035830: 300a 2020 2020 2020 2020 2020 2020 4220  0.            B 
+00035840: 2020 2020 2020 2028 7829 2066 6c6f 6174         (x) float
+00035850: 3634 2033 2e30 2034 2e30 206e 616e 2031  64 3.0 4.0 nan 1
+00035860: 2e30 2037 2e30 0a20 2020 2020 2020 2020  .0 7.0.         
+00035870: 2020 2043 2020 2020 2020 2020 2878 2920     C        (x) 
+00035880: 666c 6f61 7436 3420 6e61 6e20 6e61 6e20  float64 nan nan 
+00035890: 6e61 6e20 352e 3020 302e 300a 2020 2020  nan 5.0 0.0.    
+000358a0: 2020 2020 2020 2020 4420 2020 2020 2020          D       
+000358b0: 2028 7829 2066 6c6f 6174 3634 206e 616e   (x) float64 nan
+000358c0: 2033 2e30 206e 616e 202d 312e 3020 342e   3.0 nan -1.0 4.
+000358d0: 300a 0a20 2020 2020 2020 203e 3e3e 2064  0..        >>> d
+000358e0: 732e 696e 7465 7270 6f6c 6174 655f 6e61  s.interpolate_na
+000358f0: 2864 696d 3d22 7822 2c20 6d65 7468 6f64  (dim="x", method
+00035900: 3d22 6c69 6e65 6172 2229 0a20 2020 2020  ="linear").     
+00035910: 2020 203c 7861 7272 6179 2e44 6174 6173     <xarray.Datas
+00035920: 6574 3e0a 2020 2020 2020 2020 4469 6d65  et>.        Dime
+00035930: 6e73 696f 6e73 3a20 2028 783a 2035 290a  nsions:  (x: 5).
+00035940: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
+00035950: 7465 733a 0a20 2020 2020 2020 2020 202a  tes:.          *
+00035960: 2078 2020 2020 2020 2020 2878 2920 696e   x        (x) in
+00035970: 7436 3420 3020 3120 3220 3320 340a 2020  t64 0 1 2 3 4.  
+00035980: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
+00035990: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
+000359a0: 2020 4120 2020 2020 2020 2028 7829 2066    A        (x) f
+000359b0: 6c6f 6174 3634 206e 616e 2032 2e30 2033  loat64 nan 2.0 3
+000359c0: 2e30 2031 2e35 2030 2e30 0a20 2020 2020  .0 1.5 0.0.     
+000359d0: 2020 2020 2020 2042 2020 2020 2020 2020         B        
+000359e0: 2878 2920 666c 6f61 7436 3420 332e 3020  (x) float64 3.0 
+000359f0: 342e 3020 322e 3520 312e 3020 372e 300a  4.0 2.5 1.0 7.0.
+00035a00: 2020 2020 2020 2020 2020 2020 4320 2020              C   
+00035a10: 2020 2020 2028 7829 2066 6c6f 6174 3634       (x) float64
+00035a20: 206e 616e 206e 616e 206e 616e 2035 2e30   nan nan nan 5.0
+00035a30: 2030 2e30 0a20 2020 2020 2020 2020 2020   0.0.           
+00035a40: 2044 2020 2020 2020 2020 2878 2920 666c   D        (x) fl
+00035a50: 6f61 7436 3420 6e61 6e20 332e 3020 312e  oat64 nan 3.0 1.
+00035a60: 3020 2d31 2e30 2034 2e30 0a0a 2020 2020  0 -1.0 4.0..    
+00035a70: 2020 2020 3e3e 3e20 6473 2e69 6e74 6572      >>> ds.inter
+00035a80: 706f 6c61 7465 5f6e 6128 6469 6d3d 2278  polate_na(dim="x
+00035a90: 222c 206d 6574 686f 643d 226c 696e 6561  ", method="linea
+00035aa0: 7222 2c20 6669 6c6c 5f76 616c 7565 3d22  r", fill_value="
+00035ab0: 6578 7472 6170 6f6c 6174 6522 290a 2020  extrapolate").  
+00035ac0: 2020 2020 2020 3c78 6172 7261 792e 4461        <xarray.Da
+00035ad0: 7461 7365 743e 0a20 2020 2020 2020 2044  taset>.        D
+00035ae0: 696d 656e 7369 6f6e 733a 2020 2878 3a20  imensions:  (x: 
+00035af0: 3529 0a20 2020 2020 2020 2043 6f6f 7264  5).        Coord
+00035b00: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
+00035b10: 2020 2a20 7820 2020 2020 2020 2028 7829    * x        (x)
+00035b20: 2069 6e74 3634 2030 2031 2032 2033 2034   int64 0 1 2 3 4
+00035b30: 0a20 2020 2020 2020 2044 6174 6120 7661  .        Data va
+00035b40: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
+00035b50: 2020 2020 2041 2020 2020 2020 2020 2878       A        (x
+00035b60: 2920 666c 6f61 7436 3420 312e 3020 322e  ) float64 1.0 2.
+00035b70: 3020 332e 3020 312e 3520 302e 300a 2020  0 3.0 1.5 0.0.  
+00035b80: 2020 2020 2020 2020 2020 4220 2020 2020            B     
+00035b90: 2020 2028 7829 2066 6c6f 6174 3634 2033     (x) float64 3
+00035ba0: 2e30 2034 2e30 2032 2e35 2031 2e30 2037  .0 4.0 2.5 1.0 7
+00035bb0: 2e30 0a20 2020 2020 2020 2020 2020 2043  .0.            C
+00035bc0: 2020 2020 2020 2020 2878 2920 666c 6f61          (x) floa
+00035bd0: 7436 3420 3230 2e30 2031 352e 3020 3130  t64 20.0 15.0 10
+00035be0: 2e30 2035 2e30 2030 2e30 0a20 2020 2020  .0 5.0 0.0.     
+00035bf0: 2020 2020 2020 2044 2020 2020 2020 2020         D        
+00035c00: 2878 2920 666c 6f61 7436 3420 352e 3020  (x) float64 5.0 
+00035c10: 332e 3020 312e 3020 2d31 2e30 2034 2e30  3.0 1.0 -1.0 4.0
+00035c20: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00035c30: 2020 2020 2066 726f 6d20 7861 7272 6179       from xarray
+00035c40: 2e63 6f72 652e 6d69 7373 696e 6720 696d  .core.missing im
+00035c50: 706f 7274 205f 6170 706c 795f 6f76 6572  port _apply_over
+00035c60: 5f76 6172 735f 7769 7468 5f64 696d 2c20  _vars_with_dim, 
+00035c70: 696e 7465 7270 5f6e 610a 0a20 2020 2020  interp_na..     
+00035c80: 2020 206e 6577 203d 205f 6170 706c 795f     new = _apply_
+00035c90: 6f76 6572 5f76 6172 735f 7769 7468 5f64  over_vars_with_d
+00035ca0: 696d 280a 2020 2020 2020 2020 2020 2020  im(.            
+00035cb0: 696e 7465 7270 5f6e 612c 0a20 2020 2020  interp_na,.     
+00035cc0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00035cd0: 2020 2020 2020 2020 2064 696d 3d64 696d           dim=dim
+00035ce0: 2c0a 2020 2020 2020 2020 2020 2020 6d65  ,.            me
+00035cf0: 7468 6f64 3d6d 6574 686f 642c 0a20 2020  thod=method,.   
+00035d00: 2020 2020 2020 2020 206c 696d 6974 3d6c           limit=l
+00035d10: 696d 6974 2c0a 2020 2020 2020 2020 2020  imit,.          
+00035d20: 2020 7573 655f 636f 6f72 6469 6e61 7465    use_coordinate
+00035d30: 3d75 7365 5f63 6f6f 7264 696e 6174 652c  =use_coordinate,
+00035d40: 0a20 2020 2020 2020 2020 2020 206d 6178  .            max
+00035d50: 5f67 6170 3d6d 6178 5f67 6170 2c0a 2020  _gap=max_gap,.  
+00035d60: 2020 2020 2020 2020 2020 2a2a 6b77 6172            **kwar
+00035d70: 6773 2c0a 2020 2020 2020 2020 290a 2020  gs,.        ).  
+00035d80: 2020 2020 2020 7265 7475 726e 206e 6577        return new
+00035d90: 0a0a 2020 2020 6465 6620 6666 696c 6c28  ..    def ffill(
+00035da0: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+00035db0: 2064 696d 3a20 4861 7368 6162 6c65 2c20   dim: Hashable, 
+00035dc0: 6c69 6d69 743a 2069 6e74 207c 204e 6f6e  limit: int | Non
+00035dd0: 6520 3d20 4e6f 6e65 2920 2d3e 2054 5f44  e = None) -> T_D
+00035de0: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00035df0: 2222 2246 696c 6c20 4e61 4e20 7661 6c75  """Fill NaN valu
+00035e00: 6573 2062 7920 7072 6f70 6167 6174 696e  es by propagatin
+00035e10: 6720 7661 6c75 6573 2066 6f72 7761 7264  g values forward
+00035e20: 0a0a 2020 2020 2020 2020 2a52 6571 7569  ..        *Requi
+00035e30: 7265 7320 626f 7474 6c65 6e65 636b 2e2a  res bottleneck.*
+00035e40: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00035e50: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00035e60: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00035e70: 6469 6d20 3a20 4861 7368 6162 6c65 0a20  dim : Hashable. 
+00035e80: 2020 2020 2020 2020 2020 2053 7065 6369             Speci
+00035e90: 6669 6573 2074 6865 2064 696d 656e 7369  fies the dimensi
+00035ea0: 6f6e 2061 6c6f 6e67 2077 6869 6368 2074  on along which t
+00035eb0: 6f20 7072 6f70 6167 6174 6520 7661 6c75  o propagate valu
+00035ec0: 6573 2077 6865 6e0a 2020 2020 2020 2020  es when.        
+00035ed0: 2020 2020 6669 6c6c 696e 672e 0a20 2020      filling..   
+00035ee0: 2020 2020 206c 696d 6974 203a 2069 6e74       limit : int
+00035ef0: 206f 7220 4e6f 6e65 2c20 6f70 7469 6f6e   or None, option
+00035f00: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
+00035f10: 6865 206d 6178 696d 756d 206e 756d 6265  he maximum numbe
+00035f20: 7220 6f66 2063 6f6e 7365 6375 7469 7665  r of consecutive
+00035f30: 204e 614e 2076 616c 7565 7320 746f 2066   NaN values to f
+00035f40: 6f72 7761 7264 2066 696c 6c2e 2049 6e0a  orward fill. In.
+00035f50: 2020 2020 2020 2020 2020 2020 6f74 6865              othe
+00035f60: 7220 776f 7264 732c 2069 6620 7468 6572  r words, if ther
+00035f70: 6520 6973 2061 2067 6170 2077 6974 6820  e is a gap with 
+00035f80: 6d6f 7265 2074 6861 6e20 7468 6973 206e  more than this n
+00035f90: 756d 6265 7220 6f66 0a20 2020 2020 2020  umber of.       
+00035fa0: 2020 2020 2063 6f6e 7365 6375 7469 7665       consecutive
+00035fb0: 204e 614e 732c 2069 7420 7769 6c6c 206f   NaNs, it will o
+00035fc0: 6e6c 7920 6265 2070 6172 7469 616c 6c79  nly be partially
+00035fd0: 2066 696c 6c65 642e 204d 7573 7420 6265   filled. Must be
+00035fe0: 2067 7265 6174 6572 0a20 2020 2020 2020   greater.       
+00035ff0: 2020 2020 2074 6861 6e20 3020 6f72 204e       than 0 or N
+00036000: 6f6e 6520 666f 7220 6e6f 206c 696d 6974  one for no limit
+00036010: 2e20 4d75 7374 2062 6520 4e6f 6e65 206f  . Must be None o
+00036020: 7220 6772 6561 7465 7220 7468 616e 206f  r greater than o
+00036030: 7220 6571 7561 6c0a 2020 2020 2020 2020  r equal.        
+00036040: 2020 2020 746f 2061 7869 7320 6c65 6e67      to axis leng
+00036050: 7468 2069 6620 6669 6c6c 696e 6720 616c  th if filling al
+00036060: 6f6e 6720 6368 756e 6b65 6420 6178 6573  ong chunked axes
+00036070: 2028 6469 6d65 6e73 696f 6e73 292e 0a0a   (dimensions)...
+00036080: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00036090: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+000360a0: 2020 2020 2020 2020 4461 7461 7365 740a          Dataset.
+000360b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000360c0: 2020 2020 6672 6f6d 2078 6172 7261 792e      from xarray.
+000360d0: 636f 7265 2e6d 6973 7369 6e67 2069 6d70  core.missing imp
+000360e0: 6f72 7420 5f61 7070 6c79 5f6f 7665 725f  ort _apply_over_
+000360f0: 7661 7273 5f77 6974 685f 6469 6d2c 2066  vars_with_dim, f
+00036100: 6669 6c6c 0a0a 2020 2020 2020 2020 6e65  fill..        ne
+00036110: 7720 3d20 5f61 7070 6c79 5f6f 7665 725f  w = _apply_over_
+00036120: 7661 7273 5f77 6974 685f 6469 6d28 6666  vars_with_dim(ff
+00036130: 696c 6c2c 2073 656c 662c 2064 696d 3d64  ill, self, dim=d
+00036140: 696d 2c20 6c69 6d69 743d 6c69 6d69 7429  im, limit=limit)
+00036150: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00036160: 6e65 770a 0a20 2020 2064 6566 2062 6669  new..    def bfi
+00036170: 6c6c 2873 656c 663a 2054 5f44 6174 6173  ll(self: T_Datas
+00036180: 6574 2c20 6469 6d3a 2048 6173 6861 626c  et, dim: Hashabl
+00036190: 652c 206c 696d 6974 3a20 696e 7420 7c20  e, limit: int | 
+000361a0: 4e6f 6e65 203d 204e 6f6e 6529 202d 3e20  None = None) -> 
+000361b0: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
+000361c0: 2020 2022 2222 4669 6c6c 204e 614e 2076     """Fill NaN v
+000361d0: 616c 7565 7320 6279 2070 726f 7061 6761  alues by propaga
+000361e0: 7469 6e67 2076 616c 7565 7320 6261 636b  ting values back
+000361f0: 7761 7264 0a0a 2020 2020 2020 2020 2a52  ward..        *R
+00036200: 6571 7569 7265 7320 626f 7474 6c65 6e65  equires bottlene
+00036210: 636b 2e2a 0a0a 2020 2020 2020 2020 5061  ck.*..        Pa
+00036220: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
+00036230: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
+00036240: 2020 2020 6469 6d20 3a20 4861 7368 6162      dim : Hashab
+00036250: 6c65 0a20 2020 2020 2020 2020 2020 2053  le.            S
+00036260: 7065 6369 6669 6573 2074 6865 2064 696d  pecifies the dim
+00036270: 656e 7369 6f6e 2061 6c6f 6e67 2077 6869  ension along whi
+00036280: 6368 2074 6f20 7072 6f70 6167 6174 6520  ch to propagate 
+00036290: 7661 6c75 6573 2077 6865 6e0a 2020 2020  values when.    
+000362a0: 2020 2020 2020 2020 6669 6c6c 696e 672e          filling.
+000362b0: 0a20 2020 2020 2020 206c 696d 6974 203a  .        limit :
+000362c0: 2069 6e74 206f 7220 4e6f 6e65 2c20 6f70   int or None, op
+000362d0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+000362e0: 2020 2054 6865 206d 6178 696d 756d 206e     The maximum n
+000362f0: 756d 6265 7220 6f66 2063 6f6e 7365 6375  umber of consecu
+00036300: 7469 7665 204e 614e 2076 616c 7565 7320  tive NaN values 
+00036310: 746f 2062 6163 6b77 6172 6420 6669 6c6c  to backward fill
+00036320: 2e20 496e 0a20 2020 2020 2020 2020 2020  . In.           
+00036330: 206f 7468 6572 2077 6f72 6473 2c20 6966   other words, if
+00036340: 2074 6865 7265 2069 7320 6120 6761 7020   there is a gap 
+00036350: 7769 7468 206d 6f72 6520 7468 616e 2074  with more than t
+00036360: 6869 7320 6e75 6d62 6572 206f 660a 2020  his number of.  
+00036370: 2020 2020 2020 2020 2020 636f 6e73 6563            consec
+00036380: 7574 6976 6520 4e61 4e73 2c20 6974 2077  utive NaNs, it w
+00036390: 696c 6c20 6f6e 6c79 2062 6520 7061 7274  ill only be part
+000363a0: 6961 6c6c 7920 6669 6c6c 6564 2e20 4d75  ially filled. Mu
+000363b0: 7374 2062 6520 6772 6561 7465 720a 2020  st be greater.  
+000363c0: 2020 2020 2020 2020 2020 7468 616e 2030            than 0
+000363d0: 206f 7220 4e6f 6e65 2066 6f72 206e 6f20   or None for no 
+000363e0: 6c69 6d69 742e 204d 7573 7420 6265 204e  limit. Must be N
+000363f0: 6f6e 6520 6f72 2067 7265 6174 6572 2074  one or greater t
+00036400: 6861 6e20 6f72 2065 7175 616c 0a20 2020  han or equal.   
+00036410: 2020 2020 2020 2020 2074 6f20 6178 6973           to axis
+00036420: 206c 656e 6774 6820 6966 2066 696c 6c69   length if filli
+00036430: 6e67 2061 6c6f 6e67 2063 6875 6e6b 6564  ng along chunked
+00036440: 2061 7865 7320 2864 696d 656e 7369 6f6e   axes (dimension
+00036450: 7329 2e0a 0a20 2020 2020 2020 2052 6574  s)...        Ret
+00036460: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+00036470: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
+00036480: 6173 6574 0a20 2020 2020 2020 2022 2222  aset.        """
+00036490: 0a20 2020 2020 2020 2066 726f 6d20 7861  .        from xa
+000364a0: 7272 6179 2e63 6f72 652e 6d69 7373 696e  rray.core.missin
+000364b0: 6720 696d 706f 7274 205f 6170 706c 795f  g import _apply_
+000364c0: 6f76 6572 5f76 6172 735f 7769 7468 5f64  over_vars_with_d
+000364d0: 696d 2c20 6266 696c 6c0a 0a20 2020 2020  im, bfill..     
+000364e0: 2020 206e 6577 203d 205f 6170 706c 795f     new = _apply_
+000364f0: 6f76 6572 5f76 6172 735f 7769 7468 5f64  over_vars_with_d
+00036500: 696d 2862 6669 6c6c 2c20 7365 6c66 2c20  im(bfill, self, 
+00036510: 6469 6d3d 6469 6d2c 206c 696d 6974 3d6c  dim=dim, limit=l
+00036520: 696d 6974 290a 2020 2020 2020 2020 7265  imit).        re
+00036530: 7475 726e 206e 6577 0a0a 2020 2020 6465  turn new..    de
+00036540: 6620 636f 6d62 696e 655f 6669 7273 7428  f combine_first(
+00036550: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+00036560: 206f 7468 6572 3a20 545f 4461 7461 7365   other: T_Datase
+00036570: 7429 202d 3e20 545f 4461 7461 7365 743a  t) -> T_Dataset:
+00036580: 0a20 2020 2020 2020 2022 2222 436f 6d62  .        """Comb
+00036590: 696e 6520 7477 6f20 4461 7461 7365 7473  ine two Datasets
+000365a0: 2c20 6465 6661 756c 7420 746f 2064 6174  , default to dat
+000365b0: 615f 7661 7273 206f 6620 7365 6c66 2e0a  a_vars of self..
+000365c0: 0a20 2020 2020 2020 2054 6865 206e 6577  .        The new
+000365d0: 2063 6f6f 7264 696e 6174 6573 2066 6f6c   coordinates fol
+000365e0: 6c6f 7720 7468 6520 6e6f 726d 616c 2062  low the normal b
+000365f0: 726f 6164 6361 7374 696e 6720 616e 6420  roadcasting and 
+00036600: 616c 6967 6e6d 656e 7420 7275 6c65 730a  alignment rules.
+00036610: 2020 2020 2020 2020 6f66 2060 606a 6f69          of ``joi
+00036620: 6e3d 276f 7574 6572 2760 602e 2020 5661  n='outer'``.  Va
+00036630: 6361 6e74 2063 656c 6c73 2069 6e20 7468  cant cells in th
+00036640: 6520 6578 7061 6e64 6564 2063 6f6f 7264  e expanded coord
+00036650: 696e 6174 6573 2061 7265 0a20 2020 2020  inates are.     
+00036660: 2020 2066 696c 6c65 6420 7769 7468 206e     filled with n
+00036670: 702e 6e61 6e2e 0a0a 2020 2020 2020 2020  p.nan...        
+00036680: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+00036690: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+000366a0: 2020 2020 2020 6f74 6865 7220 3a20 4461        other : Da
+000366b0: 7461 7365 740a 2020 2020 2020 2020 2020  taset.          
+000366c0: 2020 5573 6564 2074 6f20 6669 6c6c 2061    Used to fill a
+000366d0: 6c6c 206d 6174 6368 696e 6720 6d69 7373  ll matching miss
+000366e0: 696e 6720 7661 6c75 6573 2069 6e20 7468  ing values in th
+000366f0: 6973 2061 7272 6179 2e0a 0a20 2020 2020  is array...     
+00036700: 2020 2052 6574 7572 6e73 0a20 2020 2020     Returns.     
+00036710: 2020 202d 2d2d 2d2d 2d2d 0a20 2020 2020     -------.     
+00036720: 2020 2044 6174 6173 6574 0a20 2020 2020     Dataset.     
+00036730: 2020 2022 2222 0a20 2020 2020 2020 206f     """.        o
+00036740: 7574 203d 206f 7073 2e66 696c 6c6e 6128  ut = ops.fillna(
+00036750: 7365 6c66 2c20 6f74 6865 722c 206a 6f69  self, other, joi
+00036760: 6e3d 226f 7574 6572 222c 2064 6174 6173  n="outer", datas
+00036770: 6574 5f6a 6f69 6e3d 226f 7574 6572 2229  et_join="outer")
+00036780: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00036790: 6f75 740a 0a20 2020 2064 6566 2072 6564  out..    def red
+000367a0: 7563 6528 0a20 2020 2020 2020 2073 656c  uce(.        sel
+000367b0: 663a 2054 5f44 6174 6173 6574 2c0a 2020  f: T_Dataset,.  
+000367c0: 2020 2020 2020 6675 6e63 3a20 4361 6c6c        func: Call
+000367d0: 6162 6c65 2c0a 2020 2020 2020 2020 6469  able,.        di
+000367e0: 6d3a 2044 696d 7320 3d20 4e6f 6e65 2c0a  m: Dims = None,.
+000367f0: 2020 2020 2020 2020 2a2c 0a20 2020 2020          *,.     
+00036800: 2020 206b 6565 705f 6174 7472 733a 2062     keep_attrs: b
+00036810: 6f6f 6c20 7c20 4e6f 6e65 203d 204e 6f6e  ool | None = Non
+00036820: 652c 0a20 2020 2020 2020 206b 6565 7064  e,.        keepd
+00036830: 696d 733a 2062 6f6f 6c20 3d20 4661 6c73  ims: bool = Fals
+00036840: 652c 0a20 2020 2020 2020 206e 756d 6572  e,.        numer
+00036850: 6963 5f6f 6e6c 793a 2062 6f6f 6c20 3d20  ic_only: bool = 
+00036860: 4661 6c73 652c 0a20 2020 2020 2020 202a  False,.        *
+00036870: 2a6b 7761 7267 733a 2041 6e79 2c0a 2020  *kwargs: Any,.  
+00036880: 2020 2920 2d3e 2054 5f44 6174 6173 6574    ) -> T_Dataset
+00036890: 3a0a 2020 2020 2020 2020 2222 2252 6564  :.        """Red
+000368a0: 7563 6520 7468 6973 2064 6174 6173 6574  uce this dataset
+000368b0: 2062 7920 6170 706c 7969 6e67 2060 6675   by applying `fu
+000368c0: 6e63 6020 616c 6f6e 6720 736f 6d65 2064  nc` along some d
+000368d0: 696d 656e 7369 6f6e 2873 292e 0a0a 2020  imension(s)...  
+000368e0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000368f0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00036900: 2d2d 2d0a 2020 2020 2020 2020 6675 6e63  ---.        func
+00036910: 203a 2063 616c 6c61 626c 650a 2020 2020   : callable.    
+00036920: 2020 2020 2020 2020 4675 6e63 7469 6f6e          Function
+00036930: 2077 6869 6368 2063 616e 2062 6520 6361   which can be ca
+00036940: 6c6c 6564 2069 6e20 7468 6520 666f 726d  lled in the form
+00036950: 0a20 2020 2020 2020 2020 2020 2060 6628  .            `f(
+00036960: 782c 2061 7869 733d 6178 6973 2c20 2a2a  x, axis=axis, **
+00036970: 6b77 6172 6773 2960 2074 6f20 7265 7475  kwargs)` to retu
+00036980: 726e 2074 6865 2072 6573 756c 7420 6f66  rn the result of
+00036990: 2072 6564 7563 696e 6720 616e 0a20 2020   reducing an.   
+000369a0: 2020 2020 2020 2020 206e 702e 6e64 6172           np.ndar
+000369b0: 7261 7920 6f76 6572 2061 6e20 696e 7465  ray over an inte
+000369c0: 6765 7220 7661 6c75 6564 2061 7869 732e  ger valued axis.
+000369d0: 0a20 2020 2020 2020 2064 696d 203a 2073  .        dim : s
+000369e0: 7472 2c20 4974 6572 6162 6c65 206f 6620  tr, Iterable of 
+000369f0: 4861 7368 6162 6c65 206f 7220 4e6f 6e65  Hashable or None
+00036a00: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00036a10: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
+00036a20: 2873 2920 6f76 6572 2077 6869 6368 2074  (s) over which t
+00036a30: 6f20 6170 706c 7920 6066 756e 6360 2e20  o apply `func`. 
+00036a40: 4279 2064 6566 6175 6c74 2060 6675 6e63  By default `func
+00036a50: 6020 6973 0a20 2020 2020 2020 2020 2020  ` is.           
+00036a60: 2061 7070 6c69 6564 206f 7665 7220 616c   applied over al
+00036a70: 6c20 6469 6d65 6e73 696f 6e73 2e0a 2020  l dimensions..  
+00036a80: 2020 2020 2020 6b65 6570 5f61 7474 7273        keep_attrs
+00036a90: 203a 2062 6f6f 6c20 6f72 204e 6f6e 652c   : bool or None,
+00036aa0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+00036ab0: 2020 2020 2020 4966 2054 7275 652c 2074        If True, t
+00036ac0: 6865 2064 6174 6173 6574 2773 2061 7474  he dataset's att
+00036ad0: 7269 6275 7465 7320 2860 6174 7472 7360  ributes (`attrs`
+00036ae0: 2920 7769 6c6c 2062 6520 636f 7069 6564  ) will be copied
+00036af0: 2066 726f 6d0a 2020 2020 2020 2020 2020   from.          
+00036b00: 2020 7468 6520 6f72 6967 696e 616c 206f    the original o
+00036b10: 626a 6563 7420 746f 2074 6865 206e 6577  bject to the new
+00036b20: 206f 6e65 2e20 2049 6620 4661 6c73 6520   one.  If False 
+00036b30: 2864 6566 6175 6c74 292c 2074 6865 206e  (default), the n
+00036b40: 6577 0a20 2020 2020 2020 2020 2020 206f  ew.            o
+00036b50: 626a 6563 7420 7769 6c6c 2062 6520 7265  bject will be re
+00036b60: 7475 726e 6564 2077 6974 686f 7574 2061  turned without a
+00036b70: 7474 7269 6275 7465 732e 0a20 2020 2020  ttributes..     
+00036b80: 2020 206b 6565 7064 696d 7320 3a20 626f     keepdims : bo
+00036b90: 6f6c 2c20 6465 6661 756c 743a 2046 616c  ol, default: Fal
+00036ba0: 7365 0a20 2020 2020 2020 2020 2020 2049  se.            I
+00036bb0: 6620 5472 7565 2c20 7468 6520 6469 6d65  f True, the dime
+00036bc0: 6e73 696f 6e73 2077 6869 6368 2061 7265  nsions which are
+00036bd0: 2072 6564 7563 6564 2061 7265 206c 6566   reduced are lef
+00036be0: 7420 696e 2074 6865 2072 6573 756c 740a  t in the result.
+00036bf0: 2020 2020 2020 2020 2020 2020 6173 2064              as d
+00036c00: 696d 656e 7369 6f6e 7320 6f66 2073 697a  imensions of siz
+00036c10: 6520 6f6e 652e 2043 6f6f 7264 696e 6174  e one. Coordinat
+00036c20: 6573 2074 6861 7420 7573 6520 7468 6573  es that use thes
+00036c30: 6520 6469 6d65 6e73 696f 6e73 0a20 2020  e dimensions.   
+00036c40: 2020 2020 2020 2020 2061 7265 2072 656d           are rem
+00036c50: 6f76 6564 2e0a 2020 2020 2020 2020 6e75  oved..        nu
+00036c60: 6d65 7269 635f 6f6e 6c79 203a 2062 6f6f  meric_only : boo
+00036c70: 6c2c 2064 6566 6175 6c74 3a20 4661 6c73  l, default: Fals
+00036c80: 650a 2020 2020 2020 2020 2020 2020 4966  e.            If
+00036c90: 2054 7275 652c 206f 6e6c 7920 6170 706c   True, only appl
+00036ca0: 7920 6060 6675 6e63 6060 2074 6f20 7661  y ``func`` to va
+00036cb0: 7269 6162 6c65 7320 7769 7468 2061 206e  riables with a n
+00036cc0: 756d 6572 6963 2064 7479 7065 2e0a 2020  umeric dtype..  
+00036cd0: 2020 2020 2020 2a2a 6b77 6172 6773 203a        **kwargs :
+00036ce0: 2041 6e79 0a20 2020 2020 2020 2020 2020   Any.           
+00036cf0: 2041 6464 6974 696f 6e61 6c20 6b65 7977   Additional keyw
+00036d00: 6f72 6420 6172 6775 6d65 6e74 7320 7061  ord arguments pa
+00036d10: 7373 6564 206f 6e20 746f 2060 6066 756e  ssed on to ``fun
+00036d20: 6360 602e 0a0a 2020 2020 2020 2020 5265  c``...        Re
+00036d30: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+00036d40: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7265  -----.        re
+00036d50: 6475 6365 6420 3a20 4461 7461 7365 740a  duced : Dataset.
+00036d60: 2020 2020 2020 2020 2020 2020 4461 7461              Data
+00036d70: 7365 7420 7769 7468 2074 6869 7320 6f62  set with this ob
+00036d80: 6a65 6374 2773 2044 6174 6141 7272 6179  ject's DataArray
+00036d90: 7320 7265 706c 6163 6564 2077 6974 6820  s replaced with 
+00036da0: 6e65 7720 4461 7461 4172 7261 7973 0a20  new DataArrays. 
+00036db0: 2020 2020 2020 2020 2020 206f 6620 7375             of su
+00036dc0: 6d6d 6172 697a 6564 2064 6174 6120 616e  mmarized data an
+00036dd0: 6420 7468 6520 696e 6469 6361 7465 6420  d the indicated 
+00036de0: 6469 6d65 6e73 696f 6e28 7329 2072 656d  dimension(s) rem
+00036df0: 6f76 6564 2e0a 2020 2020 2020 2020 2222  oved..        ""
+00036e00: 220a 2020 2020 2020 2020 6966 206b 7761  ".        if kwa
+00036e10: 7267 732e 6765 7428 2261 7869 7322 2c20  rgs.get("axis", 
+00036e20: 4e6f 6e65 2920 6973 206e 6f74 204e 6f6e  None) is not Non
+00036e30: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00036e40: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+00036e50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00036e60: 2022 7061 7373 696e 6720 2761 7869 7327   "passing 'axis'
+00036e70: 2074 6f20 4461 7461 7365 7420 7265 6475   to Dataset redu
+00036e80: 6365 206d 6574 686f 6473 2069 7320 616d  ce methods is am
+00036e90: 6269 6775 6f75 732e 220a 2020 2020 2020  biguous.".      
+00036ea0: 2020 2020 2020 2020 2020 2220 506c 6561            " Plea
+00036eb0: 7365 2075 7365 2027 6469 6d27 2069 6e73  se use 'dim' ins
+00036ec0: 7465 6164 2e22 0a20 2020 2020 2020 2020  tead.".         
+00036ed0: 2020 2029 0a0a 2020 2020 2020 2020 6966     )..        if
+00036ee0: 2064 696d 2069 7320 4e6f 6e65 206f 7220   dim is None or 
+00036ef0: 6469 6d20 6973 202e 2e2e 3a0a 2020 2020  dim is ...:.    
+00036f00: 2020 2020 2020 2020 6469 6d73 203d 2073          dims = s
+00036f10: 6574 2873 656c 662e 6469 6d73 290a 2020  et(self.dims).  
+00036f20: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00036f30: 7461 6e63 6528 6469 6d2c 2073 7472 2920  tance(dim, str) 
+00036f40: 6f72 206e 6f74 2069 7369 6e73 7461 6e63  or not isinstanc
+00036f50: 6528 6469 6d2c 2049 7465 7261 626c 6529  e(dim, Iterable)
+00036f60: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+00036f70: 6d73 203d 207b 6469 6d7d 0a20 2020 2020  ms = {dim}.     
+00036f80: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00036f90: 2020 2020 2064 696d 7320 3d20 7365 7428       dims = set(
+00036fa0: 6469 6d29 0a0a 2020 2020 2020 2020 6d69  dim)..        mi
+00036fb0: 7373 696e 675f 6469 6d65 6e73 696f 6e73  ssing_dimensions
+00036fc0: 203d 205b 6420 666f 7220 6420 696e 2064   = [d for d in d
+00036fd0: 696d 7320 6966 2064 206e 6f74 2069 6e20  ims if d not in 
+00036fe0: 7365 6c66 2e64 696d 735d 0a20 2020 2020  self.dims].     
+00036ff0: 2020 2069 6620 6d69 7373 696e 675f 6469     if missing_di
+00037000: 6d65 6e73 696f 6e73 3a0a 2020 2020 2020  mensions:.      
+00037010: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
+00037020: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00037030: 2020 2020 2020 2020 6622 4461 7461 7365          f"Datase
+00037040: 7420 646f 6573 206e 6f74 2063 6f6e 7461  t does not conta
+00037050: 696e 2074 6865 2064 696d 656e 7369 6f6e  in the dimension
+00037060: 733a 207b 6d69 7373 696e 675f 6469 6d65  s: {missing_dime
+00037070: 6e73 696f 6e73 7d22 0a20 2020 2020 2020  nsions}".       
+00037080: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00037090: 6966 206b 6565 705f 6174 7472 7320 6973  if keep_attrs is
+000370a0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000370b0: 2020 206b 6565 705f 6174 7472 7320 3d20     keep_attrs = 
+000370c0: 5f67 6574 5f6b 6565 705f 6174 7472 7328  _get_keep_attrs(
+000370d0: 6465 6661 756c 743d 4661 6c73 6529 0a0a  default=False)..
+000370e0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+000370f0: 733a 2064 6963 745b 4861 7368 6162 6c65  s: dict[Hashable
+00037100: 2c20 5661 7269 6162 6c65 5d20 3d20 7b7d  , Variable] = {}
+00037110: 0a20 2020 2020 2020 2066 6f72 206e 616d  .        for nam
+00037120: 652c 2076 6172 2069 6e20 7365 6c66 2e5f  e, var in self._
+00037130: 7661 7269 6162 6c65 732e 6974 656d 7328  variables.items(
+00037140: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00037150: 6564 7563 655f 6469 6d73 203d 205b 6420  educe_dims = [d 
+00037160: 666f 7220 6420 696e 2076 6172 2e64 696d  for d in var.dim
+00037170: 7320 6966 2064 2069 6e20 6469 6d73 5d0a  s if d in dims].
+00037180: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00037190: 616d 6520 696e 2073 656c 662e 636f 6f72  ame in self.coor
+000371a0: 6473 3a0a 2020 2020 2020 2020 2020 2020  ds:.            
+000371b0: 2020 2020 6966 206e 6f74 2072 6564 7563      if not reduc
+000371c0: 655f 6469 6d73 3a0a 2020 2020 2020 2020  e_dims:.        
+000371d0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+000371e0: 6162 6c65 735b 6e61 6d65 5d20 3d20 7661  ables[name] = va
+000371f0: 720a 2020 2020 2020 2020 2020 2020 656c  r.            el
+00037200: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00037210: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+00037220: 2020 2020 2020 2020 2020 2020 2023 2053               # S
+00037230: 6f6d 6520 7265 6475 6374 696f 6e20 6675  ome reduction fu
+00037240: 6e63 7469 6f6e 7320 2865 2e67 2e20 7374  nctions (e.g. st
+00037250: 642c 2076 6172 2920 6e65 6564 2074 6f20  d, var) need to 
+00037260: 7275 6e20 6f6e 2076 6172 6961 626c 6573  run on variables
+00037270: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00037280: 2020 2020 2023 2074 6861 7420 646f 6e27       # that don'
+00037290: 7420 6861 7665 2074 6865 2072 6564 7563  t have the reduc
+000372a0: 6520 6469 6d73 3a20 5052 3533 3933 0a20  e dims: PR5393. 
+000372b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000372c0: 2020 206e 6f74 2072 6564 7563 655f 6469     not reduce_di
+000372d0: 6d73 0a20 2020 2020 2020 2020 2020 2020  ms.             
+000372e0: 2020 2020 2020 206f 7220 6e6f 7420 6e75         or not nu
+000372f0: 6d65 7269 635f 6f6e 6c79 0a20 2020 2020  meric_only.     
+00037300: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00037310: 7220 6e70 2e69 7373 7562 6474 7970 6528  r np.issubdtype(
+00037320: 7661 722e 6474 7970 652c 206e 702e 6e75  var.dtype, np.nu
+00037330: 6d62 6572 290a 2020 2020 2020 2020 2020  mber).          
+00037340: 2020 2020 2020 2020 2020 6f72 2028 7661            or (va
+00037350: 722e 6474 7970 6520 3d3d 206e 702e 626f  r.dtype == np.bo
+00037360: 6f6c 5f29 0a20 2020 2020 2020 2020 2020  ol_).           
+00037370: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
+00037380: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
+00037390: 6566 6572 2074 6f20 6167 6772 6567 6174  efer to aggregat
+000373a0: 6520 6f76 6572 2061 7869 733d 4e6f 6e65  e over axis=None
+000373b0: 2072 6174 6865 7220 7468 616e 0a20 2020   rather than.   
+000373c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000373d0: 2023 2061 7869 733d 2830 2c20 3129 2069   # axis=(0, 1) i
+000373e0: 6620 7468 6579 2077 696c 6c20 6265 2065  f they will be e
+000373f0: 7175 6976 616c 656e 742c 2062 6563 6175  quivalent, becau
+00037400: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
+00037410: 2020 2020 2020 2023 2074 6865 2066 6f72         # the for
+00037420: 6d65 7220 6973 206f 6674 656e 206d 6f72  mer is often mor
+00037430: 6520 6566 6669 6369 656e 740a 2020 2020  e efficient.    
+00037440: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037450: 2320 6b65 6570 2073 696e 676c 652d 656c  # keep single-el
+00037460: 656d 656e 7420 6469 6d73 2061 7320 6c69  ement dims as li
+00037470: 7374 2c20 746f 2073 7570 706f 7274 2048  st, to support H
+00037480: 6173 6861 626c 6573 0a20 2020 2020 2020  ashables.       
+00037490: 2020 2020 2020 2020 2020 2020 2072 6564               red
+000374a0: 7563 655f 6d61 7962 655f 7369 6e67 6c65  uce_maybe_single
+000374b0: 203d 2028 0a20 2020 2020 2020 2020 2020   = (.           
+000374c0: 2020 2020 2020 2020 2020 2020 204e 6f6e               Non
+000374d0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+000374e0: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+000374f0: 2872 6564 7563 655f 6469 6d73 2920 3d3d  (reduce_dims) ==
+00037500: 2076 6172 2e6e 6469 6d20 616e 6420 7661   var.ndim and va
+00037510: 722e 6e64 696d 2021 3d20 310a 2020 2020  r.ndim != 1.    
+00037520: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037530: 2020 2020 656c 7365 2072 6564 7563 655f      else reduce_
+00037540: 6469 6d73 0a20 2020 2020 2020 2020 2020  dims.           
+00037550: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00037560: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00037570: 6172 6961 626c 6573 5b6e 616d 655d 203d  ariables[name] =
+00037580: 2076 6172 2e72 6564 7563 6528 0a20 2020   var.reduce(.   
+00037590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000375a0: 2020 2020 2066 756e 632c 0a20 2020 2020       func,.     
+000375b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000375c0: 2020 2064 696d 3d72 6564 7563 655f 6d61     dim=reduce_ma
+000375d0: 7962 655f 7369 6e67 6c65 2c0a 2020 2020  ybe_single,.    
+000375e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000375f0: 2020 2020 6b65 6570 5f61 7474 7273 3d6b      keep_attrs=k
+00037600: 6565 705f 6174 7472 732c 0a20 2020 2020  eep_attrs,.     
+00037610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00037620: 2020 206b 6565 7064 696d 733d 6b65 6570     keepdims=keep
+00037630: 6469 6d73 2c0a 2020 2020 2020 2020 2020  dims,.          
+00037640: 2020 2020 2020 2020 2020 2020 2020 2a2a                **
+00037650: 6b77 6172 6773 2c0a 2020 2020 2020 2020  kwargs,.        
+00037660: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00037670: 2020 2020 2020 2063 6f6f 7264 5f6e 616d         coord_nam
+00037680: 6573 203d 207b 6b20 666f 7220 6b20 696e  es = {k for k in
+00037690: 2073 656c 662e 636f 6f72 6473 2069 6620   self.coords if 
+000376a0: 6b20 696e 2076 6172 6961 626c 6573 7d0a  k in variables}.
+000376b0: 2020 2020 2020 2020 696e 6465 7865 7320          indexes 
+000376c0: 3d20 7b6b 3a20 7620 666f 7220 6b2c 2076  = {k: v for k, v
+000376d0: 2069 6e20 7365 6c66 2e5f 696e 6465 7865   in self._indexe
+000376e0: 732e 6974 656d 7328 2920 6966 206b 2069  s.items() if k i
+000376f0: 6e20 7661 7269 6162 6c65 737d 0a20 2020  n variables}.   
+00037700: 2020 2020 2061 7474 7273 203d 2073 656c       attrs = sel
+00037710: 662e 6174 7472 7320 6966 206b 6565 705f  f.attrs if keep_
+00037720: 6174 7472 7320 656c 7365 204e 6f6e 650a  attrs else None.
+00037730: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00037740: 656c 662e 5f72 6570 6c61 6365 5f77 6974  elf._replace_wit
+00037750: 685f 6e65 775f 6469 6d73 280a 2020 2020  h_new_dims(.    
+00037760: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+00037770: 732c 2063 6f6f 7264 5f6e 616d 6573 3d63  s, coord_names=c
+00037780: 6f6f 7264 5f6e 616d 6573 2c20 6174 7472  oord_names, attr
+00037790: 733d 6174 7472 732c 2069 6e64 6578 6573  s=attrs, indexes
+000377a0: 3d69 6e64 6578 6573 0a20 2020 2020 2020  =indexes.       
+000377b0: 2029 0a0a 2020 2020 6465 6620 6d61 7028   )..    def map(
+000377c0: 0a20 2020 2020 2020 2073 656c 663a 2054  .        self: T
+000377d0: 5f44 6174 6173 6574 2c0a 2020 2020 2020  _Dataset,.      
+000377e0: 2020 6675 6e63 3a20 4361 6c6c 6162 6c65    func: Callable
+000377f0: 2c0a 2020 2020 2020 2020 6b65 6570 5f61  ,.        keep_a
+00037800: 7474 7273 3a20 626f 6f6c 207c 204e 6f6e  ttrs: bool | Non
+00037810: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
+00037820: 2020 6172 6773 3a20 4974 6572 6162 6c65    args: Iterable
+00037830: 5b41 6e79 5d20 3d20 2829 2c0a 2020 2020  [Any] = (),.    
+00037840: 2020 2020 2a2a 6b77 6172 6773 3a20 416e      **kwargs: An
+00037850: 792c 0a20 2020 2029 202d 3e20 545f 4461  y,.    ) -> T_Da
+00037860: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
+00037870: 2222 4170 706c 7920 6120 6675 6e63 7469  ""Apply a functi
+00037880: 6f6e 2074 6f20 6561 6368 2064 6174 6120  on to each data 
+00037890: 7661 7269 6162 6c65 2069 6e20 7468 6973  variable in this
+000378a0: 2064 6174 6173 6574 0a0a 2020 2020 2020   dataset..      
+000378b0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+000378c0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+000378d0: 2020 2020 2020 2020 6675 6e63 203a 2063          func : c
+000378e0: 616c 6c61 626c 650a 2020 2020 2020 2020  allable.        
+000378f0: 2020 2020 4675 6e63 7469 6f6e 2077 6869      Function whi
+00037900: 6368 2063 616e 2062 6520 6361 6c6c 6564  ch can be called
+00037910: 2069 6e20 7468 6520 666f 726d 2060 6675   in the form `fu
+00037920: 6e63 2878 2c20 2a61 7267 732c 202a 2a6b  nc(x, *args, **k
+00037930: 7761 7267 7329 600a 2020 2020 2020 2020  wargs)`.        
+00037940: 2020 2020 746f 2074 7261 6e73 666f 726d      to transform
+00037950: 2065 6163 6820 4461 7461 4172 7261 7920   each DataArray 
+00037960: 6078 6020 696e 2074 6869 7320 6461 7461  `x` in this data
+00037970: 7365 7420 696e 746f 2061 6e6f 7468 6572  set into another
+00037980: 0a20 2020 2020 2020 2020 2020 2044 6174  .            Dat
+00037990: 6141 7272 6179 2e0a 2020 2020 2020 2020  aArray..        
+000379a0: 6b65 6570 5f61 7474 7273 203a 2062 6f6f  keep_attrs : boo
+000379b0: 6c20 6f72 204e 6f6e 652c 206f 7074 696f  l or None, optio
+000379c0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+000379d0: 4966 2054 7275 652c 2062 6f74 6820 7468  If True, both th
+000379e0: 6520 6461 7461 7365 7427 7320 616e 6420  e dataset's and 
+000379f0: 7661 7269 6162 6c65 7327 2061 7474 7269  variables' attri
+00037a00: 6275 7465 7320 2860 6174 7472 7360 2920  butes (`attrs`) 
+00037a10: 7769 6c6c 2062 650a 2020 2020 2020 2020  will be.        
+00037a20: 2020 2020 636f 7069 6564 2066 726f 6d20      copied from 
+00037a30: 7468 6520 6f72 6967 696e 616c 206f 626a  the original obj
+00037a40: 6563 7473 2074 6f20 7468 6520 6e65 7720  ects to the new 
+00037a50: 6f6e 6573 2e20 4966 2046 616c 7365 2c20  ones. If False, 
+00037a60: 7468 6520 6e65 7720 6461 7461 7365 740a  the new dataset.
+00037a70: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+00037a80: 7661 7269 6162 6c65 7320 7769 6c6c 2062  variables will b
+00037a90: 6520 7265 7475 726e 6564 2077 6974 686f  e returned witho
+00037aa0: 7574 2063 6f70 7969 6e67 2074 6865 2061  ut copying the a
+00037ab0: 7474 7269 6275 7465 732e 0a20 2020 2020  ttributes..     
+00037ac0: 2020 2061 7267 7320 3a20 6974 6572 6162     args : iterab
+00037ad0: 6c65 2c20 6f70 7469 6f6e 616c 0a20 2020  le, optional.   
+00037ae0: 2020 2020 2020 2020 2050 6f73 6974 696f           Positio
+00037af0: 6e61 6c20 6172 6775 6d65 6e74 7320 7061  nal arguments pa
+00037b00: 7373 6564 206f 6e20 746f 2060 6675 6e63  ssed on to `func
+00037b10: 602e 0a20 2020 2020 2020 202a 2a6b 7761  `..        **kwa
+00037b20: 7267 7320 3a20 416e 790a 2020 2020 2020  rgs : Any.      
+00037b30: 2020 2020 2020 4b65 7977 6f72 6420 6172        Keyword ar
+00037b40: 6775 6d65 6e74 7320 7061 7373 6564 206f  guments passed o
+00037b50: 6e20 746f 2060 6675 6e63 602e 0a0a 2020  n to `func`...  
+00037b60: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00037b70: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00037b80: 2020 2020 2020 6170 706c 6965 6420 3a20        applied : 
+00037b90: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
+00037ba0: 2020 2020 5265 7375 6c74 696e 6720 6461      Resulting da
+00037bb0: 7461 7365 7420 6672 6f6d 2061 7070 6c79  taset from apply
+00037bc0: 696e 6720 6060 6675 6e63 6060 2074 6f20  ing ``func`` to 
+00037bd0: 6561 6368 2064 6174 6120 7661 7269 6162  each data variab
+00037be0: 6c65 2e0a 0a20 2020 2020 2020 2045 7861  le...        Exa
+00037bf0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+00037c00: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00037c10: 3e3e 2064 6120 3d20 7872 2e44 6174 6141  >> da = xr.DataA
+00037c20: 7272 6179 286e 702e 7261 6e64 6f6d 2e72  rray(np.random.r
+00037c30: 616e 646e 2832 2c20 3329 290a 2020 2020  andn(2, 3)).    
+00037c40: 2020 2020 3e3e 3e20 6473 203d 2078 722e      >>> ds = xr.
+00037c50: 4461 7461 7365 7428 7b22 666f 6f22 3a20  Dataset({"foo": 
+00037c60: 6461 2c20 2262 6172 223a 2028 2278 222c  da, "bar": ("x",
+00037c70: 205b 2d31 2c20 325d 297d 290a 2020 2020   [-1, 2])}).    
+00037c80: 2020 2020 3e3e 3e20 6473 0a20 2020 2020      >>> ds.     
+00037c90: 2020 203c 7861 7272 6179 2e44 6174 6173     <xarray.Datas
+00037ca0: 6574 3e0a 2020 2020 2020 2020 4469 6d65  et>.        Dime
+00037cb0: 6e73 696f 6e73 3a20 2028 6469 6d5f 303a  nsions:  (dim_0:
+00037cc0: 2032 2c20 6469 6d5f 313a 2033 2c20 783a   2, dim_1: 3, x:
+00037cd0: 2032 290a 2020 2020 2020 2020 4469 6d65   2).        Dime
+00037ce0: 6e73 696f 6e73 2077 6974 686f 7574 2063  nsions without c
+00037cf0: 6f6f 7264 696e 6174 6573 3a20 6469 6d5f  oordinates: dim_
+00037d00: 302c 2064 696d 5f31 2c20 780a 2020 2020  0, dim_1, x.    
+00037d10: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
+00037d20: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00037d30: 666f 6f20 2020 2020 2028 6469 6d5f 302c  foo      (dim_0,
+00037d40: 2064 696d 5f31 2920 666c 6f61 7436 3420   dim_1) float64 
+00037d50: 312e 3736 3420 302e 3430 3032 2030 2e39  1.764 0.4002 0.9
+00037d60: 3738 3720 322e 3234 3120 312e 3836 3820  787 2.241 1.868 
+00037d70: 2d30 2e39 3737 330a 2020 2020 2020 2020  -0.9773.        
+00037d80: 2020 2020 6261 7220 2020 2020 2028 7829      bar      (x)
+00037d90: 2069 6e74 3634 202d 3120 320a 2020 2020   int64 -1 2.    
+00037da0: 2020 2020 3e3e 3e20 6473 2e6d 6170 286e      >>> ds.map(n
+00037db0: 702e 6661 6273 290a 2020 2020 2020 2020  p.fabs).        
+00037dc0: 3c78 6172 7261 792e 4461 7461 7365 743e  <xarray.Dataset>
+00037dd0: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
+00037de0: 6f6e 733a 2020 2864 696d 5f30 3a20 322c  ons:  (dim_0: 2,
+00037df0: 2064 696d 5f31 3a20 332c 2078 3a20 3229   dim_1: 3, x: 2)
+00037e00: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
+00037e10: 6f6e 7320 7769 7468 6f75 7420 636f 6f72  ons without coor
+00037e20: 6469 6e61 7465 733a 2064 696d 5f30 2c20  dinates: dim_0, 
+00037e30: 6469 6d5f 312c 2078 0a20 2020 2020 2020  dim_1, x.       
+00037e40: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
+00037e50: 0a20 2020 2020 2020 2020 2020 2066 6f6f  .            foo
+00037e60: 2020 2020 2020 2864 696d 5f30 2c20 6469        (dim_0, di
+00037e70: 6d5f 3129 2066 6c6f 6174 3634 2031 2e37  m_1) float64 1.7
+00037e80: 3634 2030 2e34 3030 3220 302e 3937 3837  64 0.4002 0.9787
+00037e90: 2032 2e32 3431 2031 2e38 3638 2030 2e39   2.241 1.868 0.9
+00037ea0: 3737 330a 2020 2020 2020 2020 2020 2020  773.            
+00037eb0: 6261 7220 2020 2020 2028 7829 2066 6c6f  bar      (x) flo
+00037ec0: 6174 3634 2031 2e30 2032 2e30 0a20 2020  at64 1.0 2.0.   
+00037ed0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00037ee0: 2069 6620 6b65 6570 5f61 7474 7273 2069   if keep_attrs i
+00037ef0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00037f00: 2020 2020 6b65 6570 5f61 7474 7273 203d      keep_attrs =
+00037f10: 205f 6765 745f 6b65 6570 5f61 7474 7273   _get_keep_attrs
+00037f20: 2864 6566 6175 6c74 3d46 616c 7365 290a  (default=False).
+00037f30: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+00037f40: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00037f50: 2020 6b3a 206d 6179 6265 5f77 7261 705f    k: maybe_wrap_
+00037f60: 6172 7261 7928 762c 2066 756e 6328 762c  array(v, func(v,
+00037f70: 202a 6172 6773 2c20 2a2a 6b77 6172 6773   *args, **kwargs
+00037f80: 2929 0a20 2020 2020 2020 2020 2020 2066  )).            f
+00037f90: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
+00037fa0: 6461 7461 5f76 6172 732e 6974 656d 7328  data_vars.items(
+00037fb0: 290a 2020 2020 2020 2020 7d0a 2020 2020  ).        }.    
+00037fc0: 2020 2020 6966 206b 6565 705f 6174 7472      if keep_attr
+00037fd0: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
+00037fe0: 6f72 206b 2c20 7620 696e 2076 6172 6961  or k, v in varia
+00037ff0: 626c 6573 2e69 7465 6d73 2829 3a0a 2020  bles.items():.  
+00038000: 2020 2020 2020 2020 2020 2020 2020 762e                v.
+00038010: 5f63 6f70 795f 6174 7472 735f 6672 6f6d  _copy_attrs_from
+00038020: 2873 656c 662e 6461 7461 5f76 6172 735b  (self.data_vars[
+00038030: 6b5d 290a 2020 2020 2020 2020 6174 7472  k]).        attr
+00038040: 7320 3d20 7365 6c66 2e61 7474 7273 2069  s = self.attrs i
+00038050: 6620 6b65 6570 5f61 7474 7273 2065 6c73  f keep_attrs els
+00038060: 6520 4e6f 6e65 0a20 2020 2020 2020 2072  e None.        r
+00038070: 6574 7572 6e20 7479 7065 2873 656c 6629  eturn type(self)
+00038080: 2876 6172 6961 626c 6573 2c20 6174 7472  (variables, attr
+00038090: 733d 6174 7472 7329 0a0a 2020 2020 6465  s=attrs)..    de
+000380a0: 6620 6170 706c 7928 0a20 2020 2020 2020  f apply(.       
+000380b0: 2073 656c 663a 2054 5f44 6174 6173 6574   self: T_Dataset
+000380c0: 2c0a 2020 2020 2020 2020 6675 6e63 3a20  ,.        func: 
+000380d0: 4361 6c6c 6162 6c65 2c0a 2020 2020 2020  Callable,.      
+000380e0: 2020 6b65 6570 5f61 7474 7273 3a20 626f    keep_attrs: bo
+000380f0: 6f6c 207c 204e 6f6e 6520 3d20 4e6f 6e65  ol | None = None
+00038100: 2c0a 2020 2020 2020 2020 6172 6773 3a20  ,.        args: 
+00038110: 4974 6572 6162 6c65 5b41 6e79 5d20 3d20  Iterable[Any] = 
+00038120: 2829 2c0a 2020 2020 2020 2020 2a2a 6b77  (),.        **kw
+00038130: 6172 6773 3a20 416e 792c 0a20 2020 2029  args: Any,.    )
+00038140: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
+00038150: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00038160: 2020 2042 6163 6b77 6172 6420 636f 6d70     Backward comp
+00038170: 6174 6962 6c65 2069 6d70 6c65 6d65 6e74  atible implement
+00038180: 6174 696f 6e20 6f66 2060 606d 6170 6060  ation of ``map``
+00038190: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+000381a0: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+000381b0: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
+000381c0: 7365 742e 6d61 700a 2020 2020 2020 2020  set.map.        
+000381d0: 2222 220a 2020 2020 2020 2020 7761 726e  """.        warn
+000381e0: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+000381f0: 2020 2020 2020 2022 4461 7461 7365 742e         "Dataset.
+00038200: 6170 706c 7920 6d61 7920 6265 2064 6570  apply may be dep
+00038210: 7265 6361 7465 6420 696e 2074 6865 2066  recated in the f
+00038220: 7574 7572 652e 2055 7369 6e67 2044 6174  uture. Using Dat
+00038230: 6173 6574 2e6d 6170 2069 7320 656e 636f  aset.map is enco
+00038240: 7572 6167 6564 222c 0a20 2020 2020 2020  uraged",.       
+00038250: 2020 2020 2050 656e 6469 6e67 4465 7072       PendingDepr
+00038260: 6563 6174 696f 6e57 6172 6e69 6e67 2c0a  ecationWarning,.
+00038270: 2020 2020 2020 2020 2020 2020 7374 6163              stac
+00038280: 6b6c 6576 656c 3d32 2c0a 2020 2020 2020  klevel=2,.      
+00038290: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
+000382a0: 726e 2073 656c 662e 6d61 7028 6675 6e63  rn self.map(func
+000382b0: 2c20 6b65 6570 5f61 7474 7273 2c20 6172  , keep_attrs, ar
+000382c0: 6773 2c20 2a2a 6b77 6172 6773 290a 0a20  gs, **kwargs).. 
+000382d0: 2020 2064 6566 2061 7373 6967 6e28 0a20     def assign(. 
+000382e0: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
+000382f0: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
+00038300: 7661 7269 6162 6c65 733a 204d 6170 7069  variables: Mappi
+00038310: 6e67 5b41 6e79 2c20 416e 795d 207c 204e  ng[Any, Any] | N
+00038320: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+00038330: 2020 2020 2a2a 7661 7269 6162 6c65 735f      **variables_
+00038340: 6b77 6172 6773 3a20 416e 792c 0a20 2020  kwargs: Any,.   
+00038350: 2029 202d 3e20 545f 4461 7461 7365 743a   ) -> T_Dataset:
+00038360: 0a20 2020 2020 2020 2022 2222 4173 7369  .        """Assi
+00038370: 676e 206e 6577 2064 6174 6120 7661 7269  gn new data vari
+00038380: 6162 6c65 7320 746f 2061 2044 6174 6173  ables to a Datas
+00038390: 6574 2c20 7265 7475 726e 696e 6720 6120  et, returning a 
+000383a0: 6e65 7720 6f62 6a65 6374 0a20 2020 2020  new object.     
+000383b0: 2020 2077 6974 6820 616c 6c20 7468 6520     with all the 
+000383c0: 6f72 6967 696e 616c 2076 6172 6961 626c  original variabl
+000383d0: 6573 2069 6e20 6164 6469 7469 6f6e 2074  es in addition t
+000383e0: 6f20 7468 6520 6e65 7720 6f6e 6573 2e0a  o the new ones..
+000383f0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00038400: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+00038410: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2076  ------.        v
+00038420: 6172 6961 626c 6573 203a 206d 6170 7069  ariables : mappi
+00038430: 6e67 206f 6620 6861 7368 6162 6c65 2074  ng of hashable t
+00038440: 6f20 416e 790a 2020 2020 2020 2020 2020  o Any.          
+00038450: 2020 4d61 7070 696e 6720 6672 6f6d 2076    Mapping from v
+00038460: 6172 6961 626c 6573 206e 616d 6573 2074  ariables names t
+00038470: 6f20 7468 6520 6e65 7720 7661 6c75 6573  o the new values
+00038480: 2e20 4966 2074 6865 206e 6577 2076 616c  . If the new val
+00038490: 7565 730a 2020 2020 2020 2020 2020 2020  ues.            
+000384a0: 6172 6520 6361 6c6c 6162 6c65 2c20 7468  are callable, th
+000384b0: 6579 2061 7265 2063 6f6d 7075 7465 6420  ey are computed 
+000384c0: 6f6e 2074 6865 2044 6174 6173 6574 2061  on the Dataset a
+000384d0: 6e64 2061 7373 6967 6e65 6420 746f 206e  nd assigned to n
+000384e0: 6577 0a20 2020 2020 2020 2020 2020 2064  ew.            d
+000384f0: 6174 6120 7661 7269 6162 6c65 732e 2049  ata variables. I
+00038500: 6620 7468 6520 7661 6c75 6573 2061 7265  f the values are
+00038510: 206e 6f74 2063 616c 6c61 626c 652c 2028   not callable, (
+00038520: 652e 672e 2061 2044 6174 6141 7272 6179  e.g. a DataArray
+00038530: 2c0a 2020 2020 2020 2020 2020 2020 7363  ,.            sc
+00038540: 616c 6172 2c20 6f72 2061 7272 6179 292c  alar, or array),
+00038550: 2074 6865 7920 6172 6520 7369 6d70 6c79   they are simply
+00038560: 2061 7373 6967 6e65 642e 0a20 2020 2020   assigned..     
+00038570: 2020 202a 2a76 6172 6961 626c 6573 5f6b     **variables_k
+00038580: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
+00038590: 2020 5468 6520 6b65 7977 6f72 6420 6172    The keyword ar
+000385a0: 6775 6d65 6e74 7320 666f 726d 206f 6620  guments form of 
+000385b0: 6060 7661 7269 6162 6c65 7360 602e 0a20  ``variables``.. 
+000385c0: 2020 2020 2020 2020 2020 204f 6e65 206f             One o
+000385d0: 6620 7661 7269 6162 6c65 7320 6f72 2076  f variables or v
+000385e0: 6172 6961 626c 6573 5f6b 7761 7267 7320  ariables_kwargs 
+000385f0: 6d75 7374 2062 6520 7072 6f76 6964 6564  must be provided
+00038600: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00038610: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+00038620: 2d2d 0a20 2020 2020 2020 2064 7320 3a20  --.        ds : 
+00038630: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
+00038640: 2020 2020 4120 6e65 7720 4461 7461 7365      A new Datase
+00038650: 7420 7769 7468 2074 6865 206e 6577 2076  t with the new v
+00038660: 6172 6961 626c 6573 2069 6e20 6164 6469  ariables in addi
+00038670: 7469 6f6e 2074 6f20 616c 6c20 7468 650a  tion to all the.
+00038680: 2020 2020 2020 2020 2020 2020 6578 6973              exis
+00038690: 7469 6e67 2076 6172 6961 626c 6573 2e0a  ting variables..
+000386a0: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
+000386b0: 2020 2020 2020 202d 2d2d 2d2d 0a20 2020         -----.   
+000386c0: 2020 2020 2053 696e 6365 2060 606b 7761       Since ``kwa
+000386d0: 7267 7360 6020 6973 2061 2064 6963 7469  rgs`` is a dicti
+000386e0: 6f6e 6172 792c 2074 6865 206f 7264 6572  onary, the order
+000386f0: 206f 6620 796f 7572 2061 7267 756d 656e   of your argumen
+00038700: 7473 206d 6179 206e 6f74 0a20 2020 2020  ts may not.     
+00038710: 2020 2062 6520 7072 6573 6572 7665 642c     be preserved,
+00038720: 2061 6e64 2073 6f20 7468 6520 6f72 6465   and so the orde
+00038730: 7220 6f66 2074 6865 206e 6577 2076 6172  r of the new var
+00038740: 6961 626c 6573 2069 7320 6e6f 7420 7765  iables is not we
+00038750: 6c6c 0a20 2020 2020 2020 2064 6566 696e  ll.        defin
+00038760: 6564 2e20 4173 7369 676e 696e 6720 6d75  ed. Assigning mu
+00038770: 6c74 6970 6c65 2076 6172 6961 626c 6573  ltiple variables
+00038780: 2077 6974 6869 6e20 7468 6520 7361 6d65   within the same
+00038790: 2060 6061 7373 6967 6e60 6020 6973 0a20   ``assign`` is. 
+000387a0: 2020 2020 2020 2070 6f73 7369 626c 652c         possible,
+000387b0: 2062 7574 2079 6f75 2063 616e 6e6f 7420   but you cannot 
+000387c0: 7265 6665 7265 6e63 6520 6f74 6865 7220  reference other 
+000387d0: 7661 7269 6162 6c65 7320 6372 6561 7465  variables create
+000387e0: 6420 7769 7468 696e 2074 6865 0a20 2020  d within the.   
+000387f0: 2020 2020 2073 616d 6520 6060 6173 7369       same ``assi
+00038800: 676e 6060 2063 616c 6c2e 0a0a 2020 2020  gn`` call...    
+00038810: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00038820: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00038830: 2020 2020 2020 7061 6e64 6173 2e44 6174        pandas.Dat
+00038840: 6146 7261 6d65 2e61 7373 6967 6e0a 0a20  aFrame.assign.. 
+00038850: 2020 2020 2020 2045 7861 6d70 6c65 730a         Examples.
+00038860: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00038870: 0a20 2020 2020 2020 203e 3e3e 2078 203d  .        >>> x =
+00038880: 2078 722e 4461 7461 7365 7428 0a20 2020   xr.Dataset(.   
+00038890: 2020 2020 202e 2e2e 2020 2020 207b 0a20       ...     {. 
+000388a0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+000388b0: 2020 2022 7465 6d70 6572 6174 7572 655f     "temperature_
+000388c0: 6322 3a20 280a 2020 2020 2020 2020 2e2e  c": (.        ..
+000388d0: 2e20 2020 2020 2020 2020 2020 2020 2822  .             ("
+000388e0: 6c61 7422 2c20 226c 6f6e 2229 2c0a 2020  lat", "lon"),.  
+000388f0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+00038900: 2020 2020 2020 3230 202a 206e 702e 7261        20 * np.ra
+00038910: 6e64 6f6d 2e72 616e 6428 3429 2e72 6573  ndom.rand(4).res
+00038920: 6861 7065 2832 2c20 3229 2c0a 2020 2020  hape(2, 2),.    
+00038930: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
+00038940: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
+00038950: 2020 2020 2020 2022 7072 6563 6970 6974         "precipit
+00038960: 6174 696f 6e22 3a20 2828 226c 6174 222c  ation": (("lat",
+00038970: 2022 6c6f 6e22 292c 206e 702e 7261 6e64   "lon"), np.rand
+00038980: 6f6d 2e72 616e 6428 3429 2e72 6573 6861  om.rand(4).resha
+00038990: 7065 2832 2c20 3229 292c 0a20 2020 2020  pe(2, 2)),.     
+000389a0: 2020 202e 2e2e 2020 2020 207d 2c0a 2020     ...     },.  
+000389b0: 2020 2020 2020 2e2e 2e20 2020 2020 636f        ...     co
+000389c0: 6f72 6473 3d7b 226c 6174 223a 205b 3130  ords={"lat": [10
+000389d0: 2c20 3230 5d2c 2022 6c6f 6e22 3a20 5b31  , 20], "lon": [1
+000389e0: 3530 2c20 3136 305d 7d2c 0a20 2020 2020  50, 160]},.     
+000389f0: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
+00038a00: 203e 3e3e 2078 0a20 2020 2020 2020 203c   >>> x.        <
+00038a10: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
+00038a20: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+00038a30: 6e73 3a20 2020 2020 2020 2028 6c61 743a  ns:        (lat:
+00038a40: 2032 2c20 6c6f 6e3a 2032 290a 2020 2020   2, lon: 2).    
+00038a50: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
+00038a60: 0a20 2020 2020 2020 2020 202a 206c 6174  .          * lat
+00038a70: 2020 2020 2020 2020 2020 2020 286c 6174              (lat
+00038a80: 2920 696e 7436 3420 3130 2032 300a 2020  ) int64 10 20.  
+00038a90: 2020 2020 2020 2020 2a20 6c6f 6e20 2020          * lon   
+00038aa0: 2020 2020 2020 2020 2028 6c6f 6e29 2069           (lon) i
+00038ab0: 6e74 3634 2031 3530 2031 3630 0a20 2020  nt64 150 160.   
+00038ac0: 2020 2020 2044 6174 6120 7661 7269 6162       Data variab
+00038ad0: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
+00038ae0: 2074 656d 7065 7261 7475 7265 5f63 2020   temperature_c  
+00038af0: 286c 6174 2c20 6c6f 6e29 2066 6c6f 6174  (lat, lon) float
+00038b00: 3634 2031 302e 3938 2031 342e 3320 3132  64 10.98 14.3 12
+00038b10: 2e30 3620 3130 2e39 0a20 2020 2020 2020  .06 10.9.       
+00038b20: 2020 2020 2070 7265 6369 7069 7461 7469       precipitati
+00038b30: 6f6e 2020 286c 6174 2c20 6c6f 6e29 2066  on  (lat, lon) f
+00038b40: 6c6f 6174 3634 2030 2e34 3233 3720 302e  loat64 0.4237 0.
+00038b50: 3634 3539 2030 2e34 3337 3620 302e 3839  6459 0.4376 0.89
+00038b60: 3138 0a0a 2020 2020 2020 2020 5768 6572  18..        Wher
+00038b70: 6520 7468 6520 7661 6c75 6520 6973 2061  e the value is a
+00038b80: 2063 616c 6c61 626c 652c 2065 7661 6c75   callable, evalu
+00038b90: 6174 6564 206f 6e20 6461 7461 7365 743a  ated on dataset:
+00038ba0: 0a0a 2020 2020 2020 2020 3e3e 3e20 782e  ..        >>> x.
+00038bb0: 6173 7369 676e 2874 656d 7065 7261 7475  assign(temperatu
+00038bc0: 7265 5f66 3d6c 616d 6264 6120 783a 2078  re_f=lambda x: x
+00038bd0: 2e74 656d 7065 7261 7475 7265 5f63 202a  .temperature_c *
+00038be0: 2039 202f 2035 202b 2033 3229 0a20 2020   9 / 5 + 32).   
+00038bf0: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
+00038c00: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
+00038c10: 6d65 6e73 696f 6e73 3a20 2020 2020 2020  mensions:       
+00038c20: 2028 6c61 743a 2032 2c20 6c6f 6e3a 2032   (lat: 2, lon: 2
+00038c30: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
+00038c40: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
+00038c50: 202a 206c 6174 2020 2020 2020 2020 2020   * lat          
+00038c60: 2020 286c 6174 2920 696e 7436 3420 3130    (lat) int64 10
+00038c70: 2032 300a 2020 2020 2020 2020 2020 2a20   20.          * 
+00038c80: 6c6f 6e20 2020 2020 2020 2020 2020 2028  lon            (
+00038c90: 6c6f 6e29 2069 6e74 3634 2031 3530 2031  lon) int64 150 1
+00038ca0: 3630 0a20 2020 2020 2020 2044 6174 6120  60.        Data 
+00038cb0: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
+00038cc0: 2020 2020 2020 2074 656d 7065 7261 7475         temperatu
+00038cd0: 7265 5f63 2020 286c 6174 2c20 6c6f 6e29  re_c  (lat, lon)
+00038ce0: 2066 6c6f 6174 3634 2031 302e 3938 2031   float64 10.98 1
+00038cf0: 342e 3320 3132 2e30 3620 3130 2e39 0a20  4.3 12.06 10.9. 
+00038d00: 2020 2020 2020 2020 2020 2070 7265 6369             preci
+00038d10: 7069 7461 7469 6f6e 2020 286c 6174 2c20  pitation  (lat, 
+00038d20: 6c6f 6e29 2066 6c6f 6174 3634 2030 2e34  lon) float64 0.4
+00038d30: 3233 3720 302e 3634 3539 2030 2e34 3337  237 0.6459 0.437
+00038d40: 3620 302e 3839 3138 0a20 2020 2020 2020  6 0.8918.       
+00038d50: 2020 2020 2074 656d 7065 7261 7475 7265       temperature
+00038d60: 5f66 2020 286c 6174 2c20 6c6f 6e29 2066  _f  (lat, lon) f
+00038d70: 6c6f 6174 3634 2035 312e 3736 2035 372e  loat64 51.76 57.
+00038d80: 3735 2035 332e 3720 3531 2e36 320a 0a20  75 53.7 51.62.. 
+00038d90: 2020 2020 2020 2041 6c74 6572 6e61 7469         Alternati
+00038da0: 7665 6c79 2c20 7468 6520 7361 6d65 2062  vely, the same b
+00038db0: 6568 6176 696f 7220 6361 6e20 6265 2061  ehavior can be a
+00038dc0: 6368 6965 7665 6420 6279 2064 6972 6563  chieved by direc
+00038dd0: 746c 7920 7265 6665 7265 6e63 696e 6720  tly referencing 
+00038de0: 616e 2065 7869 7374 696e 6720 6461 7461  an existing data
+00038df0: 6172 7261 793a 0a0a 2020 2020 2020 2020  array:..        
+00038e00: 3e3e 3e20 782e 6173 7369 676e 2874 656d  >>> x.assign(tem
+00038e10: 7065 7261 7475 7265 5f66 3d78 5b22 7465  perature_f=x["te
+00038e20: 6d70 6572 6174 7572 655f 6322 5d20 2a20  mperature_c"] * 
+00038e30: 3920 2f20 3520 2b20 3332 290a 2020 2020  9 / 5 + 32).    
+00038e40: 2020 2020 3c78 6172 7261 792e 4461 7461      <xarray.Data
+00038e50: 7365 743e 0a20 2020 2020 2020 2044 696d  set>.        Dim
+00038e60: 656e 7369 6f6e 733a 2020 2020 2020 2020  ensions:        
+00038e70: 286c 6174 3a20 322c 206c 6f6e 3a20 3229  (lat: 2, lon: 2)
+00038e80: 0a20 2020 2020 2020 2043 6f6f 7264 696e  .        Coordin
+00038e90: 6174 6573 3a0a 2020 2020 2020 2020 2020  ates:.          
+00038ea0: 2a20 6c61 7420 2020 2020 2020 2020 2020  * lat           
+00038eb0: 2028 6c61 7429 2069 6e74 3634 2031 3020   (lat) int64 10 
+00038ec0: 3230 0a20 2020 2020 2020 2020 202a 206c  20.          * l
+00038ed0: 6f6e 2020 2020 2020 2020 2020 2020 286c  on            (l
+00038ee0: 6f6e 2920 696e 7436 3420 3135 3020 3136  on) int64 150 16
+00038ef0: 300a 2020 2020 2020 2020 4461 7461 2076  0.        Data v
+00038f00: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
+00038f10: 2020 2020 2020 7465 6d70 6572 6174 7572        temperatur
+00038f20: 655f 6320 2028 6c61 742c 206c 6f6e 2920  e_c  (lat, lon) 
+00038f30: 666c 6f61 7436 3420 3130 2e39 3820 3134  float64 10.98 14
+00038f40: 2e33 2031 322e 3036 2031 302e 390a 2020  .3 12.06 10.9.  
+00038f50: 2020 2020 2020 2020 2020 7072 6563 6970            precip
+00038f60: 6974 6174 696f 6e20 2028 6c61 742c 206c  itation  (lat, l
+00038f70: 6f6e 2920 666c 6f61 7436 3420 302e 3432  on) float64 0.42
+00038f80: 3337 2030 2e36 3435 3920 302e 3433 3736  37 0.6459 0.4376
+00038f90: 2030 2e38 3931 380a 2020 2020 2020 2020   0.8918.        
+00038fa0: 2020 2020 7465 6d70 6572 6174 7572 655f      temperature_
+00038fb0: 6620 2028 6c61 742c 206c 6f6e 2920 666c  f  (lat, lon) fl
+00038fc0: 6f61 7436 3420 3531 2e37 3620 3537 2e37  oat64 51.76 57.7
+00038fd0: 3520 3533 2e37 2035 312e 3632 0a0a 2020  5 53.7 51.62..  
+00038fe0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00038ff0: 2020 7661 7269 6162 6c65 7320 3d20 6569    variables = ei
+00039000: 7468 6572 5f64 6963 745f 6f72 5f6b 7761  ther_dict_or_kwa
+00039010: 7267 7328 7661 7269 6162 6c65 732c 2076  rgs(variables, v
+00039020: 6172 6961 626c 6573 5f6b 7761 7267 732c  ariables_kwargs,
+00039030: 2022 6173 7369 676e 2229 0a20 2020 2020   "assign").     
+00039040: 2020 2064 6174 6120 3d20 7365 6c66 2e63     data = self.c
+00039050: 6f70 7928 290a 2020 2020 2020 2020 2320  opy().        # 
+00039060: 646f 2061 6c6c 2063 616c 6375 6c61 7469  do all calculati
+00039070: 6f6e 7320 6669 7273 742e 2e2e 0a20 2020  ons first....   
+00039080: 2020 2020 2072 6573 756c 7473 3a20 436f       results: Co
+00039090: 6572 6369 626c 654d 6170 7069 6e67 203d  ercibleMapping =
+000390a0: 2064 6174 612e 5f63 616c 635f 6173 7369   data._calc_assi
+000390b0: 676e 5f72 6573 756c 7473 2876 6172 6961  gn_results(varia
+000390c0: 626c 6573 290a 2020 2020 2020 2020 6461  bles).        da
+000390d0: 7461 2e63 6f6f 7264 732e 5f6d 6179 6265  ta.coords._maybe
+000390e0: 5f64 726f 705f 6d75 6c74 6969 6e64 6578  _drop_multiindex
+000390f0: 5f63 6f6f 7264 7328 7365 7428 7265 7375  _coords(set(resu
+00039100: 6c74 732e 6b65 7973 2829 2929 0a20 2020  lts.keys())).   
+00039110: 2020 2020 2023 202e 2e2e 2061 6e64 2074       # ... and t
+00039120: 6865 6e20 6173 7369 676e 0a20 2020 2020  hen assign.     
+00039130: 2020 2064 6174 612e 7570 6461 7465 2872     data.update(r
+00039140: 6573 756c 7473 290a 2020 2020 2020 2020  esults).        
+00039150: 7265 7475 726e 2064 6174 610a 0a20 2020  return data..   
+00039160: 2064 6566 2074 6f5f 6172 7261 7928 0a20   def to_array(. 
+00039170: 2020 2020 2020 2073 656c 662c 2064 696d         self, dim
+00039180: 3a20 4861 7368 6162 6c65 203d 2022 7661  : Hashable = "va
+00039190: 7269 6162 6c65 222c 206e 616d 653a 2048  riable", name: H
+000391a0: 6173 6861 626c 6520 7c20 4e6f 6e65 203d  ashable | None =
+000391b0: 204e 6f6e 650a 2020 2020 2920 2d3e 2044   None.    ) -> D
+000391c0: 6174 6141 7272 6179 3a0a 2020 2020 2020  ataArray:.      
+000391d0: 2020 2222 2243 6f6e 7665 7274 2074 6869    """Convert thi
+000391e0: 7320 6461 7461 7365 7420 696e 746f 2061  s dataset into a
+000391f0: 6e20 7861 7272 6179 2e44 6174 6141 7272  n xarray.DataArr
+00039200: 6179 0a0a 2020 2020 2020 2020 5468 6520  ay..        The 
+00039210: 6461 7461 2076 6172 6961 626c 6573 206f  data variables o
+00039220: 6620 7468 6973 2064 6174 6173 6574 2077  f this dataset w
+00039230: 696c 6c20 6265 2062 726f 6164 6361 7374  ill be broadcast
+00039240: 2061 6761 696e 7374 2065 6163 6820 6f74   against each ot
+00039250: 6865 720a 2020 2020 2020 2020 616e 6420  her.        and 
+00039260: 7374 6163 6b65 6420 616c 6f6e 6720 7468  stacked along th
+00039270: 6520 6669 7273 7420 6178 6973 206f 6620  e first axis of 
+00039280: 7468 6520 6e65 7720 6172 7261 792e 2041  the new array. A
+00039290: 6c6c 2063 6f6f 7264 696e 6174 6573 206f  ll coordinates o
+000392a0: 660a 2020 2020 2020 2020 7468 6973 2064  f.        this d
+000392b0: 6174 6173 6574 2077 696c 6c20 7265 6d61  ataset will rema
+000392c0: 696e 2063 6f6f 7264 696e 6174 6573 2e0a  in coordinates..
+000392d0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000392e0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
+000392f0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2064  ------.        d
+00039300: 696d 203a 2048 6173 6861 626c 652c 2064  im : Hashable, d
+00039310: 6566 6175 6c74 3a20 2276 6172 6961 626c  efault: "variabl
+00039320: 6522 0a20 2020 2020 2020 2020 2020 204e  e".            N
+00039330: 616d 6520 6f66 2074 6865 206e 6577 2064  ame of the new d
+00039340: 696d 656e 7369 6f6e 2e0a 2020 2020 2020  imension..      
+00039350: 2020 6e61 6d65 203a 2048 6173 6861 626c    name : Hashabl
+00039360: 6520 6f72 204e 6f6e 652c 206f 7074 696f  e or None, optio
+00039370: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00039380: 4e61 6d65 206f 6620 7468 6520 6e65 7720  Name of the new 
+00039390: 6461 7461 2061 7272 6179 2e0a 0a20 2020  data array...   
+000393a0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+000393b0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+000393c0: 2020 2020 2061 7272 6179 203a 2078 6172       array : xar
+000393d0: 7261 792e 4461 7461 4172 7261 790a 2020  ray.DataArray.  
+000393e0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+000393f0: 2020 6672 6f6d 2078 6172 7261 792e 636f    from xarray.co
+00039400: 7265 2e64 6174 6161 7272 6179 2069 6d70  re.dataarray imp
+00039410: 6f72 7420 4461 7461 4172 7261 790a 0a20  ort DataArray.. 
+00039420: 2020 2020 2020 2064 6174 615f 7661 7273         data_vars
+00039430: 203d 205b 7365 6c66 2e76 6172 6961 626c   = [self.variabl
+00039440: 6573 5b6b 5d20 666f 7220 6b20 696e 2073  es[k] for k in s
+00039450: 656c 662e 6461 7461 5f76 6172 735d 0a20  elf.data_vars]. 
+00039460: 2020 2020 2020 2062 726f 6164 6361 7374         broadcast
+00039470: 5f76 6172 7320 3d20 6272 6f61 6463 6173  _vars = broadcas
+00039480: 745f 7661 7269 6162 6c65 7328 2a64 6174  t_variables(*dat
+00039490: 615f 7661 7273 290a 2020 2020 2020 2020  a_vars).        
+000394a0: 6461 7461 203d 2064 7563 6b5f 6172 7261  data = duck_arra
+000394b0: 795f 6f70 732e 7374 6163 6b28 5b62 2e64  y_ops.stack([b.d
+000394c0: 6174 6120 666f 7220 6220 696e 2062 726f  ata for b in bro
+000394d0: 6164 6361 7374 5f76 6172 735d 2c20 6178  adcast_vars], ax
+000394e0: 6973 3d30 290a 0a20 2020 2020 2020 2064  is=0)..        d
+000394f0: 696d 7320 3d20 2864 696d 2c29 202b 2062  ims = (dim,) + b
+00039500: 726f 6164 6361 7374 5f76 6172 735b 305d  roadcast_vars[0]
+00039510: 2e64 696d 730a 2020 2020 2020 2020 7661  .dims.        va
+00039520: 7269 6162 6c65 203d 2056 6172 6961 626c  riable = Variabl
+00039530: 6528 6469 6d73 2c20 6461 7461 2c20 7365  e(dims, data, se
+00039540: 6c66 2e61 7474 7273 2c20 6661 7374 7061  lf.attrs, fastpa
+00039550: 7468 3d54 7275 6529 0a0a 2020 2020 2020  th=True)..      
+00039560: 2020 636f 6f72 6473 203d 207b 6b3a 2076    coords = {k: v
+00039570: 2e76 6172 6961 626c 6520 666f 7220 6b2c  .variable for k,
+00039580: 2076 2069 6e20 7365 6c66 2e63 6f6f 7264   v in self.coord
+00039590: 732e 6974 656d 7328 297d 0a20 2020 2020  s.items()}.     
+000395a0: 2020 2069 6e64 6578 6573 203d 2066 696c     indexes = fil
+000395b0: 7465 725f 696e 6465 7865 735f 6672 6f6d  ter_indexes_from
+000395c0: 5f63 6f6f 7264 7328 7365 6c66 2e5f 696e  _coords(self._in
+000395d0: 6465 7865 732c 2073 6574 2863 6f6f 7264  dexes, set(coord
+000395e0: 7329 290a 2020 2020 2020 2020 6e65 775f  s)).        new_
+000395f0: 6469 6d5f 696e 6465 7820 3d20 5061 6e64  dim_index = Pand
+00039600: 6173 496e 6465 7828 6c69 7374 2873 656c  asIndex(list(sel
+00039610: 662e 6461 7461 5f76 6172 7329 2c20 6469  f.data_vars), di
+00039620: 6d29 0a20 2020 2020 2020 2069 6e64 6578  m).        index
+00039630: 6573 5b64 696d 5d20 3d20 6e65 775f 6469  es[dim] = new_di
+00039640: 6d5f 696e 6465 780a 2020 2020 2020 2020  m_index.        
+00039650: 636f 6f72 6473 2e75 7064 6174 6528 6e65  coords.update(ne
+00039660: 775f 6469 6d5f 696e 6465 782e 6372 6561  w_dim_index.crea
+00039670: 7465 5f76 6172 6961 626c 6573 2829 290a  te_variables()).
+00039680: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00039690: 4461 7461 4172 7261 792e 5f63 6f6e 7374  DataArray._const
+000396a0: 7275 6374 5f64 6972 6563 7428 7661 7269  ruct_direct(vari
+000396b0: 6162 6c65 2c20 636f 6f72 6473 2c20 6e61  able, coords, na
+000396c0: 6d65 2c20 696e 6465 7865 7329 0a0a 2020  me, indexes)..  
+000396d0: 2020 6465 6620 5f6e 6f72 6d61 6c69 7a65    def _normalize
+000396e0: 5f64 696d 5f6f 7264 6572 280a 2020 2020  _dim_order(.    
+000396f0: 2020 2020 7365 6c66 2c20 6469 6d5f 6f72      self, dim_or
+00039700: 6465 723a 2053 6571 7565 6e63 655b 4861  der: Sequence[Ha
+00039710: 7368 6162 6c65 5d20 7c20 4e6f 6e65 203d  shable] | None =
+00039720: 204e 6f6e 650a 2020 2020 2920 2d3e 2064   None.    ) -> d
+00039730: 6963 745b 4861 7368 6162 6c65 2c20 696e  ict[Hashable, in
+00039740: 745d 3a0a 2020 2020 2020 2020 2222 220a  t]:.        """.
+00039750: 2020 2020 2020 2020 4368 6563 6b20 7468          Check th
+00039760: 6520 7661 6c69 6469 7479 206f 6620 7468  e validity of th
+00039770: 6520 7072 6f76 6964 6564 2064 696d 656e  e provided dimen
+00039780: 7369 6f6e 7320 6966 2061 6e79 2061 6e64  sions if any and
+00039790: 2072 6574 7572 6e20 7468 6520 6d61 7070   return the mapp
+000397a0: 696e 670a 2020 2020 2020 2020 6265 7477  ing.        betw
+000397b0: 6565 6e20 6469 6d65 6e73 696f 6e20 6e61  een dimension na
+000397c0: 6d65 2061 6e64 2074 6865 6972 2073 697a  me and their siz
+000397d0: 652e 0a0a 2020 2020 2020 2020 5061 7261  e...        Para
+000397e0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+000397f0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00039800: 2020 6469 6d5f 6f72 6465 723a 2053 6571    dim_order: Seq
+00039810: 7565 6e63 6520 6f66 2048 6173 6861 626c  uence of Hashabl
+00039820: 6520 6f72 204e 6f6e 652c 206f 7074 696f  e or None, optio
+00039830: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00039840: 4469 6d65 6e73 696f 6e20 6f72 6465 7220  Dimension order 
+00039850: 746f 2076 616c 6964 6174 6520 2864 6566  to validate (def
+00039860: 6175 6c74 2074 6f20 7468 6520 616c 7068  ault to the alph
+00039870: 6162 6574 6963 616c 206f 7264 6572 2069  abetical order i
+00039880: 6620 4e6f 6e65 292e 0a0a 2020 2020 2020  f None)...      
+00039890: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+000398a0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+000398b0: 2020 7265 7375 6c74 203a 2064 6963 745b    result : dict[
+000398c0: 4861 7368 6162 6c65 2c20 696e 745d 0a20  Hashable, int]. 
+000398d0: 2020 2020 2020 2020 2020 2056 616c 6964             Valid
+000398e0: 6174 6564 2064 696d 656e 7369 6f6e 7320  ated dimensions 
+000398f0: 6d61 7070 696e 672e 0a0a 2020 2020 2020  mapping...      
+00039900: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
+00039910: 2064 696d 5f6f 7264 6572 2069 7320 4e6f   dim_order is No
+00039920: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00039930: 6469 6d5f 6f72 6465 7220 3d20 6c69 7374  dim_order = list
+00039940: 2873 656c 662e 6469 6d73 290a 2020 2020  (self.dims).    
+00039950: 2020 2020 656c 6966 2073 6574 2864 696d      elif set(dim
+00039960: 5f6f 7264 6572 2920 213d 2073 6574 2873  _order) != set(s
+00039970: 656c 662e 6469 6d73 293a 0a20 2020 2020  elf.dims):.     
+00039980: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00039990: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+000399a0: 2020 2020 2020 2020 2022 6469 6d5f 6f72           "dim_or
+000399b0: 6465 7220 7b7d 2064 6f65 7320 6e6f 7420  der {} does not 
+000399c0: 6d61 7463 6820 7468 6520 7365 7420 6f66  match the set of
+000399d0: 2064 696d 656e 7369 6f6e 7320 6f66 2074   dimensions of t
+000399e0: 6869 7320 220a 2020 2020 2020 2020 2020  his ".          
+000399f0: 2020 2020 2020 2244 6174 6173 6574 3a20        "Dataset: 
+00039a00: 7b7d 222e 666f 726d 6174 2864 696d 5f6f  {}".format(dim_o
+00039a10: 7264 6572 2c20 6c69 7374 2873 656c 662e  rder, list(self.
+00039a20: 6469 6d73 2929 0a20 2020 2020 2020 2020  dims)).         
+00039a30: 2020 2029 0a0a 2020 2020 2020 2020 6f72     )..        or
+00039a40: 6465 7265 645f 6469 6d73 203d 207b 6b3a  dered_dims = {k:
+00039a50: 2073 656c 662e 6469 6d73 5b6b 5d20 666f   self.dims[k] fo
+00039a60: 7220 6b20 696e 2064 696d 5f6f 7264 6572  r k in dim_order
+00039a70: 7d0a 0a20 2020 2020 2020 2072 6574 7572  }..        retur
+00039a80: 6e20 6f72 6465 7265 645f 6469 6d73 0a0a  n ordered_dims..
+00039a90: 2020 2020 6465 6620 746f 5f70 616e 6461      def to_panda
+00039aa0: 7328 7365 6c66 2920 2d3e 2070 642e 5365  s(self) -> pd.Se
+00039ab0: 7269 6573 207c 2070 642e 4461 7461 4672  ries | pd.DataFr
+00039ac0: 616d 653a 0a20 2020 2020 2020 2022 2222  ame:.        """
+00039ad0: 436f 6e76 6572 7420 7468 6973 2064 6174  Convert this dat
+00039ae0: 6173 6574 2069 6e74 6f20 6120 7061 6e64  aset into a pand
+00039af0: 6173 206f 626a 6563 7420 7769 7468 6f75  as object withou
+00039b00: 7420 6368 616e 6769 6e67 2074 6865 206e  t changing the n
+00039b10: 756d 6265 7220 6f66 2064 696d 656e 7369  umber of dimensi
+00039b20: 6f6e 732e 0a0a 2020 2020 2020 2020 5468  ons...        Th
+00039b30: 6520 7479 7065 206f 6620 7468 6520 7265  e type of the re
+00039b40: 7475 726e 6564 206f 626a 6563 7420 6465  turned object de
+00039b50: 7065 6e64 7320 6f6e 2074 6865 206e 756d  pends on the num
+00039b60: 6265 7220 6f66 2044 6174 6173 6574 0a20  ber of Dataset. 
+00039b70: 2020 2020 2020 2064 696d 656e 7369 6f6e         dimension
+00039b80: 733a 0a0a 2020 2020 2020 2020 2a20 3044  s:..        * 0D
+00039b90: 202d 3e20 6070 616e 6461 732e 5365 7269   -> `pandas.Seri
+00039ba0: 6573 600a 2020 2020 2020 2020 2a20 3144  es`.        * 1D
+00039bb0: 202d 3e20 6070 616e 6461 732e 4461 7461   -> `pandas.Data
+00039bc0: 4672 616d 6560 0a0a 2020 2020 2020 2020  Frame`..        
+00039bd0: 4f6e 6c79 2077 6f72 6b73 2066 6f72 2044  Only works for D
+00039be0: 6174 6173 6574 7320 7769 7468 2031 206f  atasets with 1 o
+00039bf0: 7220 6665 7765 7220 6469 6d65 6e73 696f  r fewer dimensio
+00039c00: 6e73 2e0a 2020 2020 2020 2020 2222 220a  ns..        """.
+00039c10: 2020 2020 2020 2020 6966 206c 656e 2873          if len(s
+00039c20: 656c 662e 6469 6d73 2920 3d3d 2030 3a0a  elf.dims) == 0:.
+00039c30: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00039c40: 726e 2070 642e 5365 7269 6573 287b 6b3a  rn pd.Series({k:
+00039c50: 2076 2e69 7465 6d28 2920 666f 7220 6b2c   v.item() for k,
+00039c60: 2076 2069 6e20 7365 6c66 2e69 7465 6d73   v in self.items
+00039c70: 2829 7d29 0a20 2020 2020 2020 2069 6620  ()}).        if 
+00039c80: 6c65 6e28 7365 6c66 2e64 696d 7329 203d  len(self.dims) =
+00039c90: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00039ca0: 2072 6574 7572 6e20 7365 6c66 2e74 6f5f   return self.to_
+00039cb0: 6461 7461 6672 616d 6528 290a 2020 2020  dataframe().    
+00039cc0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00039cd0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+00039ce0: 2020 2263 616e 6e6f 7420 636f 6e76 6572    "cannot conver
+00039cf0: 7420 4461 7461 7365 7473 2077 6974 6820  t Datasets with 
+00039d00: 2573 2064 696d 656e 7369 6f6e 7320 696e  %s dimensions in
+00039d10: 746f 2022 0a20 2020 2020 2020 2020 2020  to ".           
+00039d20: 2022 7061 6e64 6173 206f 626a 6563 7473   "pandas objects
+00039d30: 2077 6974 686f 7574 2063 6861 6e67 696e   without changin
+00039d40: 6720 7468 6520 6e75 6d62 6572 206f 6620  g the number of 
+00039d50: 6469 6d65 6e73 696f 6e73 2e20 220a 2020  dimensions. ".  
+00039d60: 2020 2020 2020 2020 2020 2250 6c65 6173            "Pleas
+00039d70: 6520 7573 6520 4461 7461 7365 742e 746f  e use Dataset.to
+00039d80: 5f64 6174 6166 7261 6d65 2829 2069 6e73  _dataframe() ins
+00039d90: 7465 6164 2e22 2025 206c 656e 2873 656c  tead." % len(sel
+00039da0: 662e 6469 6d73 290a 2020 2020 2020 2020  f.dims).        
+00039db0: 290a 0a20 2020 2064 6566 205f 746f 5f64  )..    def _to_d
+00039dc0: 6174 6166 7261 6d65 2873 656c 662c 206f  ataframe(self, o
+00039dd0: 7264 6572 6564 5f64 696d 733a 204d 6170  rdered_dims: Map
+00039de0: 7069 6e67 5b41 6e79 2c20 696e 745d 293a  ping[Any, int]):
+00039df0: 0a20 2020 2020 2020 2063 6f6c 756d 6e73  .        columns
+00039e00: 203d 205b 6b20 666f 7220 6b20 696e 2073   = [k for k in s
+00039e10: 656c 662e 7661 7269 6162 6c65 7320 6966  elf.variables if
+00039e20: 206b 206e 6f74 2069 6e20 7365 6c66 2e64   k not in self.d
+00039e30: 696d 735d 0a20 2020 2020 2020 2064 6174  ims].        dat
+00039e40: 6120 3d20 5b0a 2020 2020 2020 2020 2020  a = [.          
+00039e50: 2020 7365 6c66 2e5f 7661 7269 6162 6c65    self._variable
+00039e60: 735b 6b5d 2e73 6574 5f64 696d 7328 6f72  s[k].set_dims(or
+00039e70: 6465 7265 645f 6469 6d73 292e 7661 6c75  dered_dims).valu
+00039e80: 6573 2e72 6573 6861 7065 282d 3129 0a20  es.reshape(-1). 
+00039e90: 2020 2020 2020 2020 2020 2066 6f72 206b             for k
+00039ea0: 2069 6e20 636f 6c75 6d6e 730a 2020 2020   in columns.    
+00039eb0: 2020 2020 5d0a 2020 2020 2020 2020 696e      ].        in
+00039ec0: 6465 7820 3d20 7365 6c66 2e63 6f6f 7264  dex = self.coord
+00039ed0: 732e 746f 5f69 6e64 6578 285b 2a6f 7264  s.to_index([*ord
+00039ee0: 6572 6564 5f64 696d 735d 290a 2020 2020  ered_dims]).    
+00039ef0: 2020 2020 7265 7475 726e 2070 642e 4461      return pd.Da
+00039f00: 7461 4672 616d 6528 6469 6374 287a 6970  taFrame(dict(zip
+00039f10: 2863 6f6c 756d 6e73 2c20 6461 7461 2929  (columns, data))
+00039f20: 2c20 696e 6465 783d 696e 6465 7829 0a0a  , index=index)..
+00039f30: 2020 2020 6465 6620 746f 5f64 6174 6166      def to_dataf
+00039f40: 7261 6d65 2873 656c 662c 2064 696d 5f6f  rame(self, dim_o
+00039f50: 7264 6572 3a20 5365 7175 656e 6365 5b48  rder: Sequence[H
+00039f60: 6173 6861 626c 655d 207c 204e 6f6e 6520  ashable] | None 
+00039f70: 3d20 4e6f 6e65 2920 2d3e 2070 642e 4461  = None) -> pd.Da
+00039f80: 7461 4672 616d 653a 0a20 2020 2020 2020  taFrame:.       
+00039f90: 2022 2222 436f 6e76 6572 7420 7468 6973   """Convert this
+00039fa0: 2064 6174 6173 6574 2069 6e74 6f20 6120   dataset into a 
+00039fb0: 7061 6e64 6173 2e44 6174 6146 7261 6d65  pandas.DataFrame
+00039fc0: 2e0a 0a20 2020 2020 2020 204e 6f6e 2d69  ...        Non-i
+00039fd0: 6e64 6578 2076 6172 6961 626c 6573 2069  ndex variables i
+00039fe0: 6e20 7468 6973 2064 6174 6173 6574 2066  n this dataset f
+00039ff0: 6f72 6d20 7468 6520 636f 6c75 6d6e 7320  orm the columns 
+0003a000: 6f66 2074 6865 0a20 2020 2020 2020 2044  of the.        D
+0003a010: 6174 6146 7261 6d65 2e20 5468 6520 4461  ataFrame. The Da
+0003a020: 7461 4672 616d 6520 6973 2069 6e64 6578  taFrame is index
+0003a030: 6564 2062 7920 7468 6520 4361 7274 6573  ed by the Cartes
+0003a040: 6961 6e20 7072 6f64 7563 7420 6f66 0a20  ian product of. 
+0003a050: 2020 2020 2020 2074 6869 7320 6461 7461         this data
+0003a060: 7365 7427 7320 696e 6469 6365 732e 0a0a  set's indices...
+0003a070: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0003a080: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+0003a090: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6469  -----.        di
+0003a0a0: 6d5f 6f72 6465 723a 2053 6571 7565 6e63  m_order: Sequenc
+0003a0b0: 6520 6f66 2048 6173 6861 626c 6520 6f72  e of Hashable or
+0003a0c0: 204e 6f6e 652c 206f 7074 696f 6e61 6c0a   None, optional.
+0003a0d0: 2020 2020 2020 2020 2020 2020 4869 6572              Hier
+0003a0e0: 6172 6368 6963 616c 2064 696d 656e 7369  archical dimensi
+0003a0f0: 6f6e 206f 7264 6572 2066 6f72 2074 6865  on order for the
+0003a100: 2072 6573 756c 7469 6e67 2064 6174 6166   resulting dataf
+0003a110: 7261 6d65 2e20 416c 6c0a 2020 2020 2020  rame. All.      
+0003a120: 2020 2020 2020 6172 7261 7973 2061 7265        arrays are
+0003a130: 2074 7261 6e73 706f 7365 6420 746f 2074   transposed to t
+0003a140: 6869 7320 6f72 6465 7220 616e 6420 7468  his order and th
+0003a150: 656e 2077 7269 7474 656e 206f 7574 2061  en written out a
+0003a160: 7320 666c 6174 0a20 2020 2020 2020 2020  s flat.         
+0003a170: 2020 2076 6563 746f 7273 2069 6e20 636f     vectors in co
+0003a180: 6e74 6967 756f 7573 206f 7264 6572 2c20  ntiguous order, 
+0003a190: 736f 2074 6865 206c 6173 7420 6469 6d65  so the last dime
+0003a1a0: 6e73 696f 6e20 696e 2074 6869 7320 6c69  nsion in this li
+0003a1b0: 7374 0a20 2020 2020 2020 2020 2020 2077  st.            w
+0003a1c0: 696c 6c20 6265 2063 6f6e 7469 6775 6f75  ill be contiguou
+0003a1d0: 7320 696e 2074 6865 2072 6573 756c 7469  s in the resulti
+0003a1e0: 6e67 2044 6174 6146 7261 6d65 2e20 5468  ng DataFrame. Th
+0003a1f0: 6973 2068 6173 2061 206d 616a 6f72 0a20  is has a major. 
+0003a200: 2020 2020 2020 2020 2020 2069 6e66 6c75             influ
+0003a210: 656e 6365 206f 6e20 7768 6963 6820 6f70  ence on which op
+0003a220: 6572 6174 696f 6e73 2061 7265 2065 6666  erations are eff
+0003a230: 6963 6965 6e74 206f 6e20 7468 6520 7265  icient on the re
+0003a240: 7375 6c74 696e 670a 2020 2020 2020 2020  sulting.        
+0003a250: 2020 2020 6461 7461 6672 616d 652e 0a0a      dataframe...
+0003a260: 2020 2020 2020 2020 2020 2020 4966 2070              If p
+0003a270: 726f 7669 6465 642c 206d 7573 7420 696e  rovided, must in
+0003a280: 636c 7564 6520 616c 6c20 6469 6d65 6e73  clude all dimens
+0003a290: 696f 6e73 206f 6620 7468 6973 2064 6174  ions of this dat
+0003a2a0: 6173 6574 2e20 4279 0a20 2020 2020 2020  aset. By.       
+0003a2b0: 2020 2020 2064 6566 6175 6c74 2c20 6469       default, di
+0003a2c0: 6d65 6e73 696f 6e73 2061 7265 2073 6f72  mensions are sor
+0003a2d0: 7465 6420 616c 7068 6162 6574 6963 616c  ted alphabetical
+0003a2e0: 6c79 2e0a 0a20 2020 2020 2020 2052 6574  ly...        Ret
+0003a2f0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+0003a300: 2d2d 2d2d 0a20 2020 2020 2020 2072 6573  ----.        res
+0003a310: 756c 7420 3a20 4461 7461 4672 616d 650a  ult : DataFrame.
+0003a320: 2020 2020 2020 2020 2020 2020 4461 7461              Data
+0003a330: 7365 7420 6173 2061 2070 616e 6461 7320  set as a pandas 
+0003a340: 4461 7461 4672 616d 652e 0a0a 2020 2020  DataFrame...    
+0003a350: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0003a360: 206f 7264 6572 6564 5f64 696d 7320 3d20   ordered_dims = 
+0003a370: 7365 6c66 2e5f 6e6f 726d 616c 697a 655f  self._normalize_
+0003a380: 6469 6d5f 6f72 6465 7228 6469 6d5f 6f72  dim_order(dim_or
+0003a390: 6465 723d 6469 6d5f 6f72 6465 7229 0a0a  der=dim_order)..
+0003a3a0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0003a3b0: 656c 662e 5f74 6f5f 6461 7461 6672 616d  elf._to_datafram
+0003a3c0: 6528 6f72 6465 7265 645f 6469 6d73 3d6f  e(ordered_dims=o
+0003a3d0: 7264 6572 6564 5f64 696d 7329 0a0a 2020  rdered_dims)..  
+0003a3e0: 2020 6465 6620 5f73 6574 5f73 7061 7273    def _set_spars
+0003a3f0: 655f 6461 7461 5f66 726f 6d5f 6461 7461  e_data_from_data
+0003a400: 6672 616d 6528 0a20 2020 2020 2020 2073  frame(.        s
+0003a410: 656c 662c 2069 6478 3a20 7064 2e49 6e64  elf, idx: pd.Ind
+0003a420: 6578 2c20 6172 7261 7973 3a20 6c69 7374  ex, arrays: list
+0003a430: 5b74 7570 6c65 5b48 6173 6861 626c 652c  [tuple[Hashable,
+0003a440: 206e 702e 6e64 6172 7261 795d 5d2c 2064   np.ndarray]], d
+0003a450: 696d 733a 2074 7570 6c65 0a20 2020 2029  ims: tuple.    )
+0003a460: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+0003a470: 2020 6672 6f6d 2073 7061 7273 6520 696d    from sparse im
+0003a480: 706f 7274 2043 4f4f 0a0a 2020 2020 2020  port COO..      
+0003a490: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0003a4a0: 6964 782c 2070 642e 4d75 6c74 6949 6e64  idx, pd.MultiInd
+0003a4b0: 6578 293a 0a20 2020 2020 2020 2020 2020  ex):.           
+0003a4c0: 2063 6f6f 7264 7320 3d20 6e70 2e73 7461   coords = np.sta
+0003a4d0: 636b 285b 6e70 2e61 7361 7272 6179 2863  ck([np.asarray(c
+0003a4e0: 6f64 6529 2066 6f72 2063 6f64 6520 696e  ode) for code in
+0003a4f0: 2069 6478 2e63 6f64 6573 5d2c 2061 7869   idx.codes], axi
+0003a500: 733d 3029 0a20 2020 2020 2020 2020 2020  s=0).           
+0003a510: 2069 735f 736f 7274 6564 203d 2069 6478   is_sorted = idx
+0003a520: 2e69 735f 6d6f 6e6f 746f 6e69 635f 696e  .is_monotonic_in
+0003a530: 6372 6561 7369 6e67 0a20 2020 2020 2020  creasing.       
+0003a540: 2020 2020 2073 6861 7065 203d 2074 7570       shape = tup
+0003a550: 6c65 286c 6576 2e73 697a 6520 666f 7220  le(lev.size for 
+0003a560: 6c65 7620 696e 2069 6478 2e6c 6576 656c  lev in idx.level
+0003a570: 7329 0a20 2020 2020 2020 2065 6c73 653a  s).        else:
+0003a580: 0a20 2020 2020 2020 2020 2020 2063 6f6f  .            coo
+0003a590: 7264 7320 3d20 6e70 2e61 7261 6e67 6528  rds = np.arange(
+0003a5a0: 6964 782e 7369 7a65 292e 7265 7368 6170  idx.size).reshap
+0003a5b0: 6528 312c 202d 3129 0a20 2020 2020 2020  e(1, -1).       
+0003a5c0: 2020 2020 2069 735f 736f 7274 6564 203d       is_sorted =
+0003a5d0: 2054 7275 650a 2020 2020 2020 2020 2020   True.          
+0003a5e0: 2020 7368 6170 6520 3d20 2869 6478 2e73    shape = (idx.s
+0003a5f0: 697a 652c 290a 0a20 2020 2020 2020 2066  ize,)..        f
+0003a600: 6f72 206e 616d 652c 2076 616c 7565 7320  or name, values 
+0003a610: 696e 2061 7272 6179 733a 0a20 2020 2020  in arrays:.     
+0003a620: 2020 2020 2020 2023 2049 6e20 7669 7274         # In virt
+0003a630: 7561 6c6c 7920 616c 6c20 7265 616c 2075  ually all real u
+0003a640: 7365 2063 6173 6573 2c20 7468 6520 7370  se cases, the sp
+0003a650: 6172 7365 2061 7272 6179 2077 696c 6c20  arse array will 
+0003a660: 6e6f 7720 6861 7665 0a20 2020 2020 2020  now have.       
+0003a670: 2020 2020 2023 206d 6973 7369 6e67 2076       # missing v
+0003a680: 616c 7565 7320 616e 6420 6e65 6564 7320  alues and needs 
+0003a690: 6120 6669 6c6c 5f76 616c 7565 2e20 466f  a fill_value. Fo
+0003a6a0: 7220 636f 6e73 6973 7465 6e63 792c 2064  r consistency, d
+0003a6b0: 6f6e 2774 0a20 2020 2020 2020 2020 2020  on't.           
+0003a6c0: 2023 2073 7065 6369 616c 2063 6173 6520   # special case 
+0003a6d0: 7468 6520 7261 7265 2065 7863 6570 7469  the rare excepti
+0003a6e0: 6f6e 7320 2865 2e67 2e2c 2064 7479 7065  ons (e.g., dtype
+0003a6f0: 3d69 6e74 2077 6974 686f 7574 2061 0a20  =int without a. 
+0003a700: 2020 2020 2020 2020 2020 2023 204d 756c             # Mul
+0003a710: 7469 496e 6465 7829 2e0a 2020 2020 2020  tiIndex)..      
+0003a720: 2020 2020 2020 6474 7970 652c 2066 696c        dtype, fil
+0003a730: 6c5f 7661 6c75 6520 3d20 7872 6474 7970  l_value = xrdtyp
+0003a740: 6573 2e6d 6179 6265 5f70 726f 6d6f 7465  es.maybe_promote
+0003a750: 2876 616c 7565 732e 6474 7970 6529 0a20  (values.dtype). 
+0003a760: 2020 2020 2020 2020 2020 2076 616c 7565             value
+0003a770: 7320 3d20 6e70 2e61 7361 7272 6179 2876  s = np.asarray(v
+0003a780: 616c 7565 732c 2064 7479 7065 3d64 7479  alues, dtype=dty
+0003a790: 7065 290a 0a20 2020 2020 2020 2020 2020  pe)..           
+0003a7a0: 2064 6174 6120 3d20 434f 4f28 0a20 2020   data = COO(.   
+0003a7b0: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+0003a7c0: 7264 732c 0a20 2020 2020 2020 2020 2020  rds,.           
+0003a7d0: 2020 2020 2076 616c 7565 732c 0a20 2020       values,.   
+0003a7e0: 2020 2020 2020 2020 2020 2020 2073 6861               sha
+0003a7f0: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
+0003a800: 2020 2020 6861 735f 6475 706c 6963 6174      has_duplicat
+0003a810: 6573 3d46 616c 7365 2c0a 2020 2020 2020  es=False,.      
+0003a820: 2020 2020 2020 2020 2020 736f 7274 6564            sorted
+0003a830: 3d69 735f 736f 7274 6564 2c0a 2020 2020  =is_sorted,.    
+0003a840: 2020 2020 2020 2020 2020 2020 6669 6c6c              fill
+0003a850: 5f76 616c 7565 3d66 696c 6c5f 7661 6c75  _value=fill_valu
+0003a860: 652c 0a20 2020 2020 2020 2020 2020 2029  e,.            )
+0003a870: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0003a880: 665b 6e61 6d65 5d20 3d20 2864 696d 732c  f[name] = (dims,
+0003a890: 2064 6174 6129 0a0a 2020 2020 6465 6620   data)..    def 
+0003a8a0: 5f73 6574 5f6e 756d 7079 5f64 6174 615f  _set_numpy_data_
+0003a8b0: 6672 6f6d 5f64 6174 6166 7261 6d65 280a  from_dataframe(.
+0003a8c0: 2020 2020 2020 2020 7365 6c66 2c20 6964          self, id
+0003a8d0: 783a 2070 642e 496e 6465 782c 2061 7272  x: pd.Index, arr
+0003a8e0: 6179 733a 206c 6973 745b 7475 706c 655b  ays: list[tuple[
+0003a8f0: 4861 7368 6162 6c65 2c20 6e70 2e6e 6461  Hashable, np.nda
+0003a900: 7272 6179 5d5d 2c20 6469 6d73 3a20 7475  rray]], dims: tu
+0003a910: 706c 650a 2020 2020 2920 2d3e 204e 6f6e  ple.    ) -> Non
+0003a920: 653a 0a20 2020 2020 2020 2069 6620 6e6f  e:.        if no
+0003a930: 7420 6973 696e 7374 616e 6365 2869 6478  t isinstance(idx
+0003a940: 2c20 7064 2e4d 756c 7469 496e 6465 7829  , pd.MultiIndex)
+0003a950: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+0003a960: 7220 6e61 6d65 2c20 7661 6c75 6573 2069  r name, values i
+0003a970: 6e20 6172 7261 7973 3a0a 2020 2020 2020  n arrays:.      
+0003a980: 2020 2020 2020 2020 2020 7365 6c66 5b6e            self[n
+0003a990: 616d 655d 203d 2028 6469 6d73 2c20 7661  ame] = (dims, va
+0003a9a0: 6c75 6573 290a 2020 2020 2020 2020 2020  lues).          
+0003a9b0: 2020 7265 7475 726e 0a0a 2020 2020 2020    return..      
+0003a9c0: 2020 2320 4e42 3a20 7369 6d69 6c61 722c    # NB: similar,
+0003a9d0: 206d 6f72 6520 6765 6e65 7261 6c20 6c6f   more general lo
+0003a9e0: 6769 632c 206e 6f77 2065 7869 7374 7320  gic, now exists 
+0003a9f0: 696e 0a20 2020 2020 2020 2023 2076 6172  in.        # var
+0003aa00: 6961 626c 652e 756e 7374 6163 6b5f 6f6e  iable.unstack_on
+0003aa10: 6365 3b20 7765 2063 6f75 6c64 2063 6f6e  ce; we could con
+0003aa20: 7369 6465 7220 636f 6d62 696e 696e 6720  sider combining 
+0003aa30: 7468 656d 2061 7420 736f 6d65 0a20 2020  them at some.   
+0003aa40: 2020 2020 2023 2070 6f69 6e74 2e0a 0a20       # point... 
+0003aa50: 2020 2020 2020 2073 6861 7065 203d 2074         shape = t
+0003aa60: 7570 6c65 286c 6576 2e73 697a 6520 666f  uple(lev.size fo
+0003aa70: 7220 6c65 7620 696e 2069 6478 2e6c 6576  r lev in idx.lev
+0003aa80: 656c 7329 0a20 2020 2020 2020 2069 6e64  els).        ind
+0003aa90: 6578 6572 203d 2074 7570 6c65 2869 6478  exer = tuple(idx
+0003aaa0: 2e63 6f64 6573 290a 0a20 2020 2020 2020  .codes)..       
+0003aab0: 2023 2057 6520 616c 7265 6164 7920 7665   # We already ve
+0003aac0: 7269 6669 6564 2074 6861 7420 7468 6520  rified that the 
+0003aad0: 4d75 6c74 6949 6e64 6578 2068 6173 2061  MultiIndex has a
+0003aae0: 6c6c 2075 6e69 7175 6520 7661 6c75 6573  ll unique values
+0003aaf0: 2c20 736f 0a20 2020 2020 2020 2023 2074  , so.        # t
+0003ab00: 6865 7265 2061 7265 206d 6973 7369 6e67  here are missing
+0003ab10: 2076 616c 7565 7320 6966 2061 6e64 206f   values if and o
+0003ab20: 6e6c 7920 6966 2074 6865 2073 697a 6520  nly if the size 
+0003ab30: 6f66 206f 7574 7075 7420 6172 7261 7973  of output arrays
+0003ab40: 2069 730a 2020 2020 2020 2020 2320 6c61   is.        # la
+0003ab50: 7267 6572 2074 6861 7420 7468 6520 696e  rger that the in
+0003ab60: 6465 782e 0a20 2020 2020 2020 206d 6973  dex..        mis
+0003ab70: 7369 6e67 5f76 616c 7565 7320 3d20 6d61  sing_values = ma
+0003ab80: 7468 2e70 726f 6428 7368 6170 6529 203e  th.prod(shape) >
+0003ab90: 2069 6478 2e73 6861 7065 5b30 5d0a 0a20   idx.shape[0].. 
+0003aba0: 2020 2020 2020 2066 6f72 206e 616d 652c         for name,
+0003abb0: 2076 616c 7565 7320 696e 2061 7272 6179   values in array
+0003abc0: 733a 0a20 2020 2020 2020 2020 2020 2023  s:.            #
+0003abd0: 204e 756d 5079 2069 6e64 6578 696e 6720   NumPy indexing 
+0003abe0: 6973 206d 7563 6820 6661 7374 6572 2074  is much faster t
+0003abf0: 6861 6e20 7573 696e 6720 4461 7461 4672  han using DataFr
+0003ac00: 616d 652e 7265 696e 6465 7828 2920 746f  ame.reindex() to
+0003ac10: 0a20 2020 2020 2020 2020 2020 2023 2066  .            # f
+0003ac20: 696c 6c20 696e 206d 6973 7369 6e67 2076  ill in missing v
+0003ac30: 616c 7565 733a 0a20 2020 2020 2020 2020  alues:.         
+0003ac40: 2020 2023 2068 7474 7073 3a2f 2f73 7461     # https://sta
+0003ac50: 636b 6f76 6572 666c 6f77 2e63 6f6d 2f61  ckoverflow.com/a
+0003ac60: 2f33 3530 3439 3839 392f 3830 3937 3035  /35049899/809705
+0003ac70: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0003ac80: 6d69 7373 696e 675f 7661 6c75 6573 3a0a  missing_values:.
+0003ac90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003aca0: 6474 7970 652c 2066 696c 6c5f 7661 6c75  dtype, fill_valu
+0003acb0: 6520 3d20 7872 6474 7970 6573 2e6d 6179  e = xrdtypes.may
+0003acc0: 6265 5f70 726f 6d6f 7465 2876 616c 7565  be_promote(value
+0003acd0: 732e 6474 7970 6529 0a20 2020 2020 2020  s.dtype).       
+0003ace0: 2020 2020 2020 2020 2064 6174 6120 3d20           data = 
+0003acf0: 6e70 2e66 756c 6c28 7368 6170 652c 2066  np.full(shape, f
+0003ad00: 696c 6c5f 7661 6c75 652c 2064 7479 7065  ill_value, dtype
+0003ad10: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+0003ad20: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003ad30: 2020 2020 2320 4966 2074 6865 7265 2061      # If there a
+0003ad40: 7265 206e 6f20 6d69 7373 696e 6720 7661  re no missing va
+0003ad50: 6c75 6573 2c20 6b65 6570 2074 6865 2065  lues, keep the e
+0003ad60: 7869 7374 696e 6720 6474 7970 650a 2020  xisting dtype.  
+0003ad70: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0003ad80: 696e 7374 6561 6420 6f66 2070 726f 6d6f  instead of promo
+0003ad90: 7469 6e67 2074 6f20 7375 7070 6f72 7420  ting to support 
+0003ada0: 4e41 2c20 652e 672e 2c20 6b65 6570 2069  NA, e.g., keep i
+0003adb0: 6e74 6567 6572 0a20 2020 2020 2020 2020  nteger.         
+0003adc0: 2020 2020 2020 2023 2063 6f6c 756d 6e73         # columns
+0003add0: 2061 7320 696e 7465 6765 7273 2e0a 2020   as integers..  
+0003ade0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0003adf0: 544f 444f 3a20 636f 6e73 6964 6572 2072  TODO: consider r
+0003ae00: 656d 6f76 696e 6720 7468 6973 2073 7065  emoving this spe
+0003ae10: 6369 616c 2063 6173 652c 2077 6869 6368  cial case, which
+0003ae20: 2064 6f65 736e 2774 0a20 2020 2020 2020   doesn't.       
+0003ae30: 2020 2020 2020 2020 2023 2065 7869 7374           # exist
+0003ae40: 2066 6f72 2073 7061 7273 653d 5472 7565   for sparse=True
+0003ae50: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0003ae60: 2020 6461 7461 203d 206e 702e 7a65 726f    data = np.zero
+0003ae70: 7328 7368 6170 652c 2076 616c 7565 732e  s(shape, values.
+0003ae80: 6474 7970 6529 0a20 2020 2020 2020 2020  dtype).         
+0003ae90: 2020 2064 6174 615b 696e 6465 7865 725d     data[indexer]
+0003aea0: 203d 2076 616c 7565 730a 2020 2020 2020   = values.      
+0003aeb0: 2020 2020 2020 7365 6c66 5b6e 616d 655d        self[name]
+0003aec0: 203d 2028 6469 6d73 2c20 6461 7461 290a   = (dims, data).
+0003aed0: 0a20 2020 2040 636c 6173 736d 6574 686f  .    @classmetho
+0003aee0: 640a 2020 2020 6465 6620 6672 6f6d 5f64  d.    def from_d
+0003aef0: 6174 6166 7261 6d65 280a 2020 2020 2020  ataframe(.      
+0003af00: 2020 636c 733a 2074 7970 655b 545f 4461    cls: type[T_Da
+0003af10: 7461 7365 745d 2c20 6461 7461 6672 616d  taset], datafram
+0003af20: 653a 2070 642e 4461 7461 4672 616d 652c  e: pd.DataFrame,
+0003af30: 2073 7061 7273 653a 2062 6f6f 6c20 3d20   sparse: bool = 
+0003af40: 4661 6c73 650a 2020 2020 2920 2d3e 2054  False.    ) -> T
+0003af50: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
+0003af60: 2020 2222 2243 6f6e 7665 7274 2061 2070    """Convert a p
+0003af70: 616e 6461 732e 4461 7461 4672 616d 6520  andas.DataFrame 
+0003af80: 696e 746f 2061 6e20 7861 7272 6179 2e44  into an xarray.D
+0003af90: 6174 6173 6574 0a0a 2020 2020 2020 2020  ataset..        
+0003afa0: 4561 6368 2063 6f6c 756d 6e20 7769 6c6c  Each column will
+0003afb0: 2062 6520 636f 6e76 6572 7465 6420 696e   be converted in
+0003afc0: 746f 2061 6e20 696e 6465 7065 6e64 656e  to an independen
+0003afd0: 7420 7661 7269 6162 6c65 2069 6e20 7468  t variable in th
+0003afe0: 650a 2020 2020 2020 2020 4461 7461 7365  e.        Datase
+0003aff0: 742e 2049 6620 7468 6520 6461 7461 6672  t. If the datafr
+0003b000: 616d 6527 7320 696e 6465 7820 6973 2061  ame's index is a
+0003b010: 204d 756c 7469 496e 6465 782c 2069 7420   MultiIndex, it 
+0003b020: 7769 6c6c 2062 6520 6578 7061 6e64 6564  will be expanded
+0003b030: 0a20 2020 2020 2020 2069 6e74 6f20 6120  .        into a 
+0003b040: 7465 6e73 6f72 2070 726f 6475 6374 206f  tensor product o
+0003b050: 6620 6f6e 652d 6469 6d65 6e73 696f 6e61  f one-dimensiona
+0003b060: 6c20 696e 6469 6365 7320 2866 696c 6c69  l indices (filli
+0003b070: 6e67 2069 6e20 6d69 7373 696e 670a 2020  ng in missing.  
+0003b080: 2020 2020 2020 7661 6c75 6573 2077 6974        values wit
+0003b090: 6820 4e61 4e29 2e20 5468 6973 206d 6574  h NaN). This met
+0003b0a0: 686f 6420 7769 6c6c 2070 726f 6475 6365  hod will produce
+0003b0b0: 2061 2044 6174 6173 6574 2076 6572 7920   a Dataset very 
+0003b0c0: 7369 6d69 6c61 7220 746f 0a20 2020 2020  similar to.     
+0003b0d0: 2020 2074 6861 7420 6f6e 2077 6869 6368     that on which
+0003b0e0: 2074 6865 2027 746f 5f64 6174 6166 7261   the 'to_datafra
+0003b0f0: 6d65 2720 6d65 7468 6f64 2077 6173 2063  me' method was c
+0003b100: 616c 6c65 642c 2065 7863 6570 7420 7769  alled, except wi
+0003b110: 7468 0a20 2020 2020 2020 2070 6f73 7369  th.        possi
+0003b120: 626c 7920 7265 6475 6e64 616e 7420 6469  bly redundant di
+0003b130: 6d65 6e73 696f 6e73 2028 7369 6e63 6520  mensions (since 
+0003b140: 616c 6c20 6461 7461 7365 7420 7661 7269  all dataset vari
+0003b150: 6162 6c65 7320 7769 6c6c 2068 6176 650a  ables will have.
+0003b160: 2020 2020 2020 2020 7468 6520 7361 6d65          the same
+0003b170: 2064 696d 656e 7369 6f6e 616c 6974 7929   dimensionality)
+0003b180: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+0003b190: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+0003b1a0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0003b1b0: 6461 7461 6672 616d 6520 3a20 4461 7461  dataframe : Data
+0003b1c0: 4672 616d 650a 2020 2020 2020 2020 2020  Frame.          
+0003b1d0: 2020 4461 7461 4672 616d 6520 6672 6f6d    DataFrame from
+0003b1e0: 2077 6869 6368 2074 6f20 636f 7079 2064   which to copy d
+0003b1f0: 6174 6120 616e 6420 696e 6469 6365 732e  ata and indices.
+0003b200: 0a20 2020 2020 2020 2073 7061 7273 6520  .        sparse 
+0003b210: 3a20 626f 6f6c 2c20 6465 6661 756c 743a  : bool, default:
+0003b220: 2046 616c 7365 0a20 2020 2020 2020 2020   False.         
+0003b230: 2020 2049 6620 7472 7565 2c20 6372 6561     If true, crea
+0003b240: 7465 2061 2073 7061 7273 6520 6172 7261  te a sparse arra
+0003b250: 7973 2069 6e73 7465 6164 206f 6620 6465  ys instead of de
+0003b260: 6e73 6520 6e75 6d70 7920 6172 7261 7973  nse numpy arrays
+0003b270: 2e20 5468 6973 0a20 2020 2020 2020 2020  . This.         
+0003b280: 2020 2063 616e 2070 6f74 656e 7469 616c     can potential
+0003b290: 6c79 2073 6176 6520 6120 6c61 7267 6520  ly save a large 
+0003b2a0: 616d 6f75 6e74 206f 6620 6d65 6d6f 7279  amount of memory
+0003b2b0: 2069 6620 7468 6520 4461 7461 4672 616d   if the DataFram
+0003b2c0: 6520 6861 730a 2020 2020 2020 2020 2020  e has.          
+0003b2d0: 2020 6120 4d75 6c74 6949 6e64 6578 2e20    a MultiIndex. 
+0003b2e0: 5265 7175 6972 6573 2074 6865 2073 7061  Requires the spa
+0003b2f0: 7273 6520 7061 636b 6167 6520 2873 7061  rse package (spa
+0003b300: 7273 652e 7079 6461 7461 2e6f 7267 292e  rse.pydata.org).
+0003b310: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0003b320: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0003b330: 2d0a 2020 2020 2020 2020 4e65 7720 4461  -.        New Da
+0003b340: 7461 7365 742e 0a0a 2020 2020 2020 2020  taset...        
+0003b350: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+0003b360: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+0003b370: 2020 7861 7272 6179 2e44 6174 6141 7272    xarray.DataArr
+0003b380: 6179 2e66 726f 6d5f 7365 7269 6573 0a20  ay.from_series. 
+0003b390: 2020 2020 2020 2070 616e 6461 732e 4461         pandas.Da
+0003b3a0: 7461 4672 616d 652e 746f 5f78 6172 7261  taFrame.to_xarra
+0003b3b0: 790a 2020 2020 2020 2020 2222 220a 2020  y.        """.  
+0003b3c0: 2020 2020 2020 2320 544f 444f 3a20 4164        # TODO: Ad
+0003b3d0: 6420 616e 206f 7074 696f 6e20 746f 2072  d an option to r
+0003b3e0: 656d 6f76 6520 6469 6d65 6e73 696f 6e73  emove dimensions
+0003b3f0: 2061 6c6f 6e67 2077 6869 6368 2074 6865   along which the
+0003b400: 2076 6172 6961 626c 6573 0a20 2020 2020   variables.     
+0003b410: 2020 2023 2061 7265 2063 6f6e 7374 616e     # are constan
+0003b420: 742c 2074 6f20 656e 6162 6c65 2063 6f6e  t, to enable con
+0003b430: 7369 7374 656e 7420 7365 7269 616c 697a  sistent serializ
+0003b440: 6174 696f 6e20 746f 2f66 726f 6d20 6120  ation to/from a 
+0003b450: 6461 7461 6672 616d 652c 0a20 2020 2020  dataframe,.     
+0003b460: 2020 2023 2065 7665 6e20 6966 2073 6f6d     # even if som
+0003b470: 6520 7661 7269 6162 6c65 7320 6861 7665  e variables have
+0003b480: 2064 6966 6665 7265 6e74 2064 696d 656e   different dimen
+0003b490: 7369 6f6e 616c 6974 792e 0a0a 2020 2020  sionality...    
+0003b4a0: 2020 2020 6966 206e 6f74 2064 6174 6166      if not dataf
+0003b4b0: 7261 6d65 2e63 6f6c 756d 6e73 2e69 735f  rame.columns.is_
+0003b4c0: 756e 6971 7565 3a0a 2020 2020 2020 2020  unique:.        
+0003b4d0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0003b4e0: 7272 6f72 2822 6361 6e6e 6f74 2063 6f6e  rror("cannot con
+0003b4f0: 7665 7274 2044 6174 6146 7261 6d65 2077  vert DataFrame w
+0003b500: 6974 6820 6e6f 6e2d 756e 6971 7565 2063  ith non-unique c
+0003b510: 6f6c 756d 6e73 2229 0a0a 2020 2020 2020  olumns")..      
+0003b520: 2020 6964 7820 3d20 7265 6d6f 7665 5f75    idx = remove_u
+0003b530: 6e75 7365 645f 6c65 7665 6c73 5f63 6174  nused_levels_cat
+0003b540: 6567 6f72 6965 7328 6461 7461 6672 616d  egories(datafram
+0003b550: 652e 696e 6465 7829 0a0a 2020 2020 2020  e.index)..      
+0003b560: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0003b570: 6964 782c 2070 642e 4d75 6c74 6949 6e64  idx, pd.MultiInd
+0003b580: 6578 2920 616e 6420 6e6f 7420 6964 782e  ex) and not idx.
+0003b590: 6973 5f75 6e69 7175 653a 0a20 2020 2020  is_unique:.     
+0003b5a0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0003b5b0: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+0003b5c0: 2020 2020 2020 2020 2022 6361 6e6e 6f74           "cannot
+0003b5d0: 2063 6f6e 7665 7274 2061 2044 6174 6146   convert a DataF
+0003b5e0: 7261 6d65 2077 6974 6820 6120 6e6f 6e2d  rame with a non-
+0003b5f0: 756e 6971 7565 204d 756c 7469 496e 6465  unique MultiInde
+0003b600: 7820 696e 746f 2078 6172 7261 7922 0a20  x into xarray". 
+0003b610: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+0003b620: 2020 2020 2020 2320 4361 7374 2074 6f20        # Cast to 
+0003b630: 6120 4e75 6d50 7920 6172 7261 7920 6669  a NumPy array fi
+0003b640: 7273 742c 2069 6e20 6361 7365 2074 6865  rst, in case the
+0003b650: 2053 6572 6965 7320 6973 2061 2070 616e   Series is a pan
+0003b660: 6461 7320 4578 7465 6e73 696f 6e0a 2020  das Extension.  
+0003b670: 2020 2020 2020 2320 6172 7261 7920 2877        # array (w
+0003b680: 6869 6368 2064 6f65 736e 2774 2068 6176  hich doesn't hav
+0003b690: 6520 6120 7661 6c69 6420 4e75 6d50 7920  e a valid NumPy 
+0003b6a0: 6474 7970 6529 0a20 2020 2020 2020 2023  dtype).        #
+0003b6b0: 2054 4f44 4f3a 2061 6c6c 6f77 2075 7365   TODO: allow use
+0003b6c0: 7273 2074 6f20 636f 6e74 726f 6c20 686f  rs to control ho
+0003b6d0: 7720 7468 6973 2063 6173 7469 6e67 2068  w this casting h
+0003b6e0: 6170 7065 6e73 2c20 652e 672e 2c20 6279  appens, e.g., by
+0003b6f0: 0a20 2020 2020 2020 2023 2066 6f72 7761  .        # forwa
+0003b700: 7264 696e 6720 6172 6775 6d65 6e74 7320  rding arguments 
+0003b710: 746f 2070 616e 6461 732e 5365 7269 6573  to pandas.Series
+0003b720: 2e74 6f5f 6e75 6d70 793f 0a20 2020 2020  .to_numpy?.     
+0003b730: 2020 2061 7272 6179 7320 3d20 5b28 6b2c     arrays = [(k,
+0003b740: 206e 702e 6173 6172 7261 7928 7629 2920   np.asarray(v)) 
+0003b750: 666f 7220 6b2c 2076 2069 6e20 6461 7461  for k, v in data
+0003b760: 6672 616d 652e 6974 656d 7328 295d 0a0a  frame.items()]..
+0003b770: 2020 2020 2020 2020 696e 6465 7865 733a          indexes:
+0003b780: 2064 6963 745b 4861 7368 6162 6c65 2c20   dict[Hashable, 
+0003b790: 496e 6465 785d 203d 207b 7d0a 2020 2020  Index] = {}.    
+0003b7a0: 2020 2020 696e 6465 785f 7661 7273 3a20      index_vars: 
+0003b7b0: 6469 6374 5b48 6173 6861 626c 652c 2056  dict[Hashable, V
+0003b7c0: 6172 6961 626c 655d 203d 207b 7d0a 0a20  ariable] = {}.. 
+0003b7d0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+0003b7e0: 616e 6365 2869 6478 2c20 7064 2e4d 756c  ance(idx, pd.Mul
+0003b7f0: 7469 496e 6465 7829 3a0a 2020 2020 2020  tiIndex):.      
+0003b800: 2020 2020 2020 6469 6d73 203d 2074 7570        dims = tup
+0003b810: 6c65 280a 2020 2020 2020 2020 2020 2020  le(.            
+0003b820: 2020 2020 6e61 6d65 2069 6620 6e61 6d65      name if name
+0003b830: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+0003b840: 6520 226c 6576 656c 5f25 6922 2025 206e  e "level_%i" % n
+0003b850: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003b860: 2066 6f72 206e 2c20 6e61 6d65 2069 6e20   for n, name in 
+0003b870: 656e 756d 6572 6174 6528 6964 782e 6e61  enumerate(idx.na
+0003b880: 6d65 7329 0a20 2020 2020 2020 2020 2020  mes).           
+0003b890: 2029 0a20 2020 2020 2020 2020 2020 2066   ).            f
+0003b8a0: 6f72 2064 696d 2c20 6c65 7620 696e 207a  or dim, lev in z
+0003b8b0: 6970 2864 696d 732c 2069 6478 2e6c 6576  ip(dims, idx.lev
+0003b8c0: 656c 7329 3a0a 2020 2020 2020 2020 2020  els):.          
+0003b8d0: 2020 2020 2020 7872 5f69 6478 203d 2050        xr_idx = P
+0003b8e0: 616e 6461 7349 6e64 6578 286c 6576 2c20  andasIndex(lev, 
+0003b8f0: 6469 6d29 0a20 2020 2020 2020 2020 2020  dim).           
+0003b900: 2020 2020 2069 6e64 6578 6573 5b64 696d       indexes[dim
+0003b910: 5d20 3d20 7872 5f69 6478 0a20 2020 2020  ] = xr_idx.     
 0003b920: 2020 2020 2020 2020 2020 2069 6e64 6578             index
 0003b930: 5f76 6172 732e 7570 6461 7465 2878 725f  _vars.update(xr_
 0003b940: 6964 782e 6372 6561 7465 5f76 6172 6961  idx.create_varia
-0003b950: 626c 6573 2829 290a 0a20 2020 2020 2020  bles())..       
-0003b960: 206f 626a 203d 2063 6c73 2e5f 636f 6e73   obj = cls._cons
-0003b970: 7472 7563 745f 6469 7265 6374 2869 6e64  truct_direct(ind
-0003b980: 6578 5f76 6172 732c 2073 6574 2869 6e64  ex_vars, set(ind
-0003b990: 6578 5f76 6172 7329 2c20 696e 6465 7865  ex_vars), indexe
-0003b9a0: 733d 696e 6465 7865 7329 0a0a 2020 2020  s=indexes)..    
-0003b9b0: 2020 2020 6966 2073 7061 7273 653a 0a20      if sparse:. 
-0003b9c0: 2020 2020 2020 2020 2020 206f 626a 2e5f             obj._
-0003b9d0: 7365 745f 7370 6172 7365 5f64 6174 615f  set_sparse_data_
-0003b9e0: 6672 6f6d 5f64 6174 6166 7261 6d65 2869  from_dataframe(i
-0003b9f0: 6478 2c20 6172 7261 7973 2c20 6469 6d73  dx, arrays, dims
-0003ba00: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-0003ba10: 2020 2020 2020 2020 2020 2020 6f62 6a2e              obj.
-0003ba20: 5f73 6574 5f6e 756d 7079 5f64 6174 615f  _set_numpy_data_
-0003ba30: 6672 6f6d 5f64 6174 6166 7261 6d65 2869  from_dataframe(i
-0003ba40: 6478 2c20 6172 7261 7973 2c20 6469 6d73  dx, arrays, dims
-0003ba50: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-0003ba60: 206f 626a 0a0a 2020 2020 6465 6620 746f   obj..    def to
-0003ba70: 5f64 6173 6b5f 6461 7461 6672 616d 6528  _dask_dataframe(
-0003ba80: 0a20 2020 2020 2020 2073 656c 662c 2064  .        self, d
-0003ba90: 696d 5f6f 7264 6572 3a20 5365 7175 656e  im_order: Sequen
-0003baa0: 6365 5b48 6173 6861 626c 655d 207c 204e  ce[Hashable] | N
-0003bab0: 6f6e 6520 3d20 4e6f 6e65 2c20 7365 745f  one = None, set_
-0003bac0: 696e 6465 783a 2062 6f6f 6c20 3d20 4661  index: bool = Fa
-0003bad0: 6c73 650a 2020 2020 2920 2d3e 2044 6173  lse.    ) -> Das
-0003bae0: 6b44 6174 6146 7261 6d65 3a0a 2020 2020  kDataFrame:.    
-0003baf0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-0003bb00: 436f 6e76 6572 7420 7468 6973 2064 6174  Convert this dat
-0003bb10: 6173 6574 2069 6e74 6f20 6120 6461 736b  aset into a dask
-0003bb20: 2e64 6174 6166 7261 6d65 2e44 6174 6146  .dataframe.DataF
-0003bb30: 7261 6d65 2e0a 0a20 2020 2020 2020 2054  rame...        T
-0003bb40: 6865 2064 696d 656e 7369 6f6e 732c 2063  he dimensions, c
-0003bb50: 6f6f 7264 696e 6174 6573 2061 6e64 2064  oordinates and d
-0003bb60: 6174 6120 7661 7269 6162 6c65 7320 696e  ata variables in
-0003bb70: 2074 6869 7320 6461 7461 7365 7420 666f   this dataset fo
-0003bb80: 726d 0a20 2020 2020 2020 2074 6865 2063  rm.        the c
-0003bb90: 6f6c 756d 6e73 206f 6620 7468 6520 4461  olumns of the Da
-0003bba0: 7461 4672 616d 652e 0a0a 2020 2020 2020  taFrame...      
-0003bbb0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0003bbc0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0003bbd0: 2020 2020 2020 2020 6469 6d5f 6f72 6465          dim_orde
-0003bbe0: 7220 3a20 6c69 7374 2c20 6f70 7469 6f6e  r : list, option
-0003bbf0: 616c 0a20 2020 2020 2020 2020 2020 2048  al.            H
-0003bc00: 6965 7261 7263 6869 6361 6c20 6469 6d65  ierarchical dime
-0003bc10: 6e73 696f 6e20 6f72 6465 7220 666f 7220  nsion order for 
-0003bc20: 7468 6520 7265 7375 6c74 696e 6720 6461  the resulting da
-0003bc30: 7461 6672 616d 652e 2041 6c6c 0a20 2020  taframe. All.   
-0003bc40: 2020 2020 2020 2020 2061 7272 6179 7320           arrays 
-0003bc50: 6172 6520 7472 616e 7370 6f73 6564 2074  are transposed t
-0003bc60: 6f20 7468 6973 206f 7264 6572 2061 6e64  o this order and
-0003bc70: 2074 6865 6e20 7772 6974 7465 6e20 6f75   then written ou
-0003bc80: 7420 6173 2066 6c61 740a 2020 2020 2020  t as flat.      
-0003bc90: 2020 2020 2020 7665 6374 6f72 7320 696e        vectors in
-0003bca0: 2063 6f6e 7469 6775 6f75 7320 6f72 6465   contiguous orde
-0003bcb0: 722c 2073 6f20 7468 6520 6c61 7374 2064  r, so the last d
-0003bcc0: 696d 656e 7369 6f6e 2069 6e20 7468 6973  imension in this
-0003bcd0: 206c 6973 740a 2020 2020 2020 2020 2020   list.          
-0003bce0: 2020 7769 6c6c 2062 6520 636f 6e74 6967    will be contig
-0003bcf0: 756f 7573 2069 6e20 7468 6520 7265 7375  uous in the resu
-0003bd00: 6c74 696e 6720 4461 7461 4672 616d 652e  lting DataFrame.
-0003bd10: 2054 6869 7320 6861 7320 6120 6d61 6a6f   This has a majo
-0003bd20: 720a 2020 2020 2020 2020 2020 2020 696e  r.            in
-0003bd30: 666c 7565 6e63 6520 6f6e 2077 6869 6368  fluence on which
-0003bd40: 206f 7065 7261 7469 6f6e 7320 6172 6520   operations are 
-0003bd50: 6566 6669 6369 656e 7420 6f6e 2074 6865  efficient on the
-0003bd60: 2072 6573 756c 7469 6e67 2064 6173 6b0a   resulting dask.
-0003bd70: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0003bd80: 6672 616d 652e 0a0a 2020 2020 2020 2020  frame...        
-0003bd90: 2020 2020 4966 2070 726f 7669 6465 642c      If provided,
-0003bda0: 206d 7573 7420 696e 636c 7564 6520 616c   must include al
-0003bdb0: 6c20 6469 6d65 6e73 696f 6e73 206f 6620  l dimensions of 
-0003bdc0: 7468 6973 2064 6174 6173 6574 2e20 4279  this dataset. By
-0003bdd0: 0a20 2020 2020 2020 2020 2020 2064 6566  .            def
-0003bde0: 6175 6c74 2c20 6469 6d65 6e73 696f 6e73  ault, dimensions
-0003bdf0: 2061 7265 2073 6f72 7465 6420 616c 7068   are sorted alph
-0003be00: 6162 6574 6963 616c 6c79 2e0a 2020 2020  abetically..    
-0003be10: 2020 2020 7365 745f 696e 6465 7820 3a20      set_index : 
-0003be20: 626f 6f6c 2c20 6465 6661 756c 743a 2046  bool, default: F
-0003be30: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
-0003be40: 2049 6620 7365 745f 696e 6465 783d 5472   If set_index=Tr
-0003be50: 7565 2c20 7468 6520 6461 736b 2044 6174  ue, the dask Dat
-0003be60: 6146 7261 6d65 2069 7320 696e 6465 7865  aFrame is indexe
-0003be70: 6420 6279 2074 6869 7320 6461 7461 7365  d by this datase
-0003be80: 7427 730a 2020 2020 2020 2020 2020 2020  t's.            
-0003be90: 636f 6f72 6469 6e61 7465 2e20 5369 6e63  coordinate. Sinc
-0003bea0: 6520 6461 736b 2044 6174 6146 7261 6d65  e dask DataFrame
-0003beb0: 7320 646f 206e 6f74 2073 7570 706f 7274  s do not support
-0003bec0: 206d 756c 7469 2d69 6e64 6578 6573 2c0a   multi-indexes,.
-0003bed0: 2020 2020 2020 2020 2020 2020 7365 745f              set_
-0003bee0: 696e 6465 7820 6f6e 6c79 2077 6f72 6b73  index only works
-0003bef0: 2069 6620 7468 6520 6461 7461 7365 7420   if the dataset 
-0003bf00: 6f6e 6c79 2063 6f6e 7461 696e 7320 6f6e  only contains on
-0003bf10: 6520 6469 6d65 6e73 696f 6e2e 0a0a 2020  e dimension...  
-0003bf20: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-0003bf30: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-0003bf40: 2020 2020 2020 6461 736b 2e64 6174 6166        dask.dataf
-0003bf50: 7261 6d65 2e44 6174 6146 7261 6d65 0a20  rame.DataFrame. 
-0003bf60: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-0003bf70: 2020 2020 696d 706f 7274 2064 6173 6b2e      import dask.
-0003bf80: 6172 7261 7920 6173 2064 610a 2020 2020  array as da.    
-0003bf90: 2020 2020 696d 706f 7274 2064 6173 6b2e      import dask.
-0003bfa0: 6461 7461 6672 616d 6520 6173 2064 640a  dataframe as dd.
-0003bfb0: 0a20 2020 2020 2020 206f 7264 6572 6564  .        ordered
-0003bfc0: 5f64 696d 7320 3d20 7365 6c66 2e5f 6e6f  _dims = self._no
-0003bfd0: 726d 616c 697a 655f 6469 6d5f 6f72 6465  rmalize_dim_orde
-0003bfe0: 7228 6469 6d5f 6f72 6465 723d 6469 6d5f  r(dim_order=dim_
-0003bff0: 6f72 6465 7229 0a0a 2020 2020 2020 2020  order)..        
-0003c000: 636f 6c75 6d6e 7320 3d20 6c69 7374 286f  columns = list(o
-0003c010: 7264 6572 6564 5f64 696d 7329 0a20 2020  rdered_dims).   
-0003c020: 2020 2020 2063 6f6c 756d 6e73 2e65 7874       columns.ext
-0003c030: 656e 6428 6b20 666f 7220 6b20 696e 2073  end(k for k in s
-0003c040: 656c 662e 636f 6f72 6473 2069 6620 6b20  elf.coords if k 
-0003c050: 6e6f 7420 696e 2073 656c 662e 6469 6d73  not in self.dims
-0003c060: 290a 2020 2020 2020 2020 636f 6c75 6d6e  ).        column
-0003c070: 732e 6578 7465 6e64 2873 656c 662e 6461  s.extend(self.da
-0003c080: 7461 5f76 6172 7329 0a0a 2020 2020 2020  ta_vars)..      
-0003c090: 2020 7365 7269 6573 5f6c 6973 7420 3d20    series_list = 
-0003c0a0: 5b5d 0a20 2020 2020 2020 2066 6f72 206e  [].        for n
-0003c0b0: 616d 6520 696e 2063 6f6c 756d 6e73 3a0a  ame in columns:.
-0003c0c0: 2020 2020 2020 2020 2020 2020 7472 793a              try:
-0003c0d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c0e0: 2076 6172 203d 2073 656c 662e 7661 7269   var = self.vari
-0003c0f0: 6162 6c65 735b 6e61 6d65 5d0a 2020 2020  ables[name].    
-0003c100: 2020 2020 2020 2020 6578 6365 7074 204b          except K
-0003c110: 6579 4572 726f 723a 0a20 2020 2020 2020  eyError:.       
-0003c120: 2020 2020 2020 2020 2023 2064 696d 656e           # dimen
-0003c130: 7369 6f6e 2077 6974 686f 7574 2061 206d  sion without a m
-0003c140: 6174 6368 696e 6720 636f 6f72 6469 6e61  atching coordina
-0003c150: 7465 0a20 2020 2020 2020 2020 2020 2020  te.             
-0003c160: 2020 2073 697a 6520 3d20 7365 6c66 2e64     size = self.d
-0003c170: 696d 735b 6e61 6d65 5d0a 2020 2020 2020  ims[name].      
-0003c180: 2020 2020 2020 2020 2020 6461 7461 203d            data =
-0003c190: 2064 612e 6172 616e 6765 2873 697a 652c   da.arange(size,
-0003c1a0: 2063 6875 6e6b 733d 7369 7a65 2c20 6474   chunks=size, dt
-0003c1b0: 7970 653d 6e70 2e69 6e74 3634 290a 2020  ype=np.int64).  
-0003c1c0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0003c1d0: 7220 3d20 5661 7269 6162 6c65 2828 6e61  r = Variable((na
-0003c1e0: 6d65 2c29 2c20 6461 7461 290a 0a20 2020  me,), data)..   
-0003c1f0: 2020 2020 2020 2020 2023 2049 6e64 6578           # Index
-0003c200: 5661 7269 6162 6c65 206f 626a 6563 7473  Variable objects
-0003c210: 2068 6176 6520 6120 6475 6d6d 7920 2e63   have a dummy .c
-0003c220: 6875 6e6b 2829 206d 6574 686f 640a 2020  hunk() method.  
-0003c230: 2020 2020 2020 2020 2020 6966 2069 7369            if isi
-0003c240: 6e73 7461 6e63 6528 7661 722c 2049 6e64  nstance(var, Ind
-0003c250: 6578 5661 7269 6162 6c65 293a 0a20 2020  exVariable):.   
-0003c260: 2020 2020 2020 2020 2020 2020 2076 6172               var
-0003c270: 203d 2076 6172 2e74 6f5f 6261 7365 5f76   = var.to_base_v
-0003c280: 6172 6961 626c 6528 290a 0a20 2020 2020  ariable()..     
-0003c290: 2020 2020 2020 2023 204d 616b 6520 7375         # Make su
-0003c2a0: 7265 2076 6172 2069 7320 6120 6461 736b  re var is a dask
-0003c2b0: 2061 7272 6179 2c20 6f74 6865 7277 6973   array, otherwis
-0003c2c0: 6520 7468 6520 6172 7261 7920 6361 6e20  e the array can 
-0003c2d0: 6265 636f 6d65 2074 6f6f 206c 6172 6765  become too large
-0003c2e0: 0a20 2020 2020 2020 2020 2020 2023 2077  .            # w
-0003c2f0: 6865 6e20 6974 2069 7320 6272 6f61 6463  hen it is broadc
-0003c300: 6173 7465 6420 746f 2073 6576 6572 616c  asted to several
-0003c310: 2064 696d 656e 7369 6f6e 733a 0a20 2020   dimensions:.   
-0003c320: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-0003c330: 6973 5f64 7563 6b5f 6461 736b 5f61 7272  is_duck_dask_arr
-0003c340: 6179 2876 6172 2e5f 6461 7461 293a 0a20  ay(var._data):. 
-0003c350: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0003c360: 6172 203d 2076 6172 2e63 6875 6e6b 2829  ar = var.chunk()
-0003c370: 0a0a 2020 2020 2020 2020 2020 2020 6461  ..            da
-0003c380: 736b 5f61 7272 6179 203d 2076 6172 2e73  sk_array = var.s
-0003c390: 6574 5f64 696d 7328 6f72 6465 7265 645f  et_dims(ordered_
-0003c3a0: 6469 6d73 292e 6368 756e 6b28 7365 6c66  dims).chunk(self
-0003c3b0: 2e63 6875 6e6b 7329 2e64 6174 610a 2020  .chunks).data.  
-0003c3c0: 2020 2020 2020 2020 2020 7365 7269 6573            series
-0003c3d0: 203d 2064 642e 6672 6f6d 5f61 7272 6179   = dd.from_array
-0003c3e0: 2864 6173 6b5f 6172 7261 792e 7265 7368  (dask_array.resh
-0003c3f0: 6170 6528 2d31 292c 2063 6f6c 756d 6e73  ape(-1), columns
-0003c400: 3d5b 6e61 6d65 5d29 0a20 2020 2020 2020  =[name]).       
-0003c410: 2020 2020 2073 6572 6965 735f 6c69 7374       series_list
-0003c420: 2e61 7070 656e 6428 7365 7269 6573 290a  .append(series).
-0003c430: 0a20 2020 2020 2020 2064 6620 3d20 6464  .        df = dd
-0003c440: 2e63 6f6e 6361 7428 7365 7269 6573 5f6c  .concat(series_l
-0003c450: 6973 742c 2061 7869 733d 3129 0a0a 2020  ist, axis=1)..  
-0003c460: 2020 2020 2020 6966 2073 6574 5f69 6e64        if set_ind
-0003c470: 6578 3a0a 2020 2020 2020 2020 2020 2020  ex:.            
-0003c480: 6469 6d5f 6f72 6465 7220 3d20 5b2a 6f72  dim_order = [*or
-0003c490: 6465 7265 645f 6469 6d73 5d0a 0a20 2020  dered_dims]..   
-0003c4a0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
-0003c4b0: 6469 6d5f 6f72 6465 7229 203d 3d20 313a  dim_order) == 1:
-0003c4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003c4d0: 2028 6469 6d2c 2920 3d20 6469 6d5f 6f72   (dim,) = dim_or
-0003c4e0: 6465 720a 2020 2020 2020 2020 2020 2020  der.            
-0003c4f0: 2020 2020 6466 203d 2064 662e 7365 745f      df = df.set_
-0003c500: 696e 6465 7828 6469 6d29 0a20 2020 2020  index(dim).     
-0003c510: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0003c520: 2020 2020 2020 2020 2020 2020 2023 2074               # t
-0003c530: 7269 6767 6572 7320 616e 2065 7272 6f72  riggers an error
-0003c540: 2061 626f 7574 206d 756c 7469 2d69 6e64   about multi-ind
-0003c550: 6578 6573 2c20 6576 656e 2069 6620 6f6e  exes, even if on
-0003c560: 6c79 206f 6e65 0a20 2020 2020 2020 2020  ly one.         
-0003c570: 2020 2020 2020 2023 2064 696d 656e 7369         # dimensi
-0003c580: 6f6e 2069 7320 7061 7373 6564 0a20 2020  on is passed.   
-0003c590: 2020 2020 2020 2020 2020 2020 2064 6620               df 
-0003c5a0: 3d20 6466 2e73 6574 5f69 6e64 6578 2864  = df.set_index(d
-0003c5b0: 696d 5f6f 7264 6572 290a 0a20 2020 2020  im_order)..     
-0003c5c0: 2020 2072 6574 7572 6e20 6466 0a0a 2020     return df..  
-0003c5d0: 2020 6465 6620 746f 5f64 6963 7428 0a20    def to_dict(. 
-0003c5e0: 2020 2020 2020 2073 656c 662c 2064 6174         self, dat
-0003c5f0: 613a 2062 6f6f 6c20 7c20 4c69 7465 7261  a: bool | Litera
-0003c600: 6c5b 226c 6973 7422 2c20 2261 7272 6179  l["list", "array
-0003c610: 225d 203d 2022 6c69 7374 222c 2065 6e63  "] = "list", enc
-0003c620: 6f64 696e 673a 2062 6f6f 6c20 3d20 4661  oding: bool = Fa
-0003c630: 6c73 650a 2020 2020 2920 2d3e 2064 6963  lse.    ) -> dic
-0003c640: 745b 7374 722c 2041 6e79 5d3a 0a20 2020  t[str, Any]:.   
-0003c650: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0003c660: 2043 6f6e 7665 7274 2074 6869 7320 6461   Convert this da
-0003c670: 7461 7365 7420 746f 2061 2064 6963 7469  taset to a dicti
-0003c680: 6f6e 6172 7920 666f 6c6c 6f77 696e 6720  onary following 
-0003c690: 7861 7272 6179 206e 616d 696e 670a 2020  xarray naming.  
-0003c6a0: 2020 2020 2020 636f 6e76 656e 7469 6f6e        convention
-0003c6b0: 732e 0a0a 2020 2020 2020 2020 436f 6e76  s...        Conv
-0003c6c0: 6572 7473 2061 6c6c 2076 6172 6961 626c  erts all variabl
-0003c6d0: 6573 2061 6e64 2061 7474 7269 6275 7465  es and attribute
-0003c6e0: 7320 746f 206e 6174 6976 6520 5079 7468  s to native Pyth
-0003c6f0: 6f6e 206f 626a 6563 7473 0a20 2020 2020  on objects.     
-0003c700: 2020 2055 7365 6675 6c20 666f 7220 636f     Useful for co
-0003c710: 6e76 6572 7469 6e67 2074 6f20 6a73 6f6e  nverting to json
-0003c720: 2e20 546f 2061 766f 6964 2064 6174 6574  . To avoid datet
-0003c730: 696d 6520 696e 636f 6d70 6174 6962 696c  ime incompatibil
-0003c740: 6974 790a 2020 2020 2020 2020 7573 6520  ity.        use 
-0003c750: 6465 636f 6465 5f74 696d 6573 3d46 616c  decode_times=Fal
-0003c760: 7365 206b 7761 7267 2069 6e20 7861 7272  se kwarg in xarr
-0003c770: 7261 792e 6f70 656e 5f64 6174 6173 6574  ray.open_dataset
-0003c780: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0003c790: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-0003c7a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0003c7b0: 2064 6174 6120 3a20 626f 6f6c 206f 7220   data : bool or 
-0003c7c0: 7b22 6c69 7374 222c 2022 6172 7261 7922  {"list", "array"
-0003c7d0: 7d2c 2064 6566 6175 6c74 3a20 226c 6973  }, default: "lis
-0003c7e0: 7422 0a20 2020 2020 2020 2020 2020 2057  t".            W
-0003c7f0: 6865 7468 6572 2074 6f20 696e 636c 7564  hether to includ
-0003c800: 6520 7468 6520 6163 7475 616c 2064 6174  e the actual dat
-0003c810: 6120 696e 2074 6865 2064 6963 7469 6f6e  a in the diction
-0003c820: 6172 792e 2057 6865 6e20 7365 7420 746f  ary. When set to
-0003c830: 0a20 2020 2020 2020 2020 2020 2046 616c  .            Fal
-0003c840: 7365 2c20 7265 7475 726e 7320 6a75 7374  se, returns just
-0003c850: 2074 6865 2073 6368 656d 612e 2049 6620   the schema. If 
-0003c860: 7365 7420 746f 2022 6172 7261 7922 2c20  set to "array", 
-0003c870: 7265 7475 726e 7320 6461 7461 2061 730a  returns data as.
-0003c880: 2020 2020 2020 2020 2020 2020 756e 6465              unde
-0003c890: 726c 7969 6e67 2061 7272 6179 2074 7970  rlying array typ
-0003c8a0: 652e 2049 6620 7365 7420 746f 2022 6c69  e. If set to "li
-0003c8b0: 7374 2220 286f 7220 5472 7565 2066 6f72  st" (or True for
-0003c8c0: 2062 6163 6b77 6172 6473 0a20 2020 2020   backwards.     
-0003c8d0: 2020 2020 2020 2063 6f6d 7061 7469 6269         compatibi
-0003c8e0: 6c69 7479 292c 2072 6574 7572 6e73 2064  lity), returns d
-0003c8f0: 6174 6120 696e 206c 6973 7473 206f 6620  ata in lists of 
-0003c900: 5079 7468 6f6e 2064 6174 6120 7479 7065  Python data type
-0003c910: 732e 204e 6f74 650a 2020 2020 2020 2020  s. Note.        
-0003c920: 2020 2020 7468 6174 2066 6f72 206f 6274      that for obt
-0003c930: 6169 6e69 6e67 2074 6865 2022 6c69 7374  aining the "list
-0003c940: 2220 6f75 7470 7574 2065 6666 6963 6965  " output efficie
-0003c950: 6e74 6c79 2c20 7573 650a 2020 2020 2020  ntly, use.      
-0003c960: 2020 2020 2020 6064 732e 636f 6d70 7574        `ds.comput
-0003c970: 6528 292e 746f 5f64 6963 7428 6461 7461  e().to_dict(data
-0003c980: 3d22 6c69 7374 2229 602e 0a0a 2020 2020  ="list")`...    
-0003c990: 2020 2020 656e 636f 6469 6e67 203a 2062      encoding : b
-0003c9a0: 6f6f 6c2c 2064 6566 6175 6c74 3a20 4661  ool, default: Fa
-0003c9b0: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-0003c9c0: 5768 6574 6865 7220 746f 2069 6e63 6c75  Whether to inclu
-0003c9d0: 6465 2074 6865 2044 6174 6173 6574 2773  de the Dataset's
-0003c9e0: 2065 6e63 6f64 696e 6720 696e 2074 6865   encoding in the
-0003c9f0: 2064 6963 7469 6f6e 6172 792e 0a0a 2020   dictionary...  
-0003ca00: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-0003ca10: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-0003ca20: 2020 2020 2020 6420 3a20 6469 6374 0a20        d : dict. 
-0003ca30: 2020 2020 2020 2020 2020 2044 6963 7420             Dict 
-0003ca40: 7769 7468 206b 6579 733a 2022 636f 6f72  with keys: "coor
-0003ca50: 6473 222c 2022 6174 7472 7322 2c20 2264  ds", "attrs", "d
-0003ca60: 696d 7322 2c20 2264 6174 615f 7661 7273  ims", "data_vars
-0003ca70: 2220 616e 6420 6f70 7469 6f6e 616c 6c79  " and optionally
-0003ca80: 0a20 2020 2020 2020 2020 2020 2022 656e  .            "en
-0003ca90: 636f 6469 6e67 222e 0a0a 2020 2020 2020  coding"...      
-0003caa0: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-0003cab0: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-0003cac0: 2020 2020 4461 7461 7365 742e 6672 6f6d      Dataset.from
-0003cad0: 5f64 6963 740a 2020 2020 2020 2020 4461  _dict.        Da
-0003cae0: 7461 4172 7261 792e 746f 5f64 6963 740a  taArray.to_dict.
-0003caf0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0003cb00: 2020 2020 643a 2064 6963 7420 3d20 7b0a      d: dict = {.
-0003cb10: 2020 2020 2020 2020 2020 2020 2263 6f6f              "coo
-0003cb20: 7264 7322 3a20 7b7d 2c0a 2020 2020 2020  rds": {},.      
-0003cb30: 2020 2020 2020 2261 7474 7273 223a 2064        "attrs": d
-0003cb40: 6563 6f64 655f 6e75 6d70 795f 6469 6374  ecode_numpy_dict
-0003cb50: 5f76 616c 7565 7328 7365 6c66 2e61 7474  _values(self.att
-0003cb60: 7273 292c 0a20 2020 2020 2020 2020 2020  rs),.           
-0003cb70: 2022 6469 6d73 223a 2064 6963 7428 7365   "dims": dict(se
-0003cb80: 6c66 2e64 696d 7329 2c0a 2020 2020 2020  lf.dims),.      
-0003cb90: 2020 2020 2020 2264 6174 615f 7661 7273        "data_vars
-0003cba0: 223a 207b 7d2c 0a20 2020 2020 2020 207d  ": {},.        }
-0003cbb0: 0a20 2020 2020 2020 2066 6f72 206b 2069  .        for k i
-0003cbc0: 6e20 7365 6c66 2e63 6f6f 7264 733a 0a20  n self.coords:. 
-0003cbd0: 2020 2020 2020 2020 2020 2064 5b22 636f             d["co
-0003cbe0: 6f72 6473 225d 2e75 7064 6174 6528 0a20  ords"].update(. 
-0003cbf0: 2020 2020 2020 2020 2020 2020 2020 207b                 {
-0003cc00: 6b3a 2073 656c 665b 6b5d 2e76 6172 6961  k: self[k].varia
-0003cc10: 626c 652e 746f 5f64 6963 7428 6461 7461  ble.to_dict(data
-0003cc20: 3d64 6174 612c 2065 6e63 6f64 696e 673d  =data, encoding=
-0003cc30: 656e 636f 6469 6e67 297d 0a20 2020 2020  encoding)}.     
-0003cc40: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0003cc50: 2066 6f72 206b 2069 6e20 7365 6c66 2e64   for k in self.d
-0003cc60: 6174 615f 7661 7273 3a0a 2020 2020 2020  ata_vars:.      
-0003cc70: 2020 2020 2020 645b 2264 6174 615f 7661        d["data_va
-0003cc80: 7273 225d 2e75 7064 6174 6528 0a20 2020  rs"].update(.   
-0003cc90: 2020 2020 2020 2020 2020 2020 207b 6b3a               {k:
-0003cca0: 2073 656c 665b 6b5d 2e76 6172 6961 626c   self[k].variabl
-0003ccb0: 652e 746f 5f64 6963 7428 6461 7461 3d64  e.to_dict(data=d
-0003ccc0: 6174 612c 2065 6e63 6f64 696e 673d 656e  ata, encoding=en
-0003ccd0: 636f 6469 6e67 297d 0a20 2020 2020 2020  coding)}.       
-0003cce0: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
-0003ccf0: 6620 656e 636f 6469 6e67 3a0a 2020 2020  f encoding:.    
-0003cd00: 2020 2020 2020 2020 645b 2265 6e63 6f64          d["encod
-0003cd10: 696e 6722 5d20 3d20 6469 6374 2873 656c  ing"] = dict(sel
-0003cd20: 662e 656e 636f 6469 6e67 290a 2020 2020  f.encoding).    
-0003cd30: 2020 2020 7265 7475 726e 2064 0a0a 2020      return d..  
-0003cd40: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
-0003cd50: 2020 2064 6566 2066 726f 6d5f 6469 6374     def from_dict
-0003cd60: 2863 6c73 3a20 7479 7065 5b54 5f44 6174  (cls: type[T_Dat
-0003cd70: 6173 6574 5d2c 2064 3a20 4d61 7070 696e  aset], d: Mappin
-0003cd80: 675b 416e 792c 2041 6e79 5d29 202d 3e20  g[Any, Any]) -> 
-0003cd90: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
-0003cda0: 2020 2022 2222 436f 6e76 6572 7420 6120     """Convert a 
-0003cdb0: 6469 6374 696f 6e61 7279 2069 6e74 6f20  dictionary into 
-0003cdc0: 616e 2078 6172 7261 792e 4461 7461 7365  an xarray.Datase
-0003cdd0: 742e 0a0a 2020 2020 2020 2020 5061 7261  t...        Para
-0003cde0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-0003cdf0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-0003ce00: 2020 6420 3a20 6469 6374 2d6c 696b 650a    d : dict-like.
-0003ce10: 2020 2020 2020 2020 2020 2020 4d61 7070              Mapp
-0003ce20: 696e 6720 7769 7468 2061 206d 696e 696d  ing with a minim
-0003ce30: 756d 2073 7472 7563 7475 7265 206f 660a  um structure of.
-0003ce40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ce50: 6060 7b22 7661 725f 3022 3a20 7b22 6469  ``{"var_0": {"di
-0003ce60: 6d73 223a 205b 2e2e 5d2c 2022 6461 7461  ms": [..], "data
-0003ce70: 223a 205b 2e2e 5d7d 2c20 5c0a 2020 2020  ": [..]}, \.    
-0003ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003ce90: 2020 2020 2020 2020 2e2e 2e7d 6060 0a0a          ...}``..
-0003cea0: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-0003ceb0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-0003cec0: 2020 2020 2020 2020 6f62 6a20 3a20 4461          obj : Da
-0003ced0: 7461 7365 740a 0a20 2020 2020 2020 2053  taset..        S
-0003cee0: 6565 2061 6c73 6f0a 2020 2020 2020 2020  ee also.        
-0003cef0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0003cf00: 2044 6174 6173 6574 2e74 6f5f 6469 6374   Dataset.to_dict
-0003cf10: 0a20 2020 2020 2020 2044 6174 6141 7272  .        DataArr
-0003cf20: 6179 2e66 726f 6d5f 6469 6374 0a0a 2020  ay.from_dict..  
-0003cf30: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-0003cf40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-0003cf50: 2020 2020 2020 2020 3e3e 3e20 6420 3d20          >>> d = 
-0003cf60: 7b0a 2020 2020 2020 2020 2e2e 2e20 2020  {.        ...   
-0003cf70: 2020 2274 223a 207b 2264 696d 7322 3a20    "t": {"dims": 
-0003cf80: 2822 7422 292c 2022 6461 7461 223a 205b  ("t"), "data": [
-0003cf90: 302c 2031 2c20 325d 7d2c 0a20 2020 2020  0, 1, 2]},.     
-0003cfa0: 2020 202e 2e2e 2020 2020 2022 6122 3a20     ...     "a": 
-0003cfb0: 7b22 6469 6d73 223a 2028 2274 2229 2c20  {"dims": ("t"), 
-0003cfc0: 2264 6174 6122 3a20 5b22 6122 2c20 2262  "data": ["a", "b
-0003cfd0: 222c 2022 6322 5d7d 2c0a 2020 2020 2020  ", "c"]},.      
-0003cfe0: 2020 2e2e 2e20 2020 2020 2262 223a 207b    ...     "b": {
-0003cff0: 2264 696d 7322 3a20 2822 7422 292c 2022  "dims": ("t"), "
-0003d000: 6461 7461 223a 205b 3130 2c20 3230 2c20  data": [10, 20, 
-0003d010: 3330 5d7d 2c0a 2020 2020 2020 2020 2e2e  30]},.        ..
-0003d020: 2e20 7d0a 2020 2020 2020 2020 3e3e 3e20  . }.        >>> 
-0003d030: 6473 203d 2078 722e 4461 7461 7365 742e  ds = xr.Dataset.
-0003d040: 6672 6f6d 5f64 6963 7428 6429 0a20 2020  from_dict(d).   
-0003d050: 2020 2020 203e 3e3e 2064 730a 2020 2020       >>> ds.    
-0003d060: 2020 2020 3c78 6172 7261 792e 4461 7461      <xarray.Data
-0003d070: 7365 743e 0a20 2020 2020 2020 2044 696d  set>.        Dim
-0003d080: 656e 7369 6f6e 733a 2020 2874 3a20 3329  ensions:  (t: 3)
-0003d090: 0a20 2020 2020 2020 2043 6f6f 7264 696e  .        Coordin
-0003d0a0: 6174 6573 3a0a 2020 2020 2020 2020 2020  ates:.          
-0003d0b0: 2a20 7420 2020 2020 2020 2028 7429 2069  * t        (t) i
-0003d0c0: 6e74 3634 2030 2031 2032 0a20 2020 2020  nt64 0 1 2.     
-0003d0d0: 2020 2044 6174 6120 7661 7269 6162 6c65     Data variable
-0003d0e0: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
-0003d0f0: 2020 2020 2020 2020 2874 2920 3c55 3120          (t) <U1 
-0003d100: 2761 2720 2762 2720 2763 270a 2020 2020  'a' 'b' 'c'.    
-0003d110: 2020 2020 2020 2020 6220 2020 2020 2020          b       
-0003d120: 2028 7429 2069 6e74 3634 2031 3020 3230   (t) int64 10 20
-0003d130: 2033 300a 0a20 2020 2020 2020 203e 3e3e   30..        >>>
-0003d140: 2064 203d 207b 0a20 2020 2020 2020 202e   d = {.        .
-0003d150: 2e2e 2020 2020 2022 636f 6f72 6473 223a  ..     "coords":
-0003d160: 207b 0a20 2020 2020 2020 202e 2e2e 2020   {.        ...  
-0003d170: 2020 2020 2020 2022 7422 3a20 7b22 6469         "t": {"di
-0003d180: 6d73 223a 2022 7422 2c20 2264 6174 6122  ms": "t", "data"
-0003d190: 3a20 5b30 2c20 312c 2032 5d2c 2022 6174  : [0, 1, 2], "at
-0003d1a0: 7472 7322 3a20 7b22 756e 6974 7322 3a20  trs": {"units": 
-0003d1b0: 2273 227d 7d0a 2020 2020 2020 2020 2e2e  "s"}}.        ..
-0003d1c0: 2e20 2020 2020 7d2c 0a20 2020 2020 2020  .     },.       
-0003d1d0: 202e 2e2e 2020 2020 2022 6174 7472 7322   ...     "attrs"
-0003d1e0: 3a20 7b22 7469 746c 6522 3a20 2261 6972  : {"title": "air
-0003d1f0: 2074 656d 7065 7261 7475 7265 227d 2c0a   temperature"},.
-0003d200: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0003d210: 2264 696d 7322 3a20 2274 222c 0a20 2020  "dims": "t",.   
-0003d220: 2020 2020 202e 2e2e 2020 2020 2022 6461       ...     "da
-0003d230: 7461 5f76 6172 7322 3a20 7b0a 2020 2020  ta_vars": {.    
-0003d240: 2020 2020 2e2e 2e20 2020 2020 2020 2020      ...         
-0003d250: 2261 223a 207b 2264 696d 7322 3a20 2274  "a": {"dims": "t
-0003d260: 222c 2022 6461 7461 223a 205b 3130 2c20  ", "data": [10, 
-0003d270: 3230 2c20 3330 5d7d 2c0a 2020 2020 2020  20, 30]},.      
-0003d280: 2020 2e2e 2e20 2020 2020 2020 2020 2262    ...         "b
-0003d290: 223a 207b 2264 696d 7322 3a20 2274 222c  ": {"dims": "t",
-0003d2a0: 2022 6461 7461 223a 205b 2261 222c 2022   "data": ["a", "
-0003d2b0: 6222 2c20 2263 225d 7d2c 0a20 2020 2020  b", "c"]},.     
-0003d2c0: 2020 202e 2e2e 2020 2020 207d 2c0a 2020     ...     },.  
-0003d2d0: 2020 2020 2020 2e2e 2e20 7d0a 2020 2020        ... }.    
-0003d2e0: 2020 2020 3e3e 3e20 6473 203d 2078 722e      >>> ds = xr.
-0003d2f0: 4461 7461 7365 742e 6672 6f6d 5f64 6963  Dataset.from_dic
-0003d300: 7428 6429 0a20 2020 2020 2020 203e 3e3e  t(d).        >>>
-0003d310: 2064 730a 2020 2020 2020 2020 3c78 6172   ds.        <xar
-0003d320: 7261 792e 4461 7461 7365 743e 0a20 2020  ray.Dataset>.   
-0003d330: 2020 2020 2044 696d 656e 7369 6f6e 733a       Dimensions:
-0003d340: 2020 2874 3a20 3329 0a20 2020 2020 2020    (t: 3).       
-0003d350: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
-0003d360: 2020 2020 2020 2020 2a20 7420 2020 2020          * t     
-0003d370: 2020 2028 7429 2069 6e74 3634 2030 2031     (t) int64 0 1
-0003d380: 2032 0a20 2020 2020 2020 2044 6174 6120   2.        Data 
-0003d390: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
-0003d3a0: 2020 2020 2020 2061 2020 2020 2020 2020         a        
-0003d3b0: 2874 2920 696e 7436 3420 3130 2032 3020  (t) int64 10 20 
-0003d3c0: 3330 0a20 2020 2020 2020 2020 2020 2062  30.            b
-0003d3d0: 2020 2020 2020 2020 2874 2920 3c55 3120          (t) <U1 
-0003d3e0: 2761 2720 2762 2720 2763 270a 2020 2020  'a' 'b' 'c'.    
-0003d3f0: 2020 2020 4174 7472 6962 7574 6573 3a0a      Attributes:.
-0003d400: 2020 2020 2020 2020 2020 2020 7469 746c              titl
-0003d410: 653a 2020 2020 6169 7220 7465 6d70 6572  e:    air temper
-0003d420: 6174 7572 650a 0a20 2020 2020 2020 2022  ature..        "
-0003d430: 2222 0a0a 2020 2020 2020 2020 7661 7269  ""..        vari
-0003d440: 6162 6c65 733a 2049 7465 7261 626c 655b  ables: Iterable[
-0003d450: 7475 706c 655b 4861 7368 6162 6c65 2c20  tuple[Hashable, 
-0003d460: 416e 795d 5d0a 2020 2020 2020 2020 6966  Any]].        if
-0003d470: 206e 6f74 207b 2263 6f6f 7264 7322 2c20   not {"coords", 
-0003d480: 2264 6174 615f 7661 7273 227d 2e69 7373  "data_vars"}.iss
-0003d490: 7562 7365 7428 7365 7428 6429 293a 0a20  ubset(set(d)):. 
-0003d4a0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-0003d4b0: 626c 6573 203d 2064 2e69 7465 6d73 2829  bles = d.items()
-0003d4c0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0003d4d0: 2020 2020 2020 2020 2020 2069 6d70 6f72             impor
-0003d4e0: 7420 6974 6572 746f 6f6c 730a 0a20 2020  t itertools..   
-0003d4f0: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
-0003d500: 6573 203d 2069 7465 7274 6f6f 6c73 2e63  es = itertools.c
-0003d510: 6861 696e 280a 2020 2020 2020 2020 2020  hain(.          
-0003d520: 2020 2020 2020 642e 6765 7428 2263 6f6f        d.get("coo
-0003d530: 7264 7322 2c20 7b7d 292e 6974 656d 7328  rds", {}).items(
-0003d540: 292c 2064 2e67 6574 2822 6461 7461 5f76  ), d.get("data_v
-0003d550: 6172 7322 2c20 7b7d 292e 6974 656d 7328  ars", {}).items(
-0003d560: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-0003d570: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
-0003d580: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
-0003d590: 655f 6469 6374 203d 207b 0a20 2020 2020  e_dict = {.     
-0003d5a0: 2020 2020 2020 2020 2020 206b 3a20 2876             k: (v
-0003d5b0: 5b22 6469 6d73 225d 2c20 765b 2264 6174  ["dims"], v["dat
-0003d5c0: 6122 5d2c 2076 2e67 6574 2822 6174 7472  a"], v.get("attr
-0003d5d0: 7322 292c 2076 2e67 6574 2822 656e 636f  s"), v.get("enco
-0003d5e0: 6469 6e67 2229 290a 2020 2020 2020 2020  ding")).        
-0003d5f0: 2020 2020 2020 2020 666f 7220 6b2c 2076          for k, v
-0003d600: 2069 6e20 7661 7269 6162 6c65 730a 2020   in variables.  
-0003d610: 2020 2020 2020 2020 2020 7d0a 2020 2020            }.    
-0003d620: 2020 2020 6578 6365 7074 204b 6579 4572      except KeyEr
-0003d630: 726f 7220 6173 2065 3a0a 2020 2020 2020  ror as e:.      
-0003d640: 2020 2020 2020 7261 6973 6520 5661 6c75        raise Valu
-0003d650: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
-0003d660: 2020 2020 2020 2020 2263 616e 6e6f 7420          "cannot 
-0003d670: 636f 6e76 6572 7420 6469 6374 2077 6974  convert dict wit
-0003d680: 686f 7574 2074 6865 206b 6579 2022 0a20  hout the key ". 
-0003d690: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003d6a0: 277b 6469 6d73 5f64 6174 617d 2722 2e66  '{dims_data}'".f
-0003d6b0: 6f72 6d61 7428 6469 6d73 5f64 6174 613d  ormat(dims_data=
-0003d6c0: 7374 7228 652e 6172 6773 5b30 5d29 290a  str(e.args[0])).
-0003d6d0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0003d6e0: 2020 2020 2020 6f62 6a20 3d20 636c 7328        obj = cls(
-0003d6f0: 7661 7269 6162 6c65 5f64 6963 7429 0a0a  variable_dict)..
-0003d700: 2020 2020 2020 2020 2320 7768 6174 2069          # what i
-0003d710: 6620 636f 6f72 6473 2061 7265 6e27 7420  f coords aren't 
-0003d720: 6469 6d73 3f0a 2020 2020 2020 2020 636f  dims?.        co
-0003d730: 6f72 6473 203d 2073 6574 2864 2e67 6574  ords = set(d.get
-0003d740: 2822 636f 6f72 6473 222c 207b 7d29 2920  ("coords", {})) 
-0003d750: 2d20 7365 7428 642e 6765 7428 2264 696d  - set(d.get("dim
-0003d760: 7322 2c20 7b7d 2929 0a20 2020 2020 2020  s", {})).       
-0003d770: 206f 626a 203d 206f 626a 2e73 6574 5f63   obj = obj.set_c
-0003d780: 6f6f 7264 7328 636f 6f72 6473 290a 0a20  oords(coords).. 
-0003d790: 2020 2020 2020 206f 626a 2e61 7474 7273         obj.attrs
-0003d7a0: 2e75 7064 6174 6528 642e 6765 7428 2261  .update(d.get("a
-0003d7b0: 7474 7273 222c 207b 7d29 290a 2020 2020  ttrs", {})).    
-0003d7c0: 2020 2020 6f62 6a2e 656e 636f 6469 6e67      obj.encoding
-0003d7d0: 2e75 7064 6174 6528 642e 6765 7428 2265  .update(d.get("e
-0003d7e0: 6e63 6f64 696e 6722 2c20 7b7d 2929 0a0a  ncoding", {}))..
-0003d7f0: 2020 2020 2020 2020 7265 7475 726e 206f          return o
-0003d800: 626a 0a0a 2020 2020 6465 6620 5f75 6e61  bj..    def _una
-0003d810: 7279 5f6f 7028 7365 6c66 3a20 545f 4461  ry_op(self: T_Da
-0003d820: 7461 7365 742c 2066 2c20 2a61 7267 732c  taset, f, *args,
-0003d830: 202a 2a6b 7761 7267 7329 202d 3e20 545f   **kwargs) -> T_
-0003d840: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
-0003d850: 2076 6172 6961 626c 6573 203d 207b 7d0a   variables = {}.
-0003d860: 2020 2020 2020 2020 6b65 6570 5f61 7474          keep_att
-0003d870: 7273 203d 206b 7761 7267 732e 706f 7028  rs = kwargs.pop(
-0003d880: 226b 6565 705f 6174 7472 7322 2c20 4e6f  "keep_attrs", No
-0003d890: 6e65 290a 2020 2020 2020 2020 6966 206b  ne).        if k
-0003d8a0: 6565 705f 6174 7472 7320 6973 204e 6f6e  eep_attrs is Non
-0003d8b0: 653a 0a20 2020 2020 2020 2020 2020 206b  e:.            k
-0003d8c0: 6565 705f 6174 7472 7320 3d20 5f67 6574  eep_attrs = _get
-0003d8d0: 5f6b 6565 705f 6174 7472 7328 6465 6661  _keep_attrs(defa
-0003d8e0: 756c 743d 5472 7565 290a 2020 2020 2020  ult=True).      
-0003d8f0: 2020 666f 7220 6b2c 2076 2069 6e20 7365    for k, v in se
-0003d900: 6c66 2e5f 7661 7269 6162 6c65 732e 6974  lf._variables.it
-0003d910: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-0003d920: 2020 2069 6620 6b20 696e 2073 656c 662e     if k in self.
-0003d930: 5f63 6f6f 7264 5f6e 616d 6573 3a0a 2020  _coord_names:.  
-0003d940: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0003d950: 7269 6162 6c65 735b 6b5d 203d 2076 0a20  riables[k] = v. 
-0003d960: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
-0003d970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003d980: 2076 6172 6961 626c 6573 5b6b 5d20 3d20   variables[k] = 
-0003d990: 6628 762c 202a 6172 6773 2c20 2a2a 6b77  f(v, *args, **kw
-0003d9a0: 6172 6773 290a 2020 2020 2020 2020 2020  args).          
-0003d9b0: 2020 2020 2020 6966 206b 6565 705f 6174        if keep_at
-0003d9c0: 7472 733a 0a20 2020 2020 2020 2020 2020  trs:.           
-0003d9d0: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
-0003d9e0: 6573 5b6b 5d2e 6174 7472 7320 3d20 762e  es[k].attrs = v.
-0003d9f0: 5f61 7474 7273 0a20 2020 2020 2020 2061  _attrs.        a
-0003da00: 7474 7273 203d 2073 656c 662e 5f61 7474  ttrs = self._att
-0003da10: 7273 2069 6620 6b65 6570 5f61 7474 7273  rs if keep_attrs
-0003da20: 2065 6c73 6520 4e6f 6e65 0a20 2020 2020   else None.     
-0003da30: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0003da40: 7265 706c 6163 655f 7769 7468 5f6e 6577  replace_with_new
-0003da50: 5f64 696d 7328 7661 7269 6162 6c65 732c  _dims(variables,
-0003da60: 2061 7474 7273 3d61 7474 7273 290a 0a20   attrs=attrs).. 
-0003da70: 2020 2064 6566 205f 6269 6e61 7279 5f6f     def _binary_o
-0003da80: 7028 7365 6c66 2c20 6f74 6865 722c 2066  p(self, other, f
-0003da90: 2c20 7265 666c 6578 6976 653d 4661 6c73  , reflexive=Fals
-0003daa0: 652c 206a 6f69 6e3d 4e6f 6e65 2920 2d3e  e, join=None) ->
-0003dab0: 2044 6174 6173 6574 3a0a 2020 2020 2020   Dataset:.      
-0003dac0: 2020 6672 6f6d 2078 6172 7261 792e 636f    from xarray.co
-0003dad0: 7265 2e64 6174 6161 7272 6179 2069 6d70  re.dataarray imp
-0003dae0: 6f72 7420 4461 7461 4172 7261 790a 2020  ort DataArray.  
-0003daf0: 2020 2020 2020 6672 6f6d 2078 6172 7261        from xarra
-0003db00: 792e 636f 7265 2e67 726f 7570 6279 2069  y.core.groupby i
-0003db10: 6d70 6f72 7420 4772 6f75 7042 790a 0a20  mport GroupBy.. 
-0003db20: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-0003db30: 616e 6365 286f 7468 6572 2c20 4772 6f75  ance(other, Grou
-0003db40: 7042 7929 3a0a 2020 2020 2020 2020 2020  pBy):.          
-0003db50: 2020 7265 7475 726e 204e 6f74 496d 706c    return NotImpl
-0003db60: 656d 656e 7465 640a 2020 2020 2020 2020  emented.        
-0003db70: 616c 6967 6e5f 7479 7065 203d 204f 5054  align_type = OPT
-0003db80: 494f 4e53 5b22 6172 6974 686d 6574 6963  IONS["arithmetic
-0003db90: 5f6a 6f69 6e22 5d20 6966 206a 6f69 6e20  _join"] if join 
-0003dba0: 6973 204e 6f6e 6520 656c 7365 206a 6f69  is None else joi
-0003dbb0: 6e0a 2020 2020 2020 2020 6966 2069 7369  n.        if isi
-0003dbc0: 6e73 7461 6e63 6528 6f74 6865 722c 2028  nstance(other, (
-0003dbd0: 4461 7461 4172 7261 792c 2044 6174 6173  DataArray, Datas
-0003dbe0: 6574 2929 3a0a 2020 2020 2020 2020 2020  et)):.          
-0003dbf0: 2020 7365 6c66 2c20 6f74 6865 7220 3d20    self, other = 
-0003dc00: 616c 6967 6e28 7365 6c66 2c20 6f74 6865  align(self, othe
-0003dc10: 722c 206a 6f69 6e3d 616c 6967 6e5f 7479  r, join=align_ty
-0003dc20: 7065 2c20 636f 7079 3d46 616c 7365 2920  pe, copy=False) 
-0003dc30: 2023 2074 7970 653a 2069 676e 6f72 655b   # type: ignore[
-0003dc40: 6173 7369 676e 6d65 6e74 5d0a 2020 2020  assignment].    
-0003dc50: 2020 2020 6720 3d20 6620 6966 206e 6f74      g = f if not
-0003dc60: 2072 6566 6c65 7869 7665 2065 6c73 6520   reflexive else 
-0003dc70: 6c61 6d62 6461 2078 2c20 793a 2066 2879  lambda x, y: f(y
-0003dc80: 2c20 7829 0a20 2020 2020 2020 2064 7320  , x).        ds 
-0003dc90: 3d20 7365 6c66 2e5f 6361 6c63 756c 6174  = self._calculat
-0003dca0: 655f 6269 6e61 7279 5f6f 7028 672c 206f  e_binary_op(g, o
-0003dcb0: 7468 6572 2c20 6a6f 696e 3d61 6c69 676e  ther, join=align
-0003dcc0: 5f74 7970 6529 0a20 2020 2020 2020 206b  _type).        k
-0003dcd0: 6565 705f 6174 7472 7320 3d20 5f67 6574  eep_attrs = _get
-0003dce0: 5f6b 6565 705f 6174 7472 7328 6465 6661  _keep_attrs(defa
-0003dcf0: 756c 743d 4661 6c73 6529 0a20 2020 2020  ult=False).     
-0003dd00: 2020 2069 6620 6b65 6570 5f61 7474 7273     if keep_attrs
-0003dd10: 3a0a 2020 2020 2020 2020 2020 2020 6473  :.            ds
-0003dd20: 2e61 7474 7273 203d 2073 656c 662e 6174  .attrs = self.at
-0003dd30: 7472 730a 2020 2020 2020 2020 7265 7475  trs.        retu
-0003dd40: 726e 2064 730a 0a20 2020 2064 6566 205f  rn ds..    def _
-0003dd50: 696e 706c 6163 655f 6269 6e61 7279 5f6f  inplace_binary_o
-0003dd60: 7028 7365 6c66 3a20 545f 4461 7461 7365  p(self: T_Datase
-0003dd70: 742c 206f 7468 6572 2c20 6629 202d 3e20  t, other, f) -> 
-0003dd80: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
-0003dd90: 2020 2066 726f 6d20 7861 7272 6179 2e63     from xarray.c
-0003dda0: 6f72 652e 6461 7461 6172 7261 7920 696d  ore.dataarray im
-0003ddb0: 706f 7274 2044 6174 6141 7272 6179 0a20  port DataArray. 
-0003ddc0: 2020 2020 2020 2066 726f 6d20 7861 7272         from xarr
-0003ddd0: 6179 2e63 6f72 652e 6772 6f75 7062 7920  ay.core.groupby 
-0003dde0: 696d 706f 7274 2047 726f 7570 4279 0a0a  import GroupBy..
-0003ddf0: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0003de00: 7461 6e63 6528 6f74 6865 722c 2047 726f  tance(other, Gro
-0003de10: 7570 4279 293a 0a20 2020 2020 2020 2020  upBy):.         
-0003de20: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0003de30: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
-0003de40: 2020 2020 2269 6e2d 706c 6163 6520 6f70      "in-place op
-0003de50: 6572 6174 696f 6e73 2062 6574 7765 656e  erations between
-0003de60: 2061 2044 6174 6173 6574 2061 6e64 2022   a Dataset and "
-0003de70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003de80: 2022 6120 6772 6f75 7065 6420 6f62 6a65   "a grouped obje
-0003de90: 6374 2061 7265 206e 6f74 2070 6572 6d69  ct are not permi
-0003dea0: 7474 6564 220a 2020 2020 2020 2020 2020  tted".          
-0003deb0: 2020 290a 2020 2020 2020 2020 2320 7765    ).        # we
-0003dec0: 2064 6f6e 2774 2061 6374 7561 6c6c 7920   don't actually 
-0003ded0: 6d6f 6469 6679 2061 7272 6179 7320 696e  modify arrays in
-0003dee0: 2d70 6c61 6365 2077 6974 6820 696e 2d70  -place with in-p
-0003def0: 6c61 6365 2044 6174 6173 6574 0a20 2020  lace Dataset.   
-0003df00: 2020 2020 2023 2061 7269 7468 6d65 7469       # arithmeti
-0003df10: 6320 2d2d 2074 6869 7320 6c65 7473 2075  c -- this lets u
-0003df20: 7320 6175 746f 6d61 7469 6361 6c6c 7920  s automatically 
-0003df30: 616c 6967 6e20 7468 696e 6773 0a20 2020  align things.   
-0003df40: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-0003df50: 6365 286f 7468 6572 2c20 2844 6174 6141  ce(other, (DataA
-0003df60: 7272 6179 2c20 4461 7461 7365 7429 293a  rray, Dataset)):
-0003df70: 0a20 2020 2020 2020 2020 2020 206f 7468  .            oth
-0003df80: 6572 203d 206f 7468 6572 2e72 6569 6e64  er = other.reind
-0003df90: 6578 5f6c 696b 6528 7365 6c66 2c20 636f  ex_like(self, co
-0003dfa0: 7079 3d46 616c 7365 290a 2020 2020 2020  py=False).      
-0003dfb0: 2020 6720 3d20 6f70 732e 696e 706c 6163    g = ops.inplac
-0003dfc0: 655f 746f 5f6e 6f6e 696e 706c 6163 655f  e_to_noninplace_
-0003dfd0: 6f70 2866 290a 2020 2020 2020 2020 6473  op(f).        ds
-0003dfe0: 203d 2073 656c 662e 5f63 616c 6375 6c61   = self._calcula
-0003dff0: 7465 5f62 696e 6172 795f 6f70 2867 2c20  te_binary_op(g, 
-0003e000: 6f74 6865 722c 2069 6e70 6c61 6365 3d54  other, inplace=T
-0003e010: 7275 6529 0a20 2020 2020 2020 2073 656c  rue).        sel
-0003e020: 662e 5f72 6570 6c61 6365 5f77 6974 685f  f._replace_with_
-0003e030: 6e65 775f 6469 6d73 280a 2020 2020 2020  new_dims(.      
-0003e040: 2020 2020 2020 6473 2e5f 7661 7269 6162        ds._variab
-0003e050: 6c65 732c 0a20 2020 2020 2020 2020 2020  les,.           
-0003e060: 2064 732e 5f63 6f6f 7264 5f6e 616d 6573   ds._coord_names
-0003e070: 2c0a 2020 2020 2020 2020 2020 2020 6174  ,.            at
-0003e080: 7472 733d 6473 2e5f 6174 7472 732c 0a20  trs=ds._attrs,. 
-0003e090: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-0003e0a0: 6573 3d64 732e 5f69 6e64 6578 6573 2c0a  es=ds._indexes,.
-0003e0b0: 2020 2020 2020 2020 2020 2020 696e 706c              inpl
-0003e0c0: 6163 653d 5472 7565 2c0a 2020 2020 2020  ace=True,.      
-0003e0d0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-0003e0e0: 726e 2073 656c 660a 0a20 2020 2064 6566  rn self..    def
-0003e0f0: 205f 6361 6c63 756c 6174 655f 6269 6e61   _calculate_bina
-0003e100: 7279 5f6f 7028 0a20 2020 2020 2020 2073  ry_op(.        s
-0003e110: 656c 662c 2066 2c20 6f74 6865 722c 206a  elf, f, other, j
-0003e120: 6f69 6e3d 2269 6e6e 6572 222c 2069 6e70  oin="inner", inp
-0003e130: 6c61 6365 3a20 626f 6f6c 203d 2046 616c  lace: bool = Fal
-0003e140: 7365 0a20 2020 2029 202d 3e20 4461 7461  se.    ) -> Data
-0003e150: 7365 743a 0a20 2020 2020 2020 2064 6566  set:.        def
-0003e160: 2061 7070 6c79 5f6f 7665 725f 626f 7468   apply_over_both
-0003e170: 286c 6873 5f64 6174 615f 7661 7273 2c20  (lhs_data_vars, 
-0003e180: 7268 735f 6461 7461 5f76 6172 732c 206c  rhs_data_vars, l
-0003e190: 6873 5f76 6172 732c 2072 6873 5f76 6172  hs_vars, rhs_var
-0003e1a0: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-0003e1b0: 6966 2069 6e70 6c61 6365 2061 6e64 2073  if inplace and s
-0003e1c0: 6574 286c 6873 5f64 6174 615f 7661 7273  et(lhs_data_vars
-0003e1d0: 2920 213d 2073 6574 2872 6873 5f64 6174  ) != set(rhs_dat
-0003e1e0: 615f 7661 7273 293a 0a20 2020 2020 2020  a_vars):.       
-0003e1f0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0003e200: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-0003e210: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0003e220: 6461 7461 7365 7473 206d 7573 7420 6861  datasets must ha
-0003e230: 7665 2074 6865 2073 616d 6520 6461 7461  ve the same data
-0003e240: 2076 6172 6961 626c 6573 2022 0a20 2020   variables ".   
-0003e250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e260: 2066 2266 6f72 2069 6e2d 706c 6163 6520   f"for in-place 
-0003e270: 6172 6974 686d 6574 6963 206f 7065 7261  arithmetic opera
-0003e280: 7469 6f6e 733a 207b 6c69 7374 286c 6873  tions: {list(lhs
-0003e290: 5f64 6174 615f 7661 7273 297d 2c20 7b6c  _data_vars)}, {l
-0003e2a0: 6973 7428 7268 735f 6461 7461 5f76 6172  ist(rhs_data_var
-0003e2b0: 7329 7d22 0a20 2020 2020 2020 2020 2020  s)}".           
-0003e2c0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0003e2d0: 2020 2020 6465 7374 5f76 6172 7320 3d20      dest_vars = 
-0003e2e0: 7b7d 0a0a 2020 2020 2020 2020 2020 2020  {}..            
-0003e2f0: 666f 7220 6b20 696e 206c 6873 5f64 6174  for k in lhs_dat
-0003e300: 615f 7661 7273 3a0a 2020 2020 2020 2020  a_vars:.        
-0003e310: 2020 2020 2020 2020 6966 206b 2069 6e20          if k in 
-0003e320: 7268 735f 6461 7461 5f76 6172 733a 0a20  rhs_data_vars:. 
-0003e330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e340: 2020 2064 6573 745f 7661 7273 5b6b 5d20     dest_vars[k] 
-0003e350: 3d20 6628 6c68 735f 7661 7273 5b6b 5d2c  = f(lhs_vars[k],
-0003e360: 2072 6873 5f76 6172 735b 6b5d 290a 2020   rhs_vars[k]).  
-0003e370: 2020 2020 2020 2020 2020 2020 2020 656c                el
-0003e380: 6966 206a 6f69 6e20 696e 205b 226c 6566  if join in ["lef
-0003e390: 7422 2c20 226f 7574 6572 225d 3a0a 2020  t", "outer"]:.  
-0003e3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003e3b0: 2020 6465 7374 5f76 6172 735b 6b5d 203d    dest_vars[k] =
-0003e3c0: 2066 286c 6873 5f76 6172 735b 6b5d 2c20   f(lhs_vars[k], 
-0003e3d0: 6e70 2e6e 616e 290a 2020 2020 2020 2020  np.nan).        
-0003e3e0: 2020 2020 666f 7220 6b20 696e 2072 6873      for k in rhs
-0003e3f0: 5f64 6174 615f 7661 7273 3a0a 2020 2020  _data_vars:.    
-0003e400: 2020 2020 2020 2020 2020 2020 6966 206b              if k
-0003e410: 206e 6f74 2069 6e20 6465 7374 5f76 6172   not in dest_var
-0003e420: 7320 616e 6420 6a6f 696e 2069 6e20 5b22  s and join in ["
-0003e430: 7269 6768 7422 2c20 226f 7574 6572 225d  right", "outer"]
-0003e440: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0003e450: 2020 2020 2020 6465 7374 5f76 6172 735b        dest_vars[
-0003e460: 6b5d 203d 2066 2872 6873 5f76 6172 735b  k] = f(rhs_vars[
-0003e470: 6b5d 2c20 6e70 2e6e 616e 290a 2020 2020  k], np.nan).    
-0003e480: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0003e490: 6573 745f 7661 7273 0a0a 2020 2020 2020  est_vars..      
-0003e4a0: 2020 6966 2075 7469 6c73 2e69 735f 6469    if utils.is_di
-0003e4b0: 6374 5f6c 696b 6528 6f74 6865 7229 2061  ct_like(other) a
-0003e4c0: 6e64 206e 6f74 2069 7369 6e73 7461 6e63  nd not isinstanc
-0003e4d0: 6528 6f74 6865 722c 2044 6174 6173 6574  e(other, Dataset
-0003e4e0: 293a 0a20 2020 2020 2020 2020 2020 2023  ):.            #
-0003e4f0: 2063 616e 2774 2075 7365 206f 7572 2073   can't use our s
-0003e500: 686f 7274 6375 7420 6f66 2064 6f69 6e67  hortcut of doing
-0003e510: 2074 6865 2062 696e 6172 7920 6f70 6572   the binary oper
-0003e520: 6174 696f 6e20 7769 7468 0a20 2020 2020  ation with.     
-0003e530: 2020 2020 2020 2023 2056 6172 6961 626c         # Variabl
-0003e540: 6520 6f62 6a65 6374 732c 2073 6f20 6170  e objects, so ap
-0003e550: 706c 7920 6f76 6572 206f 7572 2064 6174  ply over our dat
-0003e560: 6120 7661 7273 2069 6e73 7465 6164 2e0a  a vars instead..
-0003e570: 2020 2020 2020 2020 2020 2020 6e65 775f              new_
-0003e580: 6461 7461 5f76 6172 7320 3d20 6170 706c  data_vars = appl
-0003e590: 795f 6f76 6572 5f62 6f74 6828 0a20 2020  y_over_both(.   
-0003e5a0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0003e5b0: 662e 6461 7461 5f76 6172 732c 206f 7468  f.data_vars, oth
-0003e5c0: 6572 2c20 7365 6c66 2e64 6174 615f 7661  er, self.data_va
-0003e5d0: 7273 2c20 6f74 6865 720a 2020 2020 2020  rs, other.      
-0003e5e0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-0003e5f0: 2020 2020 7265 7475 726e 2074 7970 6528      return type(
-0003e600: 7365 6c66 2928 6e65 775f 6461 7461 5f76  self)(new_data_v
-0003e610: 6172 7329 0a0a 2020 2020 2020 2020 6f74  ars)..        ot
-0003e620: 6865 725f 636f 6f72 6473 3a20 436f 6f72  her_coords: Coor
-0003e630: 6469 6e61 7465 7320 7c20 4e6f 6e65 203d  dinates | None =
-0003e640: 2067 6574 6174 7472 286f 7468 6572 2c20   getattr(other, 
-0003e650: 2263 6f6f 7264 7322 2c20 4e6f 6e65 290a  "coords", None).
-0003e660: 2020 2020 2020 2020 6473 203d 2073 656c          ds = sel
-0003e670: 662e 636f 6f72 6473 2e6d 6572 6765 286f  f.coords.merge(o
-0003e680: 7468 6572 5f63 6f6f 7264 7329 0a0a 2020  ther_coords)..  
-0003e690: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
-0003e6a0: 6e63 6528 6f74 6865 722c 2044 6174 6173  nce(other, Datas
-0003e6b0: 6574 293a 0a20 2020 2020 2020 2020 2020  et):.           
-0003e6c0: 206e 6577 5f76 6172 7320 3d20 6170 706c   new_vars = appl
-0003e6d0: 795f 6f76 6572 5f62 6f74 6828 0a20 2020  y_over_both(.   
-0003e6e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-0003e6f0: 662e 6461 7461 5f76 6172 732c 206f 7468  f.data_vars, oth
-0003e700: 6572 2e64 6174 615f 7661 7273 2c20 7365  er.data_vars, se
-0003e710: 6c66 2e76 6172 6961 626c 6573 2c20 6f74  lf.variables, ot
-0003e720: 6865 722e 7661 7269 6162 6c65 730a 2020  her.variables.  
-0003e730: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0003e740: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0003e750: 2020 2020 2020 6f74 6865 725f 7661 7269        other_vari
-0003e760: 6162 6c65 203d 2067 6574 6174 7472 286f  able = getattr(o
-0003e770: 7468 6572 2c20 2276 6172 6961 626c 6522  ther, "variable"
-0003e780: 2c20 6f74 6865 7229 0a20 2020 2020 2020  , other).       
-0003e790: 2020 2020 206e 6577 5f76 6172 7320 3d20       new_vars = 
-0003e7a0: 7b6b 3a20 6628 7365 6c66 2e76 6172 6961  {k: f(self.varia
-0003e7b0: 626c 6573 5b6b 5d2c 206f 7468 6572 5f76  bles[k], other_v
-0003e7c0: 6172 6961 626c 6529 2066 6f72 206b 2069  ariable) for k i
-0003e7d0: 6e20 7365 6c66 2e64 6174 615f 7661 7273  n self.data_vars
-0003e7e0: 7d0a 2020 2020 2020 2020 6473 2e5f 7661  }.        ds._va
-0003e7f0: 7269 6162 6c65 732e 7570 6461 7465 286e  riables.update(n
-0003e800: 6577 5f76 6172 7329 0a20 2020 2020 2020  ew_vars).       
-0003e810: 2064 732e 5f64 696d 7320 3d20 6361 6c63   ds._dims = calc
-0003e820: 756c 6174 655f 6469 6d65 6e73 696f 6e73  ulate_dimensions
-0003e830: 2864 732e 5f76 6172 6961 626c 6573 290a  (ds._variables).
-0003e840: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0003e850: 730a 0a20 2020 2064 6566 205f 636f 7079  s..    def _copy
-0003e860: 5f61 7474 7273 5f66 726f 6d28 7365 6c66  _attrs_from(self
-0003e870: 2c20 6f74 6865 7229 3a0a 2020 2020 2020  , other):.      
-0003e880: 2020 7365 6c66 2e61 7474 7273 203d 206f    self.attrs = o
-0003e890: 7468 6572 2e61 7474 7273 0a20 2020 2020  ther.attrs.     
-0003e8a0: 2020 2066 6f72 2076 2069 6e20 6f74 6865     for v in othe
-0003e8b0: 722e 7661 7269 6162 6c65 733a 0a20 2020  r.variables:.   
-0003e8c0: 2020 2020 2020 2020 2069 6620 7620 696e           if v in
-0003e8d0: 2073 656c 662e 7661 7269 6162 6c65 733a   self.variables:
-0003e8e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003e8f0: 2073 656c 662e 7661 7269 6162 6c65 735b   self.variables[
-0003e900: 765d 2e61 7474 7273 203d 206f 7468 6572  v].attrs = other
-0003e910: 2e76 6172 6961 626c 6573 5b76 5d2e 6174  .variables[v].at
-0003e920: 7472 730a 0a20 2020 2064 6566 2064 6966  trs..    def dif
-0003e930: 6628 0a20 2020 2020 2020 2073 656c 663a  f(.        self:
-0003e940: 2054 5f44 6174 6173 6574 2c0a 2020 2020   T_Dataset,.    
-0003e950: 2020 2020 6469 6d3a 2048 6173 6861 626c      dim: Hashabl
-0003e960: 652c 0a20 2020 2020 2020 206e 3a20 696e  e,.        n: in
-0003e970: 7420 3d20 312c 0a20 2020 2020 2020 206c  t = 1,.        l
-0003e980: 6162 656c 3a20 4c69 7465 7261 6c5b 2275  abel: Literal["u
-0003e990: 7070 6572 222c 2022 6c6f 7765 7222 5d20  pper", "lower"] 
-0003e9a0: 3d20 2275 7070 6572 222c 0a20 2020 2029  = "upper",.    )
-0003e9b0: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
-0003e9c0: 2020 2020 2020 2022 2222 4361 6c63 756c         """Calcul
-0003e9d0: 6174 6520 7468 6520 6e2d 7468 206f 7264  ate the n-th ord
-0003e9e0: 6572 2064 6973 6372 6574 6520 6469 6666  er discrete diff
-0003e9f0: 6572 656e 6365 2061 6c6f 6e67 2067 6976  erence along giv
-0003ea00: 656e 2061 7869 732e 0a0a 2020 2020 2020  en axis...      
-0003ea10: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0003ea20: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0003ea30: 2020 2020 2020 2020 6469 6d20 3a20 4861          dim : Ha
-0003ea40: 7368 6162 6c65 0a20 2020 2020 2020 2020  shable.         
-0003ea50: 2020 2044 696d 656e 7369 6f6e 206f 7665     Dimension ove
-0003ea60: 7220 7768 6963 6820 746f 2063 616c 6375  r which to calcu
-0003ea70: 6c61 7465 2074 6865 2066 696e 6974 6520  late the finite 
-0003ea80: 6469 6666 6572 656e 6365 2e0a 2020 2020  difference..    
-0003ea90: 2020 2020 6e20 3a20 696e 742c 2064 6566      n : int, def
-0003eaa0: 6175 6c74 3a20 310a 2020 2020 2020 2020  ault: 1.        
-0003eab0: 2020 2020 5468 6520 6e75 6d62 6572 206f      The number o
-0003eac0: 6620 7469 6d65 7320 7661 6c75 6573 2061  f times values a
-0003ead0: 7265 2064 6966 6665 7265 6e63 6564 2e0a  re differenced..
-0003eae0: 2020 2020 2020 2020 6c61 6265 6c20 3a20          label : 
-0003eaf0: 7b22 7570 7065 7222 2c20 226c 6f77 6572  {"upper", "lower
-0003eb00: 227d 2c20 6465 6661 756c 743a 2022 7570  "}, default: "up
-0003eb10: 7065 7222 0a20 2020 2020 2020 2020 2020  per".           
-0003eb20: 2054 6865 206e 6577 2063 6f6f 7264 696e   The new coordin
-0003eb30: 6174 6520 696e 2064 696d 656e 7369 6f6e  ate in dimension
-0003eb40: 2060 6064 696d 6060 2077 696c 6c20 6861   ``dim`` will ha
-0003eb50: 7665 2074 6865 0a20 2020 2020 2020 2020  ve the.         
-0003eb60: 2020 2076 616c 7565 7320 6f66 2065 6974     values of eit
-0003eb70: 6865 7220 7468 6520 6d69 6e75 656e 6427  her the minuend'
-0003eb80: 7320 6f72 2073 7562 7472 6168 656e 6427  s or subtrahend'
-0003eb90: 7320 636f 6f72 6469 6e61 7465 0a20 2020  s coordinate.   
-0003eba0: 2020 2020 2020 2020 2066 6f72 2076 616c           for val
-0003ebb0: 7565 7320 2775 7070 6572 2720 616e 6420  ues 'upper' and 
-0003ebc0: 276c 6f77 6572 272c 2072 6573 7065 6374  'lower', respect
-0003ebd0: 6976 656c 792e 0a0a 2020 2020 2020 2020  ively...        
-0003ebe0: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-0003ebf0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0003ec00: 6469 6666 6572 656e 6365 203a 2044 6174  difference : Dat
-0003ec10: 6173 6574 0a20 2020 2020 2020 2020 2020  aset.           
-0003ec20: 2054 6865 206e 2d74 6820 6f72 6465 7220   The n-th order 
-0003ec30: 6669 6e69 7465 2064 6966 6665 7265 6e63  finite differenc
-0003ec40: 6520 6f66 2074 6869 7320 6f62 6a65 6374  e of this object
-0003ec50: 2e0a 0a20 2020 2020 2020 204e 6f74 6573  ...        Notes
-0003ec60: 0a20 2020 2020 2020 202d 2d2d 2d2d 0a20  .        -----. 
-0003ec70: 2020 2020 2020 2060 6e60 206d 6174 6368         `n` match
-0003ec80: 6573 206e 756d 7079 2773 2062 6568 6176  es numpy's behav
-0003ec90: 696f 7220 616e 6420 6973 2064 6966 6665  ior and is diffe
-0003eca0: 7265 6e74 2066 726f 6d20 7061 6e64 6173  rent from pandas
-0003ecb0: 2720 6669 7273 7420 6172 6775 6d65 6e74  ' first argument
-0003ecc0: 206e 616d 6564 0a20 2020 2020 2020 2060   named.        `
-0003ecd0: 7065 7269 6f64 7360 2e0a 0a20 2020 2020  periods`...     
-0003ece0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-0003ecf0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0003ed00: 2020 2020 203e 3e3e 2064 7320 3d20 7872       >>> ds = xr
-0003ed10: 2e44 6174 6173 6574 287b 2266 6f6f 223a  .Dataset({"foo":
-0003ed20: 2028 2278 222c 205b 352c 2035 2c20 362c   ("x", [5, 5, 6,
-0003ed30: 2036 5d29 7d29 0a20 2020 2020 2020 203e   6])}).        >
-0003ed40: 3e3e 2064 732e 6469 6666 2822 7822 290a  >> ds.diff("x").
-0003ed50: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
-0003ed60: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
-0003ed70: 2044 696d 656e 7369 6f6e 733a 2020 2878   Dimensions:  (x
-0003ed80: 3a20 3329 0a20 2020 2020 2020 2044 696d  : 3).        Dim
-0003ed90: 656e 7369 6f6e 7320 7769 7468 6f75 7420  ensions without 
-0003eda0: 636f 6f72 6469 6e61 7465 733a 2078 0a20  coordinates: x. 
-0003edb0: 2020 2020 2020 2044 6174 6120 7661 7269         Data vari
-0003edc0: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
-0003edd0: 2020 2066 6f6f 2020 2020 2020 2878 2920     foo      (x) 
-0003ede0: 696e 7436 3420 3020 3120 300a 2020 2020  int64 0 1 0.    
-0003edf0: 2020 2020 3e3e 3e20 6473 2e64 6966 6628      >>> ds.diff(
-0003ee00: 2278 222c 2032 290a 2020 2020 2020 2020  "x", 2).        
-0003ee10: 3c78 6172 7261 792e 4461 7461 7365 743e  <xarray.Dataset>
-0003ee20: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
-0003ee30: 6f6e 733a 2020 2878 3a20 3229 0a20 2020  ons:  (x: 2).   
-0003ee40: 2020 2020 2044 696d 656e 7369 6f6e 7320       Dimensions 
-0003ee50: 7769 7468 6f75 7420 636f 6f72 6469 6e61  without coordina
-0003ee60: 7465 733a 2078 0a20 2020 2020 2020 2044  tes: x.        D
-0003ee70: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
-0003ee80: 2020 2020 2020 2020 2020 2066 6f6f 2020             foo  
-0003ee90: 2020 2020 2878 2920 696e 7436 3420 3120      (x) int64 1 
-0003eea0: 2d31 0a0a 2020 2020 2020 2020 5365 6520  -1..        See 
-0003eeb0: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-0003eec0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
-0003eed0: 7461 7365 742e 6469 6666 6572 656e 7469  taset.differenti
-0003eee0: 6174 650a 2020 2020 2020 2020 2222 220a  ate.        """.
-0003eef0: 2020 2020 2020 2020 6966 206e 203d 3d20          if n == 
-0003ef00: 303a 0a20 2020 2020 2020 2020 2020 2072  0:.            r
-0003ef10: 6574 7572 6e20 7365 6c66 0a20 2020 2020  eturn self.     
-0003ef20: 2020 2069 6620 6e20 3c20 303a 0a20 2020     if n < 0:.   
-0003ef30: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0003ef40: 616c 7565 4572 726f 7228 6622 6f72 6465  alueError(f"orde
-0003ef50: 7220 606e 6020 6d75 7374 2062 6520 6e6f  r `n` must be no
-0003ef60: 6e2d 6e65 6761 7469 7665 2062 7574 2067  n-negative but g
-0003ef70: 6f74 207b 6e7d 2229 0a0a 2020 2020 2020  ot {n}")..      
-0003ef80: 2020 2320 7072 6570 6172 6520 736c 6963    # prepare slic
-0003ef90: 6573 0a20 2020 2020 2020 2073 6c69 6365  es.        slice
-0003efa0: 5f73 7461 7274 203d 207b 6469 6d3a 2073  _start = {dim: s
-0003efb0: 6c69 6365 284e 6f6e 652c 202d 3129 7d0a  lice(None, -1)}.
-0003efc0: 2020 2020 2020 2020 736c 6963 655f 656e          slice_en
-0003efd0: 6420 3d20 7b64 696d 3a20 736c 6963 6528  d = {dim: slice(
-0003efe0: 312c 204e 6f6e 6529 7d0a 0a20 2020 2020  1, None)}..     
-0003eff0: 2020 2023 2070 7265 7061 7265 206e 6577     # prepare new
-0003f000: 2063 6f6f 7264 696e 6174 650a 2020 2020   coordinate.    
-0003f010: 2020 2020 6966 206c 6162 656c 203d 3d20      if label == 
-0003f020: 2275 7070 6572 223a 0a20 2020 2020 2020  "upper":.       
-0003f030: 2020 2020 2073 6c69 6365 5f6e 6577 203d       slice_new =
-0003f040: 2073 6c69 6365 5f65 6e64 0a20 2020 2020   slice_end.     
-0003f050: 2020 2065 6c69 6620 6c61 6265 6c20 3d3d     elif label ==
-0003f060: 2022 6c6f 7765 7222 3a0a 2020 2020 2020   "lower":.      
-0003f070: 2020 2020 2020 736c 6963 655f 6e65 7720        slice_new 
-0003f080: 3d20 736c 6963 655f 7374 6172 740a 2020  = slice_start.  
-0003f090: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0003f0a0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0003f0b0: 6c75 6545 7272 6f72 2822 5468 6520 276c  lueError("The 'l
-0003f0c0: 6162 656c 2720 6172 6775 6d65 6e74 2068  abel' argument h
-0003f0d0: 6173 2074 6f20 6265 2065 6974 6865 7220  as to be either 
-0003f0e0: 2775 7070 6572 2720 6f72 2027 6c6f 7765  'upper' or 'lowe
-0003f0f0: 7227 2229 0a0a 2020 2020 2020 2020 696e  r'")..        in
-0003f100: 6465 7865 732c 2069 6e64 6578 5f76 6172  dexes, index_var
-0003f110: 7320 3d20 6973 656c 5f69 6e64 6578 6573  s = isel_indexes
-0003f120: 2873 656c 662e 7869 6e64 6578 6573 2c20  (self.xindexes, 
-0003f130: 736c 6963 655f 6e65 7729 0a20 2020 2020  slice_new).     
-0003f140: 2020 2076 6172 6961 626c 6573 203d 207b     variables = {
-0003f150: 7d0a 0a20 2020 2020 2020 2066 6f72 206e  }..        for n
-0003f160: 616d 652c 2076 6172 2069 6e20 7365 6c66  ame, var in self
-0003f170: 2e76 6172 6961 626c 6573 2e69 7465 6d73  .variables.items
-0003f180: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-0003f190: 6966 206e 616d 6520 696e 2069 6e64 6578  if name in index
-0003f1a0: 5f76 6172 733a 0a20 2020 2020 2020 2020  _vars:.         
-0003f1b0: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-0003f1c0: 5b6e 616d 655d 203d 2069 6e64 6578 5f76  [name] = index_v
-0003f1d0: 6172 735b 6e61 6d65 5d0a 2020 2020 2020  ars[name].      
-0003f1e0: 2020 2020 2020 656c 6966 2064 696d 2069        elif dim i
-0003f1f0: 6e20 7661 722e 6469 6d73 3a0a 2020 2020  n var.dims:.    
-0003f200: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-0003f210: 616d 6520 696e 2073 656c 662e 6461 7461  ame in self.data
-0003f220: 5f76 6172 733a 0a20 2020 2020 2020 2020  _vars:.         
-0003f230: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-0003f240: 626c 6573 5b6e 616d 655d 203d 2076 6172  bles[name] = var
-0003f250: 2e69 7365 6c28 736c 6963 655f 656e 6429  .isel(slice_end)
-0003f260: 202d 2076 6172 2e69 7365 6c28 736c 6963   - var.isel(slic
-0003f270: 655f 7374 6172 7429 0a20 2020 2020 2020  e_start).       
-0003f280: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0003f290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0003f2a0: 2020 2076 6172 6961 626c 6573 5b6e 616d     variables[nam
-0003f2b0: 655d 203d 2076 6172 2e69 7365 6c28 736c  e] = var.isel(sl
-0003f2c0: 6963 655f 6e65 7729 0a20 2020 2020 2020  ice_new).       
-0003f2d0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0003f2e0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-0003f2f0: 626c 6573 5b6e 616d 655d 203d 2076 6172  bles[name] = var
-0003f300: 0a0a 2020 2020 2020 2020 6469 6666 6572  ..        differ
-0003f310: 656e 6365 203d 2073 656c 662e 5f72 6570  ence = self._rep
-0003f320: 6c61 6365 5f77 6974 685f 6e65 775f 6469  lace_with_new_di
-0003f330: 6d73 2876 6172 6961 626c 6573 2c20 696e  ms(variables, in
-0003f340: 6465 7865 733d 696e 6465 7865 7329 0a0a  dexes=indexes)..
-0003f350: 2020 2020 2020 2020 6966 206e 203e 2031          if n > 1
-0003f360: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-0003f370: 7475 726e 2064 6966 6665 7265 6e63 652e  turn difference.
-0003f380: 6469 6666 2864 696d 2c20 6e20 2d20 3129  diff(dim, n - 1)
-0003f390: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-0003f3a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0003f3b0: 6e20 6469 6666 6572 656e 6365 0a0a 2020  n difference..  
-0003f3c0: 2020 6465 6620 7368 6966 7428 0a20 2020    def shift(.   
-0003f3d0: 2020 2020 2073 656c 663a 2054 5f44 6174       self: T_Dat
-0003f3e0: 6173 6574 2c0a 2020 2020 2020 2020 7368  aset,.        sh
-0003f3f0: 6966 7473 3a20 4d61 7070 696e 675b 416e  ifts: Mapping[An
-0003f400: 792c 2069 6e74 5d20 7c20 4e6f 6e65 203d  y, int] | None =
-0003f410: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
-0003f420: 696c 6c5f 7661 6c75 653a 2041 6e79 203d  ill_value: Any =
-0003f430: 2078 7264 7479 7065 732e 4e41 2c0a 2020   xrdtypes.NA,.  
-0003f440: 2020 2020 2020 2a2a 7368 6966 7473 5f6b        **shifts_k
-0003f450: 7761 7267 733a 2069 6e74 2c0a 2020 2020  wargs: int,.    
-0003f460: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
-0003f470: 2020 2020 2020 2020 2222 2253 6869 6674          """Shift
-0003f480: 2074 6869 7320 6461 7461 7365 7420 6279   this dataset by
-0003f490: 2061 6e20 6f66 6673 6574 2061 6c6f 6e67   an offset along
-0003f4a0: 206f 6e65 206f 7220 6d6f 7265 2064 696d   one or more dim
-0003f4b0: 656e 7369 6f6e 732e 0a0a 2020 2020 2020  ensions...      
-0003f4c0: 2020 4f6e 6c79 2064 6174 6120 7661 7269    Only data vari
-0003f4d0: 6162 6c65 7320 6172 6520 6d6f 7665 643b  ables are moved;
-0003f4e0: 2063 6f6f 7264 696e 6174 6573 2073 7461   coordinates sta
-0003f4f0: 7920 696e 2070 6c61 6365 2e20 5468 6973  y in place. This
-0003f500: 2069 730a 2020 2020 2020 2020 636f 6e73   is.        cons
-0003f510: 6973 7465 6e74 2077 6974 6820 7468 6520  istent with the 
-0003f520: 6265 6861 7669 6f72 206f 6620 6060 7368  behavior of ``sh
-0003f530: 6966 7460 6020 696e 2070 616e 6461 732e  ift`` in pandas.
-0003f540: 0a0a 2020 2020 2020 2020 5661 6c75 6573  ..        Values
-0003f550: 2073 6869 6674 6564 2066 726f 6d20 6265   shifted from be
-0003f560: 796f 6e64 2061 7272 6179 2062 6f75 6e64  yond array bound
-0003f570: 7320 7769 6c6c 2061 7070 6561 7220 6174  s will appear at
-0003f580: 206f 6e65 2065 6e64 206f 660a 2020 2020   one end of.    
-0003f590: 2020 2020 6561 6368 2064 696d 656e 7369      each dimensi
-0003f5a0: 6f6e 2c20 7768 6963 6820 6172 6520 6669  on, which are fi
-0003f5b0: 6c6c 6564 2061 6363 6f72 6469 6e67 2074  lled according t
-0003f5c0: 6f20 6066 696c 6c5f 7661 6c75 6560 2e20  o `fill_value`. 
-0003f5d0: 466f 7220 7065 7269 6f64 6963 0a20 2020  For periodic.   
-0003f5e0: 2020 2020 206f 6666 7365 7473 2069 6e73       offsets ins
-0003f5f0: 7465 6164 2073 6565 2060 726f 6c6c 602e  tead see `roll`.
-0003f600: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0003f610: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
-0003f620: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0003f630: 7368 6966 7473 203a 206d 6170 7069 6e67  shifts : mapping
-0003f640: 206f 6620 6861 7368 6162 6c65 2074 6f20   of hashable to 
-0003f650: 696e 740a 2020 2020 2020 2020 2020 2020  int.            
-0003f660: 496e 7465 6765 7220 6f66 6673 6574 2074  Integer offset t
-0003f670: 6f20 7368 6966 7420 616c 6f6e 6720 6561  o shift along ea
-0003f680: 6368 206f 6620 7468 6520 6769 7665 6e20  ch of the given 
-0003f690: 6469 6d65 6e73 696f 6e73 2e0a 2020 2020  dimensions..    
-0003f6a0: 2020 2020 2020 2020 506f 7369 7469 7665          Positive
-0003f6b0: 206f 6666 7365 7473 2073 6869 6674 2074   offsets shift t
-0003f6c0: 6f20 7468 6520 7269 6768 743b 206e 6567  o the right; neg
-0003f6d0: 6174 6976 6520 6f66 6673 6574 7320 7368  ative offsets sh
-0003f6e0: 6966 7420 746f 2074 6865 0a20 2020 2020  ift to the.     
-0003f6f0: 2020 2020 2020 206c 6566 742e 0a20 2020         left..   
-0003f700: 2020 2020 2066 696c 6c5f 7661 6c75 6520       fill_value 
-0003f710: 3a20 7363 616c 6172 206f 7220 6469 6374  : scalar or dict
-0003f720: 2d6c 696b 652c 206f 7074 696f 6e61 6c0a  -like, optional.
-0003f730: 2020 2020 2020 2020 2020 2020 5661 6c75              Valu
-0003f740: 6520 746f 2075 7365 2066 6f72 206e 6577  e to use for new
-0003f750: 6c79 206d 6973 7369 6e67 2076 616c 7565  ly missing value
-0003f760: 732e 2049 6620 6120 6469 6374 2d6c 696b  s. If a dict-lik
-0003f770: 652c 206d 6170 730a 2020 2020 2020 2020  e, maps.        
-0003f780: 2020 2020 7661 7269 6162 6c65 206e 616d      variable nam
-0003f790: 6573 2028 696e 636c 7564 696e 6720 636f  es (including co
-0003f7a0: 6f72 6469 6e61 7465 7329 2074 6f20 6669  ordinates) to fi
-0003f7b0: 6c6c 2076 616c 7565 732e 0a20 2020 2020  ll values..     
-0003f7c0: 2020 202a 2a73 6869 6674 735f 6b77 6172     **shifts_kwar
-0003f7d0: 6773 0a20 2020 2020 2020 2020 2020 2054  gs.            T
-0003f7e0: 6865 206b 6579 776f 7264 2061 7267 756d  he keyword argum
-0003f7f0: 656e 7473 2066 6f72 6d20 6f66 2060 6073  ents form of ``s
-0003f800: 6869 6674 7360 602e 0a20 2020 2020 2020  hifts``..       
-0003f810: 2020 2020 204f 6e65 206f 6620 7368 6966       One of shif
-0003f820: 7473 206f 7220 7368 6966 7473 5f6b 7761  ts or shifts_kwa
-0003f830: 7267 7320 6d75 7374 2062 6520 7072 6f76  rgs must be prov
-0003f840: 6964 6564 2e0a 0a20 2020 2020 2020 2052  ided...        R
-0003f850: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-0003f860: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2073  ------.        s
-0003f870: 6869 6674 6564 203a 2044 6174 6173 6574  hifted : Dataset
-0003f880: 0a20 2020 2020 2020 2020 2020 2044 6174  .            Dat
-0003f890: 6173 6574 2077 6974 6820 7468 6520 7361  aset with the sa
-0003f8a0: 6d65 2063 6f6f 7264 696e 6174 6573 2061  me coordinates a
-0003f8b0: 6e64 2061 7474 7269 6275 7465 7320 6275  nd attributes bu
-0003f8c0: 7420 7368 6966 7465 6420 6461 7461 0a20  t shifted data. 
-0003f8d0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-0003f8e0: 626c 6573 2e0a 0a20 2020 2020 2020 2053  bles...        S
-0003f8f0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-0003f900: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0003f910: 2072 6f6c 6c0a 0a20 2020 2020 2020 2045   roll..        E
-0003f920: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-0003f930: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0003f940: 203e 3e3e 2064 7320 3d20 7872 2e44 6174   >>> ds = xr.Dat
-0003f950: 6173 6574 287b 2266 6f6f 223a 2028 2278  aset({"foo": ("x
-0003f960: 222c 206c 6973 7428 2261 6263 6465 2229  ", list("abcde")
-0003f970: 297d 290a 2020 2020 2020 2020 3e3e 3e20  )}).        >>> 
-0003f980: 6473 2e73 6869 6674 2878 3d32 290a 2020  ds.shift(x=2).  
-0003f990: 2020 2020 2020 3c78 6172 7261 792e 4461        <xarray.Da
-0003f9a0: 7461 7365 743e 0a20 2020 2020 2020 2044  taset>.        D
-0003f9b0: 696d 656e 7369 6f6e 733a 2020 2878 3a20  imensions:  (x: 
-0003f9c0: 3529 0a20 2020 2020 2020 2044 696d 656e  5).        Dimen
-0003f9d0: 7369 6f6e 7320 7769 7468 6f75 7420 636f  sions without co
-0003f9e0: 6f72 6469 6e61 7465 733a 2078 0a20 2020  ordinates: x.   
-0003f9f0: 2020 2020 2044 6174 6120 7661 7269 6162       Data variab
-0003fa00: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
-0003fa10: 2066 6f6f 2020 2020 2020 2878 2920 6f62   foo      (x) ob
-0003fa20: 6a65 6374 206e 616e 206e 616e 2027 6127  ject nan nan 'a'
-0003fa30: 2027 6227 2027 6327 0a20 2020 2020 2020   'b' 'c'.       
-0003fa40: 2022 2222 0a20 2020 2020 2020 2073 6869   """.        shi
-0003fa50: 6674 7320 3d20 6569 7468 6572 5f64 6963  fts = either_dic
-0003fa60: 745f 6f72 5f6b 7761 7267 7328 7368 6966  t_or_kwargs(shif
-0003fa70: 7473 2c20 7368 6966 7473 5f6b 7761 7267  ts, shifts_kwarg
-0003fa80: 732c 2022 7368 6966 7422 290a 2020 2020  s, "shift").    
-0003fa90: 2020 2020 696e 7661 6c69 6420 3d20 5b6b      invalid = [k
-0003faa0: 2066 6f72 206b 2069 6e20 7368 6966 7473   for k in shifts
-0003fab0: 2069 6620 6b20 6e6f 7420 696e 2073 656c   if k not in sel
-0003fac0: 662e 6469 6d73 5d0a 2020 2020 2020 2020  f.dims].        
-0003fad0: 6966 2069 6e76 616c 6964 3a0a 2020 2020  if invalid:.    
-0003fae0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
-0003faf0: 6c75 6545 7272 6f72 2866 2264 696d 656e  lueError(f"dimen
-0003fb00: 7369 6f6e 7320 7b69 6e76 616c 6964 2172  sions {invalid!r
-0003fb10: 7d20 646f 206e 6f74 2065 7869 7374 2229  } do not exist")
-0003fb20: 0a0a 2020 2020 2020 2020 7661 7269 6162  ..        variab
-0003fb30: 6c65 7320 3d20 7b7d 0a20 2020 2020 2020  les = {}.       
-0003fb40: 2066 6f72 206e 616d 652c 2076 6172 2069   for name, var i
-0003fb50: 6e20 7365 6c66 2e76 6172 6961 626c 6573  n self.variables
-0003fb60: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
-0003fb70: 2020 2020 2020 6966 206e 616d 6520 696e        if name in
-0003fb80: 2073 656c 662e 6461 7461 5f76 6172 733a   self.data_vars:
-0003fb90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003fba0: 2066 696c 6c5f 7661 6c75 655f 203d 2028   fill_value_ = (
-0003fbb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0003fbc0: 2020 2020 2066 696c 6c5f 7661 6c75 652e       fill_value.
-0003fbd0: 6765 7428 6e61 6d65 2c20 7872 6474 7970  get(name, xrdtyp
-0003fbe0: 6573 2e4e 4129 0a20 2020 2020 2020 2020  es.NA).         
-0003fbf0: 2020 2020 2020 2020 2020 2069 6620 6973             if is
-0003fc00: 696e 7374 616e 6365 2866 696c 6c5f 7661  instance(fill_va
-0003fc10: 6c75 652c 2064 6963 7429 0a20 2020 2020  lue, dict).     
-0003fc20: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0003fc30: 6c73 6520 6669 6c6c 5f76 616c 7565 0a20  lse fill_value. 
-0003fc40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0003fc50: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0003fc60: 2020 7661 725f 7368 6966 7473 203d 207b    var_shifts = {
-0003fc70: 6b3a 2076 2066 6f72 206b 2c20 7620 696e  k: v for k, v in
-0003fc80: 2073 6869 6674 732e 6974 656d 7328 2920   shifts.items() 
-0003fc90: 6966 206b 2069 6e20 7661 722e 6469 6d73  if k in var.dims
-0003fca0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-0003fcb0: 2020 7661 7269 6162 6c65 735b 6e61 6d65    variables[name
-0003fcc0: 5d20 3d20 7661 722e 7368 6966 7428 6669  ] = var.shift(fi
-0003fcd0: 6c6c 5f76 616c 7565 3d66 696c 6c5f 7661  ll_value=fill_va
-0003fce0: 6c75 655f 2c20 7368 6966 7473 3d76 6172  lue_, shifts=var
-0003fcf0: 5f73 6869 6674 7329 0a20 2020 2020 2020  _shifts).       
-0003fd00: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-0003fd10: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-0003fd20: 626c 6573 5b6e 616d 655d 203d 2076 6172  bles[name] = var
-0003fd30: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-0003fd40: 2073 656c 662e 5f72 6570 6c61 6365 2876   self._replace(v
-0003fd50: 6172 6961 626c 6573 290a 0a20 2020 2064  ariables)..    d
-0003fd60: 6566 2072 6f6c 6c28 0a20 2020 2020 2020  ef roll(.       
-0003fd70: 2073 656c 663a 2054 5f44 6174 6173 6574   self: T_Dataset
-0003fd80: 2c0a 2020 2020 2020 2020 7368 6966 7473  ,.        shifts
-0003fd90: 3a20 4d61 7070 696e 675b 416e 792c 2069  : Mapping[Any, i
-0003fda0: 6e74 5d20 7c20 4e6f 6e65 203d 204e 6f6e  nt] | None = Non
-0003fdb0: 652c 0a20 2020 2020 2020 2072 6f6c 6c5f  e,.        roll_
-0003fdc0: 636f 6f72 6473 3a20 626f 6f6c 203d 2046  coords: bool = F
-0003fdd0: 616c 7365 2c0a 2020 2020 2020 2020 2a2a  alse,.        **
-0003fde0: 7368 6966 7473 5f6b 7761 7267 733a 2069  shifts_kwargs: i
-0003fdf0: 6e74 2c0a 2020 2020 2920 2d3e 2054 5f44  nt,.    ) -> T_D
-0003fe00: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
-0003fe10: 2222 2252 6f6c 6c20 7468 6973 2064 6174  """Roll this dat
-0003fe20: 6173 6574 2062 7920 616e 206f 6666 7365  aset by an offse
-0003fe30: 7420 616c 6f6e 6720 6f6e 6520 6f72 206d  t along one or m
-0003fe40: 6f72 6520 6469 6d65 6e73 696f 6e73 2e0a  ore dimensions..
-0003fe50: 0a20 2020 2020 2020 2055 6e6c 696b 6520  .        Unlike 
-0003fe60: 7368 6966 742c 2072 6f6c 6c20 7472 6561  shift, roll trea
-0003fe70: 7473 2074 6865 2067 6976 656e 2064 696d  ts the given dim
-0003fe80: 656e 7369 6f6e 7320 6173 2070 6572 696f  ensions as perio
-0003fe90: 6469 632c 2073 6f20 7769 6c6c 206e 6f74  dic, so will not
-0003fea0: 0a20 2020 2020 2020 2063 7265 6174 6520  .        create 
-0003feb0: 616e 7920 6d69 7373 696e 6720 7661 6c75  any missing valu
-0003fec0: 6573 2074 6f20 6265 2066 696c 6c65 642e  es to be filled.
-0003fed0: 0a0a 2020 2020 2020 2020 416c 736f 2075  ..        Also u
-0003fee0: 6e6c 696b 6520 7368 6966 742c 2072 6f6c  nlike shift, rol
-0003fef0: 6c20 6d61 7920 726f 7461 7465 2061 6c6c  l may rotate all
-0003ff00: 2076 6172 6961 626c 6573 2c20 696e 636c   variables, incl
-0003ff10: 7564 696e 6720 636f 6f72 6469 6e61 7465  uding coordinate
-0003ff20: 730a 2020 2020 2020 2020 6966 2073 7065  s.        if spe
-0003ff30: 6369 6669 6564 2e20 5468 6520 6469 7265  cified. The dire
-0003ff40: 6374 696f 6e20 6f66 2072 6f74 6174 696f  ction of rotatio
-0003ff50: 6e20 6973 2063 6f6e 7369 7374 656e 7420  n is consistent 
-0003ff60: 7769 7468 0a20 2020 2020 2020 203a 7079  with.        :py
-0003ff70: 3a66 756e 633a 606e 756d 7079 2e72 6f6c  :func:`numpy.rol
-0003ff80: 6c60 2e0a 0a20 2020 2020 2020 2050 6172  l`...        Par
-0003ff90: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
-0003ffa0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
-0003ffb0: 2020 2073 6869 6674 7320 3a20 6d61 7070     shifts : mapp
-0003ffc0: 696e 6720 6f66 2068 6173 6861 626c 6520  ing of hashable 
-0003ffd0: 746f 2069 6e74 2c20 6f70 7469 6f6e 616c  to int, optional
-0003ffe0: 0a20 2020 2020 2020 2020 2020 2041 2064  .            A d
-0003fff0: 6963 7420 7769 7468 206b 6579 7320 6d61  ict with keys ma
-00040000: 7463 6869 6e67 2064 696d 656e 7369 6f6e  tching dimension
-00040010: 7320 616e 6420 7661 6c75 6573 2067 6976  s and values giv
-00040020: 656e 0a20 2020 2020 2020 2020 2020 2062  en.            b
-00040030: 7920 696e 7465 6765 7273 2074 6f20 726f  y integers to ro
-00040040: 7461 7465 2065 6163 6820 6f66 2074 6865  tate each of the
-00040050: 2067 6976 656e 2064 696d 656e 7369 6f6e   given dimension
-00040060: 732e 2050 6f73 6974 6976 650a 2020 2020  s. Positive.    
-00040070: 2020 2020 2020 2020 6f66 6673 6574 7320          offsets 
-00040080: 726f 6c6c 2074 6f20 7468 6520 7269 6768  roll to the righ
-00040090: 743b 206e 6567 6174 6976 6520 6f66 6673  t; negative offs
-000400a0: 6574 7320 726f 6c6c 2074 6f20 7468 6520  ets roll to the 
-000400b0: 6c65 6674 2e0a 2020 2020 2020 2020 726f  left..        ro
-000400c0: 6c6c 5f63 6f6f 7264 7320 3a20 626f 6f6c  ll_coords : bool
-000400d0: 2c20 6465 6661 756c 743a 2046 616c 7365  , default: False
-000400e0: 0a20 2020 2020 2020 2020 2020 2049 6e64  .            Ind
-000400f0: 6963 6174 6573 2077 6865 7468 6572 2074  icates whether t
-00040100: 6f20 726f 6c6c 2074 6865 2063 6f6f 7264  o roll the coord
-00040110: 696e 6174 6573 2062 7920 7468 6520 6f66  inates by the of
-00040120: 6673 6574 2074 6f6f 2e0a 2020 2020 2020  fset too..      
-00040130: 2020 2a2a 7368 6966 7473 5f6b 7761 7267    **shifts_kwarg
-00040140: 7320 3a20 7b64 696d 3a20 6f66 6673 6574  s : {dim: offset
-00040150: 2c20 2e2e 2e7d 2c20 6f70 7469 6f6e 616c  , ...}, optional
-00040160: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00040170: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-00040180: 7473 2066 6f72 6d20 6f66 2060 6073 6869  ts form of ``shi
-00040190: 6674 7360 602e 0a20 2020 2020 2020 2020  fts``..         
-000401a0: 2020 204f 6e65 206f 6620 7368 6966 7473     One of shifts
-000401b0: 206f 7220 7368 6966 7473 5f6b 7761 7267   or shifts_kwarg
-000401c0: 7320 6d75 7374 2062 6520 7072 6f76 6964  s must be provid
-000401d0: 6564 2e0a 0a20 2020 2020 2020 2052 6574  ed...        Ret
-000401e0: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-000401f0: 2d2d 2d2d 0a20 2020 2020 2020 2072 6f6c  ----.        rol
-00040200: 6c65 6420 3a20 4461 7461 7365 740a 2020  led : Dataset.  
-00040210: 2020 2020 2020 2020 2020 4461 7461 7365            Datase
-00040220: 7420 7769 7468 2074 6865 2073 616d 6520  t with the same 
-00040230: 6174 7472 6962 7574 6573 2062 7574 2072  attributes but r
-00040240: 6f6c 6c65 6420 6461 7461 2061 6e64 2063  olled data and c
-00040250: 6f6f 7264 696e 6174 6573 2e0a 0a20 2020  oordinates...   
-00040260: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
-00040270: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
-00040280: 2020 2020 2020 2073 6869 6674 0a0a 2020         shift..  
-00040290: 2020 2020 2020 4578 616d 706c 6573 0a20        Examples. 
-000402a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-000402b0: 2020 2020 2020 2020 3e3e 3e20 6473 203d          >>> ds =
-000402c0: 2078 722e 4461 7461 7365 7428 7b22 666f   xr.Dataset({"fo
-000402d0: 6f22 3a20 2822 7822 2c20 6c69 7374 2822  o": ("x", list("
-000402e0: 6162 6364 6522 2929 7d2c 2063 6f6f 7264  abcde"))}, coord
-000402f0: 733d 7b22 7822 3a20 6e70 2e61 7261 6e67  s={"x": np.arang
-00040300: 6528 3529 7d29 0a20 2020 2020 2020 203e  e(5)}).        >
-00040310: 3e3e 2064 732e 726f 6c6c 2878 3d32 290a  >> ds.roll(x=2).
-00040320: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
-00040330: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
-00040340: 2044 696d 656e 7369 6f6e 733a 2020 2878   Dimensions:  (x
-00040350: 3a20 3529 0a20 2020 2020 2020 2043 6f6f  : 5).        Coo
-00040360: 7264 696e 6174 6573 3a0a 2020 2020 2020  rdinates:.      
-00040370: 2020 2020 2a20 7820 2020 2020 2020 2028      * x        (
-00040380: 7829 2069 6e74 3634 2030 2031 2032 2033  x) int64 0 1 2 3
-00040390: 2034 0a20 2020 2020 2020 2044 6174 6120   4.        Data 
-000403a0: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
-000403b0: 2020 2020 2020 2066 6f6f 2020 2020 2020         foo      
-000403c0: 2878 2920 3c55 3120 2764 2720 2765 2720  (x) <U1 'd' 'e' 
-000403d0: 2761 2720 2762 2720 2763 270a 0a20 2020  'a' 'b' 'c'..   
-000403e0: 2020 2020 203e 3e3e 2064 732e 726f 6c6c       >>> ds.roll
-000403f0: 2878 3d32 2c20 726f 6c6c 5f63 6f6f 7264  (x=2, roll_coord
-00040400: 733d 5472 7565 290a 2020 2020 2020 2020  s=True).        
-00040410: 3c78 6172 7261 792e 4461 7461 7365 743e  <xarray.Dataset>
-00040420: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
-00040430: 6f6e 733a 2020 2878 3a20 3529 0a20 2020  ons:  (x: 5).   
-00040440: 2020 2020 2043 6f6f 7264 696e 6174 6573       Coordinates
-00040450: 3a0a 2020 2020 2020 2020 2020 2a20 7820  :.          * x 
-00040460: 2020 2020 2020 2028 7829 2069 6e74 3634         (x) int64
-00040470: 2033 2034 2030 2031 2032 0a20 2020 2020   3 4 0 1 2.     
-00040480: 2020 2044 6174 6120 7661 7269 6162 6c65     Data variable
-00040490: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
-000404a0: 6f6f 2020 2020 2020 2878 2920 3c55 3120  oo      (x) <U1 
-000404b0: 2764 2720 2765 2720 2761 2720 2762 2720  'd' 'e' 'a' 'b' 
-000404c0: 2763 270a 0a20 2020 2020 2020 2022 2222  'c'..        """
-000404d0: 0a20 2020 2020 2020 2073 6869 6674 7320  .        shifts 
-000404e0: 3d20 6569 7468 6572 5f64 6963 745f 6f72  = either_dict_or
-000404f0: 5f6b 7761 7267 7328 7368 6966 7473 2c20  _kwargs(shifts, 
-00040500: 7368 6966 7473 5f6b 7761 7267 732c 2022  shifts_kwargs, "
-00040510: 726f 6c6c 2229 0a20 2020 2020 2020 2069  roll").        i
-00040520: 6e76 616c 6964 203d 205b 6b20 666f 7220  nvalid = [k for 
-00040530: 6b20 696e 2073 6869 6674 7320 6966 206b  k in shifts if k
-00040540: 206e 6f74 2069 6e20 7365 6c66 2e64 696d   not in self.dim
-00040550: 735d 0a20 2020 2020 2020 2069 6620 696e  s].        if in
-00040560: 7661 6c69 643a 0a20 2020 2020 2020 2020  valid:.         
-00040570: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
-00040580: 726f 7228 6622 6469 6d65 6e73 696f 6e73  ror(f"dimensions
-00040590: 207b 696e 7661 6c69 6421 727d 2064 6f20   {invalid!r} do 
-000405a0: 6e6f 7420 6578 6973 7422 290a 0a20 2020  not exist")..   
-000405b0: 2020 2020 2075 6e72 6f6c 6c65 645f 7661       unrolled_va
-000405c0: 7273 3a20 7475 706c 655b 4861 7368 6162  rs: tuple[Hashab
-000405d0: 6c65 2c20 2e2e 2e5d 0a0a 2020 2020 2020  le, ...]..      
-000405e0: 2020 6966 2072 6f6c 6c5f 636f 6f72 6473    if roll_coords
-000405f0: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
-00040600: 6465 7865 732c 2069 6e64 6578 5f76 6172  dexes, index_var
-00040610: 7320 3d20 726f 6c6c 5f69 6e64 6578 6573  s = roll_indexes
-00040620: 2873 656c 662e 7869 6e64 6578 6573 2c20  (self.xindexes, 
-00040630: 7368 6966 7473 290a 2020 2020 2020 2020  shifts).        
-00040640: 2020 2020 756e 726f 6c6c 6564 5f76 6172      unrolled_var
-00040650: 7320 3d20 2829 0a20 2020 2020 2020 2065  s = ().        e
-00040660: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00040670: 2069 6e64 6578 6573 203d 2064 6963 7428   indexes = dict(
-00040680: 7365 6c66 2e5f 696e 6465 7865 7329 0a20  self._indexes). 
-00040690: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-000406a0: 5f76 6172 7320 3d20 6469 6374 2873 656c  _vars = dict(sel
-000406b0: 662e 7869 6e64 6578 6573 2e76 6172 6961  f.xindexes.varia
-000406c0: 626c 6573 290a 2020 2020 2020 2020 2020  bles).          
-000406d0: 2020 756e 726f 6c6c 6564 5f76 6172 7320    unrolled_vars 
-000406e0: 3d20 7475 706c 6528 7365 6c66 2e63 6f6f  = tuple(self.coo
-000406f0: 7264 7329 0a0a 2020 2020 2020 2020 7661  rds)..        va
-00040700: 7269 6162 6c65 7320 3d20 7b7d 0a20 2020  riables = {}.   
-00040710: 2020 2020 2066 6f72 206b 2c20 7661 7220       for k, var 
-00040720: 696e 2073 656c 662e 7661 7269 6162 6c65  in self.variable
-00040730: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-00040740: 2020 2020 2020 2069 6620 6b20 696e 2069         if k in i
-00040750: 6e64 6578 5f76 6172 733a 0a20 2020 2020  ndex_vars:.     
-00040760: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-00040770: 626c 6573 5b6b 5d20 3d20 696e 6465 785f  bles[k] = index_
-00040780: 7661 7273 5b6b 5d0a 2020 2020 2020 2020  vars[k].        
-00040790: 2020 2020 656c 6966 206b 206e 6f74 2069      elif k not i
-000407a0: 6e20 756e 726f 6c6c 6564 5f76 6172 733a  n unrolled_vars:
-000407b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000407c0: 2076 6172 6961 626c 6573 5b6b 5d20 3d20   variables[k] = 
-000407d0: 7661 722e 726f 6c6c 280a 2020 2020 2020  var.roll(.      
-000407e0: 2020 2020 2020 2020 2020 2020 2020 7368                sh
-000407f0: 6966 7473 3d7b 6b3a 2073 2066 6f72 206b  ifts={k: s for k
-00040800: 2c20 7320 696e 2073 6869 6674 732e 6974  , s in shifts.it
-00040810: 656d 7328 2920 6966 206b 2069 6e20 7661  ems() if k in va
-00040820: 722e 6469 6d73 7d0a 2020 2020 2020 2020  r.dims}.        
-00040830: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00040840: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-00040850: 2020 2020 2020 2020 2020 2020 7661 7269              vari
-00040860: 6162 6c65 735b 6b5d 203d 2076 6172 0a0a  ables[k] = var..
-00040870: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00040880: 656c 662e 5f72 6570 6c61 6365 2876 6172  elf._replace(var
-00040890: 6961 626c 6573 2c20 696e 6465 7865 733d  iables, indexes=
-000408a0: 696e 6465 7865 7329 0a0a 2020 2020 6465  indexes)..    de
-000408b0: 6620 736f 7274 6279 280a 2020 2020 2020  f sortby(.      
-000408c0: 2020 7365 6c66 3a20 545f 4461 7461 7365    self: T_Datase
-000408d0: 742c 0a20 2020 2020 2020 2076 6172 6961  t,.        varia
-000408e0: 626c 6573 3a20 4861 7368 6162 6c65 207c  bles: Hashable |
-000408f0: 2044 6174 6141 7272 6179 207c 206c 6973   DataArray | lis
-00040900: 745b 4861 7368 6162 6c65 207c 2044 6174  t[Hashable | Dat
-00040910: 6141 7272 6179 5d2c 0a20 2020 2020 2020  aArray],.       
-00040920: 2061 7363 656e 6469 6e67 3a20 626f 6f6c   ascending: bool
-00040930: 203d 2054 7275 652c 0a20 2020 2029 202d   = True,.    ) -
-00040940: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
-00040950: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00040960: 2053 6f72 7420 6f62 6a65 6374 2062 7920   Sort object by 
-00040970: 6c61 6265 6c73 206f 7220 7661 6c75 6573  labels or values
-00040980: 2028 616c 6f6e 6720 616e 2061 7869 7329   (along an axis)
-00040990: 2e0a 0a20 2020 2020 2020 2053 6f72 7473  ...        Sorts
-000409a0: 2074 6865 2064 6174 6173 6574 2c20 6569   the dataset, ei
-000409b0: 7468 6572 2061 6c6f 6e67 2073 7065 6369  ther along speci
-000409c0: 6669 6564 2064 696d 656e 7369 6f6e 732c  fied dimensions,
-000409d0: 0a20 2020 2020 2020 206f 7220 6163 636f  .        or acco
-000409e0: 7264 696e 6720 746f 2076 616c 7565 7320  rding to values 
-000409f0: 6f66 2031 2d44 2064 6174 6161 7272 6179  of 1-D dataarray
-00040a00: 7320 7468 6174 2073 6861 7265 2064 696d  s that share dim
-00040a10: 656e 7369 6f6e 0a20 2020 2020 2020 2077  ension.        w
-00040a20: 6974 6820 6361 6c6c 696e 6720 6f62 6a65  ith calling obje
-00040a30: 6374 2e0a 0a20 2020 2020 2020 2049 6620  ct...        If 
-00040a40: 7468 6520 696e 7075 7420 7661 7269 6162  the input variab
-00040a50: 6c65 7320 6172 6520 6461 7461 6172 7261  les are dataarra
-00040a60: 7973 2c20 7468 656e 2074 6865 2064 6174  ys, then the dat
-00040a70: 6161 7272 6179 7320 6172 6520 616c 6967  aarrays are alig
-00040a80: 6e65 640a 2020 2020 2020 2020 2876 6961  ned.        (via
-00040a90: 206c 6566 742d 6a6f 696e 2920 746f 2074   left-join) to t
-00040aa0: 6865 2063 616c 6c69 6e67 206f 626a 6563  he calling objec
-00040ab0: 7420 7072 696f 7220 746f 2073 6f72 7469  t prior to sorti
-00040ac0: 6e67 2062 7920 6365 6c6c 2076 616c 7565  ng by cell value
-00040ad0: 732e 0a20 2020 2020 2020 204e 614e 7320  s..        NaNs 
-00040ae0: 6172 6520 736f 7274 6564 2074 6f20 7468  are sorted to th
-00040af0: 6520 656e 642c 2066 6f6c 6c6f 7769 6e67  e end, following
-00040b00: 204e 756d 7079 2063 6f6e 7665 6e74 696f   Numpy conventio
-00040b10: 6e2e 0a0a 2020 2020 2020 2020 4966 206d  n...        If m
-00040b20: 756c 7469 706c 6520 736f 7274 7320 616c  ultiple sorts al
-00040b30: 6f6e 6720 7468 6520 7361 6d65 2064 696d  ong the same dim
-00040b40: 656e 7369 6f6e 2069 730a 2020 2020 2020  ension is.      
-00040b50: 2020 6769 7665 6e2c 206e 756d 7079 2773    given, numpy's
-00040b60: 206c 6578 736f 7274 2069 7320 7065 7266   lexsort is perf
-00040b70: 6f72 6d65 6420 616c 6f6e 6720 7468 6174  ormed along that
-00040b80: 2064 696d 656e 7369 6f6e 3a0a 2020 2020   dimension:.    
-00040b90: 2020 2020 6874 7470 733a 2f2f 6e75 6d70      https://nump
-00040ba0: 792e 6f72 672f 646f 632f 7374 6162 6c65  y.org/doc/stable
-00040bb0: 2f72 6566 6572 656e 6365 2f67 656e 6572  /reference/gener
-00040bc0: 6174 6564 2f6e 756d 7079 2e6c 6578 736f  ated/numpy.lexso
-00040bd0: 7274 2e68 746d 6c0a 2020 2020 2020 2020  rt.html.        
-00040be0: 616e 6420 7468 6520 4649 5253 5420 6b65  and the FIRST ke
-00040bf0: 7920 696e 2074 6865 2073 6571 7565 6e63  y in the sequenc
-00040c00: 6520 6973 2075 7365 6420 6173 2074 6865  e is used as the
-00040c10: 2070 7269 6d61 7279 2073 6f72 7420 6b65   primary sort ke
-00040c20: 792c 0a20 2020 2020 2020 2066 6f6c 6c6f  y,.        follo
-00040c30: 7765 6420 6279 2074 6865 2032 6e64 206b  wed by the 2nd k
-00040c40: 6579 2c20 6574 632e 0a0a 2020 2020 2020  ey, etc...      
-00040c50: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00040c60: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-00040c70: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-00040c80: 7320 3a20 4861 7368 6162 6c65 2c20 4461  s : Hashable, Da
-00040c90: 7461 4172 7261 792c 206f 7220 6c69 7374  taArray, or list
-00040ca0: 206f 6620 6861 7368 6162 6c65 206f 7220   of hashable or 
-00040cb0: 4461 7461 4172 7261 790a 2020 2020 2020  DataArray.      
-00040cc0: 2020 2020 2020 3144 2044 6174 6141 7272        1D DataArr
-00040cd0: 6179 206f 626a 6563 7473 206f 7220 6e61  ay objects or na
-00040ce0: 6d65 2873 2920 6f66 2031 4420 7661 7269  me(s) of 1D vari
-00040cf0: 6162 6c65 2873 2920 696e 0a20 2020 2020  able(s) in.     
-00040d00: 2020 2020 2020 2063 6f6f 7264 732f 6461         coords/da
-00040d10: 7461 5f76 6172 7320 7768 6f73 6520 7661  ta_vars whose va
-00040d20: 6c75 6573 2061 7265 2075 7365 6420 746f  lues are used to
-00040d30: 2073 6f72 7420 7468 6520 6461 7461 7365   sort the datase
-00040d40: 742e 0a20 2020 2020 2020 2061 7363 656e  t..        ascen
-00040d50: 6469 6e67 203a 2062 6f6f 6c2c 2064 6566  ding : bool, def
-00040d60: 6175 6c74 3a20 5472 7565 0a20 2020 2020  ault: True.     
-00040d70: 2020 2020 2020 2057 6865 7468 6572 2074         Whether t
-00040d80: 6f20 736f 7274 2062 7920 6173 6365 6e64  o sort by ascend
-00040d90: 696e 6720 6f72 2064 6573 6365 6e64 696e  ing or descendin
-00040da0: 6720 6f72 6465 722e 0a0a 2020 2020 2020  g order...      
-00040db0: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-00040dc0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00040dd0: 2020 736f 7274 6564 203a 2044 6174 6173    sorted : Datas
-00040de0: 6574 0a20 2020 2020 2020 2020 2020 2041  et.            A
-00040df0: 206e 6577 2064 6174 6173 6574 2077 6865   new dataset whe
-00040e00: 7265 2061 6c6c 2074 6865 2073 7065 6369  re all the speci
-00040e10: 6669 6564 2064 696d 7320 6172 6520 736f  fied dims are so
-00040e20: 7274 6564 2062 7920 6469 6d0a 2020 2020  rted by dim.    
-00040e30: 2020 2020 2020 2020 6c61 6265 6c73 2e0a          labels..
-00040e40: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-00040e50: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-00040e60: 2d2d 0a20 2020 2020 2020 2044 6174 6141  --.        DataA
-00040e70: 7272 6179 2e73 6f72 7462 790a 2020 2020  rray.sortby.    
-00040e80: 2020 2020 6e75 6d70 792e 736f 7274 0a20      numpy.sort. 
-00040e90: 2020 2020 2020 2070 616e 6461 732e 736f         pandas.so
-00040ea0: 7274 5f76 616c 7565 730a 2020 2020 2020  rt_values.      
-00040eb0: 2020 7061 6e64 6173 2e73 6f72 745f 696e    pandas.sort_in
-00040ec0: 6465 780a 0a20 2020 2020 2020 2045 7861  dex..        Exa
-00040ed0: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
-00040ee0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
-00040ef0: 3e3e 2064 7320 3d20 7872 2e44 6174 6173  >> ds = xr.Datas
-00040f00: 6574 280a 2020 2020 2020 2020 2e2e 2e20  et(.        ... 
-00040f10: 2020 2020 7b0a 2020 2020 2020 2020 2e2e      {.        ..
-00040f20: 2e20 2020 2020 2020 2020 2241 223a 2028  .         "A": (
-00040f30: 2822 7822 2c20 2279 2229 2c20 5b5b 312c  ("x", "y"), [[1,
-00040f40: 2032 5d2c 205b 332c 2034 5d5d 292c 0a20   2], [3, 4]]),. 
-00040f50: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-00040f60: 2020 2022 4222 3a20 2828 2278 222c 2022     "B": (("x", "
-00040f70: 7922 292c 205b 5b35 2c20 365d 2c20 5b37  y"), [[5, 6], [7
-00040f80: 2c20 385d 5d29 2c0a 2020 2020 2020 2020  , 8]]),.        
-00040f90: 2e2e 2e20 2020 2020 7d2c 0a20 2020 2020  ...     },.     
-00040fa0: 2020 202e 2e2e 2020 2020 2063 6f6f 7264     ...     coord
-00040fb0: 733d 7b22 7822 3a20 5b22 6222 2c20 2261  s={"x": ["b", "a
-00040fc0: 225d 2c20 2279 223a 205b 312c 2030 5d7d  "], "y": [1, 0]}
-00040fd0: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
-00040fe0: 2020 2020 2020 2020 3e3e 3e20 6473 203d          >>> ds =
-00040ff0: 2064 732e 736f 7274 6279 2822 7822 290a   ds.sortby("x").
-00041000: 2020 2020 2020 2020 3e3e 3e20 6473 0a20          >>> ds. 
-00041010: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
-00041020: 6174 6173 6574 3e0a 2020 2020 2020 2020  ataset>.        
-00041030: 4469 6d65 6e73 696f 6e73 3a20 2028 783a  Dimensions:  (x:
-00041040: 2032 2c20 793a 2032 290a 2020 2020 2020   2, y: 2).      
-00041050: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
-00041060: 2020 2020 2020 2020 202a 2078 2020 2020           * x    
-00041070: 2020 2020 2878 2920 3c55 3120 2761 2720      (x) <U1 'a' 
-00041080: 2762 270a 2020 2020 2020 2020 2020 2a20  'b'.          * 
-00041090: 7920 2020 2020 2020 2028 7929 2069 6e74  y        (y) int
-000410a0: 3634 2031 2030 0a20 2020 2020 2020 2044  64 1 0.        D
-000410b0: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
-000410c0: 2020 2020 2020 2020 2020 2041 2020 2020             A    
-000410d0: 2020 2020 2878 2c20 7929 2069 6e74 3634      (x, y) int64
-000410e0: 2033 2034 2031 2032 0a20 2020 2020 2020   3 4 1 2.       
-000410f0: 2020 2020 2042 2020 2020 2020 2020 2878       B        (x
-00041100: 2c20 7929 2069 6e74 3634 2037 2038 2035  , y) int64 7 8 5
-00041110: 2036 0a20 2020 2020 2020 2022 2222 0a20   6.        """. 
-00041120: 2020 2020 2020 2066 726f 6d20 7861 7272         from xarr
-00041130: 6179 2e63 6f72 652e 6461 7461 6172 7261  ay.core.dataarra
-00041140: 7920 696d 706f 7274 2044 6174 6141 7272  y import DataArr
-00041150: 6179 0a0a 2020 2020 2020 2020 6966 206e  ay..        if n
-00041160: 6f74 2069 7369 6e73 7461 6e63 6528 7661  ot isinstance(va
-00041170: 7269 6162 6c65 732c 206c 6973 7429 3a0a  riables, list):.
-00041180: 2020 2020 2020 2020 2020 2020 7661 7269              vari
-00041190: 6162 6c65 7320 3d20 5b76 6172 6961 626c  ables = [variabl
-000411a0: 6573 5d0a 2020 2020 2020 2020 656c 7365  es].        else
-000411b0: 3a0a 2020 2020 2020 2020 2020 2020 7661  :.            va
-000411c0: 7269 6162 6c65 7320 3d20 7661 7269 6162  riables = variab
-000411d0: 6c65 730a 2020 2020 2020 2020 6172 7261  les.        arra
-000411e0: 7973 203d 205b 7620 6966 2069 7369 6e73  ys = [v if isins
-000411f0: 7461 6e63 6528 762c 2044 6174 6141 7272  tance(v, DataArr
-00041200: 6179 2920 656c 7365 2073 656c 665b 765d  ay) else self[v]
-00041210: 2066 6f72 2076 2069 6e20 7661 7269 6162   for v in variab
-00041220: 6c65 735d 0a20 2020 2020 2020 2061 6c69  les].        ali
-00041230: 676e 6564 5f76 6172 7320 3d20 616c 6967  gned_vars = alig
-00041240: 6e28 7365 6c66 2c20 2a61 7272 6179 732c  n(self, *arrays,
-00041250: 206a 6f69 6e3d 226c 6566 7422 2920 2023   join="left")  #
-00041260: 2074 7970 653a 2069 676e 6f72 655b 7479   type: ignore[ty
-00041270: 7065 2d76 6172 5d0a 2020 2020 2020 2020  pe-var].        
-00041280: 616c 6967 6e65 645f 7365 6c66 3a20 545f  aligned_self: T_
-00041290: 4461 7461 7365 7420 3d20 616c 6967 6e65  Dataset = aligne
-000412a0: 645f 7661 7273 5b30 5d20 2023 2074 7970  d_vars[0]  # typ
-000412b0: 653a 2069 676e 6f72 655b 6173 7369 676e  e: ignore[assign
-000412c0: 6d65 6e74 5d0a 2020 2020 2020 2020 616c  ment].        al
-000412d0: 6967 6e65 645f 6f74 6865 725f 7661 7273  igned_other_vars
-000412e0: 3a20 7475 706c 655b 4461 7461 4172 7261  : tuple[DataArra
-000412f0: 792c 202e 2e2e 5d20 3d20 616c 6967 6e65  y, ...] = aligne
-00041300: 645f 7661 7273 5b31 3a5d 2020 2320 7479  d_vars[1:]  # ty
-00041310: 7065 3a20 6967 6e6f 7265 5b61 7373 6967  pe: ignore[assig
-00041320: 6e6d 656e 745d 0a20 2020 2020 2020 2076  nment].        v
-00041330: 6172 735f 6279 5f64 696d 203d 2064 6566  ars_by_dim = def
-00041340: 6175 6c74 6469 6374 286c 6973 7429 0a20  aultdict(list). 
-00041350: 2020 2020 2020 2066 6f72 2064 6174 615f         for data_
-00041360: 6172 7261 7920 696e 2061 6c69 676e 6564  array in aligned
-00041370: 5f6f 7468 6572 5f76 6172 733a 0a20 2020  _other_vars:.   
-00041380: 2020 2020 2020 2020 2069 6620 6461 7461           if data
-00041390: 5f61 7272 6179 2e6e 6469 6d20 213d 2031  _array.ndim != 1
-000413a0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000413b0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
-000413c0: 6f72 2822 496e 7075 7420 4461 7461 4172  or("Input DataAr
-000413d0: 7261 7920 6973 206e 6f74 2031 2d44 2e22  ray is not 1-D."
-000413e0: 290a 2020 2020 2020 2020 2020 2020 286b  ).            (k
-000413f0: 6579 2c29 203d 2064 6174 615f 6172 7261  ey,) = data_arra
-00041400: 792e 6469 6d73 0a20 2020 2020 2020 2020  y.dims.         
-00041410: 2020 2076 6172 735f 6279 5f64 696d 5b6b     vars_by_dim[k
-00041420: 6579 5d2e 6170 7065 6e64 2864 6174 615f  ey].append(data_
-00041430: 6172 7261 7929 0a0a 2020 2020 2020 2020  array)..        
-00041440: 696e 6469 6365 7320 3d20 7b7d 0a20 2020  indices = {}.   
-00041450: 2020 2020 2066 6f72 206b 6579 2c20 6172       for key, ar
-00041460: 7261 7973 2069 6e20 7661 7273 5f62 795f  rays in vars_by_
-00041470: 6469 6d2e 6974 656d 7328 293a 0a20 2020  dim.items():.   
-00041480: 2020 2020 2020 2020 206f 7264 6572 203d           order =
-00041490: 206e 702e 6c65 7873 6f72 7428 7475 706c   np.lexsort(tupl
-000414a0: 6528 7265 7665 7273 6564 2861 7272 6179  e(reversed(array
-000414b0: 7329 2929 0a20 2020 2020 2020 2020 2020  s))).           
-000414c0: 2069 6e64 6963 6573 5b6b 6579 5d20 3d20   indices[key] = 
-000414d0: 6f72 6465 7220 6966 2061 7363 656e 6469  order if ascendi
-000414e0: 6e67 2065 6c73 6520 6f72 6465 725b 3a3a  ng else order[::
-000414f0: 2d31 5d0a 2020 2020 2020 2020 7265 7475  -1].        retu
-00041500: 726e 2061 6c69 676e 6564 5f73 656c 662e  rn aligned_self.
-00041510: 6973 656c 2869 6e64 6963 6573 290a 0a20  isel(indices).. 
-00041520: 2020 2064 6566 2071 7561 6e74 696c 6528     def quantile(
-00041530: 0a20 2020 2020 2020 2073 656c 663a 2054  .        self: T
-00041540: 5f44 6174 6173 6574 2c0a 2020 2020 2020  _Dataset,.      
-00041550: 2020 713a 2041 7272 6179 4c69 6b65 2c0a    q: ArrayLike,.
-00041560: 2020 2020 2020 2020 6469 6d3a 2044 696d          dim: Dim
-00041570: 7320 3d20 4e6f 6e65 2c0a 2020 2020 2020  s = None,.      
-00041580: 2020 6d65 7468 6f64 3a20 5175 616e 7469    method: Quanti
-00041590: 6c65 4d65 7468 6f64 7320 3d20 226c 696e  leMethods = "lin
-000415a0: 6561 7222 2c0a 2020 2020 2020 2020 6e75  ear",.        nu
-000415b0: 6d65 7269 635f 6f6e 6c79 3a20 626f 6f6c  meric_only: bool
-000415c0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
-000415d0: 2020 6b65 6570 5f61 7474 7273 3a20 626f    keep_attrs: bo
-000415e0: 6f6c 207c 204e 6f6e 6520 3d20 4e6f 6e65  ol | None = None
-000415f0: 2c0a 2020 2020 2020 2020 736b 6970 6e61  ,.        skipna
-00041600: 3a20 626f 6f6c 207c 204e 6f6e 6520 3d20  : bool | None = 
-00041610: 4e6f 6e65 2c0a 2020 2020 2020 2020 696e  None,.        in
-00041620: 7465 7270 6f6c 6174 696f 6e3a 2051 7561  terpolation: Qua
-00041630: 6e74 696c 654d 6574 686f 6473 207c 204e  ntileMethods | N
-00041640: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-00041650: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
-00041660: 2020 2020 2020 2020 2222 2243 6f6d 7075          """Compu
-00041670: 7465 2074 6865 2071 7468 2071 7561 6e74  te the qth quant
-00041680: 696c 6520 6f66 2074 6865 2064 6174 6120  ile of the data 
-00041690: 616c 6f6e 6720 7468 6520 7370 6563 6966  along the specif
-000416a0: 6965 6420 6469 6d65 6e73 696f 6e2e 0a0a  ied dimension...
-000416b0: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
-000416c0: 7468 6520 7174 6820 7175 616e 7469 6c65  the qth quantile
-000416d0: 7328 7329 206f 6620 7468 6520 6172 7261  s(s) of the arra
-000416e0: 7920 656c 656d 656e 7473 2066 6f72 2065  y elements for e
-000416f0: 6163 6820 7661 7269 6162 6c65 0a20 2020  ach variable.   
-00041700: 2020 2020 2069 6e20 7468 6520 4461 7461       in the Data
-00041710: 7365 742e 0a0a 2020 2020 2020 2020 5061  set...        Pa
-00041720: 7261 6d65 7465 7273 0a20 2020 2020 2020  rameters.       
-00041730: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-00041740: 2020 2020 7120 3a20 666c 6f61 7420 6f72      q : float or
-00041750: 2061 7272 6179 2d6c 696b 6520 6f66 2066   array-like of f
-00041760: 6c6f 6174 0a20 2020 2020 2020 2020 2020  loat.           
-00041770: 2051 7561 6e74 696c 6520 746f 2063 6f6d   Quantile to com
-00041780: 7075 7465 2c20 7768 6963 6820 6d75 7374  pute, which must
-00041790: 2062 6520 6265 7477 6565 6e20 3020 616e   be between 0 an
-000417a0: 6420 3120 696e 636c 7573 6976 652e 0a20  d 1 inclusive.. 
-000417b0: 2020 2020 2020 2064 696d 203a 2073 7472         dim : str
-000417c0: 206f 7220 4974 6572 6162 6c65 206f 6620   or Iterable of 
-000417d0: 4861 7368 6162 6c65 2c20 6f70 7469 6f6e  Hashable, option
-000417e0: 616c 0a20 2020 2020 2020 2020 2020 2044  al.            D
-000417f0: 696d 656e 7369 6f6e 2873 2920 6f76 6572  imension(s) over
-00041800: 2077 6869 6368 2074 6f20 6170 706c 7920   which to apply 
-00041810: 7175 616e 7469 6c65 2e0a 2020 2020 2020  quantile..      
-00041820: 2020 6d65 7468 6f64 203a 2073 7472 2c20    method : str, 
-00041830: 6465 6661 756c 743a 2022 6c69 6e65 6172  default: "linear
-00041840: 220a 2020 2020 2020 2020 2020 2020 5468  ".            Th
-00041850: 6973 206f 7074 696f 6e61 6c20 7061 7261  is optional para
-00041860: 6d65 7465 7220 7370 6563 6966 6965 7320  meter specifies 
-00041870: 7468 6520 696e 7465 7270 6f6c 6174 696f  the interpolatio
-00041880: 6e20 6d65 7468 6f64 2074 6f20 7573 6520  n method to use 
-00041890: 7768 656e 2074 6865 0a20 2020 2020 2020  when the.       
-000418a0: 2020 2020 2064 6573 6972 6564 2071 7561       desired qua
-000418b0: 6e74 696c 6520 6c69 6573 2062 6574 7765  ntile lies betwe
-000418c0: 656e 2074 776f 2064 6174 6120 706f 696e  en two data poin
-000418d0: 7473 2e20 5468 6520 6f70 7469 6f6e 7320  ts. The options 
-000418e0: 736f 7274 6564 2062 7920 7468 6569 7220  sorted by their 
-000418f0: 520a 2020 2020 2020 2020 2020 2020 7479  R.            ty
-00041900: 7065 2061 7320 7375 6d6d 6172 697a 6564  pe as summarized
-00041910: 2069 6e20 7468 6520 4826 4620 7061 7065   in the H&F pape
-00041920: 7220 5b31 5d5f 2061 7265 3a0a 0a20 2020  r [1]_ are:..   
-00041930: 2020 2020 2020 2020 2020 2020 2031 2e20               1. 
-00041940: 2269 6e76 6572 7465 645f 6364 6622 2028  "inverted_cdf" (
-00041950: 2a29 0a20 2020 2020 2020 2020 2020 2020  *).             
-00041960: 2020 2032 2e20 2261 7665 7261 6765 645f     2. "averaged_
-00041970: 696e 7665 7274 6564 5f63 6466 2220 282a  inverted_cdf" (*
-00041980: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00041990: 2020 332e 2022 636c 6f73 6573 745f 6f62    3. "closest_ob
-000419a0: 7365 7276 6174 696f 6e22 2028 2a29 0a20  servation" (*). 
-000419b0: 2020 2020 2020 2020 2020 2020 2020 2034                 4
-000419c0: 2e20 2269 6e74 6572 706f 6c61 7465 645f  . "interpolated_
-000419d0: 696e 7665 7274 6564 5f63 6466 2220 282a  inverted_cdf" (*
-000419e0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000419f0: 2020 352e 2022 6861 7a65 6e22 2028 2a29    5. "hazen" (*)
-00041a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00041a10: 2036 2e20 2277 6569 6275 6c6c 2220 282a   6. "weibull" (*
-00041a20: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00041a30: 2020 372e 2022 6c69 6e65 6172 2220 2028    7. "linear"  (
-00041a40: 6465 6661 756c 7429 0a20 2020 2020 2020  default).       
-00041a50: 2020 2020 2020 2020 2038 2e20 226d 6564           8. "med
-00041a60: 6961 6e5f 756e 6269 6173 6564 2220 282a  ian_unbiased" (*
-00041a70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00041a80: 2020 392e 2022 6e6f 726d 616c 5f75 6e62    9. "normal_unb
-00041a90: 6961 7365 6422 2028 2a29 0a0a 2020 2020  iased" (*)..    
-00041aa0: 2020 2020 2020 2020 5468 6520 6669 7273          The firs
-00041ab0: 7420 7468 7265 6520 6d65 7468 6f64 7320  t three methods 
-00041ac0: 6172 6520 6469 7363 6f6e 7469 756f 7573  are discontiuous
-00041ad0: 2e20 2054 6865 2066 6f6c 6c6f 7769 6e67  .  The following
-00041ae0: 2064 6973 636f 6e74 696e 756f 7573 0a20   discontinuous. 
-00041af0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-00041b00: 7469 6f6e 7320 6f66 2074 6865 2064 6566  tions of the def
-00041b10: 6175 6c74 2022 6c69 6e65 6172 2220 2837  ault "linear" (7
-00041b20: 2e29 206f 7074 696f 6e20 6172 6520 616c  .) option are al
-00041b30: 736f 2061 7661 696c 6162 6c65 3a0a 0a20  so available:.. 
-00041b40: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-00041b50: 2022 6c6f 7765 7222 0a20 2020 2020 2020   "lower".       
-00041b60: 2020 2020 2020 2020 202a 2022 6869 6768           * "high
-00041b70: 6572 220a 2020 2020 2020 2020 2020 2020  er".            
-00041b80: 2020 2020 2a20 226d 6964 706f 696e 7422      * "midpoint"
-00041b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00041ba0: 202a 2022 6e65 6172 6573 7422 0a0a 2020   * "nearest"..  
-00041bb0: 2020 2020 2020 2020 2020 5365 6520 3a70            See :p
-00041bc0: 793a 6675 6e63 3a60 6e75 6d70 792e 7175  y:func:`numpy.qu
-00041bd0: 616e 7469 6c65 6020 6f72 205b 315d 5f20  antile` or [1]_ 
-00041be0: 666f 7220 6465 7461 696c 732e 2054 6865  for details. The
-00041bf0: 2022 6d65 7468 6f64 2220 6172 6775 6d65   "method" argume
-00041c00: 6e74 0a20 2020 2020 2020 2020 2020 2077  nt.            w
-00041c10: 6173 2070 7265 7669 6f75 736c 7920 6361  as previously ca
-00041c20: 6c6c 6564 2022 696e 7465 7270 6f6c 6174  lled "interpolat
-00041c30: 696f 6e22 2c20 7265 6e61 6d65 6420 696e  ion", renamed in
-00041c40: 2061 6363 6f72 6461 6e63 6520 7769 7468   accordance with
-00041c50: 206e 756d 7079 0a20 2020 2020 2020 2020   numpy.         
-00041c60: 2020 2076 6572 7369 6f6e 2031 2e32 322e     version 1.22.
-00041c70: 302e 0a0a 2020 2020 2020 2020 2020 2020  0...            
-00041c80: 282a 2920 5468 6573 6520 6d65 7468 6f64  (*) These method
-00041c90: 7320 7265 7175 6972 6520 6e75 6d70 7920  s require numpy 
-00041ca0: 7665 7273 696f 6e20 312e 3232 206f 7220  version 1.22 or 
-00041cb0: 6e65 7765 722e 0a0a 2020 2020 2020 2020  newer...        
-00041cc0: 6b65 6570 5f61 7474 7273 203a 2062 6f6f  keep_attrs : boo
-00041cd0: 6c2c 206f 7074 696f 6e61 6c0a 2020 2020  l, optional.    
-00041ce0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-00041cf0: 2074 6865 2064 6174 6173 6574 2773 2061   the dataset's a
-00041d00: 7474 7269 6275 7465 7320 2860 6174 7472  ttributes (`attr
-00041d10: 7360 2920 7769 6c6c 2062 6520 636f 7069  s`) will be copi
-00041d20: 6564 2066 726f 6d0a 2020 2020 2020 2020  ed from.        
-00041d30: 2020 2020 7468 6520 6f72 6967 696e 616c      the original
-00041d40: 206f 626a 6563 7420 746f 2074 6865 206e   object to the n
-00041d50: 6577 206f 6e65 2e20 2049 6620 4661 6c73  ew one.  If Fals
-00041d60: 6520 2864 6566 6175 6c74 292c 2074 6865  e (default), the
-00041d70: 206e 6577 0a20 2020 2020 2020 2020 2020   new.           
-00041d80: 206f 626a 6563 7420 7769 6c6c 2062 6520   object will be 
-00041d90: 7265 7475 726e 6564 2077 6974 686f 7574  returned without
-00041da0: 2061 7474 7269 6275 7465 732e 0a20 2020   attributes..   
-00041db0: 2020 2020 206e 756d 6572 6963 5f6f 6e6c       numeric_onl
-00041dc0: 7920 3a20 626f 6f6c 2c20 6f70 7469 6f6e  y : bool, option
-00041dd0: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
-00041de0: 6620 5472 7565 2c20 6f6e 6c79 2061 7070  f True, only app
-00041df0: 6c79 2060 6066 756e 6360 6020 746f 2076  ly ``func`` to v
-00041e00: 6172 6961 626c 6573 2077 6974 6820 6120  ariables with a 
-00041e10: 6e75 6d65 7269 6320 6474 7970 652e 0a20  numeric dtype.. 
-00041e20: 2020 2020 2020 2073 6b69 706e 6120 3a20         skipna : 
-00041e30: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-00041e40: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
-00041e50: 7565 2c20 736b 6970 206d 6973 7369 6e67  ue, skip missing
-00041e60: 2076 616c 7565 7320 2861 7320 6d61 726b   values (as mark
-00041e70: 6564 2062 7920 4e61 4e29 2e20 4279 2064  ed by NaN). By d
-00041e80: 6566 6175 6c74 2c20 6f6e 6c79 0a20 2020  efault, only.   
-00041e90: 2020 2020 2020 2020 2073 6b69 7073 206d           skips m
-00041ea0: 6973 7369 6e67 2076 616c 7565 7320 666f  issing values fo
-00041eb0: 7220 666c 6f61 7420 6474 7970 6573 3b20  r float dtypes; 
-00041ec0: 6f74 6865 7220 6474 7970 6573 2065 6974  other dtypes eit
-00041ed0: 6865 7220 646f 206e 6f74 0a20 2020 2020  her do not.     
-00041ee0: 2020 2020 2020 2068 6176 6520 6120 7365         have a se
-00041ef0: 6e74 696e 656c 206d 6973 7369 6e67 2076  ntinel missing v
-00041f00: 616c 7565 2028 696e 7429 206f 7220 736b  alue (int) or sk
-00041f10: 6970 6e61 3d54 7275 6520 6861 7320 6e6f  ipna=True has no
-00041f20: 7420 6265 656e 0a20 2020 2020 2020 2020  t been.         
-00041f30: 2020 2069 6d70 6c65 6d65 6e74 6564 2028     implemented (
-00041f40: 6f62 6a65 6374 2c20 6461 7465 7469 6d65  object, datetime
-00041f50: 3634 206f 7220 7469 6d65 6465 6c74 6136  64 or timedelta6
-00041f60: 3429 2e0a 0a20 2020 2020 2020 2052 6574  4)...        Ret
-00041f70: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-00041f80: 2d2d 2d2d 0a20 2020 2020 2020 2071 7561  ----.        qua
-00041f90: 6e74 696c 6573 203a 2044 6174 6173 6574  ntiles : Dataset
-00041fa0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-00041fb0: 6071 6020 6973 2061 2073 696e 676c 6520  `q` is a single 
-00041fc0: 7175 616e 7469 6c65 2c20 7468 656e 2074  quantile, then t
-00041fd0: 6865 2072 6573 756c 7420 6973 2061 2073  he result is a s
-00041fe0: 6361 6c61 7220 666f 7220 6561 6368 0a20  calar for each. 
-00041ff0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-00042000: 626c 6520 696e 2064 6174 615f 7661 7273  ble in data_vars
-00042010: 2e20 4966 206d 756c 7469 706c 6520 7065  . If multiple pe
-00042020: 7263 656e 7469 6c65 7320 6172 6520 6769  rcentiles are gi
-00042030: 7665 6e2c 2066 6972 7374 0a20 2020 2020  ven, first.     
-00042040: 2020 2020 2020 2061 7869 7320 6f66 2074         axis of t
-00042050: 6865 2072 6573 756c 7420 636f 7272 6573  he result corres
-00042060: 706f 6e64 7320 746f 2074 6865 2071 7561  ponds to the qua
-00042070: 6e74 696c 6520 616e 6420 6120 7175 616e  ntile and a quan
-00042080: 7469 6c65 0a20 2020 2020 2020 2020 2020  tile.           
-00042090: 2064 696d 656e 7369 6f6e 2069 7320 6164   dimension is ad
-000420a0: 6465 6420 746f 2074 6865 2072 6574 7572  ded to the retur
-000420b0: 6e20 4461 7461 7365 742e 2054 6865 206f  n Dataset. The o
-000420c0: 7468 6572 2064 696d 656e 7369 6f6e 7320  ther dimensions 
-000420d0: 6172 650a 2020 2020 2020 2020 2020 2020  are.            
-000420e0: 7468 6520 6469 6d65 6e73 696f 6e73 2074  the dimensions t
-000420f0: 6861 7420 7265 6d61 696e 2061 6674 6572  hat remain after
-00042100: 2074 6865 2072 6564 7563 7469 6f6e 206f   the reduction o
-00042110: 6620 7468 6520 6172 7261 792e 0a0a 2020  f the array...  
-00042120: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-00042130: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-00042140: 2020 2020 2020 2020 6e75 6d70 792e 6e61          numpy.na
-00042150: 6e71 7561 6e74 696c 652c 206e 756d 7079  nquantile, numpy
-00042160: 2e71 7561 6e74 696c 652c 2070 616e 6461  .quantile, panda
-00042170: 732e 5365 7269 6573 2e71 7561 6e74 696c  s.Series.quantil
-00042180: 652c 2044 6174 6141 7272 6179 2e71 7561  e, DataArray.qua
-00042190: 6e74 696c 650a 0a20 2020 2020 2020 2045  ntile..        E
-000421a0: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-000421b0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000421c0: 203e 3e3e 2064 7320 3d20 7872 2e44 6174   >>> ds = xr.Dat
-000421d0: 6173 6574 280a 2020 2020 2020 2020 2e2e  aset(.        ..
-000421e0: 2e20 2020 2020 7b22 6122 3a20 2828 2278  .     {"a": (("x
-000421f0: 222c 2022 7922 292c 205b 5b30 2e37 2c20  ", "y"), [[0.7, 
-00042200: 342e 322c 2039 2e34 2c20 312e 355d 2c20  4.2, 9.4, 1.5], 
-00042210: 5b36 2e35 2c20 372e 332c 2032 2e36 2c20  [6.5, 7.3, 2.6, 
-00042220: 312e 395d 5d29 7d2c 0a20 2020 2020 2020  1.9]])},.       
-00042230: 202e 2e2e 2020 2020 2063 6f6f 7264 733d   ...     coords=
-00042240: 7b22 7822 3a20 5b37 2c20 395d 2c20 2279  {"x": [7, 9], "y
-00042250: 223a 205b 312c 2031 2e35 2c20 322c 2032  ": [1, 1.5, 2, 2
-00042260: 2e35 5d7d 2c0a 2020 2020 2020 2020 2e2e  .5]},.        ..
-00042270: 2e20 290a 2020 2020 2020 2020 3e3e 3e20  . ).        >>> 
-00042280: 6473 2e71 7561 6e74 696c 6528 3029 2020  ds.quantile(0)  
-00042290: 2320 6f72 2064 732e 7175 616e 7469 6c65  # or ds.quantile
-000422a0: 2830 2c20 6469 6d3d 2e2e 2e29 0a20 2020  (0, dim=...).   
-000422b0: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
-000422c0: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
-000422d0: 6d65 6e73 696f 6e73 3a20 2020 2829 0a20  mensions:   (). 
-000422e0: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
-000422f0: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00042300: 7175 616e 7469 6c65 2020 666c 6f61 7436  quantile  float6
-00042310: 3420 302e 300a 2020 2020 2020 2020 4461  4 0.0.        Da
-00042320: 7461 2076 6172 6961 626c 6573 3a0a 2020  ta variables:.  
-00042330: 2020 2020 2020 2020 2020 6120 2020 2020            a     
-00042340: 2020 2020 666c 6f61 7436 3420 302e 370a      float64 0.7.
-00042350: 2020 2020 2020 2020 3e3e 3e20 6473 2e71          >>> ds.q
-00042360: 7561 6e74 696c 6528 302c 2064 696d 3d22  uantile(0, dim="
-00042370: 7822 290a 2020 2020 2020 2020 3c78 6172  x").        <xar
-00042380: 7261 792e 4461 7461 7365 743e 0a20 2020  ray.Dataset>.   
-00042390: 2020 2020 2044 696d 656e 7369 6f6e 733a       Dimensions:
-000423a0: 2020 2028 793a 2034 290a 2020 2020 2020     (y: 4).      
-000423b0: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
-000423c0: 2020 2020 2020 2020 202a 2079 2020 2020           * y    
-000423d0: 2020 2020 2028 7929 2066 6c6f 6174 3634       (y) float64
-000423e0: 2031 2e30 2031 2e35 2032 2e30 2032 2e35   1.0 1.5 2.0 2.5
-000423f0: 0a20 2020 2020 2020 2020 2020 2071 7561  .            qua
-00042400: 6e74 696c 6520 2066 6c6f 6174 3634 2030  ntile  float64 0
-00042410: 2e30 0a20 2020 2020 2020 2044 6174 6120  .0.        Data 
-00042420: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
-00042430: 2020 2020 2020 2061 2020 2020 2020 2020         a        
-00042440: 2028 7929 2066 6c6f 6174 3634 2030 2e37   (y) float64 0.7
-00042450: 2034 2e32 2032 2e36 2031 2e35 0a20 2020   4.2 2.6 1.5.   
-00042460: 2020 2020 203e 3e3e 2064 732e 7175 616e       >>> ds.quan
-00042470: 7469 6c65 285b 302c 2030 2e35 2c20 315d  tile([0, 0.5, 1]
-00042480: 290a 2020 2020 2020 2020 3c78 6172 7261  ).        <xarra
-00042490: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
-000424a0: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
-000424b0: 2028 7175 616e 7469 6c65 3a20 3329 0a20   (quantile: 3). 
-000424c0: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
-000424d0: 6573 3a0a 2020 2020 2020 2020 2020 2a20  es:.          * 
-000424e0: 7175 616e 7469 6c65 2020 2871 7561 6e74  quantile  (quant
-000424f0: 696c 6529 2066 6c6f 6174 3634 2030 2e30  ile) float64 0.0
-00042500: 2030 2e35 2031 2e30 0a20 2020 2020 2020   0.5 1.0.       
-00042510: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
-00042520: 0a20 2020 2020 2020 2020 2020 2061 2020  .            a  
-00042530: 2020 2020 2020 2028 7175 616e 7469 6c65         (quantile
-00042540: 2920 666c 6f61 7436 3420 302e 3720 332e  ) float64 0.7 3.
-00042550: 3420 392e 340a 2020 2020 2020 2020 3e3e  4 9.4.        >>
-00042560: 3e20 6473 2e71 7561 6e74 696c 6528 5b30  > ds.quantile([0
-00042570: 2c20 302e 352c 2031 5d2c 2064 696d 3d22  , 0.5, 1], dim="
-00042580: 7822 290a 2020 2020 2020 2020 3c78 6172  x").        <xar
-00042590: 7261 792e 4461 7461 7365 743e 0a20 2020  ray.Dataset>.   
-000425a0: 2020 2020 2044 696d 656e 7369 6f6e 733a       Dimensions:
-000425b0: 2020 2028 7175 616e 7469 6c65 3a20 332c     (quantile: 3,
-000425c0: 2079 3a20 3429 0a20 2020 2020 2020 2043   y: 4).        C
-000425d0: 6f6f 7264 696e 6174 6573 3a0a 2020 2020  oordinates:.    
-000425e0: 2020 2020 2020 2a20 7920 2020 2020 2020        * y       
-000425f0: 2020 2879 2920 666c 6f61 7436 3420 312e    (y) float64 1.
-00042600: 3020 312e 3520 322e 3020 322e 350a 2020  0 1.5 2.0 2.5.  
-00042610: 2020 2020 2020 2020 2a20 7175 616e 7469          * quanti
-00042620: 6c65 2020 2871 7561 6e74 696c 6529 2066  le  (quantile) f
-00042630: 6c6f 6174 3634 2030 2e30 2030 2e35 2031  loat64 0.0 0.5 1
-00042640: 2e30 0a20 2020 2020 2020 2044 6174 6120  .0.        Data 
-00042650: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
-00042660: 2020 2020 2020 2061 2020 2020 2020 2020         a        
-00042670: 2028 7175 616e 7469 6c65 2c20 7929 2066   (quantile, y) f
-00042680: 6c6f 6174 3634 2030 2e37 2034 2e32 2032  loat64 0.7 4.2 2
-00042690: 2e36 2031 2e35 2033 2e36 202e 2e2e 2031  .6 1.5 3.6 ... 1
-000426a0: 2e37 2036 2e35 2037 2e33 2039 2e34 2031  .7 6.5 7.3 9.4 1
-000426b0: 2e39 0a0a 2020 2020 2020 2020 5265 6665  .9..        Refe
-000426c0: 7265 6e63 6573 0a20 2020 2020 2020 202d  rences.        -
-000426d0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-000426e0: 2020 2e2e 205b 315d 2052 2e20 4a2e 2048    .. [1] R. J. H
-000426f0: 796e 646d 616e 2061 6e64 2059 2e20 4661  yndman and Y. Fa
-00042700: 6e2c 0a20 2020 2020 2020 2020 2020 2253  n,.           "S
-00042710: 616d 706c 6520 7175 616e 7469 6c65 7320  ample quantiles 
-00042720: 696e 2073 7461 7469 7374 6963 616c 2070  in statistical p
-00042730: 6163 6b61 6765 732c 220a 2020 2020 2020  ackages,".      
-00042740: 2020 2020 2054 6865 2041 6d65 7269 6361       The America
-00042750: 6e20 5374 6174 6973 7469 6369 616e 2c20  n Statistician, 
-00042760: 3530 2834 292c 2070 702e 2033 3631 2d33  50(4), pp. 361-3
-00042770: 3635 2c20 3139 3936 0a20 2020 2020 2020  65, 1996.       
-00042780: 2022 2222 0a0a 2020 2020 2020 2020 2320   """..        # 
-00042790: 696e 7465 7270 6f6c 6174 696f 6e20 7265  interpolation re
-000427a0: 6e61 6d65 6420 746f 206d 6574 686f 6420  named to method 
-000427b0: 696e 2076 6572 7369 6f6e 2030 2e32 312e  in version 0.21.
-000427c0: 300a 2020 2020 2020 2020 2320 6368 6563  0.        # chec
-000427d0: 6b20 6865 7265 2061 6e64 2069 6e20 7661  k here and in va
-000427e0: 7269 6162 6c65 2074 6f20 6176 6f69 6420  riable to avoid 
-000427f0: 7265 7065 6174 6564 2077 6172 6e69 6e67  repeated warning
-00042800: 730a 2020 2020 2020 2020 6966 2069 6e74  s.        if int
-00042810: 6572 706f 6c61 7469 6f6e 2069 7320 6e6f  erpolation is no
-00042820: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-00042830: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00042840: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
-00042850: 2020 2022 5468 6520 6069 6e74 6572 706f     "The `interpo
-00042860: 6c61 7469 6f6e 6020 6172 6775 6d65 6e74  lation` argument
-00042870: 2074 6f20 7175 616e 7469 6c65 2077 6173   to quantile was
-00042880: 2072 656e 616d 6564 2074 6f20 606d 6574   renamed to `met
-00042890: 686f 6460 2e22 2c0a 2020 2020 2020 2020  hod`.",.        
-000428a0: 2020 2020 2020 2020 4675 7475 7265 5761          FutureWa
-000428b0: 726e 696e 672c 0a20 2020 2020 2020 2020  rning,.         
-000428c0: 2020 2029 0a0a 2020 2020 2020 2020 2020     )..          
-000428d0: 2020 6966 206d 6574 686f 6420 213d 2022    if method != "
-000428e0: 6c69 6e65 6172 223a 0a20 2020 2020 2020  linear":.       
-000428f0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00042900: 7970 6545 7272 6f72 2822 4361 6e6e 6f74  ypeError("Cannot
-00042910: 2070 6173 7320 696e 7465 7270 6f6c 6174   pass interpolat
-00042920: 696f 6e20 616e 6420 6d65 7468 6f64 206b  ion and method k
-00042930: 6579 776f 7264 7321 2229 0a0a 2020 2020  eywords!")..    
-00042940: 2020 2020 2020 2020 6d65 7468 6f64 203d          method =
-00042950: 2069 6e74 6572 706f 6c61 7469 6f6e 0a0a   interpolation..
-00042960: 2020 2020 2020 2020 6469 6d73 3a20 7365          dims: se
-00042970: 745b 4861 7368 6162 6c65 5d0a 2020 2020  t[Hashable].    
-00042980: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-00042990: 6528 6469 6d2c 2073 7472 293a 0a20 2020  e(dim, str):.   
-000429a0: 2020 2020 2020 2020 2064 696d 7320 3d20           dims = 
-000429b0: 7b64 696d 7d0a 2020 2020 2020 2020 656c  {dim}.        el
-000429c0: 6966 2064 696d 2069 7320 4e6f 6e65 206f  if dim is None o
-000429d0: 7220 6469 6d20 6973 202e 2e2e 3a0a 2020  r dim is ...:.  
-000429e0: 2020 2020 2020 2020 2020 6469 6d73 203d            dims =
-000429f0: 2073 6574 2873 656c 662e 6469 6d73 290a   set(self.dims).
-00042a00: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00042a10: 2020 2020 2020 2020 2020 6469 6d73 203d            dims =
-00042a20: 2073 6574 2864 696d 290a 0a20 2020 2020   set(dim)..     
-00042a30: 2020 205f 6173 7365 7274 5f65 6d70 7479     _assert_empty
-00042a40: 280a 2020 2020 2020 2020 2020 2020 7475  (.            tu
-00042a50: 706c 6528 6420 666f 7220 6420 696e 2064  ple(d for d in d
-00042a60: 696d 7320 6966 2064 206e 6f74 2069 6e20  ims if d not in 
-00042a70: 7365 6c66 2e64 696d 7329 2c0a 2020 2020  self.dims),.    
-00042a80: 2020 2020 2020 2020 2244 6174 6173 6574          "Dataset
-00042a90: 2064 6f65 7320 6e6f 7420 636f 6e74 6169   does not contai
-00042aa0: 6e20 7468 6520 6469 6d65 6e73 696f 6e73  n the dimensions
-00042ab0: 3a20 2573 222c 0a20 2020 2020 2020 2029  : %s",.        )
-00042ac0: 0a0a 2020 2020 2020 2020 7120 3d20 6e70  ..        q = np
-00042ad0: 2e61 7361 7272 6179 2871 2c20 6474 7970  .asarray(q, dtyp
-00042ae0: 653d 6e70 2e66 6c6f 6174 3634 290a 0a20  e=np.float64).. 
-00042af0: 2020 2020 2020 2076 6172 6961 626c 6573         variables
-00042b00: 203d 207b 7d0a 2020 2020 2020 2020 666f   = {}.        fo
-00042b10: 7220 6e61 6d65 2c20 7661 7220 696e 2073  r name, var in s
-00042b20: 656c 662e 7661 7269 6162 6c65 732e 6974  elf.variables.it
-00042b30: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-00042b40: 2020 2072 6564 7563 655f 6469 6d73 203d     reduce_dims =
-00042b50: 205b 6420 666f 7220 6420 696e 2076 6172   [d for d in var
-00042b60: 2e64 696d 7320 6966 2064 2069 6e20 6469  .dims if d in di
-00042b70: 6d73 5d0a 2020 2020 2020 2020 2020 2020  ms].            
-00042b80: 6966 2072 6564 7563 655f 6469 6d73 206f  if reduce_dims o
-00042b90: 7220 6e6f 7420 7661 722e 6469 6d73 3a0a  r not var.dims:.
-00042ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042bb0: 6966 206e 616d 6520 6e6f 7420 696e 2073  if name not in s
-00042bc0: 656c 662e 636f 6f72 6473 3a0a 2020 2020  elf.coords:.    
-00042bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042be0: 6966 2028 0a20 2020 2020 2020 2020 2020  if (.           
-00042bf0: 2020 2020 2020 2020 2020 2020 206e 6f74               not
-00042c00: 206e 756d 6572 6963 5f6f 6e6c 790a 2020   numeric_only.  
-00042c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042c20: 2020 2020 2020 6f72 206e 702e 6973 7375        or np.issu
-00042c30: 6264 7479 7065 2876 6172 2e64 7479 7065  bdtype(var.dtype
-00042c40: 2c20 6e70 2e6e 756d 6265 7229 0a20 2020  , np.number).   
-00042c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042c60: 2020 2020 206f 7220 7661 722e 6474 7970       or var.dtyp
-00042c70: 6520 3d3d 206e 702e 626f 6f6c 5f0a 2020  e == np.bool_.  
-00042c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042c90: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-00042ca0: 2020 2020 2020 2020 2020 2020 2076 6172               var
-00042cb0: 6961 626c 6573 5b6e 616d 655d 203d 2076  iables[name] = v
-00042cc0: 6172 2e71 7561 6e74 696c 6528 0a20 2020  ar.quantile(.   
-00042cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042ce0: 2020 2020 2020 2020 2071 2c0a 2020 2020           q,.    
-00042cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d00: 2020 2020 2020 2020 6469 6d3d 7265 6475          dim=redu
-00042d10: 6365 5f64 696d 732c 0a20 2020 2020 2020  ce_dims,.       
-00042d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d30: 2020 2020 206d 6574 686f 643d 6d65 7468       method=meth
-00042d40: 6f64 2c0a 2020 2020 2020 2020 2020 2020  od,.            
-00042d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d60: 6b65 6570 5f61 7474 7273 3d6b 6565 705f  keep_attrs=keep_
-00042d70: 6174 7472 732c 0a20 2020 2020 2020 2020  attrs,.         
-00042d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00042d90: 2020 2073 6b69 706e 613d 736b 6970 6e61     skipna=skipna
-00042da0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00042db0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00042dc0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-00042dd0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00042de0: 6172 6961 626c 6573 5b6e 616d 655d 203d  ariables[name] =
-00042df0: 2076 6172 0a0a 2020 2020 2020 2020 2320   var..        # 
-00042e00: 636f 6e73 7472 7563 7420 7468 6520 6e65  construct the ne
-00042e10: 7720 6461 7461 7365 740a 2020 2020 2020  w dataset.      
-00042e20: 2020 636f 6f72 645f 6e61 6d65 7320 3d20    coord_names = 
-00042e30: 7b6b 2066 6f72 206b 2069 6e20 7365 6c66  {k for k in self
-00042e40: 2e63 6f6f 7264 7320 6966 206b 2069 6e20  .coords if k in 
-00042e50: 7661 7269 6162 6c65 737d 0a20 2020 2020  variables}.     
-00042e60: 2020 2069 6e64 6578 6573 203d 207b 6b3a     indexes = {k:
-00042e70: 2076 2066 6f72 206b 2c20 7620 696e 2073   v for k, v in s
-00042e80: 656c 662e 5f69 6e64 6578 6573 2e69 7465  elf._indexes.ite
-00042e90: 6d73 2829 2069 6620 6b20 696e 2076 6172  ms() if k in var
-00042ea0: 6961 626c 6573 7d0a 2020 2020 2020 2020  iables}.        
-00042eb0: 6966 206b 6565 705f 6174 7472 7320 6973  if keep_attrs is
-00042ec0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00042ed0: 2020 206b 6565 705f 6174 7472 7320 3d20     keep_attrs = 
-00042ee0: 5f67 6574 5f6b 6565 705f 6174 7472 7328  _get_keep_attrs(
-00042ef0: 6465 6661 756c 743d 4661 6c73 6529 0a20  default=False). 
-00042f00: 2020 2020 2020 2061 7474 7273 203d 2073         attrs = s
-00042f10: 656c 662e 6174 7472 7320 6966 206b 6565  elf.attrs if kee
-00042f20: 705f 6174 7472 7320 656c 7365 204e 6f6e  p_attrs else Non
-00042f30: 650a 2020 2020 2020 2020 6e65 7720 3d20  e.        new = 
-00042f40: 7365 6c66 2e5f 7265 706c 6163 655f 7769  self._replace_wi
-00042f50: 7468 5f6e 6577 5f64 696d 7328 0a20 2020  th_new_dims(.   
-00042f60: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
-00042f70: 6573 2c20 636f 6f72 645f 6e61 6d65 733d  es, coord_names=
-00042f80: 636f 6f72 645f 6e61 6d65 732c 2061 7474  coord_names, att
-00042f90: 7273 3d61 7474 7273 2c20 696e 6465 7865  rs=attrs, indexe
-00042fa0: 733d 696e 6465 7865 730a 2020 2020 2020  s=indexes.      
-00042fb0: 2020 290a 2020 2020 2020 2020 7265 7475    ).        retu
-00042fc0: 726e 206e 6577 2e61 7373 6967 6e5f 636f  rn new.assign_co
-00042fd0: 6f72 6473 2871 7561 6e74 696c 653d 7129  ords(quantile=q)
-00042fe0: 0a0a 2020 2020 6465 6620 7261 6e6b 280a  ..    def rank(.
-00042ff0: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
-00043000: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
-00043010: 2064 696d 3a20 4861 7368 6162 6c65 2c0a   dim: Hashable,.
-00043020: 2020 2020 2020 2020 7063 743a 2062 6f6f          pct: boo
-00043030: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
-00043040: 2020 206b 6565 705f 6174 7472 733a 2062     keep_attrs: b
-00043050: 6f6f 6c20 7c20 4e6f 6e65 203d 204e 6f6e  ool | None = Non
-00043060: 652c 0a20 2020 2029 202d 3e20 545f 4461  e,.    ) -> T_Da
-00043070: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-00043080: 2222 5261 6e6b 7320 7468 6520 6461 7461  ""Ranks the data
-00043090: 2e0a 0a20 2020 2020 2020 2045 7175 616c  ...        Equal
-000430a0: 2076 616c 7565 7320 6172 6520 6173 7369   values are assi
-000430b0: 676e 6564 2061 2072 616e 6b20 7468 6174  gned a rank that
-000430c0: 2069 7320 7468 6520 6176 6572 6167 6520   is the average 
-000430d0: 6f66 2074 6865 2072 616e 6b73 2074 6861  of the ranks tha
-000430e0: 740a 2020 2020 2020 2020 776f 756c 6420  t.        would 
-000430f0: 6861 7665 2062 6565 6e20 6f74 6865 7277  have been otherw
-00043100: 6973 6520 6173 7369 676e 6564 2074 6f20  ise assigned to 
-00043110: 616c 6c20 6f66 2074 6865 2076 616c 7565  all of the value
-00043120: 7320 7769 7468 696e 0a20 2020 2020 2020  s within.       
-00043130: 2074 6861 7420 7365 742e 0a20 2020 2020   that set..     
-00043140: 2020 2052 616e 6b73 2062 6567 696e 2061     Ranks begin a
-00043150: 7420 312c 206e 6f74 2030 2e20 4966 2070  t 1, not 0. If p
-00043160: 6374 2069 7320 5472 7565 2c20 636f 6d70  ct is True, comp
-00043170: 7574 6573 2070 6572 6365 6e74 6167 6520  utes percentage 
-00043180: 7261 6e6b 732e 0a0a 2020 2020 2020 2020  ranks...        
-00043190: 4e61 4e73 2069 6e20 7468 6520 696e 7075  NaNs in the inpu
-000431a0: 7420 6172 7261 7920 6172 6520 7265 7475  t array are retu
-000431b0: 726e 6564 2061 7320 4e61 4e73 2e0a 0a20  rned as NaNs... 
-000431c0: 2020 2020 2020 2054 6865 2060 626f 7474         The `bott
-000431d0: 6c65 6e65 636b 6020 6c69 6272 6172 7920  leneck` library 
-000431e0: 6973 2072 6571 7569 7265 642e 0a0a 2020  is required...  
-000431f0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00043200: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00043210: 2d2d 2d0a 2020 2020 2020 2020 6469 6d20  ---.        dim 
-00043220: 3a20 4861 7368 6162 6c65 0a20 2020 2020  : Hashable.     
-00043230: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
-00043240: 206f 7665 7220 7768 6963 6820 746f 2063   over which to c
-00043250: 6f6d 7075 7465 2072 616e 6b2e 0a20 2020  ompute rank..   
-00043260: 2020 2020 2070 6374 203a 2062 6f6f 6c2c       pct : bool,
-00043270: 2064 6566 6175 6c74 3a20 4661 6c73 650a   default: False.
-00043280: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-00043290: 7275 652c 2063 6f6d 7075 7465 2070 6572  rue, compute per
-000432a0: 6365 6e74 6167 6520 7261 6e6b 732c 206f  centage ranks, o
-000432b0: 7468 6572 7769 7365 2063 6f6d 7075 7465  therwise compute
-000432c0: 2069 6e74 6567 6572 2072 616e 6b73 2e0a   integer ranks..
-000432d0: 2020 2020 2020 2020 6b65 6570 5f61 7474          keep_att
-000432e0: 7273 203a 2062 6f6f 6c20 6f72 204e 6f6e  rs : bool or Non
-000432f0: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
-00043300: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-00043310: 2074 6865 2064 6174 6173 6574 2773 2061   the dataset's a
-00043320: 7474 7269 6275 7465 7320 2860 6174 7472  ttributes (`attr
-00043330: 7360 2920 7769 6c6c 2062 6520 636f 7069  s`) will be copi
-00043340: 6564 2066 726f 6d0a 2020 2020 2020 2020  ed from.        
-00043350: 2020 2020 7468 6520 6f72 6967 696e 616c      the original
-00043360: 206f 626a 6563 7420 746f 2074 6865 206e   object to the n
-00043370: 6577 206f 6e65 2e20 2049 6620 4661 6c73  ew one.  If Fals
-00043380: 652c 2074 6865 206e 6577 0a20 2020 2020  e, the new.     
-00043390: 2020 2020 2020 206f 626a 6563 7420 7769         object wi
-000433a0: 6c6c 2062 6520 7265 7475 726e 6564 2077  ll be returned w
-000433b0: 6974 686f 7574 2061 7474 7269 6275 7465  ithout attribute
-000433c0: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
-000433d0: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-000433e0: 2d2d 2d0a 2020 2020 2020 2020 7261 6e6b  ---.        rank
-000433f0: 6564 203a 2044 6174 6173 6574 0a20 2020  ed : Dataset.   
-00043400: 2020 2020 2020 2020 2056 6172 6961 626c           Variabl
-00043410: 6573 2074 6861 7420 646f 206e 6f74 2064  es that do not d
-00043420: 6570 656e 6420 6f6e 2060 6469 6d60 2061  epend on `dim` a
-00043430: 7265 2064 726f 7070 6564 2e0a 2020 2020  re dropped..    
-00043440: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00043450: 6966 206e 6f74 204f 5054 494f 4e53 5b22  if not OPTIONS["
-00043460: 7573 655f 626f 7474 6c65 6e65 636b 225d  use_bottleneck"]
-00043470: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00043480: 6973 6520 5275 6e74 696d 6545 7272 6f72  ise RuntimeError
-00043490: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-000434a0: 2020 2272 616e 6b20 7265 7175 6972 6573    "rank requires
-000434b0: 2062 6f74 746c 656e 6563 6b20 746f 2062   bottleneck to b
-000434c0: 6520 656e 6162 6c65 642e 220a 2020 2020  e enabled.".    
-000434d0: 2020 2020 2020 2020 2020 2020 2220 4361              " Ca
-000434e0: 6c6c 2060 7872 2e73 6574 5f6f 7074 696f  ll `xr.set_optio
-000434f0: 6e73 2875 7365 5f62 6f74 746c 656e 6563  ns(use_bottlenec
-00043500: 6b3d 5472 7565 2960 2074 6f20 656e 6162  k=True)` to enab
-00043510: 6c65 2069 742e 220a 2020 2020 2020 2020  le it.".        
-00043520: 2020 2020 290a 0a20 2020 2020 2020 2069      )..        i
-00043530: 6620 6469 6d20 6e6f 7420 696e 2073 656c  f dim not in sel
-00043540: 662e 6469 6d73 3a0a 2020 2020 2020 2020  f.dims:.        
-00043550: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00043560: 7272 6f72 2866 2244 6174 6173 6574 2064  rror(f"Dataset d
-00043570: 6f65 7320 6e6f 7420 636f 6e74 6169 6e20  oes not contain 
-00043580: 7468 6520 6469 6d65 6e73 696f 6e3a 207b  the dimension: {
-00043590: 6469 6d7d 2229 0a0a 2020 2020 2020 2020  dim}")..        
-000435a0: 7661 7269 6162 6c65 7320 3d20 7b7d 0a20  variables = {}. 
-000435b0: 2020 2020 2020 2066 6f72 206e 616d 652c         for name,
-000435c0: 2076 6172 2069 6e20 7365 6c66 2e76 6172   var in self.var
-000435d0: 6961 626c 6573 2e69 7465 6d73 2829 3a0a  iables.items():.
-000435e0: 2020 2020 2020 2020 2020 2020 6966 206e              if n
-000435f0: 616d 6520 696e 2073 656c 662e 6461 7461  ame in self.data
-00043600: 5f76 6172 733a 0a20 2020 2020 2020 2020  _vars:.         
-00043610: 2020 2020 2020 2069 6620 6469 6d20 696e         if dim in
-00043620: 2076 6172 2e64 696d 733a 0a20 2020 2020   var.dims:.     
-00043630: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-00043640: 6172 6961 626c 6573 5b6e 616d 655d 203d  ariables[name] =
-00043650: 2076 6172 2e72 616e 6b28 6469 6d2c 2070   var.rank(dim, p
-00043660: 6374 3d70 6374 290a 2020 2020 2020 2020  ct=pct).        
-00043670: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00043680: 2020 2020 2020 2020 2020 7661 7269 6162            variab
-00043690: 6c65 735b 6e61 6d65 5d20 3d20 7661 720a  les[name] = var.
-000436a0: 0a20 2020 2020 2020 2063 6f6f 7264 5f6e  .        coord_n
-000436b0: 616d 6573 203d 2073 6574 2873 656c 662e  ames = set(self.
-000436c0: 636f 6f72 6473 290a 2020 2020 2020 2020  coords).        
-000436d0: 6966 206b 6565 705f 6174 7472 7320 6973  if keep_attrs is
-000436e0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-000436f0: 2020 206b 6565 705f 6174 7472 7320 3d20     keep_attrs = 
-00043700: 5f67 6574 5f6b 6565 705f 6174 7472 7328  _get_keep_attrs(
-00043710: 6465 6661 756c 743d 4661 6c73 6529 0a20  default=False). 
-00043720: 2020 2020 2020 2061 7474 7273 203d 2073         attrs = s
-00043730: 656c 662e 6174 7472 7320 6966 206b 6565  elf.attrs if kee
-00043740: 705f 6174 7472 7320 656c 7365 204e 6f6e  p_attrs else Non
-00043750: 650a 2020 2020 2020 2020 7265 7475 726e  e.        return
-00043760: 2073 656c 662e 5f72 6570 6c61 6365 2876   self._replace(v
-00043770: 6172 6961 626c 6573 2c20 636f 6f72 645f  ariables, coord_
-00043780: 6e61 6d65 732c 2061 7474 7273 3d61 7474  names, attrs=att
-00043790: 7273 290a 0a20 2020 2064 6566 2064 6966  rs)..    def dif
-000437a0: 6665 7265 6e74 6961 7465 280a 2020 2020  ferentiate(.    
-000437b0: 2020 2020 7365 6c66 3a20 545f 4461 7461      self: T_Data
-000437c0: 7365 742c 0a20 2020 2020 2020 2063 6f6f  set,.        coo
-000437d0: 7264 3a20 4861 7368 6162 6c65 2c0a 2020  rd: Hashable,.  
-000437e0: 2020 2020 2020 6564 6765 5f6f 7264 6572        edge_order
-000437f0: 3a20 4c69 7465 7261 6c5b 312c 2032 5d20  : Literal[1, 2] 
-00043800: 3d20 312c 0a20 2020 2020 2020 2064 6174  = 1,.        dat
-00043810: 6574 696d 655f 756e 6974 3a20 4461 7465  etime_unit: Date
-00043820: 7469 6d65 556e 6974 4f70 7469 6f6e 7320  timeUnitOptions 
-00043830: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00043840: 2020 2029 202d 3e20 545f 4461 7461 7365     ) -> T_Datase
-00043850: 743a 0a20 2020 2020 2020 2022 2222 2044  t:.        """ D
-00043860: 6966 6665 7265 6e74 6961 7465 2077 6974  ifferentiate wit
-00043870: 6820 7468 6520 7365 636f 6e64 206f 7264  h the second ord
-00043880: 6572 2061 6363 7572 6174 6520 6365 6e74  er accurate cent
-00043890: 7261 6c0a 2020 2020 2020 2020 6469 6666  ral.        diff
-000438a0: 6572 656e 6365 732e 0a0a 2020 2020 2020  erences...      
-000438b0: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
-000438c0: 2020 2020 2020 2020 5468 6973 2066 6561          This fea
-000438d0: 7475 7265 2069 7320 6c69 6d69 7465 6420  ture is limited 
-000438e0: 746f 2073 696d 706c 6520 6361 7274 6573  to simple cartes
-000438f0: 6961 6e20 6765 6f6d 6574 7279 2c20 692e  ian geometry, i.
-00043900: 652e 2063 6f6f 7264 0a20 2020 2020 2020  e. coord.       
-00043910: 2020 2020 206d 7573 7420 6265 206f 6e65       must be one
-00043920: 2064 696d 656e 7369 6f6e 616c 2e0a 0a20   dimensional... 
-00043930: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00043940: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00043950: 2d2d 2d2d 0a20 2020 2020 2020 2063 6f6f  ----.        coo
-00043960: 7264 203a 2048 6173 6861 626c 650a 2020  rd : Hashable.  
-00043970: 2020 2020 2020 2020 2020 5468 6520 636f            The co
-00043980: 6f72 6469 6e61 7465 2074 6f20 6265 2075  ordinate to be u
-00043990: 7365 6420 746f 2063 6f6d 7075 7465 2074  sed to compute t
-000439a0: 6865 2067 7261 6469 656e 742e 0a20 2020  he gradient..   
-000439b0: 2020 2020 2065 6467 655f 6f72 6465 7220       edge_order 
-000439c0: 3a20 7b31 2c20 327d 2c20 6465 6661 756c  : {1, 2}, defaul
-000439d0: 743a 2031 0a20 2020 2020 2020 2020 2020  t: 1.           
-000439e0: 204e 2d74 6820 6f72 6465 7220 6163 6375   N-th order accu
-000439f0: 7261 7465 2064 6966 6665 7265 6e63 6573  rate differences
-00043a00: 2061 7420 7468 6520 626f 756e 6461 7269   at the boundari
-00043a10: 6573 2e0a 2020 2020 2020 2020 6461 7465  es..        date
-00043a20: 7469 6d65 5f75 6e69 7420 3a20 4e6f 6e65  time_unit : None
-00043a30: 206f 7220 7b22 5922 2c20 224d 222c 2022   or {"Y", "M", "
-00043a40: 5722 2c20 2244 222c 2022 6822 2c20 226d  W", "D", "h", "m
-00043a50: 222c 2022 7322 2c20 226d 7322 2c20 5c0a  ", "s", "ms", \.
-00043a60: 2020 2020 2020 2020 2020 2020 2275 7322              "us"
-00043a70: 2c20 226e 7322 2c20 2270 7322 2c20 2266  , "ns", "ps", "f
-00043a80: 7322 2c20 2261 7322 2c20 4e6f 6e65 7d2c  s", "as", None},
-00043a90: 2064 6566 6175 6c74 3a20 4e6f 6e65 0a20   default: None. 
-00043aa0: 2020 2020 2020 2020 2020 2055 6e69 7420             Unit 
-00043ab0: 746f 2063 6f6d 7075 7465 2067 7261 6469  to compute gradi
-00043ac0: 656e 742e 204f 6e6c 7920 7661 6c69 6420  ent. Only valid 
-00043ad0: 666f 7220 6461 7465 7469 6d65 2063 6f6f  for datetime coo
-00043ae0: 7264 696e 6174 652e 0a0a 2020 2020 2020  rdinate...      
-00043af0: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-00043b00: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00043b10: 2020 6469 6666 6572 656e 7469 6174 6564    differentiated
-00043b20: 3a20 4461 7461 7365 740a 0a20 2020 2020  : Dataset..     
-00043b30: 2020 2053 6565 2061 6c73 6f0a 2020 2020     See also.    
-00043b40: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00043b50: 2020 2020 206e 756d 7079 2e67 7261 6469       numpy.gradi
-00043b60: 656e 743a 2063 6f72 7265 7370 6f6e 6469  ent: correspondi
-00043b70: 6e67 206e 756d 7079 2066 756e 6374 696f  ng numpy functio
-00043b80: 6e0a 2020 2020 2020 2020 2222 220a 2020  n.        """.  
-00043b90: 2020 2020 2020 6672 6f6d 2078 6172 7261        from xarra
-00043ba0: 792e 636f 7265 2e76 6172 6961 626c 6520  y.core.variable 
-00043bb0: 696d 706f 7274 2056 6172 6961 626c 650a  import Variable.
-00043bc0: 0a20 2020 2020 2020 2069 6620 636f 6f72  .        if coor
-00043bd0: 6420 6e6f 7420 696e 2073 656c 662e 7661  d not in self.va
-00043be0: 7269 6162 6c65 7320 616e 6420 636f 6f72  riables and coor
-00043bf0: 6420 6e6f 7420 696e 2073 656c 662e 6469  d not in self.di
-00043c00: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
-00043c10: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00043c20: 2866 2243 6f6f 7264 696e 6174 6520 7b63  (f"Coordinate {c
-00043c30: 6f6f 7264 7d20 646f 6573 206e 6f74 2065  oord} does not e
-00043c40: 7869 7374 2e22 290a 0a20 2020 2020 2020  xist.")..       
-00043c50: 2063 6f6f 7264 5f76 6172 203d 2073 656c   coord_var = sel
-00043c60: 665b 636f 6f72 645d 2e76 6172 6961 626c  f[coord].variabl
-00043c70: 650a 2020 2020 2020 2020 6966 2063 6f6f  e.        if coo
-00043c80: 7264 5f76 6172 2e6e 6469 6d20 213d 2031  rd_var.ndim != 1
-00043c90: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00043ca0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
-00043cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043cc0: 2243 6f6f 7264 696e 6174 6520 7b7d 206d  "Coordinate {} m
-00043cd0: 7573 7420 6265 2031 2064 696d 656e 7369  ust be 1 dimensi
-00043ce0: 6f6e 616c 2062 7574 2069 7320 7b7d 220a  onal but is {}".
-00043cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043d00: 2220 6469 6d65 6e73 696f 6e61 6c22 2e66  " dimensional".f
-00043d10: 6f72 6d61 7428 636f 6f72 642c 2063 6f6f  ormat(coord, coo
-00043d20: 7264 5f76 6172 2e6e 6469 6d29 0a20 2020  rd_var.ndim).   
-00043d30: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00043d40: 2020 2020 6469 6d20 3d20 636f 6f72 645f      dim = coord_
-00043d50: 7661 722e 6469 6d73 5b30 5d0a 2020 2020  var.dims[0].    
-00043d60: 2020 2020 6966 205f 636f 6e74 6169 6e73      if _contains
-00043d70: 5f64 6174 6574 696d 655f 6c69 6b65 5f6f  _datetime_like_o
-00043d80: 626a 6563 7473 2863 6f6f 7264 5f76 6172  bjects(coord_var
-00043d90: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00043da0: 6620 636f 6f72 645f 7661 722e 6474 7970  f coord_var.dtyp
-00043db0: 652e 6b69 6e64 2069 6e20 226d 4d22 2061  e.kind in "mM" a
-00043dc0: 6e64 2064 6174 6574 696d 655f 756e 6974  nd datetime_unit
-00043dd0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00043de0: 2020 2020 2020 2020 2020 6461 7465 7469            dateti
-00043df0: 6d65 5f75 6e69 7420 3d20 6361 7374 280a  me_unit = cast(.
-00043e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e10: 2020 2020 2244 6174 6574 696d 6555 6e69      "DatetimeUni
-00043e20: 744f 7074 696f 6e73 222c 206e 702e 6461  tOptions", np.da
-00043e30: 7465 7469 6d65 5f64 6174 6128 636f 6f72  tetime_data(coor
-00043e40: 645f 7661 722e 6474 7970 6529 5b30 5d0a  d_var.dtype)[0].
-00043e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00043e60: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00043e70: 6966 2064 6174 6574 696d 655f 756e 6974  if datetime_unit
-00043e80: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-00043e90: 2020 2020 2020 2020 2020 6461 7465 7469            dateti
-00043ea0: 6d65 5f75 6e69 7420 3d20 2273 2220 2023  me_unit = "s"  #
-00043eb0: 2044 6566 6175 6c74 2074 6f20 7365 636f   Default to seco
-00043ec0: 6e64 7320 666f 7220 6366 7469 6d65 206f  nds for cftime o
-00043ed0: 626a 6563 7473 0a20 2020 2020 2020 2020  bjects.         
-00043ee0: 2020 2063 6f6f 7264 5f76 6172 203d 2063     coord_var = c
-00043ef0: 6f6f 7264 5f76 6172 2e5f 746f 5f6e 756d  oord_var._to_num
-00043f00: 6572 6963 2864 6174 6574 696d 655f 756e  eric(datetime_un
-00043f10: 6974 3d64 6174 6574 696d 655f 756e 6974  it=datetime_unit
-00043f20: 290a 0a20 2020 2020 2020 2076 6172 6961  )..        varia
-00043f30: 626c 6573 203d 207b 7d0a 2020 2020 2020  bles = {}.      
-00043f40: 2020 666f 7220 6b2c 2076 2069 6e20 7365    for k, v in se
-00043f50: 6c66 2e76 6172 6961 626c 6573 2e69 7465  lf.variables.ite
-00043f60: 6d73 2829 3a0a 2020 2020 2020 2020 2020  ms():.          
-00043f70: 2020 6966 206b 2069 6e20 7365 6c66 2e64    if k in self.d
-00043f80: 6174 615f 7661 7273 2061 6e64 2064 696d  ata_vars and dim
-00043f90: 2069 6e20 762e 6469 6d73 2061 6e64 206b   in v.dims and k
-00043fa0: 206e 6f74 2069 6e20 7365 6c66 2e63 6f6f   not in self.coo
-00043fb0: 7264 733a 0a20 2020 2020 2020 2020 2020  rds:.           
-00043fc0: 2020 2020 2069 6620 5f63 6f6e 7461 696e       if _contain
-00043fd0: 735f 6461 7465 7469 6d65 5f6c 696b 655f  s_datetime_like_
-00043fe0: 6f62 6a65 6374 7328 7629 3a0a 2020 2020  objects(v):.    
-00043ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044000: 7620 3d20 762e 5f74 6f5f 6e75 6d65 7269  v = v._to_numeri
-00044010: 6328 6461 7465 7469 6d65 5f75 6e69 743d  c(datetime_unit=
-00044020: 6461 7465 7469 6d65 5f75 6e69 7429 0a20  datetime_unit). 
-00044030: 2020 2020 2020 2020 2020 2020 2020 2067                 g
-00044040: 7261 6420 3d20 6475 636b 5f61 7272 6179  rad = duck_array
-00044050: 5f6f 7073 2e67 7261 6469 656e 7428 0a20  _ops.gradient(. 
-00044060: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044070: 2020 2076 2e64 6174 612c 0a20 2020 2020     v.data,.     
-00044080: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00044090: 6f6f 7264 5f76 6172 2e64 6174 612c 0a20  oord_var.data,. 
-000440a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000440b0: 2020 2065 6467 655f 6f72 6465 723d 6564     edge_order=ed
-000440c0: 6765 5f6f 7264 6572 2c0a 2020 2020 2020  ge_order,.      
-000440d0: 2020 2020 2020 2020 2020 2020 2020 6178                ax
-000440e0: 6973 3d76 2e67 6574 5f61 7869 735f 6e75  is=v.get_axis_nu
-000440f0: 6d28 6469 6d29 2c0a 2020 2020 2020 2020  m(dim),.        
-00044100: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00044110: 2020 2020 2020 2020 2020 7661 7269 6162            variab
-00044120: 6c65 735b 6b5d 203d 2056 6172 6961 626c  les[k] = Variabl
-00044130: 6528 762e 6469 6d73 2c20 6772 6164 290a  e(v.dims, grad).
-00044140: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00044150: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00044160: 2020 7661 7269 6162 6c65 735b 6b5d 203d    variables[k] =
-00044170: 2076 0a20 2020 2020 2020 2072 6574 7572   v.        retur
-00044180: 6e20 7365 6c66 2e5f 7265 706c 6163 6528  n self._replace(
-00044190: 7661 7269 6162 6c65 7329 0a0a 2020 2020  variables)..    
-000441a0: 6465 6620 696e 7465 6772 6174 6528 0a20  def integrate(. 
-000441b0: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
-000441c0: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
-000441d0: 636f 6f72 643a 2048 6173 6861 626c 6520  coord: Hashable 
-000441e0: 7c20 5365 7175 656e 6365 5b48 6173 6861  | Sequence[Hasha
-000441f0: 626c 655d 2c0a 2020 2020 2020 2020 6461  ble],.        da
-00044200: 7465 7469 6d65 5f75 6e69 743a 2044 6174  tetime_unit: Dat
-00044210: 6574 696d 6555 6e69 744f 7074 696f 6e73  etimeUnitOptions
-00044220: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
-00044230: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
-00044240: 2020 2020 2022 2222 496e 7465 6772 6174       """Integrat
-00044250: 6520 616c 6f6e 6720 7468 6520 6769 7665  e along the give
-00044260: 6e20 636f 6f72 6469 6e61 7465 2075 7369  n coordinate usi
-00044270: 6e67 2074 6865 2074 7261 7065 7a6f 6964  ng the trapezoid
-00044280: 616c 2072 756c 652e 0a0a 2020 2020 2020  al rule...      
-00044290: 2020 2e2e 206e 6f74 653a 3a0a 2020 2020    .. note::.    
-000442a0: 2020 2020 2020 2020 5468 6973 2066 6561          This fea
-000442b0: 7475 7265 2069 7320 6c69 6d69 7465 6420  ture is limited 
-000442c0: 746f 2073 696d 706c 6520 6361 7274 6573  to simple cartes
-000442d0: 6961 6e20 6765 6f6d 6574 7279 2c20 692e  ian geometry, i.
-000442e0: 652e 2063 6f6f 7264 0a20 2020 2020 2020  e. coord.       
-000442f0: 2020 2020 206d 7573 7420 6265 206f 6e65       must be one
-00044300: 2064 696d 656e 7369 6f6e 616c 2e0a 0a20   dimensional... 
-00044310: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00044320: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00044330: 2d2d 2d2d 0a20 2020 2020 2020 2063 6f6f  ----.        coo
-00044340: 7264 203a 2068 6173 6861 626c 652c 206f  rd : hashable, o
-00044350: 7220 7365 7175 656e 6365 206f 6620 6861  r sequence of ha
-00044360: 7368 6162 6c65 0a20 2020 2020 2020 2020  shable.         
-00044370: 2020 2043 6f6f 7264 696e 6174 6528 7329     Coordinate(s)
-00044380: 2075 7365 6420 666f 7220 7468 6520 696e   used for the in
-00044390: 7465 6772 6174 696f 6e2e 0a20 2020 2020  tegration..     
-000443a0: 2020 2064 6174 6574 696d 655f 756e 6974     datetime_unit
-000443b0: 203a 207b 2759 272c 2027 4d27 2c20 2757   : {'Y', 'M', 'W
-000443c0: 272c 2027 4427 2c20 2768 272c 2027 6d27  ', 'D', 'h', 'm'
-000443d0: 2c20 2773 272c 2027 6d73 272c 2027 7573  , 's', 'ms', 'us
-000443e0: 272c 2027 6e73 272c 205c 0a20 2020 2020  ', 'ns', \.     
-000443f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044400: 2020 2027 7073 272c 2027 6673 272c 2027     'ps', 'fs', '
-00044410: 6173 272c 204e 6f6e 657d 2c20 6f70 7469  as', None}, opti
-00044420: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-00044430: 2053 7065 6369 6679 2074 6865 2075 6e69   Specify the uni
-00044440: 7420 6966 2064 6174 6574 696d 6520 636f  t if datetime co
-00044450: 6f72 6469 6e61 7465 2069 7320 7573 6564  ordinate is used
-00044460: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00044470: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-00044480: 2d2d 0a20 2020 2020 2020 2069 6e74 6567  --.        integ
-00044490: 7261 7465 6420 3a20 4461 7461 7365 740a  rated : Dataset.
-000444a0: 0a20 2020 2020 2020 2053 6565 2061 6c73  .        See als
-000444b0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-000444c0: 2d2d 0a20 2020 2020 2020 2044 6174 6141  --.        DataA
-000444d0: 7272 6179 2e69 6e74 6567 7261 7465 0a20  rray.integrate. 
-000444e0: 2020 2020 2020 206e 756d 7079 2e74 7261         numpy.tra
-000444f0: 707a 203a 2063 6f72 7265 7370 6f6e 6469  pz : correspondi
-00044500: 6e67 206e 756d 7079 2066 756e 6374 696f  ng numpy functio
-00044510: 6e0a 0a20 2020 2020 2020 2045 7861 6d70  n..        Examp
-00044520: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-00044530: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-00044540: 2064 7320 3d20 7872 2e44 6174 6173 6574   ds = xr.Dataset
-00044550: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-00044560: 2020 6461 7461 5f76 6172 733d 7b22 6122    data_vars={"a"
-00044570: 3a20 2822 7822 2c20 5b35 2c20 352c 2036  : ("x", [5, 5, 6
-00044580: 2c20 365d 292c 2022 6222 3a20 2822 7822  , 6]), "b": ("x"
-00044590: 2c20 5b31 2c20 322c 2031 2c20 305d 297d  , [1, 2, 1, 0])}
-000445a0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-000445b0: 2020 636f 6f72 6473 3d7b 2278 223a 205b    coords={"x": [
-000445c0: 302c 2031 2c20 322c 2033 5d2c 2022 7922  0, 1, 2, 3], "y"
-000445d0: 3a20 2822 7822 2c20 5b31 2c20 372c 2033  : ("x", [1, 7, 3
-000445e0: 2c20 355d 297d 2c0a 2020 2020 2020 2020  , 5])},.        
-000445f0: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
-00044600: 3e20 6473 0a20 2020 2020 2020 203c 7861  > ds.        <xa
-00044610: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
-00044620: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
-00044630: 3a20 2028 783a 2034 290a 2020 2020 2020  :  (x: 4).      
-00044640: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
-00044650: 2020 2020 2020 2020 202a 2078 2020 2020           * x    
-00044660: 2020 2020 2878 2920 696e 7436 3420 3020      (x) int64 0 
-00044670: 3120 3220 330a 2020 2020 2020 2020 2020  1 2 3.          
-00044680: 2020 7920 2020 2020 2020 2028 7829 2069    y        (x) i
-00044690: 6e74 3634 2031 2037 2033 2035 0a20 2020  nt64 1 7 3 5.   
-000446a0: 2020 2020 2044 6174 6120 7661 7269 6162       Data variab
-000446b0: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
-000446c0: 2061 2020 2020 2020 2020 2878 2920 696e   a        (x) in
-000446d0: 7436 3420 3520 3520 3620 360a 2020 2020  t64 5 5 6 6.    
-000446e0: 2020 2020 2020 2020 6220 2020 2020 2020          b       
-000446f0: 2028 7829 2069 6e74 3634 2031 2032 2031   (x) int64 1 2 1
-00044700: 2030 0a20 2020 2020 2020 203e 3e3e 2064   0.        >>> d
-00044710: 732e 696e 7465 6772 6174 6528 2278 2229  s.integrate("x")
-00044720: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
-00044730: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
-00044740: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
-00044750: 290a 2020 2020 2020 2020 4461 7461 2076  ).        Data v
-00044760: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
-00044770: 2020 2020 2020 6120 2020 2020 2020 2066        a        f
-00044780: 6c6f 6174 3634 2031 362e 350a 2020 2020  loat64 16.5.    
-00044790: 2020 2020 2020 2020 6220 2020 2020 2020          b       
-000447a0: 2066 6c6f 6174 3634 2033 2e35 0a20 2020   float64 3.5.   
-000447b0: 2020 2020 203e 3e3e 2064 732e 696e 7465       >>> ds.inte
-000447c0: 6772 6174 6528 2279 2229 0a20 2020 2020  grate("y").     
-000447d0: 2020 203c 7861 7272 6179 2e44 6174 6173     <xarray.Datas
-000447e0: 6574 3e0a 2020 2020 2020 2020 4469 6d65  et>.        Dime
-000447f0: 6e73 696f 6e73 3a20 2028 290a 2020 2020  nsions:  ().    
-00044800: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
-00044810: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00044820: 6120 2020 2020 2020 2066 6c6f 6174 3634  a        float64
-00044830: 2032 302e 300a 2020 2020 2020 2020 2020   20.0.          
-00044840: 2020 6220 2020 2020 2020 2066 6c6f 6174    b        float
-00044850: 3634 2034 2e30 0a20 2020 2020 2020 2022  64 4.0.        "
-00044860: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
-00044870: 7420 6973 696e 7374 616e 6365 2863 6f6f  t isinstance(coo
-00044880: 7264 2c20 286c 6973 742c 2074 7570 6c65  rd, (list, tuple
-00044890: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-000448a0: 636f 6f72 6420 3d20 2863 6f6f 7264 2c29  coord = (coord,)
-000448b0: 0a20 2020 2020 2020 2072 6573 756c 7420  .        result 
-000448c0: 3d20 7365 6c66 0a20 2020 2020 2020 2066  = self.        f
-000448d0: 6f72 2063 2069 6e20 636f 6f72 643a 0a20  or c in coord:. 
-000448e0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
-000448f0: 7420 3d20 7265 7375 6c74 2e5f 696e 7465  t = result._inte
-00044900: 6772 6174 655f 6f6e 6528 632c 2064 6174  grate_one(c, dat
-00044910: 6574 696d 655f 756e 6974 3d64 6174 6574  etime_unit=datet
-00044920: 696d 655f 756e 6974 290a 2020 2020 2020  ime_unit).      
-00044930: 2020 7265 7475 726e 2072 6573 756c 740a    return result.
-00044940: 0a20 2020 2064 6566 205f 696e 7465 6772  .    def _integr
-00044950: 6174 655f 6f6e 6528 7365 6c66 2c20 636f  ate_one(self, co
-00044960: 6f72 642c 2064 6174 6574 696d 655f 756e  ord, datetime_un
-00044970: 6974 3d4e 6f6e 652c 2063 756d 756c 6174  it=None, cumulat
-00044980: 6976 653d 4661 6c73 6529 3a0a 2020 2020  ive=False):.    
-00044990: 2020 2020 6672 6f6d 2078 6172 7261 792e      from xarray.
-000449a0: 636f 7265 2e76 6172 6961 626c 6520 696d  core.variable im
-000449b0: 706f 7274 2056 6172 6961 626c 650a 0a20  port Variable.. 
-000449c0: 2020 2020 2020 2069 6620 636f 6f72 6420         if coord 
-000449d0: 6e6f 7420 696e 2073 656c 662e 7661 7269  not in self.vari
-000449e0: 6162 6c65 7320 616e 6420 636f 6f72 6420  ables and coord 
-000449f0: 6e6f 7420 696e 2073 656c 662e 6469 6d73  not in self.dims
-00044a00: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-00044a10: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
-00044a20: 2243 6f6f 7264 696e 6174 6520 7b63 6f6f  "Coordinate {coo
-00044a30: 7264 7d20 646f 6573 206e 6f74 2065 7869  rd} does not exi
-00044a40: 7374 2e22 290a 0a20 2020 2020 2020 2063  st.")..        c
-00044a50: 6f6f 7264 5f76 6172 203d 2073 656c 665b  oord_var = self[
-00044a60: 636f 6f72 645d 2e76 6172 6961 626c 650a  coord].variable.
-00044a70: 2020 2020 2020 2020 6966 2063 6f6f 7264          if coord
-00044a80: 5f76 6172 2e6e 6469 6d20 213d 2031 3a0a  _var.ndim != 1:.
-00044a90: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00044aa0: 6520 5661 6c75 6545 7272 6f72 280a 2020  e ValueError(.  
-00044ab0: 2020 2020 2020 2020 2020 2020 2020 2243                "C
-00044ac0: 6f6f 7264 696e 6174 6520 7b7d 206d 7573  oordinate {} mus
-00044ad0: 7420 6265 2031 2064 696d 656e 7369 6f6e  t be 1 dimension
-00044ae0: 616c 2062 7574 2069 7320 7b7d 220a 2020  al but is {}".  
-00044af0: 2020 2020 2020 2020 2020 2020 2020 2220                " 
-00044b00: 6469 6d65 6e73 696f 6e61 6c22 2e66 6f72  dimensional".for
-00044b10: 6d61 7428 636f 6f72 642c 2063 6f6f 7264  mat(coord, coord
-00044b20: 5f76 6172 2e6e 6469 6d29 0a20 2020 2020  _var.ndim).     
-00044b30: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
-00044b40: 2020 6469 6d20 3d20 636f 6f72 645f 7661    dim = coord_va
-00044b50: 722e 6469 6d73 5b30 5d0a 2020 2020 2020  r.dims[0].      
-00044b60: 2020 6966 205f 636f 6e74 6169 6e73 5f64    if _contains_d
-00044b70: 6174 6574 696d 655f 6c69 6b65 5f6f 626a  atetime_like_obj
-00044b80: 6563 7473 2863 6f6f 7264 5f76 6172 293a  ects(coord_var):
-00044b90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00044ba0: 636f 6f72 645f 7661 722e 6474 7970 652e  coord_var.dtype.
-00044bb0: 6b69 6e64 2069 6e20 226d 4d22 2061 6e64  kind in "mM" and
-00044bc0: 2064 6174 6574 696d 655f 756e 6974 2069   datetime_unit i
-00044bd0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00044be0: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
-00044bf0: 5f75 6e69 742c 205f 203d 206e 702e 6461  _unit, _ = np.da
-00044c00: 7465 7469 6d65 5f64 6174 6128 636f 6f72  tetime_data(coor
-00044c10: 645f 7661 722e 6474 7970 6529 0a20 2020  d_var.dtype).   
-00044c20: 2020 2020 2020 2020 2065 6c69 6620 6461           elif da
-00044c30: 7465 7469 6d65 5f75 6e69 7420 6973 204e  tetime_unit is N
-00044c40: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00044c50: 2020 2020 2064 6174 6574 696d 655f 756e       datetime_un
-00044c60: 6974 203d 2022 7322 2020 2320 4465 6661  it = "s"  # Defa
-00044c70: 756c 7420 746f 2073 6563 6f6e 6473 2066  ult to seconds f
-00044c80: 6f72 2063 6674 696d 6520 6f62 6a65 6374  or cftime object
-00044c90: 730a 2020 2020 2020 2020 2020 2020 636f  s.            co
-00044ca0: 6f72 645f 7661 7220 3d20 636f 6f72 645f  ord_var = coord_
-00044cb0: 7661 722e 5f72 6570 6c61 6365 280a 2020  var._replace(.  
-00044cc0: 2020 2020 2020 2020 2020 2020 2020 6461                da
-00044cd0: 7461 3d64 6174 6574 696d 655f 746f 5f6e  ta=datetime_to_n
-00044ce0: 756d 6572 6963 2863 6f6f 7264 5f76 6172  umeric(coord_var
-00044cf0: 2e64 6174 612c 2064 6174 6574 696d 655f  .data, datetime_
-00044d00: 756e 6974 3d64 6174 6574 696d 655f 756e  unit=datetime_un
-00044d10: 6974 290a 2020 2020 2020 2020 2020 2020  it).            
-00044d20: 290a 0a20 2020 2020 2020 2076 6172 6961  )..        varia
-00044d30: 626c 6573 203d 207b 7d0a 2020 2020 2020  bles = {}.      
-00044d40: 2020 636f 6f72 645f 6e61 6d65 7320 3d20    coord_names = 
-00044d50: 7365 7428 290a 2020 2020 2020 2020 666f  set().        fo
-00044d60: 7220 6b2c 2076 2069 6e20 7365 6c66 2e76  r k, v in self.v
-00044d70: 6172 6961 626c 6573 2e69 7465 6d73 2829  ariables.items()
-00044d80: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
-00044d90: 206b 2069 6e20 7365 6c66 2e63 6f6f 7264   k in self.coord
-00044da0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-00044db0: 2020 2069 6620 6469 6d20 6e6f 7420 696e     if dim not in
-00044dc0: 2076 2e64 696d 7320 6f72 2063 756d 756c   v.dims or cumul
-00044dd0: 6174 6976 653a 0a20 2020 2020 2020 2020  ative:.         
-00044de0: 2020 2020 2020 2020 2020 2076 6172 6961             varia
-00044df0: 626c 6573 5b6b 5d20 3d20 760a 2020 2020  bles[k] = v.    
-00044e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e10: 636f 6f72 645f 6e61 6d65 732e 6164 6428  coord_names.add(
-00044e20: 6b29 0a20 2020 2020 2020 2020 2020 2065  k).            e
-00044e30: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00044e40: 2020 2020 2069 6620 6b20 696e 2073 656c       if k in sel
-00044e50: 662e 6461 7461 5f76 6172 7320 616e 6420  f.data_vars and 
-00044e60: 6469 6d20 696e 2076 2e64 696d 733a 0a20  dim in v.dims:. 
-00044e70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044e80: 2020 2069 6620 5f63 6f6e 7461 696e 735f     if _contains_
-00044e90: 6461 7465 7469 6d65 5f6c 696b 655f 6f62  datetime_like_ob
-00044ea0: 6a65 6374 7328 7629 3a0a 2020 2020 2020  jects(v):.      
-00044eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044ec0: 2020 7620 3d20 6461 7465 7469 6d65 5f74    v = datetime_t
-00044ed0: 6f5f 6e75 6d65 7269 6328 762c 2064 6174  o_numeric(v, dat
-00044ee0: 6574 696d 655f 756e 6974 3d64 6174 6574  etime_unit=datet
-00044ef0: 696d 655f 756e 6974 290a 2020 2020 2020  ime_unit).      
-00044f00: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00044f10: 2063 756d 756c 6174 6976 653a 0a20 2020   cumulative:.   
-00044f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044f30: 2020 2020 2069 6e74 6567 203d 2064 7563       integ = duc
-00044f40: 6b5f 6172 7261 795f 6f70 732e 6375 6d75  k_array_ops.cumu
-00044f50: 6c61 7469 7665 5f74 7261 7065 7a6f 6964  lative_trapezoid
-00044f60: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00044f70: 2020 2020 2020 2020 2020 2020 2020 762e                v.
-00044f80: 6461 7461 2c20 636f 6f72 645f 7661 722e  data, coord_var.
-00044f90: 6461 7461 2c20 6178 6973 3d76 2e67 6574  data, axis=v.get
-00044fa0: 5f61 7869 735f 6e75 6d28 6469 6d29 0a20  _axis_num(dim). 
-00044fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044fc0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00044fd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00044fe0: 2076 5f64 696d 7320 3d20 762e 6469 6d73   v_dims = v.dims
-00044ff0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045000: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00045010: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00045020: 2020 2069 6e74 6567 203d 2064 7563 6b5f     integ = duck_
-00045030: 6172 7261 795f 6f70 732e 7472 6170 7a28  array_ops.trapz(
-00045040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045050: 2020 2020 2020 2020 2020 2020 2076 2e64               v.d
-00045060: 6174 612c 2063 6f6f 7264 5f76 6172 2e64  ata, coord_var.d
-00045070: 6174 612c 2061 7869 733d 762e 6765 745f  ata, axis=v.get_
-00045080: 6178 6973 5f6e 756d 2864 696d 290a 2020  axis_num(dim).  
-00045090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000450a0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0003b950: 626c 6573 2829 290a 2020 2020 2020 2020  bles()).        
+0003b960: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0003b970: 2020 696e 6465 785f 6e61 6d65 203d 2069    index_name = i
+0003b980: 6478 2e6e 616d 6520 6966 2069 6478 2e6e  dx.name if idx.n
+0003b990: 616d 6520 6973 206e 6f74 204e 6f6e 6520  ame is not None 
+0003b9a0: 656c 7365 2022 696e 6465 7822 0a20 2020  else "index".   
+0003b9b0: 2020 2020 2020 2020 2064 696d 7320 3d20           dims = 
+0003b9c0: 2869 6e64 6578 5f6e 616d 652c 290a 2020  (index_name,).  
+0003b9d0: 2020 2020 2020 2020 2020 7872 5f69 6478            xr_idx
+0003b9e0: 203d 2050 616e 6461 7349 6e64 6578 2869   = PandasIndex(i
+0003b9f0: 6478 2c20 696e 6465 785f 6e61 6d65 290a  dx, index_name).
+0003ba00: 2020 2020 2020 2020 2020 2020 696e 6465              inde
+0003ba10: 7865 735b 696e 6465 785f 6e61 6d65 5d20  xes[index_name] 
+0003ba20: 3d20 7872 5f69 6478 0a20 2020 2020 2020  = xr_idx.       
+0003ba30: 2020 2020 2069 6e64 6578 5f76 6172 732e       index_vars.
+0003ba40: 7570 6461 7465 2878 725f 6964 782e 6372  update(xr_idx.cr
+0003ba50: 6561 7465 5f76 6172 6961 626c 6573 2829  eate_variables()
+0003ba60: 290a 0a20 2020 2020 2020 206f 626a 203d  )..        obj =
+0003ba70: 2063 6c73 2e5f 636f 6e73 7472 7563 745f   cls._construct_
+0003ba80: 6469 7265 6374 2869 6e64 6578 5f76 6172  direct(index_var
+0003ba90: 732c 2073 6574 2869 6e64 6578 5f76 6172  s, set(index_var
+0003baa0: 7329 2c20 696e 6465 7865 733d 696e 6465  s), indexes=inde
+0003bab0: 7865 7329 0a0a 2020 2020 2020 2020 6966  xes)..        if
+0003bac0: 2073 7061 7273 653a 0a20 2020 2020 2020   sparse:.       
+0003bad0: 2020 2020 206f 626a 2e5f 7365 745f 7370       obj._set_sp
+0003bae0: 6172 7365 5f64 6174 615f 6672 6f6d 5f64  arse_data_from_d
+0003baf0: 6174 6166 7261 6d65 2869 6478 2c20 6172  ataframe(idx, ar
+0003bb00: 7261 7973 2c20 6469 6d73 290a 2020 2020  rays, dims).    
+0003bb10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0003bb20: 2020 2020 2020 6f62 6a2e 5f73 6574 5f6e        obj._set_n
+0003bb30: 756d 7079 5f64 6174 615f 6672 6f6d 5f64  umpy_data_from_d
+0003bb40: 6174 6166 7261 6d65 2869 6478 2c20 6172  ataframe(idx, ar
+0003bb50: 7261 7973 2c20 6469 6d73 290a 2020 2020  rays, dims).    
+0003bb60: 2020 2020 7265 7475 726e 206f 626a 0a0a      return obj..
+0003bb70: 2020 2020 6465 6620 746f 5f64 6173 6b5f      def to_dask_
+0003bb80: 6461 7461 6672 616d 6528 0a20 2020 2020  dataframe(.     
+0003bb90: 2020 2073 656c 662c 2064 696d 5f6f 7264     self, dim_ord
+0003bba0: 6572 3a20 5365 7175 656e 6365 5b48 6173  er: Sequence[Has
+0003bbb0: 6861 626c 655d 207c 204e 6f6e 6520 3d20  hable] | None = 
+0003bbc0: 4e6f 6e65 2c20 7365 745f 696e 6465 783a  None, set_index:
+0003bbd0: 2062 6f6f 6c20 3d20 4661 6c73 650a 2020   bool = False.  
+0003bbe0: 2020 2920 2d3e 2044 6173 6b44 6174 6146    ) -> DaskDataF
+0003bbf0: 7261 6d65 3a0a 2020 2020 2020 2020 2222  rame:.        ""
+0003bc00: 220a 2020 2020 2020 2020 436f 6e76 6572  ".        Conver
+0003bc10: 7420 7468 6973 2064 6174 6173 6574 2069  t this dataset i
+0003bc20: 6e74 6f20 6120 6461 736b 2e64 6174 6166  nto a dask.dataf
+0003bc30: 7261 6d65 2e44 6174 6146 7261 6d65 2e0a  rame.DataFrame..
+0003bc40: 0a20 2020 2020 2020 2054 6865 2064 696d  .        The dim
+0003bc50: 656e 7369 6f6e 732c 2063 6f6f 7264 696e  ensions, coordin
+0003bc60: 6174 6573 2061 6e64 2064 6174 6120 7661  ates and data va
+0003bc70: 7269 6162 6c65 7320 696e 2074 6869 7320  riables in this 
+0003bc80: 6461 7461 7365 7420 666f 726d 0a20 2020  dataset form.   
+0003bc90: 2020 2020 2074 6865 2063 6f6c 756d 6e73       the columns
+0003bca0: 206f 6620 7468 6520 4461 7461 4672 616d   of the DataFram
+0003bcb0: 652e 0a0a 2020 2020 2020 2020 5061 7261  e...        Para
+0003bcc0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0003bcd0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0003bce0: 2020 6469 6d5f 6f72 6465 7220 3a20 6c69    dim_order : li
+0003bcf0: 7374 2c20 6f70 7469 6f6e 616c 0a20 2020  st, optional.   
+0003bd00: 2020 2020 2020 2020 2048 6965 7261 7263           Hierarc
+0003bd10: 6869 6361 6c20 6469 6d65 6e73 696f 6e20  hical dimension 
+0003bd20: 6f72 6465 7220 666f 7220 7468 6520 7265  order for the re
+0003bd30: 7375 6c74 696e 6720 6461 7461 6672 616d  sulting datafram
+0003bd40: 652e 2041 6c6c 0a20 2020 2020 2020 2020  e. All.         
+0003bd50: 2020 2061 7272 6179 7320 6172 6520 7472     arrays are tr
+0003bd60: 616e 7370 6f73 6564 2074 6f20 7468 6973  ansposed to this
+0003bd70: 206f 7264 6572 2061 6e64 2074 6865 6e20   order and then 
+0003bd80: 7772 6974 7465 6e20 6f75 7420 6173 2066  written out as f
+0003bd90: 6c61 740a 2020 2020 2020 2020 2020 2020  lat.            
+0003bda0: 7665 6374 6f72 7320 696e 2063 6f6e 7469  vectors in conti
+0003bdb0: 6775 6f75 7320 6f72 6465 722c 2073 6f20  guous order, so 
+0003bdc0: 7468 6520 6c61 7374 2064 696d 656e 7369  the last dimensi
+0003bdd0: 6f6e 2069 6e20 7468 6973 206c 6973 740a  on in this list.
+0003bde0: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
+0003bdf0: 2062 6520 636f 6e74 6967 756f 7573 2069   be contiguous i
+0003be00: 6e20 7468 6520 7265 7375 6c74 696e 6720  n the resulting 
+0003be10: 4461 7461 4672 616d 652e 2054 6869 7320  DataFrame. This 
+0003be20: 6861 7320 6120 6d61 6a6f 720a 2020 2020  has a major.    
+0003be30: 2020 2020 2020 2020 696e 666c 7565 6e63          influenc
+0003be40: 6520 6f6e 2077 6869 6368 206f 7065 7261  e on which opera
+0003be50: 7469 6f6e 7320 6172 6520 6566 6669 6369  tions are effici
+0003be60: 656e 7420 6f6e 2074 6865 2072 6573 756c  ent on the resul
+0003be70: 7469 6e67 2064 6173 6b0a 2020 2020 2020  ting dask.      
+0003be80: 2020 2020 2020 6461 7461 6672 616d 652e        dataframe.
+0003be90: 0a0a 2020 2020 2020 2020 2020 2020 4966  ..            If
+0003bea0: 2070 726f 7669 6465 642c 206d 7573 7420   provided, must 
+0003beb0: 696e 636c 7564 6520 616c 6c20 6469 6d65  include all dime
+0003bec0: 6e73 696f 6e73 206f 6620 7468 6973 2064  nsions of this d
+0003bed0: 6174 6173 6574 2e20 4279 0a20 2020 2020  ataset. By.     
+0003bee0: 2020 2020 2020 2064 6566 6175 6c74 2c20         default, 
+0003bef0: 6469 6d65 6e73 696f 6e73 2061 7265 2073  dimensions are s
+0003bf00: 6f72 7465 6420 616c 7068 6162 6574 6963  orted alphabetic
+0003bf10: 616c 6c79 2e0a 2020 2020 2020 2020 7365  ally..        se
+0003bf20: 745f 696e 6465 7820 3a20 626f 6f6c 2c20  t_index : bool, 
+0003bf30: 6465 6661 756c 743a 2046 616c 7365 0a20  default: False. 
+0003bf40: 2020 2020 2020 2020 2020 2049 6620 7365             If se
+0003bf50: 745f 696e 6465 783d 5472 7565 2c20 7468  t_index=True, th
+0003bf60: 6520 6461 736b 2044 6174 6146 7261 6d65  e dask DataFrame
+0003bf70: 2069 7320 696e 6465 7865 6420 6279 2074   is indexed by t
+0003bf80: 6869 7320 6461 7461 7365 7427 730a 2020  his dataset's.  
+0003bf90: 2020 2020 2020 2020 2020 636f 6f72 6469            coordi
+0003bfa0: 6e61 7465 2e20 5369 6e63 6520 6461 736b  nate. Since dask
+0003bfb0: 2044 6174 6146 7261 6d65 7320 646f 206e   DataFrames do n
+0003bfc0: 6f74 2073 7570 706f 7274 206d 756c 7469  ot support multi
+0003bfd0: 2d69 6e64 6578 6573 2c0a 2020 2020 2020  -indexes,.      
+0003bfe0: 2020 2020 2020 7365 745f 696e 6465 7820        set_index 
+0003bff0: 6f6e 6c79 2077 6f72 6b73 2069 6620 7468  only works if th
+0003c000: 6520 6461 7461 7365 7420 6f6e 6c79 2063  e dataset only c
+0003c010: 6f6e 7461 696e 7320 6f6e 6520 6469 6d65  ontains one dime
+0003c020: 6e73 696f 6e2e 0a0a 2020 2020 2020 2020  nsion...        
+0003c030: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+0003c040: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0003c050: 6461 736b 2e64 6174 6166 7261 6d65 2e44  dask.dataframe.D
+0003c060: 6174 6146 7261 6d65 0a20 2020 2020 2020  ataFrame.       
+0003c070: 2022 2222 0a0a 2020 2020 2020 2020 696d   """..        im
+0003c080: 706f 7274 2064 6173 6b2e 6172 7261 7920  port dask.array 
+0003c090: 6173 2064 610a 2020 2020 2020 2020 696d  as da.        im
+0003c0a0: 706f 7274 2064 6173 6b2e 6461 7461 6672  port dask.datafr
+0003c0b0: 616d 6520 6173 2064 640a 0a20 2020 2020  ame as dd..     
+0003c0c0: 2020 206f 7264 6572 6564 5f64 696d 7320     ordered_dims 
+0003c0d0: 3d20 7365 6c66 2e5f 6e6f 726d 616c 697a  = self._normaliz
+0003c0e0: 655f 6469 6d5f 6f72 6465 7228 6469 6d5f  e_dim_order(dim_
+0003c0f0: 6f72 6465 723d 6469 6d5f 6f72 6465 7229  order=dim_order)
+0003c100: 0a0a 2020 2020 2020 2020 636f 6c75 6d6e  ..        column
+0003c110: 7320 3d20 6c69 7374 286f 7264 6572 6564  s = list(ordered
+0003c120: 5f64 696d 7329 0a20 2020 2020 2020 2063  _dims).        c
+0003c130: 6f6c 756d 6e73 2e65 7874 656e 6428 6b20  olumns.extend(k 
+0003c140: 666f 7220 6b20 696e 2073 656c 662e 636f  for k in self.co
+0003c150: 6f72 6473 2069 6620 6b20 6e6f 7420 696e  ords if k not in
+0003c160: 2073 656c 662e 6469 6d73 290a 2020 2020   self.dims).    
+0003c170: 2020 2020 636f 6c75 6d6e 732e 6578 7465      columns.exte
+0003c180: 6e64 2873 656c 662e 6461 7461 5f76 6172  nd(self.data_var
+0003c190: 7329 0a0a 2020 2020 2020 2020 6473 5f63  s)..        ds_c
+0003c1a0: 6875 6e6b 7320 3d20 7365 6c66 2e63 6875  hunks = self.chu
+0003c1b0: 6e6b 730a 0a20 2020 2020 2020 2073 6572  nks..        ser
+0003c1c0: 6965 735f 6c69 7374 203d 205b 5d0a 2020  ies_list = [].  
+0003c1d0: 2020 2020 2020 6466 5f6d 6574 6120 3d20        df_meta = 
+0003c1e0: 7064 2e44 6174 6146 7261 6d65 2829 0a20  pd.DataFrame(). 
+0003c1f0: 2020 2020 2020 2066 6f72 206e 616d 6520         for name 
+0003c200: 696e 2063 6f6c 756d 6e73 3a0a 2020 2020  in columns:.    
+0003c210: 2020 2020 2020 2020 7472 793a 0a20 2020          try:.   
+0003c220: 2020 2020 2020 2020 2020 2020 2076 6172               var
+0003c230: 203d 2073 656c 662e 7661 7269 6162 6c65   = self.variable
+0003c240: 735b 6e61 6d65 5d0a 2020 2020 2020 2020  s[name].        
+0003c250: 2020 2020 6578 6365 7074 204b 6579 4572      except KeyEr
+0003c260: 726f 723a 0a20 2020 2020 2020 2020 2020  ror:.           
+0003c270: 2020 2020 2023 2064 696d 656e 7369 6f6e       # dimension
+0003c280: 2077 6974 686f 7574 2061 206d 6174 6368   without a match
+0003c290: 696e 6720 636f 6f72 6469 6e61 7465 0a20  ing coordinate. 
+0003c2a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0003c2b0: 697a 6520 3d20 7365 6c66 2e64 696d 735b  ize = self.dims[
+0003c2c0: 6e61 6d65 5d0a 2020 2020 2020 2020 2020  name].          
+0003c2d0: 2020 2020 2020 6461 7461 203d 2064 612e        data = da.
+0003c2e0: 6172 616e 6765 2873 697a 652c 2063 6875  arange(size, chu
+0003c2f0: 6e6b 733d 7369 7a65 2c20 6474 7970 653d  nks=size, dtype=
+0003c300: 6e70 2e69 6e74 3634 290a 2020 2020 2020  np.int64).      
+0003c310: 2020 2020 2020 2020 2020 7661 7220 3d20            var = 
+0003c320: 5661 7269 6162 6c65 2828 6e61 6d65 2c29  Variable((name,)
+0003c330: 2c20 6461 7461 290a 0a20 2020 2020 2020  , data)..       
+0003c340: 2020 2020 2023 2049 6e64 6578 5661 7269       # IndexVari
+0003c350: 6162 6c65 206f 626a 6563 7473 2068 6176  able objects hav
+0003c360: 6520 6120 6475 6d6d 7920 2e63 6875 6e6b  e a dummy .chunk
+0003c370: 2829 206d 6574 686f 640a 2020 2020 2020  () method.      
+0003c380: 2020 2020 2020 6966 2069 7369 6e73 7461        if isinsta
+0003c390: 6e63 6528 7661 722c 2049 6e64 6578 5661  nce(var, IndexVa
+0003c3a0: 7269 6162 6c65 293a 0a20 2020 2020 2020  riable):.       
+0003c3b0: 2020 2020 2020 2020 2076 6172 203d 2076           var = v
+0003c3c0: 6172 2e74 6f5f 6261 7365 5f76 6172 6961  ar.to_base_varia
+0003c3d0: 626c 6528 290a 0a20 2020 2020 2020 2020  ble()..         
+0003c3e0: 2020 2023 204d 616b 6520 7375 7265 2076     # Make sure v
+0003c3f0: 6172 2069 7320 6120 6461 736b 2061 7272  ar is a dask arr
+0003c400: 6179 2c20 6f74 6865 7277 6973 6520 7468  ay, otherwise th
+0003c410: 6520 6172 7261 7920 6361 6e20 6265 636f  e array can beco
+0003c420: 6d65 2074 6f6f 206c 6172 6765 0a20 2020  me too large.   
+0003c430: 2020 2020 2020 2020 2023 2077 6865 6e20           # when 
+0003c440: 6974 2069 7320 6272 6f61 6463 6173 7465  it is broadcaste
+0003c450: 6420 746f 2073 6576 6572 616c 2064 696d  d to several dim
+0003c460: 656e 7369 6f6e 733a 0a20 2020 2020 2020  ensions:.       
+0003c470: 2020 2020 2069 6620 6e6f 7420 6973 5f64       if not is_d
+0003c480: 7563 6b5f 6461 736b 5f61 7272 6179 2876  uck_dask_array(v
+0003c490: 6172 2e5f 6461 7461 293a 0a20 2020 2020  ar._data):.     
+0003c4a0: 2020 2020 2020 2020 2020 2076 6172 203d             var =
+0003c4b0: 2076 6172 2e63 6875 6e6b 2829 0a0a 2020   var.chunk()..  
+0003c4c0: 2020 2020 2020 2020 2020 2320 4272 6f61            # Broa
+0003c4d0: 6463 6173 7420 7468 656e 2066 6c61 7474  dcast then flatt
+0003c4e0: 656e 2074 6865 2061 7272 6179 3a0a 2020  en the array:.  
+0003c4f0: 2020 2020 2020 2020 2020 7661 725f 6e65            var_ne
+0003c500: 775f 6469 6d73 203d 2076 6172 2e73 6574  w_dims = var.set
+0003c510: 5f64 696d 7328 6f72 6465 7265 645f 6469  _dims(ordered_di
+0003c520: 6d73 292e 6368 756e 6b28 6473 5f63 6875  ms).chunk(ds_chu
+0003c530: 6e6b 7329 0a20 2020 2020 2020 2020 2020  nks).           
+0003c540: 2064 6173 6b5f 6172 7261 7920 3d20 7661   dask_array = va
+0003c550: 725f 6e65 775f 6469 6d73 2e5f 6461 7461  r_new_dims._data
+0003c560: 2e72 6573 6861 7065 282d 3129 0a0a 2020  .reshape(-1)..  
+0003c570: 2020 2020 2020 2020 2020 7365 7269 6573            series
+0003c580: 203d 2064 642e 6672 6f6d 5f64 6173 6b5f   = dd.from_dask_
+0003c590: 6172 7261 7928 6461 736b 5f61 7272 6179  array(dask_array
+0003c5a0: 2c20 636f 6c75 6d6e 733d 6e61 6d65 2c20  , columns=name, 
+0003c5b0: 6d65 7461 3d64 665f 6d65 7461 290a 2020  meta=df_meta).  
+0003c5c0: 2020 2020 2020 2020 2020 7365 7269 6573            series
+0003c5d0: 5f6c 6973 742e 6170 7065 6e64 2873 6572  _list.append(ser
+0003c5e0: 6965 7329 0a0a 2020 2020 2020 2020 6466  ies)..        df
+0003c5f0: 203d 2064 642e 636f 6e63 6174 2873 6572   = dd.concat(ser
+0003c600: 6965 735f 6c69 7374 2c20 6178 6973 3d31  ies_list, axis=1
+0003c610: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
+0003c620: 745f 696e 6465 783a 0a20 2020 2020 2020  t_index:.       
+0003c630: 2020 2020 2064 696d 5f6f 7264 6572 203d       dim_order =
+0003c640: 205b 2a6f 7264 6572 6564 5f64 696d 735d   [*ordered_dims]
+0003c650: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+0003c660: 206c 656e 2864 696d 5f6f 7264 6572 2920   len(dim_order) 
+0003c670: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0003c680: 2020 2020 2020 2864 696d 2c29 203d 2064        (dim,) = d
+0003c690: 696d 5f6f 7264 6572 0a20 2020 2020 2020  im_order.       
+0003c6a0: 2020 2020 2020 2020 2064 6620 3d20 6466           df = df
+0003c6b0: 2e73 6574 5f69 6e64 6578 2864 696d 290a  .set_index(dim).
+0003c6c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0003c6d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0003c6e0: 2020 2320 7472 6967 6765 7273 2061 6e20    # triggers an 
+0003c6f0: 6572 726f 7220 6162 6f75 7420 6d75 6c74  error about mult
+0003c700: 692d 696e 6465 7865 732c 2065 7665 6e20  i-indexes, even 
+0003c710: 6966 206f 6e6c 7920 6f6e 650a 2020 2020  if only one.    
+0003c720: 2020 2020 2020 2020 2020 2020 2320 6469              # di
+0003c730: 6d65 6e73 696f 6e20 6973 2070 6173 7365  mension is passe
+0003c740: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0003c750: 2020 6466 203d 2064 662e 7365 745f 696e    df = df.set_in
+0003c760: 6465 7828 6469 6d5f 6f72 6465 7229 0a0a  dex(dim_order)..
+0003c770: 2020 2020 2020 2020 7265 7475 726e 2064          return d
+0003c780: 660a 0a20 2020 2064 6566 2074 6f5f 6469  f..    def to_di
+0003c790: 6374 280a 2020 2020 2020 2020 7365 6c66  ct(.        self
+0003c7a0: 2c20 6461 7461 3a20 626f 6f6c 207c 204c  , data: bool | L
+0003c7b0: 6974 6572 616c 5b22 6c69 7374 222c 2022  iteral["list", "
+0003c7c0: 6172 7261 7922 5d20 3d20 226c 6973 7422  array"] = "list"
+0003c7d0: 2c20 656e 636f 6469 6e67 3a20 626f 6f6c  , encoding: bool
+0003c7e0: 203d 2046 616c 7365 0a20 2020 2029 202d   = False.    ) -
+0003c7f0: 3e20 6469 6374 5b73 7472 2c20 416e 795d  > dict[str, Any]
+0003c800: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+0003c810: 2020 2020 2020 436f 6e76 6572 7420 7468        Convert th
+0003c820: 6973 2064 6174 6173 6574 2074 6f20 6120  is dataset to a 
+0003c830: 6469 6374 696f 6e61 7279 2066 6f6c 6c6f  dictionary follo
+0003c840: 7769 6e67 2078 6172 7261 7920 6e61 6d69  wing xarray nami
+0003c850: 6e67 0a20 2020 2020 2020 2063 6f6e 7665  ng.        conve
+0003c860: 6e74 696f 6e73 2e0a 0a20 2020 2020 2020  ntions...       
+0003c870: 2043 6f6e 7665 7274 7320 616c 6c20 7661   Converts all va
+0003c880: 7269 6162 6c65 7320 616e 6420 6174 7472  riables and attr
+0003c890: 6962 7574 6573 2074 6f20 6e61 7469 7665  ibutes to native
+0003c8a0: 2050 7974 686f 6e20 6f62 6a65 6374 730a   Python objects.
+0003c8b0: 2020 2020 2020 2020 5573 6566 756c 2066          Useful f
+0003c8c0: 6f72 2063 6f6e 7665 7274 696e 6720 746f  or converting to
+0003c8d0: 206a 736f 6e2e 2054 6f20 6176 6f69 6420   json. To avoid 
+0003c8e0: 6461 7465 7469 6d65 2069 6e63 6f6d 7061  datetime incompa
+0003c8f0: 7469 6269 6c69 7479 0a20 2020 2020 2020  tibility.       
+0003c900: 2075 7365 2064 6563 6f64 655f 7469 6d65   use decode_time
+0003c910: 733d 4661 6c73 6520 6b77 6172 6720 696e  s=False kwarg in
+0003c920: 2078 6172 7272 6179 2e6f 7065 6e5f 6461   xarrray.open_da
+0003c930: 7461 7365 742e 0a0a 2020 2020 2020 2020  taset...        
+0003c940: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+0003c950: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0003c960: 2020 2020 2020 6461 7461 203a 2062 6f6f        data : boo
+0003c970: 6c20 6f72 207b 226c 6973 7422 2c20 2261  l or {"list", "a
+0003c980: 7272 6179 227d 2c20 6465 6661 756c 743a  rray"}, default:
+0003c990: 2022 6c69 7374 220a 2020 2020 2020 2020   "list".        
+0003c9a0: 2020 2020 5768 6574 6865 7220 746f 2069      Whether to i
+0003c9b0: 6e63 6c75 6465 2074 6865 2061 6374 7561  nclude the actua
+0003c9c0: 6c20 6461 7461 2069 6e20 7468 6520 6469  l data in the di
+0003c9d0: 6374 696f 6e61 7279 2e20 5768 656e 2073  ctionary. When s
+0003c9e0: 6574 2074 6f0a 2020 2020 2020 2020 2020  et to.          
+0003c9f0: 2020 4661 6c73 652c 2072 6574 7572 6e73    False, returns
+0003ca00: 206a 7573 7420 7468 6520 7363 6865 6d61   just the schema
+0003ca10: 2e20 4966 2073 6574 2074 6f20 2261 7272  . If set to "arr
+0003ca20: 6179 222c 2072 6574 7572 6e73 2064 6174  ay", returns dat
+0003ca30: 6120 6173 0a20 2020 2020 2020 2020 2020  a as.           
+0003ca40: 2075 6e64 6572 6c79 696e 6720 6172 7261   underlying arra
+0003ca50: 7920 7479 7065 2e20 4966 2073 6574 2074  y type. If set t
+0003ca60: 6f20 226c 6973 7422 2028 6f72 2054 7275  o "list" (or Tru
+0003ca70: 6520 666f 7220 6261 636b 7761 7264 730a  e for backwards.
+0003ca80: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
+0003ca90: 6174 6962 696c 6974 7929 2c20 7265 7475  atibility), retu
+0003caa0: 726e 7320 6461 7461 2069 6e20 6c69 7374  rns data in list
+0003cab0: 7320 6f66 2050 7974 686f 6e20 6461 7461  s of Python data
+0003cac0: 2074 7970 6573 2e20 4e6f 7465 0a20 2020   types. Note.   
+0003cad0: 2020 2020 2020 2020 2074 6861 7420 666f           that fo
+0003cae0: 7220 6f62 7461 696e 696e 6720 7468 6520  r obtaining the 
+0003caf0: 226c 6973 7422 206f 7574 7075 7420 6566  "list" output ef
+0003cb00: 6669 6369 656e 746c 792c 2075 7365 0a20  ficiently, use. 
+0003cb10: 2020 2020 2020 2020 2020 2060 6473 2e63             `ds.c
+0003cb20: 6f6d 7075 7465 2829 2e74 6f5f 6469 6374  ompute().to_dict
+0003cb30: 2864 6174 613d 226c 6973 7422 2960 2e0a  (data="list")`..
+0003cb40: 0a20 2020 2020 2020 2065 6e63 6f64 696e  .        encodin
+0003cb50: 6720 3a20 626f 6f6c 2c20 6465 6661 756c  g : bool, defaul
+0003cb60: 743a 2046 616c 7365 0a20 2020 2020 2020  t: False.       
+0003cb70: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+0003cb80: 696e 636c 7564 6520 7468 6520 4461 7461  include the Data
+0003cb90: 7365 7427 7320 656e 636f 6469 6e67 2069  set's encoding i
+0003cba0: 6e20 7468 6520 6469 6374 696f 6e61 7279  n the dictionary
+0003cbb0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0003cbc0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+0003cbd0: 2d2d 0a20 2020 2020 2020 2064 203a 2064  --.        d : d
+0003cbe0: 6963 740a 2020 2020 2020 2020 2020 2020  ict.            
+0003cbf0: 4469 6374 2077 6974 6820 6b65 7973 3a20  Dict with keys: 
+0003cc00: 2263 6f6f 7264 7322 2c20 2261 7474 7273  "coords", "attrs
+0003cc10: 222c 2022 6469 6d73 222c 2022 6461 7461  ", "dims", "data
+0003cc20: 5f76 6172 7322 2061 6e64 206f 7074 696f  _vars" and optio
+0003cc30: 6e61 6c6c 790a 2020 2020 2020 2020 2020  nally.          
+0003cc40: 2020 2265 6e63 6f64 696e 6722 2e0a 0a20    "encoding"... 
+0003cc50: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+0003cc60: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0003cc70: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
+0003cc80: 2e66 726f 6d5f 6469 6374 0a20 2020 2020  .from_dict.     
+0003cc90: 2020 2044 6174 6141 7272 6179 2e74 6f5f     DataArray.to_
+0003cca0: 6469 6374 0a20 2020 2020 2020 2022 2222  dict.        """
+0003ccb0: 0a20 2020 2020 2020 2064 3a20 6469 6374  .        d: dict
+0003ccc0: 203d 207b 0a20 2020 2020 2020 2020 2020   = {.           
+0003ccd0: 2022 636f 6f72 6473 223a 207b 7d2c 0a20   "coords": {},. 
+0003cce0: 2020 2020 2020 2020 2020 2022 6174 7472             "attr
+0003ccf0: 7322 3a20 6465 636f 6465 5f6e 756d 7079  s": decode_numpy
+0003cd00: 5f64 6963 745f 7661 6c75 6573 2873 656c  _dict_values(sel
+0003cd10: 662e 6174 7472 7329 2c0a 2020 2020 2020  f.attrs),.      
+0003cd20: 2020 2020 2020 2264 696d 7322 3a20 6469        "dims": di
+0003cd30: 6374 2873 656c 662e 6469 6d73 292c 0a20  ct(self.dims),. 
+0003cd40: 2020 2020 2020 2020 2020 2022 6461 7461             "data
+0003cd50: 5f76 6172 7322 3a20 7b7d 2c0a 2020 2020  _vars": {},.    
+0003cd60: 2020 2020 7d0a 2020 2020 2020 2020 666f      }.        fo
+0003cd70: 7220 6b20 696e 2073 656c 662e 636f 6f72  r k in self.coor
+0003cd80: 6473 3a0a 2020 2020 2020 2020 2020 2020  ds:.            
+0003cd90: 645b 2263 6f6f 7264 7322 5d2e 7570 6461  d["coords"].upda
+0003cda0: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
+0003cdb0: 2020 2020 7b6b 3a20 7365 6c66 5b6b 5d2e      {k: self[k].
+0003cdc0: 7661 7269 6162 6c65 2e74 6f5f 6469 6374  variable.to_dict
+0003cdd0: 2864 6174 613d 6461 7461 2c20 656e 636f  (data=data, enco
+0003cde0: 6469 6e67 3d65 6e63 6f64 696e 6729 7d0a  ding=encoding)}.
+0003cdf0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0003ce00: 2020 2020 2020 666f 7220 6b20 696e 2073        for k in s
+0003ce10: 656c 662e 6461 7461 5f76 6172 733a 0a20  elf.data_vars:. 
+0003ce20: 2020 2020 2020 2020 2020 2064 5b22 6461             d["da
+0003ce30: 7461 5f76 6172 7322 5d2e 7570 6461 7465  ta_vars"].update
+0003ce40: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003ce50: 2020 7b6b 3a20 7365 6c66 5b6b 5d2e 7661    {k: self[k].va
+0003ce60: 7269 6162 6c65 2e74 6f5f 6469 6374 2864  riable.to_dict(d
+0003ce70: 6174 613d 6461 7461 2c20 656e 636f 6469  ata=data, encodi
+0003ce80: 6e67 3d65 6e63 6f64 696e 6729 7d0a 2020  ng=encoding)}.  
+0003ce90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0003cea0: 2020 2020 6966 2065 6e63 6f64 696e 673a      if encoding:
+0003ceb0: 0a20 2020 2020 2020 2020 2020 2064 5b22  .            d["
+0003cec0: 656e 636f 6469 6e67 225d 203d 2064 6963  encoding"] = dic
+0003ced0: 7428 7365 6c66 2e65 6e63 6f64 696e 6729  t(self.encoding)
+0003cee0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0003cef0: 640a 0a20 2020 2040 636c 6173 736d 6574  d..    @classmet
+0003cf00: 686f 640a 2020 2020 6465 6620 6672 6f6d  hod.    def from
+0003cf10: 5f64 6963 7428 636c 733a 2074 7970 655b  _dict(cls: type[
+0003cf20: 545f 4461 7461 7365 745d 2c20 643a 204d  T_Dataset], d: M
+0003cf30: 6170 7069 6e67 5b41 6e79 2c20 416e 795d  apping[Any, Any]
+0003cf40: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
+0003cf50: 2020 2020 2020 2020 2222 2243 6f6e 7665          """Conve
+0003cf60: 7274 2061 2064 6963 7469 6f6e 6172 7920  rt a dictionary 
+0003cf70: 696e 746f 2061 6e20 7861 7272 6179 2e44  into an xarray.D
+0003cf80: 6174 6173 6574 2e0a 0a20 2020 2020 2020  ataset...       
+0003cf90: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+0003cfa0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+0003cfb0: 2020 2020 2020 2064 203a 2064 6963 742d         d : dict-
+0003cfc0: 6c69 6b65 0a20 2020 2020 2020 2020 2020  like.           
+0003cfd0: 204d 6170 7069 6e67 2077 6974 6820 6120   Mapping with a 
+0003cfe0: 6d69 6e69 6d75 6d20 7374 7275 6374 7572  minimum structur
+0003cff0: 6520 6f66 0a20 2020 2020 2020 2020 2020  e of.           
+0003d000: 2020 2020 2060 607b 2276 6172 5f30 223a       ``{"var_0":
+0003d010: 207b 2264 696d 7322 3a20 5b2e 2e5d 2c20   {"dims": [..], 
+0003d020: 2264 6174 6122 3a20 5b2e 2e5d 7d2c 205c  "data": [..]}, \
+0003d030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003d040: 2020 2020 2020 2020 2020 2020 202e 2e2e               ...
+0003d050: 7d60 600a 0a20 2020 2020 2020 2052 6574  }``..        Ret
+0003d060: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
+0003d070: 2d2d 2d2d 0a20 2020 2020 2020 206f 626a  ----.        obj
+0003d080: 203a 2044 6174 6173 6574 0a0a 2020 2020   : Dataset..    
+0003d090: 2020 2020 5365 6520 616c 736f 0a20 2020      See also.   
+0003d0a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0003d0b0: 2020 2020 2020 4461 7461 7365 742e 746f        Dataset.to
+0003d0c0: 5f64 6963 740a 2020 2020 2020 2020 4461  _dict.        Da
+0003d0d0: 7461 4172 7261 792e 6672 6f6d 5f64 6963  taArray.from_dic
+0003d0e0: 740a 0a20 2020 2020 2020 2045 7861 6d70  t..        Examp
+0003d0f0: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
+0003d100: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
+0003d110: 2064 203d 207b 0a20 2020 2020 2020 202e   d = {.        .
+0003d120: 2e2e 2020 2020 2022 7422 3a20 7b22 6469  ..     "t": {"di
+0003d130: 6d73 223a 2028 2274 2229 2c20 2264 6174  ms": ("t"), "dat
+0003d140: 6122 3a20 5b30 2c20 312c 2032 5d7d 2c0a  a": [0, 1, 2]},.
+0003d150: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0003d160: 2261 223a 207b 2264 696d 7322 3a20 2822  "a": {"dims": ("
+0003d170: 7422 292c 2022 6461 7461 223a 205b 2261  t"), "data": ["a
+0003d180: 222c 2022 6222 2c20 2263 225d 7d2c 0a20  ", "b", "c"]},. 
+0003d190: 2020 2020 2020 202e 2e2e 2020 2020 2022         ...     "
+0003d1a0: 6222 3a20 7b22 6469 6d73 223a 2028 2274  b": {"dims": ("t
+0003d1b0: 2229 2c20 2264 6174 6122 3a20 5b31 302c  "), "data": [10,
+0003d1c0: 2032 302c 2033 305d 7d2c 0a20 2020 2020   20, 30]},.     
+0003d1d0: 2020 202e 2e2e 207d 0a20 2020 2020 2020     ... }.       
+0003d1e0: 203e 3e3e 2064 7320 3d20 7872 2e44 6174   >>> ds = xr.Dat
+0003d1f0: 6173 6574 2e66 726f 6d5f 6469 6374 2864  aset.from_dict(d
+0003d200: 290a 2020 2020 2020 2020 3e3e 3e20 6473  ).        >>> ds
+0003d210: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
+0003d220: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
+0003d230: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
+0003d240: 743a 2033 290a 2020 2020 2020 2020 436f  t: 3).        Co
+0003d250: 6f72 6469 6e61 7465 733a 0a20 2020 2020  ordinates:.     
+0003d260: 2020 2020 202a 2074 2020 2020 2020 2020       * t        
+0003d270: 2874 2920 696e 7436 3420 3020 3120 320a  (t) int64 0 1 2.
+0003d280: 2020 2020 2020 2020 4461 7461 2076 6172          Data var
+0003d290: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
+0003d2a0: 2020 2020 6120 2020 2020 2020 2028 7429      a        (t)
+0003d2b0: 203c 5531 2027 6127 2027 6227 2027 6327   <U1 'a' 'b' 'c'
+0003d2c0: 0a20 2020 2020 2020 2020 2020 2062 2020  .            b  
+0003d2d0: 2020 2020 2020 2874 2920 696e 7436 3420        (t) int64 
+0003d2e0: 3130 2032 3020 3330 0a0a 2020 2020 2020  10 20 30..      
+0003d2f0: 2020 3e3e 3e20 6420 3d20 7b0a 2020 2020    >>> d = {.    
+0003d300: 2020 2020 2e2e 2e20 2020 2020 2263 6f6f      ...     "coo
+0003d310: 7264 7322 3a20 7b0a 2020 2020 2020 2020  rds": {.        
+0003d320: 2e2e 2e20 2020 2020 2020 2020 2274 223a  ...         "t":
+0003d330: 207b 2264 696d 7322 3a20 2274 222c 2022   {"dims": "t", "
+0003d340: 6461 7461 223a 205b 302c 2031 2c20 325d  data": [0, 1, 2]
+0003d350: 2c20 2261 7474 7273 223a 207b 2275 6e69  , "attrs": {"uni
+0003d360: 7473 223a 2022 7322 7d7d 0a20 2020 2020  ts": "s"}}.     
+0003d370: 2020 202e 2e2e 2020 2020 207d 2c0a 2020     ...     },.  
+0003d380: 2020 2020 2020 2e2e 2e20 2020 2020 2261        ...     "a
+0003d390: 7474 7273 223a 207b 2274 6974 6c65 223a  ttrs": {"title":
+0003d3a0: 2022 6169 7220 7465 6d70 6572 6174 7572   "air temperatur
+0003d3b0: 6522 7d2c 0a20 2020 2020 2020 202e 2e2e  e"},.        ...
+0003d3c0: 2020 2020 2022 6469 6d73 223a 2022 7422       "dims": "t"
+0003d3d0: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+0003d3e0: 2020 2264 6174 615f 7661 7273 223a 207b    "data_vars": {
+0003d3f0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0003d400: 2020 2020 2022 6122 3a20 7b22 6469 6d73       "a": {"dims
+0003d410: 223a 2022 7422 2c20 2264 6174 6122 3a20  ": "t", "data": 
+0003d420: 5b31 302c 2032 302c 2033 305d 7d2c 0a20  [10, 20, 30]},. 
+0003d430: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0003d440: 2020 2022 6222 3a20 7b22 6469 6d73 223a     "b": {"dims":
+0003d450: 2022 7422 2c20 2264 6174 6122 3a20 5b22   "t", "data": ["
+0003d460: 6122 2c20 2262 222c 2022 6322 5d7d 2c0a  a", "b", "c"]},.
+0003d470: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0003d480: 7d2c 0a20 2020 2020 2020 202e 2e2e 207d  },.        ... }
+0003d490: 0a20 2020 2020 2020 203e 3e3e 2064 7320  .        >>> ds 
+0003d4a0: 3d20 7872 2e44 6174 6173 6574 2e66 726f  = xr.Dataset.fro
+0003d4b0: 6d5f 6469 6374 2864 290a 2020 2020 2020  m_dict(d).      
+0003d4c0: 2020 3e3e 3e20 6473 0a20 2020 2020 2020    >>> ds.       
+0003d4d0: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+0003d4e0: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
+0003d4f0: 696f 6e73 3a20 2028 743a 2033 290a 2020  ions:  (t: 3).  
+0003d500: 2020 2020 2020 436f 6f72 6469 6e61 7465        Coordinate
+0003d510: 733a 0a20 2020 2020 2020 2020 202a 2074  s:.          * t
+0003d520: 2020 2020 2020 2020 2874 2920 696e 7436          (t) int6
+0003d530: 3420 3020 3120 320a 2020 2020 2020 2020  4 0 1 2.        
+0003d540: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
+0003d550: 2020 2020 2020 2020 2020 2020 6120 2020              a   
+0003d560: 2020 2020 2028 7429 2069 6e74 3634 2031       (t) int64 1
+0003d570: 3020 3230 2033 300a 2020 2020 2020 2020  0 20 30.        
+0003d580: 2020 2020 6220 2020 2020 2020 2028 7429      b        (t)
+0003d590: 203c 5531 2027 6127 2027 6227 2027 6327   <U1 'a' 'b' 'c'
+0003d5a0: 0a20 2020 2020 2020 2041 7474 7269 6275  .        Attribu
+0003d5b0: 7465 733a 0a20 2020 2020 2020 2020 2020  tes:.           
+0003d5c0: 2074 6974 6c65 3a20 2020 2061 6972 2074   title:    air t
+0003d5d0: 656d 7065 7261 7475 7265 0a0a 2020 2020  emperature..    
+0003d5e0: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+0003d5f0: 2076 6172 6961 626c 6573 3a20 4974 6572   variables: Iter
+0003d600: 6162 6c65 5b74 7570 6c65 5b48 6173 6861  able[tuple[Hasha
+0003d610: 626c 652c 2041 6e79 5d5d 0a20 2020 2020  ble, Any]].     
+0003d620: 2020 2069 6620 6e6f 7420 7b22 636f 6f72     if not {"coor
+0003d630: 6473 222c 2022 6461 7461 5f76 6172 7322  ds", "data_vars"
+0003d640: 7d2e 6973 7375 6273 6574 2873 6574 2864  }.issubset(set(d
+0003d650: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+0003d660: 7661 7269 6162 6c65 7320 3d20 642e 6974  variables = d.it
+0003d670: 656d 7328 290a 2020 2020 2020 2020 656c  ems().        el
+0003d680: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003d690: 696d 706f 7274 2069 7465 7274 6f6f 6c73  import itertools
+0003d6a0: 0a0a 2020 2020 2020 2020 2020 2020 7661  ..            va
+0003d6b0: 7269 6162 6c65 7320 3d20 6974 6572 746f  riables = iterto
+0003d6c0: 6f6c 732e 6368 6169 6e28 0a20 2020 2020  ols.chain(.     
+0003d6d0: 2020 2020 2020 2020 2020 2064 2e67 6574             d.get
+0003d6e0: 2822 636f 6f72 6473 222c 207b 7d29 2e69  ("coords", {}).i
+0003d6f0: 7465 6d73 2829 2c20 642e 6765 7428 2264  tems(), d.get("d
+0003d700: 6174 615f 7661 7273 222c 207b 7d29 2e69  ata_vars", {}).i
+0003d710: 7465 6d73 2829 0a20 2020 2020 2020 2020  tems().         
+0003d720: 2020 2029 0a20 2020 2020 2020 2074 7279     ).        try
+0003d730: 3a0a 2020 2020 2020 2020 2020 2020 7661  :.            va
+0003d740: 7269 6162 6c65 5f64 6963 7420 3d20 7b0a  riable_dict = {.
+0003d750: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003d760: 6b3a 2028 765b 2264 696d 7322 5d2c 2076  k: (v["dims"], v
+0003d770: 5b22 6461 7461 225d 2c20 762e 6765 7428  ["data"], v.get(
+0003d780: 2261 7474 7273 2229 2c20 762e 6765 7428  "attrs"), v.get(
+0003d790: 2265 6e63 6f64 696e 6722 2929 0a20 2020  "encoding")).   
+0003d7a0: 2020 2020 2020 2020 2020 2020 2066 6f72               for
+0003d7b0: 206b 2c20 7620 696e 2076 6172 6961 626c   k, v in variabl
+0003d7c0: 6573 0a20 2020 2020 2020 2020 2020 207d  es.            }
+0003d7d0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+0003d7e0: 4b65 7945 7272 6f72 2061 7320 653a 0a20  KeyError as e:. 
+0003d7f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0003d800: 2056 616c 7565 4572 726f 7228 0a20 2020   ValueError(.   
+0003d810: 2020 2020 2020 2020 2020 2020 2022 6361               "ca
+0003d820: 6e6e 6f74 2063 6f6e 7665 7274 2064 6963  nnot convert dic
+0003d830: 7420 7769 7468 6f75 7420 7468 6520 6b65  t without the ke
+0003d840: 7920 220a 2020 2020 2020 2020 2020 2020  y ".            
+0003d850: 2020 2020 2227 7b64 696d 735f 6461 7461      "'{dims_data
+0003d860: 7d27 222e 666f 726d 6174 2864 696d 735f  }'".format(dims_
+0003d870: 6461 7461 3d73 7472 2865 2e61 7267 735b  data=str(e.args[
+0003d880: 305d 2929 0a20 2020 2020 2020 2020 2020  0])).           
+0003d890: 2029 0a20 2020 2020 2020 206f 626a 203d   ).        obj =
+0003d8a0: 2063 6c73 2876 6172 6961 626c 655f 6469   cls(variable_di
+0003d8b0: 6374 290a 0a20 2020 2020 2020 2023 2077  ct)..        # w
+0003d8c0: 6861 7420 6966 2063 6f6f 7264 7320 6172  hat if coords ar
+0003d8d0: 656e 2774 2064 696d 733f 0a20 2020 2020  en't dims?.     
+0003d8e0: 2020 2063 6f6f 7264 7320 3d20 7365 7428     coords = set(
+0003d8f0: 642e 6765 7428 2263 6f6f 7264 7322 2c20  d.get("coords", 
+0003d900: 7b7d 2929 202d 2073 6574 2864 2e67 6574  {})) - set(d.get
+0003d910: 2822 6469 6d73 222c 207b 7d29 290a 2020  ("dims", {})).  
+0003d920: 2020 2020 2020 6f62 6a20 3d20 6f62 6a2e        obj = obj.
+0003d930: 7365 745f 636f 6f72 6473 2863 6f6f 7264  set_coords(coord
+0003d940: 7329 0a0a 2020 2020 2020 2020 6f62 6a2e  s)..        obj.
+0003d950: 6174 7472 732e 7570 6461 7465 2864 2e67  attrs.update(d.g
+0003d960: 6574 2822 6174 7472 7322 2c20 7b7d 2929  et("attrs", {}))
+0003d970: 0a20 2020 2020 2020 206f 626a 2e65 6e63  .        obj.enc
+0003d980: 6f64 696e 672e 7570 6461 7465 2864 2e67  oding.update(d.g
+0003d990: 6574 2822 656e 636f 6469 6e67 222c 207b  et("encoding", {
+0003d9a0: 7d29 290a 0a20 2020 2020 2020 2072 6574  }))..        ret
+0003d9b0: 7572 6e20 6f62 6a0a 0a20 2020 2064 6566  urn obj..    def
+0003d9c0: 205f 756e 6172 795f 6f70 2873 656c 663a   _unary_op(self:
+0003d9d0: 2054 5f44 6174 6173 6574 2c20 662c 202a   T_Dataset, f, *
+0003d9e0: 6172 6773 2c20 2a2a 6b77 6172 6773 2920  args, **kwargs) 
+0003d9f0: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
+0003da00: 2020 2020 2020 7661 7269 6162 6c65 7320        variables 
+0003da10: 3d20 7b7d 0a20 2020 2020 2020 206b 6565  = {}.        kee
+0003da20: 705f 6174 7472 7320 3d20 6b77 6172 6773  p_attrs = kwargs
+0003da30: 2e70 6f70 2822 6b65 6570 5f61 7474 7273  .pop("keep_attrs
+0003da40: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
+0003da50: 2069 6620 6b65 6570 5f61 7474 7273 2069   if keep_attrs i
+0003da60: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0003da70: 2020 2020 6b65 6570 5f61 7474 7273 203d      keep_attrs =
+0003da80: 205f 6765 745f 6b65 6570 5f61 7474 7273   _get_keep_attrs
+0003da90: 2864 6566 6175 6c74 3d54 7275 6529 0a20  (default=True). 
+0003daa0: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
+0003dab0: 696e 2073 656c 662e 5f76 6172 6961 626c  in self._variabl
+0003dac0: 6573 2e69 7465 6d73 2829 3a0a 2020 2020  es.items():.    
+0003dad0: 2020 2020 2020 2020 6966 206b 2069 6e20          if k in 
+0003dae0: 7365 6c66 2e5f 636f 6f72 645f 6e61 6d65  self._coord_name
+0003daf0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
+0003db00: 2020 2076 6172 6961 626c 6573 5b6b 5d20     variables[k] 
+0003db10: 3d20 760a 2020 2020 2020 2020 2020 2020  = v.            
+0003db20: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0003db30: 2020 2020 2020 7661 7269 6162 6c65 735b        variables[
+0003db40: 6b5d 203d 2066 2876 2c20 2a61 7267 732c  k] = f(v, *args,
+0003db50: 202a 2a6b 7761 7267 7329 0a20 2020 2020   **kwargs).     
+0003db60: 2020 2020 2020 2020 2020 2069 6620 6b65             if ke
+0003db70: 6570 5f61 7474 7273 3a0a 2020 2020 2020  ep_attrs:.      
+0003db80: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0003db90: 7269 6162 6c65 735b 6b5d 2e61 7474 7273  riables[k].attrs
+0003dba0: 203d 2076 2e5f 6174 7472 730a 2020 2020   = v._attrs.    
+0003dbb0: 2020 2020 6174 7472 7320 3d20 7365 6c66      attrs = self
+0003dbc0: 2e5f 6174 7472 7320 6966 206b 6565 705f  ._attrs if keep_
+0003dbd0: 6174 7472 7320 656c 7365 204e 6f6e 650a  attrs else None.
+0003dbe0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0003dbf0: 656c 662e 5f72 6570 6c61 6365 5f77 6974  elf._replace_wit
+0003dc00: 685f 6e65 775f 6469 6d73 2876 6172 6961  h_new_dims(varia
+0003dc10: 626c 6573 2c20 6174 7472 733d 6174 7472  bles, attrs=attr
+0003dc20: 7329 0a0a 2020 2020 6465 6620 5f62 696e  s)..    def _bin
+0003dc30: 6172 795f 6f70 2873 656c 662c 206f 7468  ary_op(self, oth
+0003dc40: 6572 2c20 662c 2072 6566 6c65 7869 7665  er, f, reflexive
+0003dc50: 3d46 616c 7365 2c20 6a6f 696e 3d4e 6f6e  =False, join=Non
+0003dc60: 6529 202d 3e20 4461 7461 7365 743a 0a20  e) -> Dataset:. 
+0003dc70: 2020 2020 2020 2066 726f 6d20 7861 7272         from xarr
+0003dc80: 6179 2e63 6f72 652e 6461 7461 6172 7261  ay.core.dataarra
+0003dc90: 7920 696d 706f 7274 2044 6174 6141 7272  y import DataArr
+0003dca0: 6179 0a20 2020 2020 2020 2066 726f 6d20  ay.        from 
+0003dcb0: 7861 7272 6179 2e63 6f72 652e 6772 6f75  xarray.core.grou
+0003dcc0: 7062 7920 696d 706f 7274 2047 726f 7570  pby import Group
+0003dcd0: 4279 0a0a 2020 2020 2020 2020 6966 2069  By..        if i
+0003dce0: 7369 6e73 7461 6e63 6528 6f74 6865 722c  sinstance(other,
+0003dcf0: 2047 726f 7570 4279 293a 0a20 2020 2020   GroupBy):.     
+0003dd00: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+0003dd10: 7449 6d70 6c65 6d65 6e74 6564 0a20 2020  tImplemented.   
+0003dd20: 2020 2020 2061 6c69 676e 5f74 7970 6520       align_type 
+0003dd30: 3d20 4f50 5449 4f4e 535b 2261 7269 7468  = OPTIONS["arith
+0003dd40: 6d65 7469 635f 6a6f 696e 225d 2069 6620  metic_join"] if 
+0003dd50: 6a6f 696e 2069 7320 4e6f 6e65 2065 6c73  join is None els
+0003dd60: 6520 6a6f 696e 0a20 2020 2020 2020 2069  e join.        i
+0003dd70: 6620 6973 696e 7374 616e 6365 286f 7468  f isinstance(oth
+0003dd80: 6572 2c20 2844 6174 6141 7272 6179 2c20  er, (DataArray, 
+0003dd90: 4461 7461 7365 7429 293a 0a20 2020 2020  Dataset)):.     
+0003dda0: 2020 2020 2020 2073 656c 662c 206f 7468         self, oth
+0003ddb0: 6572 203d 2061 6c69 676e 2873 656c 662c  er = align(self,
+0003ddc0: 206f 7468 6572 2c20 6a6f 696e 3d61 6c69   other, join=ali
+0003ddd0: 676e 5f74 7970 652c 2063 6f70 793d 4661  gn_type, copy=Fa
+0003dde0: 6c73 6529 2020 2320 7479 7065 3a20 6967  lse)  # type: ig
+0003ddf0: 6e6f 7265 5b61 7373 6967 6e6d 656e 745d  nore[assignment]
+0003de00: 0a20 2020 2020 2020 2067 203d 2066 2069  .        g = f i
+0003de10: 6620 6e6f 7420 7265 666c 6578 6976 6520  f not reflexive 
+0003de20: 656c 7365 206c 616d 6264 6120 782c 2079  else lambda x, y
+0003de30: 3a20 6628 792c 2078 290a 2020 2020 2020  : f(y, x).      
+0003de40: 2020 6473 203d 2073 656c 662e 5f63 616c    ds = self._cal
+0003de50: 6375 6c61 7465 5f62 696e 6172 795f 6f70  culate_binary_op
+0003de60: 2867 2c20 6f74 6865 722c 206a 6f69 6e3d  (g, other, join=
+0003de70: 616c 6967 6e5f 7479 7065 290a 2020 2020  align_type).    
+0003de80: 2020 2020 6b65 6570 5f61 7474 7273 203d      keep_attrs =
+0003de90: 205f 6765 745f 6b65 6570 5f61 7474 7273   _get_keep_attrs
+0003dea0: 2864 6566 6175 6c74 3d46 616c 7365 290a  (default=False).
+0003deb0: 2020 2020 2020 2020 6966 206b 6565 705f          if keep_
+0003dec0: 6174 7472 733a 0a20 2020 2020 2020 2020  attrs:.         
+0003ded0: 2020 2064 732e 6174 7472 7320 3d20 7365     ds.attrs = se
+0003dee0: 6c66 2e61 7474 7273 0a20 2020 2020 2020  lf.attrs.       
+0003def0: 2072 6574 7572 6e20 6473 0a0a 2020 2020   return ds..    
+0003df00: 6465 6620 5f69 6e70 6c61 6365 5f62 696e  def _inplace_bin
+0003df10: 6172 795f 6f70 2873 656c 663a 2054 5f44  ary_op(self: T_D
+0003df20: 6174 6173 6574 2c20 6f74 6865 722c 2066  ataset, other, f
+0003df30: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
+0003df40: 2020 2020 2020 2020 6672 6f6d 2078 6172          from xar
+0003df50: 7261 792e 636f 7265 2e64 6174 6161 7272  ray.core.dataarr
+0003df60: 6179 2069 6d70 6f72 7420 4461 7461 4172  ay import DataAr
+0003df70: 7261 790a 2020 2020 2020 2020 6672 6f6d  ray.        from
+0003df80: 2078 6172 7261 792e 636f 7265 2e67 726f   xarray.core.gro
+0003df90: 7570 6279 2069 6d70 6f72 7420 4772 6f75  upby import Grou
+0003dfa0: 7042 790a 0a20 2020 2020 2020 2069 6620  pBy..        if 
+0003dfb0: 6973 696e 7374 616e 6365 286f 7468 6572  isinstance(other
+0003dfc0: 2c20 4772 6f75 7042 7929 3a0a 2020 2020  , GroupBy):.    
+0003dfd0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+0003dfe0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
+0003dff0: 2020 2020 2020 2020 2022 696e 2d70 6c61           "in-pla
+0003e000: 6365 206f 7065 7261 7469 6f6e 7320 6265  ce operations be
+0003e010: 7477 6565 6e20 6120 4461 7461 7365 7420  tween a Dataset 
+0003e020: 616e 6420 220a 2020 2020 2020 2020 2020  and ".          
+0003e030: 2020 2020 2020 2261 2067 726f 7570 6564        "a grouped
+0003e040: 206f 626a 6563 7420 6172 6520 6e6f 7420   object are not 
+0003e050: 7065 726d 6974 7465 6422 0a20 2020 2020  permitted".     
+0003e060: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0003e070: 2023 2077 6520 646f 6e27 7420 6163 7475   # we don't actu
+0003e080: 616c 6c79 206d 6f64 6966 7920 6172 7261  ally modify arra
+0003e090: 7973 2069 6e2d 706c 6163 6520 7769 7468  ys in-place with
+0003e0a0: 2069 6e2d 706c 6163 6520 4461 7461 7365   in-place Datase
+0003e0b0: 740a 2020 2020 2020 2020 2320 6172 6974  t.        # arit
+0003e0c0: 686d 6574 6963 202d 2d20 7468 6973 206c  hmetic -- this l
+0003e0d0: 6574 7320 7573 2061 7574 6f6d 6174 6963  ets us automatic
+0003e0e0: 616c 6c79 2061 6c69 676e 2074 6869 6e67  ally align thing
+0003e0f0: 730a 2020 2020 2020 2020 6966 2069 7369  s.        if isi
+0003e100: 6e73 7461 6e63 6528 6f74 6865 722c 2028  nstance(other, (
+0003e110: 4461 7461 4172 7261 792c 2044 6174 6173  DataArray, Datas
+0003e120: 6574 2929 3a0a 2020 2020 2020 2020 2020  et)):.          
+0003e130: 2020 6f74 6865 7220 3d20 6f74 6865 722e    other = other.
+0003e140: 7265 696e 6465 785f 6c69 6b65 2873 656c  reindex_like(sel
+0003e150: 662c 2063 6f70 793d 4661 6c73 6529 0a20  f, copy=False). 
+0003e160: 2020 2020 2020 2067 203d 206f 7073 2e69         g = ops.i
+0003e170: 6e70 6c61 6365 5f74 6f5f 6e6f 6e69 6e70  nplace_to_noninp
+0003e180: 6c61 6365 5f6f 7028 6629 0a20 2020 2020  lace_op(f).     
+0003e190: 2020 2064 7320 3d20 7365 6c66 2e5f 6361     ds = self._ca
+0003e1a0: 6c63 756c 6174 655f 6269 6e61 7279 5f6f  lculate_binary_o
+0003e1b0: 7028 672c 206f 7468 6572 2c20 696e 706c  p(g, other, inpl
+0003e1c0: 6163 653d 5472 7565 290a 2020 2020 2020  ace=True).      
+0003e1d0: 2020 7365 6c66 2e5f 7265 706c 6163 655f    self._replace_
+0003e1e0: 7769 7468 5f6e 6577 5f64 696d 7328 0a20  with_new_dims(. 
+0003e1f0: 2020 2020 2020 2020 2020 2064 732e 5f76             ds._v
+0003e200: 6172 6961 626c 6573 2c0a 2020 2020 2020  ariables,.      
+0003e210: 2020 2020 2020 6473 2e5f 636f 6f72 645f        ds._coord_
+0003e220: 6e61 6d65 732c 0a20 2020 2020 2020 2020  names,.         
+0003e230: 2020 2061 7474 7273 3d64 732e 5f61 7474     attrs=ds._att
+0003e240: 7273 2c0a 2020 2020 2020 2020 2020 2020  rs,.            
+0003e250: 696e 6465 7865 733d 6473 2e5f 696e 6465  indexes=ds._inde
+0003e260: 7865 732c 0a20 2020 2020 2020 2020 2020  xes,.           
+0003e270: 2069 6e70 6c61 6365 3d54 7275 652c 0a20   inplace=True,. 
+0003e280: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0003e290: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+0003e2a0: 2020 6465 6620 5f63 616c 6375 6c61 7465    def _calculate
+0003e2b0: 5f62 696e 6172 795f 6f70 280a 2020 2020  _binary_op(.    
+0003e2c0: 2020 2020 7365 6c66 2c20 662c 206f 7468      self, f, oth
+0003e2d0: 6572 2c20 6a6f 696e 3d22 696e 6e65 7222  er, join="inner"
+0003e2e0: 2c20 696e 706c 6163 653a 2062 6f6f 6c20  , inplace: bool 
+0003e2f0: 3d20 4661 6c73 650a 2020 2020 2920 2d3e  = False.    ) ->
+0003e300: 2044 6174 6173 6574 3a0a 2020 2020 2020   Dataset:.      
+0003e310: 2020 6465 6620 6170 706c 795f 6f76 6572    def apply_over
+0003e320: 5f62 6f74 6828 6c68 735f 6461 7461 5f76  _both(lhs_data_v
+0003e330: 6172 732c 2072 6873 5f64 6174 615f 7661  ars, rhs_data_va
+0003e340: 7273 2c20 6c68 735f 7661 7273 2c20 7268  rs, lhs_vars, rh
+0003e350: 735f 7661 7273 293a 0a20 2020 2020 2020  s_vars):.       
+0003e360: 2020 2020 2069 6620 696e 706c 6163 6520       if inplace 
+0003e370: 616e 6420 7365 7428 6c68 735f 6461 7461  and set(lhs_data
+0003e380: 5f76 6172 7329 2021 3d20 7365 7428 7268  _vars) != set(rh
+0003e390: 735f 6461 7461 5f76 6172 7329 3a0a 2020  s_data_vars):.  
+0003e3a0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0003e3b0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0003e3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003e3d0: 2020 2020 2264 6174 6173 6574 7320 6d75      "datasets mu
+0003e3e0: 7374 2068 6176 6520 7468 6520 7361 6d65  st have the same
+0003e3f0: 2064 6174 6120 7661 7269 6162 6c65 7320   data variables 
+0003e400: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+0003e410: 2020 2020 2020 6622 666f 7220 696e 2d70        f"for in-p
+0003e420: 6c61 6365 2061 7269 7468 6d65 7469 6320  lace arithmetic 
+0003e430: 6f70 6572 6174 696f 6e73 3a20 7b6c 6973  operations: {lis
+0003e440: 7428 6c68 735f 6461 7461 5f76 6172 7329  t(lhs_data_vars)
+0003e450: 7d2c 207b 6c69 7374 2872 6873 5f64 6174  }, {list(rhs_dat
+0003e460: 615f 7661 7273 297d 220a 2020 2020 2020  a_vars)}".      
+0003e470: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+0003e480: 2020 2020 2020 2020 2064 6573 745f 7661           dest_va
+0003e490: 7273 203d 207b 7d0a 0a20 2020 2020 2020  rs = {}..       
+0003e4a0: 2020 2020 2066 6f72 206b 2069 6e20 6c68       for k in lh
+0003e4b0: 735f 6461 7461 5f76 6172 733a 0a20 2020  s_data_vars:.   
+0003e4c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0003e4d0: 6b20 696e 2072 6873 5f64 6174 615f 7661  k in rhs_data_va
+0003e4e0: 7273 3a0a 2020 2020 2020 2020 2020 2020  rs:.            
+0003e4f0: 2020 2020 2020 2020 6465 7374 5f76 6172          dest_var
+0003e500: 735b 6b5d 203d 2066 286c 6873 5f76 6172  s[k] = f(lhs_var
+0003e510: 735b 6b5d 2c20 7268 735f 7661 7273 5b6b  s[k], rhs_vars[k
+0003e520: 5d29 0a20 2020 2020 2020 2020 2020 2020  ]).             
+0003e530: 2020 2065 6c69 6620 6a6f 696e 2069 6e20     elif join in 
+0003e540: 5b22 6c65 6674 222c 2022 6f75 7465 7222  ["left", "outer"
+0003e550: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+0003e560: 2020 2020 2020 2064 6573 745f 7661 7273         dest_vars
+0003e570: 5b6b 5d20 3d20 6628 6c68 735f 7661 7273  [k] = f(lhs_vars
+0003e580: 5b6b 5d2c 206e 702e 6e61 6e29 0a20 2020  [k], np.nan).   
+0003e590: 2020 2020 2020 2020 2066 6f72 206b 2069           for k i
+0003e5a0: 6e20 7268 735f 6461 7461 5f76 6172 733a  n rhs_data_vars:
+0003e5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003e5c0: 2069 6620 6b20 6e6f 7420 696e 2064 6573   if k not in des
+0003e5d0: 745f 7661 7273 2061 6e64 206a 6f69 6e20  t_vars and join 
+0003e5e0: 696e 205b 2272 6967 6874 222c 2022 6f75  in ["right", "ou
+0003e5f0: 7465 7222 5d3a 0a20 2020 2020 2020 2020  ter"]:.         
+0003e600: 2020 2020 2020 2020 2020 2064 6573 745f             dest_
+0003e610: 7661 7273 5b6b 5d20 3d20 6628 7268 735f  vars[k] = f(rhs_
+0003e620: 7661 7273 5b6b 5d2c 206e 702e 6e61 6e29  vars[k], np.nan)
+0003e630: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0003e640: 7572 6e20 6465 7374 5f76 6172 730a 0a20  urn dest_vars.. 
+0003e650: 2020 2020 2020 2069 6620 7574 696c 732e         if utils.
+0003e660: 6973 5f64 6963 745f 6c69 6b65 286f 7468  is_dict_like(oth
+0003e670: 6572 2920 616e 6420 6e6f 7420 6973 696e  er) and not isin
+0003e680: 7374 616e 6365 286f 7468 6572 2c20 4461  stance(other, Da
+0003e690: 7461 7365 7429 3a0a 2020 2020 2020 2020  taset):.        
+0003e6a0: 2020 2020 2320 6361 6e27 7420 7573 6520      # can't use 
+0003e6b0: 6f75 7220 7368 6f72 7463 7574 206f 6620  our shortcut of 
+0003e6c0: 646f 696e 6720 7468 6520 6269 6e61 7279  doing the binary
+0003e6d0: 206f 7065 7261 7469 6f6e 2077 6974 680a   operation with.
+0003e6e0: 2020 2020 2020 2020 2020 2020 2320 5661              # Va
+0003e6f0: 7269 6162 6c65 206f 626a 6563 7473 2c20  riable objects, 
+0003e700: 736f 2061 7070 6c79 206f 7665 7220 6f75  so apply over ou
+0003e710: 7220 6461 7461 2076 6172 7320 696e 7374  r data vars inst
+0003e720: 6561 642e 0a20 2020 2020 2020 2020 2020  ead..           
+0003e730: 206e 6577 5f64 6174 615f 7661 7273 203d   new_data_vars =
+0003e740: 2061 7070 6c79 5f6f 7665 725f 626f 7468   apply_over_both
+0003e750: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003e760: 2020 7365 6c66 2e64 6174 615f 7661 7273    self.data_vars
+0003e770: 2c20 6f74 6865 722c 2073 656c 662e 6461  , other, self.da
+0003e780: 7461 5f76 6172 732c 206f 7468 6572 0a20  ta_vars, other. 
+0003e790: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0003e7a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0003e7b0: 7479 7065 2873 656c 6629 286e 6577 5f64  type(self)(new_d
+0003e7c0: 6174 615f 7661 7273 290a 0a20 2020 2020  ata_vars)..     
+0003e7d0: 2020 206f 7468 6572 5f63 6f6f 7264 733a     other_coords:
+0003e7e0: 2043 6f6f 7264 696e 6174 6573 207c 204e   Coordinates | N
+0003e7f0: 6f6e 6520 3d20 6765 7461 7474 7228 6f74  one = getattr(ot
+0003e800: 6865 722c 2022 636f 6f72 6473 222c 204e  her, "coords", N
+0003e810: 6f6e 6529 0a20 2020 2020 2020 2064 7320  one).        ds 
+0003e820: 3d20 7365 6c66 2e63 6f6f 7264 732e 6d65  = self.coords.me
+0003e830: 7267 6528 6f74 6865 725f 636f 6f72 6473  rge(other_coords
+0003e840: 290a 0a20 2020 2020 2020 2069 6620 6973  )..        if is
+0003e850: 696e 7374 616e 6365 286f 7468 6572 2c20  instance(other, 
+0003e860: 4461 7461 7365 7429 3a0a 2020 2020 2020  Dataset):.      
+0003e870: 2020 2020 2020 6e65 775f 7661 7273 203d        new_vars =
+0003e880: 2061 7070 6c79 5f6f 7665 725f 626f 7468   apply_over_both
+0003e890: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0003e8a0: 2020 7365 6c66 2e64 6174 615f 7661 7273    self.data_vars
+0003e8b0: 2c20 6f74 6865 722e 6461 7461 5f76 6172  , other.data_var
+0003e8c0: 732c 2073 656c 662e 7661 7269 6162 6c65  s, self.variable
+0003e8d0: 732c 206f 7468 6572 2e76 6172 6961 626c  s, other.variabl
+0003e8e0: 6573 0a20 2020 2020 2020 2020 2020 2029  es.            )
+0003e8f0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0003e900: 2020 2020 2020 2020 2020 206f 7468 6572             other
+0003e910: 5f76 6172 6961 626c 6520 3d20 6765 7461  _variable = geta
+0003e920: 7474 7228 6f74 6865 722c 2022 7661 7269  ttr(other, "vari
+0003e930: 6162 6c65 222c 206f 7468 6572 290a 2020  able", other).  
+0003e940: 2020 2020 2020 2020 2020 6e65 775f 7661            new_va
+0003e950: 7273 203d 207b 6b3a 2066 2873 656c 662e  rs = {k: f(self.
+0003e960: 7661 7269 6162 6c65 735b 6b5d 2c20 6f74  variables[k], ot
+0003e970: 6865 725f 7661 7269 6162 6c65 2920 666f  her_variable) fo
+0003e980: 7220 6b20 696e 2073 656c 662e 6461 7461  r k in self.data
+0003e990: 5f76 6172 737d 0a20 2020 2020 2020 2064  _vars}.        d
+0003e9a0: 732e 5f76 6172 6961 626c 6573 2e75 7064  s._variables.upd
+0003e9b0: 6174 6528 6e65 775f 7661 7273 290a 2020  ate(new_vars).  
+0003e9c0: 2020 2020 2020 6473 2e5f 6469 6d73 203d        ds._dims =
+0003e9d0: 2063 616c 6375 6c61 7465 5f64 696d 656e   calculate_dimen
+0003e9e0: 7369 6f6e 7328 6473 2e5f 7661 7269 6162  sions(ds._variab
+0003e9f0: 6c65 7329 0a20 2020 2020 2020 2072 6574  les).        ret
+0003ea00: 7572 6e20 6473 0a0a 2020 2020 6465 6620  urn ds..    def 
+0003ea10: 5f63 6f70 795f 6174 7472 735f 6672 6f6d  _copy_attrs_from
+0003ea20: 2873 656c 662c 206f 7468 6572 293a 0a20  (self, other):. 
+0003ea30: 2020 2020 2020 2073 656c 662e 6174 7472         self.attr
+0003ea40: 7320 3d20 6f74 6865 722e 6174 7472 730a  s = other.attrs.
+0003ea50: 2020 2020 2020 2020 666f 7220 7620 696e          for v in
+0003ea60: 206f 7468 6572 2e76 6172 6961 626c 6573   other.variables
+0003ea70: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+0003ea80: 2076 2069 6e20 7365 6c66 2e76 6172 6961   v in self.varia
+0003ea90: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
+0003eaa0: 2020 2020 2020 7365 6c66 2e76 6172 6961        self.varia
+0003eab0: 626c 6573 5b76 5d2e 6174 7472 7320 3d20  bles[v].attrs = 
+0003eac0: 6f74 6865 722e 7661 7269 6162 6c65 735b  other.variables[
+0003ead0: 765d 2e61 7474 7273 0a0a 2020 2020 6465  v].attrs..    de
+0003eae0: 6620 6469 6666 280a 2020 2020 2020 2020  f diff(.        
+0003eaf0: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+0003eb00: 0a20 2020 2020 2020 2064 696d 3a20 4861  .        dim: Ha
+0003eb10: 7368 6162 6c65 2c0a 2020 2020 2020 2020  shable,.        
+0003eb20: 6e3a 2069 6e74 203d 2031 2c0a 2020 2020  n: int = 1,.    
+0003eb30: 2020 2020 6c61 6265 6c3a 204c 6974 6572      label: Liter
+0003eb40: 616c 5b22 7570 7065 7222 2c20 226c 6f77  al["upper", "low
+0003eb50: 6572 225d 203d 2022 7570 7065 7222 2c0a  er"] = "upper",.
+0003eb60: 2020 2020 2920 2d3e 2054 5f44 6174 6173      ) -> T_Datas
+0003eb70: 6574 3a0a 2020 2020 2020 2020 2222 2243  et:.        """C
+0003eb80: 616c 6375 6c61 7465 2074 6865 206e 2d74  alculate the n-t
+0003eb90: 6820 6f72 6465 7220 6469 7363 7265 7465  h order discrete
+0003eba0: 2064 6966 6665 7265 6e63 6520 616c 6f6e   difference alon
+0003ebb0: 6720 6769 7665 6e20 6178 6973 2e0a 0a20  g given axis... 
+0003ebc0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0003ebd0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+0003ebe0: 2d2d 2d2d 0a20 2020 2020 2020 2064 696d  ----.        dim
+0003ebf0: 203a 2048 6173 6861 626c 650a 2020 2020   : Hashable.    
+0003ec00: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+0003ec10: 6e20 6f76 6572 2077 6869 6368 2074 6f20  n over which to 
+0003ec20: 6361 6c63 756c 6174 6520 7468 6520 6669  calculate the fi
+0003ec30: 6e69 7465 2064 6966 6665 7265 6e63 652e  nite difference.
+0003ec40: 0a20 2020 2020 2020 206e 203a 2069 6e74  .        n : int
+0003ec50: 2c20 6465 6661 756c 743a 2031 0a20 2020  , default: 1.   
+0003ec60: 2020 2020 2020 2020 2054 6865 206e 756d           The num
+0003ec70: 6265 7220 6f66 2074 696d 6573 2076 616c  ber of times val
+0003ec80: 7565 7320 6172 6520 6469 6666 6572 656e  ues are differen
+0003ec90: 6365 642e 0a20 2020 2020 2020 206c 6162  ced..        lab
+0003eca0: 656c 203a 207b 2275 7070 6572 222c 2022  el : {"upper", "
+0003ecb0: 6c6f 7765 7222 7d2c 2064 6566 6175 6c74  lower"}, default
+0003ecc0: 3a20 2275 7070 6572 220a 2020 2020 2020  : "upper".      
+0003ecd0: 2020 2020 2020 5468 6520 6e65 7720 636f        The new co
+0003ece0: 6f72 6469 6e61 7465 2069 6e20 6469 6d65  ordinate in dime
+0003ecf0: 6e73 696f 6e20 6060 6469 6d60 6020 7769  nsion ``dim`` wi
+0003ed00: 6c6c 2068 6176 6520 7468 650a 2020 2020  ll have the.    
+0003ed10: 2020 2020 2020 2020 7661 6c75 6573 206f          values o
+0003ed20: 6620 6569 7468 6572 2074 6865 206d 696e  f either the min
+0003ed30: 7565 6e64 2773 206f 7220 7375 6274 7261  uend's or subtra
+0003ed40: 6865 6e64 2773 2063 6f6f 7264 696e 6174  hend's coordinat
+0003ed50: 650a 2020 2020 2020 2020 2020 2020 666f  e.            fo
+0003ed60: 7220 7661 6c75 6573 2027 7570 7065 7227  r values 'upper'
+0003ed70: 2061 6e64 2027 6c6f 7765 7227 2c20 7265   and 'lower', re
+0003ed80: 7370 6563 7469 7665 6c79 2e0a 0a20 2020  spectively...   
+0003ed90: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
+0003eda0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
+0003edb0: 2020 2020 2064 6966 6665 7265 6e63 6520       difference 
+0003edc0: 3a20 4461 7461 7365 740a 2020 2020 2020  : Dataset.      
+0003edd0: 2020 2020 2020 5468 6520 6e2d 7468 206f        The n-th o
+0003ede0: 7264 6572 2066 696e 6974 6520 6469 6666  rder finite diff
+0003edf0: 6572 656e 6365 206f 6620 7468 6973 206f  erence of this o
+0003ee00: 626a 6563 742e 0a0a 2020 2020 2020 2020  bject...        
+0003ee10: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
+0003ee20: 2d2d 2d0a 2020 2020 2020 2020 606e 6020  ---.        `n` 
+0003ee30: 6d61 7463 6865 7320 6e75 6d70 7927 7320  matches numpy's 
+0003ee40: 6265 6861 7669 6f72 2061 6e64 2069 7320  behavior and is 
+0003ee50: 6469 6666 6572 656e 7420 6672 6f6d 2070  different from p
+0003ee60: 616e 6461 7327 2066 6972 7374 2061 7267  andas' first arg
+0003ee70: 756d 656e 7420 6e61 6d65 640a 2020 2020  ument named.    
+0003ee80: 2020 2020 6070 6572 696f 6473 602e 0a0a      `periods`...
+0003ee90: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+0003eea0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0003eeb0: 2d0a 2020 2020 2020 2020 3e3e 3e20 6473  -.        >>> ds
+0003eec0: 203d 2078 722e 4461 7461 7365 7428 7b22   = xr.Dataset({"
+0003eed0: 666f 6f22 3a20 2822 7822 2c20 5b35 2c20  foo": ("x", [5, 
+0003eee0: 352c 2036 2c20 365d 297d 290a 2020 2020  5, 6, 6])}).    
+0003eef0: 2020 2020 3e3e 3e20 6473 2e64 6966 6628      >>> ds.diff(
+0003ef00: 2278 2229 0a20 2020 2020 2020 203c 7861  "x").        <xa
+0003ef10: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
+0003ef20: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
+0003ef30: 3a20 2028 783a 2033 290a 2020 2020 2020  :  (x: 3).      
+0003ef40: 2020 4469 6d65 6e73 696f 6e73 2077 6974    Dimensions wit
+0003ef50: 686f 7574 2063 6f6f 7264 696e 6174 6573  hout coordinates
+0003ef60: 3a20 780a 2020 2020 2020 2020 4461 7461  : x.        Data
+0003ef70: 2076 6172 6961 626c 6573 3a0a 2020 2020   variables:.    
+0003ef80: 2020 2020 2020 2020 666f 6f20 2020 2020          foo     
+0003ef90: 2028 7829 2069 6e74 3634 2030 2031 2030   (x) int64 0 1 0
+0003efa0: 0a20 2020 2020 2020 203e 3e3e 2064 732e  .        >>> ds.
+0003efb0: 6469 6666 2822 7822 2c20 3229 0a20 2020  diff("x", 2).   
+0003efc0: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
+0003efd0: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
+0003efe0: 6d65 6e73 696f 6e73 3a20 2028 783a 2032  mensions:  (x: 2
+0003eff0: 290a 2020 2020 2020 2020 4469 6d65 6e73  ).        Dimens
+0003f000: 696f 6e73 2077 6974 686f 7574 2063 6f6f  ions without coo
+0003f010: 7264 696e 6174 6573 3a20 780a 2020 2020  rdinates: x.    
+0003f020: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
+0003f030: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+0003f040: 666f 6f20 2020 2020 2028 7829 2069 6e74  foo      (x) int
+0003f050: 3634 2031 202d 310a 0a20 2020 2020 2020  64 1 -1..       
+0003f060: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+0003f070: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+0003f080: 2020 2044 6174 6173 6574 2e64 6966 6665     Dataset.diffe
+0003f090: 7265 6e74 6961 7465 0a20 2020 2020 2020  rentiate.       
+0003f0a0: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+0003f0b0: 6e20 3d3d 2030 3a0a 2020 2020 2020 2020  n == 0:.        
+0003f0c0: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
+0003f0d0: 2020 2020 2020 2020 6966 206e 203c 2030          if n < 0
+0003f0e0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0003f0f0: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
+0003f100: 226f 7264 6572 2060 6e60 206d 7573 7420  "order `n` must 
+0003f110: 6265 206e 6f6e 2d6e 6567 6174 6976 6520  be non-negative 
+0003f120: 6275 7420 676f 7420 7b6e 7d22 290a 0a20  but got {n}").. 
+0003f130: 2020 2020 2020 2023 2070 7265 7061 7265         # prepare
+0003f140: 2073 6c69 6365 730a 2020 2020 2020 2020   slices.        
+0003f150: 736c 6963 655f 7374 6172 7420 3d20 7b64  slice_start = {d
+0003f160: 696d 3a20 736c 6963 6528 4e6f 6e65 2c20  im: slice(None, 
+0003f170: 2d31 297d 0a20 2020 2020 2020 2073 6c69  -1)}.        sli
+0003f180: 6365 5f65 6e64 203d 207b 6469 6d3a 2073  ce_end = {dim: s
+0003f190: 6c69 6365 2831 2c20 4e6f 6e65 297d 0a0a  lice(1, None)}..
+0003f1a0: 2020 2020 2020 2020 2320 7072 6570 6172          # prepar
+0003f1b0: 6520 6e65 7720 636f 6f72 6469 6e61 7465  e new coordinate
+0003f1c0: 0a20 2020 2020 2020 2069 6620 6c61 6265  .        if labe
+0003f1d0: 6c20 3d3d 2022 7570 7065 7222 3a0a 2020  l == "upper":.  
+0003f1e0: 2020 2020 2020 2020 2020 736c 6963 655f            slice_
+0003f1f0: 6e65 7720 3d20 736c 6963 655f 656e 640a  new = slice_end.
+0003f200: 2020 2020 2020 2020 656c 6966 206c 6162          elif lab
+0003f210: 656c 203d 3d20 226c 6f77 6572 223a 0a20  el == "lower":. 
+0003f220: 2020 2020 2020 2020 2020 2073 6c69 6365             slice
+0003f230: 5f6e 6577 203d 2073 6c69 6365 5f73 7461  _new = slice_sta
+0003f240: 7274 0a20 2020 2020 2020 2065 6c73 653a  rt.        else:
+0003f250: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0003f260: 7365 2056 616c 7565 4572 726f 7228 2254  se ValueError("T
+0003f270: 6865 2027 6c61 6265 6c27 2061 7267 756d  he 'label' argum
+0003f280: 656e 7420 6861 7320 746f 2062 6520 6569  ent has to be ei
+0003f290: 7468 6572 2027 7570 7065 7227 206f 7220  ther 'upper' or 
+0003f2a0: 276c 6f77 6572 2722 290a 0a20 2020 2020  'lower'")..     
+0003f2b0: 2020 2069 6e64 6578 6573 2c20 696e 6465     indexes, inde
+0003f2c0: 785f 7661 7273 203d 2069 7365 6c5f 696e  x_vars = isel_in
+0003f2d0: 6465 7865 7328 7365 6c66 2e78 696e 6465  dexes(self.xinde
+0003f2e0: 7865 732c 2073 6c69 6365 5f6e 6577 290a  xes, slice_new).
+0003f2f0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+0003f300: 7320 3d20 7b7d 0a0a 2020 2020 2020 2020  s = {}..        
+0003f310: 666f 7220 6e61 6d65 2c20 7661 7220 696e  for name, var in
+0003f320: 2073 656c 662e 7661 7269 6162 6c65 732e   self.variables.
+0003f330: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+0003f340: 2020 2020 2069 6620 6e61 6d65 2069 6e20       if name in 
+0003f350: 696e 6465 785f 7661 7273 3a0a 2020 2020  index_vars:.    
+0003f360: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+0003f370: 6162 6c65 735b 6e61 6d65 5d20 3d20 696e  ables[name] = in
+0003f380: 6465 785f 7661 7273 5b6e 616d 655d 0a20  dex_vars[name]. 
+0003f390: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0003f3a0: 6469 6d20 696e 2076 6172 2e64 696d 733a  dim in var.dims:
+0003f3b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0003f3c0: 2069 6620 6e61 6d65 2069 6e20 7365 6c66   if name in self
+0003f3d0: 2e64 6174 615f 7661 7273 3a0a 2020 2020  .data_vars:.    
+0003f3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f3f0: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
+0003f400: 3d20 7661 722e 6973 656c 2873 6c69 6365  = var.isel(slice
+0003f410: 5f65 6e64 2920 2d20 7661 722e 6973 656c  _end) - var.isel
+0003f420: 2873 6c69 6365 5f73 7461 7274 290a 2020  (slice_start).  
+0003f430: 2020 2020 2020 2020 2020 2020 2020 656c                el
+0003f440: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003f450: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+0003f460: 735b 6e61 6d65 5d20 3d20 7661 722e 6973  s[name] = var.is
+0003f470: 656c 2873 6c69 6365 5f6e 6577 290a 2020  el(slice_new).  
+0003f480: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0003f490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003f4a0: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
+0003f4b0: 3d20 7661 720a 0a20 2020 2020 2020 2064  = var..        d
+0003f4c0: 6966 6665 7265 6e63 6520 3d20 7365 6c66  ifference = self
+0003f4d0: 2e5f 7265 706c 6163 655f 7769 7468 5f6e  ._replace_with_n
+0003f4e0: 6577 5f64 696d 7328 7661 7269 6162 6c65  ew_dims(variable
+0003f4f0: 732c 2069 6e64 6578 6573 3d69 6e64 6578  s, indexes=index
+0003f500: 6573 290a 0a20 2020 2020 2020 2069 6620  es)..        if 
+0003f510: 6e20 3e20 313a 0a20 2020 2020 2020 2020  n > 1:.         
+0003f520: 2020 2072 6574 7572 6e20 6469 6666 6572     return differ
+0003f530: 656e 6365 2e64 6966 6628 6469 6d2c 206e  ence.diff(dim, n
+0003f540: 202d 2031 290a 2020 2020 2020 2020 656c   - 1).        el
+0003f550: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0003f560: 7265 7475 726e 2064 6966 6665 7265 6e63  return differenc
+0003f570: 650a 0a20 2020 2064 6566 2073 6869 6674  e..    def shift
+0003f580: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
+0003f590: 545f 4461 7461 7365 742c 0a20 2020 2020  T_Dataset,.     
+0003f5a0: 2020 2073 6869 6674 733a 204d 6170 7069     shifts: Mappi
+0003f5b0: 6e67 5b41 6e79 2c20 696e 745d 207c 204e  ng[Any, int] | N
+0003f5c0: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+0003f5d0: 2020 2020 6669 6c6c 5f76 616c 7565 3a20      fill_value: 
+0003f5e0: 416e 7920 3d20 7872 6474 7970 6573 2e4e  Any = xrdtypes.N
+0003f5f0: 412c 0a20 2020 2020 2020 202a 2a73 6869  A,.        **shi
+0003f600: 6674 735f 6b77 6172 6773 3a20 696e 742c  fts_kwargs: int,
+0003f610: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
+0003f620: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+0003f630: 5368 6966 7420 7468 6973 2064 6174 6173  Shift this datas
+0003f640: 6574 2062 7920 616e 206f 6666 7365 7420  et by an offset 
+0003f650: 616c 6f6e 6720 6f6e 6520 6f72 206d 6f72  along one or mor
+0003f660: 6520 6469 6d65 6e73 696f 6e73 2e0a 0a20  e dimensions... 
+0003f670: 2020 2020 2020 204f 6e6c 7920 6461 7461         Only data
+0003f680: 2076 6172 6961 626c 6573 2061 7265 206d   variables are m
+0003f690: 6f76 6564 3b20 636f 6f72 6469 6e61 7465  oved; coordinate
+0003f6a0: 7320 7374 6179 2069 6e20 706c 6163 652e  s stay in place.
+0003f6b0: 2054 6869 7320 6973 0a20 2020 2020 2020   This is.       
+0003f6c0: 2063 6f6e 7369 7374 656e 7420 7769 7468   consistent with
+0003f6d0: 2074 6865 2062 6568 6176 696f 7220 6f66   the behavior of
+0003f6e0: 2060 6073 6869 6674 6060 2069 6e20 7061   ``shift`` in pa
+0003f6f0: 6e64 6173 2e0a 0a20 2020 2020 2020 2056  ndas...        V
+0003f700: 616c 7565 7320 7368 6966 7465 6420 6672  alues shifted fr
+0003f710: 6f6d 2062 6579 6f6e 6420 6172 7261 7920  om beyond array 
+0003f720: 626f 756e 6473 2077 696c 6c20 6170 7065  bounds will appe
+0003f730: 6172 2061 7420 6f6e 6520 656e 6420 6f66  ar at one end of
+0003f740: 0a20 2020 2020 2020 2065 6163 6820 6469  .        each di
+0003f750: 6d65 6e73 696f 6e2c 2077 6869 6368 2061  mension, which a
+0003f760: 7265 2066 696c 6c65 6420 6163 636f 7264  re filled accord
+0003f770: 696e 6720 746f 2060 6669 6c6c 5f76 616c  ing to `fill_val
+0003f780: 7565 602e 2046 6f72 2070 6572 696f 6469  ue`. For periodi
+0003f790: 630a 2020 2020 2020 2020 6f66 6673 6574  c.        offset
+0003f7a0: 7320 696e 7374 6561 6420 7365 6520 6072  s instead see `r
+0003f7b0: 6f6c 6c60 2e0a 0a20 2020 2020 2020 2050  oll`...        P
+0003f7c0: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+0003f7d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0003f7e0: 2020 2020 2073 6869 6674 7320 3a20 6d61       shifts : ma
+0003f7f0: 7070 696e 6720 6f66 2068 6173 6861 626c  pping of hashabl
+0003f800: 6520 746f 2069 6e74 0a20 2020 2020 2020  e to int.       
+0003f810: 2020 2020 2049 6e74 6567 6572 206f 6666       Integer off
+0003f820: 7365 7420 746f 2073 6869 6674 2061 6c6f  set to shift alo
+0003f830: 6e67 2065 6163 6820 6f66 2074 6865 2067  ng each of the g
+0003f840: 6976 656e 2064 696d 656e 7369 6f6e 732e  iven dimensions.
+0003f850: 0a20 2020 2020 2020 2020 2020 2050 6f73  .            Pos
+0003f860: 6974 6976 6520 6f66 6673 6574 7320 7368  itive offsets sh
+0003f870: 6966 7420 746f 2074 6865 2072 6967 6874  ift to the right
+0003f880: 3b20 6e65 6761 7469 7665 206f 6666 7365  ; negative offse
+0003f890: 7473 2073 6869 6674 2074 6f20 7468 650a  ts shift to the.
+0003f8a0: 2020 2020 2020 2020 2020 2020 6c65 6674              left
+0003f8b0: 2e0a 2020 2020 2020 2020 6669 6c6c 5f76  ..        fill_v
+0003f8c0: 616c 7565 203a 2073 6361 6c61 7220 6f72  alue : scalar or
+0003f8d0: 2064 6963 742d 6c69 6b65 2c20 6f70 7469   dict-like, opti
+0003f8e0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0003f8f0: 2056 616c 7565 2074 6f20 7573 6520 666f   Value to use fo
+0003f900: 7220 6e65 776c 7920 6d69 7373 696e 6720  r newly missing 
+0003f910: 7661 6c75 6573 2e20 4966 2061 2064 6963  values. If a dic
+0003f920: 742d 6c69 6b65 2c20 6d61 7073 0a20 2020  t-like, maps.   
+0003f930: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
+0003f940: 6520 6e61 6d65 7320 2869 6e63 6c75 6469  e names (includi
+0003f950: 6e67 2063 6f6f 7264 696e 6174 6573 2920  ng coordinates) 
+0003f960: 746f 2066 696c 6c20 7661 6c75 6573 2e0a  to fill values..
+0003f970: 2020 2020 2020 2020 2a2a 7368 6966 7473          **shifts
+0003f980: 5f6b 7761 7267 730a 2020 2020 2020 2020  _kwargs.        
+0003f990: 2020 2020 5468 6520 6b65 7977 6f72 6420      The keyword 
+0003f9a0: 6172 6775 6d65 6e74 7320 666f 726d 206f  arguments form o
+0003f9b0: 6620 6060 7368 6966 7473 6060 2e0a 2020  f ``shifts``..  
+0003f9c0: 2020 2020 2020 2020 2020 4f6e 6520 6f66            One of
+0003f9d0: 2073 6869 6674 7320 6f72 2073 6869 6674   shifts or shift
+0003f9e0: 735f 6b77 6172 6773 206d 7573 7420 6265  s_kwargs must be
+0003f9f0: 2070 726f 7669 6465 642e 0a0a 2020 2020   provided...    
+0003fa00: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+0003fa10: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+0003fa20: 2020 2020 7368 6966 7465 6420 3a20 4461      shifted : Da
+0003fa30: 7461 7365 740a 2020 2020 2020 2020 2020  taset.          
+0003fa40: 2020 4461 7461 7365 7420 7769 7468 2074    Dataset with t
+0003fa50: 6865 2073 616d 6520 636f 6f72 6469 6e61  he same coordina
+0003fa60: 7465 7320 616e 6420 6174 7472 6962 7574  tes and attribut
+0003fa70: 6573 2062 7574 2073 6869 6674 6564 2064  es but shifted d
+0003fa80: 6174 610a 2020 2020 2020 2020 2020 2020  ata.            
+0003fa90: 7661 7269 6162 6c65 732e 0a0a 2020 2020  variables...    
+0003faa0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+0003fab0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0003fac0: 2020 2020 2020 726f 6c6c 0a0a 2020 2020        roll..    
+0003fad0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0003fae0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0003faf0: 2020 2020 2020 3e3e 3e20 6473 203d 2078        >>> ds = x
+0003fb00: 722e 4461 7461 7365 7428 7b22 666f 6f22  r.Dataset({"foo"
+0003fb10: 3a20 2822 7822 2c20 6c69 7374 2822 6162  : ("x", list("ab
+0003fb20: 6364 6522 2929 7d29 0a20 2020 2020 2020  cde"))}).       
+0003fb30: 203e 3e3e 2064 732e 7368 6966 7428 783d   >>> ds.shift(x=
+0003fb40: 3229 0a20 2020 2020 2020 203c 7861 7272  2).        <xarr
+0003fb50: 6179 2e44 6174 6173 6574 3e0a 2020 2020  ay.Dataset>.    
+0003fb60: 2020 2020 4469 6d65 6e73 696f 6e73 3a20      Dimensions: 
+0003fb70: 2028 783a 2035 290a 2020 2020 2020 2020   (x: 5).        
+0003fb80: 4469 6d65 6e73 696f 6e73 2077 6974 686f  Dimensions witho
+0003fb90: 7574 2063 6f6f 7264 696e 6174 6573 3a20  ut coordinates: 
+0003fba0: 780a 2020 2020 2020 2020 4461 7461 2076  x.        Data v
+0003fbb0: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
+0003fbc0: 2020 2020 2020 666f 6f20 2020 2020 2028        foo      (
+0003fbd0: 7829 206f 626a 6563 7420 6e61 6e20 6e61  x) object nan na
+0003fbe0: 6e20 2761 2720 2762 2720 2763 270a 2020  n 'a' 'b' 'c'.  
+0003fbf0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0003fc00: 2020 7368 6966 7473 203d 2065 6974 6865    shifts = eithe
+0003fc10: 725f 6469 6374 5f6f 725f 6b77 6172 6773  r_dict_or_kwargs
+0003fc20: 2873 6869 6674 732c 2073 6869 6674 735f  (shifts, shifts_
+0003fc30: 6b77 6172 6773 2c20 2273 6869 6674 2229  kwargs, "shift")
+0003fc40: 0a20 2020 2020 2020 2069 6e76 616c 6964  .        invalid
+0003fc50: 203d 205b 6b20 666f 7220 6b20 696e 2073   = [k for k in s
+0003fc60: 6869 6674 7320 6966 206b 206e 6f74 2069  hifts if k not i
+0003fc70: 6e20 7365 6c66 2e64 696d 735d 0a20 2020  n self.dims].   
+0003fc80: 2020 2020 2069 6620 696e 7661 6c69 643a       if invalid:
+0003fc90: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0003fca0: 7365 2056 616c 7565 4572 726f 7228 6622  se ValueError(f"
+0003fcb0: 6469 6d65 6e73 696f 6e73 207b 696e 7661  dimensions {inva
+0003fcc0: 6c69 6421 727d 2064 6f20 6e6f 7420 6578  lid!r} do not ex
+0003fcd0: 6973 7422 290a 0a20 2020 2020 2020 2076  ist")..        v
+0003fce0: 6172 6961 626c 6573 203d 207b 7d0a 2020  ariables = {}.  
+0003fcf0: 2020 2020 2020 666f 7220 6e61 6d65 2c20        for name, 
+0003fd00: 7661 7220 696e 2073 656c 662e 7661 7269  var in self.vari
+0003fd10: 6162 6c65 732e 6974 656d 7328 293a 0a20  ables.items():. 
+0003fd20: 2020 2020 2020 2020 2020 2069 6620 6e61             if na
+0003fd30: 6d65 2069 6e20 7365 6c66 2e64 6174 615f  me in self.data_
+0003fd40: 7661 7273 3a0a 2020 2020 2020 2020 2020  vars:.          
+0003fd50: 2020 2020 2020 6669 6c6c 5f76 616c 7565        fill_value
+0003fd60: 5f20 3d20 280a 2020 2020 2020 2020 2020  _ = (.          
+0003fd70: 2020 2020 2020 2020 2020 6669 6c6c 5f76            fill_v
+0003fd80: 616c 7565 2e67 6574 286e 616d 652c 2078  alue.get(name, x
+0003fd90: 7264 7479 7065 732e 4e41 290a 2020 2020  rdtypes.NA).    
+0003fda0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fdb0: 6966 2069 7369 6e73 7461 6e63 6528 6669  if isinstance(fi
+0003fdc0: 6c6c 5f76 616c 7565 2c20 6469 6374 290a  ll_value, dict).
+0003fdd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fde0: 2020 2020 656c 7365 2066 696c 6c5f 7661      else fill_va
+0003fdf0: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
+0003fe00: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
+0003fe10: 2020 2020 2020 2076 6172 5f73 6869 6674         var_shift
+0003fe20: 7320 3d20 7b6b 3a20 7620 666f 7220 6b2c  s = {k: v for k,
+0003fe30: 2076 2069 6e20 7368 6966 7473 2e69 7465   v in shifts.ite
+0003fe40: 6d73 2829 2069 6620 6b20 696e 2076 6172  ms() if k in var
+0003fe50: 2e64 696d 737d 0a20 2020 2020 2020 2020  .dims}.         
+0003fe60: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+0003fe70: 5b6e 616d 655d 203d 2076 6172 2e73 6869  [name] = var.shi
+0003fe80: 6674 2866 696c 6c5f 7661 6c75 653d 6669  ft(fill_value=fi
+0003fe90: 6c6c 5f76 616c 7565 5f2c 2073 6869 6674  ll_value_, shift
+0003fea0: 733d 7661 725f 7368 6966 7473 290a 2020  s=var_shifts).  
+0003feb0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+0003fec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0003fed0: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
+0003fee0: 3d20 7661 720a 0a20 2020 2020 2020 2072  = var..        r
+0003fef0: 6574 7572 6e20 7365 6c66 2e5f 7265 706c  eturn self._repl
+0003ff00: 6163 6528 7661 7269 6162 6c65 7329 0a0a  ace(variables)..
+0003ff10: 2020 2020 6465 6620 726f 6c6c 280a 2020      def roll(.  
+0003ff20: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
+0003ff30: 7461 7365 742c 0a20 2020 2020 2020 2073  taset,.        s
+0003ff40: 6869 6674 733a 204d 6170 7069 6e67 5b41  hifts: Mapping[A
+0003ff50: 6e79 2c20 696e 745d 207c 204e 6f6e 6520  ny, int] | None 
+0003ff60: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+0003ff70: 726f 6c6c 5f63 6f6f 7264 733a 2062 6f6f  roll_coords: boo
+0003ff80: 6c20 3d20 4661 6c73 652c 0a20 2020 2020  l = False,.     
+0003ff90: 2020 202a 2a73 6869 6674 735f 6b77 6172     **shifts_kwar
+0003ffa0: 6773 3a20 696e 742c 0a20 2020 2029 202d  gs: int,.    ) -
+0003ffb0: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
+0003ffc0: 2020 2020 2022 2222 526f 6c6c 2074 6869       """Roll thi
+0003ffd0: 7320 6461 7461 7365 7420 6279 2061 6e20  s dataset by an 
+0003ffe0: 6f66 6673 6574 2061 6c6f 6e67 206f 6e65  offset along one
+0003fff0: 206f 7220 6d6f 7265 2064 696d 656e 7369   or more dimensi
+00040000: 6f6e 732e 0a0a 2020 2020 2020 2020 556e  ons...        Un
+00040010: 6c69 6b65 2073 6869 6674 2c20 726f 6c6c  like shift, roll
+00040020: 2074 7265 6174 7320 7468 6520 6769 7665   treats the give
+00040030: 6e20 6469 6d65 6e73 696f 6e73 2061 7320  n dimensions as 
+00040040: 7065 7269 6f64 6963 2c20 736f 2077 696c  periodic, so wil
+00040050: 6c20 6e6f 740a 2020 2020 2020 2020 6372  l not.        cr
+00040060: 6561 7465 2061 6e79 206d 6973 7369 6e67  eate any missing
+00040070: 2076 616c 7565 7320 746f 2062 6520 6669   values to be fi
+00040080: 6c6c 6564 2e0a 0a20 2020 2020 2020 2041  lled...        A
+00040090: 6c73 6f20 756e 6c69 6b65 2073 6869 6674  lso unlike shift
+000400a0: 2c20 726f 6c6c 206d 6179 2072 6f74 6174  , roll may rotat
+000400b0: 6520 616c 6c20 7661 7269 6162 6c65 732c  e all variables,
+000400c0: 2069 6e63 6c75 6469 6e67 2063 6f6f 7264   including coord
+000400d0: 696e 6174 6573 0a20 2020 2020 2020 2069  inates.        i
+000400e0: 6620 7370 6563 6966 6965 642e 2054 6865  f specified. The
+000400f0: 2064 6972 6563 7469 6f6e 206f 6620 726f   direction of ro
+00040100: 7461 7469 6f6e 2069 7320 636f 6e73 6973  tation is consis
+00040110: 7465 6e74 2077 6974 680a 2020 2020 2020  tent with.      
+00040120: 2020 3a70 793a 6675 6e63 3a60 6e75 6d70    :py:func:`nump
+00040130: 792e 726f 6c6c 602e 0a0a 2020 2020 2020  y.roll`...      
+00040140: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00040150: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00040160: 2020 2020 2020 2020 7368 6966 7473 203a          shifts :
+00040170: 206d 6170 7069 6e67 206f 6620 6861 7368   mapping of hash
+00040180: 6162 6c65 2074 6f20 696e 742c 206f 7074  able to int, opt
+00040190: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+000401a0: 2020 4120 6469 6374 2077 6974 6820 6b65    A dict with ke
+000401b0: 7973 206d 6174 6368 696e 6720 6469 6d65  ys matching dime
+000401c0: 6e73 696f 6e73 2061 6e64 2076 616c 7565  nsions and value
+000401d0: 7320 6769 7665 6e0a 2020 2020 2020 2020  s given.        
+000401e0: 2020 2020 6279 2069 6e74 6567 6572 7320      by integers 
+000401f0: 746f 2072 6f74 6174 6520 6561 6368 206f  to rotate each o
+00040200: 6620 7468 6520 6769 7665 6e20 6469 6d65  f the given dime
+00040210: 6e73 696f 6e73 2e20 506f 7369 7469 7665  nsions. Positive
+00040220: 0a20 2020 2020 2020 2020 2020 206f 6666  .            off
+00040230: 7365 7473 2072 6f6c 6c20 746f 2074 6865  sets roll to the
+00040240: 2072 6967 6874 3b20 6e65 6761 7469 7665   right; negative
+00040250: 206f 6666 7365 7473 2072 6f6c 6c20 746f   offsets roll to
+00040260: 2074 6865 206c 6566 742e 0a20 2020 2020   the left..     
+00040270: 2020 2072 6f6c 6c5f 636f 6f72 6473 203a     roll_coords :
+00040280: 2062 6f6f 6c2c 2064 6566 6175 6c74 3a20   bool, default: 
+00040290: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
+000402a0: 2020 496e 6469 6361 7465 7320 7768 6574    Indicates whet
+000402b0: 6865 7220 746f 2072 6f6c 6c20 7468 6520  her to roll the 
+000402c0: 636f 6f72 6469 6e61 7465 7320 6279 2074  coordinates by t
+000402d0: 6865 206f 6666 7365 7420 746f 6f2e 0a20  he offset too.. 
+000402e0: 2020 2020 2020 202a 2a73 6869 6674 735f         **shifts_
+000402f0: 6b77 6172 6773 203a 207b 6469 6d3a 206f  kwargs : {dim: o
+00040300: 6666 7365 742c 202e 2e2e 7d2c 206f 7074  ffset, ...}, opt
+00040310: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00040320: 2020 5468 6520 6b65 7977 6f72 6420 6172    The keyword ar
+00040330: 6775 6d65 6e74 7320 666f 726d 206f 6620  guments form of 
+00040340: 6060 7368 6966 7473 6060 2e0a 2020 2020  ``shifts``..    
+00040350: 2020 2020 2020 2020 4f6e 6520 6f66 2073          One of s
+00040360: 6869 6674 7320 6f72 2073 6869 6674 735f  hifts or shifts_
+00040370: 6b77 6172 6773 206d 7573 7420 6265 2070  kwargs must be p
+00040380: 726f 7669 6465 642e 0a0a 2020 2020 2020  rovided...      
+00040390: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+000403a0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+000403b0: 2020 726f 6c6c 6564 203a 2044 6174 6173    rolled : Datas
+000403c0: 6574 0a20 2020 2020 2020 2020 2020 2044  et.            D
+000403d0: 6174 6173 6574 2077 6974 6820 7468 6520  ataset with the 
+000403e0: 7361 6d65 2061 7474 7269 6275 7465 7320  same attributes 
+000403f0: 6275 7420 726f 6c6c 6564 2064 6174 6120  but rolled data 
+00040400: 616e 6420 636f 6f72 6469 6e61 7465 732e  and coordinates.
+00040410: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
+00040420: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
+00040430: 2d2d 2d0a 2020 2020 2020 2020 7368 6966  ---.        shif
+00040440: 740a 0a20 2020 2020 2020 2045 7861 6d70  t..        Examp
+00040450: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
+00040460: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
+00040470: 2064 7320 3d20 7872 2e44 6174 6173 6574   ds = xr.Dataset
+00040480: 287b 2266 6f6f 223a 2028 2278 222c 206c  ({"foo": ("x", l
+00040490: 6973 7428 2261 6263 6465 2229 297d 2c20  ist("abcde"))}, 
+000404a0: 636f 6f72 6473 3d7b 2278 223a 206e 702e  coords={"x": np.
+000404b0: 6172 616e 6765 2835 297d 290a 2020 2020  arange(5)}).    
+000404c0: 2020 2020 3e3e 3e20 6473 2e72 6f6c 6c28      >>> ds.roll(
+000404d0: 783d 3229 0a20 2020 2020 2020 203c 7861  x=2).        <xa
+000404e0: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
+000404f0: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
+00040500: 3a20 2028 783a 2035 290a 2020 2020 2020  :  (x: 5).      
+00040510: 2020 436f 6f72 6469 6e61 7465 733a 0a20    Coordinates:. 
+00040520: 2020 2020 2020 2020 202a 2078 2020 2020           * x    
+00040530: 2020 2020 2878 2920 696e 7436 3420 3020      (x) int64 0 
+00040540: 3120 3220 3320 340a 2020 2020 2020 2020  1 2 3 4.        
+00040550: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
+00040560: 2020 2020 2020 2020 2020 2020 666f 6f20              foo 
+00040570: 2020 2020 2028 7829 203c 5531 2027 6427       (x) <U1 'd'
+00040580: 2027 6527 2027 6127 2027 6227 2027 6327   'e' 'a' 'b' 'c'
+00040590: 0a0a 2020 2020 2020 2020 3e3e 3e20 6473  ..        >>> ds
+000405a0: 2e72 6f6c 6c28 783d 322c 2072 6f6c 6c5f  .roll(x=2, roll_
+000405b0: 636f 6f72 6473 3d54 7275 6529 0a20 2020  coords=True).   
+000405c0: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
+000405d0: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
+000405e0: 6d65 6e73 696f 6e73 3a20 2028 783a 2035  mensions:  (x: 5
+000405f0: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
+00040600: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
+00040610: 202a 2078 2020 2020 2020 2020 2878 2920   * x        (x) 
+00040620: 696e 7436 3420 3320 3420 3020 3120 320a  int64 3 4 0 1 2.
+00040630: 2020 2020 2020 2020 4461 7461 2076 6172          Data var
+00040640: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
+00040650: 2020 2020 666f 6f20 2020 2020 2028 7829      foo      (x)
+00040660: 203c 5531 2027 6427 2027 6527 2027 6127   <U1 'd' 'e' 'a'
+00040670: 2027 6227 2027 6327 0a0a 2020 2020 2020   'b' 'c'..      
+00040680: 2020 2222 220a 2020 2020 2020 2020 7368    """.        sh
+00040690: 6966 7473 203d 2065 6974 6865 725f 6469  ifts = either_di
+000406a0: 6374 5f6f 725f 6b77 6172 6773 2873 6869  ct_or_kwargs(shi
+000406b0: 6674 732c 2073 6869 6674 735f 6b77 6172  fts, shifts_kwar
+000406c0: 6773 2c20 2272 6f6c 6c22 290a 2020 2020  gs, "roll").    
+000406d0: 2020 2020 696e 7661 6c69 6420 3d20 5b6b      invalid = [k
+000406e0: 2066 6f72 206b 2069 6e20 7368 6966 7473   for k in shifts
+000406f0: 2069 6620 6b20 6e6f 7420 696e 2073 656c   if k not in sel
+00040700: 662e 6469 6d73 5d0a 2020 2020 2020 2020  f.dims].        
+00040710: 6966 2069 6e76 616c 6964 3a0a 2020 2020  if invalid:.    
+00040720: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00040730: 6c75 6545 7272 6f72 2866 2264 696d 656e  lueError(f"dimen
+00040740: 7369 6f6e 7320 7b69 6e76 616c 6964 2172  sions {invalid!r
+00040750: 7d20 646f 206e 6f74 2065 7869 7374 2229  } do not exist")
+00040760: 0a0a 2020 2020 2020 2020 756e 726f 6c6c  ..        unroll
+00040770: 6564 5f76 6172 733a 2074 7570 6c65 5b48  ed_vars: tuple[H
+00040780: 6173 6861 626c 652c 202e 2e2e 5d0a 0a20  ashable, ...].. 
+00040790: 2020 2020 2020 2069 6620 726f 6c6c 5f63         if roll_c
+000407a0: 6f6f 7264 733a 0a20 2020 2020 2020 2020  oords:.         
+000407b0: 2020 2069 6e64 6578 6573 2c20 696e 6465     indexes, inde
+000407c0: 785f 7661 7273 203d 2072 6f6c 6c5f 696e  x_vars = roll_in
+000407d0: 6465 7865 7328 7365 6c66 2e78 696e 6465  dexes(self.xinde
+000407e0: 7865 732c 2073 6869 6674 7329 0a20 2020  xes, shifts).   
+000407f0: 2020 2020 2020 2020 2075 6e72 6f6c 6c65           unrolle
+00040800: 645f 7661 7273 203d 2028 290a 2020 2020  d_vars = ().    
+00040810: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00040820: 2020 2020 2020 696e 6465 7865 7320 3d20        indexes = 
+00040830: 6469 6374 2873 656c 662e 5f69 6e64 6578  dict(self._index
+00040840: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+00040850: 696e 6465 785f 7661 7273 203d 2064 6963  index_vars = dic
+00040860: 7428 7365 6c66 2e78 696e 6465 7865 732e  t(self.xindexes.
+00040870: 7661 7269 6162 6c65 7329 0a20 2020 2020  variables).     
+00040880: 2020 2020 2020 2075 6e72 6f6c 6c65 645f         unrolled_
+00040890: 7661 7273 203d 2074 7570 6c65 2873 656c  vars = tuple(sel
+000408a0: 662e 636f 6f72 6473 290a 0a20 2020 2020  f.coords)..     
+000408b0: 2020 2076 6172 6961 626c 6573 203d 207b     variables = {
+000408c0: 7d0a 2020 2020 2020 2020 666f 7220 6b2c  }.        for k,
+000408d0: 2076 6172 2069 6e20 7365 6c66 2e76 6172   var in self.var
+000408e0: 6961 626c 6573 2e69 7465 6d73 2829 3a0a  iables.items():.
+000408f0: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+00040900: 2069 6e20 696e 6465 785f 7661 7273 3a0a   in index_vars:.
+00040910: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00040920: 7661 7269 6162 6c65 735b 6b5d 203d 2069  variables[k] = i
+00040930: 6e64 6578 5f76 6172 735b 6b5d 0a20 2020  ndex_vars[k].   
+00040940: 2020 2020 2020 2020 2065 6c69 6620 6b20           elif k 
+00040950: 6e6f 7420 696e 2075 6e72 6f6c 6c65 645f  not in unrolled_
+00040960: 7661 7273 3a0a 2020 2020 2020 2020 2020  vars:.          
+00040970: 2020 2020 2020 7661 7269 6162 6c65 735b        variables[
+00040980: 6b5d 203d 2076 6172 2e72 6f6c 6c28 0a20  k] = var.roll(. 
+00040990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000409a0: 2020 2073 6869 6674 733d 7b6b 3a20 7320     shifts={k: s 
+000409b0: 666f 7220 6b2c 2073 2069 6e20 7368 6966  for k, s in shif
+000409c0: 7473 2e69 7465 6d73 2829 2069 6620 6b20  ts.items() if k 
+000409d0: 696e 2076 6172 2e64 696d 737d 0a20 2020  in var.dims}.   
+000409e0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000409f0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00040a00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00040a10: 2076 6172 6961 626c 6573 5b6b 5d20 3d20   variables[k] = 
+00040a20: 7661 720a 0a20 2020 2020 2020 2072 6574  var..        ret
+00040a30: 7572 6e20 7365 6c66 2e5f 7265 706c 6163  urn self._replac
+00040a40: 6528 7661 7269 6162 6c65 732c 2069 6e64  e(variables, ind
+00040a50: 6578 6573 3d69 6e64 6578 6573 290a 0a20  exes=indexes).. 
+00040a60: 2020 2064 6566 2073 6f72 7462 7928 0a20     def sortby(. 
+00040a70: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
+00040a80: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
+00040a90: 7661 7269 6162 6c65 733a 2048 6173 6861  variables: Hasha
+00040aa0: 626c 6520 7c20 4461 7461 4172 7261 7920  ble | DataArray 
+00040ab0: 7c20 6c69 7374 5b48 6173 6861 626c 6520  | list[Hashable 
+00040ac0: 7c20 4461 7461 4172 7261 795d 2c0a 2020  | DataArray],.  
+00040ad0: 2020 2020 2020 6173 6365 6e64 696e 673a        ascending:
+00040ae0: 2062 6f6f 6c20 3d20 5472 7565 2c0a 2020   bool = True,.  
+00040af0: 2020 2920 2d3e 2054 5f44 6174 6173 6574    ) -> T_Dataset
+00040b00: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00040b10: 2020 2020 2020 536f 7274 206f 626a 6563        Sort objec
+00040b20: 7420 6279 206c 6162 656c 7320 6f72 2076  t by labels or v
+00040b30: 616c 7565 7320 2861 6c6f 6e67 2061 6e20  alues (along an 
+00040b40: 6178 6973 292e 0a0a 2020 2020 2020 2020  axis)...        
+00040b50: 536f 7274 7320 7468 6520 6461 7461 7365  Sorts the datase
+00040b60: 742c 2065 6974 6865 7220 616c 6f6e 6720  t, either along 
+00040b70: 7370 6563 6966 6965 6420 6469 6d65 6e73  specified dimens
+00040b80: 696f 6e73 2c0a 2020 2020 2020 2020 6f72  ions,.        or
+00040b90: 2061 6363 6f72 6469 6e67 2074 6f20 7661   according to va
+00040ba0: 6c75 6573 206f 6620 312d 4420 6461 7461  lues of 1-D data
+00040bb0: 6172 7261 7973 2074 6861 7420 7368 6172  arrays that shar
+00040bc0: 6520 6469 6d65 6e73 696f 6e0a 2020 2020  e dimension.    
+00040bd0: 2020 2020 7769 7468 2063 616c 6c69 6e67      with calling
+00040be0: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
+00040bf0: 2020 4966 2074 6865 2069 6e70 7574 2076    If the input v
+00040c00: 6172 6961 626c 6573 2061 7265 2064 6174  ariables are dat
+00040c10: 6161 7272 6179 732c 2074 6865 6e20 7468  aarrays, then th
+00040c20: 6520 6461 7461 6172 7261 7973 2061 7265  e dataarrays are
+00040c30: 2061 6c69 676e 6564 0a20 2020 2020 2020   aligned.       
+00040c40: 2028 7669 6120 6c65 6674 2d6a 6f69 6e29   (via left-join)
+00040c50: 2074 6f20 7468 6520 6361 6c6c 696e 6720   to the calling 
+00040c60: 6f62 6a65 6374 2070 7269 6f72 2074 6f20  object prior to 
+00040c70: 736f 7274 696e 6720 6279 2063 656c 6c20  sorting by cell 
+00040c80: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
+00040c90: 4e61 4e73 2061 7265 2073 6f72 7465 6420  NaNs are sorted 
+00040ca0: 746f 2074 6865 2065 6e64 2c20 666f 6c6c  to the end, foll
+00040cb0: 6f77 696e 6720 4e75 6d70 7920 636f 6e76  owing Numpy conv
+00040cc0: 656e 7469 6f6e 2e0a 0a20 2020 2020 2020  ention...       
+00040cd0: 2049 6620 6d75 6c74 6970 6c65 2073 6f72   If multiple sor
+00040ce0: 7473 2061 6c6f 6e67 2074 6865 2073 616d  ts along the sam
+00040cf0: 6520 6469 6d65 6e73 696f 6e20 6973 0a20  e dimension is. 
+00040d00: 2020 2020 2020 2067 6976 656e 2c20 6e75         given, nu
+00040d10: 6d70 7927 7320 6c65 7873 6f72 7420 6973  mpy's lexsort is
+00040d20: 2070 6572 666f 726d 6564 2061 6c6f 6e67   performed along
+00040d30: 2074 6861 7420 6469 6d65 6e73 696f 6e3a   that dimension:
+00040d40: 0a20 2020 2020 2020 2068 7474 7073 3a2f  .        https:/
+00040d50: 2f6e 756d 7079 2e6f 7267 2f64 6f63 2f73  /numpy.org/doc/s
+00040d60: 7461 626c 652f 7265 6665 7265 6e63 652f  table/reference/
+00040d70: 6765 6e65 7261 7465 642f 6e75 6d70 792e  generated/numpy.
+00040d80: 6c65 7873 6f72 742e 6874 6d6c 0a20 2020  lexsort.html.   
+00040d90: 2020 2020 2061 6e64 2074 6865 2046 4952       and the FIR
+00040da0: 5354 206b 6579 2069 6e20 7468 6520 7365  ST key in the se
+00040db0: 7175 656e 6365 2069 7320 7573 6564 2061  quence is used a
+00040dc0: 7320 7468 6520 7072 696d 6172 7920 736f  s the primary so
+00040dd0: 7274 206b 6579 2c0a 2020 2020 2020 2020  rt key,.        
+00040de0: 666f 6c6c 6f77 6564 2062 7920 7468 6520  followed by the 
+00040df0: 326e 6420 6b65 792c 2065 7463 2e0a 0a20  2nd key, etc... 
+00040e00: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00040e10: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00040e20: 2d2d 2d2d 0a20 2020 2020 2020 2076 6172  ----.        var
+00040e30: 6961 626c 6573 203a 2048 6173 6861 626c  iables : Hashabl
+00040e40: 652c 2044 6174 6141 7272 6179 2c20 6f72  e, DataArray, or
+00040e50: 206c 6973 7420 6f66 2068 6173 6861 626c   list of hashabl
+00040e60: 6520 6f72 2044 6174 6141 7272 6179 0a20  e or DataArray. 
+00040e70: 2020 2020 2020 2020 2020 2031 4420 4461             1D Da
+00040e80: 7461 4172 7261 7920 6f62 6a65 6374 7320  taArray objects 
+00040e90: 6f72 206e 616d 6528 7329 206f 6620 3144  or name(s) of 1D
+00040ea0: 2076 6172 6961 626c 6528 7329 2069 6e0a   variable(s) in.
+00040eb0: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
+00040ec0: 6473 2f64 6174 615f 7661 7273 2077 686f  ds/data_vars who
+00040ed0: 7365 2076 616c 7565 7320 6172 6520 7573  se values are us
+00040ee0: 6564 2074 6f20 736f 7274 2074 6865 2064  ed to sort the d
+00040ef0: 6174 6173 6574 2e0a 2020 2020 2020 2020  ataset..        
+00040f00: 6173 6365 6e64 696e 6720 3a20 626f 6f6c  ascending : bool
+00040f10: 2c20 6465 6661 756c 743a 2054 7275 650a  , default: True.
+00040f20: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
+00040f30: 6865 7220 746f 2073 6f72 7420 6279 2061  her to sort by a
+00040f40: 7363 656e 6469 6e67 206f 7220 6465 7363  scending or desc
+00040f50: 656e 6469 6e67 206f 7264 6572 2e0a 0a20  ending order... 
+00040f60: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+00040f70: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+00040f80: 2020 2020 2020 2073 6f72 7465 6420 3a20         sorted : 
+00040f90: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
+00040fa0: 2020 2020 4120 6e65 7720 6461 7461 7365      A new datase
+00040fb0: 7420 7768 6572 6520 616c 6c20 7468 6520  t where all the 
+00040fc0: 7370 6563 6966 6965 6420 6469 6d73 2061  specified dims a
+00040fd0: 7265 2073 6f72 7465 6420 6279 2064 696d  re sorted by dim
+00040fe0: 0a20 2020 2020 2020 2020 2020 206c 6162  .            lab
+00040ff0: 656c 732e 0a0a 2020 2020 2020 2020 5365  els...        Se
+00041000: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
+00041010: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00041020: 4461 7461 4172 7261 792e 736f 7274 6279  DataArray.sortby
+00041030: 0a20 2020 2020 2020 206e 756d 7079 2e73  .        numpy.s
+00041040: 6f72 740a 2020 2020 2020 2020 7061 6e64  ort.        pand
+00041050: 6173 2e73 6f72 745f 7661 6c75 6573 0a20  as.sort_values. 
+00041060: 2020 2020 2020 2070 616e 6461 732e 736f         pandas.so
+00041070: 7274 5f69 6e64 6578 0a0a 2020 2020 2020  rt_index..      
+00041080: 2020 4578 616d 706c 6573 0a20 2020 2020    Examples.     
+00041090: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+000410a0: 2020 2020 3e3e 3e20 6473 203d 2078 722e      >>> ds = xr.
+000410b0: 4461 7461 7365 7428 0a20 2020 2020 2020  Dataset(.       
+000410c0: 202e 2e2e 2020 2020 207b 0a20 2020 2020   ...     {.     
+000410d0: 2020 202e 2e2e 2020 2020 2020 2020 2022     ...         "
+000410e0: 4122 3a20 2828 2278 222c 2022 7922 292c  A": (("x", "y"),
+000410f0: 205b 5b31 2c20 325d 2c20 5b33 2c20 345d   [[1, 2], [3, 4]
+00041100: 5d29 2c0a 2020 2020 2020 2020 2e2e 2e20  ]),.        ... 
+00041110: 2020 2020 2020 2020 2242 223a 2028 2822          "B": (("
+00041120: 7822 2c20 2279 2229 2c20 5b5b 352c 2036  x", "y"), [[5, 6
+00041130: 5d2c 205b 372c 2038 5d5d 292c 0a20 2020  ], [7, 8]]),.   
+00041140: 2020 2020 202e 2e2e 2020 2020 207d 2c0a       ...     },.
+00041150: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00041160: 636f 6f72 6473 3d7b 2278 223a 205b 2262  coords={"x": ["b
+00041170: 222c 2022 6122 5d2c 2022 7922 3a20 5b31  ", "a"], "y": [1
+00041180: 2c20 305d 7d2c 0a20 2020 2020 2020 202e  , 0]},.        .
+00041190: 2e2e 2029 0a20 2020 2020 2020 203e 3e3e  .. ).        >>>
+000411a0: 2064 7320 3d20 6473 2e73 6f72 7462 7928   ds = ds.sortby(
+000411b0: 2278 2229 0a20 2020 2020 2020 203e 3e3e  "x").        >>>
+000411c0: 2064 730a 2020 2020 2020 2020 3c78 6172   ds.        <xar
+000411d0: 7261 792e 4461 7461 7365 743e 0a20 2020  ray.Dataset>.   
+000411e0: 2020 2020 2044 696d 656e 7369 6f6e 733a       Dimensions:
+000411f0: 2020 2878 3a20 322c 2079 3a20 3229 0a20    (x: 2, y: 2). 
+00041200: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
+00041210: 6573 3a0a 2020 2020 2020 2020 2020 2a20  es:.          * 
+00041220: 7820 2020 2020 2020 2028 7829 203c 5531  x        (x) <U1
+00041230: 2027 6127 2027 6227 0a20 2020 2020 2020   'a' 'b'.       
+00041240: 2020 202a 2079 2020 2020 2020 2020 2879     * y        (y
+00041250: 2920 696e 7436 3420 3120 300a 2020 2020  ) int64 1 0.    
+00041260: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
+00041270: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00041280: 4120 2020 2020 2020 2028 782c 2079 2920  A        (x, y) 
+00041290: 696e 7436 3420 3320 3420 3120 320a 2020  int64 3 4 1 2.  
+000412a0: 2020 2020 2020 2020 2020 4220 2020 2020            B     
+000412b0: 2020 2028 782c 2079 2920 696e 7436 3420     (x, y) int64 
+000412c0: 3720 3820 3520 360a 2020 2020 2020 2020  7 8 5 6.        
+000412d0: 2222 220a 2020 2020 2020 2020 6672 6f6d  """.        from
+000412e0: 2078 6172 7261 792e 636f 7265 2e64 6174   xarray.core.dat
+000412f0: 6161 7272 6179 2069 6d70 6f72 7420 4461  aarray import Da
+00041300: 7461 4172 7261 790a 0a20 2020 2020 2020  taArray..       
+00041310: 2069 6620 6e6f 7420 6973 696e 7374 616e   if not isinstan
+00041320: 6365 2876 6172 6961 626c 6573 2c20 6c69  ce(variables, li
+00041330: 7374 293a 0a20 2020 2020 2020 2020 2020  st):.           
+00041340: 2076 6172 6961 626c 6573 203d 205b 7661   variables = [va
+00041350: 7269 6162 6c65 735d 0a20 2020 2020 2020  riables].       
+00041360: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00041370: 2020 2076 6172 6961 626c 6573 203d 2076     variables = v
+00041380: 6172 6961 626c 6573 0a20 2020 2020 2020  ariables.       
+00041390: 2061 7272 6179 7320 3d20 5b76 2069 6620   arrays = [v if 
+000413a0: 6973 696e 7374 616e 6365 2876 2c20 4461  isinstance(v, Da
+000413b0: 7461 4172 7261 7929 2065 6c73 6520 7365  taArray) else se
+000413c0: 6c66 5b76 5d20 666f 7220 7620 696e 2076  lf[v] for v in v
+000413d0: 6172 6961 626c 6573 5d0a 2020 2020 2020  ariables].      
+000413e0: 2020 616c 6967 6e65 645f 7661 7273 203d    aligned_vars =
+000413f0: 2061 6c69 676e 2873 656c 662c 202a 6172   align(self, *ar
+00041400: 7261 7973 2c20 6a6f 696e 3d22 6c65 6674  rays, join="left
+00041410: 2229 2020 2320 7479 7065 3a20 6967 6e6f  ")  # type: igno
+00041420: 7265 5b74 7970 652d 7661 725d 0a20 2020  re[type-var].   
+00041430: 2020 2020 2061 6c69 676e 6564 5f73 656c       aligned_sel
+00041440: 663a 2054 5f44 6174 6173 6574 203d 2061  f: T_Dataset = a
+00041450: 6c69 676e 6564 5f76 6172 735b 305d 2020  ligned_vars[0]  
+00041460: 2320 7479 7065 3a20 6967 6e6f 7265 5b61  # type: ignore[a
+00041470: 7373 6967 6e6d 656e 745d 0a20 2020 2020  ssignment].     
+00041480: 2020 2061 6c69 676e 6564 5f6f 7468 6572     aligned_other
+00041490: 5f76 6172 733a 2074 7570 6c65 5b44 6174  _vars: tuple[Dat
+000414a0: 6141 7272 6179 2c20 2e2e 2e5d 203d 2061  aArray, ...] = a
+000414b0: 6c69 676e 6564 5f76 6172 735b 313a 5d20  ligned_vars[1:] 
+000414c0: 2023 2074 7970 653a 2069 676e 6f72 655b   # type: ignore[
+000414d0: 6173 7369 676e 6d65 6e74 5d0a 2020 2020  assignment].    
+000414e0: 2020 2020 7661 7273 5f62 795f 6469 6d20      vars_by_dim 
+000414f0: 3d20 6465 6661 756c 7464 6963 7428 6c69  = defaultdict(li
+00041500: 7374 290a 2020 2020 2020 2020 666f 7220  st).        for 
+00041510: 6461 7461 5f61 7272 6179 2069 6e20 616c  data_array in al
+00041520: 6967 6e65 645f 6f74 6865 725f 7661 7273  igned_other_vars
+00041530: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00041540: 2064 6174 615f 6172 7261 792e 6e64 696d   data_array.ndim
+00041550: 2021 3d20 313a 0a20 2020 2020 2020 2020   != 1:.         
+00041560: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+00041570: 7565 4572 726f 7228 2249 6e70 7574 2044  ueError("Input D
+00041580: 6174 6141 7272 6179 2069 7320 6e6f 7420  ataArray is not 
+00041590: 312d 442e 2229 0a20 2020 2020 2020 2020  1-D.").         
+000415a0: 2020 2028 6b65 792c 2920 3d20 6461 7461     (key,) = data
+000415b0: 5f61 7272 6179 2e64 696d 730a 2020 2020  _array.dims.    
+000415c0: 2020 2020 2020 2020 7661 7273 5f62 795f          vars_by_
+000415d0: 6469 6d5b 6b65 795d 2e61 7070 656e 6428  dim[key].append(
+000415e0: 6461 7461 5f61 7272 6179 290a 0a20 2020  data_array)..   
+000415f0: 2020 2020 2069 6e64 6963 6573 203d 207b       indices = {
+00041600: 7d0a 2020 2020 2020 2020 666f 7220 6b65  }.        for ke
+00041610: 792c 2061 7272 6179 7320 696e 2076 6172  y, arrays in var
+00041620: 735f 6279 5f64 696d 2e69 7465 6d73 2829  s_by_dim.items()
+00041630: 3a0a 2020 2020 2020 2020 2020 2020 6f72  :.            or
+00041640: 6465 7220 3d20 6e70 2e6c 6578 736f 7274  der = np.lexsort
+00041650: 2874 7570 6c65 2872 6576 6572 7365 6428  (tuple(reversed(
+00041660: 6172 7261 7973 2929 290a 2020 2020 2020  arrays))).      
+00041670: 2020 2020 2020 696e 6469 6365 735b 6b65        indices[ke
+00041680: 795d 203d 206f 7264 6572 2069 6620 6173  y] = order if as
+00041690: 6365 6e64 696e 6720 656c 7365 206f 7264  cending else ord
+000416a0: 6572 5b3a 3a2d 315d 0a20 2020 2020 2020  er[::-1].       
+000416b0: 2072 6574 7572 6e20 616c 6967 6e65 645f   return aligned_
+000416c0: 7365 6c66 2e69 7365 6c28 696e 6469 6365  self.isel(indice
+000416d0: 7329 0a0a 2020 2020 6465 6620 7175 616e  s)..    def quan
+000416e0: 7469 6c65 280a 2020 2020 2020 2020 7365  tile(.        se
+000416f0: 6c66 3a20 545f 4461 7461 7365 742c 0a20  lf: T_Dataset,. 
+00041700: 2020 2020 2020 2071 3a20 4172 7261 794c         q: ArrayL
+00041710: 696b 652c 0a20 2020 2020 2020 2064 696d  ike,.        dim
+00041720: 3a20 4469 6d73 203d 204e 6f6e 652c 0a20  : Dims = None,. 
+00041730: 2020 2020 2020 206d 6574 686f 643a 2051         method: Q
+00041740: 7561 6e74 696c 654d 6574 686f 6473 203d  uantileMethods =
+00041750: 2022 6c69 6e65 6172 222c 0a20 2020 2020   "linear",.     
+00041760: 2020 206e 756d 6572 6963 5f6f 6e6c 793a     numeric_only:
+00041770: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+00041780: 2020 2020 2020 206b 6565 705f 6174 7472         keep_attr
+00041790: 733a 2062 6f6f 6c20 7c20 4e6f 6e65 203d  s: bool | None =
+000417a0: 204e 6f6e 652c 0a20 2020 2020 2020 2073   None,.        s
+000417b0: 6b69 706e 613a 2062 6f6f 6c20 7c20 4e6f  kipna: bool | No
+000417c0: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+000417d0: 2020 2069 6e74 6572 706f 6c61 7469 6f6e     interpolation
+000417e0: 3a20 5175 616e 7469 6c65 4d65 7468 6f64  : QuantileMethod
+000417f0: 7320 7c20 4e6f 6e65 203d 204e 6f6e 652c  s | None = None,
+00041800: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
+00041810: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+00041820: 436f 6d70 7574 6520 7468 6520 7174 6820  Compute the qth 
+00041830: 7175 616e 7469 6c65 206f 6620 7468 6520  quantile of the 
+00041840: 6461 7461 2061 6c6f 6e67 2074 6865 2073  data along the s
+00041850: 7065 6369 6669 6564 2064 696d 656e 7369  pecified dimensi
+00041860: 6f6e 2e0a 0a20 2020 2020 2020 2052 6574  on...        Ret
+00041870: 7572 6e73 2074 6865 2071 7468 2071 7561  urns the qth qua
+00041880: 6e74 696c 6573 2873 2920 6f66 2074 6865  ntiles(s) of the
+00041890: 2061 7272 6179 2065 6c65 6d65 6e74 7320   array elements 
+000418a0: 666f 7220 6561 6368 2076 6172 6961 626c  for each variabl
+000418b0: 650a 2020 2020 2020 2020 696e 2074 6865  e.        in the
+000418c0: 2044 6174 6173 6574 2e0a 0a20 2020 2020   Dataset...     
+000418d0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
+000418e0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+000418f0: 0a20 2020 2020 2020 2071 203a 2066 6c6f  .        q : flo
+00041900: 6174 206f 7220 6172 7261 792d 6c69 6b65  at or array-like
+00041910: 206f 6620 666c 6f61 740a 2020 2020 2020   of float.      
+00041920: 2020 2020 2020 5175 616e 7469 6c65 2074        Quantile t
+00041930: 6f20 636f 6d70 7574 652c 2077 6869 6368  o compute, which
+00041940: 206d 7573 7420 6265 2062 6574 7765 656e   must be between
+00041950: 2030 2061 6e64 2031 2069 6e63 6c75 7369   0 and 1 inclusi
+00041960: 7665 2e0a 2020 2020 2020 2020 6469 6d20  ve..        dim 
+00041970: 3a20 7374 7220 6f72 2049 7465 7261 626c  : str or Iterabl
+00041980: 6520 6f66 2048 6173 6861 626c 652c 206f  e of Hashable, o
+00041990: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+000419a0: 2020 2020 4469 6d65 6e73 696f 6e28 7329      Dimension(s)
+000419b0: 206f 7665 7220 7768 6963 6820 746f 2061   over which to a
+000419c0: 7070 6c79 2071 7561 6e74 696c 652e 0a20  pply quantile.. 
+000419d0: 2020 2020 2020 206d 6574 686f 6420 3a20         method : 
+000419e0: 7374 722c 2064 6566 6175 6c74 3a20 226c  str, default: "l
+000419f0: 696e 6561 7222 0a20 2020 2020 2020 2020  inear".         
+00041a00: 2020 2054 6869 7320 6f70 7469 6f6e 616c     This optional
+00041a10: 2070 6172 616d 6574 6572 2073 7065 6369   parameter speci
+00041a20: 6669 6573 2074 6865 2069 6e74 6572 706f  fies the interpo
+00041a30: 6c61 7469 6f6e 206d 6574 686f 6420 746f  lation method to
+00041a40: 2075 7365 2077 6865 6e20 7468 650a 2020   use when the.  
+00041a50: 2020 2020 2020 2020 2020 6465 7369 7265            desire
+00041a60: 6420 7175 616e 7469 6c65 206c 6965 7320  d quantile lies 
+00041a70: 6265 7477 6565 6e20 7477 6f20 6461 7461  between two data
+00041a80: 2070 6f69 6e74 732e 2054 6865 206f 7074   points. The opt
+00041a90: 696f 6e73 2073 6f72 7465 6420 6279 2074  ions sorted by t
+00041aa0: 6865 6972 2052 0a20 2020 2020 2020 2020  heir R.         
+00041ab0: 2020 2074 7970 6520 6173 2073 756d 6d61     type as summa
+00041ac0: 7269 7a65 6420 696e 2074 6865 2048 2646  rized in the H&F
+00041ad0: 2070 6170 6572 205b 315d 5f20 6172 653a   paper [1]_ are:
+00041ae0: 0a0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00041af0: 2020 312e 2022 696e 7665 7274 6564 5f63    1. "inverted_c
+00041b00: 6466 2220 282a 290a 2020 2020 2020 2020  df" (*).        
+00041b10: 2020 2020 2020 2020 322e 2022 6176 6572          2. "aver
+00041b20: 6167 6564 5f69 6e76 6572 7465 645f 6364  aged_inverted_cd
+00041b30: 6622 2028 2a29 0a20 2020 2020 2020 2020  f" (*).         
+00041b40: 2020 2020 2020 2033 2e20 2263 6c6f 7365         3. "close
+00041b50: 7374 5f6f 6273 6572 7661 7469 6f6e 2220  st_observation" 
+00041b60: 282a 290a 2020 2020 2020 2020 2020 2020  (*).            
+00041b70: 2020 2020 342e 2022 696e 7465 7270 6f6c      4. "interpol
+00041b80: 6174 6564 5f69 6e76 6572 7465 645f 6364  ated_inverted_cd
+00041b90: 6622 2028 2a29 0a20 2020 2020 2020 2020  f" (*).         
+00041ba0: 2020 2020 2020 2035 2e20 2268 617a 656e         5. "hazen
+00041bb0: 2220 282a 290a 2020 2020 2020 2020 2020  " (*).          
+00041bc0: 2020 2020 2020 362e 2022 7765 6962 756c        6. "weibul
+00041bd0: 6c22 2028 2a29 0a20 2020 2020 2020 2020  l" (*).         
+00041be0: 2020 2020 2020 2037 2e20 226c 696e 6561         7. "linea
+00041bf0: 7222 2020 2864 6566 6175 6c74 290a 2020  r"  (default).  
+00041c00: 2020 2020 2020 2020 2020 2020 2020 382e                8.
+00041c10: 2022 6d65 6469 616e 5f75 6e62 6961 7365   "median_unbiase
+00041c20: 6422 2028 2a29 0a20 2020 2020 2020 2020  d" (*).         
+00041c30: 2020 2020 2020 2039 2e20 226e 6f72 6d61         9. "norma
+00041c40: 6c5f 756e 6269 6173 6564 2220 282a 290a  l_unbiased" (*).
+00041c50: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+00041c60: 2066 6972 7374 2074 6872 6565 206d 6574   first three met
+00041c70: 686f 6473 2061 7265 2064 6973 636f 6e74  hods are discont
+00041c80: 6975 6f75 732e 2020 5468 6520 666f 6c6c  iuous.  The foll
+00041c90: 6f77 696e 6720 6469 7363 6f6e 7469 6e75  owing discontinu
+00041ca0: 6f75 730a 2020 2020 2020 2020 2020 2020  ous.            
+00041cb0: 7661 7269 6174 696f 6e73 206f 6620 7468  variations of th
+00041cc0: 6520 6465 6661 756c 7420 226c 696e 6561  e default "linea
+00041cd0: 7222 2028 372e 2920 6f70 7469 6f6e 2061  r" (7.) option a
+00041ce0: 7265 2061 6c73 6f20 6176 6169 6c61 626c  re also availabl
+00041cf0: 653a 0a0a 2020 2020 2020 2020 2020 2020  e:..            
+00041d00: 2020 2020 2a20 226c 6f77 6572 220a 2020      * "lower".  
+00041d10: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
+00041d20: 2268 6967 6865 7222 0a20 2020 2020 2020  "higher".       
+00041d30: 2020 2020 2020 2020 202a 2022 6d69 6470           * "midp
+00041d40: 6f69 6e74 220a 2020 2020 2020 2020 2020  oint".          
+00041d50: 2020 2020 2020 2a20 226e 6561 7265 7374        * "nearest
+00041d60: 220a 0a20 2020 2020 2020 2020 2020 2053  "..            S
+00041d70: 6565 203a 7079 3a66 756e 633a 606e 756d  ee :py:func:`num
+00041d80: 7079 2e71 7561 6e74 696c 6560 206f 7220  py.quantile` or 
+00041d90: 5b31 5d5f 2066 6f72 2064 6574 6169 6c73  [1]_ for details
+00041da0: 2e20 5468 6520 226d 6574 686f 6422 2061  . The "method" a
+00041db0: 7267 756d 656e 740a 2020 2020 2020 2020  rgument.        
+00041dc0: 2020 2020 7761 7320 7072 6576 696f 7573      was previous
+00041dd0: 6c79 2063 616c 6c65 6420 2269 6e74 6572  ly called "inter
+00041de0: 706f 6c61 7469 6f6e 222c 2072 656e 616d  polation", renam
+00041df0: 6564 2069 6e20 6163 636f 7264 616e 6365  ed in accordance
+00041e00: 2077 6974 6820 6e75 6d70 790a 2020 2020   with numpy.    
+00041e10: 2020 2020 2020 2020 7665 7273 696f 6e20          version 
+00041e20: 312e 3232 2e30 2e0a 0a20 2020 2020 2020  1.22.0...       
+00041e30: 2020 2020 2028 2a29 2054 6865 7365 206d       (*) These m
+00041e40: 6574 686f 6473 2072 6571 7569 7265 206e  ethods require n
+00041e50: 756d 7079 2076 6572 7369 6f6e 2031 2e32  umpy version 1.2
+00041e60: 3220 6f72 206e 6577 6572 2e0a 0a20 2020  2 or newer...   
+00041e70: 2020 2020 206b 6565 705f 6174 7472 7320       keep_attrs 
+00041e80: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
+00041e90: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+00041ea0: 5472 7565 2c20 7468 6520 6461 7461 7365  True, the datase
+00041eb0: 7427 7320 6174 7472 6962 7574 6573 2028  t's attributes (
+00041ec0: 6061 7474 7273 6029 2077 696c 6c20 6265  `attrs`) will be
+00041ed0: 2063 6f70 6965 6420 6672 6f6d 0a20 2020   copied from.   
+00041ee0: 2020 2020 2020 2020 2074 6865 206f 7269           the ori
+00041ef0: 6769 6e61 6c20 6f62 6a65 6374 2074 6f20  ginal object to 
+00041f00: 7468 6520 6e65 7720 6f6e 652e 2020 4966  the new one.  If
+00041f10: 2046 616c 7365 2028 6465 6661 756c 7429   False (default)
+00041f20: 2c20 7468 6520 6e65 770a 2020 2020 2020  , the new.      
+00041f30: 2020 2020 2020 6f62 6a65 6374 2077 696c        object wil
+00041f40: 6c20 6265 2072 6574 7572 6e65 6420 7769  l be returned wi
+00041f50: 7468 6f75 7420 6174 7472 6962 7574 6573  thout attributes
+00041f60: 2e0a 2020 2020 2020 2020 6e75 6d65 7269  ..        numeri
+00041f70: 635f 6f6e 6c79 203a 2062 6f6f 6c2c 206f  c_only : bool, o
+00041f80: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00041f90: 2020 2020 4966 2054 7275 652c 206f 6e6c      If True, onl
+00041fa0: 7920 6170 706c 7920 6060 6675 6e63 6060  y apply ``func``
+00041fb0: 2074 6f20 7661 7269 6162 6c65 7320 7769   to variables wi
+00041fc0: 7468 2061 206e 756d 6572 6963 2064 7479  th a numeric dty
+00041fd0: 7065 2e0a 2020 2020 2020 2020 736b 6970  pe..        skip
+00041fe0: 6e61 203a 2062 6f6f 6c2c 206f 7074 696f  na : bool, optio
+00041ff0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+00042000: 4966 2054 7275 652c 2073 6b69 7020 6d69  If True, skip mi
+00042010: 7373 696e 6720 7661 6c75 6573 2028 6173  ssing values (as
+00042020: 206d 6172 6b65 6420 6279 204e 614e 292e   marked by NaN).
+00042030: 2042 7920 6465 6661 756c 742c 206f 6e6c   By default, onl
+00042040: 790a 2020 2020 2020 2020 2020 2020 736b  y.            sk
+00042050: 6970 7320 6d69 7373 696e 6720 7661 6c75  ips missing valu
+00042060: 6573 2066 6f72 2066 6c6f 6174 2064 7479  es for float dty
+00042070: 7065 733b 206f 7468 6572 2064 7479 7065  pes; other dtype
+00042080: 7320 6569 7468 6572 2064 6f20 6e6f 740a  s either do not.
+00042090: 2020 2020 2020 2020 2020 2020 6861 7665              have
+000420a0: 2061 2073 656e 7469 6e65 6c20 6d69 7373   a sentinel miss
+000420b0: 696e 6720 7661 6c75 6520 2869 6e74 2920  ing value (int) 
+000420c0: 6f72 2073 6b69 706e 613d 5472 7565 2068  or skipna=True h
+000420d0: 6173 206e 6f74 2062 6565 6e0a 2020 2020  as not been.    
+000420e0: 2020 2020 2020 2020 696d 706c 656d 656e          implemen
+000420f0: 7465 6420 286f 626a 6563 742c 2064 6174  ted (object, dat
+00042100: 6574 696d 6536 3420 6f72 2074 696d 6564  etime64 or timed
+00042110: 656c 7461 3634 292e 0a0a 2020 2020 2020  elta64)...      
+00042120: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+00042130: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+00042140: 2020 7175 616e 7469 6c65 7320 3a20 4461    quantiles : Da
+00042150: 7461 7365 740a 2020 2020 2020 2020 2020  taset.          
+00042160: 2020 4966 2060 7160 2069 7320 6120 7369    If `q` is a si
+00042170: 6e67 6c65 2071 7561 6e74 696c 652c 2074  ngle quantile, t
+00042180: 6865 6e20 7468 6520 7265 7375 6c74 2069  hen the result i
+00042190: 7320 6120 7363 616c 6172 2066 6f72 2065  s a scalar for e
+000421a0: 6163 680a 2020 2020 2020 2020 2020 2020  ach.            
+000421b0: 7661 7269 6162 6c65 2069 6e20 6461 7461  variable in data
+000421c0: 5f76 6172 732e 2049 6620 6d75 6c74 6970  _vars. If multip
+000421d0: 6c65 2070 6572 6365 6e74 696c 6573 2061  le percentiles a
+000421e0: 7265 2067 6976 656e 2c20 6669 7273 740a  re given, first.
+000421f0: 2020 2020 2020 2020 2020 2020 6178 6973              axis
+00042200: 206f 6620 7468 6520 7265 7375 6c74 2063   of the result c
+00042210: 6f72 7265 7370 6f6e 6473 2074 6f20 7468  orresponds to th
+00042220: 6520 7175 616e 7469 6c65 2061 6e64 2061  e quantile and a
+00042230: 2071 7561 6e74 696c 650a 2020 2020 2020   quantile.      
+00042240: 2020 2020 2020 6469 6d65 6e73 696f 6e20        dimension 
+00042250: 6973 2061 6464 6564 2074 6f20 7468 6520  is added to the 
+00042260: 7265 7475 726e 2044 6174 6173 6574 2e20  return Dataset. 
+00042270: 5468 6520 6f74 6865 7220 6469 6d65 6e73  The other dimens
+00042280: 696f 6e73 2061 7265 0a20 2020 2020 2020  ions are.       
+00042290: 2020 2020 2074 6865 2064 696d 656e 7369       the dimensi
+000422a0: 6f6e 7320 7468 6174 2072 656d 6169 6e20  ons that remain 
+000422b0: 6166 7465 7220 7468 6520 7265 6475 6374  after the reduct
+000422c0: 696f 6e20 6f66 2074 6865 2061 7272 6179  ion of the array
+000422d0: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+000422e0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+000422f0: 2d2d 2d2d 0a20 2020 2020 2020 206e 756d  ----.        num
+00042300: 7079 2e6e 616e 7175 616e 7469 6c65 2c20  py.nanquantile, 
+00042310: 6e75 6d70 792e 7175 616e 7469 6c65 2c20  numpy.quantile, 
+00042320: 7061 6e64 6173 2e53 6572 6965 732e 7175  pandas.Series.qu
+00042330: 616e 7469 6c65 2c20 4461 7461 4172 7261  antile, DataArra
+00042340: 792e 7175 616e 7469 6c65 0a0a 2020 2020  y.quantile..    
+00042350: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+00042360: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00042370: 2020 2020 2020 3e3e 3e20 6473 203d 2078        >>> ds = x
+00042380: 722e 4461 7461 7365 7428 0a20 2020 2020  r.Dataset(.     
+00042390: 2020 202e 2e2e 2020 2020 207b 2261 223a     ...     {"a":
+000423a0: 2028 2822 7822 2c20 2279 2229 2c20 5b5b   (("x", "y"), [[
+000423b0: 302e 372c 2034 2e32 2c20 392e 342c 2031  0.7, 4.2, 9.4, 1
+000423c0: 2e35 5d2c 205b 362e 352c 2037 2e33 2c20  .5], [6.5, 7.3, 
+000423d0: 322e 362c 2031 2e39 5d5d 297d 2c0a 2020  2.6, 1.9]])},.  
+000423e0: 2020 2020 2020 2e2e 2e20 2020 2020 636f        ...     co
+000423f0: 6f72 6473 3d7b 2278 223a 205b 372c 2039  ords={"x": [7, 9
+00042400: 5d2c 2022 7922 3a20 5b31 2c20 312e 352c  ], "y": [1, 1.5,
+00042410: 2032 2c20 322e 355d 7d2c 0a20 2020 2020   2, 2.5]},.     
+00042420: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
+00042430: 203e 3e3e 2064 732e 7175 616e 7469 6c65   >>> ds.quantile
+00042440: 2830 2920 2023 206f 7220 6473 2e71 7561  (0)  # or ds.qua
+00042450: 6e74 696c 6528 302c 2064 696d 3d2e 2e2e  ntile(0, dim=...
+00042460: 290a 2020 2020 2020 2020 3c78 6172 7261  ).        <xarra
+00042470: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
+00042480: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
+00042490: 2028 290a 2020 2020 2020 2020 436f 6f72   ().        Coor
+000424a0: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
+000424b0: 2020 2020 2071 7561 6e74 696c 6520 2066       quantile  f
+000424c0: 6c6f 6174 3634 2030 2e30 0a20 2020 2020  loat64 0.0.     
+000424d0: 2020 2044 6174 6120 7661 7269 6162 6c65     Data variable
+000424e0: 733a 0a20 2020 2020 2020 2020 2020 2061  s:.            a
+000424f0: 2020 2020 2020 2020 2066 6c6f 6174 3634           float64
+00042500: 2030 2e37 0a20 2020 2020 2020 203e 3e3e   0.7.        >>>
+00042510: 2064 732e 7175 616e 7469 6c65 2830 2c20   ds.quantile(0, 
+00042520: 6469 6d3d 2278 2229 0a20 2020 2020 2020  dim="x").       
+00042530: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+00042540: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
+00042550: 696f 6e73 3a20 2020 2879 3a20 3429 0a20  ions:   (y: 4). 
+00042560: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
+00042570: 6573 3a0a 2020 2020 2020 2020 2020 2a20  es:.          * 
+00042580: 7920 2020 2020 2020 2020 2879 2920 666c  y         (y) fl
+00042590: 6f61 7436 3420 312e 3020 312e 3520 322e  oat64 1.0 1.5 2.
+000425a0: 3020 322e 350a 2020 2020 2020 2020 2020  0 2.5.          
+000425b0: 2020 7175 616e 7469 6c65 2020 666c 6f61    quantile  floa
+000425c0: 7436 3420 302e 300a 2020 2020 2020 2020  t64 0.0.        
+000425d0: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
+000425e0: 2020 2020 2020 2020 2020 2020 6120 2020              a   
+000425f0: 2020 2020 2020 2879 2920 666c 6f61 7436        (y) float6
+00042600: 3420 302e 3720 342e 3220 322e 3620 312e  4 0.7 4.2 2.6 1.
+00042610: 350a 2020 2020 2020 2020 3e3e 3e20 6473  5.        >>> ds
+00042620: 2e71 7561 6e74 696c 6528 5b30 2c20 302e  .quantile([0, 0.
+00042630: 352c 2031 5d29 0a20 2020 2020 2020 203c  5, 1]).        <
+00042640: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
+00042650: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+00042660: 6e73 3a20 2020 2871 7561 6e74 696c 653a  ns:   (quantile:
+00042670: 2033 290a 2020 2020 2020 2020 436f 6f72   3).        Coor
+00042680: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
+00042690: 2020 202a 2071 7561 6e74 696c 6520 2028     * quantile  (
+000426a0: 7175 616e 7469 6c65 2920 666c 6f61 7436  quantile) float6
+000426b0: 3420 302e 3020 302e 3520 312e 300a 2020  4 0.0 0.5 1.0.  
+000426c0: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
+000426d0: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
+000426e0: 2020 6120 2020 2020 2020 2020 2871 7561    a         (qua
+000426f0: 6e74 696c 6529 2066 6c6f 6174 3634 2030  ntile) float64 0
+00042700: 2e37 2033 2e34 2039 2e34 0a20 2020 2020  .7 3.4 9.4.     
+00042710: 2020 203e 3e3e 2064 732e 7175 616e 7469     >>> ds.quanti
+00042720: 6c65 285b 302c 2030 2e35 2c20 315d 2c20  le([0, 0.5, 1], 
+00042730: 6469 6d3d 2278 2229 0a20 2020 2020 2020  dim="x").       
+00042740: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+00042750: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
+00042760: 696f 6e73 3a20 2020 2871 7561 6e74 696c  ions:   (quantil
+00042770: 653a 2033 2c20 793a 2034 290a 2020 2020  e: 3, y: 4).    
+00042780: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
+00042790: 0a20 2020 2020 2020 2020 202a 2079 2020  .          * y  
+000427a0: 2020 2020 2020 2028 7929 2066 6c6f 6174         (y) float
+000427b0: 3634 2031 2e30 2031 2e35 2032 2e30 2032  64 1.0 1.5 2.0 2
+000427c0: 2e35 0a20 2020 2020 2020 2020 202a 2071  .5.          * q
+000427d0: 7561 6e74 696c 6520 2028 7175 616e 7469  uantile  (quanti
+000427e0: 6c65 2920 666c 6f61 7436 3420 302e 3020  le) float64 0.0 
+000427f0: 302e 3520 312e 300a 2020 2020 2020 2020  0.5 1.0.        
+00042800: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
+00042810: 2020 2020 2020 2020 2020 2020 6120 2020              a   
+00042820: 2020 2020 2020 2871 7561 6e74 696c 652c        (quantile,
+00042830: 2079 2920 666c 6f61 7436 3420 302e 3720   y) float64 0.7 
+00042840: 342e 3220 322e 3620 312e 3520 332e 3620  4.2 2.6 1.5 3.6 
+00042850: 2e2e 2e20 312e 3720 362e 3520 372e 3320  ... 1.7 6.5 7.3 
+00042860: 392e 3420 312e 390a 0a20 2020 2020 2020  9.4 1.9..       
+00042870: 2052 6566 6572 656e 6365 730a 2020 2020   References.    
+00042880: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
+00042890: 2020 2020 2020 202e 2e20 5b31 5d20 522e         .. [1] R.
+000428a0: 204a 2e20 4879 6e64 6d61 6e20 616e 6420   J. Hyndman and 
+000428b0: 592e 2046 616e 2c0a 2020 2020 2020 2020  Y. Fan,.        
+000428c0: 2020 2022 5361 6d70 6c65 2071 7561 6e74     "Sample quant
+000428d0: 696c 6573 2069 6e20 7374 6174 6973 7469  iles in statisti
+000428e0: 6361 6c20 7061 636b 6167 6573 2c22 0a20  cal packages,". 
+000428f0: 2020 2020 2020 2020 2020 5468 6520 416d            The Am
+00042900: 6572 6963 616e 2053 7461 7469 7374 6963  erican Statistic
+00042910: 6961 6e2c 2035 3028 3429 2c20 7070 2e20  ian, 50(4), pp. 
+00042920: 3336 312d 3336 352c 2031 3939 360a 2020  361-365, 1996.  
+00042930: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
+00042940: 2020 2023 2069 6e74 6572 706f 6c61 7469     # interpolati
+00042950: 6f6e 2072 656e 616d 6564 2074 6f20 6d65  on renamed to me
+00042960: 7468 6f64 2069 6e20 7665 7273 696f 6e20  thod in version 
+00042970: 302e 3231 2e30 0a20 2020 2020 2020 2023  0.21.0.        #
+00042980: 2063 6865 636b 2068 6572 6520 616e 6420   check here and 
+00042990: 696e 2076 6172 6961 626c 6520 746f 2061  in variable to a
+000429a0: 766f 6964 2072 6570 6561 7465 6420 7761  void repeated wa
+000429b0: 726e 696e 6773 0a20 2020 2020 2020 2069  rnings.        i
+000429c0: 6620 696e 7465 7270 6f6c 6174 696f 6e20  f interpolation 
+000429d0: 6973 206e 6f74 204e 6f6e 653a 0a20 2020  is not None:.   
+000429e0: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+000429f0: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00042a00: 2020 2020 2020 2020 2254 6865 2060 696e          "The `in
+00042a10: 7465 7270 6f6c 6174 696f 6e60 2061 7267  terpolation` arg
+00042a20: 756d 656e 7420 746f 2071 7561 6e74 696c  ument to quantil
+00042a30: 6520 7761 7320 7265 6e61 6d65 6420 746f  e was renamed to
+00042a40: 2060 6d65 7468 6f64 602e 222c 0a20 2020   `method`.",.   
+00042a50: 2020 2020 2020 2020 2020 2020 2046 7574               Fut
+00042a60: 7572 6557 6172 6e69 6e67 2c0a 2020 2020  ureWarning,.    
+00042a70: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00042a80: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
+00042a90: 2021 3d20 226c 696e 6561 7222 3a0a 2020   != "linear":.  
+00042aa0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00042ab0: 6973 6520 5479 7065 4572 726f 7228 2243  ise TypeError("C
+00042ac0: 616e 6e6f 7420 7061 7373 2069 6e74 6572  annot pass inter
+00042ad0: 706f 6c61 7469 6f6e 2061 6e64 206d 6574  polation and met
+00042ae0: 686f 6420 6b65 7977 6f72 6473 2122 290a  hod keywords!").
+00042af0: 0a20 2020 2020 2020 2020 2020 206d 6574  .            met
+00042b00: 686f 6420 3d20 696e 7465 7270 6f6c 6174  hod = interpolat
+00042b10: 696f 6e0a 0a20 2020 2020 2020 2064 696d  ion..        dim
+00042b20: 733a 2073 6574 5b48 6173 6861 626c 655d  s: set[Hashable]
+00042b30: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00042b40: 7374 616e 6365 2864 696d 2c20 7374 7229  stance(dim, str)
+00042b50: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+00042b60: 6d73 203d 207b 6469 6d7d 0a20 2020 2020  ms = {dim}.     
+00042b70: 2020 2065 6c69 6620 6469 6d20 6973 204e     elif dim is N
+00042b80: 6f6e 6520 6f72 2064 696d 2069 7320 2e2e  one or dim is ..
+00042b90: 2e3a 0a20 2020 2020 2020 2020 2020 2064  .:.            d
+00042ba0: 696d 7320 3d20 7365 7428 7365 6c66 2e64  ims = set(self.d
+00042bb0: 696d 7329 0a20 2020 2020 2020 2065 6c73  ims).        els
+00042bc0: 653a 0a20 2020 2020 2020 2020 2020 2064  e:.            d
+00042bd0: 696d 7320 3d20 7365 7428 6469 6d29 0a0a  ims = set(dim)..
+00042be0: 2020 2020 2020 2020 5f61 7373 6572 745f          _assert_
+00042bf0: 656d 7074 7928 0a20 2020 2020 2020 2020  empty(.         
+00042c00: 2020 2074 7570 6c65 2864 2066 6f72 2064     tuple(d for d
+00042c10: 2069 6e20 6469 6d73 2069 6620 6420 6e6f   in dims if d no
+00042c20: 7420 696e 2073 656c 662e 6469 6d73 292c  t in self.dims),
+00042c30: 0a20 2020 2020 2020 2020 2020 2022 4461  .            "Da
+00042c40: 7461 7365 7420 646f 6573 206e 6f74 2063  taset does not c
+00042c50: 6f6e 7461 696e 2074 6865 2064 696d 656e  ontain the dimen
+00042c60: 7369 6f6e 733a 2025 7322 2c0a 2020 2020  sions: %s",.    
+00042c70: 2020 2020 290a 0a20 2020 2020 2020 2071      )..        q
+00042c80: 203d 206e 702e 6173 6172 7261 7928 712c   = np.asarray(q,
+00042c90: 2064 7479 7065 3d6e 702e 666c 6f61 7436   dtype=np.float6
+00042ca0: 3429 0a0a 2020 2020 2020 2020 7661 7269  4)..        vari
+00042cb0: 6162 6c65 7320 3d20 7b7d 0a20 2020 2020  ables = {}.     
+00042cc0: 2020 2066 6f72 206e 616d 652c 2076 6172     for name, var
+00042cd0: 2069 6e20 7365 6c66 2e76 6172 6961 626c   in self.variabl
+00042ce0: 6573 2e69 7465 6d73 2829 3a0a 2020 2020  es.items():.    
+00042cf0: 2020 2020 2020 2020 7265 6475 6365 5f64          reduce_d
+00042d00: 696d 7320 3d20 5b64 2066 6f72 2064 2069  ims = [d for d i
+00042d10: 6e20 7661 722e 6469 6d73 2069 6620 6420  n var.dims if d 
+00042d20: 696e 2064 696d 735d 0a20 2020 2020 2020  in dims].       
+00042d30: 2020 2020 2069 6620 7265 6475 6365 5f64       if reduce_d
+00042d40: 696d 7320 6f72 206e 6f74 2076 6172 2e64  ims or not var.d
+00042d50: 696d 733a 0a20 2020 2020 2020 2020 2020  ims:.           
+00042d60: 2020 2020 2069 6620 6e61 6d65 206e 6f74       if name not
+00042d70: 2069 6e20 7365 6c66 2e63 6f6f 7264 733a   in self.coords:
+00042d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042d90: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+00042da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042db0: 2020 6e6f 7420 6e75 6d65 7269 635f 6f6e    not numeric_on
+00042dc0: 6c79 0a20 2020 2020 2020 2020 2020 2020  ly.             
+00042dd0: 2020 2020 2020 2020 2020 206f 7220 6e70             or np
+00042de0: 2e69 7373 7562 6474 7970 6528 7661 722e  .issubdtype(var.
+00042df0: 6474 7970 652c 206e 702e 6e75 6d62 6572  dtype, np.number
+00042e00: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+00042e10: 2020 2020 2020 2020 2020 6f72 2076 6172            or var
+00042e20: 2e64 7479 7065 203d 3d20 6e70 2e62 6f6f  .dtype == np.boo
+00042e30: 6c5f 0a20 2020 2020 2020 2020 2020 2020  l_.             
+00042e40: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
+00042e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042e60: 2020 7661 7269 6162 6c65 735b 6e61 6d65    variables[name
+00042e70: 5d20 3d20 7661 722e 7175 616e 7469 6c65  ] = var.quantile
+00042e80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00042e90: 2020 2020 2020 2020 2020 2020 2020 712c                q,
+00042ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00042eb0: 2020 2020 2020 2020 2020 2020 2064 696d               dim
+00042ec0: 3d72 6564 7563 655f 6469 6d73 2c0a 2020  =reduce_dims,.  
+00042ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042ee0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
+00042ef0: 3d6d 6574 686f 642c 0a20 2020 2020 2020  =method,.       
+00042f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042f10: 2020 2020 206b 6565 705f 6174 7472 733d       keep_attrs=
+00042f20: 6b65 6570 5f61 7474 7273 2c0a 2020 2020  keep_attrs,.    
+00042f30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00042f40: 2020 2020 2020 2020 736b 6970 6e61 3d73          skipna=s
+00042f50: 6b69 706e 612c 0a20 2020 2020 2020 2020  kipna,.         
+00042f60: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00042f70: 0a0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+00042f80: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00042f90: 2020 2020 7661 7269 6162 6c65 735b 6e61      variables[na
+00042fa0: 6d65 5d20 3d20 7661 720a 0a20 2020 2020  me] = var..     
+00042fb0: 2020 2023 2063 6f6e 7374 7275 6374 2074     # construct t
+00042fc0: 6865 206e 6577 2064 6174 6173 6574 0a20  he new dataset. 
+00042fd0: 2020 2020 2020 2063 6f6f 7264 5f6e 616d         coord_nam
+00042fe0: 6573 203d 207b 6b20 666f 7220 6b20 696e  es = {k for k in
+00042ff0: 2073 656c 662e 636f 6f72 6473 2069 6620   self.coords if 
+00043000: 6b20 696e 2076 6172 6961 626c 6573 7d0a  k in variables}.
+00043010: 2020 2020 2020 2020 696e 6465 7865 7320          indexes 
+00043020: 3d20 7b6b 3a20 7620 666f 7220 6b2c 2076  = {k: v for k, v
+00043030: 2069 6e20 7365 6c66 2e5f 696e 6465 7865   in self._indexe
+00043040: 732e 6974 656d 7328 2920 6966 206b 2069  s.items() if k i
+00043050: 6e20 7661 7269 6162 6c65 737d 0a20 2020  n variables}.   
+00043060: 2020 2020 2069 6620 6b65 6570 5f61 7474       if keep_att
+00043070: 7273 2069 7320 4e6f 6e65 3a0a 2020 2020  rs is None:.    
+00043080: 2020 2020 2020 2020 6b65 6570 5f61 7474          keep_att
+00043090: 7273 203d 205f 6765 745f 6b65 6570 5f61  rs = _get_keep_a
+000430a0: 7474 7273 2864 6566 6175 6c74 3d46 616c  ttrs(default=Fal
+000430b0: 7365 290a 2020 2020 2020 2020 6174 7472  se).        attr
+000430c0: 7320 3d20 7365 6c66 2e61 7474 7273 2069  s = self.attrs i
+000430d0: 6620 6b65 6570 5f61 7474 7273 2065 6c73  f keep_attrs els
+000430e0: 6520 4e6f 6e65 0a20 2020 2020 2020 206e  e None.        n
+000430f0: 6577 203d 2073 656c 662e 5f72 6570 6c61  ew = self._repla
+00043100: 6365 5f77 6974 685f 6e65 775f 6469 6d73  ce_with_new_dims
+00043110: 280a 2020 2020 2020 2020 2020 2020 7661  (.            va
+00043120: 7269 6162 6c65 732c 2063 6f6f 7264 5f6e  riables, coord_n
+00043130: 616d 6573 3d63 6f6f 7264 5f6e 616d 6573  ames=coord_names
+00043140: 2c20 6174 7472 733d 6174 7472 732c 2069  , attrs=attrs, i
+00043150: 6e64 6578 6573 3d69 6e64 6578 6573 0a20  ndexes=indexes. 
+00043160: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00043170: 2072 6574 7572 6e20 6e65 772e 6173 7369   return new.assi
+00043180: 676e 5f63 6f6f 7264 7328 7175 616e 7469  gn_coords(quanti
+00043190: 6c65 3d71 290a 0a20 2020 2064 6566 2072  le=q)..    def r
+000431a0: 616e 6b28 0a20 2020 2020 2020 2073 656c  ank(.        sel
+000431b0: 663a 2054 5f44 6174 6173 6574 2c0a 2020  f: T_Dataset,.  
+000431c0: 2020 2020 2020 6469 6d3a 2048 6173 6861        dim: Hasha
+000431d0: 626c 652c 0a20 2020 2020 2020 2070 6374  ble,.        pct
+000431e0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
+000431f0: 2020 2020 2020 2020 6b65 6570 5f61 7474          keep_att
+00043200: 7273 3a20 626f 6f6c 207c 204e 6f6e 6520  rs: bool | None 
+00043210: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
+00043220: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
+00043230: 2020 2020 2222 2252 616e 6b73 2074 6865      """Ranks the
+00043240: 2064 6174 612e 0a0a 2020 2020 2020 2020   data...        
+00043250: 4571 7561 6c20 7661 6c75 6573 2061 7265  Equal values are
+00043260: 2061 7373 6967 6e65 6420 6120 7261 6e6b   assigned a rank
+00043270: 2074 6861 7420 6973 2074 6865 2061 7665   that is the ave
+00043280: 7261 6765 206f 6620 7468 6520 7261 6e6b  rage of the rank
+00043290: 7320 7468 6174 0a20 2020 2020 2020 2077  s that.        w
+000432a0: 6f75 6c64 2068 6176 6520 6265 656e 206f  ould have been o
+000432b0: 7468 6572 7769 7365 2061 7373 6967 6e65  therwise assigne
+000432c0: 6420 746f 2061 6c6c 206f 6620 7468 6520  d to all of the 
+000432d0: 7661 6c75 6573 2077 6974 6869 6e0a 2020  values within.  
+000432e0: 2020 2020 2020 7468 6174 2073 6574 2e0a        that set..
+000432f0: 2020 2020 2020 2020 5261 6e6b 7320 6265          Ranks be
+00043300: 6769 6e20 6174 2031 2c20 6e6f 7420 302e  gin at 1, not 0.
+00043310: 2049 6620 7063 7420 6973 2054 7275 652c   If pct is True,
+00043320: 2063 6f6d 7075 7465 7320 7065 7263 656e   computes percen
+00043330: 7461 6765 2072 616e 6b73 2e0a 0a20 2020  tage ranks...   
+00043340: 2020 2020 204e 614e 7320 696e 2074 6865       NaNs in the
+00043350: 2069 6e70 7574 2061 7272 6179 2061 7265   input array are
+00043360: 2072 6574 7572 6e65 6420 6173 204e 614e   returned as NaN
+00043370: 732e 0a0a 2020 2020 2020 2020 5468 6520  s...        The 
+00043380: 6062 6f74 746c 656e 6563 6b60 206c 6962  `bottleneck` lib
+00043390: 7261 7279 2069 7320 7265 7175 6972 6564  rary is required
+000433a0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+000433b0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+000433c0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+000433d0: 2064 696d 203a 2048 6173 6861 626c 650a   dim : Hashable.
+000433e0: 2020 2020 2020 2020 2020 2020 4469 6d65              Dime
+000433f0: 6e73 696f 6e20 6f76 6572 2077 6869 6368  nsion over which
+00043400: 2074 6f20 636f 6d70 7574 6520 7261 6e6b   to compute rank
+00043410: 2e0a 2020 2020 2020 2020 7063 7420 3a20  ..        pct : 
+00043420: 626f 6f6c 2c20 6465 6661 756c 743a 2046  bool, default: F
+00043430: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00043440: 2049 6620 5472 7565 2c20 636f 6d70 7574   If True, comput
+00043450: 6520 7065 7263 656e 7461 6765 2072 616e  e percentage ran
+00043460: 6b73 2c20 6f74 6865 7277 6973 6520 636f  ks, otherwise co
+00043470: 6d70 7574 6520 696e 7465 6765 7220 7261  mpute integer ra
+00043480: 6e6b 732e 0a20 2020 2020 2020 206b 6565  nks..        kee
+00043490: 705f 6174 7472 7320 3a20 626f 6f6c 206f  p_attrs : bool o
+000434a0: 7220 4e6f 6e65 2c20 6f70 7469 6f6e 616c  r None, optional
+000434b0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+000434c0: 5472 7565 2c20 7468 6520 6461 7461 7365  True, the datase
+000434d0: 7427 7320 6174 7472 6962 7574 6573 2028  t's attributes (
+000434e0: 6061 7474 7273 6029 2077 696c 6c20 6265  `attrs`) will be
+000434f0: 2063 6f70 6965 6420 6672 6f6d 0a20 2020   copied from.   
+00043500: 2020 2020 2020 2020 2074 6865 206f 7269           the ori
+00043510: 6769 6e61 6c20 6f62 6a65 6374 2074 6f20  ginal object to 
+00043520: 7468 6520 6e65 7720 6f6e 652e 2020 4966  the new one.  If
+00043530: 2046 616c 7365 2c20 7468 6520 6e65 770a   False, the new.
+00043540: 2020 2020 2020 2020 2020 2020 6f62 6a65              obje
+00043550: 6374 2077 696c 6c20 6265 2072 6574 7572  ct will be retur
+00043560: 6e65 6420 7769 7468 6f75 7420 6174 7472  ned without attr
+00043570: 6962 7574 6573 2e0a 0a20 2020 2020 2020  ibutes...       
+00043580: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00043590: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+000435a0: 2072 616e 6b65 6420 3a20 4461 7461 7365   ranked : Datase
+000435b0: 740a 2020 2020 2020 2020 2020 2020 5661  t.            Va
+000435c0: 7269 6162 6c65 7320 7468 6174 2064 6f20  riables that do 
+000435d0: 6e6f 7420 6465 7065 6e64 206f 6e20 6064  not depend on `d
+000435e0: 696d 6020 6172 6520 6472 6f70 7065 642e  im` are dropped.
+000435f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00043600: 2020 2020 2069 6620 6e6f 7420 4f50 5449       if not OPTI
+00043610: 4f4e 535b 2275 7365 5f62 6f74 746c 656e  ONS["use_bottlen
+00043620: 6563 6b22 5d3a 0a20 2020 2020 2020 2020  eck"]:.         
+00043630: 2020 2072 6169 7365 2052 756e 7469 6d65     raise Runtime
+00043640: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
+00043650: 2020 2020 2020 2022 7261 6e6b 2072 6571         "rank req
+00043660: 7569 7265 7320 626f 7474 6c65 6e65 636b  uires bottleneck
+00043670: 2074 6f20 6265 2065 6e61 626c 6564 2e22   to be enabled."
+00043680: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00043690: 2022 2043 616c 6c20 6078 722e 7365 745f   " Call `xr.set_
+000436a0: 6f70 7469 6f6e 7328 7573 655f 626f 7474  options(use_bott
+000436b0: 6c65 6e65 636b 3d54 7275 6529 6020 746f  leneck=True)` to
+000436c0: 2065 6e61 626c 6520 6974 2e22 0a20 2020   enable it.".   
+000436d0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+000436e0: 2020 2020 6966 2064 696d 206e 6f74 2069      if dim not i
+000436f0: 6e20 7365 6c66 2e64 696d 733a 0a20 2020  n self.dims:.   
+00043700: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+00043710: 616c 7565 4572 726f 7228 6622 4461 7461  alueError(f"Data
+00043720: 7365 7420 646f 6573 206e 6f74 2063 6f6e  set does not con
+00043730: 7461 696e 2074 6865 2064 696d 656e 7369  tain the dimensi
+00043740: 6f6e 3a20 7b64 696d 7d22 290a 0a20 2020  on: {dim}")..   
+00043750: 2020 2020 2076 6172 6961 626c 6573 203d       variables =
+00043760: 207b 7d0a 2020 2020 2020 2020 666f 7220   {}.        for 
+00043770: 6e61 6d65 2c20 7661 7220 696e 2073 656c  name, var in sel
+00043780: 662e 7661 7269 6162 6c65 732e 6974 656d  f.variables.item
+00043790: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
+000437a0: 2069 6620 6e61 6d65 2069 6e20 7365 6c66   if name in self
+000437b0: 2e64 6174 615f 7661 7273 3a0a 2020 2020  .data_vars:.    
+000437c0: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+000437d0: 696d 2069 6e20 7661 722e 6469 6d73 3a0a  im in var.dims:.
+000437e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000437f0: 2020 2020 7661 7269 6162 6c65 735b 6e61      variables[na
+00043800: 6d65 5d20 3d20 7661 722e 7261 6e6b 2864  me] = var.rank(d
+00043810: 696d 2c20 7063 743d 7063 7429 0a20 2020  im, pct=pct).   
+00043820: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+00043830: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00043840: 6172 6961 626c 6573 5b6e 616d 655d 203d  ariables[name] =
+00043850: 2076 6172 0a0a 2020 2020 2020 2020 636f   var..        co
+00043860: 6f72 645f 6e61 6d65 7320 3d20 7365 7428  ord_names = set(
+00043870: 7365 6c66 2e63 6f6f 7264 7329 0a20 2020  self.coords).   
+00043880: 2020 2020 2069 6620 6b65 6570 5f61 7474       if keep_att
+00043890: 7273 2069 7320 4e6f 6e65 3a0a 2020 2020  rs is None:.    
+000438a0: 2020 2020 2020 2020 6b65 6570 5f61 7474          keep_att
+000438b0: 7273 203d 205f 6765 745f 6b65 6570 5f61  rs = _get_keep_a
+000438c0: 7474 7273 2864 6566 6175 6c74 3d46 616c  ttrs(default=Fal
+000438d0: 7365 290a 2020 2020 2020 2020 6174 7472  se).        attr
+000438e0: 7320 3d20 7365 6c66 2e61 7474 7273 2069  s = self.attrs i
+000438f0: 6620 6b65 6570 5f61 7474 7273 2065 6c73  f keep_attrs els
+00043900: 6520 4e6f 6e65 0a20 2020 2020 2020 2072  e None.        r
+00043910: 6574 7572 6e20 7365 6c66 2e5f 7265 706c  eturn self._repl
+00043920: 6163 6528 7661 7269 6162 6c65 732c 2063  ace(variables, c
+00043930: 6f6f 7264 5f6e 616d 6573 2c20 6174 7472  oord_names, attr
+00043940: 733d 6174 7472 7329 0a0a 2020 2020 6465  s=attrs)..    de
+00043950: 6620 6469 6666 6572 656e 7469 6174 6528  f differentiate(
+00043960: 0a20 2020 2020 2020 2073 656c 663a 2054  .        self: T
+00043970: 5f44 6174 6173 6574 2c0a 2020 2020 2020  _Dataset,.      
+00043980: 2020 636f 6f72 643a 2048 6173 6861 626c    coord: Hashabl
+00043990: 652c 0a20 2020 2020 2020 2065 6467 655f  e,.        edge_
+000439a0: 6f72 6465 723a 204c 6974 6572 616c 5b31  order: Literal[1
+000439b0: 2c20 325d 203d 2031 2c0a 2020 2020 2020  , 2] = 1,.      
+000439c0: 2020 6461 7465 7469 6d65 5f75 6e69 743a    datetime_unit:
+000439d0: 2044 6174 6574 696d 6555 6e69 744f 7074   DatetimeUnitOpt
+000439e0: 696f 6e73 207c 204e 6f6e 6520 3d20 4e6f  ions | None = No
+000439f0: 6e65 2c0a 2020 2020 2920 2d3e 2054 5f44  ne,.    ) -> T_D
+00043a00: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00043a10: 2222 2220 4469 6666 6572 656e 7469 6174  """ Differentiat
+00043a20: 6520 7769 7468 2074 6865 2073 6563 6f6e  e with the secon
+00043a30: 6420 6f72 6465 7220 6163 6375 7261 7465  d order accurate
+00043a40: 2063 656e 7472 616c 0a20 2020 2020 2020   central.       
+00043a50: 2064 6966 6665 7265 6e63 6573 2e0a 0a20   differences... 
+00043a60: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+00043a70: 0a20 2020 2020 2020 2020 2020 2054 6869  .            Thi
+00043a80: 7320 6665 6174 7572 6520 6973 206c 696d  s feature is lim
+00043a90: 6974 6564 2074 6f20 7369 6d70 6c65 2063  ited to simple c
+00043aa0: 6172 7465 7369 616e 2067 656f 6d65 7472  artesian geometr
+00043ab0: 792c 2069 2e65 2e20 636f 6f72 640a 2020  y, i.e. coord.  
+00043ac0: 2020 2020 2020 2020 2020 6d75 7374 2062            must b
+00043ad0: 6520 6f6e 6520 6469 6d65 6e73 696f 6e61  e one dimensiona
+00043ae0: 6c2e 0a0a 2020 2020 2020 2020 5061 7261  l...        Para
+00043af0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+00043b00: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+00043b10: 2020 636f 6f72 6420 3a20 4861 7368 6162    coord : Hashab
+00043b20: 6c65 0a20 2020 2020 2020 2020 2020 2054  le.            T
+00043b30: 6865 2063 6f6f 7264 696e 6174 6520 746f  he coordinate to
+00043b40: 2062 6520 7573 6564 2074 6f20 636f 6d70   be used to comp
+00043b50: 7574 6520 7468 6520 6772 6164 6965 6e74  ute the gradient
+00043b60: 2e0a 2020 2020 2020 2020 6564 6765 5f6f  ..        edge_o
+00043b70: 7264 6572 203a 207b 312c 2032 7d2c 2064  rder : {1, 2}, d
+00043b80: 6566 6175 6c74 3a20 310a 2020 2020 2020  efault: 1.      
+00043b90: 2020 2020 2020 4e2d 7468 206f 7264 6572        N-th order
+00043ba0: 2061 6363 7572 6174 6520 6469 6666 6572   accurate differ
+00043bb0: 656e 6365 7320 6174 2074 6865 2062 6f75  ences at the bou
+00043bc0: 6e64 6172 6965 732e 0a20 2020 2020 2020  ndaries..       
+00043bd0: 2064 6174 6574 696d 655f 756e 6974 203a   datetime_unit :
+00043be0: 204e 6f6e 6520 6f72 207b 2259 222c 2022   None or {"Y", "
+00043bf0: 4d22 2c20 2257 222c 2022 4422 2c20 2268  M", "W", "D", "h
+00043c00: 222c 2022 6d22 2c20 2273 222c 2022 6d73  ", "m", "s", "ms
+00043c10: 222c 205c 0a20 2020 2020 2020 2020 2020  ", \.           
+00043c20: 2022 7573 222c 2022 6e73 222c 2022 7073   "us", "ns", "ps
+00043c30: 222c 2022 6673 222c 2022 6173 222c 204e  ", "fs", "as", N
+00043c40: 6f6e 657d 2c20 6465 6661 756c 743a 204e  one}, default: N
+00043c50: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00043c60: 556e 6974 2074 6f20 636f 6d70 7574 6520  Unit to compute 
+00043c70: 6772 6164 6965 6e74 2e20 4f6e 6c79 2076  gradient. Only v
+00043c80: 616c 6964 2066 6f72 2064 6174 6574 696d  alid for datetim
+00043c90: 6520 636f 6f72 6469 6e61 7465 2e0a 0a20  e coordinate... 
+00043ca0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
+00043cb0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
+00043cc0: 2020 2020 2020 2064 6966 6665 7265 6e74         different
+00043cd0: 6961 7465 643a 2044 6174 6173 6574 0a0a  iated: Dataset..
+00043ce0: 2020 2020 2020 2020 5365 6520 616c 736f          See also
+00043cf0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00043d00: 2d0a 2020 2020 2020 2020 6e75 6d70 792e  -.        numpy.
+00043d10: 6772 6164 6965 6e74 3a20 636f 7272 6573  gradient: corres
+00043d20: 706f 6e64 696e 6720 6e75 6d70 7920 6675  ponding numpy fu
+00043d30: 6e63 7469 6f6e 0a20 2020 2020 2020 2022  nction.        "
+00043d40: 2222 0a20 2020 2020 2020 2066 726f 6d20  "".        from 
+00043d50: 7861 7272 6179 2e63 6f72 652e 7661 7269  xarray.core.vari
+00043d60: 6162 6c65 2069 6d70 6f72 7420 5661 7269  able import Vari
+00043d70: 6162 6c65 0a0a 2020 2020 2020 2020 6966  able..        if
+00043d80: 2063 6f6f 7264 206e 6f74 2069 6e20 7365   coord not in se
+00043d90: 6c66 2e76 6172 6961 626c 6573 2061 6e64  lf.variables and
+00043da0: 2063 6f6f 7264 206e 6f74 2069 6e20 7365   coord not in se
+00043db0: 6c66 2e64 696d 733a 0a20 2020 2020 2020  lf.dims:.       
+00043dc0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+00043dd0: 4572 726f 7228 6622 436f 6f72 6469 6e61  Error(f"Coordina
+00043de0: 7465 207b 636f 6f72 647d 2064 6f65 7320  te {coord} does 
+00043df0: 6e6f 7420 6578 6973 742e 2229 0a0a 2020  not exist.")..  
+00043e00: 2020 2020 2020 636f 6f72 645f 7661 7220        coord_var 
+00043e10: 3d20 7365 6c66 5b63 6f6f 7264 5d2e 7661  = self[coord].va
+00043e20: 7269 6162 6c65 0a20 2020 2020 2020 2069  riable.        i
+00043e30: 6620 636f 6f72 645f 7661 722e 6e64 696d  f coord_var.ndim
+00043e40: 2021 3d20 313a 0a20 2020 2020 2020 2020   != 1:.         
+00043e50: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00043e60: 726f 7228 0a20 2020 2020 2020 2020 2020  ror(.           
+00043e70: 2020 2020 2022 436f 6f72 6469 6e61 7465       "Coordinate
+00043e80: 207b 7d20 6d75 7374 2062 6520 3120 6469   {} must be 1 di
+00043e90: 6d65 6e73 696f 6e61 6c20 6275 7420 6973  mensional but is
+00043ea0: 207b 7d22 0a20 2020 2020 2020 2020 2020   {}".           
+00043eb0: 2020 2020 2022 2064 696d 656e 7369 6f6e       " dimension
+00043ec0: 616c 222e 666f 726d 6174 2863 6f6f 7264  al".format(coord
+00043ed0: 2c20 636f 6f72 645f 7661 722e 6e64 696d  , coord_var.ndim
+00043ee0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+00043ef0: 0a20 2020 2020 2020 2064 696d 203d 2063  .        dim = c
+00043f00: 6f6f 7264 5f76 6172 2e64 696d 735b 305d  oord_var.dims[0]
+00043f10: 0a20 2020 2020 2020 2069 6620 5f63 6f6e  .        if _con
+00043f20: 7461 696e 735f 6461 7465 7469 6d65 5f6c  tains_datetime_l
+00043f30: 696b 655f 6f62 6a65 6374 7328 636f 6f72  ike_objects(coor
+00043f40: 645f 7661 7229 3a0a 2020 2020 2020 2020  d_var):.        
+00043f50: 2020 2020 6966 2063 6f6f 7264 5f76 6172      if coord_var
+00043f60: 2e64 7479 7065 2e6b 696e 6420 696e 2022  .dtype.kind in "
+00043f70: 6d4d 2220 616e 6420 6461 7465 7469 6d65  mM" and datetime
+00043f80: 5f75 6e69 7420 6973 204e 6f6e 653a 0a20  _unit is None:. 
+00043f90: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00043fa0: 6174 6574 696d 655f 756e 6974 203d 2063  atetime_unit = c
+00043fb0: 6173 7428 0a20 2020 2020 2020 2020 2020  ast(.           
+00043fc0: 2020 2020 2020 2020 2022 4461 7465 7469           "Dateti
+00043fd0: 6d65 556e 6974 4f70 7469 6f6e 7322 2c20  meUnitOptions", 
+00043fe0: 6e70 2e64 6174 6574 696d 655f 6461 7461  np.datetime_data
+00043ff0: 2863 6f6f 7264 5f76 6172 2e64 7479 7065  (coord_var.dtype
+00044000: 295b 305d 0a20 2020 2020 2020 2020 2020  )[0].           
+00044010: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00044020: 2020 2065 6c69 6620 6461 7465 7469 6d65     elif datetime
+00044030: 5f75 6e69 7420 6973 204e 6f6e 653a 0a20  _unit is None:. 
+00044040: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00044050: 6174 6574 696d 655f 756e 6974 203d 2022  atetime_unit = "
+00044060: 7322 2020 2320 4465 6661 756c 7420 746f  s"  # Default to
+00044070: 2073 6563 6f6e 6473 2066 6f72 2063 6674   seconds for cft
+00044080: 696d 6520 6f62 6a65 6374 730a 2020 2020  ime objects.    
+00044090: 2020 2020 2020 2020 636f 6f72 645f 7661          coord_va
+000440a0: 7220 3d20 636f 6f72 645f 7661 722e 5f74  r = coord_var._t
+000440b0: 6f5f 6e75 6d65 7269 6328 6461 7465 7469  o_numeric(dateti
+000440c0: 6d65 5f75 6e69 743d 6461 7465 7469 6d65  me_unit=datetime
+000440d0: 5f75 6e69 7429 0a0a 2020 2020 2020 2020  _unit)..        
+000440e0: 7661 7269 6162 6c65 7320 3d20 7b7d 0a20  variables = {}. 
+000440f0: 2020 2020 2020 2066 6f72 206b 2c20 7620         for k, v 
+00044100: 696e 2073 656c 662e 7661 7269 6162 6c65  in self.variable
+00044110: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
+00044120: 2020 2020 2020 2069 6620 6b20 696e 2073         if k in s
+00044130: 656c 662e 6461 7461 5f76 6172 7320 616e  elf.data_vars an
+00044140: 6420 6469 6d20 696e 2076 2e64 696d 7320  d dim in v.dims 
+00044150: 616e 6420 6b20 6e6f 7420 696e 2073 656c  and k not in sel
+00044160: 662e 636f 6f72 6473 3a0a 2020 2020 2020  f.coords:.      
+00044170: 2020 2020 2020 2020 2020 6966 205f 636f            if _co
+00044180: 6e74 6169 6e73 5f64 6174 6574 696d 655f  ntains_datetime_
+00044190: 6c69 6b65 5f6f 626a 6563 7473 2876 293a  like_objects(v):
+000441a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000441b0: 2020 2020 2076 203d 2076 2e5f 746f 5f6e       v = v._to_n
+000441c0: 756d 6572 6963 2864 6174 6574 696d 655f  umeric(datetime_
+000441d0: 756e 6974 3d64 6174 6574 696d 655f 756e  unit=datetime_un
+000441e0: 6974 290a 2020 2020 2020 2020 2020 2020  it).            
+000441f0: 2020 2020 6772 6164 203d 2064 7563 6b5f      grad = duck_
+00044200: 6172 7261 795f 6f70 732e 6772 6164 6965  array_ops.gradie
+00044210: 6e74 280a 2020 2020 2020 2020 2020 2020  nt(.            
+00044220: 2020 2020 2020 2020 762e 6461 7461 2c0a          v.data,.
+00044230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044240: 2020 2020 636f 6f72 645f 7661 722e 6461      coord_var.da
+00044250: 7461 2c0a 2020 2020 2020 2020 2020 2020  ta,.            
+00044260: 2020 2020 2020 2020 6564 6765 5f6f 7264          edge_ord
+00044270: 6572 3d65 6467 655f 6f72 6465 722c 0a20  er=edge_order,. 
+00044280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044290: 2020 2061 7869 733d 762e 6765 745f 6178     axis=v.get_ax
+000442a0: 6973 5f6e 756d 2864 696d 292c 0a20 2020  is_num(dim),.   
+000442b0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000442c0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+000442d0: 6172 6961 626c 6573 5b6b 5d20 3d20 5661  ariables[k] = Va
+000442e0: 7269 6162 6c65 2876 2e64 696d 732c 2067  riable(v.dims, g
+000442f0: 7261 6429 0a20 2020 2020 2020 2020 2020  rad).           
+00044300: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00044310: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+00044320: 5b6b 5d20 3d20 760a 2020 2020 2020 2020  [k] = v.        
+00044330: 7265 7475 726e 2073 656c 662e 5f72 6570  return self._rep
+00044340: 6c61 6365 2876 6172 6961 626c 6573 290a  lace(variables).
+00044350: 0a20 2020 2064 6566 2069 6e74 6567 7261  .    def integra
+00044360: 7465 280a 2020 2020 2020 2020 7365 6c66  te(.        self
+00044370: 3a20 545f 4461 7461 7365 742c 0a20 2020  : T_Dataset,.   
+00044380: 2020 2020 2063 6f6f 7264 3a20 4861 7368       coord: Hash
+00044390: 6162 6c65 207c 2053 6571 7565 6e63 655b  able | Sequence[
+000443a0: 4861 7368 6162 6c65 5d2c 0a20 2020 2020  Hashable],.     
+000443b0: 2020 2064 6174 6574 696d 655f 756e 6974     datetime_unit
+000443c0: 3a20 4461 7465 7469 6d65 556e 6974 4f70  : DatetimeUnitOp
+000443d0: 7469 6f6e 7320 3d20 4e6f 6e65 2c0a 2020  tions = None,.  
+000443e0: 2020 2920 2d3e 2054 5f44 6174 6173 6574    ) -> T_Dataset
+000443f0: 3a0a 2020 2020 2020 2020 2222 2249 6e74  :.        """Int
+00044400: 6567 7261 7465 2061 6c6f 6e67 2074 6865  egrate along the
+00044410: 2067 6976 656e 2063 6f6f 7264 696e 6174   given coordinat
+00044420: 6520 7573 696e 6720 7468 6520 7472 6170  e using the trap
+00044430: 657a 6f69 6461 6c20 7275 6c65 2e0a 0a20  ezoidal rule... 
+00044440: 2020 2020 2020 202e 2e20 6e6f 7465 3a3a         .. note::
+00044450: 0a20 2020 2020 2020 2020 2020 2054 6869  .            Thi
+00044460: 7320 6665 6174 7572 6520 6973 206c 696d  s feature is lim
+00044470: 6974 6564 2074 6f20 7369 6d70 6c65 2063  ited to simple c
+00044480: 6172 7465 7369 616e 2067 656f 6d65 7472  artesian geometr
+00044490: 792c 2069 2e65 2e20 636f 6f72 640a 2020  y, i.e. coord.  
+000444a0: 2020 2020 2020 2020 2020 6d75 7374 2062            must b
+000444b0: 6520 6f6e 6520 6469 6d65 6e73 696f 6e61  e one dimensiona
+000444c0: 6c2e 0a0a 2020 2020 2020 2020 5061 7261  l...        Para
+000444d0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+000444e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000444f0: 2020 636f 6f72 6420 3a20 6861 7368 6162    coord : hashab
+00044500: 6c65 2c20 6f72 2073 6571 7565 6e63 6520  le, or sequence 
+00044510: 6f66 2068 6173 6861 626c 650a 2020 2020  of hashable.    
+00044520: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
+00044530: 7465 2873 2920 7573 6564 2066 6f72 2074  te(s) used for t
+00044540: 6865 2069 6e74 6567 7261 7469 6f6e 2e0a  he integration..
+00044550: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
+00044560: 5f75 6e69 7420 3a20 7b27 5927 2c20 274d  _unit : {'Y', 'M
+00044570: 272c 2027 5727 2c20 2744 272c 2027 6827  ', 'W', 'D', 'h'
+00044580: 2c20 276d 272c 2027 7327 2c20 276d 7327  , 'm', 's', 'ms'
+00044590: 2c20 2775 7327 2c20 276e 7327 2c20 5c0a  , 'us', 'ns', \.
+000445a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000445b0: 2020 2020 2020 2020 2770 7327 2c20 2766          'ps', 'f
+000445c0: 7327 2c20 2761 7327 2c20 4e6f 6e65 7d2c  s', 'as', None},
+000445d0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+000445e0: 2020 2020 2020 5370 6563 6966 7920 7468        Specify th
+000445f0: 6520 756e 6974 2069 6620 6461 7465 7469  e unit if dateti
+00044600: 6d65 2063 6f6f 7264 696e 6174 6520 6973  me coordinate is
+00044610: 2075 7365 642e 0a0a 2020 2020 2020 2020   used...        
+00044620: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
+00044630: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00044640: 696e 7465 6772 6174 6564 203a 2044 6174  integrated : Dat
+00044650: 6173 6574 0a0a 2020 2020 2020 2020 5365  aset..        Se
+00044660: 6520 616c 736f 0a20 2020 2020 2020 202d  e also.        -
+00044670: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00044680: 4461 7461 4172 7261 792e 696e 7465 6772  DataArray.integr
+00044690: 6174 650a 2020 2020 2020 2020 6e75 6d70  ate.        nump
+000446a0: 792e 7472 6170 7a20 3a20 636f 7272 6573  y.trapz : corres
+000446b0: 706f 6e64 696e 6720 6e75 6d70 7920 6675  ponding numpy fu
+000446c0: 6e63 7469 6f6e 0a0a 2020 2020 2020 2020  nction..        
+000446d0: 4578 616d 706c 6573 0a20 2020 2020 2020  Examples.       
+000446e0: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+000446f0: 2020 3e3e 3e20 6473 203d 2078 722e 4461    >>> ds = xr.Da
+00044700: 7461 7365 7428 0a20 2020 2020 2020 202e  taset(.        .
+00044710: 2e2e 2020 2020 2064 6174 615f 7661 7273  ..     data_vars
+00044720: 3d7b 2261 223a 2028 2278 222c 205b 352c  ={"a": ("x", [5,
+00044730: 2035 2c20 362c 2036 5d29 2c20 2262 223a   5, 6, 6]), "b":
+00044740: 2028 2278 222c 205b 312c 2032 2c20 312c   ("x", [1, 2, 1,
+00044750: 2030 5d29 7d2c 0a20 2020 2020 2020 202e   0])},.        .
+00044760: 2e2e 2020 2020 2063 6f6f 7264 733d 7b22  ..     coords={"
+00044770: 7822 3a20 5b30 2c20 312c 2032 2c20 335d  x": [0, 1, 2, 3]
+00044780: 2c20 2279 223a 2028 2278 222c 205b 312c  , "y": ("x", [1,
+00044790: 2037 2c20 332c 2035 5d29 7d2c 0a20 2020   7, 3, 5])},.   
+000447a0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
+000447b0: 2020 203e 3e3e 2064 730a 2020 2020 2020     >>> ds.      
+000447c0: 2020 3c78 6172 7261 792e 4461 7461 7365    <xarray.Datase
+000447d0: 743e 0a20 2020 2020 2020 2044 696d 656e  t>.        Dimen
+000447e0: 7369 6f6e 733a 2020 2878 3a20 3429 0a20  sions:  (x: 4). 
+000447f0: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
+00044800: 6573 3a0a 2020 2020 2020 2020 2020 2a20  es:.          * 
+00044810: 7820 2020 2020 2020 2028 7829 2069 6e74  x        (x) int
+00044820: 3634 2030 2031 2032 2033 0a20 2020 2020  64 0 1 2 3.     
+00044830: 2020 2020 2020 2079 2020 2020 2020 2020         y        
+00044840: 2878 2920 696e 7436 3420 3120 3720 3320  (x) int64 1 7 3 
+00044850: 350a 2020 2020 2020 2020 4461 7461 2076  5.        Data v
+00044860: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
+00044870: 2020 2020 2020 6120 2020 2020 2020 2028        a        (
+00044880: 7829 2069 6e74 3634 2035 2035 2036 2036  x) int64 5 5 6 6
+00044890: 0a20 2020 2020 2020 2020 2020 2062 2020  .            b  
+000448a0: 2020 2020 2020 2878 2920 696e 7436 3420        (x) int64 
+000448b0: 3120 3220 3120 300a 2020 2020 2020 2020  1 2 1 0.        
+000448c0: 3e3e 3e20 6473 2e69 6e74 6567 7261 7465  >>> ds.integrate
+000448d0: 2822 7822 290a 2020 2020 2020 2020 3c78  ("x").        <x
+000448e0: 6172 7261 792e 4461 7461 7365 743e 0a20  array.Dataset>. 
+000448f0: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
+00044900: 733a 2020 2829 0a20 2020 2020 2020 2044  s:  ().        D
+00044910: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
+00044920: 2020 2020 2020 2020 2020 2061 2020 2020             a    
+00044930: 2020 2020 666c 6f61 7436 3420 3136 2e35      float64 16.5
+00044940: 0a20 2020 2020 2020 2020 2020 2062 2020  .            b  
+00044950: 2020 2020 2020 666c 6f61 7436 3420 332e        float64 3.
+00044960: 350a 2020 2020 2020 2020 3e3e 3e20 6473  5.        >>> ds
+00044970: 2e69 6e74 6567 7261 7465 2822 7922 290a  .integrate("y").
+00044980: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
+00044990: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
+000449a0: 2044 696d 656e 7369 6f6e 733a 2020 2829   Dimensions:  ()
+000449b0: 0a20 2020 2020 2020 2044 6174 6120 7661  .        Data va
+000449c0: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
+000449d0: 2020 2020 2061 2020 2020 2020 2020 666c       a        fl
+000449e0: 6f61 7436 3420 3230 2e30 0a20 2020 2020  oat64 20.0.     
+000449f0: 2020 2020 2020 2062 2020 2020 2020 2020         b        
+00044a00: 666c 6f61 7436 3420 342e 300a 2020 2020  float64 4.0.    
+00044a10: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+00044a20: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
+00044a30: 6528 636f 6f72 642c 2028 6c69 7374 2c20  e(coord, (list, 
+00044a40: 7475 706c 6529 293a 0a20 2020 2020 2020  tuple)):.       
+00044a50: 2020 2020 2063 6f6f 7264 203d 2028 636f       coord = (co
+00044a60: 6f72 642c 290a 2020 2020 2020 2020 7265  ord,).        re
+00044a70: 7375 6c74 203d 2073 656c 660a 2020 2020  sult = self.    
+00044a80: 2020 2020 666f 7220 6320 696e 2063 6f6f      for c in coo
+00044a90: 7264 3a0a 2020 2020 2020 2020 2020 2020  rd:.            
+00044aa0: 7265 7375 6c74 203d 2072 6573 756c 742e  result = result.
+00044ab0: 5f69 6e74 6567 7261 7465 5f6f 6e65 2863  _integrate_one(c
+00044ac0: 2c20 6461 7465 7469 6d65 5f75 6e69 743d  , datetime_unit=
+00044ad0: 6461 7465 7469 6d65 5f75 6e69 7429 0a20  datetime_unit). 
+00044ae0: 2020 2020 2020 2072 6574 7572 6e20 7265         return re
+00044af0: 7375 6c74 0a0a 2020 2020 6465 6620 5f69  sult..    def _i
+00044b00: 6e74 6567 7261 7465 5f6f 6e65 2873 656c  ntegrate_one(sel
+00044b10: 662c 2063 6f6f 7264 2c20 6461 7465 7469  f, coord, dateti
+00044b20: 6d65 5f75 6e69 743d 4e6f 6e65 2c20 6375  me_unit=None, cu
+00044b30: 6d75 6c61 7469 7665 3d46 616c 7365 293a  mulative=False):
+00044b40: 0a20 2020 2020 2020 2066 726f 6d20 7861  .        from xa
+00044b50: 7272 6179 2e63 6f72 652e 7661 7269 6162  rray.core.variab
+00044b60: 6c65 2069 6d70 6f72 7420 5661 7269 6162  le import Variab
+00044b70: 6c65 0a0a 2020 2020 2020 2020 6966 2063  le..        if c
+00044b80: 6f6f 7264 206e 6f74 2069 6e20 7365 6c66  oord not in self
+00044b90: 2e76 6172 6961 626c 6573 2061 6e64 2063  .variables and c
+00044ba0: 6f6f 7264 206e 6f74 2069 6e20 7365 6c66  oord not in self
+00044bb0: 2e64 696d 733a 0a20 2020 2020 2020 2020  .dims:.         
+00044bc0: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00044bd0: 726f 7228 6622 436f 6f72 6469 6e61 7465  ror(f"Coordinate
+00044be0: 207b 636f 6f72 647d 2064 6f65 7320 6e6f   {coord} does no
+00044bf0: 7420 6578 6973 742e 2229 0a0a 2020 2020  t exist.")..    
+00044c00: 2020 2020 636f 6f72 645f 7661 7220 3d20      coord_var = 
+00044c10: 7365 6c66 5b63 6f6f 7264 5d2e 7661 7269  self[coord].vari
+00044c20: 6162 6c65 0a20 2020 2020 2020 2069 6620  able.        if 
+00044c30: 636f 6f72 645f 7661 722e 6e64 696d 2021  coord_var.ndim !
+00044c40: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00044c50: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00044c60: 7228 0a20 2020 2020 2020 2020 2020 2020  r(.             
+00044c70: 2020 2022 436f 6f72 6469 6e61 7465 207b     "Coordinate {
+00044c80: 7d20 6d75 7374 2062 6520 3120 6469 6d65  } must be 1 dime
+00044c90: 6e73 696f 6e61 6c20 6275 7420 6973 207b  nsional but is {
+00044ca0: 7d22 0a20 2020 2020 2020 2020 2020 2020  }".             
+00044cb0: 2020 2022 2064 696d 656e 7369 6f6e 616c     " dimensional
+00044cc0: 222e 666f 726d 6174 2863 6f6f 7264 2c20  ".format(coord, 
+00044cd0: 636f 6f72 645f 7661 722e 6e64 696d 290a  coord_var.ndim).
+00044ce0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00044cf0: 2020 2020 2020 2064 696d 203d 2063 6f6f         dim = coo
+00044d00: 7264 5f76 6172 2e64 696d 735b 305d 0a20  rd_var.dims[0]. 
+00044d10: 2020 2020 2020 2069 6620 5f63 6f6e 7461         if _conta
+00044d20: 696e 735f 6461 7465 7469 6d65 5f6c 696b  ins_datetime_lik
+00044d30: 655f 6f62 6a65 6374 7328 636f 6f72 645f  e_objects(coord_
+00044d40: 7661 7229 3a0a 2020 2020 2020 2020 2020  var):.          
+00044d50: 2020 6966 2063 6f6f 7264 5f76 6172 2e64    if coord_var.d
+00044d60: 7479 7065 2e6b 696e 6420 696e 2022 6d4d  type.kind in "mM
+00044d70: 2220 616e 6420 6461 7465 7469 6d65 5f75  " and datetime_u
+00044d80: 6e69 7420 6973 204e 6f6e 653a 0a20 2020  nit is None:.   
+00044d90: 2020 2020 2020 2020 2020 2020 2064 6174               dat
+00044da0: 6574 696d 655f 756e 6974 2c20 5f20 3d20  etime_unit, _ = 
+00044db0: 6e70 2e64 6174 6574 696d 655f 6461 7461  np.datetime_data
+00044dc0: 2863 6f6f 7264 5f76 6172 2e64 7479 7065  (coord_var.dtype
+00044dd0: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00044de0: 6966 2064 6174 6574 696d 655f 756e 6974  if datetime_unit
+00044df0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+00044e00: 2020 2020 2020 2020 2020 6461 7465 7469            dateti
+00044e10: 6d65 5f75 6e69 7420 3d20 2273 2220 2023  me_unit = "s"  #
+00044e20: 2044 6566 6175 6c74 2074 6f20 7365 636f   Default to seco
+00044e30: 6e64 7320 666f 7220 6366 7469 6d65 206f  nds for cftime o
+00044e40: 626a 6563 7473 0a20 2020 2020 2020 2020  bjects.         
+00044e50: 2020 2063 6f6f 7264 5f76 6172 203d 2063     coord_var = c
+00044e60: 6f6f 7264 5f76 6172 2e5f 7265 706c 6163  oord_var._replac
+00044e70: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00044e80: 2020 2064 6174 613d 6461 7465 7469 6d65     data=datetime
+00044e90: 5f74 6f5f 6e75 6d65 7269 6328 636f 6f72  _to_numeric(coor
+00044ea0: 645f 7661 722e 6461 7461 2c20 6461 7465  d_var.data, date
+00044eb0: 7469 6d65 5f75 6e69 743d 6461 7465 7469  time_unit=dateti
+00044ec0: 6d65 5f75 6e69 7429 0a20 2020 2020 2020  me_unit).       
+00044ed0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00044ee0: 7661 7269 6162 6c65 7320 3d20 7b7d 0a20  variables = {}. 
+00044ef0: 2020 2020 2020 2063 6f6f 7264 5f6e 616d         coord_nam
+00044f00: 6573 203d 2073 6574 2829 0a20 2020 2020  es = set().     
+00044f10: 2020 2066 6f72 206b 2c20 7620 696e 2073     for k, v in s
+00044f20: 656c 662e 7661 7269 6162 6c65 732e 6974  elf.variables.it
+00044f30: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
+00044f40: 2020 2069 6620 6b20 696e 2073 656c 662e     if k in self.
+00044f50: 636f 6f72 6473 3a0a 2020 2020 2020 2020  coords:.        
+00044f60: 2020 2020 2020 2020 6966 2064 696d 206e          if dim n
+00044f70: 6f74 2069 6e20 762e 6469 6d73 206f 7220  ot in v.dims or 
+00044f80: 6375 6d75 6c61 7469 7665 3a0a 2020 2020  cumulative:.    
+00044f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00044fa0: 7661 7269 6162 6c65 735b 6b5d 203d 2076  variables[k] = v
+00044fb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00044fc0: 2020 2020 2063 6f6f 7264 5f6e 616d 6573       coord_names
+00044fd0: 2e61 6464 286b 290a 2020 2020 2020 2020  .add(k).        
+00044fe0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00044ff0: 2020 2020 2020 2020 2020 6966 206b 2069            if k i
+00045000: 6e20 7365 6c66 2e64 6174 615f 7661 7273  n self.data_vars
+00045010: 2061 6e64 2064 696d 2069 6e20 762e 6469   and dim in v.di
+00045020: 6d73 3a0a 2020 2020 2020 2020 2020 2020  ms:.            
+00045030: 2020 2020 2020 2020 6966 205f 636f 6e74          if _cont
+00045040: 6169 6e73 5f64 6174 6574 696d 655f 6c69  ains_datetime_li
+00045050: 6b65 5f6f 626a 6563 7473 2876 293a 0a20  ke_objects(v):. 
+00045060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045070: 2020 2020 2020 2076 203d 2064 6174 6574         v = datet
+00045080: 696d 655f 746f 5f6e 756d 6572 6963 2876  ime_to_numeric(v
+00045090: 2c20 6461 7465 7469 6d65 5f75 6e69 743d  , datetime_unit=
+000450a0: 6461 7465 7469 6d65 5f75 6e69 7429 0a20  datetime_unit). 
 000450b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000450c0: 765f 6469 6d73 203d 206c 6973 7428 762e  v_dims = list(v.
-000450d0: 6469 6d73 290a 2020 2020 2020 2020 2020  dims).          
-000450e0: 2020 2020 2020 2020 2020 2020 2020 765f                v_
-000450f0: 6469 6d73 2e72 656d 6f76 6528 6469 6d29  dims.remove(dim)
-00045100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00045110: 2020 2020 2076 6172 6961 626c 6573 5b6b       variables[k
-00045120: 5d20 3d20 5661 7269 6162 6c65 2876 5f64  ] = Variable(v_d
-00045130: 696d 732c 2069 6e74 6567 290a 2020 2020  ims, integ).    
-00045140: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00045150: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00045160: 2020 2020 2020 7661 7269 6162 6c65 735b        variables[
-00045170: 6b5d 203d 2076 0a20 2020 2020 2020 2069  k] = v.        i
-00045180: 6e64 6578 6573 203d 207b 6b3a 2076 2066  ndexes = {k: v f
-00045190: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
-000451a0: 5f69 6e64 6578 6573 2e69 7465 6d73 2829  _indexes.items()
-000451b0: 2069 6620 6b20 696e 2076 6172 6961 626c   if k in variabl
-000451c0: 6573 7d0a 2020 2020 2020 2020 7265 7475  es}.        retu
-000451d0: 726e 2073 656c 662e 5f72 6570 6c61 6365  rn self._replace
-000451e0: 5f77 6974 685f 6e65 775f 6469 6d73 280a  _with_new_dims(.
-000451f0: 2020 2020 2020 2020 2020 2020 7661 7269              vari
-00045200: 6162 6c65 732c 2063 6f6f 7264 5f6e 616d  ables, coord_nam
-00045210: 6573 3d63 6f6f 7264 5f6e 616d 6573 2c20  es=coord_names, 
-00045220: 696e 6465 7865 733d 696e 6465 7865 730a  indexes=indexes.
-00045230: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
-00045240: 6566 2063 756d 756c 6174 6976 655f 696e  ef cumulative_in
-00045250: 7465 6772 6174 6528 0a20 2020 2020 2020  tegrate(.       
-00045260: 2073 656c 663a 2054 5f44 6174 6173 6574   self: T_Dataset
-00045270: 2c0a 2020 2020 2020 2020 636f 6f72 643a  ,.        coord:
-00045280: 2048 6173 6861 626c 6520 7c20 5365 7175   Hashable | Sequ
-00045290: 656e 6365 5b48 6173 6861 626c 655d 2c0a  ence[Hashable],.
-000452a0: 2020 2020 2020 2020 6461 7465 7469 6d65          datetime
-000452b0: 5f75 6e69 743a 2044 6174 6574 696d 6555  _unit: DatetimeU
-000452c0: 6e69 744f 7074 696f 6e73 203d 204e 6f6e  nitOptions = Non
-000452d0: 652c 0a20 2020 2029 202d 3e20 545f 4461  e,.    ) -> T_Da
-000452e0: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
-000452f0: 2222 496e 7465 6772 6174 6520 616c 6f6e  ""Integrate alon
-00045300: 6720 7468 6520 6769 7665 6e20 636f 6f72  g the given coor
-00045310: 6469 6e61 7465 2075 7369 6e67 2074 6865  dinate using the
-00045320: 2074 7261 7065 7a6f 6964 616c 2072 756c   trapezoidal rul
-00045330: 652e 0a0a 2020 2020 2020 2020 2e2e 206e  e...        .. n
-00045340: 6f74 653a 3a0a 2020 2020 2020 2020 2020  ote::.          
-00045350: 2020 5468 6973 2066 6561 7475 7265 2069    This feature i
-00045360: 7320 6c69 6d69 7465 6420 746f 2073 696d  s limited to sim
-00045370: 706c 6520 6361 7274 6573 6961 6e20 6765  ple cartesian ge
-00045380: 6f6d 6574 7279 2c20 692e 652e 2063 6f6f  ometry, i.e. coo
-00045390: 7264 0a20 2020 2020 2020 2020 2020 206d  rd.            m
-000453a0: 7573 7420 6265 206f 6e65 2064 696d 656e  ust be one dimen
-000453b0: 7369 6f6e 616c 2e0a 0a20 2020 2020 2020  sional...       
-000453c0: 2020 2020 2054 6865 2066 6972 7374 2065       The first e
-000453d0: 6e74 7279 206f 6620 7468 6520 6375 6d75  ntry of the cumu
-000453e0: 6c61 7469 7665 2069 6e74 6567 7261 6c20  lative integral 
-000453f0: 6f66 2065 6163 6820 7661 7269 6162 6c65  of each variable
-00045400: 2069 7320 616c 7761 7973 2030 2c20 696e   is always 0, in
-00045410: 0a20 2020 2020 2020 2020 2020 206f 7264  .            ord
-00045420: 6572 2074 6f20 6b65 6570 2074 6865 206c  er to keep the l
-00045430: 656e 6774 6820 6f66 2074 6865 2064 696d  ength of the dim
-00045440: 656e 7369 6f6e 2075 6e63 6861 6e67 6564  ension unchanged
-00045450: 2062 6574 7765 656e 2069 6e70 7574 2061   between input a
-00045460: 6e64 0a20 2020 2020 2020 2020 2020 206f  nd.            o
-00045470: 7574 7075 742e 0a0a 2020 2020 2020 2020  utput...        
-00045480: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00045490: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-000454a0: 2020 2020 2020 636f 6f72 6420 3a20 6861        coord : ha
-000454b0: 7368 6162 6c65 2c20 6f72 2073 6571 7565  shable, or seque
-000454c0: 6e63 6520 6f66 2068 6173 6861 626c 650a  nce of hashable.
-000454d0: 2020 2020 2020 2020 2020 2020 436f 6f72              Coor
-000454e0: 6469 6e61 7465 2873 2920 7573 6564 2066  dinate(s) used f
-000454f0: 6f72 2074 6865 2069 6e74 6567 7261 7469  or the integrati
-00045500: 6f6e 2e0a 2020 2020 2020 2020 6461 7465  on..        date
-00045510: 7469 6d65 5f75 6e69 7420 3a20 7b27 5927  time_unit : {'Y'
-00045520: 2c20 274d 272c 2027 5727 2c20 2744 272c  , 'M', 'W', 'D',
-00045530: 2027 6827 2c20 276d 272c 2027 7327 2c20   'h', 'm', 's', 
-00045540: 276d 7327 2c20 2775 7327 2c20 276e 7327  'ms', 'us', 'ns'
-00045550: 2c20 5c0a 2020 2020 2020 2020 2020 2020  , \.            
-00045560: 2020 2020 2020 2020 2020 2020 2770 7327              'ps'
-00045570: 2c20 2766 7327 2c20 2761 7327 2c20 4e6f  , 'fs', 'as', No
-00045580: 6e65 7d2c 206f 7074 696f 6e61 6c0a 2020  ne}, optional.  
-00045590: 2020 2020 2020 2020 2020 5370 6563 6966            Specif
-000455a0: 7920 7468 6520 756e 6974 2069 6620 6461  y the unit if da
-000455b0: 7465 7469 6d65 2063 6f6f 7264 696e 6174  tetime coordinat
-000455c0: 6520 6973 2075 7365 642e 0a0a 2020 2020  e is used...    
-000455d0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-000455e0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-000455f0: 2020 2020 696e 7465 6772 6174 6564 203a      integrated :
-00045600: 2044 6174 6173 6574 0a0a 2020 2020 2020   Dataset..      
-00045610: 2020 5365 6520 616c 736f 0a20 2020 2020    See also.     
-00045620: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00045630: 2020 2020 4461 7461 4172 7261 792e 6375      DataArray.cu
-00045640: 6d75 6c61 7469 7665 5f69 6e74 6567 7261  mulative_integra
-00045650: 7465 0a20 2020 2020 2020 2073 6369 7079  te.        scipy
-00045660: 2e69 6e74 6567 7261 7465 2e63 756d 756c  .integrate.cumul
-00045670: 6174 6976 655f 7472 6170 657a 6f69 6420  ative_trapezoid 
-00045680: 3a20 636f 7272 6573 706f 6e64 696e 6720  : corresponding 
-00045690: 7363 6970 7920 6675 6e63 7469 6f6e 0a0a  scipy function..
-000456a0: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-000456b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000456c0: 2d0a 2020 2020 2020 2020 3e3e 3e20 6473  -.        >>> ds
-000456d0: 203d 2078 722e 4461 7461 7365 7428 0a20   = xr.Dataset(. 
-000456e0: 2020 2020 2020 202e 2e2e 2020 2020 2064         ...     d
-000456f0: 6174 615f 7661 7273 3d7b 2261 223a 2028  ata_vars={"a": (
-00045700: 2278 222c 205b 352c 2035 2c20 362c 2036  "x", [5, 5, 6, 6
-00045710: 5d29 2c20 2262 223a 2028 2278 222c 205b  ]), "b": ("x", [
-00045720: 312c 2032 2c20 312c 2030 5d29 7d2c 0a20  1, 2, 1, 0])},. 
-00045730: 2020 2020 2020 202e 2e2e 2020 2020 2063         ...     c
-00045740: 6f6f 7264 733d 7b22 7822 3a20 5b30 2c20  oords={"x": [0, 
-00045750: 312c 2032 2c20 335d 2c20 2279 223a 2028  1, 2, 3], "y": (
-00045760: 2278 222c 205b 312c 2037 2c20 332c 2035  "x", [1, 7, 3, 5
-00045770: 5d29 7d2c 0a20 2020 2020 2020 202e 2e2e  ])},.        ...
-00045780: 2029 0a20 2020 2020 2020 203e 3e3e 2064   ).        >>> d
-00045790: 730a 2020 2020 2020 2020 3c78 6172 7261  s.        <xarra
-000457a0: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
-000457b0: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
-000457c0: 2878 3a20 3429 0a20 2020 2020 2020 2043  (x: 4).        C
-000457d0: 6f6f 7264 696e 6174 6573 3a0a 2020 2020  oordinates:.    
-000457e0: 2020 2020 2020 2a20 7820 2020 2020 2020        * x       
-000457f0: 2028 7829 2069 6e74 3634 2030 2031 2032   (x) int64 0 1 2
-00045800: 2033 0a20 2020 2020 2020 2020 2020 2079   3.            y
-00045810: 2020 2020 2020 2020 2878 2920 696e 7436          (x) int6
-00045820: 3420 3120 3720 3320 350a 2020 2020 2020  4 1 7 3 5.      
-00045830: 2020 4461 7461 2076 6172 6961 626c 6573    Data variables
-00045840: 3a0a 2020 2020 2020 2020 2020 2020 6120  :.            a 
-00045850: 2020 2020 2020 2028 7829 2069 6e74 3634         (x) int64
-00045860: 2035 2035 2036 2036 0a20 2020 2020 2020   5 5 6 6.       
-00045870: 2020 2020 2062 2020 2020 2020 2020 2878       b        (x
-00045880: 2920 696e 7436 3420 3120 3220 3120 300a  ) int64 1 2 1 0.
-00045890: 2020 2020 2020 2020 3e3e 3e20 6473 2e63          >>> ds.c
-000458a0: 756d 756c 6174 6976 655f 696e 7465 6772  umulative_integr
-000458b0: 6174 6528 2278 2229 0a20 2020 2020 2020  ate("x").       
-000458c0: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
-000458d0: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
-000458e0: 696f 6e73 3a20 2028 783a 2034 290a 2020  ions:  (x: 4).  
-000458f0: 2020 2020 2020 436f 6f72 6469 6e61 7465        Coordinate
-00045900: 733a 0a20 2020 2020 2020 2020 202a 2078  s:.          * x
-00045910: 2020 2020 2020 2020 2878 2920 696e 7436          (x) int6
-00045920: 3420 3020 3120 3220 330a 2020 2020 2020  4 0 1 2 3.      
-00045930: 2020 2020 2020 7920 2020 2020 2020 2028        y        (
-00045940: 7829 2069 6e74 3634 2031 2037 2033 2035  x) int64 1 7 3 5
-00045950: 0a20 2020 2020 2020 2044 6174 6120 7661  .        Data va
-00045960: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
-00045970: 2020 2020 2061 2020 2020 2020 2020 2878       a        (x
-00045980: 2920 666c 6f61 7436 3420 302e 3020 352e  ) float64 0.0 5.
-00045990: 3020 3130 2e35 2031 362e 350a 2020 2020  0 10.5 16.5.    
-000459a0: 2020 2020 2020 2020 6220 2020 2020 2020          b       
-000459b0: 2028 7829 2066 6c6f 6174 3634 2030 2e30   (x) float64 0.0
-000459c0: 2031 2e35 2033 2e30 2033 2e35 0a20 2020   1.5 3.0 3.5.   
-000459d0: 2020 2020 203e 3e3e 2064 732e 6375 6d75       >>> ds.cumu
-000459e0: 6c61 7469 7665 5f69 6e74 6567 7261 7465  lative_integrate
-000459f0: 2822 7922 290a 2020 2020 2020 2020 3c78  ("y").        <x
-00045a00: 6172 7261 792e 4461 7461 7365 743e 0a20  array.Dataset>. 
-00045a10: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
-00045a20: 733a 2020 2878 3a20 3429 0a20 2020 2020  s:  (x: 4).     
-00045a30: 2020 2043 6f6f 7264 696e 6174 6573 3a0a     Coordinates:.
-00045a40: 2020 2020 2020 2020 2020 2a20 7820 2020            * x   
-00045a50: 2020 2020 2028 7829 2069 6e74 3634 2030       (x) int64 0
-00045a60: 2031 2032 2033 0a20 2020 2020 2020 2020   1 2 3.         
-00045a70: 2020 2079 2020 2020 2020 2020 2878 2920     y        (x) 
-00045a80: 696e 7436 3420 3120 3720 3320 350a 2020  int64 1 7 3 5.  
-00045a90: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
-00045aa0: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
-00045ab0: 2020 6120 2020 2020 2020 2028 7829 2066    a        (x) f
-00045ac0: 6c6f 6174 3634 2030 2e30 2033 302e 3020  loat64 0.0 30.0 
-00045ad0: 382e 3020 3230 2e30 0a20 2020 2020 2020  8.0 20.0.       
-00045ae0: 2020 2020 2062 2020 2020 2020 2020 2878       b        (x
-00045af0: 2920 666c 6f61 7436 3420 302e 3020 392e  ) float64 0.0 9.
-00045b00: 3020 332e 3020 342e 300a 2020 2020 2020  0 3.0 4.0.      
-00045b10: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00045b20: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
-00045b30: 636f 6f72 642c 2028 6c69 7374 2c20 7475  coord, (list, tu
-00045b40: 706c 6529 293a 0a20 2020 2020 2020 2020  ple)):.         
-00045b50: 2020 2063 6f6f 7264 203d 2028 636f 6f72     coord = (coor
-00045b60: 642c 290a 2020 2020 2020 2020 7265 7375  d,).        resu
-00045b70: 6c74 203d 2073 656c 660a 2020 2020 2020  lt = self.      
-00045b80: 2020 666f 7220 6320 696e 2063 6f6f 7264    for c in coord
-00045b90: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-00045ba0: 7375 6c74 203d 2072 6573 756c 742e 5f69  sult = result._i
-00045bb0: 6e74 6567 7261 7465 5f6f 6e65 280a 2020  ntegrate_one(.  
-00045bc0: 2020 2020 2020 2020 2020 2020 2020 632c                c,
-00045bd0: 2064 6174 6574 696d 655f 756e 6974 3d64   datetime_unit=d
-00045be0: 6174 6574 696d 655f 756e 6974 2c20 6375  atetime_unit, cu
-00045bf0: 6d75 6c61 7469 7665 3d54 7275 650a 2020  mulative=True.  
-00045c00: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00045c10: 2020 2020 7265 7475 726e 2072 6573 756c      return resul
-00045c20: 740a 0a20 2020 2040 7072 6f70 6572 7479  t..    @property
-00045c30: 0a20 2020 2064 6566 2072 6561 6c28 7365  .    def real(se
-00045c40: 6c66 3a20 545f 4461 7461 7365 7429 202d  lf: T_Dataset) -
-00045c50: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
-00045c60: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00045c70: 2054 6865 2072 6561 6c20 7061 7274 206f   The real part o
-00045c80: 6620 6561 6368 2064 6174 6120 7661 7269  f each data vari
-00045c90: 6162 6c65 2e0a 0a20 2020 2020 2020 2053  able...        S
-00045ca0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-00045cb0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00045cc0: 206e 756d 7079 2e6e 6461 7272 6179 2e72   numpy.ndarray.r
-00045cd0: 6561 6c0a 2020 2020 2020 2020 2222 220a  eal.        """.
-00045ce0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00045cf0: 656c 662e 6d61 7028 6c61 6d62 6461 2078  elf.map(lambda x
-00045d00: 3a20 782e 7265 616c 2c20 6b65 6570 5f61  : x.real, keep_a
-00045d10: 7474 7273 3d54 7275 6529 0a0a 2020 2020  ttrs=True)..    
-00045d20: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00045d30: 6620 696d 6167 2873 656c 663a 2054 5f44  f imag(self: T_D
-00045d40: 6174 6173 6574 2920 2d3e 2054 5f44 6174  ataset) -> T_Dat
-00045d50: 6173 6574 3a0a 2020 2020 2020 2020 2222  aset:.        ""
-00045d60: 220a 2020 2020 2020 2020 5468 6520 696d  ".        The im
-00045d70: 6167 696e 6172 7920 7061 7274 206f 6620  aginary part of 
-00045d80: 6561 6368 2064 6174 6120 7661 7269 6162  each data variab
-00045d90: 6c65 2e0a 0a20 2020 2020 2020 2053 6565  le...        See
-00045da0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00045db0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
-00045dc0: 756d 7079 2e6e 6461 7272 6179 2e69 6d61  umpy.ndarray.ima
-00045dd0: 670a 2020 2020 2020 2020 2222 220a 2020  g.        """.  
-00045de0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00045df0: 662e 6d61 7028 6c61 6d62 6461 2078 3a20  f.map(lambda x: 
-00045e00: 782e 696d 6167 2c20 6b65 6570 5f61 7474  x.imag, keep_att
-00045e10: 7273 3d54 7275 6529 0a0a 2020 2020 706c  rs=True)..    pl
-00045e20: 6f74 203d 2075 7469 6c73 2e55 6e63 6163  ot = utils.Uncac
-00045e30: 6865 6441 6363 6573 736f 7228 4461 7461  hedAccessor(Data
-00045e40: 7365 7450 6c6f 7441 6363 6573 736f 7229  setPlotAccessor)
-00045e50: 0a0a 2020 2020 6465 6620 6669 6c74 6572  ..    def filter
-00045e60: 5f62 795f 6174 7472 7328 7365 6c66 3a20  _by_attrs(self: 
-00045e70: 545f 4461 7461 7365 742c 202a 2a6b 7761  T_Dataset, **kwa
-00045e80: 7267 7329 202d 3e20 545f 4461 7461 7365  rgs) -> T_Datase
-00045e90: 743a 0a20 2020 2020 2020 2022 2222 5265  t:.        """Re
-00045ea0: 7475 726e 7320 6120 6060 4461 7461 7365  turns a ``Datase
-00045eb0: 7460 6020 7769 7468 2076 6172 6961 626c  t`` with variabl
-00045ec0: 6573 2074 6861 7420 6d61 7463 6820 7370  es that match sp
-00045ed0: 6563 6966 6963 2063 6f6e 6469 7469 6f6e  ecific condition
-00045ee0: 732e 0a0a 2020 2020 2020 2020 4361 6e20  s...        Can 
-00045ef0: 7061 7373 2069 6e20 6060 6b65 793d 7661  pass in ``key=va
-00045f00: 6c75 6560 6020 6f72 2060 606b 6579 3d63  lue`` or ``key=c
-00045f10: 616c 6c61 626c 6560 602e 2020 4120 4461  allable``.  A Da
-00045f20: 7461 7365 7420 6973 2072 6574 7572 6e65  taset is returne
-00045f30: 640a 2020 2020 2020 2020 636f 6e74 6169  d.        contai
-00045f40: 6e69 6e67 206f 6e6c 7920 7468 6520 7661  ning only the va
-00045f50: 7269 6162 6c65 7320 666f 7220 7768 6963  riables for whic
-00045f60: 6820 616c 6c20 7468 6520 6669 6c74 6572  h all the filter
-00045f70: 2074 6573 7473 2070 6173 732e 0a20 2020   tests pass..   
-00045f80: 2020 2020 2054 6865 7365 2074 6573 7473       These tests
-00045f90: 2061 7265 2065 6974 6865 7220 6060 6b65   are either ``ke
-00045fa0: 793d 7661 6c75 6560 6020 666f 7220 7768  y=value`` for wh
-00045fb0: 6963 6820 7468 6520 6174 7472 6962 7574  ich the attribut
-00045fc0: 6520 6060 6b65 7960 600a 2020 2020 2020  e ``key``.      
-00045fd0: 2020 6861 7320 7468 6520 6578 6163 7420    has the exact 
-00045fe0: 7661 6c75 6520 6060 7661 6c75 6560 6020  value ``value`` 
-00045ff0: 6f72 2074 6865 2063 616c 6c61 626c 6520  or the callable 
-00046000: 7061 7373 6564 2069 6e74 6f0a 2020 2020  passed into.    
-00046010: 2020 2020 6060 6b65 793d 6361 6c6c 6162      ``key=callab
-00046020: 6c65 6060 2072 6574 7572 6e73 2054 7275  le`` returns Tru
-00046030: 652e 2054 6865 2063 616c 6c61 626c 6520  e. The callable 
-00046040: 7769 6c6c 2062 6520 7061 7373 6564 2061  will be passed a
-00046050: 2073 696e 676c 650a 2020 2020 2020 2020   single.        
-00046060: 7661 6c75 652c 2065 6974 6865 7220 7468  value, either th
-00046070: 6520 7661 6c75 6520 6f66 2074 6865 2061  e value of the a
-00046080: 7474 7269 6275 7465 2060 606b 6579 6060  ttribute ``key``
-00046090: 206f 7220 6060 4e6f 6e65 6060 2069 6620   or ``None`` if 
-000460a0: 7468 650a 2020 2020 2020 2020 4461 7461  the.        Data
-000460b0: 4172 7261 7920 646f 6573 206e 6f74 2068  Array does not h
-000460c0: 6176 6520 616e 2061 7474 7269 6275 7465  ave an attribute
-000460d0: 2077 6974 6820 7468 6520 6e61 6d65 2060   with the name `
-000460e0: 606b 6579 6060 2e0a 0a20 2020 2020 2020  `key``...       
-000460f0: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
-00046100: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20      ----------. 
-00046110: 2020 2020 2020 202a 2a6b 7761 7267 730a         **kwargs.
-00046120: 2020 2020 2020 2020 2020 2020 6b65 7920              key 
-00046130: 3a20 7374 720a 2020 2020 2020 2020 2020  : str.          
-00046140: 2020 2020 2020 4174 7472 6962 7574 6520        Attribute 
-00046150: 6e61 6d65 2e0a 2020 2020 2020 2020 2020  name..          
-00046160: 2020 7661 6c75 6520 3a20 6361 6c6c 6162    value : callab
-00046170: 6c65 206f 7220 6f62 6a0a 2020 2020 2020  le or obj.      
-00046180: 2020 2020 2020 2020 2020 4966 2076 616c            If val
-00046190: 7565 2069 7320 6120 6361 6c6c 6162 6c65  ue is a callable
-000461a0: 2c20 6974 2073 686f 756c 6420 7265 7475  , it should retu
-000461b0: 726e 2061 2062 6f6f 6c65 616e 2069 6e20  rn a boolean in 
-000461c0: 7468 6520 666f 726d 0a20 2020 2020 2020  the form.       
-000461d0: 2020 2020 2020 2020 206f 6620 626f 6f6c           of bool
-000461e0: 203d 2066 756e 6328 6174 7472 2920 7768   = func(attr) wh
-000461f0: 6572 6520 6174 7472 2069 7320 6461 2e61  ere attr is da.a
-00046200: 7474 7273 5b6b 6579 5d2e 0a20 2020 2020  ttrs[key]..     
-00046210: 2020 2020 2020 2020 2020 204f 7468 6572             Other
-00046220: 7769 7365 2c20 7661 6c75 6520 7769 6c6c  wise, value will
-00046230: 2062 6520 636f 6d70 6172 6564 2074 6f20   be compared to 
-00046240: 7468 6520 6561 6368 0a20 2020 2020 2020  the each.       
-00046250: 2020 2020 2020 2020 2044 6174 6141 7272           DataArr
-00046260: 6179 2773 2061 7474 7273 5b6b 6579 5d2e  ay's attrs[key].
-00046270: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00046280: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-00046290: 2d0a 2020 2020 2020 2020 6e65 7720 3a20  -.        new : 
-000462a0: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
-000462b0: 2020 2020 4e65 7720 6461 7461 7365 7420      New dataset 
-000462c0: 7769 7468 2076 6172 6961 626c 6573 2066  with variables f
-000462d0: 696c 7465 7265 6420 6279 2061 7474 7269  iltered by attri
-000462e0: 6275 7465 2e0a 0a20 2020 2020 2020 2045  bute...        E
-000462f0: 7861 6d70 6c65 730a 2020 2020 2020 2020  xamples.        
-00046300: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00046310: 203e 3e3e 2074 656d 7020 3d20 3135 202b   >>> temp = 15 +
-00046320: 2038 202a 206e 702e 7261 6e64 6f6d 2e72   8 * np.random.r
-00046330: 616e 646e 2832 2c20 322c 2033 290a 2020  andn(2, 2, 3).  
-00046340: 2020 2020 2020 3e3e 3e20 7072 6563 6970        >>> precip
-00046350: 203d 2031 3020 2a20 6e70 2e72 616e 646f   = 10 * np.rando
-00046360: 6d2e 7261 6e64 2832 2c20 322c 2033 290a  m.rand(2, 2, 3).
-00046370: 2020 2020 2020 2020 3e3e 3e20 6c6f 6e20          >>> lon 
-00046380: 3d20 5b5b 2d39 392e 3833 2c20 2d39 392e  = [[-99.83, -99.
-00046390: 3332 5d2c 205b 2d39 392e 3739 2c20 2d39  32], [-99.79, -9
-000463a0: 392e 3233 5d5d 0a20 2020 2020 2020 203e  9.23]].        >
-000463b0: 3e3e 206c 6174 203d 205b 5b34 322e 3235  >> lat = [[42.25
-000463c0: 2c20 3432 2e32 315d 2c20 5b34 322e 3633  , 42.21], [42.63
-000463d0: 2c20 3432 2e35 395d 5d0a 2020 2020 2020  , 42.59]].      
-000463e0: 2020 3e3e 3e20 6469 6d73 203d 205b 2278    >>> dims = ["x
-000463f0: 222c 2022 7922 2c20 2274 696d 6522 5d0a  ", "y", "time"].
-00046400: 2020 2020 2020 2020 3e3e 3e20 7465 6d70          >>> temp
-00046410: 5f61 7474 7220 3d20 6469 6374 2873 7461  _attr = dict(sta
-00046420: 6e64 6172 645f 6e61 6d65 3d22 6169 725f  ndard_name="air_
-00046430: 706f 7465 6e74 6961 6c5f 7465 6d70 6572  potential_temper
-00046440: 6174 7572 6522 290a 2020 2020 2020 2020  ature").        
-00046450: 3e3e 3e20 7072 6563 6970 5f61 7474 7220  >>> precip_attr 
-00046460: 3d20 6469 6374 2873 7461 6e64 6172 645f  = dict(standard_
-00046470: 6e61 6d65 3d22 636f 6e76 6563 7469 7665  name="convective
-00046480: 5f70 7265 6369 7069 7461 7469 6f6e 5f66  _precipitation_f
-00046490: 6c75 7822 290a 0a20 2020 2020 2020 203e  lux")..        >
-000464a0: 3e3e 2064 7320 3d20 7872 2e44 6174 6173  >> ds = xr.Datas
-000464b0: 6574 280a 2020 2020 2020 2020 2e2e 2e20  et(.        ... 
-000464c0: 2020 2020 6469 6374 280a 2020 2020 2020      dict(.      
-000464d0: 2020 2e2e 2e20 2020 2020 2020 2020 7465    ...         te
-000464e0: 6d70 6572 6174 7572 653d 2864 696d 732c  mperature=(dims,
-000464f0: 2074 656d 702c 2074 656d 705f 6174 7472   temp, temp_attr
-00046500: 292c 0a20 2020 2020 2020 202e 2e2e 2020  ),.        ...  
-00046510: 2020 2020 2020 2070 7265 6369 7069 7461         precipita
-00046520: 7469 6f6e 3d28 6469 6d73 2c20 7072 6563  tion=(dims, prec
-00046530: 6970 2c20 7072 6563 6970 5f61 7474 7229  ip, precip_attr)
-00046540: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
-00046550: 2020 292c 0a20 2020 2020 2020 202e 2e2e    ),.        ...
-00046560: 2020 2020 2063 6f6f 7264 733d 6469 6374       coords=dict
-00046570: 280a 2020 2020 2020 2020 2e2e 2e20 2020  (.        ...   
-00046580: 2020 2020 2020 6c6f 6e3d 285b 2278 222c        lon=(["x",
-00046590: 2022 7922 5d2c 206c 6f6e 292c 0a20 2020   "y"], lon),.   
-000465a0: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
-000465b0: 206c 6174 3d28 5b22 7822 2c20 2279 225d   lat=(["x", "y"]
-000465c0: 2c20 6c61 7429 2c0a 2020 2020 2020 2020  , lat),.        
-000465d0: 2e2e 2e20 2020 2020 2020 2020 7469 6d65  ...         time
-000465e0: 3d70 642e 6461 7465 5f72 616e 6765 2822  =pd.date_range("
-000465f0: 3230 3134 2d30 392d 3036 222c 2070 6572  2014-09-06", per
-00046600: 696f 6473 3d33 292c 0a20 2020 2020 2020  iods=3),.       
-00046610: 202e 2e2e 2020 2020 2020 2020 2072 6566   ...         ref
-00046620: 6572 656e 6365 5f74 696d 653d 7064 2e54  erence_time=pd.T
-00046630: 696d 6573 7461 6d70 2822 3230 3134 2d30  imestamp("2014-0
-00046640: 392d 3035 2229 2c0a 2020 2020 2020 2020  9-05"),.        
-00046650: 2e2e 2e20 2020 2020 292c 0a20 2020 2020  ...     ),.     
-00046660: 2020 202e 2e2e 2029 0a0a 2020 2020 2020     ... )..      
-00046670: 2020 4765 7420 7661 7269 6162 6c65 7320    Get variables 
-00046680: 6d61 7463 6869 6e67 2061 2073 7065 6369  matching a speci
-00046690: 6669 6320 7374 616e 6461 7264 5f6e 616d  fic standard_nam
-000466a0: 653a 0a0a 2020 2020 2020 2020 3e3e 3e20  e:..        >>> 
-000466b0: 6473 2e66 696c 7465 725f 6279 5f61 7474  ds.filter_by_att
-000466c0: 7273 2873 7461 6e64 6172 645f 6e61 6d65  rs(standard_name
-000466d0: 3d22 636f 6e76 6563 7469 7665 5f70 7265  ="convective_pre
-000466e0: 6369 7069 7461 7469 6f6e 5f66 6c75 7822  cipitation_flux"
-000466f0: 290a 2020 2020 2020 2020 3c78 6172 7261  ).        <xarra
-00046700: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
-00046710: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
-00046720: 2020 2020 2020 2028 783a 2032 2c20 793a         (x: 2, y:
-00046730: 2032 2c20 7469 6d65 3a20 3329 0a20 2020   2, time: 3).   
-00046740: 2020 2020 2043 6f6f 7264 696e 6174 6573       Coordinates
-00046750: 3a0a 2020 2020 2020 2020 2020 2020 6c6f  :.            lo
-00046760: 6e20 2020 2020 2020 2020 2020 2020 2878  n             (x
-00046770: 2c20 7929 2066 6c6f 6174 3634 202d 3939  , y) float64 -99
-00046780: 2e38 3320 2d39 392e 3332 202d 3939 2e37  .83 -99.32 -99.7
-00046790: 3920 2d39 392e 3233 0a20 2020 2020 2020  9 -99.23.       
-000467a0: 2020 2020 206c 6174 2020 2020 2020 2020       lat        
-000467b0: 2020 2020 2028 782c 2079 2920 666c 6f61       (x, y) floa
-000467c0: 7436 3420 3432 2e32 3520 3432 2e32 3120  t64 42.25 42.21 
-000467d0: 3432 2e36 3320 3432 2e35 390a 2020 2020  42.63 42.59.    
-000467e0: 2020 2020 2020 2a20 7469 6d65 2020 2020        * time    
-000467f0: 2020 2020 2020 2020 2874 696d 6529 2064          (time) d
-00046800: 6174 6574 696d 6536 345b 6e73 5d20 3230  atetime64[ns] 20
-00046810: 3134 2d30 392d 3036 2032 3031 342d 3039  14-09-06 2014-09
-00046820: 2d30 3720 3230 3134 2d30 392d 3038 0a20  -07 2014-09-08. 
-00046830: 2020 2020 2020 2020 2020 2072 6566 6572             refer
-00046840: 656e 6365 5f74 696d 6520 2064 6174 6574  ence_time  datet
-00046850: 696d 6536 345b 6e73 5d20 3230 3134 2d30  ime64[ns] 2014-0
-00046860: 392d 3035 0a20 2020 2020 2020 2044 696d  9-05.        Dim
-00046870: 656e 7369 6f6e 7320 7769 7468 6f75 7420  ensions without 
-00046880: 636f 6f72 6469 6e61 7465 733a 2078 2c20  coordinates: x, 
-00046890: 790a 2020 2020 2020 2020 4461 7461 2076  y.        Data v
-000468a0: 6172 6961 626c 6573 3a0a 2020 2020 2020  ariables:.      
-000468b0: 2020 2020 2020 7072 6563 6970 6974 6174        precipitat
-000468c0: 696f 6e20 2020 2878 2c20 792c 2074 696d  ion   (x, y, tim
-000468d0: 6529 2066 6c6f 6174 3634 2035 2e36 3820  e) float64 5.68 
-000468e0: 392e 3235 3620 302e 3731 3034 202e 2e2e  9.256 0.7104 ...
-000468f0: 2037 2e39 3932 2034 2e36 3135 2037 2e38   7.992 4.615 7.8
-00046900: 3035 0a0a 2020 2020 2020 2020 4765 7420  05..        Get 
-00046910: 616c 6c20 7661 7269 6162 6c65 7320 7468  all variables th
-00046920: 6174 2068 6176 6520 6120 7374 616e 6461  at have a standa
-00046930: 7264 5f6e 616d 6520 6174 7472 6962 7574  rd_name attribut
-00046940: 653a 0a0a 2020 2020 2020 2020 3e3e 3e20  e:..        >>> 
-00046950: 7374 616e 6461 7264 5f6e 616d 6520 3d20  standard_name = 
-00046960: 6c61 6d62 6461 2076 3a20 7620 6973 206e  lambda v: v is n
-00046970: 6f74 204e 6f6e 650a 2020 2020 2020 2020  ot None.        
-00046980: 3e3e 3e20 6473 2e66 696c 7465 725f 6279  >>> ds.filter_by
-00046990: 5f61 7474 7273 2873 7461 6e64 6172 645f  _attrs(standard_
-000469a0: 6e61 6d65 3d73 7461 6e64 6172 645f 6e61  name=standard_na
-000469b0: 6d65 290a 2020 2020 2020 2020 3c78 6172  me).        <xar
-000469c0: 7261 792e 4461 7461 7365 743e 0a20 2020  ray.Dataset>.   
-000469d0: 2020 2020 2044 696d 656e 7369 6f6e 733a       Dimensions:
-000469e0: 2020 2020 2020 2020 2028 783a 2032 2c20           (x: 2, 
-000469f0: 793a 2032 2c20 7469 6d65 3a20 3329 0a20  y: 2, time: 3). 
-00046a00: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
-00046a10: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
-00046a20: 6c6f 6e20 2020 2020 2020 2020 2020 2020  lon             
-00046a30: 2878 2c20 7929 2066 6c6f 6174 3634 202d  (x, y) float64 -
-00046a40: 3939 2e38 3320 2d39 392e 3332 202d 3939  99.83 -99.32 -99
-00046a50: 2e37 3920 2d39 392e 3233 0a20 2020 2020  .79 -99.23.     
-00046a60: 2020 2020 2020 206c 6174 2020 2020 2020         lat      
-00046a70: 2020 2020 2020 2028 782c 2079 2920 666c         (x, y) fl
-00046a80: 6f61 7436 3420 3432 2e32 3520 3432 2e32  oat64 42.25 42.2
-00046a90: 3120 3432 2e36 3320 3432 2e35 390a 2020  1 42.63 42.59.  
-00046aa0: 2020 2020 2020 2020 2a20 7469 6d65 2020          * time  
-00046ab0: 2020 2020 2020 2020 2020 2874 696d 6529            (time)
-00046ac0: 2064 6174 6574 696d 6536 345b 6e73 5d20   datetime64[ns] 
-00046ad0: 3230 3134 2d30 392d 3036 2032 3031 342d  2014-09-06 2014-
-00046ae0: 3039 2d30 3720 3230 3134 2d30 392d 3038  09-07 2014-09-08
-00046af0: 0a20 2020 2020 2020 2020 2020 2072 6566  .            ref
-00046b00: 6572 656e 6365 5f74 696d 6520 2064 6174  erence_time  dat
-00046b10: 6574 696d 6536 345b 6e73 5d20 3230 3134  etime64[ns] 2014
-00046b20: 2d30 392d 3035 0a20 2020 2020 2020 2044  -09-05.        D
-00046b30: 696d 656e 7369 6f6e 7320 7769 7468 6f75  imensions withou
-00046b40: 7420 636f 6f72 6469 6e61 7465 733a 2078  t coordinates: x
-00046b50: 2c20 790a 2020 2020 2020 2020 4461 7461  , y.        Data
-00046b60: 2076 6172 6961 626c 6573 3a0a 2020 2020   variables:.    
-00046b70: 2020 2020 2020 2020 7465 6d70 6572 6174          temperat
-00046b80: 7572 6520 2020 2020 2878 2c20 792c 2074  ure     (x, y, t
-00046b90: 696d 6529 2066 6c6f 6174 3634 2032 392e  ime) float64 29.
-00046ba0: 3131 2031 382e 3220 3232 2e38 3320 2e2e  11 18.2 22.83 ..
-00046bb0: 2e20 3138 2e32 3820 3136 2e31 3520 3236  . 18.28 16.15 26
-00046bc0: 2e36 330a 2020 2020 2020 2020 2020 2020  .63.            
-00046bd0: 7072 6563 6970 6974 6174 696f 6e20 2020  precipitation   
-00046be0: 2878 2c20 792c 2074 696d 6529 2066 6c6f  (x, y, time) flo
-00046bf0: 6174 3634 2035 2e36 3820 392e 3235 3620  at64 5.68 9.256 
-00046c00: 302e 3731 3034 202e 2e2e 2037 2e39 3932  0.7104 ... 7.992
-00046c10: 2034 2e36 3135 2037 2e38 3035 0a0a 2020   4.615 7.805..  
-00046c20: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00046c30: 2020 7365 6c65 6374 696f 6e20 3d20 5b5d    selection = []
-00046c40: 0a20 2020 2020 2020 2066 6f72 2076 6172  .        for var
-00046c50: 5f6e 616d 652c 2076 6172 6961 626c 6520  _name, variable 
-00046c60: 696e 2073 656c 662e 7661 7269 6162 6c65  in self.variable
-00046c70: 732e 6974 656d 7328 293a 0a20 2020 2020  s.items():.     
-00046c80: 2020 2020 2020 2068 6173 5f76 616c 7565         has_value
-00046c90: 5f66 6c61 6720 3d20 4661 6c73 650a 2020  _flag = False.  
-00046ca0: 2020 2020 2020 2020 2020 666f 7220 6174            for at
-00046cb0: 7472 5f6e 616d 652c 2070 6174 7465 726e  tr_name, pattern
-00046cc0: 2069 6e20 6b77 6172 6773 2e69 7465 6d73   in kwargs.items
-00046cd0: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
-00046ce0: 2020 2020 6174 7472 5f76 616c 7565 203d      attr_value =
-00046cf0: 2076 6172 6961 626c 652e 6174 7472 732e   variable.attrs.
-00046d00: 6765 7428 6174 7472 5f6e 616d 6529 0a20  get(attr_name). 
-00046d10: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00046d20: 6620 2863 616c 6c61 626c 6528 7061 7474  f (callable(patt
-00046d30: 6572 6e29 2061 6e64 2070 6174 7465 726e  ern) and pattern
-00046d40: 2861 7474 725f 7661 6c75 6529 2920 6f72  (attr_value)) or
-00046d50: 2061 7474 725f 7661 6c75 6520 3d3d 2070   attr_value == p
-00046d60: 6174 7465 726e 3a0a 2020 2020 2020 2020  attern:.        
-00046d70: 2020 2020 2020 2020 2020 2020 6861 735f              has_
-00046d80: 7661 6c75 655f 666c 6167 203d 2054 7275  value_flag = Tru
-00046d90: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00046da0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-00046db0: 2020 2020 2020 2020 2020 2020 6861 735f              has_
-00046dc0: 7661 6c75 655f 666c 6167 203d 2046 616c  value_flag = Fal
-00046dd0: 7365 0a20 2020 2020 2020 2020 2020 2020  se.             
-00046de0: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
-00046df0: 2020 2020 2020 2020 2069 6620 6861 735f           if has_
-00046e00: 7661 6c75 655f 666c 6167 2069 7320 5472  value_flag is Tr
-00046e10: 7565 3a0a 2020 2020 2020 2020 2020 2020  ue:.            
-00046e20: 2020 2020 7365 6c65 6374 696f 6e2e 6170      selection.ap
-00046e30: 7065 6e64 2876 6172 5f6e 616d 6529 0a20  pend(var_name). 
-00046e40: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00046e50: 6c66 5b73 656c 6563 7469 6f6e 5d0a 0a20  lf[selection].. 
-00046e60: 2020 2064 6566 2075 6e69 6679 5f63 6875     def unify_chu
-00046e70: 6e6b 7328 7365 6c66 3a20 545f 4461 7461  nks(self: T_Data
-00046e80: 7365 7429 202d 3e20 545f 4461 7461 7365  set) -> T_Datase
-00046e90: 743a 0a20 2020 2020 2020 2022 2222 556e  t:.        """Un
-00046ea0: 6966 7920 6368 756e 6b20 7369 7a65 2061  ify chunk size a
-00046eb0: 6c6f 6e67 2061 6c6c 2063 6875 6e6b 6564  long all chunked
-00046ec0: 2064 696d 656e 7369 6f6e 7320 6f66 2074   dimensions of t
-00046ed0: 6869 7320 4461 7461 7365 742e 0a0a 2020  his Dataset...  
-00046ee0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
-00046ef0: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
-00046f00: 2020 2020 2020 4461 7461 7365 7420 7769        Dataset wi
-00046f10: 7468 2063 6f6e 7369 7374 656e 7420 6368  th consistent ch
-00046f20: 756e 6b20 7369 7a65 7320 666f 7220 616c  unk sizes for al
-00046f30: 6c20 6461 736b 2d61 7272 6179 2076 6172  l dask-array var
-00046f40: 6961 626c 6573 0a0a 2020 2020 2020 2020  iables..        
-00046f50: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-00046f60: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-00046f70: 2020 6461 736b 2e61 7272 6179 2e63 6f72    dask.array.cor
-00046f80: 652e 756e 6966 795f 6368 756e 6b73 0a20  e.unify_chunks. 
-00046f90: 2020 2020 2020 2022 2222 0a0a 2020 2020         """..    
-00046fa0: 2020 2020 7265 7475 726e 2075 6e69 6679      return unify
-00046fb0: 5f63 6875 6e6b 7328 7365 6c66 295b 305d  _chunks(self)[0]
-00046fc0: 0a0a 2020 2020 6465 6620 6d61 705f 626c  ..    def map_bl
-00046fd0: 6f63 6b73 280a 2020 2020 2020 2020 7365  ocks(.        se
-00046fe0: 6c66 2c0a 2020 2020 2020 2020 6675 6e63  lf,.        func
-00046ff0: 3a20 4361 6c6c 6162 6c65 5b2e 2e2e 2c20  : Callable[..., 
-00047000: 545f 5861 7272 6179 5d2c 0a20 2020 2020  T_Xarray],.     
-00047010: 2020 2061 7267 733a 2053 6571 7565 6e63     args: Sequenc
-00047020: 655b 416e 795d 203d 2028 292c 0a20 2020  e[Any] = (),.   
-00047030: 2020 2020 206b 7761 7267 733a 204d 6170       kwargs: Map
-00047040: 7069 6e67 5b73 7472 2c20 416e 795d 207c  ping[str, Any] |
-00047050: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-00047060: 2020 2020 2020 7465 6d70 6c61 7465 3a20        template: 
-00047070: 4461 7461 4172 7261 7920 7c20 4461 7461  DataArray | Data
-00047080: 7365 7420 7c20 4e6f 6e65 203d 204e 6f6e  set | None = Non
-00047090: 652c 0a20 2020 2029 202d 3e20 545f 5861  e,.    ) -> T_Xa
-000470a0: 7272 6179 3a0a 2020 2020 2020 2020 2222  rray:.        ""
-000470b0: 220a 2020 2020 2020 2020 4170 706c 7920  ".        Apply 
-000470c0: 6120 6675 6e63 7469 6f6e 2074 6f20 6561  a function to ea
-000470d0: 6368 2062 6c6f 636b 206f 6620 7468 6973  ch block of this
-000470e0: 2044 6174 6173 6574 2e0a 0a20 2020 2020   Dataset...     
-000470f0: 2020 202e 2e20 7761 726e 696e 673a 3a0a     .. warning::.
-00047100: 2020 2020 2020 2020 2020 2020 5468 6973              This
-00047110: 206d 6574 686f 6420 6973 2065 7870 6572   method is exper
-00047120: 696d 656e 7461 6c20 616e 6420 6974 7320  imental and its 
-00047130: 7369 676e 6174 7572 6520 6d61 7920 6368  signature may ch
-00047140: 616e 6765 2e0a 0a20 2020 2020 2020 2050  ange...        P
-00047150: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
-00047160: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
-00047170: 2020 2020 2066 756e 6320 3a20 6361 6c6c       func : call
-00047180: 6162 6c65 0a20 2020 2020 2020 2020 2020  able.           
-00047190: 2055 7365 722d 7072 6f76 6964 6564 2066   User-provided f
-000471a0: 756e 6374 696f 6e20 7468 6174 2061 6363  unction that acc
-000471b0: 6570 7473 2061 2044 6174 6173 6574 2061  epts a Dataset a
-000471c0: 7320 6974 7320 6669 7273 740a 2020 2020  s its first.    
-000471d0: 2020 2020 2020 2020 7061 7261 6d65 7465          paramete
-000471e0: 722e 2054 6865 2066 756e 6374 696f 6e20  r. The function 
-000471f0: 7769 6c6c 2072 6563 6569 7665 2061 2073  will receive a s
-00047200: 7562 7365 7420 6f72 2027 626c 6f63 6b27  ubset or 'block'
-00047210: 206f 6620 7468 6973 2044 6174 6173 6574   of this Dataset
-00047220: 2028 7365 6520 6265 6c6f 7729 2c0a 2020   (see below),.  
-00047230: 2020 2020 2020 2020 2020 636f 7272 6573            corres
-00047240: 706f 6e64 696e 6720 746f 206f 6e65 2063  ponding to one c
-00047250: 6875 6e6b 2061 6c6f 6e67 2065 6163 6820  hunk along each 
-00047260: 6368 756e 6b65 6420 6469 6d65 6e73 696f  chunked dimensio
-00047270: 6e2e 2060 6066 756e 6360 6020 7769 6c6c  n. ``func`` will
-00047280: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
-00047290: 6578 6563 7574 6564 2061 7320 6060 6675  executed as ``fu
-000472a0: 6e63 2873 7562 7365 745f 6461 7461 7365  nc(subset_datase
-000472b0: 742c 202a 7375 6273 6574 5f61 7267 732c  t, *subset_args,
-000472c0: 202a 2a6b 7761 7267 7329 6060 2e0a 0a20   **kwargs)``... 
-000472d0: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-000472e0: 6675 6e63 7469 6f6e 206d 7573 7420 7265  function must re
-000472f0: 7475 726e 2065 6974 6865 7220 6120 7369  turn either a si
-00047300: 6e67 6c65 2044 6174 6141 7272 6179 206f  ngle DataArray o
-00047310: 7220 6120 7369 6e67 6c65 2044 6174 6173  r a single Datas
-00047320: 6574 2e0a 0a20 2020 2020 2020 2020 2020  et...           
-00047330: 2054 6869 7320 6675 6e63 7469 6f6e 2063   This function c
-00047340: 616e 6e6f 7420 6164 6420 6120 6e65 7720  annot add a new 
-00047350: 6368 756e 6b65 6420 6469 6d65 6e73 696f  chunked dimensio
-00047360: 6e2e 0a20 2020 2020 2020 2061 7267 7320  n..        args 
-00047370: 3a20 7365 7175 656e 6365 0a20 2020 2020  : sequence.     
-00047380: 2020 2020 2020 2050 6173 7365 6420 746f         Passed to
-00047390: 2066 756e 6320 6166 7465 7220 756e 7061   func after unpa
-000473a0: 636b 696e 6720 616e 6420 7375 6273 6574  cking and subset
-000473b0: 7469 6e67 2061 6e79 2078 6172 7261 7920  ting any xarray 
-000473c0: 6f62 6a65 6374 7320 6279 2062 6c6f 636b  objects by block
-000473d0: 732e 0a20 2020 2020 2020 2020 2020 2078  s..            x
-000473e0: 6172 7261 7920 6f62 6a65 6374 7320 696e  array objects in
-000473f0: 2061 7267 7320 6d75 7374 2062 6520 616c   args must be al
-00047400: 6967 6e65 6420 7769 7468 206f 626a 2c20  igned with obj, 
-00047410: 6f74 6865 7277 6973 6520 616e 2065 7272  otherwise an err
-00047420: 6f72 2069 7320 7261 6973 6564 2e0a 2020  or is raised..  
-00047430: 2020 2020 2020 6b77 6172 6773 203a 204d        kwargs : M
-00047440: 6170 7069 6e67 206f 7220 4e6f 6e65 0a20  apping or None. 
-00047450: 2020 2020 2020 2020 2020 2050 6173 7365             Passe
-00047460: 6420 7665 7262 6174 696d 2074 6f20 6675  d verbatim to fu
-00047470: 6e63 2061 6674 6572 2075 6e70 6163 6b69  nc after unpacki
-00047480: 6e67 2e20 7861 7272 6179 206f 626a 6563  ng. xarray objec
-00047490: 7473 2c20 6966 2061 6e79 2c20 7769 6c6c  ts, if any, will
-000474a0: 206e 6f74 2062 650a 2020 2020 2020 2020   not be.        
-000474b0: 2020 2020 7375 6273 6574 2074 6f20 626c      subset to bl
-000474c0: 6f63 6b73 2e20 5061 7373 696e 6720 6461  ocks. Passing da
-000474d0: 736b 2063 6f6c 6c65 6374 696f 6e73 2069  sk collections i
-000474e0: 6e20 6b77 6172 6773 2069 7320 6e6f 7420  n kwargs is not 
-000474f0: 616c 6c6f 7765 642e 0a20 2020 2020 2020  allowed..       
-00047500: 2074 656d 706c 6174 6520 3a20 4461 7461   template : Data
-00047510: 4172 7261 792c 2044 6174 6173 6574 206f  Array, Dataset o
-00047520: 7220 4e6f 6e65 2c20 6f70 7469 6f6e 616c  r None, optional
-00047530: 0a20 2020 2020 2020 2020 2020 2078 6172  .            xar
-00047540: 7261 7920 6f62 6a65 6374 2072 6570 7265  ray object repre
-00047550: 7365 6e74 696e 6720 7468 6520 6669 6e61  senting the fina
-00047560: 6c20 7265 7375 6c74 2061 6674 6572 2063  l result after c
-00047570: 6f6d 7075 7465 2069 7320 6361 6c6c 6564  ompute is called
-00047580: 2e20 4966 206e 6f74 2070 726f 7669 6465  . If not provide
-00047590: 642c 0a20 2020 2020 2020 2020 2020 2074  d,.            t
-000475a0: 6865 2066 756e 6374 696f 6e20 7769 6c6c  he function will
-000475b0: 2062 6520 6669 7273 7420 7275 6e20 6f6e   be first run on
-000475c0: 206d 6f63 6b65 642d 7570 2064 6174 612c   mocked-up data,
-000475d0: 2074 6861 7420 6c6f 6f6b 7320 6c69 6b65   that looks like
-000475e0: 2074 6869 7320 6f62 6a65 6374 2062 7574   this object but
-000475f0: 0a20 2020 2020 2020 2020 2020 2068 6173  .            has
-00047600: 2073 697a 6573 2030 2c20 746f 2064 6574   sizes 0, to det
-00047610: 6572 6d69 6e65 2070 726f 7065 7274 6965  ermine propertie
-00047620: 7320 6f66 2074 6865 2072 6574 7572 6e65  s of the returne
-00047630: 6420 6f62 6a65 6374 2073 7563 6820 6173  d object such as
-00047640: 2064 7479 7065 2c0a 2020 2020 2020 2020   dtype,.        
-00047650: 2020 2020 7661 7269 6162 6c65 206e 616d      variable nam
-00047660: 6573 2c20 6174 7472 6962 7574 6573 2c20  es, attributes, 
-00047670: 6e65 7720 6469 6d65 6e73 696f 6e73 2061  new dimensions a
-00047680: 6e64 206e 6577 2069 6e64 6578 6573 2028  nd new indexes (
-00047690: 6966 2061 6e79 292e 0a20 2020 2020 2020  if any)..       
-000476a0: 2020 2020 2060 6074 656d 706c 6174 6560       ``template`
-000476b0: 6020 6d75 7374 2062 6520 7072 6f76 6964  ` must be provid
-000476c0: 6564 2069 6620 7468 6520 6675 6e63 7469  ed if the functi
-000476d0: 6f6e 2063 6861 6e67 6573 2074 6865 2073  on changes the s
-000476e0: 697a 6520 6f66 2065 7869 7374 696e 6720  ize of existing 
-000476f0: 6469 6d65 6e73 696f 6e73 2e0a 2020 2020  dimensions..    
-00047700: 2020 2020 2020 2020 5768 656e 2070 726f          When pro
-00047710: 7669 6465 642c 2060 6061 7474 7273 6060  vided, ``attrs``
-00047720: 206f 6e20 7661 7269 6162 6c65 7320 696e   on variables in
-00047730: 2060 7465 6d70 6c61 7465 6020 6172 6520   `template` are 
-00047740: 636f 7069 6564 206f 7665 7220 746f 2074  copied over to t
-00047750: 6865 2072 6573 756c 742e 2041 6e79 0a20  he result. Any. 
-00047760: 2020 2020 2020 2020 2020 2060 6061 7474             ``att
-00047770: 7273 6060 2073 6574 2062 7920 6060 6675  rs`` set by ``fu
-00047780: 6e63 6060 2077 696c 6c20 6265 2069 676e  nc`` will be ign
-00047790: 6f72 6564 2e0a 0a20 2020 2020 2020 2052  ored...        R
-000477a0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-000477b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2041  ------.        A
-000477c0: 2073 696e 676c 6520 4461 7461 4172 7261   single DataArra
-000477d0: 7920 6f72 2044 6174 6173 6574 2077 6974  y or Dataset wit
-000477e0: 6820 6461 736b 2062 6163 6b65 6e64 2c20  h dask backend, 
-000477f0: 7265 6173 7365 6d62 6c65 6420 6672 6f6d  reassembled from
-00047800: 2074 6865 206f 7574 7075 7473 206f 6620   the outputs of 
-00047810: 7468 650a 2020 2020 2020 2020 6675 6e63  the.        func
-00047820: 7469 6f6e 2e0a 0a20 2020 2020 2020 204e  tion...        N
-00047830: 6f74 6573 0a20 2020 2020 2020 202d 2d2d  otes.        ---
-00047840: 2d2d 0a20 2020 2020 2020 2054 6869 7320  --.        This 
-00047850: 6675 6e63 7469 6f6e 2069 7320 6465 7369  function is desi
-00047860: 676e 6564 2066 6f72 2077 6865 6e20 6060  gned for when ``
-00047870: 6675 6e63 6060 206e 6565 6473 2074 6f20  func`` needs to 
-00047880: 6d61 6e69 7075 6c61 7465 2061 2077 686f  manipulate a who
-00047890: 6c65 2078 6172 7261 7920 6f62 6a65 6374  le xarray object
-000478a0: 0a20 2020 2020 2020 2073 7562 7365 7420  .        subset 
-000478b0: 746f 2065 6163 6820 626c 6f63 6b2e 2045  to each block. E
-000478c0: 6163 6820 626c 6f63 6b20 6973 206c 6f61  ach block is loa
-000478d0: 6465 6420 696e 746f 206d 656d 6f72 792e  ded into memory.
-000478e0: 2049 6e20 7468 6520 6d6f 7265 2063 6f6d   In the more com
-000478f0: 6d6f 6e20 6361 7365 2077 6865 7265 0a20  mon case where. 
-00047900: 2020 2020 2020 2060 6066 756e 6360 6020         ``func`` 
-00047910: 6361 6e20 776f 726b 206f 6e20 6e75 6d70  can work on nump
-00047920: 7920 6172 7261 7973 2c20 6974 2069 7320  y arrays, it is 
-00047930: 7265 636f 6d6d 656e 6465 6420 746f 2075  recommended to u
-00047940: 7365 2060 6061 7070 6c79 5f75 6675 6e63  se ``apply_ufunc
-00047950: 6060 2e0a 0a20 2020 2020 2020 2049 6620  ``...        If 
-00047960: 6e6f 6e65 206f 6620 7468 6520 7661 7269  none of the vari
-00047970: 6162 6c65 7320 696e 2074 6869 7320 6f62  ables in this ob
-00047980: 6a65 6374 2069 7320 6261 636b 6564 2062  ject is backed b
-00047990: 7920 6461 736b 2061 7272 6179 732c 2063  y dask arrays, c
-000479a0: 616c 6c69 6e67 2074 6869 7320 6675 6e63  alling this func
-000479b0: 7469 6f6e 2069 730a 2020 2020 2020 2020  tion is.        
-000479c0: 6571 7569 7661 6c65 6e74 2074 6f20 6361  equivalent to ca
-000479d0: 6c6c 696e 6720 6060 6675 6e63 286f 626a  lling ``func(obj
-000479e0: 2c20 2a61 7267 732c 202a 2a6b 7761 7267  , *args, **kwarg
-000479f0: 7329 6060 2e0a 0a20 2020 2020 2020 2053  s)``...        S
-00047a00: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-00047a10: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00047a20: 2064 6173 6b2e 6172 7261 792e 6d61 705f   dask.array.map_
-00047a30: 626c 6f63 6b73 2c20 7861 7272 6179 2e61  blocks, xarray.a
-00047a40: 7070 6c79 5f75 6675 6e63 2c20 7861 7272  pply_ufunc, xarr
-00047a50: 6179 2e44 6174 6173 6574 2e6d 6170 5f62  ay.Dataset.map_b
-00047a60: 6c6f 636b 730a 2020 2020 2020 2020 7861  locks.        xa
-00047a70: 7272 6179 2e44 6174 6141 7272 6179 2e6d  rray.DataArray.m
-00047a80: 6170 5f62 6c6f 636b 730a 0a20 2020 2020  ap_blocks..     
-00047a90: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
-00047aa0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-00047ab0: 2020 2020 2043 616c 6375 6c61 7465 2061       Calculate a
-00047ac0: 6e20 616e 6f6d 616c 7920 6672 6f6d 2063  n anomaly from c
-00047ad0: 6c69 6d61 746f 6c6f 6779 2075 7369 6e67  limatology using
-00047ae0: 2060 602e 6772 6f75 7062 7928 2960 602e   ``.groupby()``.
-00047af0: 2055 7369 6e67 0a20 2020 2020 2020 2060   Using.        `
-00047b00: 6078 722e 6d61 705f 626c 6f63 6b73 2829  `xr.map_blocks()
-00047b10: 6060 2061 6c6c 6f77 7320 666f 7220 7061  `` allows for pa
-00047b20: 7261 6c6c 656c 206f 7065 7261 7469 6f6e  rallel operation
-00047b30: 7320 7769 7468 206b 6e6f 776c 6564 6765  s with knowledge
-00047b40: 206f 6620 6060 7861 7272 6179 6060 2c0a   of ``xarray``,.
-00047b50: 2020 2020 2020 2020 6974 7320 696e 6469          its indi
-00047b60: 6365 732c 2061 6e64 2069 7473 206d 6574  ces, and its met
-00047b70: 686f 6473 206c 696b 6520 6060 2e67 726f  hods like ``.gro
-00047b80: 7570 6279 2829 6060 2e0a 0a20 2020 2020  upby()``...     
-00047b90: 2020 203e 3e3e 2064 6566 2063 616c 6375     >>> def calcu
-00047ba0: 6c61 7465 5f61 6e6f 6d61 6c79 2864 612c  late_anomaly(da,
-00047bb0: 2067 726f 7570 6279 5f74 7970 653d 2274   groupby_type="t
-00047bc0: 696d 652e 6d6f 6e74 6822 293a 0a20 2020  ime.month"):.   
-00047bd0: 2020 2020 202e 2e2e 2020 2020 2067 6220       ...     gb 
-00047be0: 3d20 6461 2e67 726f 7570 6279 2867 726f  = da.groupby(gro
-00047bf0: 7570 6279 5f74 7970 6529 0a20 2020 2020  upby_type).     
-00047c00: 2020 202e 2e2e 2020 2020 2063 6c69 6d20     ...     clim 
-00047c10: 3d20 6762 2e6d 6561 6e28 6469 6d3d 2274  = gb.mean(dim="t
-00047c20: 696d 6522 290a 2020 2020 2020 2020 2e2e  ime").        ..
-00047c30: 2e20 2020 2020 7265 7475 726e 2067 6220  .     return gb 
-00047c40: 2d20 636c 696d 0a20 2020 2020 2020 202e  - clim.        .
-00047c50: 2e2e 0a20 2020 2020 2020 203e 3e3e 2074  ...        >>> t
-00047c60: 696d 6520 3d20 7872 2e63 6674 696d 655f  ime = xr.cftime_
-00047c70: 7261 6e67 6528 2231 3939 302d 3031 222c  range("1990-01",
-00047c80: 2022 3139 3932 2d30 3122 2c20 6672 6571   "1992-01", freq
-00047c90: 3d22 4d22 290a 2020 2020 2020 2020 3e3e  ="M").        >>
-00047ca0: 3e20 6d6f 6e74 6820 3d20 7872 2e44 6174  > month = xr.Dat
-00047cb0: 6141 7272 6179 2874 696d 652e 6d6f 6e74  aArray(time.mont
-00047cc0: 682c 2063 6f6f 7264 733d 7b22 7469 6d65  h, coords={"time
-00047cd0: 223a 2074 696d 657d 2c20 6469 6d73 3d5b  ": time}, dims=[
-00047ce0: 2274 696d 6522 5d29 0a20 2020 2020 2020  "time"]).       
-00047cf0: 203e 3e3e 206e 702e 7261 6e64 6f6d 2e73   >>> np.random.s
-00047d00: 6565 6428 3132 3329 0a20 2020 2020 2020  eed(123).       
-00047d10: 203e 3e3e 2061 7272 6179 203d 2078 722e   >>> array = xr.
-00047d20: 4461 7461 4172 7261 7928 0a20 2020 2020  DataArray(.     
-00047d30: 2020 202e 2e2e 2020 2020 206e 702e 7261     ...     np.ra
-00047d40: 6e64 6f6d 2e72 616e 6428 6c65 6e28 7469  ndom.rand(len(ti
-00047d50: 6d65 2929 2c0a 2020 2020 2020 2020 2e2e  me)),.        ..
-00047d60: 2e20 2020 2020 6469 6d73 3d5b 2274 696d  .     dims=["tim
-00047d70: 6522 5d2c 0a20 2020 2020 2020 202e 2e2e  e"],.        ...
-00047d80: 2020 2020 2063 6f6f 7264 733d 7b22 7469       coords={"ti
-00047d90: 6d65 223a 2074 696d 652c 2022 6d6f 6e74  me": time, "mont
-00047da0: 6822 3a20 6d6f 6e74 687d 2c0a 2020 2020  h": month},.    
-00047db0: 2020 2020 2e2e 2e20 292e 6368 756e 6b28      ... ).chunk(
-00047dc0: 290a 2020 2020 2020 2020 3e3e 3e20 6473  ).        >>> ds
-00047dd0: 203d 2078 722e 4461 7461 7365 7428 7b22   = xr.Dataset({"
-00047de0: 6122 3a20 6172 7261 797d 290a 2020 2020  a": array}).    
-00047df0: 2020 2020 3e3e 3e20 6473 2e6d 6170 5f62      >>> ds.map_b
-00047e00: 6c6f 636b 7328 6361 6c63 756c 6174 655f  locks(calculate_
-00047e10: 616e 6f6d 616c 792c 2074 656d 706c 6174  anomaly, templat
-00047e20: 653d 6473 292e 636f 6d70 7574 6528 290a  e=ds).compute().
-00047e30: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
-00047e40: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
-00047e50: 2044 696d 656e 7369 6f6e 733a 2020 2874   Dimensions:  (t
-00047e60: 696d 653a 2032 3429 0a20 2020 2020 2020  ime: 24).       
-00047e70: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
-00047e80: 2020 2020 2020 2020 2a20 7469 6d65 2020          * time  
-00047e90: 2020 2028 7469 6d65 2920 6f62 6a65 6374     (time) object
-00047ea0: 2031 3939 302d 3031 2d33 3120 3030 3a30   1990-01-31 00:0
-00047eb0: 303a 3030 202e 2e2e 2031 3939 312d 3132  0:00 ... 1991-12
-00047ec0: 2d33 3120 3030 3a30 303a 3030 0a20 2020  -31 00:00:00.   
-00047ed0: 2020 2020 2020 2020 206d 6f6e 7468 2020           month  
-00047ee0: 2020 2874 696d 6529 2069 6e74 3634 2031    (time) int64 1
-00047ef0: 2032 2033 2034 2035 2036 2037 2038 2039   2 3 4 5 6 7 8 9
-00047f00: 2031 3020 3131 2031 3220 3120 3220 3320   10 11 12 1 2 3 
-00047f10: 3420 3520 3620 3720 3820 3920 3130 2031  4 5 6 7 8 9 10 1
-00047f20: 3120 3132 0a20 2020 2020 2020 2044 6174  1 12.        Dat
-00047f30: 6120 7661 7269 6162 6c65 733a 0a20 2020  a variables:.   
-00047f40: 2020 2020 2020 2020 2061 2020 2020 2020           a      
-00047f50: 2020 2874 696d 6529 2066 6c6f 6174 3634    (time) float64
-00047f60: 2030 2e31 3238 3920 302e 3131 3332 202d   0.1289 0.1132 -
-00047f70: 302e 3038 3536 202e 2e2e 2030 2e32 3238  0.0856 ... 0.228
-00047f80: 3720 302e 3139 3036 202d 302e 3035 3930  7 0.1906 -0.0590
-00047f90: 310a 0a20 2020 2020 2020 204e 6f74 6520  1..        Note 
-00047fa0: 7468 6174 206f 6e65 206d 7573 7420 6578  that one must ex
-00047fb0: 706c 6963 6974 6c79 2075 7365 2060 6061  plicitly use ``a
-00047fc0: 7267 733d 5b5d 6060 2061 6e64 2060 606b  rgs=[]`` and ``k
-00047fd0: 7761 7267 733d 7b7d 6060 2074 6f20 7061  wargs={}`` to pa
-00047fe0: 7373 2061 7267 756d 656e 7473 0a20 2020  ss arguments.   
-00047ff0: 2020 2020 2074 6f20 7468 6520 6675 6e63       to the func
-00048000: 7469 6f6e 2062 6569 6e67 2061 7070 6c69  tion being appli
-00048010: 6564 2069 6e20 6060 7872 2e6d 6170 5f62  ed in ``xr.map_b
-00048020: 6c6f 636b 7328 2960 603a 0a0a 2020 2020  locks()``:..    
-00048030: 2020 2020 3e3e 3e20 6473 2e6d 6170 5f62      >>> ds.map_b
-00048040: 6c6f 636b 7328 0a20 2020 2020 2020 202e  locks(.        .
-00048050: 2e2e 2020 2020 2063 616c 6375 6c61 7465  ..     calculate
-00048060: 5f61 6e6f 6d61 6c79 2c0a 2020 2020 2020  _anomaly,.      
-00048070: 2020 2e2e 2e20 2020 2020 6b77 6172 6773    ...     kwargs
-00048080: 3d7b 2267 726f 7570 6279 5f74 7970 6522  ={"groupby_type"
-00048090: 3a20 2274 696d 652e 7965 6172 227d 2c0a  : "time.year"},.
-000480a0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-000480b0: 7465 6d70 6c61 7465 3d64 732c 0a20 2020  template=ds,.   
-000480c0: 2020 2020 202e 2e2e 2029 0a20 2020 2020       ... ).     
-000480d0: 2020 203c 7861 7272 6179 2e44 6174 6173     <xarray.Datas
-000480e0: 6574 3e0a 2020 2020 2020 2020 4469 6d65  et>.        Dime
-000480f0: 6e73 696f 6e73 3a20 2028 7469 6d65 3a20  nsions:  (time: 
-00048100: 3234 290a 2020 2020 2020 2020 436f 6f72  24).        Coor
-00048110: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
-00048120: 2020 202a 2074 696d 6520 2020 2020 2874     * time     (t
-00048130: 696d 6529 206f 626a 6563 7420 3139 3930  ime) object 1990
-00048140: 2d30 312d 3331 2030 303a 3030 3a30 3020  -01-31 00:00:00 
-00048150: 2e2e 2e20 3139 3931 2d31 322d 3331 2030  ... 1991-12-31 0
-00048160: 303a 3030 3a30 300a 2020 2020 2020 2020  0:00:00.        
-00048170: 2020 2020 6d6f 6e74 6820 2020 2028 7469      month    (ti
-00048180: 6d65 2920 696e 7436 3420 6461 736b 2e61  me) int64 dask.a
-00048190: 7272 6179 3c63 6875 6e6b 7369 7a65 3d28  rray<chunksize=(
-000481a0: 3234 2c29 2c20 6d65 7461 3d6e 702e 6e64  24,), meta=np.nd
-000481b0: 6172 7261 793e 0a20 2020 2020 2020 2044  array>.        D
-000481c0: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
-000481d0: 2020 2020 2020 2020 2020 2061 2020 2020             a    
-000481e0: 2020 2020 2874 696d 6529 2066 6c6f 6174      (time) float
-000481f0: 3634 2064 6173 6b2e 6172 7261 793c 6368  64 dask.array<ch
-00048200: 756e 6b73 697a 653d 2832 342c 292c 206d  unksize=(24,), m
-00048210: 6574 613d 6e70 2e6e 6461 7272 6179 3e0a  eta=np.ndarray>.
-00048220: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00048230: 2020 2020 6672 6f6d 2078 6172 7261 792e      from xarray.
-00048240: 636f 7265 2e70 6172 616c 6c65 6c20 696d  core.parallel im
-00048250: 706f 7274 206d 6170 5f62 6c6f 636b 730a  port map_blocks.
-00048260: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00048270: 6d61 705f 626c 6f63 6b73 2866 756e 632c  map_blocks(func,
-00048280: 2073 656c 662c 2061 7267 732c 206b 7761   self, args, kwa
-00048290: 7267 732c 2074 656d 706c 6174 6529 0a0a  rgs, template)..
-000482a0: 2020 2020 6465 6620 706f 6c79 6669 7428      def polyfit(
-000482b0: 0a20 2020 2020 2020 2073 656c 663a 2054  .        self: T
-000482c0: 5f44 6174 6173 6574 2c0a 2020 2020 2020  _Dataset,.      
-000482d0: 2020 6469 6d3a 2048 6173 6861 626c 652c    dim: Hashable,
-000482e0: 0a20 2020 2020 2020 2064 6567 3a20 696e  .        deg: in
-000482f0: 742c 0a20 2020 2020 2020 2073 6b69 706e  t,.        skipn
-00048300: 613a 2062 6f6f 6c20 7c20 4e6f 6e65 203d  a: bool | None =
-00048310: 204e 6f6e 652c 0a20 2020 2020 2020 2072   None,.        r
-00048320: 636f 6e64 3a20 666c 6f61 7420 7c20 4e6f  cond: float | No
-00048330: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
-00048340: 2020 2077 3a20 4861 7368 6162 6c65 207c     w: Hashable |
-00048350: 2041 6e79 203d 204e 6f6e 652c 0a20 2020   Any = None,.   
-00048360: 2020 2020 2066 756c 6c3a 2062 6f6f 6c20       full: bool 
-00048370: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
-00048380: 2063 6f76 3a20 626f 6f6c 207c 204c 6974   cov: bool | Lit
-00048390: 6572 616c 5b22 756e 7363 616c 6564 225d  eral["unscaled"]
-000483a0: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
-000483b0: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-000483c0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-000483d0: 2020 4c65 6173 7420 7371 7561 7265 7320    Least squares 
-000483e0: 706f 6c79 6e6f 6d69 616c 2066 6974 2e0a  polynomial fit..
-000483f0: 0a20 2020 2020 2020 2054 6869 7320 7265  .        This re
-00048400: 706c 6963 6174 6573 2074 6865 2062 6568  plicates the beh
-00048410: 6176 696f 7572 206f 6620 606e 756d 7079  aviour of `numpy
-00048420: 2e70 6f6c 7966 6974 6020 6275 7420 6469  .polyfit` but di
-00048430: 6666 6572 7320 6279 2073 6b69 7070 696e  ffers by skippin
-00048440: 670a 2020 2020 2020 2020 696e 7661 6c69  g.        invali
-00048450: 6420 7661 6c75 6573 2077 6865 6e20 6073  d values when `s
-00048460: 6b69 706e 6120 3d20 5472 7565 602e 0a0a  kipna = True`...
-00048470: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00048480: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-00048490: 2d2d 2d2d 2d0a 2020 2020 2020 2020 6469  -----.        di
-000484a0: 6d20 3a20 6861 7368 6162 6c65 0a20 2020  m : hashable.   
-000484b0: 2020 2020 2020 2020 2043 6f6f 7264 696e           Coordin
-000484c0: 6174 6520 616c 6f6e 6720 7768 6963 6820  ate along which 
-000484d0: 746f 2066 6974 2074 6865 2070 6f6c 796e  to fit the polyn
-000484e0: 6f6d 6961 6c73 2e0a 2020 2020 2020 2020  omials..        
-000484f0: 6465 6720 3a20 696e 740a 2020 2020 2020  deg : int.      
-00048500: 2020 2020 2020 4465 6772 6565 206f 6620        Degree of 
-00048510: 7468 6520 6669 7474 696e 6720 706f 6c79  the fitting poly
-00048520: 6e6f 6d69 616c 2e0a 2020 2020 2020 2020  nomial..        
-00048530: 736b 6970 6e61 203a 2062 6f6f 6c20 6f72  skipna : bool or
-00048540: 204e 6f6e 652c 206f 7074 696f 6e61 6c0a   None, optional.
-00048550: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-00048560: 7275 652c 2072 656d 6f76 6573 2061 6c6c  rue, removes all
-00048570: 2069 6e76 616c 6964 2076 616c 7565 7320   invalid values 
-00048580: 6265 666f 7265 2066 6974 7469 6e67 2065  before fitting e
-00048590: 6163 6820 3144 2073 6c69 6365 7320 6f66  ach 1D slices of
-000485a0: 2074 6865 2061 7272 6179 2e0a 2020 2020   the array..    
-000485b0: 2020 2020 2020 2020 4465 6661 756c 7420          Default 
-000485c0: 6973 2054 7275 6520 6966 2064 6174 6120  is True if data 
-000485d0: 6973 2073 746f 7265 6420 696e 2061 2064  is stored in a d
-000485e0: 6173 6b2e 6172 7261 7920 6f72 2069 6620  ask.array or if 
-000485f0: 7468 6572 6520 6973 2061 6e79 0a20 2020  there is any.   
-00048600: 2020 2020 2020 2020 2069 6e76 616c 6964           invalid
-00048610: 2076 616c 7565 732c 2046 616c 7365 206f   values, False o
-00048620: 7468 6572 7769 7365 2e0a 2020 2020 2020  therwise..      
-00048630: 2020 7263 6f6e 6420 3a20 666c 6f61 7420    rcond : float 
-00048640: 6f72 204e 6f6e 652c 206f 7074 696f 6e61  or None, optiona
-00048650: 6c0a 2020 2020 2020 2020 2020 2020 5265  l.            Re
-00048660: 6c61 7469 7665 2063 6f6e 6469 7469 6f6e  lative condition
-00048670: 206e 756d 6265 7220 746f 2074 6865 2066   number to the f
-00048680: 6974 2e0a 2020 2020 2020 2020 7720 3a20  it..        w : 
-00048690: 6861 7368 6162 6c65 206f 7220 416e 792c  hashable or Any,
-000486a0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-000486b0: 2020 2020 2020 5765 6967 6874 7320 746f        Weights to
-000486c0: 2061 7070 6c79 2074 6f20 7468 6520 792d   apply to the y-
-000486d0: 636f 6f72 6469 6e61 7465 206f 6620 7468  coordinate of th
-000486e0: 6520 7361 6d70 6c65 2070 6f69 6e74 732e  e sample points.
-000486f0: 0a20 2020 2020 2020 2020 2020 2043 616e  .            Can
-00048700: 2062 6520 616e 2061 7272 6179 2d6c 696b   be an array-lik
-00048710: 6520 6f62 6a65 6374 206f 7220 7468 6520  e object or the 
-00048720: 6e61 6d65 206f 6620 6120 636f 6f72 6469  name of a coordi
-00048730: 6e61 7465 2069 6e20 7468 6520 6461 7461  nate in the data
-00048740: 7365 742e 0a20 2020 2020 2020 2066 756c  set..        ful
-00048750: 6c20 3a20 626f 6f6c 2c20 6465 6661 756c  l : bool, defaul
-00048760: 743a 2046 616c 7365 0a20 2020 2020 2020  t: False.       
-00048770: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
-00048780: 7265 7475 726e 2074 6865 2072 6573 6964  return the resid
-00048790: 7561 6c73 2c20 6d61 7472 6978 2072 616e  uals, matrix ran
-000487a0: 6b20 616e 6420 7369 6e67 756c 6172 2076  k and singular v
-000487b0: 616c 7565 7320 696e 2061 6464 6974 696f  alues in additio
-000487c0: 6e0a 2020 2020 2020 2020 2020 2020 746f  n.            to
-000487d0: 2074 6865 2063 6f65 6666 6963 6965 6e74   the coefficient
-000487e0: 732e 0a20 2020 2020 2020 2063 6f76 203a  s..        cov :
-000487f0: 2062 6f6f 6c20 6f72 2022 756e 7363 616c   bool or "unscal
-00048800: 6564 222c 2064 6566 6175 6c74 3a20 4661  ed", default: Fa
-00048810: 6c73 650a 2020 2020 2020 2020 2020 2020  lse.            
-00048820: 5768 6574 6865 7220 746f 2072 6574 7572  Whether to retur
-00048830: 6e20 746f 2074 6865 2063 6f76 6172 6961  n to the covaria
-00048840: 6e63 6520 6d61 7472 6978 2069 6e20 6164  nce matrix in ad
-00048850: 6469 7469 6f6e 2074 6f20 7468 6520 636f  dition to the co
-00048860: 6566 6669 6369 656e 7473 2e0a 2020 2020  efficients..    
-00048870: 2020 2020 2020 2020 5468 6520 6d61 7472          The matr
-00048880: 6978 2069 7320 6e6f 7420 7363 616c 6564  ix is not scaled
-00048890: 2069 6620 6063 6f76 3d27 756e 7363 616c   if `cov='unscal
-000488a0: 6564 2760 2e0a 0a20 2020 2020 2020 2052  ed'`...        R
-000488b0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-000488c0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2070  ------.        p
-000488d0: 6f6c 7966 6974 5f72 6573 756c 7473 203a  olyfit_results :
-000488e0: 2044 6174 6173 6574 0a20 2020 2020 2020   Dataset.       
-000488f0: 2020 2020 2041 2073 696e 676c 6520 6461       A single da
-00048900: 7461 7365 7420 7768 6963 6820 636f 6e74  taset which cont
-00048910: 6169 6e73 2028 666f 7220 6561 6368 2022  ains (for each "
-00048920: 7661 7222 2069 6e20 7468 6520 696e 7075  var" in the inpu
-00048930: 7420 6461 7461 7365 7429 3a0a 0a20 2020  t dataset):..   
-00048940: 2020 2020 2020 2020 205b 7661 725d 5f70           [var]_p
-00048950: 6f6c 7966 6974 5f63 6f65 6666 6963 6965  olyfit_coefficie
-00048960: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
-00048970: 2020 2020 5468 6520 636f 6566 6669 6369      The coeffici
-00048980: 656e 7473 206f 6620 7468 6520 6265 7374  ents of the best
-00048990: 2066 6974 2066 6f72 2065 6163 6820 7661   fit for each va
-000489a0: 7269 6162 6c65 2069 6e20 7468 6973 2064  riable in this d
-000489b0: 6174 6173 6574 2e0a 2020 2020 2020 2020  ataset..        
-000489c0: 2020 2020 5b76 6172 5d5f 706f 6c79 6669      [var]_polyfi
-000489d0: 745f 7265 7369 6475 616c 730a 2020 2020  t_residuals.    
-000489e0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-000489f0: 7265 7369 6475 616c 7320 6f66 2074 6865  residuals of the
-00048a00: 206c 6561 7374 2d73 7175 6172 6520 636f   least-square co
-00048a10: 6d70 7574 6174 696f 6e20 666f 7220 6561  mputation for ea
-00048a20: 6368 2076 6172 6961 626c 6520 286f 6e6c  ch variable (onl
-00048a30: 7920 696e 636c 7564 6564 2069 6620 6066  y included if `f
-00048a40: 756c 6c3d 5472 7565 6029 0a20 2020 2020  ull=True`).     
-00048a50: 2020 2020 2020 2020 2020 2057 6865 6e20             When 
-00048a60: 7468 6520 6d61 7472 6978 2072 616e 6b20  the matrix rank 
-00048a70: 6973 2064 6566 6963 6965 6e74 2c20 6e70  is deficient, np
-00048a80: 2e6e 616e 2069 7320 7265 7475 726e 6564  .nan is returned
-00048a90: 2e0a 2020 2020 2020 2020 2020 2020 5b64  ..            [d
-00048aa0: 696d 5d5f 6d61 7472 6978 5f72 616e 6b0a  im]_matrix_rank.
-00048ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00048ac0: 5468 6520 6566 6665 6374 6976 6520 7261  The effective ra
-00048ad0: 6e6b 206f 6620 7468 6520 7363 616c 6564  nk of the scaled
-00048ae0: 2056 616e 6465 726d 6f6e 6465 2063 6f65   Vandermonde coe
-00048af0: 6666 6963 6965 6e74 206d 6174 7269 7820  fficient matrix 
-00048b00: 286f 6e6c 7920 696e 636c 7564 6564 2069  (only included i
-00048b10: 6620 6066 756c 6c3d 5472 7565 6029 0a20  f `full=True`). 
-00048b20: 2020 2020 2020 2020 2020 2020 2020 2054                 T
-00048b30: 6865 2072 616e 6b20 6973 2063 6f6d 7075  he rank is compu
-00048b40: 7465 6420 6967 6e6f 7269 6e67 2074 6865  ted ignoring the
-00048b50: 204e 614e 2076 616c 7565 7320 7468 6174   NaN values that
-00048b60: 206d 6967 6874 2062 6520 736b 6970 7065   might be skippe
-00048b70: 642e 0a20 2020 2020 2020 2020 2020 205b  d..            [
-00048b80: 6469 6d5d 5f73 696e 6775 6c61 725f 7661  dim]_singular_va
-00048b90: 6c75 6573 0a20 2020 2020 2020 2020 2020  lues.           
-00048ba0: 2020 2020 2054 6865 2073 696e 6775 6c61       The singula
-00048bb0: 7220 7661 6c75 6573 206f 6620 7468 6520  r values of the 
-00048bc0: 7363 616c 6564 2056 616e 6465 726d 6f6e  scaled Vandermon
-00048bd0: 6465 2063 6f65 6666 6963 6965 6e74 206d  de coefficient m
-00048be0: 6174 7269 7820 286f 6e6c 7920 696e 636c  atrix (only incl
-00048bf0: 7564 6564 2069 6620 6066 756c 6c3d 5472  uded if `full=Tr
-00048c00: 7565 6029 0a20 2020 2020 2020 2020 2020  ue`).           
-00048c10: 205b 7661 725d 5f70 6f6c 7966 6974 5f63   [var]_polyfit_c
-00048c20: 6f76 6172 6961 6e63 650a 2020 2020 2020  ovariance.      
-00048c30: 2020 2020 2020 2020 2020 5468 6520 636f            The co
-00048c40: 7661 7269 616e 6365 206d 6174 7269 7820  variance matrix 
-00048c50: 6f66 2074 6865 2070 6f6c 796e 6f6d 6961  of the polynomia
-00048c60: 6c20 636f 6566 6669 6369 656e 7420 6573  l coefficient es
-00048c70: 7469 6d61 7465 7320 286f 6e6c 7920 696e  timates (only in
-00048c80: 636c 7564 6564 2069 6620 6066 756c 6c3d  cluded if `full=
-00048c90: 4661 6c73 6560 2061 6e64 2060 636f 763d  False` and `cov=
-00048ca0: 5472 7565 6029 0a0a 2020 2020 2020 2020  True`)..        
-00048cb0: 5761 726e 730a 2020 2020 2020 2020 2d2d  Warns.        --
-00048cc0: 2d2d 2d0a 2020 2020 2020 2020 5261 6e6b  ---.        Rank
-00048cd0: 5761 726e 696e 670a 2020 2020 2020 2020  Warning.        
-00048ce0: 2020 2020 5468 6520 7261 6e6b 206f 6620      The rank of 
-00048cf0: 7468 6520 636f 6566 6669 6369 656e 7420  the coefficient 
-00048d00: 6d61 7472 6978 2069 6e20 7468 6520 6c65  matrix in the le
-00048d10: 6173 742d 7371 7561 7265 7320 6669 7420  ast-squares fit 
-00048d20: 6973 2064 6566 6963 6965 6e74 2e0a 2020  is deficient..  
-00048d30: 2020 2020 2020 2020 2020 5468 6520 7761            The wa
-00048d40: 726e 696e 6720 6973 206e 6f74 2072 6169  rning is not rai
-00048d50: 7365 6420 7769 7468 2069 6e2d 6d65 6d6f  sed with in-memo
-00048d60: 7279 2028 6e6f 7420 6461 736b 2920 6461  ry (not dask) da
-00048d70: 7461 2061 6e64 2060 6675 6c6c 3d54 7275  ta and `full=Tru
-00048d80: 6560 2e0a 0a20 2020 2020 2020 2053 6565  e`...        See
-00048d90: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00048da0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
-00048db0: 756d 7079 2e70 6f6c 7966 6974 0a20 2020  umpy.polyfit.   
-00048dc0: 2020 2020 206e 756d 7079 2e70 6f6c 7976       numpy.polyv
-00048dd0: 616c 0a20 2020 2020 2020 2078 6172 7261  al.        xarra
-00048de0: 792e 706f 6c79 7661 6c0a 2020 2020 2020  y.polyval.      
-00048df0: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
-00048e00: 6f6d 2078 6172 7261 792e 636f 7265 2e64  om xarray.core.d
-00048e10: 6174 6161 7272 6179 2069 6d70 6f72 7420  ataarray import 
-00048e20: 4461 7461 4172 7261 790a 0a20 2020 2020  DataArray..     
-00048e30: 2020 2076 6172 6961 626c 6573 203d 207b     variables = {
-00048e40: 7d0a 2020 2020 2020 2020 736b 6970 6e61  }.        skipna
-00048e50: 5f64 6120 3d20 736b 6970 6e61 0a0a 2020  _da = skipna..  
-00048e60: 2020 2020 2020 7820 3d20 6765 745f 636c        x = get_cl
-00048e70: 6561 6e5f 696e 7465 7270 5f69 6e64 6578  ean_interp_index
-00048e80: 2873 656c 662c 2064 696d 2c20 7374 7269  (self, dim, stri
-00048e90: 6374 3d46 616c 7365 290a 2020 2020 2020  ct=False).      
-00048ea0: 2020 786e 616d 6520 3d20 6622 7b73 656c    xname = f"{sel
-00048eb0: 665b 6469 6d5d 2e6e 616d 657d 5f22 0a20  f[dim].name}_". 
-00048ec0: 2020 2020 2020 206f 7264 6572 203d 2069         order = i
-00048ed0: 6e74 2864 6567 2920 2b20 310a 2020 2020  nt(deg) + 1.    
-00048ee0: 2020 2020 6c68 7320 3d20 6e70 2e76 616e      lhs = np.van
-00048ef0: 6465 7228 782c 206f 7264 6572 290a 0a20  der(x, order).. 
-00048f00: 2020 2020 2020 2069 6620 7263 6f6e 6420         if rcond 
-00048f10: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00048f20: 2020 2020 2072 636f 6e64 203d 2028 0a20       rcond = (. 
-00048f30: 2020 2020 2020 2020 2020 2020 2020 2078                 x
-00048f40: 2e73 6861 7065 5b30 5d20 2a20 6e70 2e63  .shape[0] * np.c
-00048f50: 6f72 652e 6669 6e66 6f28 782e 6474 7970  ore.finfo(x.dtyp
-00048f60: 6529 2e65 7073 2020 2320 7479 7065 3a20  e).eps  # type: 
-00048f70: 6967 6e6f 7265 5b61 7474 722d 6465 6669  ignore[attr-defi
-00048f80: 6e65 645d 0a20 2020 2020 2020 2020 2020  ned].           
-00048f90: 2029 0a0a 2020 2020 2020 2020 2320 5765   )..        # We
-00048fa0: 6967 6874 733a 0a20 2020 2020 2020 2069  ights:.        i
-00048fb0: 6620 7720 6973 206e 6f74 204e 6f6e 653a  f w is not None:
-00048fc0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00048fd0: 6973 696e 7374 616e 6365 2877 2c20 4861  isinstance(w, Ha
-00048fe0: 7368 6162 6c65 293a 0a20 2020 2020 2020  shable):.       
-00048ff0: 2020 2020 2020 2020 2077 203d 2073 656c           w = sel
-00049000: 662e 636f 6f72 6473 5b77 5d0a 2020 2020  f.coords[w].    
-00049010: 2020 2020 2020 2020 7720 3d20 6e70 2e61          w = np.a
-00049020: 7361 7272 6179 2877 290a 2020 2020 2020  sarray(w).      
-00049030: 2020 2020 2020 6966 2077 2e6e 6469 6d20        if w.ndim 
-00049040: 213d 2031 3a0a 2020 2020 2020 2020 2020  != 1:.          
-00049050: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-00049060: 4572 726f 7228 2245 7870 6563 7465 6420  Error("Expected 
-00049070: 6120 312d 6420 6172 7261 7920 666f 7220  a 1-d array for 
-00049080: 7765 6967 6874 732e 2229 0a20 2020 2020  weights.").     
-00049090: 2020 2020 2020 2069 6620 772e 7368 6170         if w.shap
-000490a0: 655b 305d 2021 3d20 6c68 732e 7368 6170  e[0] != lhs.shap
-000490b0: 655b 305d 3a0a 2020 2020 2020 2020 2020  e[0]:.          
-000490c0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-000490d0: 4572 726f 7228 6622 4578 7065 6374 6564  Error(f"Expected
-000490e0: 2077 2061 6e64 207b 6469 6d7d 2074 6f20   w and {dim} to 
-000490f0: 6861 7665 2074 6865 2073 616d 6520 6c65  have the same le
-00049100: 6e67 7468 2229 0a20 2020 2020 2020 2020  ngth").         
-00049110: 2020 206c 6873 202a 3d20 775b 3a2c 206e     lhs *= w[:, n
-00049120: 702e 6e65 7761 7869 735d 0a0a 2020 2020  p.newaxis]..    
-00049130: 2020 2020 2320 5363 616c 696e 670a 2020      # Scaling.  
-00049140: 2020 2020 2020 7363 616c 6520 3d20 6e70        scale = np
-00049150: 2e73 7172 7428 286c 6873 202a 206c 6873  .sqrt((lhs * lhs
-00049160: 292e 7375 6d28 6178 6973 3d30 2929 0a20  ).sum(axis=0)). 
-00049170: 2020 2020 2020 206c 6873 202f 3d20 7363         lhs /= sc
-00049180: 616c 650a 0a20 2020 2020 2020 2064 6567  ale..        deg
-00049190: 7265 655f 6469 6d20 3d20 7574 696c 732e  ree_dim = utils.
-000491a0: 6765 745f 7465 6d70 5f64 696d 6e61 6d65  get_temp_dimname
-000491b0: 2873 656c 662e 6469 6d73 2c20 2264 6567  (self.dims, "deg
-000491c0: 7265 6522 290a 0a20 2020 2020 2020 2072  ree")..        r
-000491d0: 616e 6b20 3d20 6e70 2e6c 696e 616c 672e  ank = np.linalg.
-000491e0: 6d61 7472 6978 5f72 616e 6b28 6c68 7329  matrix_rank(lhs)
-000491f0: 0a0a 2020 2020 2020 2020 6966 2066 756c  ..        if ful
-00049200: 6c3a 0a20 2020 2020 2020 2020 2020 2072  l:.            r
-00049210: 616e 6b20 3d20 4461 7461 4172 7261 7928  ank = DataArray(
-00049220: 7261 6e6b 2c20 6e61 6d65 3d78 6e61 6d65  rank, name=xname
-00049230: 202b 2022 6d61 7472 6978 5f72 616e 6b22   + "matrix_rank"
-00049240: 290a 2020 2020 2020 2020 2020 2020 7661  ).            va
-00049250: 7269 6162 6c65 735b 7261 6e6b 2e6e 616d  riables[rank.nam
-00049260: 655d 203d 2072 616e 6b0a 2020 2020 2020  e] = rank.      
-00049270: 2020 2020 2020 5f73 696e 6720 3d20 6e70        _sing = np
-00049280: 2e6c 696e 616c 672e 7376 6428 6c68 732c  .linalg.svd(lhs,
-00049290: 2063 6f6d 7075 7465 5f75 763d 4661 6c73   compute_uv=Fals
-000492a0: 6529 0a20 2020 2020 2020 2020 2020 2073  e).            s
-000492b0: 696e 6720 3d20 4461 7461 4172 7261 7928  ing = DataArray(
-000492c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000492d0: 205f 7369 6e67 2c0a 2020 2020 2020 2020   _sing,.        
-000492e0: 2020 2020 2020 2020 6469 6d73 3d28 6465          dims=(de
-000492f0: 6772 6565 5f64 696d 2c29 2c0a 2020 2020  gree_dim,),.    
-00049300: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
-00049310: 6473 3d7b 6465 6772 6565 5f64 696d 3a20  ds={degree_dim: 
-00049320: 6e70 2e61 7261 6e67 6528 7261 6e6b 202d  np.arange(rank -
-00049330: 2031 2c20 2d31 2c20 2d31 297d 2c0a 2020   1, -1, -1)},.  
-00049340: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-00049350: 6d65 3d78 6e61 6d65 202b 2022 7369 6e67  me=xname + "sing
-00049360: 756c 6172 5f76 616c 7565 7322 2c0a 2020  ular_values",.  
-00049370: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00049380: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
-00049390: 735b 7369 6e67 2e6e 616d 655d 203d 2073  s[sing.name] = s
-000493a0: 696e 670a 0a20 2020 2020 2020 2066 6f72  ing..        for
-000493b0: 206e 616d 652c 2064 6120 696e 2073 656c   name, da in sel
-000493c0: 662e 6461 7461 5f76 6172 732e 6974 656d  f.data_vars.item
-000493d0: 7328 293a 0a20 2020 2020 2020 2020 2020  s():.           
-000493e0: 2069 6620 6469 6d20 6e6f 7420 696e 2064   if dim not in d
-000493f0: 612e 6469 6d73 3a0a 2020 2020 2020 2020  a.dims:.        
-00049400: 2020 2020 2020 2020 636f 6e74 696e 7565          continue
-00049410: 0a0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00049420: 2069 735f 6475 636b 5f64 6173 6b5f 6172   is_duck_dask_ar
-00049430: 7261 7928 6461 2e64 6174 6129 2061 6e64  ray(da.data) and
-00049440: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
-00049450: 2020 2072 616e 6b20 213d 206f 7264 6572     rank != order
-00049460: 206f 7220 6675 6c6c 206f 7220 736b 6970   or full or skip
-00049470: 6e61 2069 7320 4e6f 6e65 0a20 2020 2020  na is None.     
-00049480: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-00049490: 2020 2020 2020 2020 2020 2320 4375 7272            # Curr
-000494a0: 656e 7420 616c 676f 7269 7468 6d20 7769  ent algorithm wi
-000494b0: 7468 2064 6173 6b20 616e 6420 736b 6970  th dask and skip
-000494c0: 6e61 3d46 616c 7365 206e 6569 7468 6572  na=False neither
-000494d0: 2073 7570 706f 7274 730a 2020 2020 2020   supports.      
-000494e0: 2020 2020 2020 2020 2020 2320 6465 6669            # defi
-000494f0: 6369 656e 7420 7261 6e6b 7320 6e6f 7220  cient ranks nor 
-00049500: 646f 6573 2069 7420 6f75 7470 7574 2074  does it output t
-00049510: 6865 2022 6675 6c6c 2220 696e 666f 2028  he "full" info (
-00049520: 6973 7375 6520 6461 736b 2f64 6173 6b23  issue dask/dask#
-00049530: 3635 3136 290a 2020 2020 2020 2020 2020  6516).          
-00049540: 2020 2020 2020 736b 6970 6e61 5f64 6120        skipna_da 
-00049550: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
-00049560: 2020 2065 6c69 6620 736b 6970 6e61 2069     elif skipna i
-00049570: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
-00049580: 2020 2020 2020 2020 736b 6970 6e61 5f64          skipna_d
-00049590: 6120 3d20 626f 6f6c 286e 702e 616e 7928  a = bool(np.any(
-000495a0: 6461 2e69 736e 756c 6c28 2929 290a 0a20  da.isnull())).. 
-000495b0: 2020 2020 2020 2020 2020 2064 696d 735f             dims_
-000495c0: 746f 5f73 7461 636b 203d 205b 6469 6d6e  to_stack = [dimn
-000495d0: 616d 6520 666f 7220 6469 6d6e 616d 6520  ame for dimname 
-000495e0: 696e 2064 612e 6469 6d73 2069 6620 6469  in da.dims if di
-000495f0: 6d6e 616d 6520 213d 2064 696d 5d0a 2020  mname != dim].  
-00049600: 2020 2020 2020 2020 2020 7374 6163 6b65            stacke
-00049610: 645f 636f 6f72 6473 3a20 6469 6374 5b48  d_coords: dict[H
-00049620: 6173 6861 626c 652c 2044 6174 6141 7272  ashable, DataArr
-00049630: 6179 5d20 3d20 7b7d 0a20 2020 2020 2020  ay] = {}.       
-00049640: 2020 2020 2069 6620 6469 6d73 5f74 6f5f       if dims_to_
-00049650: 7374 6163 6b3a 0a20 2020 2020 2020 2020  stack:.         
-00049660: 2020 2020 2020 2073 7461 636b 6564 5f64         stacked_d
-00049670: 696d 203d 2075 7469 6c73 2e67 6574 5f74  im = utils.get_t
-00049680: 656d 705f 6469 6d6e 616d 6528 6469 6d73  emp_dimname(dims
-00049690: 5f74 6f5f 7374 6163 6b2c 2022 7374 6163  _to_stack, "stac
-000496a0: 6b65 6422 290a 2020 2020 2020 2020 2020  ked").          
-000496b0: 2020 2020 2020 7268 7320 3d20 6461 2e74        rhs = da.t
-000496c0: 7261 6e73 706f 7365 2864 696d 2c20 2a64  ranspose(dim, *d
-000496d0: 696d 735f 746f 5f73 7461 636b 292e 7374  ims_to_stack).st
-000496e0: 6163 6b28 0a20 2020 2020 2020 2020 2020  ack(.           
-000496f0: 2020 2020 2020 2020 207b 7374 6163 6b65           {stacke
-00049700: 645f 6469 6d3a 2064 696d 735f 746f 5f73  d_dim: dims_to_s
-00049710: 7461 636b 7d0a 2020 2020 2020 2020 2020  tack}.          
-00049720: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00049730: 2020 2020 2020 2020 7374 6163 6b65 645f          stacked_
-00049740: 636f 6f72 6473 203d 207b 7374 6163 6b65  coords = {stacke
-00049750: 645f 6469 6d3a 2072 6873 5b73 7461 636b  d_dim: rhs[stack
-00049760: 6564 5f64 696d 5d7d 0a20 2020 2020 2020  ed_dim]}.       
-00049770: 2020 2020 2020 2020 2073 6361 6c65 5f64           scale_d
-00049780: 6120 3d20 7363 616c 655b 3a2c 206e 702e  a = scale[:, np.
-00049790: 6e65 7761 7869 735d 0a20 2020 2020 2020  newaxis].       
-000497a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-000497b0: 2020 2020 2020 2020 2020 2072 6873 203d             rhs =
-000497c0: 2064 610a 2020 2020 2020 2020 2020 2020   da.            
-000497d0: 2020 2020 7363 616c 655f 6461 203d 2073      scale_da = s
-000497e0: 6361 6c65 0a0a 2020 2020 2020 2020 2020  cale..          
-000497f0: 2020 6966 2077 2069 7320 6e6f 7420 4e6f    if w is not No
-00049800: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00049810: 2020 2020 7268 7320 2a3d 2077 5b3a 2c20      rhs *= w[:, 
-00049820: 6e70 2e6e 6577 6178 6973 5d0a 0a20 2020  np.newaxis]..   
-00049830: 2020 2020 2020 2020 2077 6974 6820 7761           with wa
-00049840: 726e 696e 6773 2e63 6174 6368 5f77 6172  rnings.catch_war
-00049850: 6e69 6e67 7328 293a 0a20 2020 2020 2020  nings():.       
-00049860: 2020 2020 2020 2020 2069 6620 6675 6c6c           if full
-00049870: 3a20 2023 2043 6f70 7920 6e70 2e70 6f6c  :  # Copy np.pol
-00049880: 7966 6974 2062 6568 6176 696f 720a 2020  yfit behavior.  
-00049890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000498a0: 2020 7761 726e 696e 6773 2e73 696d 706c    warnings.simpl
-000498b0: 6566 696c 7465 7228 2269 676e 6f72 6522  efilter("ignore"
-000498c0: 2c20 6e70 2e52 616e 6b57 6172 6e69 6e67  , np.RankWarning
-000498d0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-000498e0: 2020 656c 7365 3a20 2023 2052 6169 7365    else:  # Raise
-000498f0: 206f 6e6c 7920 6f6e 6365 2070 6572 2076   only once per v
-00049900: 6172 6961 626c 650a 2020 2020 2020 2020  ariable.        
-00049910: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-00049920: 696e 6773 2e73 696d 706c 6566 696c 7465  ings.simplefilte
-00049930: 7228 226f 6e63 6522 2c20 6e70 2e52 616e  r("once", np.Ran
-00049940: 6b57 6172 6e69 6e67 290a 0a20 2020 2020  kWarning)..     
-00049950: 2020 2020 2020 2020 2020 2063 6f65 6666             coeff
-00049960: 732c 2072 6573 6964 7561 6c73 203d 2064  s, residuals = d
-00049970: 7563 6b5f 6172 7261 795f 6f70 732e 6c65  uck_array_ops.le
-00049980: 6173 745f 7371 7561 7265 7328 0a20 2020  ast_squares(.   
-00049990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000499a0: 206c 6873 2c20 7268 732e 6461 7461 2c20   lhs, rhs.data, 
-000499b0: 7263 6f6e 643d 7263 6f6e 642c 2073 6b69  rcond=rcond, ski
-000499c0: 706e 613d 736b 6970 6e61 5f64 610a 2020  pna=skipna_da.  
-000499d0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-000499e0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000499f0: 6973 696e 7374 616e 6365 286e 616d 652c  isinstance(name,
-00049a00: 2073 7472 293a 0a20 2020 2020 2020 2020   str):.         
-00049a10: 2020 2020 2020 206e 616d 6520 3d20 6622         name = f"
-00049a20: 7b6e 616d 657d 5f22 0a20 2020 2020 2020  {name}_".       
-00049a30: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00049a40: 2020 2020 2020 2020 2020 2023 2054 6875             # Thu
-00049a50: 7320 6120 5265 7072 4f62 6a65 6374 203d  s a ReprObject =
-00049a60: 3e20 706f 6c79 6669 7420 7761 7320 6361  > polyfit was ca
-00049a70: 6c6c 6564 206f 6e20 6120 4461 7461 4172  lled on a DataAr
-00049a80: 7261 790a 2020 2020 2020 2020 2020 2020  ray.            
-00049a90: 2020 2020 6e61 6d65 203d 2022 220a 0a20      name = "".. 
-00049aa0: 2020 2020 2020 2020 2020 2063 6f65 6666             coeff
-00049ab0: 7320 3d20 4461 7461 4172 7261 7928 0a20  s = DataArray(. 
-00049ac0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00049ad0: 6f65 6666 7320 2f20 7363 616c 655f 6461  oeffs / scale_da
-00049ae0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00049af0: 2020 6469 6d73 3d5b 6465 6772 6565 5f64    dims=[degree_d
-00049b00: 696d 5d20 2b20 6c69 7374 2873 7461 636b  im] + list(stack
-00049b10: 6564 5f63 6f6f 7264 732e 6b65 7973 2829  ed_coords.keys()
-00049b20: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00049b30: 2020 2063 6f6f 7264 733d 7b64 6567 7265     coords={degre
-00049b40: 655f 6469 6d3a 206e 702e 6172 616e 6765  e_dim: np.arange
-00049b50: 286f 7264 6572 295b 3a3a 2d31 5d2c 202a  (order)[::-1], *
-00049b60: 2a73 7461 636b 6564 5f63 6f6f 7264 737d  *stacked_coords}
-00049b70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00049b80: 2020 6e61 6d65 3d6e 616d 6520 2b20 2270    name=name + "p
-00049b90: 6f6c 7966 6974 5f63 6f65 6666 6963 6965  olyfit_coefficie
-00049ba0: 6e74 7322 2c0a 2020 2020 2020 2020 2020  nts",.          
-00049bb0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00049bc0: 6966 2064 696d 735f 746f 5f73 7461 636b  if dims_to_stack
-00049bd0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00049be0: 2020 636f 6566 6673 203d 2063 6f65 6666    coeffs = coeff
-00049bf0: 732e 756e 7374 6163 6b28 7374 6163 6b65  s.unstack(stacke
-00049c00: 645f 6469 6d29 0a20 2020 2020 2020 2020  d_dim).         
-00049c10: 2020 2076 6172 6961 626c 6573 5b63 6f65     variables[coe
-00049c20: 6666 732e 6e61 6d65 5d20 3d20 636f 6566  ffs.name] = coef
-00049c30: 6673 0a0a 2020 2020 2020 2020 2020 2020  fs..            
-00049c40: 6966 2066 756c 6c20 6f72 2028 636f 7620  if full or (cov 
-00049c50: 6973 2054 7275 6529 3a0a 2020 2020 2020  is True):.      
-00049c60: 2020 2020 2020 2020 2020 7265 7369 6475            residu
-00049c70: 616c 7320 3d20 4461 7461 4172 7261 7928  als = DataArray(
-00049c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00049c90: 2020 2020 2072 6573 6964 7561 6c73 2069       residuals i
-00049ca0: 6620 6469 6d73 5f74 6f5f 7374 6163 6b20  f dims_to_stack 
-00049cb0: 656c 7365 2072 6573 6964 7561 6c73 2e73  else residuals.s
-00049cc0: 7175 6565 7a65 2829 2c0a 2020 2020 2020  queeze(),.      
-00049cd0: 2020 2020 2020 2020 2020 2020 2020 6469                di
-00049ce0: 6d73 3d6c 6973 7428 7374 6163 6b65 645f  ms=list(stacked_
-00049cf0: 636f 6f72 6473 2e6b 6579 7328 2929 2c0a  coords.keys()),.
-00049d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049d10: 2020 2020 636f 6f72 6473 3d73 7461 636b      coords=stack
-00049d20: 6564 5f63 6f6f 7264 732c 0a20 2020 2020  ed_coords,.     
-00049d30: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-00049d40: 616d 653d 6e61 6d65 202b 2022 706f 6c79  ame=name + "poly
-00049d50: 6669 745f 7265 7369 6475 616c 7322 2c0a  fit_residuals",.
-00049d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049d70: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-00049d80: 2020 6966 2064 696d 735f 746f 5f73 7461    if dims_to_sta
-00049d90: 636b 3a0a 2020 2020 2020 2020 2020 2020  ck:.            
-00049da0: 2020 2020 2020 2020 7265 7369 6475 616c          residual
-00049db0: 7320 3d20 7265 7369 6475 616c 732e 756e  s = residuals.un
-00049dc0: 7374 6163 6b28 7374 6163 6b65 645f 6469  stack(stacked_di
-00049dd0: 6d29 0a20 2020 2020 2020 2020 2020 2020  m).             
-00049de0: 2020 2076 6172 6961 626c 6573 5b72 6573     variables[res
-00049df0: 6964 7561 6c73 2e6e 616d 655d 203d 2072  iduals.name] = r
-00049e00: 6573 6964 7561 6c73 0a0a 2020 2020 2020  esiduals..      
-00049e10: 2020 2020 2020 6966 2063 6f76 3a0a 2020        if cov:.  
-00049e20: 2020 2020 2020 2020 2020 2020 2020 5662                Vb
-00049e30: 6173 6520 3d20 6e70 2e6c 696e 616c 672e  ase = np.linalg.
-00049e40: 696e 7628 6e70 2e64 6f74 286c 6873 2e54  inv(np.dot(lhs.T
-00049e50: 2c20 6c68 7329 290a 2020 2020 2020 2020  , lhs)).        
-00049e60: 2020 2020 2020 2020 5662 6173 6520 2f3d          Vbase /=
-00049e70: 206e 702e 6f75 7465 7228 7363 616c 652c   np.outer(scale,
-00049e80: 2073 6361 6c65 290a 2020 2020 2020 2020   scale).        
-00049e90: 2020 2020 2020 2020 6966 2063 6f76 203d          if cov =
-00049ea0: 3d20 2275 6e73 6361 6c65 6422 3a0a 2020  = "unscaled":.  
-00049eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049ec0: 2020 6661 6320 3d20 310a 2020 2020 2020    fac = 1.      
-00049ed0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-00049ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049ef0: 2020 2020 6966 2078 2e73 6861 7065 5b30      if x.shape[0
-00049f00: 5d20 3c3d 206f 7264 6572 3a0a 2020 2020  ] <= order:.    
-00049f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049f20: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-00049f30: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00049f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049f50: 2020 2254 6865 206e 756d 6265 7220 6f66    "The number of
-00049f60: 2064 6174 6120 706f 696e 7473 206d 7573   data points mus
-00049f70: 7420 6578 6365 6564 206f 7264 6572 2074  t exceed order t
-00049f80: 6f20 7363 616c 6520 7468 6520 636f 7661  o scale the cova
-00049f90: 7269 616e 6365 206d 6174 7269 782e 220a  riance matrix.".
-00049fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00049fb0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00049fc0: 2020 2020 2020 2020 2020 2020 2020 6661                fa
-00049fd0: 6320 3d20 7265 7369 6475 616c 7320 2f20  c = residuals / 
-00049fe0: 2878 2e73 6861 7065 5b30 5d20 2d20 6f72  (x.shape[0] - or
-00049ff0: 6465 7229 0a20 2020 2020 2020 2020 2020  der).           
-0004a000: 2020 2020 2063 6f76 6172 6961 6e63 6520       covariance 
-0004a010: 3d20 4461 7461 4172 7261 7928 5662 6173  = DataArray(Vbas
-0004a020: 652c 2064 696d 733d 2822 636f 765f 6922  e, dims=("cov_i"
-0004a030: 2c20 2263 6f76 5f6a 2229 2920 2a20 6661  , "cov_j")) * fa
-0004a040: 630a 2020 2020 2020 2020 2020 2020 2020  c.              
-0004a050: 2020 7661 7269 6162 6c65 735b 6e61 6d65    variables[name
-0004a060: 202b 2022 706f 6c79 6669 745f 636f 7661   + "polyfit_cova
-0004a070: 7269 616e 6365 225d 203d 2063 6f76 6172  riance"] = covar
-0004a080: 6961 6e63 650a 0a20 2020 2020 2020 2072  iance..        r
-0004a090: 6574 7572 6e20 7479 7065 2873 656c 6629  eturn type(self)
-0004a0a0: 2864 6174 615f 7661 7273 3d76 6172 6961  (data_vars=varia
-0004a0b0: 626c 6573 2c20 6174 7472 733d 7365 6c66  bles, attrs=self
-0004a0c0: 2e61 7474 7273 2e63 6f70 7928 2929 0a0a  .attrs.copy())..
-0004a0d0: 2020 2020 6465 6620 7061 6428 0a20 2020      def pad(.   
-0004a0e0: 2020 2020 2073 656c 663a 2054 5f44 6174       self: T_Dat
-0004a0f0: 6173 6574 2c0a 2020 2020 2020 2020 7061  aset,.        pa
-0004a100: 645f 7769 6474 683a 204d 6170 7069 6e67  d_width: Mapping
-0004a110: 5b41 6e79 2c20 696e 7420 7c20 7475 706c  [Any, int | tupl
-0004a120: 655b 696e 742c 2069 6e74 5d5d 207c 204e  e[int, int]] | N
-0004a130: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-0004a140: 2020 2020 6d6f 6465 3a20 5061 644d 6f64      mode: PadMod
-0004a150: 654f 7074 696f 6e73 203d 2022 636f 6e73  eOptions = "cons
-0004a160: 7461 6e74 222c 0a20 2020 2020 2020 2073  tant",.        s
-0004a170: 7461 745f 6c65 6e67 7468 3a20 696e 740a  tat_length: int.
-0004a180: 2020 2020 2020 2020 7c20 7475 706c 655b          | tuple[
-0004a190: 696e 742c 2069 6e74 5d0a 2020 2020 2020  int, int].      
-0004a1a0: 2020 7c20 4d61 7070 696e 675b 416e 792c    | Mapping[Any,
-0004a1b0: 2074 7570 6c65 5b69 6e74 2c20 696e 745d   tuple[int, int]
-0004a1c0: 5d0a 2020 2020 2020 2020 7c20 4e6f 6e65  ].        | None
-0004a1d0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0004a1e0: 2063 6f6e 7374 616e 745f 7661 6c75 6573   constant_values
-0004a1f0: 3a20 280a 2020 2020 2020 2020 2020 2020  : (.            
-0004a200: 666c 6f61 7420 7c20 7475 706c 655b 666c  float | tuple[fl
-0004a210: 6f61 742c 2066 6c6f 6174 5d20 7c20 4d61  oat, float] | Ma
-0004a220: 7070 696e 675b 416e 792c 2074 7570 6c65  pping[Any, tuple
-0004a230: 5b66 6c6f 6174 2c20 666c 6f61 745d 5d20  [float, float]] 
-0004a240: 7c20 4e6f 6e65 0a20 2020 2020 2020 2029  | None.        )
-0004a250: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0004a260: 2065 6e64 5f76 616c 7565 733a 2069 6e74   end_values: int
-0004a270: 207c 2074 7570 6c65 5b69 6e74 2c20 696e   | tuple[int, in
-0004a280: 745d 207c 204d 6170 7069 6e67 5b41 6e79  t] | Mapping[Any
-0004a290: 2c20 7475 706c 655b 696e 742c 2069 6e74  , tuple[int, int
-0004a2a0: 5d5d 207c 204e 6f6e 6520 3d20 4e6f 6e65  ]] | None = None
-0004a2b0: 2c0a 2020 2020 2020 2020 7265 666c 6563  ,.        reflec
-0004a2c0: 745f 7479 7065 3a20 5061 6452 6566 6c65  t_type: PadRefle
-0004a2d0: 6374 4f70 7469 6f6e 7320 3d20 4e6f 6e65  ctOptions = None
-0004a2e0: 2c0a 2020 2020 2020 2020 6b65 6570 5f61  ,.        keep_a
-0004a2f0: 7474 7273 3a20 626f 6f6c 207c 204e 6f6e  ttrs: bool | Non
-0004a300: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-0004a310: 2020 2a2a 7061 645f 7769 6474 685f 6b77    **pad_width_kw
-0004a320: 6172 6773 3a20 416e 792c 0a20 2020 2029  args: Any,.    )
-0004a330: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
-0004a340: 2020 2020 2020 2022 2222 5061 6420 7468         """Pad th
-0004a350: 6973 2064 6174 6173 6574 2061 6c6f 6e67  is dataset along
-0004a360: 206f 6e65 206f 7220 6d6f 7265 2064 696d   one or more dim
-0004a370: 656e 7369 6f6e 732e 0a0a 2020 2020 2020  ensions...      
-0004a380: 2020 2e2e 2077 6172 6e69 6e67 3a3a 0a20    .. warning::. 
-0004a390: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-0004a3a0: 6675 6e63 7469 6f6e 2069 7320 6578 7065  function is expe
-0004a3b0: 7269 6d65 6e74 616c 2061 6e64 2069 7473  rimental and its
-0004a3c0: 2062 6568 6176 696f 7572 2069 7320 6c69   behaviour is li
-0004a3d0: 6b65 6c79 2074 6f20 6368 616e 6765 0a20  kely to change. 
-0004a3e0: 2020 2020 2020 2020 2020 2065 7370 6563             espec
-0004a3f0: 6961 6c6c 7920 7265 6761 7264 696e 6720  ially regarding 
-0004a400: 7061 6464 696e 6720 6f66 2064 696d 656e  padding of dimen
-0004a410: 7369 6f6e 2063 6f6f 7264 696e 6174 6573  sion coordinates
-0004a420: 2028 6f72 2049 6e64 6578 5661 7269 6162   (or IndexVariab
-0004a430: 6c65 7329 2e0a 0a20 2020 2020 2020 2057  les)...        W
-0004a440: 6865 6e20 7573 696e 6720 6f6e 6520 6f66  hen using one of
-0004a450: 2074 6865 206d 6f64 6573 2028 2265 6467   the modes ("edg
-0004a460: 6522 2c20 2272 6566 6c65 6374 222c 2022  e", "reflect", "
-0004a470: 7379 6d6d 6574 7269 6322 2c20 2277 7261  symmetric", "wra
-0004a480: 7022 292c 0a20 2020 2020 2020 2063 6f6f  p"),.        coo
-0004a490: 7264 696e 6174 6573 2077 696c 6c20 6265  rdinates will be
-0004a4a0: 2070 6164 6465 6420 7769 7468 2074 6865   padded with the
-0004a4b0: 2073 616d 6520 6d6f 6465 2c20 6f74 6865   same mode, othe
-0004a4c0: 7277 6973 6520 636f 6f72 6469 6e61 7465  rwise coordinate
-0004a4d0: 730a 2020 2020 2020 2020 6172 6520 7061  s.        are pa
-0004a4e0: 6464 6564 2075 7369 6e67 2074 6865 2022  dded using the "
-0004a4f0: 636f 6e73 7461 6e74 2220 6d6f 6465 2077  constant" mode w
-0004a500: 6974 6820 6669 6c6c 5f76 616c 7565 2064  ith fill_value d
-0004a510: 7479 7065 732e 4e41 2e0a 0a20 2020 2020  types.NA...     
-0004a520: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-0004a530: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-0004a540: 0a20 2020 2020 2020 2070 6164 5f77 6964  .        pad_wid
-0004a550: 7468 203a 206d 6170 7069 6e67 206f 6620  th : mapping of 
-0004a560: 6861 7368 6162 6c65 2074 6f20 7475 706c  hashable to tupl
-0004a570: 6520 6f66 2069 6e74 0a20 2020 2020 2020  e of int.       
-0004a580: 2020 2020 204d 6170 7069 6e67 2077 6974       Mapping wit
-0004a590: 6820 7468 6520 666f 726d 206f 6620 7b64  h the form of {d
-0004a5a0: 696d 3a20 2870 6164 5f62 6566 6f72 652c  im: (pad_before,
-0004a5b0: 2070 6164 5f61 6674 6572 297d 0a20 2020   pad_after)}.   
-0004a5c0: 2020 2020 2020 2020 2064 6573 6372 6962           describ
-0004a5d0: 696e 6720 7468 6520 6e75 6d62 6572 206f  ing the number o
-0004a5e0: 6620 7661 6c75 6573 2070 6164 6465 6420  f values padded 
-0004a5f0: 616c 6f6e 6720 6561 6368 2064 696d 656e  along each dimen
-0004a600: 7369 6f6e 2e0a 2020 2020 2020 2020 2020  sion..          
-0004a610: 2020 7b64 696d 3a20 7061 647d 2069 7320    {dim: pad} is 
-0004a620: 6120 7368 6f72 7463 7574 2066 6f72 2070  a shortcut for p
-0004a630: 6164 5f62 6566 6f72 6520 3d20 7061 645f  ad_before = pad_
-0004a640: 6166 7465 7220 3d20 7061 640a 2020 2020  after = pad.    
-0004a650: 2020 2020 6d6f 6465 203a 207b 2263 6f6e      mode : {"con
-0004a660: 7374 616e 7422 2c20 2265 6467 6522 2c20  stant", "edge", 
-0004a670: 226c 696e 6561 725f 7261 6d70 222c 2022  "linear_ramp", "
-0004a680: 6d61 7869 6d75 6d22 2c20 226d 6561 6e22  maximum", "mean"
-0004a690: 2c20 226d 6564 6961 6e22 2c20 5c0a 2020  , "median", \.  
-0004a6a0: 2020 2020 2020 2020 2020 226d 696e 696d            "minim
-0004a6b0: 756d 222c 2022 7265 666c 6563 7422 2c20  um", "reflect", 
-0004a6c0: 2273 796d 6d65 7472 6963 222c 2022 7772  "symmetric", "wr
-0004a6d0: 6170 227d 2c20 6465 6661 756c 743a 2022  ap"}, default: "
-0004a6e0: 636f 6e73 7461 6e74 220a 2020 2020 2020  constant".      
-0004a6f0: 2020 2020 2020 486f 7720 746f 2070 6164        How to pad
-0004a700: 2074 6865 2044 6174 6141 7272 6179 2028   the DataArray (
-0004a710: 7461 6b65 6e20 6672 6f6d 206e 756d 7079  taken from numpy
-0004a720: 2064 6f63 7329 3a0a 0a20 2020 2020 2020   docs):..       
-0004a730: 2020 2020 202d 2022 636f 6e73 7461 6e74       - "constant
-0004a740: 223a 2050 6164 7320 7769 7468 2061 2063  ": Pads with a c
-0004a750: 6f6e 7374 616e 7420 7661 6c75 652e 0a20  onstant value.. 
-0004a760: 2020 2020 2020 2020 2020 202d 2022 6564             - "ed
-0004a770: 6765 223a 2050 6164 7320 7769 7468 2074  ge": Pads with t
-0004a780: 6865 2065 6467 6520 7661 6c75 6573 206f  he edge values o
-0004a790: 6620 6172 7261 792e 0a20 2020 2020 2020  f array..       
-0004a7a0: 2020 2020 202d 2022 6c69 6e65 6172 5f72       - "linear_r
-0004a7b0: 616d 7022 3a20 5061 6473 2077 6974 6820  amp": Pads with 
-0004a7c0: 7468 6520 6c69 6e65 6172 2072 616d 7020  the linear ramp 
-0004a7d0: 6265 7477 6565 6e20 656e 645f 7661 6c75  between end_valu
-0004a7e0: 6520 616e 6420 7468 650a 2020 2020 2020  e and the.      
-0004a7f0: 2020 2020 2020 2020 6172 7261 7920 6564          array ed
-0004a800: 6765 2076 616c 7565 2e0a 2020 2020 2020  ge value..      
-0004a810: 2020 2020 2020 2d20 226d 6178 696d 756d        - "maximum
-0004a820: 223a 2050 6164 7320 7769 7468 2074 6865  ": Pads with the
-0004a830: 206d 6178 696d 756d 2076 616c 7565 206f   maximum value o
-0004a840: 6620 616c 6c20 6f72 2070 6172 7420 6f66  f all or part of
-0004a850: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-0004a860: 2020 2076 6563 746f 7220 616c 6f6e 6720     vector along 
-0004a870: 6561 6368 2061 7869 732e 0a20 2020 2020  each axis..     
-0004a880: 2020 2020 2020 202d 2022 6d65 616e 223a         - "mean":
-0004a890: 2050 6164 7320 7769 7468 2074 6865 206d   Pads with the m
-0004a8a0: 6561 6e20 7661 6c75 6520 6f66 2061 6c6c  ean value of all
-0004a8b0: 206f 7220 7061 7274 206f 6620 7468 650a   or part of the.
-0004a8c0: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-0004a8d0: 6374 6f72 2061 6c6f 6e67 2065 6163 6820  ctor along each 
-0004a8e0: 6178 6973 2e0a 2020 2020 2020 2020 2020  axis..          
-0004a8f0: 2020 2d20 226d 6564 6961 6e22 3a20 5061    - "median": Pa
-0004a900: 6473 2077 6974 6820 7468 6520 6d65 6469  ds with the medi
-0004a910: 616e 2076 616c 7565 206f 6620 616c 6c20  an value of all 
-0004a920: 6f72 2070 6172 7420 6f66 2074 6865 0a20  or part of the. 
-0004a930: 2020 2020 2020 2020 2020 2020 2076 6563               vec
-0004a940: 746f 7220 616c 6f6e 6720 6561 6368 2061  tor along each a
-0004a950: 7869 732e 0a20 2020 2020 2020 2020 2020  xis..           
-0004a960: 202d 2022 6d69 6e69 6d75 6d22 3a20 5061   - "minimum": Pa
-0004a970: 6473 2077 6974 6820 7468 6520 6d69 6e69  ds with the mini
-0004a980: 6d75 6d20 7661 6c75 6520 6f66 2061 6c6c  mum value of all
-0004a990: 206f 7220 7061 7274 206f 6620 7468 650a   or part of the.
-0004a9a0: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-0004a9b0: 6374 6f72 2061 6c6f 6e67 2065 6163 6820  ctor along each 
-0004a9c0: 6178 6973 2e0a 2020 2020 2020 2020 2020  axis..          
-0004a9d0: 2020 2d20 2272 6566 6c65 6374 223a 2050    - "reflect": P
-0004a9e0: 6164 7320 7769 7468 2074 6865 2072 6566  ads with the ref
-0004a9f0: 6c65 6374 696f 6e20 6f66 2074 6865 2076  lection of the v
-0004aa00: 6563 746f 7220 6d69 7272 6f72 6564 206f  ector mirrored o
-0004aa10: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
-0004aa20: 7468 6520 6669 7273 7420 616e 6420 6c61  the first and la
-0004aa30: 7374 2076 616c 7565 7320 6f66 2074 6865  st values of the
-0004aa40: 2076 6563 746f 7220 616c 6f6e 6720 6561   vector along ea
-0004aa50: 6368 2061 7869 732e 0a20 2020 2020 2020  ch axis..       
-0004aa60: 2020 2020 202d 2022 7379 6d6d 6574 7269       - "symmetri
-0004aa70: 6322 3a20 5061 6473 2077 6974 6820 7468  c": Pads with th
-0004aa80: 6520 7265 666c 6563 7469 6f6e 206f 6620  e reflection of 
-0004aa90: 7468 6520 7665 6374 6f72 206d 6972 726f  the vector mirro
-0004aaa0: 7265 640a 2020 2020 2020 2020 2020 2020  red.            
-0004aab0: 2020 616c 6f6e 6720 7468 6520 6564 6765    along the edge
-0004aac0: 206f 6620 7468 6520 6172 7261 792e 0a20   of the array.. 
-0004aad0: 2020 2020 2020 2020 2020 202d 2022 7772             - "wr
-0004aae0: 6170 223a 2050 6164 7320 7769 7468 2074  ap": Pads with t
-0004aaf0: 6865 2077 7261 7020 6f66 2074 6865 2076  he wrap of the v
-0004ab00: 6563 746f 7220 616c 6f6e 6720 7468 6520  ector along the 
-0004ab10: 6178 6973 2e0a 2020 2020 2020 2020 2020  axis..          
-0004ab20: 2020 2020 5468 6520 6669 7273 7420 7661      The first va
-0004ab30: 6c75 6573 2061 7265 2075 7365 6420 746f  lues are used to
-0004ab40: 2070 6164 2074 6865 2065 6e64 2061 6e64   pad the end and
-0004ab50: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-0004ab60: 2020 2065 6e64 2076 616c 7565 7320 6172     end values ar
-0004ab70: 6520 7573 6564 2074 6f20 7061 6420 7468  e used to pad th
-0004ab80: 6520 6265 6769 6e6e 696e 672e 0a0a 2020  e beginning...  
-0004ab90: 2020 2020 2020 7374 6174 5f6c 656e 6774        stat_lengt
-0004aba0: 6820 3a20 696e 742c 2074 7570 6c65 206f  h : int, tuple o
-0004abb0: 7220 6d61 7070 696e 6720 6f66 2068 6173  r mapping of has
-0004abc0: 6861 626c 6520 746f 2074 7570 6c65 2c20  hable to tuple, 
-0004abd0: 6465 6661 756c 743a 204e 6f6e 650a 2020  default: None.  
-0004abe0: 2020 2020 2020 2020 2020 5573 6564 2069            Used i
-0004abf0: 6e20 276d 6178 696d 756d 272c 2027 6d65  n 'maximum', 'me
-0004ac00: 616e 272c 2027 6d65 6469 616e 272c 2061  an', 'median', a
-0004ac10: 6e64 2027 6d69 6e69 6d75 6d27 2e20 204e  nd 'minimum'.  N
-0004ac20: 756d 6265 7220 6f66 0a20 2020 2020 2020  umber of.       
-0004ac30: 2020 2020 2076 616c 7565 7320 6174 2065       values at e
-0004ac40: 6467 6520 6f66 2065 6163 6820 6178 6973  dge of each axis
-0004ac50: 2075 7365 6420 746f 2063 616c 6375 6c61   used to calcula
-0004ac60: 7465 2074 6865 2073 7461 7469 7374 6963  te the statistic
-0004ac70: 2076 616c 7565 2e0a 2020 2020 2020 2020   value..        
-0004ac80: 2020 2020 7b64 696d 5f31 3a20 2862 6566      {dim_1: (bef
-0004ac90: 6f72 655f 312c 2061 6674 6572 5f31 292c  ore_1, after_1),
-0004aca0: 202e 2e2e 2064 696d 5f4e 3a20 2862 6566   ... dim_N: (bef
-0004acb0: 6f72 655f 4e2c 2061 6674 6572 5f4e 297d  ore_N, after_N)}
-0004acc0: 2075 6e69 7175 650a 2020 2020 2020 2020   unique.        
-0004acd0: 2020 2020 7374 6174 6973 7469 6320 6c65      statistic le
-0004ace0: 6e67 7468 7320 616c 6f6e 6720 6561 6368  ngths along each
-0004acf0: 2064 696d 656e 7369 6f6e 2e0a 2020 2020   dimension..    
-0004ad00: 2020 2020 2020 2020 2828 6265 666f 7265          ((before
-0004ad10: 2c20 6166 7465 7229 2c29 2079 6965 6c64  , after),) yield
-0004ad20: 7320 7361 6d65 2062 6566 6f72 6520 616e  s same before an
-0004ad30: 6420 6166 7465 7220 7374 6174 6973 7469  d after statisti
-0004ad40: 6320 6c65 6e67 7468 730a 2020 2020 2020  c lengths.      
-0004ad50: 2020 2020 2020 666f 7220 6561 6368 2064        for each d
-0004ad60: 696d 656e 7369 6f6e 2e0a 2020 2020 2020  imension..      
-0004ad70: 2020 2020 2020 2873 7461 745f 6c65 6e67        (stat_leng
-0004ad80: 7468 2c29 206f 7220 696e 7420 6973 2061  th,) or int is a
-0004ad90: 2073 686f 7274 6375 7420 666f 7220 6265   shortcut for be
-0004ada0: 666f 7265 203d 2061 6674 6572 203d 2073  fore = after = s
-0004adb0: 7461 7469 7374 6963 0a20 2020 2020 2020  tatistic.       
-0004adc0: 2020 2020 206c 656e 6774 6820 666f 7220       length for 
-0004add0: 616c 6c20 6178 6573 2e0a 2020 2020 2020  all axes..      
-0004ade0: 2020 2020 2020 4465 6661 756c 7420 6973        Default is
-0004adf0: 2060 604e 6f6e 6560 602c 2074 6f20 7573   ``None``, to us
-0004ae00: 6520 7468 6520 656e 7469 7265 2061 7869  e the entire axi
-0004ae10: 732e 0a20 2020 2020 2020 2063 6f6e 7374  s..        const
-0004ae20: 616e 745f 7661 6c75 6573 203a 2073 6361  ant_values : sca
-0004ae30: 6c61 722c 2074 7570 6c65 206f 7220 6d61  lar, tuple or ma
-0004ae40: 7070 696e 6720 6f66 2068 6173 6861 626c  pping of hashabl
-0004ae50: 6520 746f 2074 7570 6c65 2c20 6465 6661  e to tuple, defa
-0004ae60: 756c 743a 2030 0a20 2020 2020 2020 2020  ult: 0.         
-0004ae70: 2020 2055 7365 6420 696e 2027 636f 6e73     Used in 'cons
-0004ae80: 7461 6e74 272e 2020 5468 6520 7661 6c75  tant'.  The valu
-0004ae90: 6573 2074 6f20 7365 7420 7468 6520 7061  es to set the pa
-0004aea0: 6464 6564 2076 616c 7565 7320 666f 7220  dded values for 
-0004aeb0: 6561 6368 0a20 2020 2020 2020 2020 2020  each.           
-0004aec0: 2061 7869 732e 0a20 2020 2020 2020 2020   axis..         
-0004aed0: 2020 2060 607b 6469 6d5f 313a 2028 6265     ``{dim_1: (be
-0004aee0: 666f 7265 5f31 2c20 6166 7465 725f 3129  fore_1, after_1)
-0004aef0: 2c20 2e2e 2e20 6469 6d5f 4e3a 2028 6265  , ... dim_N: (be
-0004af00: 666f 7265 5f4e 2c20 6166 7465 725f 4e29  fore_N, after_N)
-0004af10: 7d60 6020 756e 6971 7565 0a20 2020 2020  }`` unique.     
-0004af20: 2020 2020 2020 2070 6164 2063 6f6e 7374         pad const
-0004af30: 616e 7473 2061 6c6f 6e67 2065 6163 6820  ants along each 
-0004af40: 6469 6d65 6e73 696f 6e2e 0a20 2020 2020  dimension..     
-0004af50: 2020 2020 2020 2060 6028 2862 6566 6f72         ``((befor
-0004af60: 652c 2061 6674 6572 292c 2960 6020 7969  e, after),)`` yi
-0004af70: 656c 6473 2073 616d 6520 6265 666f 7265  elds same before
-0004af80: 2061 6e64 2061 6674 6572 2063 6f6e 7374   and after const
-0004af90: 616e 7473 2066 6f72 2065 6163 680a 2020  ants for each.  
-0004afa0: 2020 2020 2020 2020 2020 6469 6d65 6e73            dimens
-0004afb0: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
-0004afc0: 2060 6028 636f 6e73 7461 6e74 2c29 6060   ``(constant,)``
-0004afd0: 206f 7220 6060 636f 6e73 7461 6e74 6060   or ``constant``
-0004afe0: 2069 7320 6120 7368 6f72 7463 7574 2066   is a shortcut f
-0004aff0: 6f72 2060 6062 6566 6f72 6520 3d20 6166  or ``before = af
-0004b000: 7465 7220 3d20 636f 6e73 7461 6e74 6060  ter = constant``
-0004b010: 2066 6f72 0a20 2020 2020 2020 2020 2020   for.           
-0004b020: 2061 6c6c 2064 696d 656e 7369 6f6e 732e   all dimensions.
-0004b030: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
-0004b040: 6175 6c74 2069 7320 302e 0a20 2020 2020  ault is 0..     
-0004b050: 2020 2065 6e64 5f76 616c 7565 7320 3a20     end_values : 
-0004b060: 7363 616c 6172 2c20 7475 706c 6520 6f72  scalar, tuple or
-0004b070: 206d 6170 7069 6e67 206f 6620 6861 7368   mapping of hash
-0004b080: 6162 6c65 2074 6f20 7475 706c 652c 2064  able to tuple, d
-0004b090: 6566 6175 6c74 3a20 300a 2020 2020 2020  efault: 0.      
-0004b0a0: 2020 2020 2020 5573 6564 2069 6e20 276c        Used in 'l
-0004b0b0: 696e 6561 725f 7261 6d70 272e 2020 5468  inear_ramp'.  Th
-0004b0c0: 6520 7661 6c75 6573 2075 7365 6420 666f  e values used fo
-0004b0d0: 7220 7468 6520 656e 6469 6e67 2076 616c  r the ending val
-0004b0e0: 7565 206f 6620 7468 650a 2020 2020 2020  ue of the.      
-0004b0f0: 2020 2020 2020 6c69 6e65 6172 5f72 616d        linear_ram
-0004b100: 7020 616e 6420 7468 6174 2077 696c 6c20  p and that will 
-0004b110: 666f 726d 2074 6865 2065 6467 6520 6f66  form the edge of
-0004b120: 2074 6865 2070 6164 6465 6420 6172 7261   the padded arra
-0004b130: 792e 0a20 2020 2020 2020 2020 2020 2060  y..            `
-0004b140: 607b 6469 6d5f 313a 2028 6265 666f 7265  `{dim_1: (before
-0004b150: 5f31 2c20 6166 7465 725f 3129 2c20 2e2e  _1, after_1), ..
-0004b160: 2e20 6469 6d5f 4e3a 2028 6265 666f 7265  . dim_N: (before
-0004b170: 5f4e 2c20 6166 7465 725f 4e29 7d60 6020  _N, after_N)}`` 
-0004b180: 756e 6971 7565 0a20 2020 2020 2020 2020  unique.         
-0004b190: 2020 2065 6e64 2076 616c 7565 7320 616c     end values al
-0004b1a0: 6f6e 6720 6561 6368 2064 696d 656e 7369  ong each dimensi
-0004b1b0: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
-0004b1c0: 6060 2828 6265 666f 7265 2c20 6166 7465  ``((before, afte
-0004b1d0: 7229 2c29 6060 2079 6965 6c64 7320 7361  r),)`` yields sa
-0004b1e0: 6d65 2062 6566 6f72 6520 616e 6420 6166  me before and af
-0004b1f0: 7465 7220 656e 6420 7661 6c75 6573 2066  ter end values f
-0004b200: 6f72 2065 6163 680a 2020 2020 2020 2020  or each.        
-0004b210: 2020 2020 6178 6973 2e0a 2020 2020 2020      axis..      
-0004b220: 2020 2020 2020 6060 2863 6f6e 7374 616e        ``(constan
-0004b230: 742c 2960 6020 6f72 2060 6063 6f6e 7374  t,)`` or ``const
-0004b240: 616e 7460 6020 6973 2061 2073 686f 7274  ant`` is a short
-0004b250: 6375 7420 666f 7220 6060 6265 666f 7265  cut for ``before
-0004b260: 203d 2061 6674 6572 203d 2063 6f6e 7374   = after = const
-0004b270: 616e 7460 6020 666f 720a 2020 2020 2020  ant`` for.      
-0004b280: 2020 2020 2020 616c 6c20 6178 6573 2e0a        all axes..
-0004b290: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
-0004b2a0: 756c 7420 6973 2030 2e0a 2020 2020 2020  ult is 0..      
-0004b2b0: 2020 7265 666c 6563 745f 7479 7065 203a    reflect_type :
-0004b2c0: 207b 2265 7665 6e22 2c20 226f 6464 222c   {"even", "odd",
-0004b2d0: 204e 6f6e 657d 2c20 6f70 7469 6f6e 616c   None}, optional
-0004b2e0: 0a20 2020 2020 2020 2020 2020 2055 7365  .            Use
-0004b2f0: 6420 696e 2022 7265 666c 6563 7422 2c20  d in "reflect", 
-0004b300: 616e 6420 2273 796d 6d65 7472 6963 222e  and "symmetric".
-0004b310: 2020 5468 6520 2265 7665 6e22 2073 7479    The "even" sty
-0004b320: 6c65 2069 7320 7468 650a 2020 2020 2020  le is the.      
-0004b330: 2020 2020 2020 6465 6661 756c 7420 7769        default wi
-0004b340: 7468 2061 6e20 756e 616c 7465 7265 6420  th an unaltered 
-0004b350: 7265 666c 6563 7469 6f6e 2061 726f 756e  reflection aroun
-0004b360: 6420 7468 6520 6564 6765 2076 616c 7565  d the edge value
-0004b370: 2e20 2046 6f72 0a20 2020 2020 2020 2020  .  For.         
-0004b380: 2020 2074 6865 2022 6f64 6422 2073 7479     the "odd" sty
-0004b390: 6c65 2c20 7468 6520 6578 7465 6e64 6564  le, the extended
-0004b3a0: 2070 6172 7420 6f66 2074 6865 2061 7272   part of the arr
-0004b3b0: 6179 2069 7320 6372 6561 7465 6420 6279  ay is created by
-0004b3c0: 0a20 2020 2020 2020 2020 2020 2073 7562  .            sub
-0004b3d0: 7472 6163 7469 6e67 2074 6865 2072 6566  tracting the ref
-0004b3e0: 6c65 6374 6564 2076 616c 7565 7320 6672  lected values fr
-0004b3f0: 6f6d 2074 776f 2074 696d 6573 2074 6865  om two times the
-0004b400: 2065 6467 6520 7661 6c75 652e 0a20 2020   edge value..   
-0004b410: 2020 2020 206b 6565 705f 6174 7472 7320       keep_attrs 
-0004b420: 3a20 626f 6f6c 206f 7220 4e6f 6e65 2c20  : bool or None, 
-0004b430: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0004b440: 2020 2020 2049 6620 5472 7565 2c20 7468       If True, th
-0004b450: 6520 6174 7472 6962 7574 6573 2028 6060  e attributes (``
-0004b460: 6174 7472 7360 6029 2077 696c 6c20 6265  attrs``) will be
-0004b470: 2063 6f70 6965 6420 6672 6f6d 2074 6865   copied from the
-0004b480: 0a20 2020 2020 2020 2020 2020 206f 7269  .            ori
-0004b490: 6769 6e61 6c20 6f62 6a65 6374 2074 6f20  ginal object to 
-0004b4a0: 7468 6520 6e65 7720 6f6e 652e 2049 6620  the new one. If 
-0004b4b0: 4661 6c73 652c 2074 6865 206e 6577 206f  False, the new o
-0004b4c0: 626a 6563 740a 2020 2020 2020 2020 2020  bject.          
-0004b4d0: 2020 7769 6c6c 2062 6520 7265 7475 726e    will be return
-0004b4e0: 6564 2077 6974 686f 7574 2061 7474 7269  ed without attri
-0004b4f0: 6275 7465 732e 0a20 2020 2020 2020 202a  butes..        *
-0004b500: 2a70 6164 5f77 6964 7468 5f6b 7761 7267  *pad_width_kwarg
-0004b510: 730a 2020 2020 2020 2020 2020 2020 5468  s.            Th
-0004b520: 6520 6b65 7977 6f72 6420 6172 6775 6d65  e keyword argume
-0004b530: 6e74 7320 666f 726d 206f 6620 6060 7061  nts form of ``pa
-0004b540: 645f 7769 6474 6860 602e 0a20 2020 2020  d_width``..     
-0004b550: 2020 2020 2020 204f 6e65 206f 6620 6060         One of ``
-0004b560: 7061 645f 7769 6474 6860 6020 6f72 2060  pad_width`` or `
-0004b570: 6070 6164 5f77 6964 7468 5f6b 7761 7267  `pad_width_kwarg
-0004b580: 7360 6020 6d75 7374 2062 6520 7072 6f76  s`` must be prov
-0004b590: 6964 6564 2e0a 0a20 2020 2020 2020 2052  ided...        R
-0004b5a0: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
-0004b5b0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2070  ------.        p
-0004b5c0: 6164 6465 6420 3a20 4461 7461 7365 740a  added : Dataset.
-0004b5d0: 2020 2020 2020 2020 2020 2020 4461 7461              Data
-0004b5e0: 7365 7420 7769 7468 2074 6865 2070 6164  set with the pad
-0004b5f0: 6465 6420 636f 6f72 6469 6e61 7465 7320  ded coordinates 
-0004b600: 616e 6420 6461 7461 2e0a 0a20 2020 2020  and data...     
-0004b610: 2020 2053 6565 2041 6c73 6f0a 2020 2020     See Also.    
-0004b620: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
-0004b630: 2020 2020 2044 6174 6173 6574 2e73 6869       Dataset.shi
-0004b640: 6674 2c20 4461 7461 7365 742e 726f 6c6c  ft, Dataset.roll
-0004b650: 2c20 4461 7461 7365 742e 6266 696c 6c2c  , Dataset.bfill,
-0004b660: 2044 6174 6173 6574 2e66 6669 6c6c 2c20   Dataset.ffill, 
-0004b670: 6e75 6d70 792e 7061 642c 2064 6173 6b2e  numpy.pad, dask.
-0004b680: 6172 7261 792e 7061 640a 0a20 2020 2020  array.pad..     
-0004b690: 2020 204e 6f74 6573 0a20 2020 2020 2020     Notes.       
-0004b6a0: 202d 2d2d 2d2d 0a20 2020 2020 2020 2042   -----.        B
-0004b6b0: 7920 6465 6661 756c 7420 7768 656e 2060  y default when `
-0004b6c0: 606d 6f64 653d 2263 6f6e 7374 616e 7422  `mode="constant"
-0004b6d0: 6060 2061 6e64 2060 6063 6f6e 7374 616e  `` and ``constan
-0004b6e0: 745f 7661 6c75 6573 3d4e 6f6e 6560 602c  t_values=None``,
-0004b6f0: 2069 6e74 6567 6572 2074 7970 6573 2077   integer types w
-0004b700: 696c 6c20 6265 0a20 2020 2020 2020 2070  ill be.        p
-0004b710: 726f 6d6f 7465 6420 746f 2060 6066 6c6f  romoted to ``flo
-0004b720: 6174 6060 2061 6e64 2070 6164 6465 6420  at`` and padded 
-0004b730: 7769 7468 2060 606e 702e 6e61 6e60 602e  with ``np.nan``.
-0004b740: 2054 6f20 6176 6f69 6420 7479 7065 2070   To avoid type p
-0004b750: 726f 6d6f 7469 6f6e 0a20 2020 2020 2020  romotion.       
-0004b760: 2073 7065 6369 6679 2060 6063 6f6e 7374   specify ``const
-0004b770: 616e 745f 7661 6c75 6573 3d6e 702e 6e61  ant_values=np.na
-0004b780: 6e60 600a 0a20 2020 2020 2020 2050 6164  n``..        Pad
-0004b790: 6469 6e67 2063 6f6f 7264 696e 6174 6573  ding coordinates
-0004b7a0: 2077 696c 6c20 6472 6f70 2074 6865 6972   will drop their
-0004b7b0: 2063 6f72 7265 7370 6f6e 6469 6e67 2069   corresponding i
-0004b7c0: 6e64 6578 2028 6966 2061 6e79 2920 616e  ndex (if any) an
-0004b7d0: 6420 7769 6c6c 2072 6573 6574 2064 6566  d will reset def
-0004b7e0: 6175 6c74 0a20 2020 2020 2020 2069 6e64  ault.        ind
-0004b7f0: 6578 6573 2066 6f72 2064 696d 656e 7369  exes for dimensi
-0004b800: 6f6e 2063 6f6f 7264 696e 6174 6573 2e0a  on coordinates..
-0004b810: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-0004b820: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
-0004b830: 2d2d 0a20 2020 2020 2020 203e 3e3e 2064  --.        >>> d
-0004b840: 7320 3d20 7872 2e44 6174 6173 6574 287b  s = xr.Dataset({
-0004b850: 2266 6f6f 223a 2028 2278 222c 2072 616e  "foo": ("x", ran
-0004b860: 6765 2835 2929 7d29 0a20 2020 2020 2020  ge(5))}).       
-0004b870: 203e 3e3e 2064 732e 7061 6428 783d 2831   >>> ds.pad(x=(1
-0004b880: 2c20 3229 290a 2020 2020 2020 2020 3c78  , 2)).        <x
-0004b890: 6172 7261 792e 4461 7461 7365 743e 0a20  array.Dataset>. 
-0004b8a0: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
-0004b8b0: 733a 2020 2878 3a20 3829 0a20 2020 2020  s:  (x: 8).     
-0004b8c0: 2020 2044 696d 656e 7369 6f6e 7320 7769     Dimensions wi
-0004b8d0: 7468 6f75 7420 636f 6f72 6469 6e61 7465  thout coordinate
-0004b8e0: 733a 2078 0a20 2020 2020 2020 2044 6174  s: x.        Dat
-0004b8f0: 6120 7661 7269 6162 6c65 733a 0a20 2020  a variables:.   
-0004b900: 2020 2020 2020 2020 2066 6f6f 2020 2020           foo    
-0004b910: 2020 2878 2920 666c 6f61 7436 3420 6e61    (x) float64 na
-0004b920: 6e20 302e 3020 312e 3020 322e 3020 332e  n 0.0 1.0 2.0 3.
-0004b930: 3020 342e 3020 6e61 6e20 6e61 6e0a 2020  0 4.0 nan nan.  
-0004b940: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0004b950: 2020 7061 645f 7769 6474 6820 3d20 6569    pad_width = ei
-0004b960: 7468 6572 5f64 6963 745f 6f72 5f6b 7761  ther_dict_or_kwa
-0004b970: 7267 7328 7061 645f 7769 6474 682c 2070  rgs(pad_width, p
-0004b980: 6164 5f77 6964 7468 5f6b 7761 7267 732c  ad_width_kwargs,
-0004b990: 2022 7061 6422 290a 0a20 2020 2020 2020   "pad")..       
-0004b9a0: 2069 6620 6d6f 6465 2069 6e20 2822 6564   if mode in ("ed
-0004b9b0: 6765 222c 2022 7265 666c 6563 7422 2c20  ge", "reflect", 
-0004b9c0: 2273 796d 6d65 7472 6963 222c 2022 7772  "symmetric", "wr
-0004b9d0: 6170 2229 3a0a 2020 2020 2020 2020 2020  ap"):.          
-0004b9e0: 2020 636f 6f72 645f 7061 645f 6d6f 6465    coord_pad_mode
-0004b9f0: 203d 206d 6f64 650a 2020 2020 2020 2020   = mode.        
-0004ba00: 2020 2020 636f 6f72 645f 7061 645f 6f70      coord_pad_op
-0004ba10: 7469 6f6e 7320 3d20 7b0a 2020 2020 2020  tions = {.      
-0004ba20: 2020 2020 2020 2020 2020 2273 7461 745f            "stat_
-0004ba30: 6c65 6e67 7468 223a 2073 7461 745f 6c65  length": stat_le
-0004ba40: 6e67 7468 2c0a 2020 2020 2020 2020 2020  ngth,.          
-0004ba50: 2020 2020 2020 2263 6f6e 7374 616e 745f        "constant_
-0004ba60: 7661 6c75 6573 223a 2063 6f6e 7374 616e  values": constan
-0004ba70: 745f 7661 6c75 6573 2c0a 2020 2020 2020  t_values,.      
-0004ba80: 2020 2020 2020 2020 2020 2265 6e64 5f76            "end_v
-0004ba90: 616c 7565 7322 3a20 656e 645f 7661 6c75  alues": end_valu
-0004baa0: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
-0004bab0: 2020 2020 2272 6566 6c65 6374 5f74 7970      "reflect_typ
-0004bac0: 6522 3a20 7265 666c 6563 745f 7479 7065  e": reflect_type
-0004bad0: 2c0a 2020 2020 2020 2020 2020 2020 7d0a  ,.            }.
-0004bae0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-0004baf0: 2020 2020 2020 2020 2020 636f 6f72 645f            coord_
-0004bb00: 7061 645f 6d6f 6465 203d 2022 636f 6e73  pad_mode = "cons
-0004bb10: 7461 6e74 220a 2020 2020 2020 2020 2020  tant".          
-0004bb20: 2020 636f 6f72 645f 7061 645f 6f70 7469    coord_pad_opti
-0004bb30: 6f6e 7320 3d20 7b7d 0a0a 2020 2020 2020  ons = {}..      
-0004bb40: 2020 6966 206b 6565 705f 6174 7472 7320    if keep_attrs 
-0004bb50: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0004bb60: 2020 2020 206b 6565 705f 6174 7472 7320       keep_attrs 
-0004bb70: 3d20 5f67 6574 5f6b 6565 705f 6174 7472  = _get_keep_attr
-0004bb80: 7328 6465 6661 756c 743d 5472 7565 290a  s(default=True).
-0004bb90: 0a20 2020 2020 2020 2076 6172 6961 626c  .        variabl
-0004bba0: 6573 203d 207b 7d0a 0a20 2020 2020 2020  es = {}..       
-0004bbb0: 2023 206b 6565 7020 696e 6465 7865 7320   # keep indexes 
-0004bbc0: 7468 6174 2077 6f6e 2774 2062 6520 6166  that won't be af
-0004bbd0: 6665 6374 6564 2062 7920 7061 6420 616e  fected by pad an
-0004bbe0: 6420 6472 6f70 2061 6c6c 206f 7468 6572  d drop all other
-0004bbf0: 2069 6e64 6578 6573 0a20 2020 2020 2020   indexes.       
-0004bc00: 2078 696e 6465 7865 7320 3d20 7365 6c66   xindexes = self
-0004bc10: 2e78 696e 6465 7865 730a 2020 2020 2020  .xindexes.      
-0004bc20: 2020 7061 645f 6469 6d73 203d 2073 6574    pad_dims = set
-0004bc30: 2870 6164 5f77 6964 7468 290a 2020 2020  (pad_width).    
-0004bc40: 2020 2020 696e 6465 7865 7320 3d20 7b7d      indexes = {}
-0004bc50: 0a20 2020 2020 2020 2066 6f72 206b 2c20  .        for k, 
-0004bc60: 6964 7820 696e 2078 696e 6465 7865 732e  idx in xindexes.
-0004bc70: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
-0004bc80: 2020 2020 2069 6620 6e6f 7420 7061 645f       if not pad_
-0004bc90: 6469 6d73 2e69 6e74 6572 7365 6374 696f  dims.intersectio
-0004bca0: 6e28 7869 6e64 6578 6573 2e67 6574 5f61  n(xindexes.get_a
-0004bcb0: 6c6c 5f64 696d 7328 6b29 293a 0a20 2020  ll_dims(k)):.   
-0004bcc0: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
-0004bcd0: 6578 6573 5b6b 5d20 3d20 6964 780a 0a20  exes[k] = idx.. 
-0004bce0: 2020 2020 2020 2066 6f72 206e 616d 652c         for name,
-0004bcf0: 2076 6172 2069 6e20 7365 6c66 2e76 6172   var in self.var
-0004bd00: 6961 626c 6573 2e69 7465 6d73 2829 3a0a  iables.items():.
-0004bd10: 2020 2020 2020 2020 2020 2020 7661 725f              var_
-0004bd20: 7061 645f 7769 6474 6820 3d20 7b6b 3a20  pad_width = {k: 
-0004bd30: 7620 666f 7220 6b2c 2076 2069 6e20 7061  v for k, v in pa
-0004bd40: 645f 7769 6474 682e 6974 656d 7328 2920  d_width.items() 
-0004bd50: 6966 206b 2069 6e20 7661 722e 6469 6d73  if k in var.dims
-0004bd60: 7d0a 2020 2020 2020 2020 2020 2020 6966  }.            if
-0004bd70: 206e 6f74 2076 6172 5f70 6164 5f77 6964   not var_pad_wid
-0004bd80: 7468 3a0a 2020 2020 2020 2020 2020 2020  th:.            
-0004bd90: 2020 2020 7661 7269 6162 6c65 735b 6e61      variables[na
-0004bda0: 6d65 5d20 3d20 7661 720a 2020 2020 2020  me] = var.      
-0004bdb0: 2020 2020 2020 656c 6966 206e 616d 6520        elif name 
-0004bdc0: 696e 2073 656c 662e 6461 7461 5f76 6172  in self.data_var
-0004bdd0: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0004bde0: 2020 2076 6172 6961 626c 6573 5b6e 616d     variables[nam
-0004bdf0: 655d 203d 2076 6172 2e70 6164 280a 2020  e] = var.pad(.  
-0004be00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004be10: 2020 7061 645f 7769 6474 683d 7661 725f    pad_width=var_
-0004be20: 7061 645f 7769 6474 682c 0a20 2020 2020  pad_width,.     
-0004be30: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0004be40: 6f64 653d 6d6f 6465 2c0a 2020 2020 2020  ode=mode,.      
-0004be50: 2020 2020 2020 2020 2020 2020 2020 7374                st
-0004be60: 6174 5f6c 656e 6774 683d 7374 6174 5f6c  at_length=stat_l
-0004be70: 656e 6774 682c 0a20 2020 2020 2020 2020  ength,.         
-0004be80: 2020 2020 2020 2020 2020 2063 6f6e 7374             const
-0004be90: 616e 745f 7661 6c75 6573 3d63 6f6e 7374  ant_values=const
-0004bea0: 616e 745f 7661 6c75 6573 2c0a 2020 2020  ant_values,.    
-0004beb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bec0: 656e 645f 7661 6c75 6573 3d65 6e64 5f76  end_values=end_v
-0004bed0: 616c 7565 732c 0a20 2020 2020 2020 2020  alues,.         
-0004bee0: 2020 2020 2020 2020 2020 2072 6566 6c65             refle
-0004bef0: 6374 5f74 7970 653d 7265 666c 6563 745f  ct_type=reflect_
-0004bf00: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
-0004bf10: 2020 2020 2020 2020 2020 6b65 6570 5f61            keep_a
-0004bf20: 7474 7273 3d6b 6565 705f 6174 7472 732c  ttrs=keep_attrs,
-0004bf30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004bf40: 2029 0a20 2020 2020 2020 2020 2020 2065   ).            e
-0004bf50: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-0004bf60: 2020 2020 2076 6172 6961 626c 6573 5b6e       variables[n
-0004bf70: 616d 655d 203d 2076 6172 2e70 6164 280a  ame] = var.pad(.
-0004bf80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bf90: 2020 2020 7061 645f 7769 6474 683d 7661      pad_width=va
-0004bfa0: 725f 7061 645f 7769 6474 682c 0a20 2020  r_pad_width,.   
-0004bfb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004bfc0: 206d 6f64 653d 636f 6f72 645f 7061 645f   mode=coord_pad_
-0004bfd0: 6d6f 6465 2c0a 2020 2020 2020 2020 2020  mode,.          
-0004bfe0: 2020 2020 2020 2020 2020 6b65 6570 5f61            keep_a
-0004bff0: 7474 7273 3d6b 6565 705f 6174 7472 732c  ttrs=keep_attrs,
-0004c000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0004c010: 2020 2020 202a 2a63 6f6f 7264 5f70 6164       **coord_pad
-0004c020: 5f6f 7074 696f 6e73 2c20 2023 2074 7970  _options,  # typ
-0004c030: 653a 2069 676e 6f72 655b 6172 672d 7479  e: ignore[arg-ty
-0004c040: 7065 5d0a 2020 2020 2020 2020 2020 2020  pe].            
-0004c050: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-0004c060: 2020 2020 2020 2320 7265 7365 7420 6465        # reset de
-0004c070: 6661 756c 7420 696e 6465 7820 6f66 2064  fault index of d
-0004c080: 696d 656e 7369 6f6e 2063 6f6f 7264 696e  imension coordin
-0004c090: 6174 6573 0a20 2020 2020 2020 2020 2020  ates.           
-0004c0a0: 2020 2020 2069 6620 286e 616d 652c 2920       if (name,) 
-0004c0b0: 3d3d 2076 6172 2e64 696d 733a 0a20 2020  == var.dims:.   
+000450c0: 2020 2069 6620 6375 6d75 6c61 7469 7665     if cumulative
+000450d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000450e0: 2020 2020 2020 2020 2020 696e 7465 6720            integ 
+000450f0: 3d20 6475 636b 5f61 7272 6179 5f6f 7073  = duck_array_ops
+00045100: 2e63 756d 756c 6174 6976 655f 7472 6170  .cumulative_trap
+00045110: 657a 6f69 6428 0a20 2020 2020 2020 2020  ezoid(.         
+00045120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045130: 2020 2076 2e64 6174 612c 2063 6f6f 7264     v.data, coord
+00045140: 5f76 6172 2e64 6174 612c 2061 7869 733d  _var.data, axis=
+00045150: 762e 6765 745f 6178 6973 5f6e 756d 2864  v.get_axis_num(d
+00045160: 696d 290a 2020 2020 2020 2020 2020 2020  im).            
+00045170: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00045180: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045190: 2020 2020 2020 765f 6469 6d73 203d 2076        v_dims = v
+000451a0: 2e64 696d 730a 2020 2020 2020 2020 2020  .dims.          
+000451b0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000451c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000451d0: 2020 2020 2020 2020 696e 7465 6720 3d20          integ = 
+000451e0: 6475 636b 5f61 7272 6179 5f6f 7073 2e74  duck_array_ops.t
+000451f0: 7261 707a 280a 2020 2020 2020 2020 2020  rapz(.          
+00045200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045210: 2020 762e 6461 7461 2c20 636f 6f72 645f    v.data, coord_
+00045220: 7661 722e 6461 7461 2c20 6178 6973 3d76  var.data, axis=v
+00045230: 2e67 6574 5f61 7869 735f 6e75 6d28 6469  .get_axis_num(di
+00045240: 6d29 0a20 2020 2020 2020 2020 2020 2020  m).             
+00045250: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00045260: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045270: 2020 2020 2076 5f64 696d 7320 3d20 6c69       v_dims = li
+00045280: 7374 2876 2e64 696d 7329 0a20 2020 2020  st(v.dims).     
+00045290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000452a0: 2020 2076 5f64 696d 732e 7265 6d6f 7665     v_dims.remove
+000452b0: 2864 696d 290a 2020 2020 2020 2020 2020  (dim).          
+000452c0: 2020 2020 2020 2020 2020 7661 7269 6162            variab
+000452d0: 6c65 735b 6b5d 203d 2056 6172 6961 626c  les[k] = Variabl
+000452e0: 6528 765f 6469 6d73 2c20 696e 7465 6729  e(v_dims, integ)
+000452f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00045300: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00045310: 2020 2020 2020 2020 2020 2076 6172 6961             varia
+00045320: 626c 6573 5b6b 5d20 3d20 760a 2020 2020  bles[k] = v.    
+00045330: 2020 2020 696e 6465 7865 7320 3d20 7b6b      indexes = {k
+00045340: 3a20 7620 666f 7220 6b2c 2076 2069 6e20  : v for k, v in 
+00045350: 7365 6c66 2e5f 696e 6465 7865 732e 6974  self._indexes.it
+00045360: 656d 7328 2920 6966 206b 2069 6e20 7661  ems() if k in va
+00045370: 7269 6162 6c65 737d 0a20 2020 2020 2020  riables}.       
+00045380: 2072 6574 7572 6e20 7365 6c66 2e5f 7265   return self._re
+00045390: 706c 6163 655f 7769 7468 5f6e 6577 5f64  place_with_new_d
+000453a0: 696d 7328 0a20 2020 2020 2020 2020 2020  ims(.           
+000453b0: 2076 6172 6961 626c 6573 2c20 636f 6f72   variables, coor
+000453c0: 645f 6e61 6d65 733d 636f 6f72 645f 6e61  d_names=coord_na
+000453d0: 6d65 732c 2069 6e64 6578 6573 3d69 6e64  mes, indexes=ind
+000453e0: 6578 6573 0a20 2020 2020 2020 2029 0a0a  exes.        )..
+000453f0: 2020 2020 6465 6620 6375 6d75 6c61 7469      def cumulati
+00045400: 7665 5f69 6e74 6567 7261 7465 280a 2020  ve_integrate(.  
+00045410: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
+00045420: 7461 7365 742c 0a20 2020 2020 2020 2063  taset,.        c
+00045430: 6f6f 7264 3a20 4861 7368 6162 6c65 207c  oord: Hashable |
+00045440: 2053 6571 7565 6e63 655b 4861 7368 6162   Sequence[Hashab
+00045450: 6c65 5d2c 0a20 2020 2020 2020 2064 6174  le],.        dat
+00045460: 6574 696d 655f 756e 6974 3a20 4461 7465  etime_unit: Date
+00045470: 7469 6d65 556e 6974 4f70 7469 6f6e 7320  timeUnitOptions 
+00045480: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
+00045490: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
+000454a0: 2020 2020 2222 2249 6e74 6567 7261 7465      """Integrate
+000454b0: 2061 6c6f 6e67 2074 6865 2067 6976 656e   along the given
+000454c0: 2063 6f6f 7264 696e 6174 6520 7573 696e   coordinate usin
+000454d0: 6720 7468 6520 7472 6170 657a 6f69 6461  g the trapezoida
+000454e0: 6c20 7275 6c65 2e0a 0a20 2020 2020 2020  l rule...       
+000454f0: 202e 2e20 6e6f 7465 3a3a 0a20 2020 2020   .. note::.     
+00045500: 2020 2020 2020 2054 6869 7320 6665 6174         This feat
+00045510: 7572 6520 6973 206c 696d 6974 6564 2074  ure is limited t
+00045520: 6f20 7369 6d70 6c65 2063 6172 7465 7369  o simple cartesi
+00045530: 616e 2067 656f 6d65 7472 792c 2069 2e65  an geometry, i.e
+00045540: 2e20 636f 6f72 640a 2020 2020 2020 2020  . coord.        
+00045550: 2020 2020 6d75 7374 2062 6520 6f6e 6520      must be one 
+00045560: 6469 6d65 6e73 696f 6e61 6c2e 0a0a 2020  dimensional...  
+00045570: 2020 2020 2020 2020 2020 5468 6520 6669            The fi
+00045580: 7273 7420 656e 7472 7920 6f66 2074 6865  rst entry of the
+00045590: 2063 756d 756c 6174 6976 6520 696e 7465   cumulative inte
+000455a0: 6772 616c 206f 6620 6561 6368 2076 6172  gral of each var
+000455b0: 6961 626c 6520 6973 2061 6c77 6179 7320  iable is always 
+000455c0: 302c 2069 6e0a 2020 2020 2020 2020 2020  0, in.          
+000455d0: 2020 6f72 6465 7220 746f 206b 6565 7020    order to keep 
+000455e0: 7468 6520 6c65 6e67 7468 206f 6620 7468  the length of th
+000455f0: 6520 6469 6d65 6e73 696f 6e20 756e 6368  e dimension unch
+00045600: 616e 6765 6420 6265 7477 6565 6e20 696e  anged between in
+00045610: 7075 7420 616e 640a 2020 2020 2020 2020  put and.        
+00045620: 2020 2020 6f75 7470 7574 2e0a 0a20 2020      output...   
+00045630: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+00045640: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00045650: 2d2d 0a20 2020 2020 2020 2063 6f6f 7264  --.        coord
+00045660: 203a 2068 6173 6861 626c 652c 206f 7220   : hashable, or 
+00045670: 7365 7175 656e 6365 206f 6620 6861 7368  sequence of hash
+00045680: 6162 6c65 0a20 2020 2020 2020 2020 2020  able.           
+00045690: 2043 6f6f 7264 696e 6174 6528 7329 2075   Coordinate(s) u
+000456a0: 7365 6420 666f 7220 7468 6520 696e 7465  sed for the inte
+000456b0: 6772 6174 696f 6e2e 0a20 2020 2020 2020  gration..       
+000456c0: 2064 6174 6574 696d 655f 756e 6974 203a   datetime_unit :
+000456d0: 207b 2759 272c 2027 4d27 2c20 2757 272c   {'Y', 'M', 'W',
+000456e0: 2027 4427 2c20 2768 272c 2027 6d27 2c20   'D', 'h', 'm', 
+000456f0: 2773 272c 2027 6d73 272c 2027 7573 272c  's', 'ms', 'us',
+00045700: 2027 6e73 272c 205c 0a20 2020 2020 2020   'ns', \.       
+00045710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00045720: 2027 7073 272c 2027 6673 272c 2027 6173   'ps', 'fs', 'as
+00045730: 272c 204e 6f6e 657d 2c20 6f70 7469 6f6e  ', None}, option
+00045740: 616c 0a20 2020 2020 2020 2020 2020 2053  al.            S
+00045750: 7065 6369 6679 2074 6865 2075 6e69 7420  pecify the unit 
+00045760: 6966 2064 6174 6574 696d 6520 636f 6f72  if datetime coor
+00045770: 6469 6e61 7465 2069 7320 7573 6564 2e0a  dinate is used..
+00045780: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00045790: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000457a0: 0a20 2020 2020 2020 2069 6e74 6567 7261  .        integra
+000457b0: 7465 6420 3a20 4461 7461 7365 740a 0a20  ted : Dataset.. 
+000457c0: 2020 2020 2020 2053 6565 2061 6c73 6f0a         See also.
+000457d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000457e0: 0a20 2020 2020 2020 2044 6174 6141 7272  .        DataArr
+000457f0: 6179 2e63 756d 756c 6174 6976 655f 696e  ay.cumulative_in
+00045800: 7465 6772 6174 650a 2020 2020 2020 2020  tegrate.        
+00045810: 7363 6970 792e 696e 7465 6772 6174 652e  scipy.integrate.
+00045820: 6375 6d75 6c61 7469 7665 5f74 7261 7065  cumulative_trape
+00045830: 7a6f 6964 203a 2063 6f72 7265 7370 6f6e  zoid : correspon
+00045840: 6469 6e67 2073 6369 7079 2066 756e 6374  ding scipy funct
+00045850: 696f 6e0a 0a20 2020 2020 2020 2045 7861  ion..        Exa
+00045860: 6d70 6c65 730a 2020 2020 2020 2020 2d2d  mples.        --
+00045870: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 203e  ------.        >
+00045880: 3e3e 2064 7320 3d20 7872 2e44 6174 6173  >> ds = xr.Datas
+00045890: 6574 280a 2020 2020 2020 2020 2e2e 2e20  et(.        ... 
+000458a0: 2020 2020 6461 7461 5f76 6172 733d 7b22      data_vars={"
+000458b0: 6122 3a20 2822 7822 2c20 5b35 2c20 352c  a": ("x", [5, 5,
+000458c0: 2036 2c20 365d 292c 2022 6222 3a20 2822   6, 6]), "b": ("
+000458d0: 7822 2c20 5b31 2c20 322c 2031 2c20 305d  x", [1, 2, 1, 0]
+000458e0: 297d 2c0a 2020 2020 2020 2020 2e2e 2e20  )},.        ... 
+000458f0: 2020 2020 636f 6f72 6473 3d7b 2278 223a      coords={"x":
+00045900: 205b 302c 2031 2c20 322c 2033 5d2c 2022   [0, 1, 2, 3], "
+00045910: 7922 3a20 2822 7822 2c20 5b31 2c20 372c  y": ("x", [1, 7,
+00045920: 2033 2c20 355d 297d 2c0a 2020 2020 2020   3, 5])},.      
+00045930: 2020 2e2e 2e20 290a 2020 2020 2020 2020    ... ).        
+00045940: 3e3e 3e20 6473 0a20 2020 2020 2020 203c  >>> ds.        <
+00045950: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
+00045960: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+00045970: 6e73 3a20 2028 783a 2034 290a 2020 2020  ns:  (x: 4).    
+00045980: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
+00045990: 0a20 2020 2020 2020 2020 202a 2078 2020  .          * x  
+000459a0: 2020 2020 2020 2878 2920 696e 7436 3420        (x) int64 
+000459b0: 3020 3120 3220 330a 2020 2020 2020 2020  0 1 2 3.        
+000459c0: 2020 2020 7920 2020 2020 2020 2028 7829      y        (x)
+000459d0: 2069 6e74 3634 2031 2037 2033 2035 0a20   int64 1 7 3 5. 
+000459e0: 2020 2020 2020 2044 6174 6120 7661 7269         Data vari
+000459f0: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
+00045a00: 2020 2061 2020 2020 2020 2020 2878 2920     a        (x) 
+00045a10: 696e 7436 3420 3520 3520 3620 360a 2020  int64 5 5 6 6.  
+00045a20: 2020 2020 2020 2020 2020 6220 2020 2020            b     
+00045a30: 2020 2028 7829 2069 6e74 3634 2031 2032     (x) int64 1 2
+00045a40: 2031 2030 0a20 2020 2020 2020 203e 3e3e   1 0.        >>>
+00045a50: 2064 732e 6375 6d75 6c61 7469 7665 5f69   ds.cumulative_i
+00045a60: 6e74 6567 7261 7465 2822 7822 290a 2020  ntegrate("x").  
+00045a70: 2020 2020 2020 3c78 6172 7261 792e 4461        <xarray.Da
+00045a80: 7461 7365 743e 0a20 2020 2020 2020 2044  taset>.        D
+00045a90: 696d 656e 7369 6f6e 733a 2020 2878 3a20  imensions:  (x: 
+00045aa0: 3429 0a20 2020 2020 2020 2043 6f6f 7264  4).        Coord
+00045ab0: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
+00045ac0: 2020 2a20 7820 2020 2020 2020 2028 7829    * x        (x)
+00045ad0: 2069 6e74 3634 2030 2031 2032 2033 0a20   int64 0 1 2 3. 
+00045ae0: 2020 2020 2020 2020 2020 2079 2020 2020             y    
+00045af0: 2020 2020 2878 2920 696e 7436 3420 3120      (x) int64 1 
+00045b00: 3720 3320 350a 2020 2020 2020 2020 4461  7 3 5.        Da
+00045b10: 7461 2076 6172 6961 626c 6573 3a0a 2020  ta variables:.  
+00045b20: 2020 2020 2020 2020 2020 6120 2020 2020            a     
+00045b30: 2020 2028 7829 2066 6c6f 6174 3634 2030     (x) float64 0
+00045b40: 2e30 2035 2e30 2031 302e 3520 3136 2e35  .0 5.0 10.5 16.5
+00045b50: 0a20 2020 2020 2020 2020 2020 2062 2020  .            b  
+00045b60: 2020 2020 2020 2878 2920 666c 6f61 7436        (x) float6
+00045b70: 3420 302e 3020 312e 3520 332e 3020 332e  4 0.0 1.5 3.0 3.
+00045b80: 350a 2020 2020 2020 2020 3e3e 3e20 6473  5.        >>> ds
+00045b90: 2e63 756d 756c 6174 6976 655f 696e 7465  .cumulative_inte
+00045ba0: 6772 6174 6528 2279 2229 0a20 2020 2020  grate("y").     
+00045bb0: 2020 203c 7861 7272 6179 2e44 6174 6173     <xarray.Datas
+00045bc0: 6574 3e0a 2020 2020 2020 2020 4469 6d65  et>.        Dime
+00045bd0: 6e73 696f 6e73 3a20 2028 783a 2034 290a  nsions:  (x: 4).
+00045be0: 2020 2020 2020 2020 436f 6f72 6469 6e61          Coordina
+00045bf0: 7465 733a 0a20 2020 2020 2020 2020 202a  tes:.          *
+00045c00: 2078 2020 2020 2020 2020 2878 2920 696e   x        (x) in
+00045c10: 7436 3420 3020 3120 3220 330a 2020 2020  t64 0 1 2 3.    
+00045c20: 2020 2020 2020 2020 7920 2020 2020 2020          y       
+00045c30: 2028 7829 2069 6e74 3634 2031 2037 2033   (x) int64 1 7 3
+00045c40: 2035 0a20 2020 2020 2020 2044 6174 6120   5.        Data 
+00045c50: 7661 7269 6162 6c65 733a 0a20 2020 2020  variables:.     
+00045c60: 2020 2020 2020 2061 2020 2020 2020 2020         a        
+00045c70: 2878 2920 666c 6f61 7436 3420 302e 3020  (x) float64 0.0 
+00045c80: 3330 2e30 2038 2e30 2032 302e 300a 2020  30.0 8.0 20.0.  
+00045c90: 2020 2020 2020 2020 2020 6220 2020 2020            b     
+00045ca0: 2020 2028 7829 2066 6c6f 6174 3634 2030     (x) float64 0
+00045cb0: 2e30 2039 2e30 2033 2e30 2034 2e30 0a20  .0 9.0 3.0 4.0. 
+00045cc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00045cd0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00045ce0: 616e 6365 2863 6f6f 7264 2c20 286c 6973  ance(coord, (lis
+00045cf0: 742c 2074 7570 6c65 2929 3a0a 2020 2020  t, tuple)):.    
+00045d00: 2020 2020 2020 2020 636f 6f72 6420 3d20          coord = 
+00045d10: 2863 6f6f 7264 2c29 0a20 2020 2020 2020  (coord,).       
+00045d20: 2072 6573 756c 7420 3d20 7365 6c66 0a20   result = self. 
+00045d30: 2020 2020 2020 2066 6f72 2063 2069 6e20         for c in 
+00045d40: 636f 6f72 643a 0a20 2020 2020 2020 2020  coord:.         
+00045d50: 2020 2072 6573 756c 7420 3d20 7265 7375     result = resu
+00045d60: 6c74 2e5f 696e 7465 6772 6174 655f 6f6e  lt._integrate_on
+00045d70: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00045d80: 2020 2063 2c20 6461 7465 7469 6d65 5f75     c, datetime_u
+00045d90: 6e69 743d 6461 7465 7469 6d65 5f75 6e69  nit=datetime_uni
+00045da0: 742c 2063 756d 756c 6174 6976 653d 5472  t, cumulative=Tr
+00045db0: 7565 0a20 2020 2020 2020 2020 2020 2029  ue.            )
+00045dc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00045dd0: 7265 7375 6c74 0a0a 2020 2020 4070 726f  result..    @pro
+00045de0: 7065 7274 790a 2020 2020 6465 6620 7265  perty.    def re
+00045df0: 616c 2873 656c 663a 2054 5f44 6174 6173  al(self: T_Datas
+00045e00: 6574 2920 2d3e 2054 5f44 6174 6173 6574  et) -> T_Dataset
+00045e10: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00045e20: 2020 2020 2020 5468 6520 7265 616c 2070        The real p
+00045e30: 6172 7420 6f66 2065 6163 6820 6461 7461  art of each data
+00045e40: 2076 6172 6961 626c 652e 0a0a 2020 2020   variable...    
+00045e50: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00045e60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00045e70: 2020 2020 2020 6e75 6d70 792e 6e64 6172        numpy.ndar
+00045e80: 7261 792e 7265 616c 0a20 2020 2020 2020  ray.real.       
+00045e90: 2022 2222 0a20 2020 2020 2020 2072 6574   """.        ret
+00045ea0: 7572 6e20 7365 6c66 2e6d 6170 286c 616d  urn self.map(lam
+00045eb0: 6264 6120 783a 2078 2e72 6561 6c2c 206b  bda x: x.real, k
+00045ec0: 6565 705f 6174 7472 733d 5472 7565 290a  eep_attrs=True).
+00045ed0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00045ee0: 2020 2064 6566 2069 6d61 6728 7365 6c66     def imag(self
+00045ef0: 3a20 545f 4461 7461 7365 7429 202d 3e20  : T_Dataset) -> 
+00045f00: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
+00045f10: 2020 2022 2222 0a20 2020 2020 2020 2054     """.        T
+00045f20: 6865 2069 6d61 6769 6e61 7279 2070 6172  he imaginary par
+00045f30: 7420 6f66 2065 6163 6820 6461 7461 2076  t of each data v
+00045f40: 6172 6961 626c 652e 0a0a 2020 2020 2020  ariable...      
+00045f50: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+00045f60: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00045f70: 2020 2020 6e75 6d70 792e 6e64 6172 7261      numpy.ndarra
+00045f80: 792e 696d 6167 0a20 2020 2020 2020 2022  y.imag.        "
+00045f90: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00045fa0: 6e20 7365 6c66 2e6d 6170 286c 616d 6264  n self.map(lambd
+00045fb0: 6120 783a 2078 2e69 6d61 672c 206b 6565  a x: x.imag, kee
+00045fc0: 705f 6174 7472 733d 5472 7565 290a 0a20  p_attrs=True).. 
+00045fd0: 2020 2070 6c6f 7420 3d20 7574 696c 732e     plot = utils.
+00045fe0: 556e 6361 6368 6564 4163 6365 7373 6f72  UncachedAccessor
+00045ff0: 2844 6174 6173 6574 506c 6f74 4163 6365  (DatasetPlotAcce
+00046000: 7373 6f72 290a 0a20 2020 2064 6566 2066  ssor)..    def f
+00046010: 696c 7465 725f 6279 5f61 7474 7273 2873  ilter_by_attrs(s
+00046020: 656c 663a 2054 5f44 6174 6173 6574 2c20  elf: T_Dataset, 
+00046030: 2a2a 6b77 6172 6773 2920 2d3e 2054 5f44  **kwargs) -> T_D
+00046040: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00046050: 2222 2252 6574 7572 6e73 2061 2060 6044  """Returns a ``D
+00046060: 6174 6173 6574 6060 2077 6974 6820 7661  ataset`` with va
+00046070: 7269 6162 6c65 7320 7468 6174 206d 6174  riables that mat
+00046080: 6368 2073 7065 6369 6669 6320 636f 6e64  ch specific cond
+00046090: 6974 696f 6e73 2e0a 0a20 2020 2020 2020  itions...       
+000460a0: 2043 616e 2070 6173 7320 696e 2060 606b   Can pass in ``k
+000460b0: 6579 3d76 616c 7565 6060 206f 7220 6060  ey=value`` or ``
+000460c0: 6b65 793d 6361 6c6c 6162 6c65 6060 2e20  key=callable``. 
+000460d0: 2041 2044 6174 6173 6574 2069 7320 7265   A Dataset is re
+000460e0: 7475 726e 6564 0a20 2020 2020 2020 2063  turned.        c
+000460f0: 6f6e 7461 696e 696e 6720 6f6e 6c79 2074  ontaining only t
+00046100: 6865 2076 6172 6961 626c 6573 2066 6f72  he variables for
+00046110: 2077 6869 6368 2061 6c6c 2074 6865 2066   which all the f
+00046120: 696c 7465 7220 7465 7374 7320 7061 7373  ilter tests pass
+00046130: 2e0a 2020 2020 2020 2020 5468 6573 6520  ..        These 
+00046140: 7465 7374 7320 6172 6520 6569 7468 6572  tests are either
+00046150: 2060 606b 6579 3d76 616c 7565 6060 2066   ``key=value`` f
+00046160: 6f72 2077 6869 6368 2074 6865 2061 7474  or which the att
+00046170: 7269 6275 7465 2060 606b 6579 6060 0a20  ribute ``key``. 
+00046180: 2020 2020 2020 2068 6173 2074 6865 2065         has the e
+00046190: 7861 6374 2076 616c 7565 2060 6076 616c  xact value ``val
+000461a0: 7565 6060 206f 7220 7468 6520 6361 6c6c  ue`` or the call
+000461b0: 6162 6c65 2070 6173 7365 6420 696e 746f  able passed into
+000461c0: 0a20 2020 2020 2020 2060 606b 6579 3d63  .        ``key=c
+000461d0: 616c 6c61 626c 6560 6020 7265 7475 726e  allable`` return
+000461e0: 7320 5472 7565 2e20 5468 6520 6361 6c6c  s True. The call
+000461f0: 6162 6c65 2077 696c 6c20 6265 2070 6173  able will be pas
+00046200: 7365 6420 6120 7369 6e67 6c65 0a20 2020  sed a single.   
+00046210: 2020 2020 2076 616c 7565 2c20 6569 7468       value, eith
+00046220: 6572 2074 6865 2076 616c 7565 206f 6620  er the value of 
+00046230: 7468 6520 6174 7472 6962 7574 6520 6060  the attribute ``
+00046240: 6b65 7960 6020 6f72 2060 604e 6f6e 6560  key`` or ``None`
+00046250: 6020 6966 2074 6865 0a20 2020 2020 2020  ` if the.       
+00046260: 2044 6174 6141 7272 6179 2064 6f65 7320   DataArray does 
+00046270: 6e6f 7420 6861 7665 2061 6e20 6174 7472  not have an attr
+00046280: 6962 7574 6520 7769 7468 2074 6865 206e  ibute with the n
+00046290: 616d 6520 6060 6b65 7960 602e 0a0a 2020  ame ``key``...  
+000462a0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+000462b0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000462c0: 2d2d 2d0a 2020 2020 2020 2020 2a2a 6b77  ---.        **kw
+000462d0: 6172 6773 0a20 2020 2020 2020 2020 2020  args.           
+000462e0: 206b 6579 203a 2073 7472 0a20 2020 2020   key : str.     
+000462f0: 2020 2020 2020 2020 2020 2041 7474 7269             Attri
+00046300: 6275 7465 206e 616d 652e 0a20 2020 2020  bute name..     
+00046310: 2020 2020 2020 2076 616c 7565 203a 2063         value : c
+00046320: 616c 6c61 626c 6520 6f72 206f 626a 0a20  allable or obj. 
+00046330: 2020 2020 2020 2020 2020 2020 2020 2049                 I
+00046340: 6620 7661 6c75 6520 6973 2061 2063 616c  f value is a cal
+00046350: 6c61 626c 652c 2069 7420 7368 6f75 6c64  lable, it should
+00046360: 2072 6574 7572 6e20 6120 626f 6f6c 6561   return a boolea
+00046370: 6e20 696e 2074 6865 2066 6f72 6d0a 2020  n in the form.  
+00046380: 2020 2020 2020 2020 2020 2020 2020 6f66                of
+00046390: 2062 6f6f 6c20 3d20 6675 6e63 2861 7474   bool = func(att
+000463a0: 7229 2077 6865 7265 2061 7474 7220 6973  r) where attr is
+000463b0: 2064 612e 6174 7472 735b 6b65 795d 2e0a   da.attrs[key]..
+000463c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000463d0: 4f74 6865 7277 6973 652c 2076 616c 7565  Otherwise, value
+000463e0: 2077 696c 6c20 6265 2063 6f6d 7061 7265   will be compare
+000463f0: 6420 746f 2074 6865 2065 6163 680a 2020  d to the each.  
+00046400: 2020 2020 2020 2020 2020 2020 2020 4461                Da
+00046410: 7461 4172 7261 7927 7320 6174 7472 735b  taArray's attrs[
+00046420: 6b65 795d 2e0a 0a20 2020 2020 2020 2052  key]...        R
+00046430: 6574 7572 6e73 0a20 2020 2020 2020 202d  eturns.        -
+00046440: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 206e  ------.        n
+00046450: 6577 203a 2044 6174 6173 6574 0a20 2020  ew : Dataset.   
+00046460: 2020 2020 2020 2020 204e 6577 2064 6174           New dat
+00046470: 6173 6574 2077 6974 6820 7661 7269 6162  aset with variab
+00046480: 6c65 7320 6669 6c74 6572 6564 2062 7920  les filtered by 
+00046490: 6174 7472 6962 7574 652e 0a0a 2020 2020  attribute...    
+000464a0: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+000464b0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+000464c0: 2020 2020 2020 3e3e 3e20 7465 6d70 203d        >>> temp =
+000464d0: 2031 3520 2b20 3820 2a20 6e70 2e72 616e   15 + 8 * np.ran
+000464e0: 646f 6d2e 7261 6e64 6e28 322c 2032 2c20  dom.randn(2, 2, 
+000464f0: 3329 0a20 2020 2020 2020 203e 3e3e 2070  3).        >>> p
+00046500: 7265 6369 7020 3d20 3130 202a 206e 702e  recip = 10 * np.
+00046510: 7261 6e64 6f6d 2e72 616e 6428 322c 2032  random.rand(2, 2
+00046520: 2c20 3329 0a20 2020 2020 2020 203e 3e3e  , 3).        >>>
+00046530: 206c 6f6e 203d 205b 5b2d 3939 2e38 332c   lon = [[-99.83,
+00046540: 202d 3939 2e33 325d 2c20 5b2d 3939 2e37   -99.32], [-99.7
+00046550: 392c 202d 3939 2e32 335d 5d0a 2020 2020  9, -99.23]].    
+00046560: 2020 2020 3e3e 3e20 6c61 7420 3d20 5b5b      >>> lat = [[
+00046570: 3432 2e32 352c 2034 322e 3231 5d2c 205b  42.25, 42.21], [
+00046580: 3432 2e36 332c 2034 322e 3539 5d5d 0a20  42.63, 42.59]]. 
+00046590: 2020 2020 2020 203e 3e3e 2064 696d 7320         >>> dims 
+000465a0: 3d20 5b22 7822 2c20 2279 222c 2022 7469  = ["x", "y", "ti
+000465b0: 6d65 225d 0a20 2020 2020 2020 203e 3e3e  me"].        >>>
+000465c0: 2074 656d 705f 6174 7472 203d 2064 6963   temp_attr = dic
+000465d0: 7428 7374 616e 6461 7264 5f6e 616d 653d  t(standard_name=
+000465e0: 2261 6972 5f70 6f74 656e 7469 616c 5f74  "air_potential_t
+000465f0: 656d 7065 7261 7475 7265 2229 0a20 2020  emperature").   
+00046600: 2020 2020 203e 3e3e 2070 7265 6369 705f       >>> precip_
+00046610: 6174 7472 203d 2064 6963 7428 7374 616e  attr = dict(stan
+00046620: 6461 7264 5f6e 616d 653d 2263 6f6e 7665  dard_name="conve
+00046630: 6374 6976 655f 7072 6563 6970 6974 6174  ctive_precipitat
+00046640: 696f 6e5f 666c 7578 2229 0a0a 2020 2020  ion_flux")..    
+00046650: 2020 2020 3e3e 3e20 6473 203d 2078 722e      >>> ds = xr.
+00046660: 4461 7461 7365 7428 0a20 2020 2020 2020  Dataset(.       
+00046670: 202e 2e2e 2020 2020 2064 6963 7428 0a20   ...     dict(. 
+00046680: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+00046690: 2020 2074 656d 7065 7261 7475 7265 3d28     temperature=(
+000466a0: 6469 6d73 2c20 7465 6d70 2c20 7465 6d70  dims, temp, temp
+000466b0: 5f61 7474 7229 2c0a 2020 2020 2020 2020  _attr),.        
+000466c0: 2e2e 2e20 2020 2020 2020 2020 7072 6563  ...         prec
+000466d0: 6970 6974 6174 696f 6e3d 2864 696d 732c  ipitation=(dims,
+000466e0: 2070 7265 6369 702c 2070 7265 6369 705f   precip, precip_
+000466f0: 6174 7472 292c 0a20 2020 2020 2020 202e  attr),.        .
+00046700: 2e2e 2020 2020 2029 2c0a 2020 2020 2020  ..     ),.      
+00046710: 2020 2e2e 2e20 2020 2020 636f 6f72 6473    ...     coords
+00046720: 3d64 6963 7428 0a20 2020 2020 2020 202e  =dict(.        .
+00046730: 2e2e 2020 2020 2020 2020 206c 6f6e 3d28  ..         lon=(
+00046740: 5b22 7822 2c20 2279 225d 2c20 6c6f 6e29  ["x", "y"], lon)
+00046750: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+00046760: 2020 2020 2020 6c61 743d 285b 2278 222c        lat=(["x",
+00046770: 2022 7922 5d2c 206c 6174 292c 0a20 2020   "y"], lat),.   
+00046780: 2020 2020 202e 2e2e 2020 2020 2020 2020       ...        
+00046790: 2074 696d 653d 7064 2e64 6174 655f 7261   time=pd.date_ra
+000467a0: 6e67 6528 2232 3031 342d 3039 2d30 3622  nge("2014-09-06"
+000467b0: 2c20 7065 7269 6f64 733d 3329 2c0a 2020  , periods=3),.  
+000467c0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
+000467d0: 2020 7265 6665 7265 6e63 655f 7469 6d65    reference_time
+000467e0: 3d70 642e 5469 6d65 7374 616d 7028 2232  =pd.Timestamp("2
+000467f0: 3031 342d 3039 2d30 3522 292c 0a20 2020  014-09-05"),.   
+00046800: 2020 2020 202e 2e2e 2020 2020 2029 2c0a       ...     ),.
+00046810: 2020 2020 2020 2020 2e2e 2e20 290a 0a20          ... ).. 
+00046820: 2020 2020 2020 2047 6574 2076 6172 6961         Get varia
+00046830: 626c 6573 206d 6174 6368 696e 6720 6120  bles matching a 
+00046840: 7370 6563 6966 6963 2073 7461 6e64 6172  specific standar
+00046850: 645f 6e61 6d65 3a0a 0a20 2020 2020 2020  d_name:..       
+00046860: 203e 3e3e 2064 732e 6669 6c74 6572 5f62   >>> ds.filter_b
+00046870: 795f 6174 7472 7328 7374 616e 6461 7264  y_attrs(standard
+00046880: 5f6e 616d 653d 2263 6f6e 7665 6374 6976  _name="convectiv
+00046890: 655f 7072 6563 6970 6974 6174 696f 6e5f  e_precipitation_
+000468a0: 666c 7578 2229 0a20 2020 2020 2020 203c  flux").        <
+000468b0: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
+000468c0: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+000468d0: 6e73 3a20 2020 2020 2020 2020 2878 3a20  ns:         (x: 
+000468e0: 322c 2079 3a20 322c 2074 696d 653a 2033  2, y: 2, time: 3
+000468f0: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
+00046900: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
+00046910: 2020 206c 6f6e 2020 2020 2020 2020 2020     lon          
+00046920: 2020 2028 782c 2079 2920 666c 6f61 7436     (x, y) float6
+00046930: 3420 2d39 392e 3833 202d 3939 2e33 3220  4 -99.83 -99.32 
+00046940: 2d39 392e 3739 202d 3939 2e32 330a 2020  -99.79 -99.23.  
+00046950: 2020 2020 2020 2020 2020 6c61 7420 2020            lat   
+00046960: 2020 2020 2020 2020 2020 2878 2c20 7929            (x, y)
+00046970: 2066 6c6f 6174 3634 2034 322e 3235 2034   float64 42.25 4
+00046980: 322e 3231 2034 322e 3633 2034 322e 3539  2.21 42.63 42.59
+00046990: 0a20 2020 2020 2020 2020 202a 2074 696d  .          * tim
+000469a0: 6520 2020 2020 2020 2020 2020 2028 7469  e            (ti
+000469b0: 6d65 2920 6461 7465 7469 6d65 3634 5b6e  me) datetime64[n
+000469c0: 735d 2032 3031 342d 3039 2d30 3620 3230  s] 2014-09-06 20
+000469d0: 3134 2d30 392d 3037 2032 3031 342d 3039  14-09-07 2014-09
+000469e0: 2d30 380a 2020 2020 2020 2020 2020 2020  -08.            
+000469f0: 7265 6665 7265 6e63 655f 7469 6d65 2020  reference_time  
+00046a00: 6461 7465 7469 6d65 3634 5b6e 735d 2032  datetime64[ns] 2
+00046a10: 3031 342d 3039 2d30 350a 2020 2020 2020  014-09-05.      
+00046a20: 2020 4469 6d65 6e73 696f 6e73 2077 6974    Dimensions wit
+00046a30: 686f 7574 2063 6f6f 7264 696e 6174 6573  hout coordinates
+00046a40: 3a20 782c 2079 0a20 2020 2020 2020 2044  : x, y.        D
+00046a50: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
+00046a60: 2020 2020 2020 2020 2020 2070 7265 6369             preci
+00046a70: 7069 7461 7469 6f6e 2020 2028 782c 2079  pitation   (x, y
+00046a80: 2c20 7469 6d65 2920 666c 6f61 7436 3420  , time) float64 
+00046a90: 352e 3638 2039 2e32 3536 2030 2e37 3130  5.68 9.256 0.710
+00046aa0: 3420 2e2e 2e20 372e 3939 3220 342e 3631  4 ... 7.992 4.61
+00046ab0: 3520 372e 3830 350a 0a20 2020 2020 2020  5 7.805..       
+00046ac0: 2047 6574 2061 6c6c 2076 6172 6961 626c   Get all variabl
+00046ad0: 6573 2074 6861 7420 6861 7665 2061 2073  es that have a s
+00046ae0: 7461 6e64 6172 645f 6e61 6d65 2061 7474  tandard_name att
+00046af0: 7269 6275 7465 3a0a 0a20 2020 2020 2020  ribute:..       
+00046b00: 203e 3e3e 2073 7461 6e64 6172 645f 6e61   >>> standard_na
+00046b10: 6d65 203d 206c 616d 6264 6120 763a 2076  me = lambda v: v
+00046b20: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
+00046b30: 2020 2020 203e 3e3e 2064 732e 6669 6c74       >>> ds.filt
+00046b40: 6572 5f62 795f 6174 7472 7328 7374 616e  er_by_attrs(stan
+00046b50: 6461 7264 5f6e 616d 653d 7374 616e 6461  dard_name=standa
+00046b60: 7264 5f6e 616d 6529 0a20 2020 2020 2020  rd_name).       
+00046b70: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+00046b80: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
+00046b90: 696f 6e73 3a20 2020 2020 2020 2020 2878  ions:         (x
+00046ba0: 3a20 322c 2079 3a20 322c 2074 696d 653a  : 2, y: 2, time:
+00046bb0: 2033 290a 2020 2020 2020 2020 436f 6f72   3).        Coor
+00046bc0: 6469 6e61 7465 733a 0a20 2020 2020 2020  dinates:.       
+00046bd0: 2020 2020 206c 6f6e 2020 2020 2020 2020       lon        
+00046be0: 2020 2020 2028 782c 2079 2920 666c 6f61       (x, y) floa
+00046bf0: 7436 3420 2d39 392e 3833 202d 3939 2e33  t64 -99.83 -99.3
+00046c00: 3220 2d39 392e 3739 202d 3939 2e32 330a  2 -99.79 -99.23.
+00046c10: 2020 2020 2020 2020 2020 2020 6c61 7420              lat 
+00046c20: 2020 2020 2020 2020 2020 2020 2878 2c20              (x, 
+00046c30: 7929 2066 6c6f 6174 3634 2034 322e 3235  y) float64 42.25
+00046c40: 2034 322e 3231 2034 322e 3633 2034 322e   42.21 42.63 42.
+00046c50: 3539 0a20 2020 2020 2020 2020 202a 2074  59.          * t
+00046c60: 696d 6520 2020 2020 2020 2020 2020 2028  ime            (
+00046c70: 7469 6d65 2920 6461 7465 7469 6d65 3634  time) datetime64
+00046c80: 5b6e 735d 2032 3031 342d 3039 2d30 3620  [ns] 2014-09-06 
+00046c90: 3230 3134 2d30 392d 3037 2032 3031 342d  2014-09-07 2014-
+00046ca0: 3039 2d30 380a 2020 2020 2020 2020 2020  09-08.          
+00046cb0: 2020 7265 6665 7265 6e63 655f 7469 6d65    reference_time
+00046cc0: 2020 6461 7465 7469 6d65 3634 5b6e 735d    datetime64[ns]
+00046cd0: 2032 3031 342d 3039 2d30 350a 2020 2020   2014-09-05.    
+00046ce0: 2020 2020 4469 6d65 6e73 696f 6e73 2077      Dimensions w
+00046cf0: 6974 686f 7574 2063 6f6f 7264 696e 6174  ithout coordinat
+00046d00: 6573 3a20 782c 2079 0a20 2020 2020 2020  es: x, y.       
+00046d10: 2044 6174 6120 7661 7269 6162 6c65 733a   Data variables:
+00046d20: 0a20 2020 2020 2020 2020 2020 2074 656d  .            tem
+00046d30: 7065 7261 7475 7265 2020 2020 2028 782c  perature     (x,
+00046d40: 2079 2c20 7469 6d65 2920 666c 6f61 7436   y, time) float6
+00046d50: 3420 3239 2e31 3120 3138 2e32 2032 322e  4 29.11 18.2 22.
+00046d60: 3833 202e 2e2e 2031 382e 3238 2031 362e  83 ... 18.28 16.
+00046d70: 3135 2032 362e 3633 0a20 2020 2020 2020  15 26.63.       
+00046d80: 2020 2020 2070 7265 6369 7069 7461 7469       precipitati
+00046d90: 6f6e 2020 2028 782c 2079 2c20 7469 6d65  on   (x, y, time
+00046da0: 2920 666c 6f61 7436 3420 352e 3638 2039  ) float64 5.68 9
+00046db0: 2e32 3536 2030 2e37 3130 3420 2e2e 2e20  .256 0.7104 ... 
+00046dc0: 372e 3939 3220 342e 3631 3520 372e 3830  7.992 4.615 7.80
+00046dd0: 350a 0a20 2020 2020 2020 2022 2222 0a20  5..        """. 
+00046de0: 2020 2020 2020 2073 656c 6563 7469 6f6e         selection
+00046df0: 203d 205b 5d0a 2020 2020 2020 2020 666f   = [].        fo
+00046e00: 7220 7661 725f 6e61 6d65 2c20 7661 7269  r var_name, vari
+00046e10: 6162 6c65 2069 6e20 7365 6c66 2e76 6172  able in self.var
+00046e20: 6961 626c 6573 2e69 7465 6d73 2829 3a0a  iables.items():.
+00046e30: 2020 2020 2020 2020 2020 2020 6861 735f              has_
+00046e40: 7661 6c75 655f 666c 6167 203d 2046 616c  value_flag = Fal
+00046e50: 7365 0a20 2020 2020 2020 2020 2020 2066  se.            f
+00046e60: 6f72 2061 7474 725f 6e61 6d65 2c20 7061  or attr_name, pa
+00046e70: 7474 6572 6e20 696e 206b 7761 7267 732e  ttern in kwargs.
+00046e80: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+00046e90: 2020 2020 2020 2020 2061 7474 725f 7661           attr_va
+00046ea0: 6c75 6520 3d20 7661 7269 6162 6c65 2e61  lue = variable.a
+00046eb0: 7474 7273 2e67 6574 2861 7474 725f 6e61  ttrs.get(attr_na
+00046ec0: 6d65 290a 2020 2020 2020 2020 2020 2020  me).            
+00046ed0: 2020 2020 6966 2028 6361 6c6c 6162 6c65      if (callable
+00046ee0: 2870 6174 7465 726e 2920 616e 6420 7061  (pattern) and pa
+00046ef0: 7474 6572 6e28 6174 7472 5f76 616c 7565  ttern(attr_value
+00046f00: 2929 206f 7220 6174 7472 5f76 616c 7565  )) or attr_value
+00046f10: 203d 3d20 7061 7474 6572 6e3a 0a20 2020   == pattern:.   
+00046f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046f30: 2068 6173 5f76 616c 7565 5f66 6c61 6720   has_value_flag 
+00046f40: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00046f50: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00046f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00046f70: 2068 6173 5f76 616c 7565 5f66 6c61 6720   has_value_flag 
+00046f80: 3d20 4661 6c73 650a 2020 2020 2020 2020  = False.        
+00046f90: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00046fa0: 6b0a 2020 2020 2020 2020 2020 2020 6966  k.            if
+00046fb0: 2068 6173 5f76 616c 7565 5f66 6c61 6720   has_value_flag 
+00046fc0: 6973 2054 7275 653a 0a20 2020 2020 2020  is True:.       
+00046fd0: 2020 2020 2020 2020 2073 656c 6563 7469           selecti
+00046fe0: 6f6e 2e61 7070 656e 6428 7661 725f 6e61  on.append(var_na
+00046ff0: 6d65 290a 2020 2020 2020 2020 7265 7475  me).        retu
+00047000: 726e 2073 656c 665b 7365 6c65 6374 696f  rn self[selectio
+00047010: 6e5d 0a0a 2020 2020 6465 6620 756e 6966  n]..    def unif
+00047020: 795f 6368 756e 6b73 2873 656c 663a 2054  y_chunks(self: T
+00047030: 5f44 6174 6173 6574 2920 2d3e 2054 5f44  _Dataset) -> T_D
+00047040: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+00047050: 2222 2255 6e69 6679 2063 6875 6e6b 2073  """Unify chunk s
+00047060: 697a 6520 616c 6f6e 6720 616c 6c20 6368  ize along all ch
+00047070: 756e 6b65 6420 6469 6d65 6e73 696f 6e73  unked dimensions
+00047080: 206f 6620 7468 6973 2044 6174 6173 6574   of this Dataset
+00047090: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+000470a0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
+000470b0: 2d2d 0a20 2020 2020 2020 2044 6174 6173  --.        Datas
+000470c0: 6574 2077 6974 6820 636f 6e73 6973 7465  et with consiste
+000470d0: 6e74 2063 6875 6e6b 2073 697a 6573 2066  nt chunk sizes f
+000470e0: 6f72 2061 6c6c 2064 6173 6b2d 6172 7261  or all dask-arra
+000470f0: 7920 7661 7269 6162 6c65 730a 0a20 2020  y variables..   
+00047100: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+00047110: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+00047120: 2020 2020 2020 2064 6173 6b2e 6172 7261         dask.arra
+00047130: 792e 636f 7265 2e75 6e69 6679 5f63 6875  y.core.unify_chu
+00047140: 6e6b 730a 2020 2020 2020 2020 2222 220a  nks.        """.
+00047150: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00047160: 756e 6966 795f 6368 756e 6b73 2873 656c  unify_chunks(sel
+00047170: 6629 5b30 5d0a 0a20 2020 2064 6566 206d  f)[0]..    def m
+00047180: 6170 5f62 6c6f 636b 7328 0a20 2020 2020  ap_blocks(.     
+00047190: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+000471a0: 2066 756e 633a 2043 616c 6c61 626c 655b   func: Callable[
+000471b0: 2e2e 2e2c 2054 5f58 6172 7261 795d 2c0a  ..., T_Xarray],.
+000471c0: 2020 2020 2020 2020 6172 6773 3a20 5365          args: Se
+000471d0: 7175 656e 6365 5b41 6e79 5d20 3d20 2829  quence[Any] = ()
+000471e0: 2c0a 2020 2020 2020 2020 6b77 6172 6773  ,.        kwargs
+000471f0: 3a20 4d61 7070 696e 675b 7374 722c 2041  : Mapping[str, A
+00047200: 6e79 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ny] | None = Non
+00047210: 652c 0a20 2020 2020 2020 2074 656d 706c  e,.        templ
+00047220: 6174 653a 2044 6174 6141 7272 6179 207c  ate: DataArray |
+00047230: 2044 6174 6173 6574 207c 204e 6f6e 6520   Dataset | None 
+00047240: 3d20 4e6f 6e65 2c0a 2020 2020 2920 2d3e  = None,.    ) ->
+00047250: 2054 5f58 6172 7261 793a 0a20 2020 2020   T_Xarray:.     
+00047260: 2020 2022 2222 0a20 2020 2020 2020 2041     """.        A
+00047270: 7070 6c79 2061 2066 756e 6374 696f 6e20  pply a function 
+00047280: 746f 2065 6163 6820 626c 6f63 6b20 6f66  to each block of
+00047290: 2074 6869 7320 4461 7461 7365 742e 0a0a   this Dataset...
+000472a0: 2020 2020 2020 2020 2e2e 2077 6172 6e69          .. warni
+000472b0: 6e67 3a3a 0a20 2020 2020 2020 2020 2020  ng::.           
+000472c0: 2054 6869 7320 6d65 7468 6f64 2069 7320   This method is 
+000472d0: 6578 7065 7269 6d65 6e74 616c 2061 6e64  experimental and
+000472e0: 2069 7473 2073 6967 6e61 7475 7265 206d   its signature m
+000472f0: 6179 2063 6861 6e67 652e 0a0a 2020 2020  ay change...    
+00047300: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
+00047310: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00047320: 2d0a 2020 2020 2020 2020 6675 6e63 203a  -.        func :
+00047330: 2063 616c 6c61 626c 650a 2020 2020 2020   callable.      
+00047340: 2020 2020 2020 5573 6572 2d70 726f 7669        User-provi
+00047350: 6465 6420 6675 6e63 7469 6f6e 2074 6861  ded function tha
+00047360: 7420 6163 6365 7074 7320 6120 4461 7461  t accepts a Data
+00047370: 7365 7420 6173 2069 7473 2066 6972 7374  set as its first
+00047380: 0a20 2020 2020 2020 2020 2020 2070 6172  .            par
+00047390: 616d 6574 6572 2e20 5468 6520 6675 6e63  ameter. The func
+000473a0: 7469 6f6e 2077 696c 6c20 7265 6365 6976  tion will receiv
+000473b0: 6520 6120 7375 6273 6574 206f 7220 2762  e a subset or 'b
+000473c0: 6c6f 636b 2720 6f66 2074 6869 7320 4461  lock' of this Da
+000473d0: 7461 7365 7420 2873 6565 2062 656c 6f77  taset (see below
+000473e0: 292c 0a20 2020 2020 2020 2020 2020 2063  ),.            c
+000473f0: 6f72 7265 7370 6f6e 6469 6e67 2074 6f20  orresponding to 
+00047400: 6f6e 6520 6368 756e 6b20 616c 6f6e 6720  one chunk along 
+00047410: 6561 6368 2063 6875 6e6b 6564 2064 696d  each chunked dim
+00047420: 656e 7369 6f6e 2e20 6060 6675 6e63 6060  ension. ``func``
+00047430: 2077 696c 6c20 6265 0a20 2020 2020 2020   will be.       
+00047440: 2020 2020 2065 7865 6375 7465 6420 6173       executed as
+00047450: 2060 6066 756e 6328 7375 6273 6574 5f64   ``func(subset_d
+00047460: 6174 6173 6574 2c20 2a73 7562 7365 745f  ataset, *subset_
+00047470: 6172 6773 2c20 2a2a 6b77 6172 6773 2960  args, **kwargs)`
+00047480: 602e 0a0a 2020 2020 2020 2020 2020 2020  `...            
+00047490: 5468 6973 2066 756e 6374 696f 6e20 6d75  This function mu
+000474a0: 7374 2072 6574 7572 6e20 6569 7468 6572  st return either
+000474b0: 2061 2073 696e 676c 6520 4461 7461 4172   a single DataAr
+000474c0: 7261 7920 6f72 2061 2073 696e 676c 6520  ray or a single 
+000474d0: 4461 7461 7365 742e 0a0a 2020 2020 2020  Dataset...      
+000474e0: 2020 2020 2020 5468 6973 2066 756e 6374        This funct
+000474f0: 696f 6e20 6361 6e6e 6f74 2061 6464 2061  ion cannot add a
+00047500: 206e 6577 2063 6875 6e6b 6564 2064 696d   new chunked dim
+00047510: 656e 7369 6f6e 2e0a 2020 2020 2020 2020  ension..        
+00047520: 6172 6773 203a 2073 6571 7565 6e63 650a  args : sequence.
+00047530: 2020 2020 2020 2020 2020 2020 5061 7373              Pass
+00047540: 6564 2074 6f20 6675 6e63 2061 6674 6572  ed to func after
+00047550: 2075 6e70 6163 6b69 6e67 2061 6e64 2073   unpacking and s
+00047560: 7562 7365 7474 696e 6720 616e 7920 7861  ubsetting any xa
+00047570: 7272 6179 206f 626a 6563 7473 2062 7920  rray objects by 
+00047580: 626c 6f63 6b73 2e0a 2020 2020 2020 2020  blocks..        
+00047590: 2020 2020 7861 7272 6179 206f 626a 6563      xarray objec
+000475a0: 7473 2069 6e20 6172 6773 206d 7573 7420  ts in args must 
+000475b0: 6265 2061 6c69 676e 6564 2077 6974 6820  be aligned with 
+000475c0: 6f62 6a2c 206f 7468 6572 7769 7365 2061  obj, otherwise a
+000475d0: 6e20 6572 726f 7220 6973 2072 6169 7365  n error is raise
+000475e0: 642e 0a20 2020 2020 2020 206b 7761 7267  d..        kwarg
+000475f0: 7320 3a20 4d61 7070 696e 6720 6f72 204e  s : Mapping or N
+00047600: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00047610: 5061 7373 6564 2076 6572 6261 7469 6d20  Passed verbatim 
+00047620: 746f 2066 756e 6320 6166 7465 7220 756e  to func after un
+00047630: 7061 636b 696e 672e 2078 6172 7261 7920  packing. xarray 
+00047640: 6f62 6a65 6374 732c 2069 6620 616e 792c  objects, if any,
+00047650: 2077 696c 6c20 6e6f 7420 6265 0a20 2020   will not be.   
+00047660: 2020 2020 2020 2020 2073 7562 7365 7420           subset 
+00047670: 746f 2062 6c6f 636b 732e 2050 6173 7369  to blocks. Passi
+00047680: 6e67 2064 6173 6b20 636f 6c6c 6563 7469  ng dask collecti
+00047690: 6f6e 7320 696e 206b 7761 7267 7320 6973  ons in kwargs is
+000476a0: 206e 6f74 2061 6c6c 6f77 6564 2e0a 2020   not allowed..  
+000476b0: 2020 2020 2020 7465 6d70 6c61 7465 203a        template :
+000476c0: 2044 6174 6141 7272 6179 2c20 4461 7461   DataArray, Data
+000476d0: 7365 7420 6f72 204e 6f6e 652c 206f 7074  set or None, opt
+000476e0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+000476f0: 2020 7861 7272 6179 206f 626a 6563 7420    xarray object 
+00047700: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+00047710: 2066 696e 616c 2072 6573 756c 7420 6166   final result af
+00047720: 7465 7220 636f 6d70 7574 6520 6973 2063  ter compute is c
+00047730: 616c 6c65 642e 2049 6620 6e6f 7420 7072  alled. If not pr
+00047740: 6f76 6964 6564 2c0a 2020 2020 2020 2020  ovided,.        
+00047750: 2020 2020 7468 6520 6675 6e63 7469 6f6e      the function
+00047760: 2077 696c 6c20 6265 2066 6972 7374 2072   will be first r
+00047770: 756e 206f 6e20 6d6f 636b 6564 2d75 7020  un on mocked-up 
+00047780: 6461 7461 2c20 7468 6174 206c 6f6f 6b73  data, that looks
+00047790: 206c 696b 6520 7468 6973 206f 626a 6563   like this objec
+000477a0: 7420 6275 740a 2020 2020 2020 2020 2020  t but.          
+000477b0: 2020 6861 7320 7369 7a65 7320 302c 2074    has sizes 0, t
+000477c0: 6f20 6465 7465 726d 696e 6520 7072 6f70  o determine prop
+000477d0: 6572 7469 6573 206f 6620 7468 6520 7265  erties of the re
+000477e0: 7475 726e 6564 206f 626a 6563 7420 7375  turned object su
+000477f0: 6368 2061 7320 6474 7970 652c 0a20 2020  ch as dtype,.   
+00047800: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
+00047810: 6520 6e61 6d65 732c 2061 7474 7269 6275  e names, attribu
+00047820: 7465 732c 206e 6577 2064 696d 656e 7369  tes, new dimensi
+00047830: 6f6e 7320 616e 6420 6e65 7720 696e 6465  ons and new inde
+00047840: 7865 7320 2869 6620 616e 7929 2e0a 2020  xes (if any)..  
+00047850: 2020 2020 2020 2020 2020 6060 7465 6d70            ``temp
+00047860: 6c61 7465 6060 206d 7573 7420 6265 2070  late`` must be p
+00047870: 726f 7669 6465 6420 6966 2074 6865 2066  rovided if the f
+00047880: 756e 6374 696f 6e20 6368 616e 6765 7320  unction changes 
+00047890: 7468 6520 7369 7a65 206f 6620 6578 6973  the size of exis
+000478a0: 7469 6e67 2064 696d 656e 7369 6f6e 732e  ting dimensions.
+000478b0: 0a20 2020 2020 2020 2020 2020 2057 6865  .            Whe
+000478c0: 6e20 7072 6f76 6964 6564 2c20 6060 6174  n provided, ``at
+000478d0: 7472 7360 6020 6f6e 2076 6172 6961 626c  trs`` on variabl
+000478e0: 6573 2069 6e20 6074 656d 706c 6174 6560  es in `template`
+000478f0: 2061 7265 2063 6f70 6965 6420 6f76 6572   are copied over
+00047900: 2074 6f20 7468 6520 7265 7375 6c74 2e20   to the result. 
+00047910: 416e 790a 2020 2020 2020 2020 2020 2020  Any.            
+00047920: 6060 6174 7472 7360 6020 7365 7420 6279  ``attrs`` set by
+00047930: 2060 6066 756e 6360 6020 7769 6c6c 2062   ``func`` will b
+00047940: 6520 6967 6e6f 7265 642e 0a0a 2020 2020  e ignored...    
+00047950: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00047960: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00047970: 2020 2020 4120 7369 6e67 6c65 2044 6174      A single Dat
+00047980: 6141 7272 6179 206f 7220 4461 7461 7365  aArray or Datase
+00047990: 7420 7769 7468 2064 6173 6b20 6261 636b  t with dask back
+000479a0: 656e 642c 2072 6561 7373 656d 626c 6564  end, reassembled
+000479b0: 2066 726f 6d20 7468 6520 6f75 7470 7574   from the output
+000479c0: 7320 6f66 2074 6865 0a20 2020 2020 2020  s of the.       
+000479d0: 2066 756e 6374 696f 6e2e 0a0a 2020 2020   function...    
+000479e0: 2020 2020 4e6f 7465 730a 2020 2020 2020      Notes.      
+000479f0: 2020 2d2d 2d2d 2d0a 2020 2020 2020 2020    -----.        
+00047a00: 5468 6973 2066 756e 6374 696f 6e20 6973  This function is
+00047a10: 2064 6573 6967 6e65 6420 666f 7220 7768   designed for wh
+00047a20: 656e 2060 6066 756e 6360 6020 6e65 6564  en ``func`` need
+00047a30: 7320 746f 206d 616e 6970 756c 6174 6520  s to manipulate 
+00047a40: 6120 7768 6f6c 6520 7861 7272 6179 206f  a whole xarray o
+00047a50: 626a 6563 740a 2020 2020 2020 2020 7375  bject.        su
+00047a60: 6273 6574 2074 6f20 6561 6368 2062 6c6f  bset to each blo
+00047a70: 636b 2e20 4561 6368 2062 6c6f 636b 2069  ck. Each block i
+00047a80: 7320 6c6f 6164 6564 2069 6e74 6f20 6d65  s loaded into me
+00047a90: 6d6f 7279 2e20 496e 2074 6865 206d 6f72  mory. In the mor
+00047aa0: 6520 636f 6d6d 6f6e 2063 6173 6520 7768  e common case wh
+00047ab0: 6572 650a 2020 2020 2020 2020 6060 6675  ere.        ``fu
+00047ac0: 6e63 6060 2063 616e 2077 6f72 6b20 6f6e  nc`` can work on
+00047ad0: 206e 756d 7079 2061 7272 6179 732c 2069   numpy arrays, i
+00047ae0: 7420 6973 2072 6563 6f6d 6d65 6e64 6564  t is recommended
+00047af0: 2074 6f20 7573 6520 6060 6170 706c 795f   to use ``apply_
+00047b00: 7566 756e 6360 602e 0a0a 2020 2020 2020  ufunc``...      
+00047b10: 2020 4966 206e 6f6e 6520 6f66 2074 6865    If none of the
+00047b20: 2076 6172 6961 626c 6573 2069 6e20 7468   variables in th
+00047b30: 6973 206f 626a 6563 7420 6973 2062 6163  is object is bac
+00047b40: 6b65 6420 6279 2064 6173 6b20 6172 7261  ked by dask arra
+00047b50: 7973 2c20 6361 6c6c 696e 6720 7468 6973  ys, calling this
+00047b60: 2066 756e 6374 696f 6e20 6973 0a20 2020   function is.   
+00047b70: 2020 2020 2065 7175 6976 616c 656e 7420       equivalent 
+00047b80: 746f 2063 616c 6c69 6e67 2060 6066 756e  to calling ``fun
+00047b90: 6328 6f62 6a2c 202a 6172 6773 2c20 2a2a  c(obj, *args, **
+00047ba0: 6b77 6172 6773 2960 602e 0a0a 2020 2020  kwargs)``...    
+00047bb0: 2020 2020 5365 6520 416c 736f 0a20 2020      See Also.   
+00047bc0: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+00047bd0: 2020 2020 2020 6461 736b 2e61 7272 6179        dask.array
+00047be0: 2e6d 6170 5f62 6c6f 636b 732c 2078 6172  .map_blocks, xar
+00047bf0: 7261 792e 6170 706c 795f 7566 756e 632c  ray.apply_ufunc,
+00047c00: 2078 6172 7261 792e 4461 7461 7365 742e   xarray.Dataset.
+00047c10: 6d61 705f 626c 6f63 6b73 0a20 2020 2020  map_blocks.     
+00047c20: 2020 2078 6172 7261 792e 4461 7461 4172     xarray.DataAr
+00047c30: 7261 792e 6d61 705f 626c 6f63 6b73 0a0a  ray.map_blocks..
+00047c40: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+00047c50: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00047c60: 2d0a 2020 2020 2020 2020 4361 6c63 756c  -.        Calcul
+00047c70: 6174 6520 616e 2061 6e6f 6d61 6c79 2066  ate an anomaly f
+00047c80: 726f 6d20 636c 696d 6174 6f6c 6f67 7920  rom climatology 
+00047c90: 7573 696e 6720 6060 2e67 726f 7570 6279  using ``.groupby
+00047ca0: 2829 6060 2e20 5573 696e 670a 2020 2020  ()``. Using.    
+00047cb0: 2020 2020 6060 7872 2e6d 6170 5f62 6c6f      ``xr.map_blo
+00047cc0: 636b 7328 2960 6020 616c 6c6f 7773 2066  cks()`` allows f
+00047cd0: 6f72 2070 6172 616c 6c65 6c20 6f70 6572  or parallel oper
+00047ce0: 6174 696f 6e73 2077 6974 6820 6b6e 6f77  ations with know
+00047cf0: 6c65 6467 6520 6f66 2060 6078 6172 7261  ledge of ``xarra
+00047d00: 7960 602c 0a20 2020 2020 2020 2069 7473  y``,.        its
+00047d10: 2069 6e64 6963 6573 2c20 616e 6420 6974   indices, and it
+00047d20: 7320 6d65 7468 6f64 7320 6c69 6b65 2060  s methods like `
+00047d30: 602e 6772 6f75 7062 7928 2960 602e 0a0a  `.groupby()``...
+00047d40: 2020 2020 2020 2020 3e3e 3e20 6465 6620          >>> def 
+00047d50: 6361 6c63 756c 6174 655f 616e 6f6d 616c  calculate_anomal
+00047d60: 7928 6461 2c20 6772 6f75 7062 795f 7479  y(da, groupby_ty
+00047d70: 7065 3d22 7469 6d65 2e6d 6f6e 7468 2229  pe="time.month")
+00047d80: 3a0a 2020 2020 2020 2020 2e2e 2e20 2020  :.        ...   
+00047d90: 2020 6762 203d 2064 612e 6772 6f75 7062    gb = da.groupb
+00047da0: 7928 6772 6f75 7062 795f 7479 7065 290a  y(groupby_type).
+00047db0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00047dc0: 636c 696d 203d 2067 622e 6d65 616e 2864  clim = gb.mean(d
+00047dd0: 696d 3d22 7469 6d65 2229 0a20 2020 2020  im="time").     
+00047de0: 2020 202e 2e2e 2020 2020 2072 6574 7572     ...     retur
+00047df0: 6e20 6762 202d 2063 6c69 6d0a 2020 2020  n gb - clim.    
+00047e00: 2020 2020 2e2e 2e0a 2020 2020 2020 2020      ....        
+00047e10: 3e3e 3e20 7469 6d65 203d 2078 722e 6366  >>> time = xr.cf
+00047e20: 7469 6d65 5f72 616e 6765 2822 3139 3930  time_range("1990
+00047e30: 2d30 3122 2c20 2231 3939 322d 3031 222c  -01", "1992-01",
+00047e40: 2066 7265 713d 224d 2229 0a20 2020 2020   freq="M").     
+00047e50: 2020 203e 3e3e 206d 6f6e 7468 203d 2078     >>> month = x
+00047e60: 722e 4461 7461 4172 7261 7928 7469 6d65  r.DataArray(time
+00047e70: 2e6d 6f6e 7468 2c20 636f 6f72 6473 3d7b  .month, coords={
+00047e80: 2274 696d 6522 3a20 7469 6d65 7d2c 2064  "time": time}, d
+00047e90: 696d 733d 5b22 7469 6d65 225d 290a 2020  ims=["time"]).  
+00047ea0: 2020 2020 2020 3e3e 3e20 6e70 2e72 616e        >>> np.ran
+00047eb0: 646f 6d2e 7365 6564 2831 3233 290a 2020  dom.seed(123).  
+00047ec0: 2020 2020 2020 3e3e 3e20 6172 7261 7920        >>> array 
+00047ed0: 3d20 7872 2e44 6174 6141 7272 6179 280a  = xr.DataArray(.
+00047ee0: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+00047ef0: 6e70 2e72 616e 646f 6d2e 7261 6e64 286c  np.random.rand(l
+00047f00: 656e 2874 696d 6529 292c 0a20 2020 2020  en(time)),.     
+00047f10: 2020 202e 2e2e 2020 2020 2064 696d 733d     ...     dims=
+00047f20: 5b22 7469 6d65 225d 2c0a 2020 2020 2020  ["time"],.      
+00047f30: 2020 2e2e 2e20 2020 2020 636f 6f72 6473    ...     coords
+00047f40: 3d7b 2274 696d 6522 3a20 7469 6d65 2c20  ={"time": time, 
+00047f50: 226d 6f6e 7468 223a 206d 6f6e 7468 7d2c  "month": month},
+00047f60: 0a20 2020 2020 2020 202e 2e2e 2029 2e63  .        ... ).c
+00047f70: 6875 6e6b 2829 0a20 2020 2020 2020 203e  hunk().        >
+00047f80: 3e3e 2064 7320 3d20 7872 2e44 6174 6173  >> ds = xr.Datas
+00047f90: 6574 287b 2261 223a 2061 7272 6179 7d29  et({"a": array})
+00047fa0: 0a20 2020 2020 2020 203e 3e3e 2064 732e  .        >>> ds.
+00047fb0: 6d61 705f 626c 6f63 6b73 2863 616c 6375  map_blocks(calcu
+00047fc0: 6c61 7465 5f61 6e6f 6d61 6c79 2c20 7465  late_anomaly, te
+00047fd0: 6d70 6c61 7465 3d64 7329 2e63 6f6d 7075  mplate=ds).compu
+00047fe0: 7465 2829 0a20 2020 2020 2020 203c 7861  te().        <xa
+00047ff0: 7272 6179 2e44 6174 6173 6574 3e0a 2020  rray.Dataset>.  
+00048000: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
+00048010: 3a20 2028 7469 6d65 3a20 3234 290a 2020  :  (time: 24).  
+00048020: 2020 2020 2020 436f 6f72 6469 6e61 7465        Coordinate
+00048030: 733a 0a20 2020 2020 2020 2020 202a 2074  s:.          * t
+00048040: 696d 6520 2020 2020 2874 696d 6529 206f  ime     (time) o
+00048050: 626a 6563 7420 3139 3930 2d30 312d 3331  bject 1990-01-31
+00048060: 2030 303a 3030 3a30 3020 2e2e 2e20 3139   00:00:00 ... 19
+00048070: 3931 2d31 322d 3331 2030 303a 3030 3a30  91-12-31 00:00:0
+00048080: 300a 2020 2020 2020 2020 2020 2020 6d6f  0.            mo
+00048090: 6e74 6820 2020 2028 7469 6d65 2920 696e  nth    (time) in
+000480a0: 7436 3420 3120 3220 3320 3420 3520 3620  t64 1 2 3 4 5 6 
+000480b0: 3720 3820 3920 3130 2031 3120 3132 2031  7 8 9 10 11 12 1
+000480c0: 2032 2033 2034 2035 2036 2037 2038 2039   2 3 4 5 6 7 8 9
+000480d0: 2031 3020 3131 2031 320a 2020 2020 2020   10 11 12.      
+000480e0: 2020 4461 7461 2076 6172 6961 626c 6573    Data variables
+000480f0: 3a0a 2020 2020 2020 2020 2020 2020 6120  :.            a 
+00048100: 2020 2020 2020 2028 7469 6d65 2920 666c         (time) fl
+00048110: 6f61 7436 3420 302e 3132 3839 2030 2e31  oat64 0.1289 0.1
+00048120: 3133 3220 2d30 2e30 3835 3620 2e2e 2e20  132 -0.0856 ... 
+00048130: 302e 3232 3837 2030 2e31 3930 3620 2d30  0.2287 0.1906 -0
+00048140: 2e30 3539 3031 0a0a 2020 2020 2020 2020  .05901..        
+00048150: 4e6f 7465 2074 6861 7420 6f6e 6520 6d75  Note that one mu
+00048160: 7374 2065 7870 6c69 6369 746c 7920 7573  st explicitly us
+00048170: 6520 6060 6172 6773 3d5b 5d60 6020 616e  e ``args=[]`` an
+00048180: 6420 6060 6b77 6172 6773 3d7b 7d60 6020  d ``kwargs={}`` 
+00048190: 746f 2070 6173 7320 6172 6775 6d65 6e74  to pass argument
+000481a0: 730a 2020 2020 2020 2020 746f 2074 6865  s.        to the
+000481b0: 2066 756e 6374 696f 6e20 6265 696e 6720   function being 
+000481c0: 6170 706c 6965 6420 696e 2060 6078 722e  applied in ``xr.
+000481d0: 6d61 705f 626c 6f63 6b73 2829 6060 3a0a  map_blocks()``:.
+000481e0: 0a20 2020 2020 2020 203e 3e3e 2064 732e  .        >>> ds.
+000481f0: 6d61 705f 626c 6f63 6b73 280a 2020 2020  map_blocks(.    
+00048200: 2020 2020 2e2e 2e20 2020 2020 6361 6c63      ...     calc
+00048210: 756c 6174 655f 616e 6f6d 616c 792c 0a20  ulate_anomaly,. 
+00048220: 2020 2020 2020 202e 2e2e 2020 2020 206b         ...     k
+00048230: 7761 7267 733d 7b22 6772 6f75 7062 795f  wargs={"groupby_
+00048240: 7479 7065 223a 2022 7469 6d65 2e79 6561  type": "time.yea
+00048250: 7222 7d2c 0a20 2020 2020 2020 202e 2e2e  r"},.        ...
+00048260: 2020 2020 2074 656d 706c 6174 653d 6473       template=ds
+00048270: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
+00048280: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
+00048290: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
+000482a0: 2044 696d 656e 7369 6f6e 733a 2020 2874   Dimensions:  (t
+000482b0: 696d 653a 2032 3429 0a20 2020 2020 2020  ime: 24).       
+000482c0: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
+000482d0: 2020 2020 2020 2020 2a20 7469 6d65 2020          * time  
+000482e0: 2020 2028 7469 6d65 2920 6f62 6a65 6374     (time) object
+000482f0: 2031 3939 302d 3031 2d33 3120 3030 3a30   1990-01-31 00:0
+00048300: 303a 3030 202e 2e2e 2031 3939 312d 3132  0:00 ... 1991-12
+00048310: 2d33 3120 3030 3a30 303a 3030 0a20 2020  -31 00:00:00.   
+00048320: 2020 2020 2020 2020 206d 6f6e 7468 2020           month  
+00048330: 2020 2874 696d 6529 2069 6e74 3634 2064    (time) int64 d
+00048340: 6173 6b2e 6172 7261 793c 6368 756e 6b73  ask.array<chunks
+00048350: 697a 653d 2832 342c 292c 206d 6574 613d  ize=(24,), meta=
+00048360: 6e70 2e6e 6461 7272 6179 3e0a 2020 2020  np.ndarray>.    
+00048370: 2020 2020 4461 7461 2076 6172 6961 626c      Data variabl
+00048380: 6573 3a0a 2020 2020 2020 2020 2020 2020  es:.            
+00048390: 6120 2020 2020 2020 2028 7469 6d65 2920  a        (time) 
+000483a0: 666c 6f61 7436 3420 6461 736b 2e61 7272  float64 dask.arr
+000483b0: 6179 3c63 6875 6e6b 7369 7a65 3d28 3234  ay<chunksize=(24
+000483c0: 2c29 2c20 6d65 7461 3d6e 702e 6e64 6172  ,), meta=np.ndar
+000483d0: 7261 793e 0a20 2020 2020 2020 2022 2222  ray>.        """
+000483e0: 0a20 2020 2020 2020 2066 726f 6d20 7861  .        from xa
+000483f0: 7272 6179 2e63 6f72 652e 7061 7261 6c6c  rray.core.parall
+00048400: 656c 2069 6d70 6f72 7420 6d61 705f 626c  el import map_bl
+00048410: 6f63 6b73 0a0a 2020 2020 2020 2020 7265  ocks..        re
+00048420: 7475 726e 206d 6170 5f62 6c6f 636b 7328  turn map_blocks(
+00048430: 6675 6e63 2c20 7365 6c66 2c20 6172 6773  func, self, args
+00048440: 2c20 6b77 6172 6773 2c20 7465 6d70 6c61  , kwargs, templa
+00048450: 7465 290a 0a20 2020 2064 6566 2070 6f6c  te)..    def pol
+00048460: 7966 6974 280a 2020 2020 2020 2020 7365  yfit(.        se
+00048470: 6c66 3a20 545f 4461 7461 7365 742c 0a20  lf: T_Dataset,. 
+00048480: 2020 2020 2020 2064 696d 3a20 4861 7368         dim: Hash
+00048490: 6162 6c65 2c0a 2020 2020 2020 2020 6465  able,.        de
+000484a0: 673a 2069 6e74 2c0a 2020 2020 2020 2020  g: int,.        
+000484b0: 736b 6970 6e61 3a20 626f 6f6c 207c 204e  skipna: bool | N
+000484c0: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+000484d0: 2020 2020 7263 6f6e 643a 2066 6c6f 6174      rcond: float
+000484e0: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
+000484f0: 2020 2020 2020 2020 773a 2048 6173 6861          w: Hasha
+00048500: 626c 6520 7c20 416e 7920 3d20 4e6f 6e65  ble | Any = None
+00048510: 2c0a 2020 2020 2020 2020 6675 6c6c 3a20  ,.        full: 
+00048520: 626f 6f6c 203d 2046 616c 7365 2c0a 2020  bool = False,.  
+00048530: 2020 2020 2020 636f 763a 2062 6f6f 6c20        cov: bool 
+00048540: 7c20 4c69 7465 7261 6c5b 2275 6e73 6361  | Literal["unsca
+00048550: 6c65 6422 5d20 3d20 4661 6c73 652c 0a20  led"] = False,. 
+00048560: 2020 2029 202d 3e20 545f 4461 7461 7365     ) -> T_Datase
+00048570: 743a 0a20 2020 2020 2020 2022 2222 0a20  t:.        """. 
+00048580: 2020 2020 2020 204c 6561 7374 2073 7175         Least squ
+00048590: 6172 6573 2070 6f6c 796e 6f6d 6961 6c20  ares polynomial 
+000485a0: 6669 742e 0a0a 2020 2020 2020 2020 5468  fit...        Th
+000485b0: 6973 2072 6570 6c69 6361 7465 7320 7468  is replicates th
+000485c0: 6520 6265 6861 7669 6f75 7220 6f66 2060  e behaviour of `
+000485d0: 6e75 6d70 792e 706f 6c79 6669 7460 2062  numpy.polyfit` b
+000485e0: 7574 2064 6966 6665 7273 2062 7920 736b  ut differs by sk
+000485f0: 6970 7069 6e67 0a20 2020 2020 2020 2069  ipping.        i
+00048600: 6e76 616c 6964 2076 616c 7565 7320 7768  nvalid values wh
+00048610: 656e 2060 736b 6970 6e61 203d 2054 7275  en `skipna = Tru
+00048620: 6560 2e0a 0a20 2020 2020 2020 2050 6172  e`...        Par
+00048630: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+00048640: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00048650: 2020 2064 696d 203a 2068 6173 6861 626c     dim : hashabl
+00048660: 650a 2020 2020 2020 2020 2020 2020 436f  e.            Co
+00048670: 6f72 6469 6e61 7465 2061 6c6f 6e67 2077  ordinate along w
+00048680: 6869 6368 2074 6f20 6669 7420 7468 6520  hich to fit the 
+00048690: 706f 6c79 6e6f 6d69 616c 732e 0a20 2020  polynomials..   
+000486a0: 2020 2020 2064 6567 203a 2069 6e74 0a20       deg : int. 
+000486b0: 2020 2020 2020 2020 2020 2044 6567 7265             Degre
+000486c0: 6520 6f66 2074 6865 2066 6974 7469 6e67  e of the fitting
+000486d0: 2070 6f6c 796e 6f6d 6961 6c2e 0a20 2020   polynomial..   
+000486e0: 2020 2020 2073 6b69 706e 6120 3a20 626f       skipna : bo
+000486f0: 6f6c 206f 7220 4e6f 6e65 2c20 6f70 7469  ol or None, opti
+00048700: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+00048710: 2049 6620 5472 7565 2c20 7265 6d6f 7665   If True, remove
+00048720: 7320 616c 6c20 696e 7661 6c69 6420 7661  s all invalid va
+00048730: 6c75 6573 2062 6566 6f72 6520 6669 7474  lues before fitt
+00048740: 696e 6720 6561 6368 2031 4420 736c 6963  ing each 1D slic
+00048750: 6573 206f 6620 7468 6520 6172 7261 792e  es of the array.
+00048760: 0a20 2020 2020 2020 2020 2020 2044 6566  .            Def
+00048770: 6175 6c74 2069 7320 5472 7565 2069 6620  ault is True if 
+00048780: 6461 7461 2069 7320 7374 6f72 6564 2069  data is stored i
+00048790: 6e20 6120 6461 736b 2e61 7272 6179 206f  n a dask.array o
+000487a0: 7220 6966 2074 6865 7265 2069 7320 616e  r if there is an
+000487b0: 790a 2020 2020 2020 2020 2020 2020 696e  y.            in
+000487c0: 7661 6c69 6420 7661 6c75 6573 2c20 4661  valid values, Fa
+000487d0: 6c73 6520 6f74 6865 7277 6973 652e 0a20  lse otherwise.. 
+000487e0: 2020 2020 2020 2072 636f 6e64 203a 2066         rcond : f
+000487f0: 6c6f 6174 206f 7220 4e6f 6e65 2c20 6f70  loat or None, op
+00048800: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00048810: 2020 2052 656c 6174 6976 6520 636f 6e64     Relative cond
+00048820: 6974 696f 6e20 6e75 6d62 6572 2074 6f20  ition number to 
+00048830: 7468 6520 6669 742e 0a20 2020 2020 2020  the fit..       
+00048840: 2077 203a 2068 6173 6861 626c 6520 6f72   w : hashable or
+00048850: 2041 6e79 2c20 6f70 7469 6f6e 616c 0a20   Any, optional. 
+00048860: 2020 2020 2020 2020 2020 2057 6569 6768             Weigh
+00048870: 7473 2074 6f20 6170 706c 7920 746f 2074  ts to apply to t
+00048880: 6865 2079 2d63 6f6f 7264 696e 6174 6520  he y-coordinate 
+00048890: 6f66 2074 6865 2073 616d 706c 6520 706f  of the sample po
+000488a0: 696e 7473 2e0a 2020 2020 2020 2020 2020  ints..          
+000488b0: 2020 4361 6e20 6265 2061 6e20 6172 7261    Can be an arra
+000488c0: 792d 6c69 6b65 206f 626a 6563 7420 6f72  y-like object or
+000488d0: 2074 6865 206e 616d 6520 6f66 2061 2063   the name of a c
+000488e0: 6f6f 7264 696e 6174 6520 696e 2074 6865  oordinate in the
+000488f0: 2064 6174 6173 6574 2e0a 2020 2020 2020   dataset..      
+00048900: 2020 6675 6c6c 203a 2062 6f6f 6c2c 2064    full : bool, d
+00048910: 6566 6175 6c74 3a20 4661 6c73 650a 2020  efault: False.  
+00048920: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+00048930: 7220 746f 2072 6574 7572 6e20 7468 6520  r to return the 
+00048940: 7265 7369 6475 616c 732c 206d 6174 7269  residuals, matri
+00048950: 7820 7261 6e6b 2061 6e64 2073 696e 6775  x rank and singu
+00048960: 6c61 7220 7661 6c75 6573 2069 6e20 6164  lar values in ad
+00048970: 6469 7469 6f6e 0a20 2020 2020 2020 2020  dition.         
+00048980: 2020 2074 6f20 7468 6520 636f 6566 6669     to the coeffi
+00048990: 6369 656e 7473 2e0a 2020 2020 2020 2020  cients..        
+000489a0: 636f 7620 3a20 626f 6f6c 206f 7220 2275  cov : bool or "u
+000489b0: 6e73 6361 6c65 6422 2c20 6465 6661 756c  nscaled", defaul
+000489c0: 743a 2046 616c 7365 0a20 2020 2020 2020  t: False.       
+000489d0: 2020 2020 2057 6865 7468 6572 2074 6f20       Whether to 
+000489e0: 7265 7475 726e 2074 6f20 7468 6520 636f  return to the co
+000489f0: 7661 7269 616e 6365 206d 6174 7269 7820  variance matrix 
+00048a00: 696e 2061 6464 6974 696f 6e20 746f 2074  in addition to t
+00048a10: 6865 2063 6f65 6666 6963 6965 6e74 732e  he coefficients.
+00048a20: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
+00048a30: 206d 6174 7269 7820 6973 206e 6f74 2073   matrix is not s
+00048a40: 6361 6c65 6420 6966 2060 636f 763d 2775  caled if `cov='u
+00048a50: 6e73 6361 6c65 6427 602e 0a0a 2020 2020  nscaled'`...    
+00048a60: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00048a70: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00048a80: 2020 2020 706f 6c79 6669 745f 7265 7375      polyfit_resu
+00048a90: 6c74 7320 3a20 4461 7461 7365 740a 2020  lts : Dataset.  
+00048aa0: 2020 2020 2020 2020 2020 4120 7369 6e67            A sing
+00048ab0: 6c65 2064 6174 6173 6574 2077 6869 6368  le dataset which
+00048ac0: 2063 6f6e 7461 696e 7320 2866 6f72 2065   contains (for e
+00048ad0: 6163 6820 2276 6172 2220 696e 2074 6865  ach "var" in the
+00048ae0: 2069 6e70 7574 2064 6174 6173 6574 293a   input dataset):
+00048af0: 0a0a 2020 2020 2020 2020 2020 2020 5b76  ..            [v
+00048b00: 6172 5d5f 706f 6c79 6669 745f 636f 6566  ar]_polyfit_coef
+00048b10: 6669 6369 656e 7473 0a20 2020 2020 2020  ficients.       
+00048b20: 2020 2020 2020 2020 2054 6865 2063 6f65           The coe
+00048b30: 6666 6963 6965 6e74 7320 6f66 2074 6865  fficients of the
+00048b40: 2062 6573 7420 6669 7420 666f 7220 6561   best fit for ea
+00048b50: 6368 2076 6172 6961 626c 6520 696e 2074  ch variable in t
+00048b60: 6869 7320 6461 7461 7365 742e 0a20 2020  his dataset..   
+00048b70: 2020 2020 2020 2020 205b 7661 725d 5f70           [var]_p
+00048b80: 6f6c 7966 6974 5f72 6573 6964 7561 6c73  olyfit_residuals
+00048b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00048ba0: 2054 6865 2072 6573 6964 7561 6c73 206f   The residuals o
+00048bb0: 6620 7468 6520 6c65 6173 742d 7371 7561  f the least-squa
+00048bc0: 7265 2063 6f6d 7075 7461 7469 6f6e 2066  re computation f
+00048bd0: 6f72 2065 6163 6820 7661 7269 6162 6c65  or each variable
+00048be0: 2028 6f6e 6c79 2069 6e63 6c75 6465 6420   (only included 
+00048bf0: 6966 2060 6675 6c6c 3d54 7275 6560 290a  if `full=True`).
+00048c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00048c10: 5768 656e 2074 6865 206d 6174 7269 7820  When the matrix 
+00048c20: 7261 6e6b 2069 7320 6465 6669 6369 656e  rank is deficien
+00048c30: 742c 206e 702e 6e61 6e20 6973 2072 6574  t, np.nan is ret
+00048c40: 7572 6e65 642e 0a20 2020 2020 2020 2020  urned..         
+00048c50: 2020 205b 6469 6d5d 5f6d 6174 7269 785f     [dim]_matrix_
+00048c60: 7261 6e6b 0a20 2020 2020 2020 2020 2020  rank.           
+00048c70: 2020 2020 2054 6865 2065 6666 6563 7469       The effecti
+00048c80: 7665 2072 616e 6b20 6f66 2074 6865 2073  ve rank of the s
+00048c90: 6361 6c65 6420 5661 6e64 6572 6d6f 6e64  caled Vandermond
+00048ca0: 6520 636f 6566 6669 6369 656e 7420 6d61  e coefficient ma
+00048cb0: 7472 6978 2028 6f6e 6c79 2069 6e63 6c75  trix (only inclu
+00048cc0: 6465 6420 6966 2060 6675 6c6c 3d54 7275  ded if `full=Tru
+00048cd0: 6560 290a 2020 2020 2020 2020 2020 2020  e`).            
+00048ce0: 2020 2020 5468 6520 7261 6e6b 2069 7320      The rank is 
+00048cf0: 636f 6d70 7574 6564 2069 676e 6f72 696e  computed ignorin
+00048d00: 6720 7468 6520 4e61 4e20 7661 6c75 6573  g the NaN values
+00048d10: 2074 6861 7420 6d69 6768 7420 6265 2073   that might be s
+00048d20: 6b69 7070 6564 2e0a 2020 2020 2020 2020  kipped..        
+00048d30: 2020 2020 5b64 696d 5d5f 7369 6e67 756c      [dim]_singul
+00048d40: 6172 5f76 616c 7565 730a 2020 2020 2020  ar_values.      
+00048d50: 2020 2020 2020 2020 2020 5468 6520 7369            The si
+00048d60: 6e67 756c 6172 2076 616c 7565 7320 6f66  ngular values of
+00048d70: 2074 6865 2073 6361 6c65 6420 5661 6e64   the scaled Vand
+00048d80: 6572 6d6f 6e64 6520 636f 6566 6669 6369  ermonde coeffici
+00048d90: 656e 7420 6d61 7472 6978 2028 6f6e 6c79  ent matrix (only
+00048da0: 2069 6e63 6c75 6465 6420 6966 2060 6675   included if `fu
+00048db0: 6c6c 3d54 7275 6560 290a 2020 2020 2020  ll=True`).      
+00048dc0: 2020 2020 2020 5b76 6172 5d5f 706f 6c79        [var]_poly
+00048dd0: 6669 745f 636f 7661 7269 616e 6365 0a20  fit_covariance. 
+00048de0: 2020 2020 2020 2020 2020 2020 2020 2054                 T
+00048df0: 6865 2063 6f76 6172 6961 6e63 6520 6d61  he covariance ma
+00048e00: 7472 6978 206f 6620 7468 6520 706f 6c79  trix of the poly
+00048e10: 6e6f 6d69 616c 2063 6f65 6666 6963 6965  nomial coefficie
+00048e20: 6e74 2065 7374 696d 6174 6573 2028 6f6e  nt estimates (on
+00048e30: 6c79 2069 6e63 6c75 6465 6420 6966 2060  ly included if `
+00048e40: 6675 6c6c 3d46 616c 7365 6020 616e 6420  full=False` and 
+00048e50: 6063 6f76 3d54 7275 6560 290a 0a20 2020  `cov=True`)..   
+00048e60: 2020 2020 2057 6172 6e73 0a20 2020 2020       Warns.     
+00048e70: 2020 202d 2d2d 2d2d 0a20 2020 2020 2020     -----.       
+00048e80: 2052 616e 6b57 6172 6e69 6e67 0a20 2020   RankWarning.   
+00048e90: 2020 2020 2020 2020 2054 6865 2072 616e           The ran
+00048ea0: 6b20 6f66 2074 6865 2063 6f65 6666 6963  k of the coeffic
+00048eb0: 6965 6e74 206d 6174 7269 7820 696e 2074  ient matrix in t
+00048ec0: 6865 206c 6561 7374 2d73 7175 6172 6573  he least-squares
+00048ed0: 2066 6974 2069 7320 6465 6669 6369 656e   fit is deficien
+00048ee0: 742e 0a20 2020 2020 2020 2020 2020 2054  t..            T
+00048ef0: 6865 2077 6172 6e69 6e67 2069 7320 6e6f  he warning is no
+00048f00: 7420 7261 6973 6564 2077 6974 6820 696e  t raised with in
+00048f10: 2d6d 656d 6f72 7920 286e 6f74 2064 6173  -memory (not das
+00048f20: 6b29 2064 6174 6120 616e 6420 6066 756c  k) data and `ful
+00048f30: 6c3d 5472 7565 602e 0a0a 2020 2020 2020  l=True`...      
+00048f40: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
+00048f50: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
+00048f60: 2020 2020 6e75 6d70 792e 706f 6c79 6669      numpy.polyfi
+00048f70: 740a 2020 2020 2020 2020 6e75 6d70 792e  t.        numpy.
+00048f80: 706f 6c79 7661 6c0a 2020 2020 2020 2020  polyval.        
+00048f90: 7861 7272 6179 2e70 6f6c 7976 616c 0a20  xarray.polyval. 
+00048fa0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00048fb0: 2020 2066 726f 6d20 7861 7272 6179 2e63     from xarray.c
+00048fc0: 6f72 652e 6461 7461 6172 7261 7920 696d  ore.dataarray im
+00048fd0: 706f 7274 2044 6174 6141 7272 6179 0a0a  port DataArray..
+00048fe0: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+00048ff0: 7320 3d20 7b7d 0a20 2020 2020 2020 2073  s = {}.        s
+00049000: 6b69 706e 615f 6461 203d 2073 6b69 706e  kipna_da = skipn
+00049010: 610a 0a20 2020 2020 2020 2078 203d 2067  a..        x = g
+00049020: 6574 5f63 6c65 616e 5f69 6e74 6572 705f  et_clean_interp_
+00049030: 696e 6465 7828 7365 6c66 2c20 6469 6d2c  index(self, dim,
+00049040: 2073 7472 6963 743d 4661 6c73 6529 0a20   strict=False). 
+00049050: 2020 2020 2020 2078 6e61 6d65 203d 2066         xname = f
+00049060: 227b 7365 6c66 5b64 696d 5d2e 6e61 6d65  "{self[dim].name
+00049070: 7d5f 220a 2020 2020 2020 2020 6f72 6465  }_".        orde
+00049080: 7220 3d20 696e 7428 6465 6729 202b 2031  r = int(deg) + 1
+00049090: 0a20 2020 2020 2020 206c 6873 203d 206e  .        lhs = n
+000490a0: 702e 7661 6e64 6572 2878 2c20 6f72 6465  p.vander(x, orde
+000490b0: 7229 0a0a 2020 2020 2020 2020 6966 2072  r)..        if r
+000490c0: 636f 6e64 2069 7320 4e6f 6e65 3a0a 2020  cond is None:.  
+000490d0: 2020 2020 2020 2020 2020 7263 6f6e 6420            rcond 
+000490e0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+000490f0: 2020 2020 782e 7368 6170 655b 305d 202a      x.shape[0] *
+00049100: 206e 702e 636f 7265 2e66 696e 666f 2878   np.core.finfo(x
+00049110: 2e64 7479 7065 292e 6570 7320 2023 2074  .dtype).eps  # t
+00049120: 7970 653a 2069 676e 6f72 655b 6174 7472  ype: ignore[attr
+00049130: 2d64 6566 696e 6564 5d0a 2020 2020 2020  -defined].      
+00049140: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
+00049150: 2023 2057 6569 6768 7473 3a0a 2020 2020   # Weights:.    
+00049160: 2020 2020 6966 2077 2069 7320 6e6f 7420      if w is not 
+00049170: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
+00049180: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00049190: 772c 2048 6173 6861 626c 6529 3a0a 2020  w, Hashable):.  
+000491a0: 2020 2020 2020 2020 2020 2020 2020 7720                w 
+000491b0: 3d20 7365 6c66 2e63 6f6f 7264 735b 775d  = self.coords[w]
+000491c0: 0a20 2020 2020 2020 2020 2020 2077 203d  .            w =
+000491d0: 206e 702e 6173 6172 7261 7928 7729 0a20   np.asarray(w). 
+000491e0: 2020 2020 2020 2020 2020 2069 6620 772e             if w.
+000491f0: 6e64 696d 2021 3d20 313a 0a20 2020 2020  ndim != 1:.     
+00049200: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00049210: 2054 7970 6545 7272 6f72 2822 4578 7065   TypeError("Expe
+00049220: 6374 6564 2061 2031 2d64 2061 7272 6179  cted a 1-d array
+00049230: 2066 6f72 2077 6569 6768 7473 2e22 290a   for weights.").
+00049240: 2020 2020 2020 2020 2020 2020 6966 2077              if w
+00049250: 2e73 6861 7065 5b30 5d20 213d 206c 6873  .shape[0] != lhs
+00049260: 2e73 6861 7065 5b30 5d3a 0a20 2020 2020  .shape[0]:.     
+00049270: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00049280: 2054 7970 6545 7272 6f72 2866 2245 7870   TypeError(f"Exp
+00049290: 6563 7465 6420 7720 616e 6420 7b64 696d  ected w and {dim
+000492a0: 7d20 746f 2068 6176 6520 7468 6520 7361  } to have the sa
+000492b0: 6d65 206c 656e 6774 6822 290a 2020 2020  me length").    
+000492c0: 2020 2020 2020 2020 6c68 7320 2a3d 2077          lhs *= w
+000492d0: 5b3a 2c20 6e70 2e6e 6577 6178 6973 5d0a  [:, np.newaxis].
+000492e0: 0a20 2020 2020 2020 2023 2053 6361 6c69  .        # Scali
+000492f0: 6e67 0a20 2020 2020 2020 2073 6361 6c65  ng.        scale
+00049300: 203d 206e 702e 7371 7274 2828 6c68 7320   = np.sqrt((lhs 
+00049310: 2a20 6c68 7329 2e73 756d 2861 7869 733d  * lhs).sum(axis=
+00049320: 3029 290a 2020 2020 2020 2020 6c68 7320  0)).        lhs 
+00049330: 2f3d 2073 6361 6c65 0a0a 2020 2020 2020  /= scale..      
+00049340: 2020 6465 6772 6565 5f64 696d 203d 2075    degree_dim = u
+00049350: 7469 6c73 2e67 6574 5f74 656d 705f 6469  tils.get_temp_di
+00049360: 6d6e 616d 6528 7365 6c66 2e64 696d 732c  mname(self.dims,
+00049370: 2022 6465 6772 6565 2229 0a0a 2020 2020   "degree")..    
+00049380: 2020 2020 7261 6e6b 203d 206e 702e 6c69      rank = np.li
+00049390: 6e61 6c67 2e6d 6174 7269 785f 7261 6e6b  nalg.matrix_rank
+000493a0: 286c 6873 290a 0a20 2020 2020 2020 2069  (lhs)..        i
+000493b0: 6620 6675 6c6c 3a0a 2020 2020 2020 2020  f full:.        
+000493c0: 2020 2020 7261 6e6b 203d 2044 6174 6141      rank = DataA
+000493d0: 7272 6179 2872 616e 6b2c 206e 616d 653d  rray(rank, name=
+000493e0: 786e 616d 6520 2b20 226d 6174 7269 785f  xname + "matrix_
+000493f0: 7261 6e6b 2229 0a20 2020 2020 2020 2020  rank").         
+00049400: 2020 2076 6172 6961 626c 6573 5b72 616e     variables[ran
+00049410: 6b2e 6e61 6d65 5d20 3d20 7261 6e6b 0a20  k.name] = rank. 
+00049420: 2020 2020 2020 2020 2020 205f 7369 6e67             _sing
+00049430: 203d 206e 702e 6c69 6e61 6c67 2e73 7664   = np.linalg.svd
+00049440: 286c 6873 2c20 636f 6d70 7574 655f 7576  (lhs, compute_uv
+00049450: 3d46 616c 7365 290a 2020 2020 2020 2020  =False).        
+00049460: 2020 2020 7369 6e67 203d 2044 6174 6141      sing = DataA
+00049470: 7272 6179 280a 2020 2020 2020 2020 2020  rray(.          
+00049480: 2020 2020 2020 5f73 696e 672c 0a20 2020        _sing,.   
+00049490: 2020 2020 2020 2020 2020 2020 2064 696d               dim
+000494a0: 733d 2864 6567 7265 655f 6469 6d2c 292c  s=(degree_dim,),
+000494b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000494c0: 2063 6f6f 7264 733d 7b64 6567 7265 655f   coords={degree_
+000494d0: 6469 6d3a 206e 702e 6172 616e 6765 2872  dim: np.arange(r
+000494e0: 616e 6b20 2d20 312c 202d 312c 202d 3129  ank - 1, -1, -1)
+000494f0: 7d2c 0a20 2020 2020 2020 2020 2020 2020  },.             
+00049500: 2020 206e 616d 653d 786e 616d 6520 2b20     name=xname + 
+00049510: 2273 696e 6775 6c61 725f 7661 6c75 6573  "singular_values
+00049520: 222c 0a20 2020 2020 2020 2020 2020 2029  ",.            )
+00049530: 0a20 2020 2020 2020 2020 2020 2076 6172  .            var
+00049540: 6961 626c 6573 5b73 696e 672e 6e61 6d65  iables[sing.name
+00049550: 5d20 3d20 7369 6e67 0a0a 2020 2020 2020  ] = sing..      
+00049560: 2020 666f 7220 6e61 6d65 2c20 6461 2069    for name, da i
+00049570: 6e20 7365 6c66 2e64 6174 615f 7661 7273  n self.data_vars
+00049580: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+00049590: 2020 2020 2020 6966 2064 696d 206e 6f74        if dim not
+000495a0: 2069 6e20 6461 2e64 696d 733a 0a20 2020   in da.dims:.   
+000495b0: 2020 2020 2020 2020 2020 2020 2063 6f6e               con
+000495c0: 7469 6e75 650a 0a20 2020 2020 2020 2020  tinue..         
+000495d0: 2020 2069 6620 6973 5f64 7563 6b5f 6461     if is_duck_da
+000495e0: 736b 5f61 7272 6179 2864 612e 6461 7461  sk_array(da.data
+000495f0: 2920 616e 6420 280a 2020 2020 2020 2020  ) and (.        
+00049600: 2020 2020 2020 2020 7261 6e6b 2021 3d20          rank != 
+00049610: 6f72 6465 7220 6f72 2066 756c 6c20 6f72  order or full or
+00049620: 2073 6b69 706e 6120 6973 204e 6f6e 650a   skipna is None.
+00049630: 2020 2020 2020 2020 2020 2020 293a 0a20              ):. 
+00049640: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00049650: 2043 7572 7265 6e74 2061 6c67 6f72 6974   Current algorit
+00049660: 686d 2077 6974 6820 6461 736b 2061 6e64  hm with dask and
+00049670: 2073 6b69 706e 613d 4661 6c73 6520 6e65   skipna=False ne
+00049680: 6974 6865 7220 7375 7070 6f72 7473 0a20  ither supports. 
+00049690: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000496a0: 2064 6566 6963 6965 6e74 2072 616e 6b73   deficient ranks
+000496b0: 206e 6f72 2064 6f65 7320 6974 206f 7574   nor does it out
+000496c0: 7075 7420 7468 6520 2266 756c 6c22 2069  put the "full" i
+000496d0: 6e66 6f20 2869 7373 7565 2064 6173 6b2f  nfo (issue dask/
+000496e0: 6461 736b 2336 3531 3629 0a20 2020 2020  dask#6516).     
+000496f0: 2020 2020 2020 2020 2020 2073 6b69 706e             skipn
+00049700: 615f 6461 203d 2054 7275 650a 2020 2020  a_da = True.    
+00049710: 2020 2020 2020 2020 656c 6966 2073 6b69          elif ski
+00049720: 706e 6120 6973 204e 6f6e 653a 0a20 2020  pna is None:.   
+00049730: 2020 2020 2020 2020 2020 2020 2073 6b69               ski
+00049740: 706e 615f 6461 203d 2062 6f6f 6c28 6e70  pna_da = bool(np
+00049750: 2e61 6e79 2864 612e 6973 6e75 6c6c 2829  .any(da.isnull()
+00049760: 2929 0a0a 2020 2020 2020 2020 2020 2020  ))..            
+00049770: 6469 6d73 5f74 6f5f 7374 6163 6b20 3d20  dims_to_stack = 
+00049780: 5b64 696d 6e61 6d65 2066 6f72 2064 696d  [dimname for dim
+00049790: 6e61 6d65 2069 6e20 6461 2e64 696d 7320  name in da.dims 
+000497a0: 6966 2064 696d 6e61 6d65 2021 3d20 6469  if dimname != di
+000497b0: 6d5d 0a20 2020 2020 2020 2020 2020 2073  m].            s
+000497c0: 7461 636b 6564 5f63 6f6f 7264 733a 2064  tacked_coords: d
+000497d0: 6963 745b 4861 7368 6162 6c65 2c20 4461  ict[Hashable, Da
+000497e0: 7461 4172 7261 795d 203d 207b 7d0a 2020  taArray] = {}.  
+000497f0: 2020 2020 2020 2020 2020 6966 2064 696d            if dim
+00049800: 735f 746f 5f73 7461 636b 3a0a 2020 2020  s_to_stack:.    
+00049810: 2020 2020 2020 2020 2020 2020 7374 6163              stac
+00049820: 6b65 645f 6469 6d20 3d20 7574 696c 732e  ked_dim = utils.
+00049830: 6765 745f 7465 6d70 5f64 696d 6e61 6d65  get_temp_dimname
+00049840: 2864 696d 735f 746f 5f73 7461 636b 2c20  (dims_to_stack, 
+00049850: 2273 7461 636b 6564 2229 0a20 2020 2020  "stacked").     
+00049860: 2020 2020 2020 2020 2020 2072 6873 203d             rhs =
+00049870: 2064 612e 7472 616e 7370 6f73 6528 6469   da.transpose(di
+00049880: 6d2c 202a 6469 6d73 5f74 6f5f 7374 6163  m, *dims_to_stac
+00049890: 6b29 2e73 7461 636b 280a 2020 2020 2020  k).stack(.      
+000498a0: 2020 2020 2020 2020 2020 2020 2020 7b73                {s
+000498b0: 7461 636b 6564 5f64 696d 3a20 6469 6d73  tacked_dim: dims
+000498c0: 5f74 6f5f 7374 6163 6b7d 0a20 2020 2020  _to_stack}.     
+000498d0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000498e0: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+000498f0: 636b 6564 5f63 6f6f 7264 7320 3d20 7b73  cked_coords = {s
+00049900: 7461 636b 6564 5f64 696d 3a20 7268 735b  tacked_dim: rhs[
+00049910: 7374 6163 6b65 645f 6469 6d5d 7d0a 2020  stacked_dim]}.  
+00049920: 2020 2020 2020 2020 2020 2020 2020 7363                sc
+00049930: 616c 655f 6461 203d 2073 6361 6c65 5b3a  ale_da = scale[:
+00049940: 2c20 6e70 2e6e 6577 6178 6973 5d0a 2020  , np.newaxis].  
+00049950: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00049960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049970: 7268 7320 3d20 6461 0a20 2020 2020 2020  rhs = da.       
+00049980: 2020 2020 2020 2020 2073 6361 6c65 5f64           scale_d
+00049990: 6120 3d20 7363 616c 650a 0a20 2020 2020  a = scale..     
+000499a0: 2020 2020 2020 2069 6620 7720 6973 206e         if w is n
+000499b0: 6f74 204e 6f6e 653a 0a20 2020 2020 2020  ot None:.       
+000499c0: 2020 2020 2020 2020 2072 6873 203d 2072           rhs = r
+000499d0: 6873 202a 2077 5b3a 2c20 6e70 2e6e 6577  hs * w[:, np.new
+000499e0: 6178 6973 5d0a 0a20 2020 2020 2020 2020  axis]..         
+000499f0: 2020 2077 6974 6820 7761 726e 696e 6773     with warnings
+00049a00: 2e63 6174 6368 5f77 6172 6e69 6e67 7328  .catch_warnings(
+00049a10: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00049a20: 2020 2069 6620 6675 6c6c 3a20 2023 2043     if full:  # C
+00049a30: 6f70 7920 6e70 2e70 6f6c 7966 6974 2062  opy np.polyfit b
+00049a40: 6568 6176 696f 720a 2020 2020 2020 2020  ehavior.        
+00049a50: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+00049a60: 696e 6773 2e73 696d 706c 6566 696c 7465  ings.simplefilte
+00049a70: 7228 2269 676e 6f72 6522 2c20 6e70 2e52  r("ignore", np.R
+00049a80: 616e 6b57 6172 6e69 6e67 290a 2020 2020  ankWarning).    
+00049a90: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00049aa0: 3a20 2023 2052 6169 7365 206f 6e6c 7920  :  # Raise only 
+00049ab0: 6f6e 6365 2070 6572 2076 6172 6961 626c  once per variabl
+00049ac0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00049ad0: 2020 2020 2020 7761 726e 696e 6773 2e73        warnings.s
+00049ae0: 696d 706c 6566 696c 7465 7228 226f 6e63  implefilter("onc
+00049af0: 6522 2c20 6e70 2e52 616e 6b57 6172 6e69  e", np.RankWarni
+00049b00: 6e67 290a 0a20 2020 2020 2020 2020 2020  ng)..           
+00049b10: 2020 2020 2063 6f65 6666 732c 2072 6573       coeffs, res
+00049b20: 6964 7561 6c73 203d 2064 7563 6b5f 6172  iduals = duck_ar
+00049b30: 7261 795f 6f70 732e 6c65 6173 745f 7371  ray_ops.least_sq
+00049b40: 7561 7265 7328 0a20 2020 2020 2020 2020  uares(.         
+00049b50: 2020 2020 2020 2020 2020 206c 6873 2c20             lhs, 
+00049b60: 7268 732e 6461 7461 2c20 7263 6f6e 643d  rhs.data, rcond=
+00049b70: 7263 6f6e 642c 2073 6b69 706e 613d 736b  rcond, skipna=sk
+00049b80: 6970 6e61 5f64 610a 2020 2020 2020 2020  ipna_da.        
+00049b90: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00049ba0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00049bb0: 616e 6365 286e 616d 652c 2073 7472 293a  ance(name, str):
+00049bc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00049bd0: 206e 616d 6520 3d20 6622 7b6e 616d 657d   name = f"{name}
+00049be0: 5f22 0a20 2020 2020 2020 2020 2020 2065  _".            e
+00049bf0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00049c00: 2020 2020 2023 2054 6875 7320 6120 5265       # Thus a Re
+00049c10: 7072 4f62 6a65 6374 203d 3e20 706f 6c79  prObject => poly
+00049c20: 6669 7420 7761 7320 6361 6c6c 6564 206f  fit was called o
+00049c30: 6e20 6120 4461 7461 4172 7261 790a 2020  n a DataArray.  
+00049c40: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+00049c50: 6d65 203d 2022 220a 0a20 2020 2020 2020  me = ""..       
+00049c60: 2020 2020 2063 6f65 6666 7320 3d20 4461       coeffs = Da
+00049c70: 7461 4172 7261 7928 0a20 2020 2020 2020  taArray(.       
+00049c80: 2020 2020 2020 2020 2063 6f65 6666 7320           coeffs 
+00049c90: 2f20 7363 616c 655f 6461 2c0a 2020 2020  / scale_da,.    
+00049ca0: 2020 2020 2020 2020 2020 2020 6469 6d73              dims
+00049cb0: 3d5b 6465 6772 6565 5f64 696d 5d20 2b20  =[degree_dim] + 
+00049cc0: 6c69 7374 2873 7461 636b 6564 5f63 6f6f  list(stacked_coo
+00049cd0: 7264 732e 6b65 7973 2829 292c 0a20 2020  rds.keys()),.   
+00049ce0: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+00049cf0: 7264 733d 7b64 6567 7265 655f 6469 6d3a  rds={degree_dim:
+00049d00: 206e 702e 6172 616e 6765 286f 7264 6572   np.arange(order
+00049d10: 295b 3a3a 2d31 5d2c 202a 2a73 7461 636b  )[::-1], **stack
+00049d20: 6564 5f63 6f6f 7264 737d 2c0a 2020 2020  ed_coords},.    
+00049d30: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00049d40: 3d6e 616d 6520 2b20 2270 6f6c 7966 6974  =name + "polyfit
+00049d50: 5f63 6f65 6666 6963 6965 6e74 7322 2c0a  _coefficients",.
+00049d60: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00049d70: 2020 2020 2020 2020 2020 6966 2064 696d            if dim
+00049d80: 735f 746f 5f73 7461 636b 3a0a 2020 2020  s_to_stack:.    
+00049d90: 2020 2020 2020 2020 2020 2020 636f 6566              coef
+00049da0: 6673 203d 2063 6f65 6666 732e 756e 7374  fs = coeffs.unst
+00049db0: 6163 6b28 7374 6163 6b65 645f 6469 6d29  ack(stacked_dim)
+00049dc0: 0a20 2020 2020 2020 2020 2020 2076 6172  .            var
+00049dd0: 6961 626c 6573 5b63 6f65 6666 732e 6e61  iables[coeffs.na
+00049de0: 6d65 5d20 3d20 636f 6566 6673 0a0a 2020  me] = coeffs..  
+00049df0: 2020 2020 2020 2020 2020 6966 2066 756c            if ful
+00049e00: 6c20 6f72 2028 636f 7620 6973 2054 7275  l or (cov is Tru
+00049e10: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00049e20: 2020 2020 7265 7369 6475 616c 7320 3d20      residuals = 
+00049e30: 4461 7461 4172 7261 7928 0a20 2020 2020  DataArray(.     
+00049e40: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00049e50: 6573 6964 7561 6c73 2069 6620 6469 6d73  esiduals if dims
+00049e60: 5f74 6f5f 7374 6163 6b20 656c 7365 2072  _to_stack else r
+00049e70: 6573 6964 7561 6c73 2e73 7175 6565 7a65  esiduals.squeeze
+00049e80: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+00049e90: 2020 2020 2020 2020 6469 6d73 3d6c 6973          dims=lis
+00049ea0: 7428 7374 6163 6b65 645f 636f 6f72 6473  t(stacked_coords
+00049eb0: 2e6b 6579 7328 2929 2c0a 2020 2020 2020  .keys()),.      
+00049ec0: 2020 2020 2020 2020 2020 2020 2020 636f                co
+00049ed0: 6f72 6473 3d73 7461 636b 6564 5f63 6f6f  ords=stacked_coo
+00049ee0: 7264 732c 0a20 2020 2020 2020 2020 2020  rds,.           
+00049ef0: 2020 2020 2020 2020 206e 616d 653d 6e61           name=na
+00049f00: 6d65 202b 2022 706f 6c79 6669 745f 7265  me + "polyfit_re
+00049f10: 7369 6475 616c 7322 2c0a 2020 2020 2020  siduals",.      
+00049f20: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00049f30: 2020 2020 2020 2020 2020 2020 6966 2064              if d
+00049f40: 696d 735f 746f 5f73 7461 636b 3a0a 2020  ims_to_stack:.  
+00049f50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00049f60: 2020 7265 7369 6475 616c 7320 3d20 7265    residuals = re
+00049f70: 7369 6475 616c 732e 756e 7374 6163 6b28  siduals.unstack(
+00049f80: 7374 6163 6b65 645f 6469 6d29 0a20 2020  stacked_dim).   
+00049f90: 2020 2020 2020 2020 2020 2020 2076 6172               var
+00049fa0: 6961 626c 6573 5b72 6573 6964 7561 6c73  iables[residuals
+00049fb0: 2e6e 616d 655d 203d 2072 6573 6964 7561  .name] = residua
+00049fc0: 6c73 0a0a 2020 2020 2020 2020 2020 2020  ls..            
+00049fd0: 6966 2063 6f76 3a0a 2020 2020 2020 2020  if cov:.        
+00049fe0: 2020 2020 2020 2020 5662 6173 6520 3d20          Vbase = 
+00049ff0: 6e70 2e6c 696e 616c 672e 696e 7628 6e70  np.linalg.inv(np
+0004a000: 2e64 6f74 286c 6873 2e54 2c20 6c68 7329  .dot(lhs.T, lhs)
+0004a010: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0004a020: 2020 5662 6173 6520 2f3d 206e 702e 6f75    Vbase /= np.ou
+0004a030: 7465 7228 7363 616c 652c 2073 6361 6c65  ter(scale, scale
+0004a040: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0004a050: 2020 6966 2063 6f76 203d 3d20 2275 6e73    if cov == "uns
+0004a060: 6361 6c65 6422 3a0a 2020 2020 2020 2020  caled":.        
+0004a070: 2020 2020 2020 2020 2020 2020 6661 6320              fac 
+0004a080: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+0004a090: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+0004a0a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0004a0b0: 2078 2e73 6861 7065 5b30 5d20 3c3d 206f   x.shape[0] <= o
+0004a0c0: 7264 6572 3a0a 2020 2020 2020 2020 2020  rder:.          
+0004a0d0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0004a0e0: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0004a0f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a100: 2020 2020 2020 2020 2020 2020 2254 6865              "The
+0004a110: 206e 756d 6265 7220 6f66 2064 6174 6120   number of data 
+0004a120: 706f 696e 7473 206d 7573 7420 6578 6365  points must exce
+0004a130: 6564 206f 7264 6572 2074 6f20 7363 616c  ed order to scal
+0004a140: 6520 7468 6520 636f 7661 7269 616e 6365  e the covariance
+0004a150: 206d 6174 7269 782e 220a 2020 2020 2020   matrix.".      
+0004a160: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004a170: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0004a180: 2020 2020 2020 2020 6661 6320 3d20 7265          fac = re
+0004a190: 7369 6475 616c 7320 2f20 2878 2e73 6861  siduals / (x.sha
+0004a1a0: 7065 5b30 5d20 2d20 6f72 6465 7229 0a20  pe[0] - order). 
+0004a1b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0004a1c0: 6f76 6172 6961 6e63 6520 3d20 4461 7461  ovariance = Data
+0004a1d0: 4172 7261 7928 5662 6173 652c 2064 696d  Array(Vbase, dim
+0004a1e0: 733d 2822 636f 765f 6922 2c20 2263 6f76  s=("cov_i", "cov
+0004a1f0: 5f6a 2229 2920 2a20 6661 630a 2020 2020  _j")) * fac.    
+0004a200: 2020 2020 2020 2020 2020 2020 7661 7269              vari
+0004a210: 6162 6c65 735b 6e61 6d65 202b 2022 706f  ables[name + "po
+0004a220: 6c79 6669 745f 636f 7661 7269 616e 6365  lyfit_covariance
+0004a230: 225d 203d 2063 6f76 6172 6961 6e63 650a  "] = covariance.
+0004a240: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0004a250: 7479 7065 2873 656c 6629 2864 6174 615f  type(self)(data_
+0004a260: 7661 7273 3d76 6172 6961 626c 6573 2c20  vars=variables, 
+0004a270: 6174 7472 733d 7365 6c66 2e61 7474 7273  attrs=self.attrs
+0004a280: 2e63 6f70 7928 2929 0a0a 2020 2020 6465  .copy())..    de
+0004a290: 6620 7061 6428 0a20 2020 2020 2020 2073  f pad(.        s
+0004a2a0: 656c 663a 2054 5f44 6174 6173 6574 2c0a  elf: T_Dataset,.
+0004a2b0: 2020 2020 2020 2020 7061 645f 7769 6474          pad_widt
+0004a2c0: 683a 204d 6170 7069 6e67 5b41 6e79 2c20  h: Mapping[Any, 
+0004a2d0: 696e 7420 7c20 7475 706c 655b 696e 742c  int | tuple[int,
+0004a2e0: 2069 6e74 5d5d 207c 204e 6f6e 6520 3d20   int]] | None = 
+0004a2f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6d6f  None,.        mo
+0004a300: 6465 3a20 5061 644d 6f64 654f 7074 696f  de: PadModeOptio
+0004a310: 6e73 203d 2022 636f 6e73 7461 6e74 222c  ns = "constant",
+0004a320: 0a20 2020 2020 2020 2073 7461 745f 6c65  .        stat_le
+0004a330: 6e67 7468 3a20 696e 740a 2020 2020 2020  ngth: int.      
+0004a340: 2020 7c20 7475 706c 655b 696e 742c 2069    | tuple[int, i
+0004a350: 6e74 5d0a 2020 2020 2020 2020 7c20 4d61  nt].        | Ma
+0004a360: 7070 696e 675b 416e 792c 2074 7570 6c65  pping[Any, tuple
+0004a370: 5b69 6e74 2c20 696e 745d 5d0a 2020 2020  [int, int]].    
+0004a380: 2020 2020 7c20 4e6f 6e65 203d 204e 6f6e      | None = Non
+0004a390: 652c 0a20 2020 2020 2020 2063 6f6e 7374  e,.        const
+0004a3a0: 616e 745f 7661 6c75 6573 3a20 280a 2020  ant_values: (.  
+0004a3b0: 2020 2020 2020 2020 2020 666c 6f61 7420            float 
+0004a3c0: 7c20 7475 706c 655b 666c 6f61 742c 2066  | tuple[float, f
+0004a3d0: 6c6f 6174 5d20 7c20 4d61 7070 696e 675b  loat] | Mapping[
+0004a3e0: 416e 792c 2074 7570 6c65 5b66 6c6f 6174  Any, tuple[float
+0004a3f0: 2c20 666c 6f61 745d 5d20 7c20 4e6f 6e65  , float]] | None
+0004a400: 0a20 2020 2020 2020 2029 203d 204e 6f6e  .        ) = Non
+0004a410: 652c 0a20 2020 2020 2020 2065 6e64 5f76  e,.        end_v
+0004a420: 616c 7565 733a 2069 6e74 207c 2074 7570  alues: int | tup
+0004a430: 6c65 5b69 6e74 2c20 696e 745d 207c 204d  le[int, int] | M
+0004a440: 6170 7069 6e67 5b41 6e79 2c20 7475 706c  apping[Any, tupl
+0004a450: 655b 696e 742c 2069 6e74 5d5d 207c 204e  e[int, int]] | N
+0004a460: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+0004a470: 2020 2020 7265 666c 6563 745f 7479 7065      reflect_type
+0004a480: 3a20 5061 6452 6566 6c65 6374 4f70 7469  : PadReflectOpti
+0004a490: 6f6e 7320 3d20 4e6f 6e65 2c0a 2020 2020  ons = None,.    
+0004a4a0: 2020 2020 6b65 6570 5f61 7474 7273 3a20      keep_attrs: 
+0004a4b0: 626f 6f6c 207c 204e 6f6e 6520 3d20 4e6f  bool | None = No
+0004a4c0: 6e65 2c0a 2020 2020 2020 2020 2a2a 7061  ne,.        **pa
+0004a4d0: 645f 7769 6474 685f 6b77 6172 6773 3a20  d_width_kwargs: 
+0004a4e0: 416e 792c 0a20 2020 2029 202d 3e20 545f  Any,.    ) -> T_
+0004a4f0: 4461 7461 7365 743a 0a20 2020 2020 2020  Dataset:.       
+0004a500: 2022 2222 5061 6420 7468 6973 2064 6174   """Pad this dat
+0004a510: 6173 6574 2061 6c6f 6e67 206f 6e65 206f  aset along one o
+0004a520: 7220 6d6f 7265 2064 696d 656e 7369 6f6e  r more dimension
+0004a530: 732e 0a0a 2020 2020 2020 2020 2e2e 2077  s...        .. w
+0004a540: 6172 6e69 6e67 3a3a 0a20 2020 2020 2020  arning::.       
+0004a550: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
+0004a560: 6f6e 2069 7320 6578 7065 7269 6d65 6e74  on is experiment
+0004a570: 616c 2061 6e64 2069 7473 2062 6568 6176  al and its behav
+0004a580: 696f 7572 2069 7320 6c69 6b65 6c79 2074  iour is likely t
+0004a590: 6f20 6368 616e 6765 0a20 2020 2020 2020  o change.       
+0004a5a0: 2020 2020 2065 7370 6563 6961 6c6c 7920       especially 
+0004a5b0: 7265 6761 7264 696e 6720 7061 6464 696e  regarding paddin
+0004a5c0: 6720 6f66 2064 696d 656e 7369 6f6e 2063  g of dimension c
+0004a5d0: 6f6f 7264 696e 6174 6573 2028 6f72 2049  oordinates (or I
+0004a5e0: 6e64 6578 5661 7269 6162 6c65 7329 2e0a  ndexVariables)..
+0004a5f0: 0a20 2020 2020 2020 2057 6865 6e20 7573  .        When us
+0004a600: 696e 6720 6f6e 6520 6f66 2074 6865 206d  ing one of the m
+0004a610: 6f64 6573 2028 2265 6467 6522 2c20 2272  odes ("edge", "r
+0004a620: 6566 6c65 6374 222c 2022 7379 6d6d 6574  eflect", "symmet
+0004a630: 7269 6322 2c20 2277 7261 7022 292c 0a20  ric", "wrap"),. 
+0004a640: 2020 2020 2020 2063 6f6f 7264 696e 6174         coordinat
+0004a650: 6573 2077 696c 6c20 6265 2070 6164 6465  es will be padde
+0004a660: 6420 7769 7468 2074 6865 2073 616d 6520  d with the same 
+0004a670: 6d6f 6465 2c20 6f74 6865 7277 6973 6520  mode, otherwise 
+0004a680: 636f 6f72 6469 6e61 7465 730a 2020 2020  coordinates.    
+0004a690: 2020 2020 6172 6520 7061 6464 6564 2075      are padded u
+0004a6a0: 7369 6e67 2074 6865 2022 636f 6e73 7461  sing the "consta
+0004a6b0: 6e74 2220 6d6f 6465 2077 6974 6820 6669  nt" mode with fi
+0004a6c0: 6c6c 5f76 616c 7565 2064 7479 7065 732e  ll_value dtypes.
+0004a6d0: 4e41 2e0a 0a20 2020 2020 2020 2050 6172  NA...        Par
+0004a6e0: 616d 6574 6572 730a 2020 2020 2020 2020  ameters.        
+0004a6f0: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+0004a700: 2020 2070 6164 5f77 6964 7468 203a 206d     pad_width : m
+0004a710: 6170 7069 6e67 206f 6620 6861 7368 6162  apping of hashab
+0004a720: 6c65 2074 6f20 7475 706c 6520 6f66 2069  le to tuple of i
+0004a730: 6e74 0a20 2020 2020 2020 2020 2020 204d  nt.            M
+0004a740: 6170 7069 6e67 2077 6974 6820 7468 6520  apping with the 
+0004a750: 666f 726d 206f 6620 7b64 696d 3a20 2870  form of {dim: (p
+0004a760: 6164 5f62 6566 6f72 652c 2070 6164 5f61  ad_before, pad_a
+0004a770: 6674 6572 297d 0a20 2020 2020 2020 2020  fter)}.         
+0004a780: 2020 2064 6573 6372 6962 696e 6720 7468     describing th
+0004a790: 6520 6e75 6d62 6572 206f 6620 7661 6c75  e number of valu
+0004a7a0: 6573 2070 6164 6465 6420 616c 6f6e 6720  es padded along 
+0004a7b0: 6561 6368 2064 696d 656e 7369 6f6e 2e0a  each dimension..
+0004a7c0: 2020 2020 2020 2020 2020 2020 7b64 696d              {dim
+0004a7d0: 3a20 7061 647d 2069 7320 6120 7368 6f72  : pad} is a shor
+0004a7e0: 7463 7574 2066 6f72 2070 6164 5f62 6566  tcut for pad_bef
+0004a7f0: 6f72 6520 3d20 7061 645f 6166 7465 7220  ore = pad_after 
+0004a800: 3d20 7061 640a 2020 2020 2020 2020 6d6f  = pad.        mo
+0004a810: 6465 203a 207b 2263 6f6e 7374 616e 7422  de : {"constant"
+0004a820: 2c20 2265 6467 6522 2c20 226c 696e 6561  , "edge", "linea
+0004a830: 725f 7261 6d70 222c 2022 6d61 7869 6d75  r_ramp", "maximu
+0004a840: 6d22 2c20 226d 6561 6e22 2c20 226d 6564  m", "mean", "med
+0004a850: 6961 6e22 2c20 5c0a 2020 2020 2020 2020  ian", \.        
+0004a860: 2020 2020 226d 696e 696d 756d 222c 2022      "minimum", "
+0004a870: 7265 666c 6563 7422 2c20 2273 796d 6d65  reflect", "symme
+0004a880: 7472 6963 222c 2022 7772 6170 227d 2c20  tric", "wrap"}, 
+0004a890: 6465 6661 756c 743a 2022 636f 6e73 7461  default: "consta
+0004a8a0: 6e74 220a 2020 2020 2020 2020 2020 2020  nt".            
+0004a8b0: 486f 7720 746f 2070 6164 2074 6865 2044  How to pad the D
+0004a8c0: 6174 6141 7272 6179 2028 7461 6b65 6e20  ataArray (taken 
+0004a8d0: 6672 6f6d 206e 756d 7079 2064 6f63 7329  from numpy docs)
+0004a8e0: 3a0a 0a20 2020 2020 2020 2020 2020 202d  :..            -
+0004a8f0: 2022 636f 6e73 7461 6e74 223a 2050 6164   "constant": Pad
+0004a900: 7320 7769 7468 2061 2063 6f6e 7374 616e  s with a constan
+0004a910: 7420 7661 6c75 652e 0a20 2020 2020 2020  t value..       
+0004a920: 2020 2020 202d 2022 6564 6765 223a 2050       - "edge": P
+0004a930: 6164 7320 7769 7468 2074 6865 2065 6467  ads with the edg
+0004a940: 6520 7661 6c75 6573 206f 6620 6172 7261  e values of arra
+0004a950: 792e 0a20 2020 2020 2020 2020 2020 202d  y..            -
+0004a960: 2022 6c69 6e65 6172 5f72 616d 7022 3a20   "linear_ramp": 
+0004a970: 5061 6473 2077 6974 6820 7468 6520 6c69  Pads with the li
+0004a980: 6e65 6172 2072 616d 7020 6265 7477 6565  near ramp betwee
+0004a990: 6e20 656e 645f 7661 6c75 6520 616e 6420  n end_value and 
+0004a9a0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+0004a9b0: 2020 6172 7261 7920 6564 6765 2076 616c    array edge val
+0004a9c0: 7565 2e0a 2020 2020 2020 2020 2020 2020  ue..            
+0004a9d0: 2d20 226d 6178 696d 756d 223a 2050 6164  - "maximum": Pad
+0004a9e0: 7320 7769 7468 2074 6865 206d 6178 696d  s with the maxim
+0004a9f0: 756d 2076 616c 7565 206f 6620 616c 6c20  um value of all 
+0004aa00: 6f72 2070 6172 7420 6f66 2074 6865 0a20  or part of the. 
+0004aa10: 2020 2020 2020 2020 2020 2020 2076 6563               vec
+0004aa20: 746f 7220 616c 6f6e 6720 6561 6368 2061  tor along each a
+0004aa30: 7869 732e 0a20 2020 2020 2020 2020 2020  xis..           
+0004aa40: 202d 2022 6d65 616e 223a 2050 6164 7320   - "mean": Pads 
+0004aa50: 7769 7468 2074 6865 206d 6561 6e20 7661  with the mean va
+0004aa60: 6c75 6520 6f66 2061 6c6c 206f 7220 7061  lue of all or pa
+0004aa70: 7274 206f 6620 7468 650a 2020 2020 2020  rt of the.      
+0004aa80: 2020 2020 2020 2020 7665 6374 6f72 2061          vector a
+0004aa90: 6c6f 6e67 2065 6163 6820 6178 6973 2e0a  long each axis..
+0004aaa0: 2020 2020 2020 2020 2020 2020 2d20 226d              - "m
+0004aab0: 6564 6961 6e22 3a20 5061 6473 2077 6974  edian": Pads wit
+0004aac0: 6820 7468 6520 6d65 6469 616e 2076 616c  h the median val
+0004aad0: 7565 206f 6620 616c 6c20 6f72 2070 6172  ue of all or par
+0004aae0: 7420 6f66 2074 6865 0a20 2020 2020 2020  t of the.       
+0004aaf0: 2020 2020 2020 2076 6563 746f 7220 616c         vector al
+0004ab00: 6f6e 6720 6561 6368 2061 7869 732e 0a20  ong each axis.. 
+0004ab10: 2020 2020 2020 2020 2020 202d 2022 6d69             - "mi
+0004ab20: 6e69 6d75 6d22 3a20 5061 6473 2077 6974  nimum": Pads wit
+0004ab30: 6820 7468 6520 6d69 6e69 6d75 6d20 7661  h the minimum va
+0004ab40: 6c75 6520 6f66 2061 6c6c 206f 7220 7061  lue of all or pa
+0004ab50: 7274 206f 6620 7468 650a 2020 2020 2020  rt of the.      
+0004ab60: 2020 2020 2020 2020 7665 6374 6f72 2061          vector a
+0004ab70: 6c6f 6e67 2065 6163 6820 6178 6973 2e0a  long each axis..
+0004ab80: 2020 2020 2020 2020 2020 2020 2d20 2272              - "r
+0004ab90: 6566 6c65 6374 223a 2050 6164 7320 7769  eflect": Pads wi
+0004aba0: 7468 2074 6865 2072 6566 6c65 6374 696f  th the reflectio
+0004abb0: 6e20 6f66 2074 6865 2076 6563 746f 7220  n of the vector 
+0004abc0: 6d69 7272 6f72 6564 206f 6e0a 2020 2020  mirrored on.    
+0004abd0: 2020 2020 2020 2020 2020 7468 6520 6669            the fi
+0004abe0: 7273 7420 616e 6420 6c61 7374 2076 616c  rst and last val
+0004abf0: 7565 7320 6f66 2074 6865 2076 6563 746f  ues of the vecto
+0004ac00: 7220 616c 6f6e 6720 6561 6368 2061 7869  r along each axi
+0004ac10: 732e 0a20 2020 2020 2020 2020 2020 202d  s..            -
+0004ac20: 2022 7379 6d6d 6574 7269 6322 3a20 5061   "symmetric": Pa
+0004ac30: 6473 2077 6974 6820 7468 6520 7265 666c  ds with the refl
+0004ac40: 6563 7469 6f6e 206f 6620 7468 6520 7665  ection of the ve
+0004ac50: 6374 6f72 206d 6972 726f 7265 640a 2020  ctor mirrored.  
+0004ac60: 2020 2020 2020 2020 2020 2020 616c 6f6e              alon
+0004ac70: 6720 7468 6520 6564 6765 206f 6620 7468  g the edge of th
+0004ac80: 6520 6172 7261 792e 0a20 2020 2020 2020  e array..       
+0004ac90: 2020 2020 202d 2022 7772 6170 223a 2050       - "wrap": P
+0004aca0: 6164 7320 7769 7468 2074 6865 2077 7261  ads with the wra
+0004acb0: 7020 6f66 2074 6865 2076 6563 746f 7220  p of the vector 
+0004acc0: 616c 6f6e 6720 7468 6520 6178 6973 2e0a  along the axis..
+0004acd0: 2020 2020 2020 2020 2020 2020 2020 5468                Th
+0004ace0: 6520 6669 7273 7420 7661 6c75 6573 2061  e first values a
+0004acf0: 7265 2075 7365 6420 746f 2070 6164 2074  re used to pad t
+0004ad00: 6865 2065 6e64 2061 6e64 2074 6865 0a20  he end and the. 
+0004ad10: 2020 2020 2020 2020 2020 2020 2065 6e64               end
+0004ad20: 2076 616c 7565 7320 6172 6520 7573 6564   values are used
+0004ad30: 2074 6f20 7061 6420 7468 6520 6265 6769   to pad the begi
+0004ad40: 6e6e 696e 672e 0a0a 2020 2020 2020 2020  nning...        
+0004ad50: 7374 6174 5f6c 656e 6774 6820 3a20 696e  stat_length : in
+0004ad60: 742c 2074 7570 6c65 206f 7220 6d61 7070  t, tuple or mapp
+0004ad70: 696e 6720 6f66 2068 6173 6861 626c 6520  ing of hashable 
+0004ad80: 746f 2074 7570 6c65 2c20 6465 6661 756c  to tuple, defaul
+0004ad90: 743a 204e 6f6e 650a 2020 2020 2020 2020  t: None.        
+0004ada0: 2020 2020 5573 6564 2069 6e20 276d 6178      Used in 'max
+0004adb0: 696d 756d 272c 2027 6d65 616e 272c 2027  imum', 'mean', '
+0004adc0: 6d65 6469 616e 272c 2061 6e64 2027 6d69  median', and 'mi
+0004add0: 6e69 6d75 6d27 2e20 204e 756d 6265 7220  nimum'.  Number 
+0004ade0: 6f66 0a20 2020 2020 2020 2020 2020 2076  of.            v
+0004adf0: 616c 7565 7320 6174 2065 6467 6520 6f66  alues at edge of
+0004ae00: 2065 6163 6820 6178 6973 2075 7365 6420   each axis used 
+0004ae10: 746f 2063 616c 6375 6c61 7465 2074 6865  to calculate the
+0004ae20: 2073 7461 7469 7374 6963 2076 616c 7565   statistic value
+0004ae30: 2e0a 2020 2020 2020 2020 2020 2020 7b64  ..            {d
+0004ae40: 696d 5f31 3a20 2862 6566 6f72 655f 312c  im_1: (before_1,
+0004ae50: 2061 6674 6572 5f31 292c 202e 2e2e 2064   after_1), ... d
+0004ae60: 696d 5f4e 3a20 2862 6566 6f72 655f 4e2c  im_N: (before_N,
+0004ae70: 2061 6674 6572 5f4e 297d 2075 6e69 7175   after_N)} uniqu
+0004ae80: 650a 2020 2020 2020 2020 2020 2020 7374  e.            st
+0004ae90: 6174 6973 7469 6320 6c65 6e67 7468 7320  atistic lengths 
+0004aea0: 616c 6f6e 6720 6561 6368 2064 696d 656e  along each dimen
+0004aeb0: 7369 6f6e 2e0a 2020 2020 2020 2020 2020  sion..          
+0004aec0: 2020 2828 6265 666f 7265 2c20 6166 7465    ((before, afte
+0004aed0: 7229 2c29 2079 6965 6c64 7320 7361 6d65  r),) yields same
+0004aee0: 2062 6566 6f72 6520 616e 6420 6166 7465   before and afte
+0004aef0: 7220 7374 6174 6973 7469 6320 6c65 6e67  r statistic leng
+0004af00: 7468 730a 2020 2020 2020 2020 2020 2020  ths.            
+0004af10: 666f 7220 6561 6368 2064 696d 656e 7369  for each dimensi
+0004af20: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+0004af30: 2873 7461 745f 6c65 6e67 7468 2c29 206f  (stat_length,) o
+0004af40: 7220 696e 7420 6973 2061 2073 686f 7274  r int is a short
+0004af50: 6375 7420 666f 7220 6265 666f 7265 203d  cut for before =
+0004af60: 2061 6674 6572 203d 2073 7461 7469 7374   after = statist
+0004af70: 6963 0a20 2020 2020 2020 2020 2020 206c  ic.            l
+0004af80: 656e 6774 6820 666f 7220 616c 6c20 6178  ength for all ax
+0004af90: 6573 2e0a 2020 2020 2020 2020 2020 2020  es..            
+0004afa0: 4465 6661 756c 7420 6973 2060 604e 6f6e  Default is ``Non
+0004afb0: 6560 602c 2074 6f20 7573 6520 7468 6520  e``, to use the 
+0004afc0: 656e 7469 7265 2061 7869 732e 0a20 2020  entire axis..   
+0004afd0: 2020 2020 2063 6f6e 7374 616e 745f 7661       constant_va
+0004afe0: 6c75 6573 203a 2073 6361 6c61 722c 2074  lues : scalar, t
+0004aff0: 7570 6c65 206f 7220 6d61 7070 696e 6720  uple or mapping 
+0004b000: 6f66 2068 6173 6861 626c 6520 746f 2074  of hashable to t
+0004b010: 7570 6c65 2c20 6465 6661 756c 743a 2030  uple, default: 0
+0004b020: 0a20 2020 2020 2020 2020 2020 2055 7365  .            Use
+0004b030: 6420 696e 2027 636f 6e73 7461 6e74 272e  d in 'constant'.
+0004b040: 2020 5468 6520 7661 6c75 6573 2074 6f20    The values to 
+0004b050: 7365 7420 7468 6520 7061 6464 6564 2076  set the padded v
+0004b060: 616c 7565 7320 666f 7220 6561 6368 0a20  alues for each. 
+0004b070: 2020 2020 2020 2020 2020 2061 7869 732e             axis.
+0004b080: 0a20 2020 2020 2020 2020 2020 2060 607b  .            ``{
+0004b090: 6469 6d5f 313a 2028 6265 666f 7265 5f31  dim_1: (before_1
+0004b0a0: 2c20 6166 7465 725f 3129 2c20 2e2e 2e20  , after_1), ... 
+0004b0b0: 6469 6d5f 4e3a 2028 6265 666f 7265 5f4e  dim_N: (before_N
+0004b0c0: 2c20 6166 7465 725f 4e29 7d60 6020 756e  , after_N)}`` un
+0004b0d0: 6971 7565 0a20 2020 2020 2020 2020 2020  ique.           
+0004b0e0: 2070 6164 2063 6f6e 7374 616e 7473 2061   pad constants a
+0004b0f0: 6c6f 6e67 2065 6163 6820 6469 6d65 6e73  long each dimens
+0004b100: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+0004b110: 2060 6028 2862 6566 6f72 652c 2061 6674   ``((before, aft
+0004b120: 6572 292c 2960 6020 7969 656c 6473 2073  er),)`` yields s
+0004b130: 616d 6520 6265 666f 7265 2061 6e64 2061  ame before and a
+0004b140: 6674 6572 2063 6f6e 7374 616e 7473 2066  fter constants f
+0004b150: 6f72 2065 6163 680a 2020 2020 2020 2020  or each.        
+0004b160: 2020 2020 6469 6d65 6e73 696f 6e2e 0a20      dimension.. 
+0004b170: 2020 2020 2020 2020 2020 2060 6028 636f             ``(co
+0004b180: 6e73 7461 6e74 2c29 6060 206f 7220 6060  nstant,)`` or ``
+0004b190: 636f 6e73 7461 6e74 6060 2069 7320 6120  constant`` is a 
+0004b1a0: 7368 6f72 7463 7574 2066 6f72 2060 6062  shortcut for ``b
+0004b1b0: 6566 6f72 6520 3d20 6166 7465 7220 3d20  efore = after = 
+0004b1c0: 636f 6e73 7461 6e74 6060 2066 6f72 0a20  constant`` for. 
+0004b1d0: 2020 2020 2020 2020 2020 2061 6c6c 2064             all d
+0004b1e0: 696d 656e 7369 6f6e 732e 0a20 2020 2020  imensions..     
+0004b1f0: 2020 2020 2020 2044 6566 6175 6c74 2069         Default i
+0004b200: 7320 302e 0a20 2020 2020 2020 2065 6e64  s 0..        end
+0004b210: 5f76 616c 7565 7320 3a20 7363 616c 6172  _values : scalar
+0004b220: 2c20 7475 706c 6520 6f72 206d 6170 7069  , tuple or mappi
+0004b230: 6e67 206f 6620 6861 7368 6162 6c65 2074  ng of hashable t
+0004b240: 6f20 7475 706c 652c 2064 6566 6175 6c74  o tuple, default
+0004b250: 3a20 300a 2020 2020 2020 2020 2020 2020  : 0.            
+0004b260: 5573 6564 2069 6e20 276c 696e 6561 725f  Used in 'linear_
+0004b270: 7261 6d70 272e 2020 5468 6520 7661 6c75  ramp'.  The valu
+0004b280: 6573 2075 7365 6420 666f 7220 7468 6520  es used for the 
+0004b290: 656e 6469 6e67 2076 616c 7565 206f 6620  ending value of 
+0004b2a0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+0004b2b0: 6c69 6e65 6172 5f72 616d 7020 616e 6420  linear_ramp and 
+0004b2c0: 7468 6174 2077 696c 6c20 666f 726d 2074  that will form t
+0004b2d0: 6865 2065 6467 6520 6f66 2074 6865 2070  he edge of the p
+0004b2e0: 6164 6465 6420 6172 7261 792e 0a20 2020  added array..   
+0004b2f0: 2020 2020 2020 2020 2060 607b 6469 6d5f           ``{dim_
+0004b300: 313a 2028 6265 666f 7265 5f31 2c20 6166  1: (before_1, af
+0004b310: 7465 725f 3129 2c20 2e2e 2e20 6469 6d5f  ter_1), ... dim_
+0004b320: 4e3a 2028 6265 666f 7265 5f4e 2c20 6166  N: (before_N, af
+0004b330: 7465 725f 4e29 7d60 6020 756e 6971 7565  ter_N)}`` unique
+0004b340: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
+0004b350: 2076 616c 7565 7320 616c 6f6e 6720 6561   values along ea
+0004b360: 6368 2064 696d 656e 7369 6f6e 2e0a 2020  ch dimension..  
+0004b370: 2020 2020 2020 2020 2020 6060 2828 6265            ``((be
+0004b380: 666f 7265 2c20 6166 7465 7229 2c29 6060  fore, after),)``
+0004b390: 2079 6965 6c64 7320 7361 6d65 2062 6566   yields same bef
+0004b3a0: 6f72 6520 616e 6420 6166 7465 7220 656e  ore and after en
+0004b3b0: 6420 7661 6c75 6573 2066 6f72 2065 6163  d values for eac
+0004b3c0: 680a 2020 2020 2020 2020 2020 2020 6178  h.            ax
+0004b3d0: 6973 2e0a 2020 2020 2020 2020 2020 2020  is..            
+0004b3e0: 6060 2863 6f6e 7374 616e 742c 2960 6020  ``(constant,)`` 
+0004b3f0: 6f72 2060 6063 6f6e 7374 616e 7460 6020  or ``constant`` 
+0004b400: 6973 2061 2073 686f 7274 6375 7420 666f  is a shortcut fo
+0004b410: 7220 6060 6265 666f 7265 203d 2061 6674  r ``before = aft
+0004b420: 6572 203d 2063 6f6e 7374 616e 7460 6020  er = constant`` 
+0004b430: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
+0004b440: 616c 6c20 6178 6573 2e0a 2020 2020 2020  all axes..      
+0004b450: 2020 2020 2020 4465 6661 756c 7420 6973        Default is
+0004b460: 2030 2e0a 2020 2020 2020 2020 7265 666c   0..        refl
+0004b470: 6563 745f 7479 7065 203a 207b 2265 7665  ect_type : {"eve
+0004b480: 6e22 2c20 226f 6464 222c 204e 6f6e 657d  n", "odd", None}
+0004b490: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+0004b4a0: 2020 2020 2020 2055 7365 6420 696e 2022         Used in "
+0004b4b0: 7265 666c 6563 7422 2c20 616e 6420 2273  reflect", and "s
+0004b4c0: 796d 6d65 7472 6963 222e 2020 5468 6520  ymmetric".  The 
+0004b4d0: 2265 7665 6e22 2073 7479 6c65 2069 7320  "even" style is 
+0004b4e0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+0004b4f0: 6465 6661 756c 7420 7769 7468 2061 6e20  default with an 
+0004b500: 756e 616c 7465 7265 6420 7265 666c 6563  unaltered reflec
+0004b510: 7469 6f6e 2061 726f 756e 6420 7468 6520  tion around the 
+0004b520: 6564 6765 2076 616c 7565 2e20 2046 6f72  edge value.  For
+0004b530: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+0004b540: 2022 6f64 6422 2073 7479 6c65 2c20 7468   "odd" style, th
+0004b550: 6520 6578 7465 6e64 6564 2070 6172 7420  e extended part 
+0004b560: 6f66 2074 6865 2061 7272 6179 2069 7320  of the array is 
+0004b570: 6372 6561 7465 6420 6279 0a20 2020 2020  created by.     
+0004b580: 2020 2020 2020 2073 7562 7472 6163 7469         subtracti
+0004b590: 6e67 2074 6865 2072 6566 6c65 6374 6564  ng the reflected
+0004b5a0: 2076 616c 7565 7320 6672 6f6d 2074 776f   values from two
+0004b5b0: 2074 696d 6573 2074 6865 2065 6467 6520   times the edge 
+0004b5c0: 7661 6c75 652e 0a20 2020 2020 2020 206b  value..        k
+0004b5d0: 6565 705f 6174 7472 7320 3a20 626f 6f6c  eep_attrs : bool
+0004b5e0: 206f 7220 4e6f 6e65 2c20 6f70 7469 6f6e   or None, option
+0004b5f0: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
+0004b600: 6620 5472 7565 2c20 7468 6520 6174 7472  f True, the attr
+0004b610: 6962 7574 6573 2028 6060 6174 7472 7360  ibutes (``attrs`
+0004b620: 6029 2077 696c 6c20 6265 2063 6f70 6965  `) will be copie
+0004b630: 6420 6672 6f6d 2074 6865 0a20 2020 2020  d from the.     
+0004b640: 2020 2020 2020 206f 7269 6769 6e61 6c20         original 
+0004b650: 6f62 6a65 6374 2074 6f20 7468 6520 6e65  object to the ne
+0004b660: 7720 6f6e 652e 2049 6620 4661 6c73 652c  w one. If False,
+0004b670: 2074 6865 206e 6577 206f 626a 6563 740a   the new object.
+0004b680: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
+0004b690: 2062 6520 7265 7475 726e 6564 2077 6974   be returned wit
+0004b6a0: 686f 7574 2061 7474 7269 6275 7465 732e  hout attributes.
+0004b6b0: 0a20 2020 2020 2020 202a 2a70 6164 5f77  .        **pad_w
+0004b6c0: 6964 7468 5f6b 7761 7267 730a 2020 2020  idth_kwargs.    
+0004b6d0: 2020 2020 2020 2020 5468 6520 6b65 7977          The keyw
+0004b6e0: 6f72 6420 6172 6775 6d65 6e74 7320 666f  ord arguments fo
+0004b6f0: 726d 206f 6620 6060 7061 645f 7769 6474  rm of ``pad_widt
+0004b700: 6860 602e 0a20 2020 2020 2020 2020 2020  h``..           
+0004b710: 204f 6e65 206f 6620 6060 7061 645f 7769   One of ``pad_wi
+0004b720: 6474 6860 6020 6f72 2060 6070 6164 5f77  dth`` or ``pad_w
+0004b730: 6964 7468 5f6b 7761 7267 7360 6020 6d75  idth_kwargs`` mu
+0004b740: 7374 2062 6520 7072 6f76 6964 6564 2e0a  st be provided..
+0004b750: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0004b760: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0004b770: 0a20 2020 2020 2020 2070 6164 6465 6420  .        padded 
+0004b780: 3a20 4461 7461 7365 740a 2020 2020 2020  : Dataset.      
+0004b790: 2020 2020 2020 4461 7461 7365 7420 7769        Dataset wi
+0004b7a0: 7468 2074 6865 2070 6164 6465 6420 636f  th the padded co
+0004b7b0: 6f72 6469 6e61 7465 7320 616e 6420 6461  ordinates and da
+0004b7c0: 7461 2e0a 0a20 2020 2020 2020 2053 6565  ta...        See
+0004b7d0: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
+0004b7e0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
+0004b7f0: 6174 6173 6574 2e73 6869 6674 2c20 4461  ataset.shift, Da
+0004b800: 7461 7365 742e 726f 6c6c 2c20 4461 7461  taset.roll, Data
+0004b810: 7365 742e 6266 696c 6c2c 2044 6174 6173  set.bfill, Datas
+0004b820: 6574 2e66 6669 6c6c 2c20 6e75 6d70 792e  et.ffill, numpy.
+0004b830: 7061 642c 2064 6173 6b2e 6172 7261 792e  pad, dask.array.
+0004b840: 7061 640a 0a20 2020 2020 2020 204e 6f74  pad..        Not
+0004b850: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
+0004b860: 0a20 2020 2020 2020 2042 7920 6465 6661  .        By defa
+0004b870: 756c 7420 7768 656e 2060 606d 6f64 653d  ult when ``mode=
+0004b880: 2263 6f6e 7374 616e 7422 6060 2061 6e64  "constant"`` and
+0004b890: 2060 6063 6f6e 7374 616e 745f 7661 6c75   ``constant_valu
+0004b8a0: 6573 3d4e 6f6e 6560 602c 2069 6e74 6567  es=None``, integ
+0004b8b0: 6572 2074 7970 6573 2077 696c 6c20 6265  er types will be
+0004b8c0: 0a20 2020 2020 2020 2070 726f 6d6f 7465  .        promote
+0004b8d0: 6420 746f 2060 6066 6c6f 6174 6060 2061  d to ``float`` a
+0004b8e0: 6e64 2070 6164 6465 6420 7769 7468 2060  nd padded with `
+0004b8f0: 606e 702e 6e61 6e60 602e 2054 6f20 6176  `np.nan``. To av
+0004b900: 6f69 6420 7479 7065 2070 726f 6d6f 7469  oid type promoti
+0004b910: 6f6e 0a20 2020 2020 2020 2073 7065 6369  on.        speci
+0004b920: 6679 2060 6063 6f6e 7374 616e 745f 7661  fy ``constant_va
+0004b930: 6c75 6573 3d6e 702e 6e61 6e60 600a 0a20  lues=np.nan``.. 
+0004b940: 2020 2020 2020 2050 6164 6469 6e67 2063         Padding c
+0004b950: 6f6f 7264 696e 6174 6573 2077 696c 6c20  oordinates will 
+0004b960: 6472 6f70 2074 6865 6972 2063 6f72 7265  drop their corre
+0004b970: 7370 6f6e 6469 6e67 2069 6e64 6578 2028  sponding index (
+0004b980: 6966 2061 6e79 2920 616e 6420 7769 6c6c  if any) and will
+0004b990: 2072 6573 6574 2064 6566 6175 6c74 0a20   reset default. 
+0004b9a0: 2020 2020 2020 2069 6e64 6578 6573 2066         indexes f
+0004b9b0: 6f72 2064 696d 656e 7369 6f6e 2063 6f6f  or dimension coo
+0004b9c0: 7264 696e 6174 6573 2e0a 0a20 2020 2020  rdinates...     
+0004b9d0: 2020 2045 7861 6d70 6c65 730a 2020 2020     Examples.    
+0004b9e0: 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020      --------.   
+0004b9f0: 2020 2020 203e 3e3e 2064 7320 3d20 7872       >>> ds = xr
+0004ba00: 2e44 6174 6173 6574 287b 2266 6f6f 223a  .Dataset({"foo":
+0004ba10: 2028 2278 222c 2072 616e 6765 2835 2929   ("x", range(5))
+0004ba20: 7d29 0a20 2020 2020 2020 203e 3e3e 2064  }).        >>> d
+0004ba30: 732e 7061 6428 783d 2831 2c20 3229 290a  s.pad(x=(1, 2)).
+0004ba40: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
+0004ba50: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
+0004ba60: 2044 696d 656e 7369 6f6e 733a 2020 2878   Dimensions:  (x
+0004ba70: 3a20 3829 0a20 2020 2020 2020 2044 696d  : 8).        Dim
+0004ba80: 656e 7369 6f6e 7320 7769 7468 6f75 7420  ensions without 
+0004ba90: 636f 6f72 6469 6e61 7465 733a 2078 0a20  coordinates: x. 
+0004baa0: 2020 2020 2020 2044 6174 6120 7661 7269         Data vari
+0004bab0: 6162 6c65 733a 0a20 2020 2020 2020 2020  ables:.         
+0004bac0: 2020 2066 6f6f 2020 2020 2020 2878 2920     foo      (x) 
+0004bad0: 666c 6f61 7436 3420 6e61 6e20 302e 3020  float64 nan 0.0 
+0004bae0: 312e 3020 322e 3020 332e 3020 342e 3020  1.0 2.0 3.0 4.0 
+0004baf0: 6e61 6e20 6e61 6e0a 2020 2020 2020 2020  nan nan.        
+0004bb00: 2222 220a 2020 2020 2020 2020 7061 645f  """.        pad_
+0004bb10: 7769 6474 6820 3d20 6569 7468 6572 5f64  width = either_d
+0004bb20: 6963 745f 6f72 5f6b 7761 7267 7328 7061  ict_or_kwargs(pa
+0004bb30: 645f 7769 6474 682c 2070 6164 5f77 6964  d_width, pad_wid
+0004bb40: 7468 5f6b 7761 7267 732c 2022 7061 6422  th_kwargs, "pad"
+0004bb50: 290a 0a20 2020 2020 2020 2069 6620 6d6f  )..        if mo
+0004bb60: 6465 2069 6e20 2822 6564 6765 222c 2022  de in ("edge", "
+0004bb70: 7265 666c 6563 7422 2c20 2273 796d 6d65  reflect", "symme
+0004bb80: 7472 6963 222c 2022 7772 6170 2229 3a0a  tric", "wrap"):.
+0004bb90: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
+0004bba0: 645f 7061 645f 6d6f 6465 203d 206d 6f64  d_pad_mode = mod
+0004bbb0: 650a 2020 2020 2020 2020 2020 2020 636f  e.            co
+0004bbc0: 6f72 645f 7061 645f 6f70 7469 6f6e 7320  ord_pad_options 
+0004bbd0: 3d20 7b0a 2020 2020 2020 2020 2020 2020  = {.            
+0004bbe0: 2020 2020 2273 7461 745f 6c65 6e67 7468      "stat_length
+0004bbf0: 223a 2073 7461 745f 6c65 6e67 7468 2c0a  ": stat_length,.
+0004bc00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004bc10: 2263 6f6e 7374 616e 745f 7661 6c75 6573  "constant_values
+0004bc20: 223a 2063 6f6e 7374 616e 745f 7661 6c75  ": constant_valu
+0004bc30: 6573 2c0a 2020 2020 2020 2020 2020 2020  es,.            
+0004bc40: 2020 2020 2265 6e64 5f76 616c 7565 7322      "end_values"
+0004bc50: 3a20 656e 645f 7661 6c75 6573 2c0a 2020  : end_values,.  
+0004bc60: 2020 2020 2020 2020 2020 2020 2020 2272                "r
+0004bc70: 6566 6c65 6374 5f74 7970 6522 3a20 7265  eflect_type": re
+0004bc80: 666c 6563 745f 7479 7065 2c0a 2020 2020  flect_type,.    
+0004bc90: 2020 2020 2020 2020 7d0a 2020 2020 2020          }.      
+0004bca0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+0004bcb0: 2020 2020 636f 6f72 645f 7061 645f 6d6f      coord_pad_mo
+0004bcc0: 6465 203d 2022 636f 6e73 7461 6e74 220a  de = "constant".
+0004bcd0: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
+0004bce0: 645f 7061 645f 6f70 7469 6f6e 7320 3d20  d_pad_options = 
+0004bcf0: 7b7d 0a0a 2020 2020 2020 2020 6966 206b  {}..        if k
+0004bd00: 6565 705f 6174 7472 7320 6973 204e 6f6e  eep_attrs is Non
+0004bd10: 653a 0a20 2020 2020 2020 2020 2020 206b  e:.            k
+0004bd20: 6565 705f 6174 7472 7320 3d20 5f67 6574  eep_attrs = _get
+0004bd30: 5f6b 6565 705f 6174 7472 7328 6465 6661  _keep_attrs(defa
+0004bd40: 756c 743d 5472 7565 290a 0a20 2020 2020  ult=True)..     
+0004bd50: 2020 2076 6172 6961 626c 6573 203d 207b     variables = {
+0004bd60: 7d0a 0a20 2020 2020 2020 2023 206b 6565  }..        # kee
+0004bd70: 7020 696e 6465 7865 7320 7468 6174 2077  p indexes that w
+0004bd80: 6f6e 2774 2062 6520 6166 6665 6374 6564  on't be affected
+0004bd90: 2062 7920 7061 6420 616e 6420 6472 6f70   by pad and drop
+0004bda0: 2061 6c6c 206f 7468 6572 2069 6e64 6578   all other index
+0004bdb0: 6573 0a20 2020 2020 2020 2078 696e 6465  es.        xinde
+0004bdc0: 7865 7320 3d20 7365 6c66 2e78 696e 6465  xes = self.xinde
+0004bdd0: 7865 730a 2020 2020 2020 2020 7061 645f  xes.        pad_
+0004bde0: 6469 6d73 203d 2073 6574 2870 6164 5f77  dims = set(pad_w
+0004bdf0: 6964 7468 290a 2020 2020 2020 2020 696e  idth).        in
+0004be00: 6465 7865 7320 3d20 7b7d 0a20 2020 2020  dexes = {}.     
+0004be10: 2020 2066 6f72 206b 2c20 6964 7820 696e     for k, idx in
+0004be20: 2078 696e 6465 7865 732e 6974 656d 7328   xindexes.items(
+0004be30: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0004be40: 6620 6e6f 7420 7061 645f 6469 6d73 2e69  f not pad_dims.i
+0004be50: 6e74 6572 7365 6374 696f 6e28 7869 6e64  ntersection(xind
+0004be60: 6578 6573 2e67 6574 5f61 6c6c 5f64 696d  exes.get_all_dim
+0004be70: 7328 6b29 293a 0a20 2020 2020 2020 2020  s(k)):.         
+0004be80: 2020 2020 2020 2069 6e64 6578 6573 5b6b         indexes[k
+0004be90: 5d20 3d20 6964 780a 0a20 2020 2020 2020  ] = idx..       
+0004bea0: 2066 6f72 206e 616d 652c 2076 6172 2069   for name, var i
+0004beb0: 6e20 7365 6c66 2e76 6172 6961 626c 6573  n self.variables
+0004bec0: 2e69 7465 6d73 2829 3a0a 2020 2020 2020  .items():.      
+0004bed0: 2020 2020 2020 7661 725f 7061 645f 7769        var_pad_wi
+0004bee0: 6474 6820 3d20 7b6b 3a20 7620 666f 7220  dth = {k: v for 
+0004bef0: 6b2c 2076 2069 6e20 7061 645f 7769 6474  k, v in pad_widt
+0004bf00: 682e 6974 656d 7328 2920 6966 206b 2069  h.items() if k i
+0004bf10: 6e20 7661 722e 6469 6d73 7d0a 2020 2020  n var.dims}.    
+0004bf20: 2020 2020 2020 2020 6966 206e 6f74 2076          if not v
+0004bf30: 6172 5f70 6164 5f77 6964 7468 3a0a 2020  ar_pad_width:.  
+0004bf40: 2020 2020 2020 2020 2020 2020 2020 7661                va
+0004bf50: 7269 6162 6c65 735b 6e61 6d65 5d20 3d20  riables[name] = 
+0004bf60: 7661 720a 2020 2020 2020 2020 2020 2020  var.            
+0004bf70: 656c 6966 206e 616d 6520 696e 2073 656c  elif name in sel
+0004bf80: 662e 6461 7461 5f76 6172 733a 0a20 2020  f.data_vars:.   
+0004bf90: 2020 2020 2020 2020 2020 2020 2076 6172               var
+0004bfa0: 6961 626c 6573 5b6e 616d 655d 203d 2076  iables[name] = v
+0004bfb0: 6172 2e70 6164 280a 2020 2020 2020 2020  ar.pad(.        
+0004bfc0: 2020 2020 2020 2020 2020 2020 7061 645f              pad_
+0004bfd0: 7769 6474 683d 7661 725f 7061 645f 7769  width=var_pad_wi
+0004bfe0: 6474 682c 0a20 2020 2020 2020 2020 2020  dth,.           
+0004bff0: 2020 2020 2020 2020 206d 6f64 653d 6d6f           mode=mo
+0004c000: 6465 2c0a 2020 2020 2020 2020 2020 2020  de,.            
+0004c010: 2020 2020 2020 2020 7374 6174 5f6c 656e          stat_len
+0004c020: 6774 683d 7374 6174 5f6c 656e 6774 682c  gth=stat_length,
+0004c030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004c040: 2020 2020 2063 6f6e 7374 616e 745f 7661       constant_va
+0004c050: 6c75 6573 3d63 6f6e 7374 616e 745f 7661  lues=constant_va
+0004c060: 6c75 6573 2c0a 2020 2020 2020 2020 2020  lues,.          
+0004c070: 2020 2020 2020 2020 2020 656e 645f 7661            end_va
+0004c080: 6c75 6573 3d65 6e64 5f76 616c 7565 732c  lues=end_values,
+0004c090: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004c0a0: 2020 2020 2072 6566 6c65 6374 5f74 7970       reflect_typ
+0004c0b0: 653d 7265 666c 6563 745f 7479 7065 2c0a  e=reflect_type,.
 0004c0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c0d0: 2064 696d 5f76 6172 203d 207b 6e61 6d65   dim_var = {name
-0004c0e0: 3a20 7661 7269 6162 6c65 735b 6e61 6d65  : variables[name
-0004c0f0: 5d7d 0a20 2020 2020 2020 2020 2020 2020  ]}.             
-0004c100: 2020 2020 2020 2069 6e64 6578 203d 2050         index = P
-0004c110: 616e 6461 7349 6e64 6578 2e66 726f 6d5f  andasIndex.from_
-0004c120: 7661 7269 6162 6c65 7328 6469 6d5f 7661  variables(dim_va
-0004c130: 722c 206f 7074 696f 6e73 3d7b 7d29 0a20  r, options={}). 
-0004c140: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c150: 2020 2069 6e64 6578 5f76 6172 7320 3d20     index_vars = 
-0004c160: 696e 6465 782e 6372 6561 7465 5f76 6172  index.create_var
-0004c170: 6961 626c 6573 2864 696d 5f76 6172 290a  iables(dim_var).
-0004c180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004c190: 2020 2020 696e 6465 7865 735b 6e61 6d65      indexes[name
-0004c1a0: 5d20 3d20 696e 6465 780a 2020 2020 2020  ] = index.      
-0004c1b0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-0004c1c0: 7269 6162 6c65 735b 6e61 6d65 5d20 3d20  riables[name] = 
-0004c1d0: 696e 6465 785f 7661 7273 5b6e 616d 655d  index_vars[name]
-0004c1e0: 0a0a 2020 2020 2020 2020 6174 7472 7320  ..        attrs 
-0004c1f0: 3d20 7365 6c66 2e5f 6174 7472 7320 6966  = self._attrs if
-0004c200: 206b 6565 705f 6174 7472 7320 656c 7365   keep_attrs else
-0004c210: 204e 6f6e 650a 2020 2020 2020 2020 7265   None.        re
-0004c220: 7475 726e 2073 656c 662e 5f72 6570 6c61  turn self._repla
-0004c230: 6365 5f77 6974 685f 6e65 775f 6469 6d73  ce_with_new_dims
-0004c240: 2876 6172 6961 626c 6573 2c20 696e 6465  (variables, inde
-0004c250: 7865 733d 696e 6465 7865 732c 2061 7474  xes=indexes, att
-0004c260: 7273 3d61 7474 7273 290a 0a20 2020 2064  rs=attrs)..    d
-0004c270: 6566 2069 6478 6d69 6e28 0a20 2020 2020  ef idxmin(.     
-0004c280: 2020 2073 656c 663a 2054 5f44 6174 6173     self: T_Datas
-0004c290: 6574 2c0a 2020 2020 2020 2020 6469 6d3a  et,.        dim:
-0004c2a0: 2048 6173 6861 626c 6520 7c20 4e6f 6e65   Hashable | None
-0004c2b0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0004c2c0: 2073 6b69 706e 613a 2062 6f6f 6c20 7c20   skipna: bool | 
-0004c2d0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-0004c2e0: 2020 2020 2066 696c 6c5f 7661 6c75 653a       fill_value:
-0004c2f0: 2041 6e79 203d 2078 7264 7479 7065 732e   Any = xrdtypes.
-0004c300: 4e41 2c0a 2020 2020 2020 2020 6b65 6570  NA,.        keep
-0004c310: 5f61 7474 7273 3a20 626f 6f6c 207c 204e  _attrs: bool | N
-0004c320: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
-0004c330: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
-0004c340: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-0004c350: 6e20 7468 6520 636f 6f72 6469 6e61 7465  n the coordinate
-0004c360: 206c 6162 656c 206f 6620 7468 6520 6d69   label of the mi
-0004c370: 6e69 6d75 6d20 7661 6c75 6520 616c 6f6e  nimum value alon
-0004c380: 6720 6120 6469 6d65 6e73 696f 6e2e 0a0a  g a dimension...
-0004c390: 2020 2020 2020 2020 5265 7475 726e 7320          Returns 
-0004c3a0: 6120 6e65 7720 6044 6174 6173 6574 6020  a new `Dataset` 
-0004c3b0: 6e61 6d65 6420 6166 7465 7220 7468 6520  named after the 
-0004c3c0: 6469 6d65 6e73 696f 6e20 7769 7468 2074  dimension with t
-0004c3d0: 6865 2076 616c 7565 7320 6f66 0a20 2020  he values of.   
-0004c3e0: 2020 2020 2074 6865 2063 6f6f 7264 696e       the coordin
-0004c3f0: 6174 6520 6c61 6265 6c73 2061 6c6f 6e67  ate labels along
-0004c400: 2074 6861 7420 6469 6d65 6e73 696f 6e20   that dimension 
-0004c410: 636f 7272 6573 706f 6e64 696e 6720 746f  corresponding to
-0004c420: 206d 696e 696d 756d 0a20 2020 2020 2020   minimum.       
-0004c430: 2076 616c 7565 7320 616c 6f6e 6720 7468   values along th
-0004c440: 6174 2064 696d 656e 7369 6f6e 2e0a 0a20  at dimension... 
-0004c450: 2020 2020 2020 2049 6e20 636f 6d70 6172         In compar
-0004c460: 6973 6f6e 2074 6f20 3a70 793a 6d65 7468  ison to :py:meth
-0004c470: 3a60 7e44 6174 6173 6574 2e61 7267 6d69  :`~Dataset.argmi
-0004c480: 6e60 2c20 7468 6973 2072 6574 7572 6e73  n`, this returns
-0004c490: 2074 6865 0a20 2020 2020 2020 2063 6f6f   the.        coo
-0004c4a0: 7264 696e 6174 6520 6c61 6265 6c20 7768  rdinate label wh
-0004c4b0: 696c 6520 3a70 793a 6d65 7468 3a60 7e44  ile :py:meth:`~D
-0004c4c0: 6174 6173 6574 2e61 7267 6d69 6e60 2072  ataset.argmin` r
-0004c4d0: 6574 7572 6e73 2074 6865 2069 6e64 6578  eturns the index
-0004c4e0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-0004c4f0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-0004c500: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0004c510: 2064 696d 203a 2048 6173 6861 626c 652c   dim : Hashable,
-0004c520: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-0004c530: 2020 2020 2020 4469 6d65 6e73 696f 6e20        Dimension 
-0004c540: 6f76 6572 2077 6869 6368 2074 6f20 6170  over which to ap
-0004c550: 706c 7920 6069 6478 6d69 6e60 2e20 2054  ply `idxmin`.  T
-0004c560: 6869 7320 6973 206f 7074 696f 6e61 6c20  his is optional 
-0004c570: 666f 7220 3144 0a20 2020 2020 2020 2020  for 1D.         
-0004c580: 2020 2076 6172 6961 626c 6573 2c20 6275     variables, bu
-0004c590: 7420 7265 7175 6972 6564 2066 6f72 2076  t required for v
-0004c5a0: 6172 6961 626c 6573 2077 6974 6820 3220  ariables with 2 
-0004c5b0: 6f72 206d 6f72 6520 6469 6d65 6e73 696f  or more dimensio
-0004c5c0: 6e73 2e0a 2020 2020 2020 2020 736b 6970  ns..        skip
-0004c5d0: 6e61 203a 2062 6f6f 6c20 6f72 204e 6f6e  na : bool or Non
-0004c5e0: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
-0004c5f0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-0004c600: 2073 6b69 7020 6d69 7373 696e 6720 7661   skip missing va
-0004c610: 6c75 6573 2028 6173 206d 6172 6b65 6420  lues (as marked 
-0004c620: 6279 204e 614e 292e 2042 7920 6465 6661  by NaN). By defa
-0004c630: 756c 742c 206f 6e6c 790a 2020 2020 2020  ult, only.      
-0004c640: 2020 2020 2020 736b 6970 7320 6d69 7373        skips miss
-0004c650: 696e 6720 7661 6c75 6573 2066 6f72 2060  ing values for `
-0004c660: 6066 6c6f 6174 6060 2c20 6060 636f 6d70  `float``, ``comp
-0004c670: 6c65 7860 602c 2061 6e64 2060 606f 626a  lex``, and ``obj
-0004c680: 6563 7460 600a 2020 2020 2020 2020 2020  ect``.          
-0004c690: 2020 6474 7970 6573 3b20 6f74 6865 7220    dtypes; other 
-0004c6a0: 6474 7970 6573 2065 6974 6865 7220 646f  dtypes either do
-0004c6b0: 206e 6f74 2068 6176 6520 6120 7365 6e74   not have a sent
-0004c6c0: 696e 656c 206d 6973 7369 6e67 2076 616c  inel missing val
-0004c6d0: 7565 0a20 2020 2020 2020 2020 2020 2028  ue.            (
-0004c6e0: 6060 696e 7460 6029 206f 7220 6060 736b  ``int``) or ``sk
-0004c6f0: 6970 6e61 3d54 7275 6560 6020 6861 7320  ipna=True`` has 
-0004c700: 6e6f 7420 6265 656e 2069 6d70 6c65 6d65  not been impleme
-0004c710: 6e74 6564 0a20 2020 2020 2020 2020 2020  nted.           
-0004c720: 2028 6060 6461 7465 7469 6d65 3634 6060   (``datetime64``
-0004c730: 206f 7220 6060 7469 6d65 6465 6c74 6136   or ``timedelta6
-0004c740: 3460 6029 2e0a 2020 2020 2020 2020 6669  4``)..        fi
-0004c750: 6c6c 5f76 616c 7565 203a 2041 6e79 2c20  ll_value : Any, 
-0004c760: 6465 6661 756c 743a 204e 614e 0a20 2020  default: NaN.   
-0004c770: 2020 2020 2020 2020 2056 616c 7565 2074           Value t
-0004c780: 6f20 6265 2066 696c 6c65 6420 696e 2063  o be filled in c
-0004c790: 6173 6520 616c 6c20 6f66 2074 6865 2076  ase all of the v
-0004c7a0: 616c 7565 7320 616c 6f6e 6720 6120 6469  alues along a di
-0004c7b0: 6d65 6e73 696f 6e20 6172 650a 2020 2020  mension are.    
-0004c7c0: 2020 2020 2020 2020 6e75 6c6c 2e20 2042          null.  B
-0004c7d0: 7920 6465 6661 756c 7420 7468 6973 2069  y default this i
-0004c7e0: 7320 4e61 4e2e 2020 5468 6520 6669 6c6c  s NaN.  The fill
-0004c7f0: 2076 616c 7565 2061 6e64 2072 6573 756c   value and resul
-0004c800: 7420 6172 650a 2020 2020 2020 2020 2020  t are.          
-0004c810: 2020 6175 746f 6d61 7469 6361 6c6c 7920    automatically 
-0004c820: 636f 6e76 6572 7465 6420 746f 2061 2063  converted to a c
-0004c830: 6f6d 7061 7469 626c 6520 6474 7970 6520  ompatible dtype 
-0004c840: 6966 2070 6f73 7369 626c 652e 0a20 2020  if possible..   
-0004c850: 2020 2020 2020 2020 2049 676e 6f72 6564           Ignored
-0004c860: 2069 6620 6060 736b 6970 6e61 6060 2069   if ``skipna`` i
-0004c870: 7320 4661 6c73 652e 0a20 2020 2020 2020  s False..       
-0004c880: 206b 6565 705f 6174 7472 7320 3a20 626f   keep_attrs : bo
-0004c890: 6f6c 206f 7220 4e6f 6e65 2c20 6f70 7469  ol or None, opti
-0004c8a0: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
-0004c8b0: 2049 6620 5472 7565 2c20 7468 6520 6174   If True, the at
-0004c8c0: 7472 6962 7574 6573 2028 6060 6174 7472  tributes (``attr
-0004c8d0: 7360 6029 2077 696c 6c20 6265 2063 6f70  s``) will be cop
-0004c8e0: 6965 6420 6672 6f6d 2074 6865 0a20 2020  ied from the.   
-0004c8f0: 2020 2020 2020 2020 206f 7269 6769 6e61           origina
-0004c900: 6c20 6f62 6a65 6374 2074 6f20 7468 6520  l object to the 
-0004c910: 6e65 7720 6f6e 652e 2049 6620 4661 6c73  new one. If Fals
-0004c920: 652c 2074 6865 206e 6577 206f 626a 6563  e, the new objec
-0004c930: 740a 2020 2020 2020 2020 2020 2020 7769  t.            wi
-0004c940: 6c6c 2062 6520 7265 7475 726e 6564 2077  ll be returned w
-0004c950: 6974 686f 7574 2061 7474 7269 6275 7465  ithout attribute
-0004c960: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
-0004c970: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-0004c980: 2d2d 2d0a 2020 2020 2020 2020 7265 6475  ---.        redu
-0004c990: 6365 6420 3a20 4461 7461 7365 740a 2020  ced : Dataset.  
-0004c9a0: 2020 2020 2020 2020 2020 4e65 7720 6044            New `D
-0004c9b0: 6174 6173 6574 6020 6f62 6a65 6374 2077  ataset` object w
-0004c9c0: 6974 6820 6069 6478 6d69 6e60 2061 7070  ith `idxmin` app
-0004c9d0: 6c69 6564 2074 6f20 6974 7320 6461 7461  lied to its data
-0004c9e0: 2061 6e64 2074 6865 0a20 2020 2020 2020   and the.       
-0004c9f0: 2020 2020 2069 6e64 6963 6174 6564 2064       indicated d
-0004ca00: 696d 656e 7369 6f6e 2072 656d 6f76 6564  imension removed
-0004ca10: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
-0004ca20: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
-0004ca30: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
-0004ca40: 6141 7272 6179 2e69 6478 6d69 6e2c 2044  aArray.idxmin, D
-0004ca50: 6174 6173 6574 2e69 6478 6d61 782c 2044  ataset.idxmax, D
-0004ca60: 6174 6173 6574 2e6d 696e 2c20 4461 7461  ataset.min, Data
-0004ca70: 7365 742e 6172 676d 696e 0a0a 2020 2020  set.argmin..    
-0004ca80: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
-0004ca90: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
-0004caa0: 2020 2020 2020 3e3e 3e20 6172 7261 7931        >>> array1
-0004cab0: 203d 2078 722e 4461 7461 4172 7261 7928   = xr.DataArray(
-0004cac0: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
-0004cad0: 205b 302c 2032 2c20 312c 2030 2c20 2d32   [0, 2, 1, 0, -2
-0004cae0: 5d2c 2064 696d 733d 2278 222c 2063 6f6f  ], dims="x", coo
-0004caf0: 7264 733d 7b22 7822 3a20 5b22 6122 2c20  rds={"x": ["a", 
-0004cb00: 2262 222c 2022 6322 2c20 2264 222c 2022  "b", "c", "d", "
-0004cb10: 6522 5d7d 0a20 2020 2020 2020 202e 2e2e  e"]}.        ...
-0004cb20: 2029 0a20 2020 2020 2020 203e 3e3e 2061   ).        >>> a
-0004cb30: 7272 6179 3220 3d20 7872 2e44 6174 6141  rray2 = xr.DataA
-0004cb40: 7272 6179 280a 2020 2020 2020 2020 2e2e  rray(.        ..
-0004cb50: 2e20 2020 2020 5b0a 2020 2020 2020 2020  .     [.        
-0004cb60: 2e2e 2e20 2020 2020 2020 2020 5b32 2e30  ...         [2.0
-0004cb70: 2c20 312e 302c 2032 2e30 2c20 302e 302c  , 1.0, 2.0, 0.0,
-0004cb80: 202d 322e 305d 2c0a 2020 2020 2020 2020   -2.0],.        
-0004cb90: 2e2e 2e20 2020 2020 2020 2020 5b2d 342e  ...         [-4.
-0004cba0: 302c 206e 702e 4e61 4e2c 2032 2e30 2c20  0, np.NaN, 2.0, 
-0004cbb0: 6e70 2e4e 614e 2c20 2d32 2e30 5d2c 0a20  np.NaN, -2.0],. 
-0004cbc0: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
-0004cbd0: 2020 205b 6e70 2e4e 614e 2c20 6e70 2e4e     [np.NaN, np.N
-0004cbe0: 614e 2c20 312e 302c 206e 702e 4e61 4e2c  aN, 1.0, np.NaN,
-0004cbf0: 206e 702e 4e61 4e5d 2c0a 2020 2020 2020   np.NaN],.      
-0004cc00: 2020 2e2e 2e20 2020 2020 5d2c 0a20 2020    ...     ],.   
-0004cc10: 2020 2020 202e 2e2e 2020 2020 2064 696d       ...     dim
-0004cc20: 733d 5b22 7922 2c20 2278 225d 2c0a 2020  s=["y", "x"],.  
-0004cc30: 2020 2020 2020 2e2e 2e20 2020 2020 636f        ...     co
-0004cc40: 6f72 6473 3d7b 2279 223a 205b 2d31 2c20  ords={"y": [-1, 
-0004cc50: 302c 2031 5d2c 2022 7822 3a20 5b22 6122  0, 1], "x": ["a"
-0004cc60: 2c20 2262 222c 2022 6322 2c20 2264 222c  , "b", "c", "d",
-0004cc70: 2022 6522 5d7d 2c0a 2020 2020 2020 2020   "e"]},.        
-0004cc80: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
-0004cc90: 3e20 6473 203d 2078 722e 4461 7461 7365  > ds = xr.Datase
-0004cca0: 7428 7b22 696e 7422 3a20 6172 7261 7931  t({"int": array1
-0004ccb0: 2c20 2266 6c6f 6174 223a 2061 7272 6179  , "float": array
-0004ccc0: 327d 290a 2020 2020 2020 2020 3e3e 3e20  2}).        >>> 
-0004ccd0: 6473 2e6d 696e 2864 696d 3d22 7822 290a  ds.min(dim="x").
-0004cce0: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
-0004ccf0: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
-0004cd00: 2044 696d 656e 7369 6f6e 733a 2020 2879   Dimensions:  (y
-0004cd10: 3a20 3329 0a20 2020 2020 2020 2043 6f6f  : 3).        Coo
-0004cd20: 7264 696e 6174 6573 3a0a 2020 2020 2020  rdinates:.      
-0004cd30: 2020 2020 2a20 7920 2020 2020 2020 2028      * y        (
-0004cd40: 7929 2069 6e74 3634 202d 3120 3020 310a  y) int64 -1 0 1.
-0004cd50: 2020 2020 2020 2020 4461 7461 2076 6172          Data var
-0004cd60: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
-0004cd70: 2020 2020 696e 7420 2020 2020 2069 6e74      int      int
-0004cd80: 3634 202d 320a 2020 2020 2020 2020 2020  64 -2.          
-0004cd90: 2020 666c 6f61 7420 2020 2028 7929 2066    float    (y) f
-0004cda0: 6c6f 6174 3634 202d 322e 3020 2d34 2e30  loat64 -2.0 -4.0
-0004cdb0: 2031 2e30 0a20 2020 2020 2020 203e 3e3e   1.0.        >>>
-0004cdc0: 2064 732e 6172 676d 696e 2864 696d 3d22   ds.argmin(dim="
-0004cdd0: 7822 290a 2020 2020 2020 2020 3c78 6172  x").        <xar
-0004cde0: 7261 792e 4461 7461 7365 743e 0a20 2020  ray.Dataset>.   
-0004cdf0: 2020 2020 2044 696d 656e 7369 6f6e 733a       Dimensions:
-0004ce00: 2020 2879 3a20 3329 0a20 2020 2020 2020    (y: 3).       
-0004ce10: 2043 6f6f 7264 696e 6174 6573 3a0a 2020   Coordinates:.  
-0004ce20: 2020 2020 2020 2020 2a20 7920 2020 2020          * y     
-0004ce30: 2020 2028 7929 2069 6e74 3634 202d 3120     (y) int64 -1 
-0004ce40: 3020 310a 2020 2020 2020 2020 4461 7461  0 1.        Data
-0004ce50: 2076 6172 6961 626c 6573 3a0a 2020 2020   variables:.    
-0004ce60: 2020 2020 2020 2020 696e 7420 2020 2020          int     
-0004ce70: 2069 6e74 3634 2034 0a20 2020 2020 2020   int64 4.       
-0004ce80: 2020 2020 2066 6c6f 6174 2020 2020 2879       float    (y
-0004ce90: 2920 696e 7436 3420 3420 3020 320a 2020  ) int64 4 0 2.  
-0004cea0: 2020 2020 2020 3e3e 3e20 6473 2e69 6478        >>> ds.idx
-0004ceb0: 6d69 6e28 6469 6d3d 2278 2229 0a20 2020  min(dim="x").   
-0004cec0: 2020 2020 203c 7861 7272 6179 2e44 6174       <xarray.Dat
-0004ced0: 6173 6574 3e0a 2020 2020 2020 2020 4469  aset>.        Di
-0004cee0: 6d65 6e73 696f 6e73 3a20 2028 793a 2033  mensions:  (y: 3
-0004cef0: 290a 2020 2020 2020 2020 436f 6f72 6469  ).        Coordi
-0004cf00: 6e61 7465 733a 0a20 2020 2020 2020 2020  nates:.         
-0004cf10: 202a 2079 2020 2020 2020 2020 2879 2920   * y        (y) 
-0004cf20: 696e 7436 3420 2d31 2030 2031 0a20 2020  int64 -1 0 1.   
-0004cf30: 2020 2020 2044 6174 6120 7661 7269 6162       Data variab
-0004cf40: 6c65 733a 0a20 2020 2020 2020 2020 2020  les:.           
-0004cf50: 2069 6e74 2020 2020 2020 3c55 3120 2765   int      <U1 'e
-0004cf60: 270a 2020 2020 2020 2020 2020 2020 666c  '.            fl
-0004cf70: 6f61 7420 2020 2028 7929 206f 626a 6563  oat    (y) objec
-0004cf80: 7420 2765 2720 2761 2720 2763 270a 2020  t 'e' 'a' 'c'.  
-0004cf90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0004cfa0: 2020 7265 7475 726e 2073 656c 662e 6d61    return self.ma
-0004cfb0: 7028 0a20 2020 2020 2020 2020 2020 206d  p(.            m
-0004cfc0: 6574 686f 6463 616c 6c65 7228 0a20 2020  ethodcaller(.   
-0004cfd0: 2020 2020 2020 2020 2020 2020 2022 6964               "id
-0004cfe0: 786d 696e 222c 0a20 2020 2020 2020 2020  xmin",.         
-0004cff0: 2020 2020 2020 2064 696d 3d64 696d 2c0a         dim=dim,.
-0004d000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004d010: 736b 6970 6e61 3d73 6b69 706e 612c 0a20  skipna=skipna,. 
-0004d020: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0004d030: 696c 6c5f 7661 6c75 653d 6669 6c6c 5f76  ill_value=fill_v
-0004d040: 616c 7565 2c0a 2020 2020 2020 2020 2020  alue,.          
-0004d050: 2020 2020 2020 6b65 6570 5f61 7474 7273        keep_attrs
-0004d060: 3d6b 6565 705f 6174 7472 732c 0a20 2020  =keep_attrs,.   
-0004d070: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-0004d080: 2020 2029 0a0a 2020 2020 6465 6620 6964     )..    def id
-0004d090: 786d 6178 280a 2020 2020 2020 2020 7365  xmax(.        se
-0004d0a0: 6c66 3a20 545f 4461 7461 7365 742c 0a20  lf: T_Dataset,. 
-0004d0b0: 2020 2020 2020 2064 696d 3a20 4861 7368         dim: Hash
-0004d0c0: 6162 6c65 207c 204e 6f6e 6520 3d20 4e6f  able | None = No
-0004d0d0: 6e65 2c0a 2020 2020 2020 2020 736b 6970  ne,.        skip
-0004d0e0: 6e61 3a20 626f 6f6c 207c 204e 6f6e 6520  na: bool | None 
-0004d0f0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0004d100: 6669 6c6c 5f76 616c 7565 3a20 416e 7920  fill_value: Any 
-0004d110: 3d20 7872 6474 7970 6573 2e4e 412c 0a20  = xrdtypes.NA,. 
-0004d120: 2020 2020 2020 206b 6565 705f 6174 7472         keep_attr
-0004d130: 733a 2062 6f6f 6c20 7c20 4e6f 6e65 203d  s: bool | None =
-0004d140: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
-0004d150: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
-0004d160: 2020 2022 2222 5265 7475 726e 2074 6865     """Return the
-0004d170: 2063 6f6f 7264 696e 6174 6520 6c61 6265   coordinate labe
-0004d180: 6c20 6f66 2074 6865 206d 6178 696d 756d  l of the maximum
-0004d190: 2076 616c 7565 2061 6c6f 6e67 2061 2064   value along a d
-0004d1a0: 696d 656e 7369 6f6e 2e0a 0a20 2020 2020  imension...     
-0004d1b0: 2020 2052 6574 7572 6e73 2061 206e 6577     Returns a new
-0004d1c0: 2060 4461 7461 7365 7460 206e 616d 6564   `Dataset` named
-0004d1d0: 2061 6674 6572 2074 6865 2064 696d 656e   after the dimen
-0004d1e0: 7369 6f6e 2077 6974 6820 7468 6520 7661  sion with the va
-0004d1f0: 6c75 6573 206f 660a 2020 2020 2020 2020  lues of.        
-0004d200: 7468 6520 636f 6f72 6469 6e61 7465 206c  the coordinate l
-0004d210: 6162 656c 7320 616c 6f6e 6720 7468 6174  abels along that
-0004d220: 2064 696d 656e 7369 6f6e 2063 6f72 7265   dimension corre
-0004d230: 7370 6f6e 6469 6e67 2074 6f20 6d61 7869  sponding to maxi
-0004d240: 6d75 6d0a 2020 2020 2020 2020 7661 6c75  mum.        valu
-0004d250: 6573 2061 6c6f 6e67 2074 6861 7420 6469  es along that di
-0004d260: 6d65 6e73 696f 6e2e 0a0a 2020 2020 2020  mension...      
-0004d270: 2020 496e 2063 6f6d 7061 7269 736f 6e20    In comparison 
-0004d280: 746f 203a 7079 3a6d 6574 683a 607e 4461  to :py:meth:`~Da
-0004d290: 7461 7365 742e 6172 676d 6178 602c 2074  taset.argmax`, t
-0004d2a0: 6869 7320 7265 7475 726e 7320 7468 650a  his returns the.
-0004d2b0: 2020 2020 2020 2020 636f 6f72 6469 6e61          coordina
-0004d2c0: 7465 206c 6162 656c 2077 6869 6c65 203a  te label while :
-0004d2d0: 7079 3a6d 6574 683a 607e 4461 7461 7365  py:meth:`~Datase
-0004d2e0: 742e 6172 676d 6178 6020 7265 7475 726e  t.argmax` return
-0004d2f0: 7320 7468 6520 696e 6465 782e 0a0a 2020  s the index...  
-0004d300: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-0004d310: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0004d320: 2d2d 2d0a 2020 2020 2020 2020 6469 6d20  ---.        dim 
-0004d330: 3a20 7374 722c 206f 7074 696f 6e61 6c0a  : str, optional.
-0004d340: 2020 2020 2020 2020 2020 2020 4469 6d65              Dime
-0004d350: 6e73 696f 6e20 6f76 6572 2077 6869 6368  nsion over which
-0004d360: 2074 6f20 6170 706c 7920 6069 6478 6d61   to apply `idxma
-0004d370: 7860 2e20 2054 6869 7320 6973 206f 7074  x`.  This is opt
-0004d380: 696f 6e61 6c20 666f 7220 3144 0a20 2020  ional for 1D.   
-0004d390: 2020 2020 2020 2020 2076 6172 6961 626c           variabl
-0004d3a0: 6573 2c20 6275 7420 7265 7175 6972 6564  es, but required
-0004d3b0: 2066 6f72 2076 6172 6961 626c 6573 2077   for variables w
-0004d3c0: 6974 6820 3220 6f72 206d 6f72 6520 6469  ith 2 or more di
-0004d3d0: 6d65 6e73 696f 6e73 2e0a 2020 2020 2020  mensions..      
-0004d3e0: 2020 736b 6970 6e61 203a 2062 6f6f 6c20    skipna : bool 
-0004d3f0: 6f72 204e 6f6e 652c 206f 7074 696f 6e61  or None, optiona
-0004d400: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
-0004d410: 2054 7275 652c 2073 6b69 7020 6d69 7373   True, skip miss
-0004d420: 696e 6720 7661 6c75 6573 2028 6173 206d  ing values (as m
-0004d430: 6172 6b65 6420 6279 204e 614e 292e 2042  arked by NaN). B
-0004d440: 7920 6465 6661 756c 742c 206f 6e6c 790a  y default, only.
-0004d450: 2020 2020 2020 2020 2020 2020 736b 6970              skip
-0004d460: 7320 6d69 7373 696e 6720 7661 6c75 6573  s missing values
-0004d470: 2066 6f72 2060 6066 6c6f 6174 6060 2c20   for ``float``, 
-0004d480: 6060 636f 6d70 6c65 7860 602c 2061 6e64  ``complex``, and
-0004d490: 2060 606f 626a 6563 7460 600a 2020 2020   ``object``.    
-0004d4a0: 2020 2020 2020 2020 6474 7970 6573 3b20          dtypes; 
-0004d4b0: 6f74 6865 7220 6474 7970 6573 2065 6974  other dtypes eit
-0004d4c0: 6865 7220 646f 206e 6f74 2068 6176 6520  her do not have 
-0004d4d0: 6120 7365 6e74 696e 656c 206d 6973 7369  a sentinel missi
-0004d4e0: 6e67 2076 616c 7565 0a20 2020 2020 2020  ng value.       
-0004d4f0: 2020 2020 2028 6060 696e 7460 6029 206f       (``int``) o
-0004d500: 7220 6060 736b 6970 6e61 3d54 7275 6560  r ``skipna=True`
-0004d510: 6020 6861 7320 6e6f 7420 6265 656e 2069  ` has not been i
-0004d520: 6d70 6c65 6d65 6e74 6564 0a20 2020 2020  mplemented.     
-0004d530: 2020 2020 2020 2028 6060 6461 7465 7469         (``dateti
-0004d540: 6d65 3634 6060 206f 7220 6060 7469 6d65  me64`` or ``time
-0004d550: 6465 6c74 6136 3460 6029 2e0a 2020 2020  delta64``)..    
-0004d560: 2020 2020 6669 6c6c 5f76 616c 7565 203a      fill_value :
-0004d570: 2041 6e79 2c20 6465 6661 756c 743a 204e   Any, default: N
-0004d580: 614e 0a20 2020 2020 2020 2020 2020 2056  aN.            V
-0004d590: 616c 7565 2074 6f20 6265 2066 696c 6c65  alue to be fille
-0004d5a0: 6420 696e 2063 6173 6520 616c 6c20 6f66  d in case all of
-0004d5b0: 2074 6865 2076 616c 7565 7320 616c 6f6e   the values alon
-0004d5c0: 6720 6120 6469 6d65 6e73 696f 6e20 6172  g a dimension ar
-0004d5d0: 650a 2020 2020 2020 2020 2020 2020 6e75  e.            nu
-0004d5e0: 6c6c 2e20 2042 7920 6465 6661 756c 7420  ll.  By default 
-0004d5f0: 7468 6973 2069 7320 4e61 4e2e 2020 5468  this is NaN.  Th
-0004d600: 6520 6669 6c6c 2076 616c 7565 2061 6e64  e fill value and
-0004d610: 2072 6573 756c 7420 6172 650a 2020 2020   result are.    
-0004d620: 2020 2020 2020 2020 6175 746f 6d61 7469          automati
-0004d630: 6361 6c6c 7920 636f 6e76 6572 7465 6420  cally converted 
-0004d640: 746f 2061 2063 6f6d 7061 7469 626c 6520  to a compatible 
-0004d650: 6474 7970 6520 6966 2070 6f73 7369 626c  dtype if possibl
-0004d660: 652e 0a20 2020 2020 2020 2020 2020 2049  e..            I
-0004d670: 676e 6f72 6564 2069 6620 6060 736b 6970  gnored if ``skip
-0004d680: 6e61 6060 2069 7320 4661 6c73 652e 0a20  na`` is False.. 
-0004d690: 2020 2020 2020 206b 6565 705f 6174 7472         keep_attr
-0004d6a0: 7320 3a20 626f 6f6c 206f 7220 4e6f 6e65  s : bool or None
-0004d6b0: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
-0004d6c0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-0004d6d0: 7468 6520 6174 7472 6962 7574 6573 2028  the attributes (
-0004d6e0: 6060 6174 7472 7360 6029 2077 696c 6c20  ``attrs``) will 
-0004d6f0: 6265 2063 6f70 6965 6420 6672 6f6d 2074  be copied from t
-0004d700: 6865 0a20 2020 2020 2020 2020 2020 206f  he.            o
-0004d710: 7269 6769 6e61 6c20 6f62 6a65 6374 2074  riginal object t
-0004d720: 6f20 7468 6520 6e65 7720 6f6e 652e 2049  o the new one. I
-0004d730: 6620 4661 6c73 652c 2074 6865 206e 6577  f False, the new
-0004d740: 206f 626a 6563 740a 2020 2020 2020 2020   object.        
-0004d750: 2020 2020 7769 6c6c 2062 6520 7265 7475      will be retu
-0004d760: 726e 6564 2077 6974 686f 7574 2061 7474  rned without att
-0004d770: 7269 6275 7465 732e 0a0a 2020 2020 2020  ributes...      
-0004d780: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-0004d790: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-0004d7a0: 2020 7265 6475 6365 6420 3a20 4461 7461    reduced : Data
-0004d7b0: 7365 740a 2020 2020 2020 2020 2020 2020  set.            
-0004d7c0: 4e65 7720 6044 6174 6173 6574 6020 6f62  New `Dataset` ob
-0004d7d0: 6a65 6374 2077 6974 6820 6069 6478 6d61  ject with `idxma
-0004d7e0: 7860 2061 7070 6c69 6564 2074 6f20 6974  x` applied to it
-0004d7f0: 7320 6461 7461 2061 6e64 2074 6865 0a20  s data and the. 
-0004d800: 2020 2020 2020 2020 2020 2069 6e64 6963             indic
-0004d810: 6174 6564 2064 696d 656e 7369 6f6e 2072  ated dimension r
-0004d820: 656d 6f76 6564 2e0a 0a20 2020 2020 2020  emoved...       
-0004d830: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
-0004d840: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
-0004d850: 2020 2044 6174 6141 7272 6179 2e69 6478     DataArray.idx
-0004d860: 6d61 782c 2044 6174 6173 6574 2e69 6478  max, Dataset.idx
-0004d870: 6d69 6e2c 2044 6174 6173 6574 2e6d 6178  min, Dataset.max
-0004d880: 2c20 4461 7461 7365 742e 6172 676d 6178  , Dataset.argmax
-0004d890: 0a0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-0004d8a0: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-0004d8b0: 2d2d 2d0a 2020 2020 2020 2020 3e3e 3e20  ---.        >>> 
-0004d8c0: 6172 7261 7931 203d 2078 722e 4461 7461  array1 = xr.Data
-0004d8d0: 4172 7261 7928 0a20 2020 2020 2020 202e  Array(.        .
-0004d8e0: 2e2e 2020 2020 205b 302c 2032 2c20 312c  ..     [0, 2, 1,
-0004d8f0: 2030 2c20 2d32 5d2c 2064 696d 733d 2278   0, -2], dims="x
-0004d900: 222c 2063 6f6f 7264 733d 7b22 7822 3a20  ", coords={"x": 
-0004d910: 5b22 6122 2c20 2262 222c 2022 6322 2c20  ["a", "b", "c", 
-0004d920: 2264 222c 2022 6522 5d7d 0a20 2020 2020  "d", "e"]}.     
-0004d930: 2020 202e 2e2e 2029 0a20 2020 2020 2020     ... ).       
-0004d940: 203e 3e3e 2061 7272 6179 3220 3d20 7872   >>> array2 = xr
-0004d950: 2e44 6174 6141 7272 6179 280a 2020 2020  .DataArray(.    
-0004d960: 2020 2020 2e2e 2e20 2020 2020 5b0a 2020      ...     [.  
-0004d970: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0004d980: 2020 5b32 2e30 2c20 312e 302c 2032 2e30    [2.0, 1.0, 2.0
-0004d990: 2c20 302e 302c 202d 322e 305d 2c0a 2020  , 0.0, -2.0],.  
-0004d9a0: 2020 2020 2020 2e2e 2e20 2020 2020 2020        ...       
-0004d9b0: 2020 5b2d 342e 302c 206e 702e 4e61 4e2c    [-4.0, np.NaN,
-0004d9c0: 2032 2e30 2c20 6e70 2e4e 614e 2c20 2d32   2.0, np.NaN, -2
-0004d9d0: 2e30 5d2c 0a20 2020 2020 2020 202e 2e2e  .0],.        ...
-0004d9e0: 2020 2020 2020 2020 205b 6e70 2e4e 614e           [np.NaN
-0004d9f0: 2c20 6e70 2e4e 614e 2c20 312e 302c 206e  , np.NaN, 1.0, n
-0004da00: 702e 4e61 4e2c 206e 702e 4e61 4e5d 2c0a  p.NaN, np.NaN],.
-0004da10: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
-0004da20: 5d2c 0a20 2020 2020 2020 202e 2e2e 2020  ],.        ...  
-0004da30: 2020 2064 696d 733d 5b22 7922 2c20 2278     dims=["y", "x
-0004da40: 225d 2c0a 2020 2020 2020 2020 2e2e 2e20  "],.        ... 
-0004da50: 2020 2020 636f 6f72 6473 3d7b 2279 223a      coords={"y":
-0004da60: 205b 2d31 2c20 302c 2031 5d2c 2022 7822   [-1, 0, 1], "x"
-0004da70: 3a20 5b22 6122 2c20 2262 222c 2022 6322  : ["a", "b", "c"
-0004da80: 2c20 2264 222c 2022 6522 5d7d 2c0a 2020  , "d", "e"]},.  
-0004da90: 2020 2020 2020 2e2e 2e20 290a 2020 2020        ... ).    
-0004daa0: 2020 2020 3e3e 3e20 6473 203d 2078 722e      >>> ds = xr.
-0004dab0: 4461 7461 7365 7428 7b22 696e 7422 3a20  Dataset({"int": 
-0004dac0: 6172 7261 7931 2c20 2266 6c6f 6174 223a  array1, "float":
-0004dad0: 2061 7272 6179 327d 290a 2020 2020 2020   array2}).      
-0004dae0: 2020 3e3e 3e20 6473 2e6d 6178 2864 696d    >>> ds.max(dim
-0004daf0: 3d22 7822 290a 2020 2020 2020 2020 3c78  ="x").        <x
-0004db00: 6172 7261 792e 4461 7461 7365 743e 0a20  array.Dataset>. 
-0004db10: 2020 2020 2020 2044 696d 656e 7369 6f6e         Dimension
-0004db20: 733a 2020 2879 3a20 3329 0a20 2020 2020  s:  (y: 3).     
-0004db30: 2020 2043 6f6f 7264 696e 6174 6573 3a0a     Coordinates:.
-0004db40: 2020 2020 2020 2020 2020 2a20 7920 2020            * y   
-0004db50: 2020 2020 2028 7929 2069 6e74 3634 202d       (y) int64 -
-0004db60: 3120 3020 310a 2020 2020 2020 2020 4461  1 0 1.        Da
-0004db70: 7461 2076 6172 6961 626c 6573 3a0a 2020  ta variables:.  
-0004db80: 2020 2020 2020 2020 2020 696e 7420 2020            int   
-0004db90: 2020 2069 6e74 3634 2032 0a20 2020 2020     int64 2.     
-0004dba0: 2020 2020 2020 2066 6c6f 6174 2020 2020         float    
-0004dbb0: 2879 2920 666c 6f61 7436 3420 322e 3020  (y) float64 2.0 
-0004dbc0: 322e 3020 312e 300a 2020 2020 2020 2020  2.0 1.0.        
-0004dbd0: 3e3e 3e20 6473 2e61 7267 6d61 7828 6469  >>> ds.argmax(di
-0004dbe0: 6d3d 2278 2229 0a20 2020 2020 2020 203c  m="x").        <
-0004dbf0: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
-0004dc00: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
-0004dc10: 6e73 3a20 2028 793a 2033 290a 2020 2020  ns:  (y: 3).    
-0004dc20: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
-0004dc30: 0a20 2020 2020 2020 2020 202a 2079 2020  .          * y  
-0004dc40: 2020 2020 2020 2879 2920 696e 7436 3420        (y) int64 
-0004dc50: 2d31 2030 2031 0a20 2020 2020 2020 2044  -1 0 1.        D
-0004dc60: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
-0004dc70: 2020 2020 2020 2020 2020 2069 6e74 2020             int  
-0004dc80: 2020 2020 696e 7436 3420 310a 2020 2020      int64 1.    
-0004dc90: 2020 2020 2020 2020 666c 6f61 7420 2020          float   
-0004dca0: 2028 7929 2069 6e74 3634 2030 2032 2032   (y) int64 0 2 2
-0004dcb0: 0a20 2020 2020 2020 203e 3e3e 2064 732e  .        >>> ds.
-0004dcc0: 6964 786d 6178 2864 696d 3d22 7822 290a  idxmax(dim="x").
-0004dcd0: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
-0004dce0: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
-0004dcf0: 2044 696d 656e 7369 6f6e 733a 2020 2879   Dimensions:  (y
-0004dd00: 3a20 3329 0a20 2020 2020 2020 2043 6f6f  : 3).        Coo
-0004dd10: 7264 696e 6174 6573 3a0a 2020 2020 2020  rdinates:.      
-0004dd20: 2020 2020 2a20 7920 2020 2020 2020 2028      * y        (
-0004dd30: 7929 2069 6e74 3634 202d 3120 3020 310a  y) int64 -1 0 1.
-0004dd40: 2020 2020 2020 2020 4461 7461 2076 6172          Data var
-0004dd50: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
-0004dd60: 2020 2020 696e 7420 2020 2020 203c 5531      int      <U1
-0004dd70: 2027 6227 0a20 2020 2020 2020 2020 2020   'b'.           
-0004dd80: 2066 6c6f 6174 2020 2020 2879 2920 6f62   float    (y) ob
-0004dd90: 6a65 6374 2027 6127 2027 6327 2027 6327  ject 'a' 'c' 'c'
-0004dda0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0004ddb0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0004ddc0: 2e6d 6170 280a 2020 2020 2020 2020 2020  .map(.          
-0004ddd0: 2020 6d65 7468 6f64 6361 6c6c 6572 280a    methodcaller(.
-0004dde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004ddf0: 2269 6478 6d61 7822 2c0a 2020 2020 2020  "idxmax",.      
-0004de00: 2020 2020 2020 2020 2020 6469 6d3d 6469            dim=di
-0004de10: 6d2c 0a20 2020 2020 2020 2020 2020 2020  m,.             
-0004de20: 2020 2073 6b69 706e 613d 736b 6970 6e61     skipna=skipna
-0004de30: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0004de40: 2020 6669 6c6c 5f76 616c 7565 3d66 696c    fill_value=fil
-0004de50: 6c5f 7661 6c75 652c 0a20 2020 2020 2020  l_value,.       
-0004de60: 2020 2020 2020 2020 206b 6565 705f 6174           keep_at
-0004de70: 7472 733d 6b65 6570 5f61 7474 7273 2c0a  trs=keep_attrs,.
-0004de80: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0004de90: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0004dea0: 2061 7267 6d69 6e28 7365 6c66 3a20 545f   argmin(self: T_
-0004deb0: 4461 7461 7365 742c 2064 696d 3a20 4861  Dataset, dim: Ha
-0004dec0: 7368 6162 6c65 207c 204e 6f6e 6520 3d20  shable | None = 
-0004ded0: 4e6f 6e65 2c20 2a2a 6b77 6172 6773 2920  None, **kwargs) 
-0004dee0: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-0004def0: 2020 2020 2020 2222 2249 6e64 6963 6573        """Indices
-0004df00: 206f 6620 7468 6520 6d69 6e69 6d61 206f   of the minima o
-0004df10: 6620 7468 6520 6d65 6d62 6572 2076 6172  f the member var
-0004df20: 6961 626c 6573 2e0a 0a20 2020 2020 2020  iables...       
-0004df30: 2049 6620 7468 6572 6520 6172 6520 6d75   If there are mu
-0004df40: 6c74 6970 6c65 206d 696e 696d 612c 2074  ltiple minima, t
-0004df50: 6865 2069 6e64 6963 6573 206f 6620 7468  he indices of th
-0004df60: 6520 6669 7273 7420 6f6e 6520 666f 756e  e first one foun
-0004df70: 6420 7769 6c6c 2062 650a 2020 2020 2020  d will be.      
-0004df80: 2020 7265 7475 726e 6564 2e0a 0a20 2020    returned...   
-0004df90: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
-0004dfa0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0004dfb0: 2d2d 0a20 2020 2020 2020 2064 696d 203a  --.        dim :
-0004dfc0: 2048 6173 6861 626c 652c 206f 7074 696f   Hashable, optio
-0004dfd0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
-0004dfe0: 5468 6520 6469 6d65 6e73 696f 6e20 6f76  The dimension ov
-0004dff0: 6572 2077 6869 6368 2074 6f20 6669 6e64  er which to find
-0004e000: 2074 6865 206d 696e 696d 756d 2e20 4279   the minimum. By
-0004e010: 2064 6566 6175 6c74 2c20 6669 6e64 7320   default, finds 
-0004e020: 6d69 6e69 6d75 6d20 6f76 6572 0a20 2020  minimum over.   
-0004e030: 2020 2020 2020 2020 2061 6c6c 2064 696d           all dim
-0004e040: 656e 7369 6f6e 7320 2d20 666f 7220 6e6f  ensions - for no
-0004e050: 7720 7265 7475 726e 696e 6720 616e 2069  w returning an i
-0004e060: 6e74 2066 6f72 2062 6163 6b77 6172 6420  nt for backward 
-0004e070: 636f 6d70 6174 6962 696c 6974 792c 2062  compatibility, b
-0004e080: 7574 0a20 2020 2020 2020 2020 2020 2074  ut.            t
-0004e090: 6869 7320 6973 2064 6570 7265 6361 7465  his is deprecate
-0004e0a0: 642c 2069 6e20 6675 7475 7265 2077 696c  d, in future wil
-0004e0b0: 6c20 6265 2061 6e20 6572 726f 722c 2073  l be an error, s
-0004e0c0: 696e 6365 2044 6174 6141 7272 6179 2e61  ince DataArray.a
-0004e0d0: 7267 6d69 6e20 7769 6c6c 0a20 2020 2020  rgmin will.     
-0004e0e0: 2020 2020 2020 2072 6574 7572 6e20 6120         return a 
-0004e0f0: 6469 6374 2077 6974 6820 696e 6469 6365  dict with indice
-0004e100: 7320 666f 7220 616c 6c20 6469 6d65 6e73  s for all dimens
-0004e110: 696f 6e73 2c20 7768 6963 6820 646f 6573  ions, which does
-0004e120: 206e 6f74 206d 616b 6520 7365 6e73 6520   not make sense 
-0004e130: 666f 720a 2020 2020 2020 2020 2020 2020  for.            
-0004e140: 6120 4461 7461 7365 742e 0a20 2020 2020  a Dataset..     
-0004e150: 2020 206b 6565 705f 6174 7472 7320 3a20     keep_attrs : 
-0004e160: 626f 6f6c 2c20 6f70 7469 6f6e 616c 0a20  bool, optional. 
-0004e170: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
-0004e180: 7565 2c20 7468 6520 6174 7472 6962 7574  ue, the attribut
-0004e190: 6573 2028 6061 7474 7273 6029 2077 696c  es (`attrs`) wil
-0004e1a0: 6c20 6265 2063 6f70 6965 6420 6672 6f6d  l be copied from
-0004e1b0: 2074 6865 206f 7269 6769 6e61 6c0a 2020   the original.  
-0004e1c0: 2020 2020 2020 2020 2020 6f62 6a65 6374            object
-0004e1d0: 2074 6f20 7468 6520 6e65 7720 6f6e 652e   to the new one.
-0004e1e0: 2020 4966 2046 616c 7365 2028 6465 6661    If False (defa
-0004e1f0: 756c 7429 2c20 7468 6520 6e65 7720 6f62  ult), the new ob
-0004e200: 6a65 6374 2077 696c 6c20 6265 0a20 2020  ject will be.   
-0004e210: 2020 2020 2020 2020 2072 6574 7572 6e65           returne
-0004e220: 6420 7769 7468 6f75 7420 6174 7472 6962  d without attrib
-0004e230: 7574 6573 2e0a 2020 2020 2020 2020 736b  utes..        sk
-0004e240: 6970 6e61 203a 2062 6f6f 6c2c 206f 7074  ipna : bool, opt
-0004e250: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
-0004e260: 2020 4966 2054 7275 652c 2073 6b69 7020    If True, skip 
-0004e270: 6d69 7373 696e 6720 7661 6c75 6573 2028  missing values (
-0004e280: 6173 206d 6172 6b65 6420 6279 204e 614e  as marked by NaN
-0004e290: 292e 2042 7920 6465 6661 756c 742c 206f  ). By default, o
-0004e2a0: 6e6c 790a 2020 2020 2020 2020 2020 2020  nly.            
-0004e2b0: 736b 6970 7320 6d69 7373 696e 6720 7661  skips missing va
-0004e2c0: 6c75 6573 2066 6f72 2066 6c6f 6174 2064  lues for float d
-0004e2d0: 7479 7065 733b 206f 7468 6572 2064 7479  types; other dty
-0004e2e0: 7065 7320 6569 7468 6572 2064 6f20 6e6f  pes either do no
-0004e2f0: 740a 2020 2020 2020 2020 2020 2020 6861  t.            ha
-0004e300: 7665 2061 2073 656e 7469 6e65 6c20 6d69  ve a sentinel mi
-0004e310: 7373 696e 6720 7661 6c75 6520 2869 6e74  ssing value (int
-0004e320: 2920 6f72 2073 6b69 706e 613d 5472 7565  ) or skipna=True
-0004e330: 2068 6173 206e 6f74 2062 6565 6e0a 2020   has not been.  
-0004e340: 2020 2020 2020 2020 2020 696d 706c 656d            implem
-0004e350: 656e 7465 6420 286f 626a 6563 742c 2064  ented (object, d
-0004e360: 6174 6574 696d 6536 3420 6f72 2074 696d  atetime64 or tim
-0004e370: 6564 656c 7461 3634 292e 0a0a 2020 2020  edelta64)...    
-0004e380: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
-0004e390: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
-0004e3a0: 2020 2020 7265 7375 6c74 203a 2044 6174      result : Dat
-0004e3b0: 6173 6574 0a0a 2020 2020 2020 2020 5365  aset..        Se
-0004e3c0: 6520 416c 736f 0a20 2020 2020 2020 202d  e Also.        -
-0004e3d0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
-0004e3e0: 4461 7461 4172 7261 792e 6172 676d 696e  DataArray.argmin
-0004e3f0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0004e400: 2020 2020 2069 6620 6469 6d20 6973 204e       if dim is N
-0004e410: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0004e420: 2077 6172 6e69 6e67 732e 7761 726e 280a   warnings.warn(.
-0004e430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0004e440: 224f 6e63 6520 7468 6520 6265 6861 7669  "Once the behavi
-0004e450: 6f75 7220 6f66 2044 6174 6141 7272 6179  our of DataArray
-0004e460: 2e61 7267 6d69 6e28 2920 616e 6420 5661  .argmin() and Va
-0004e470: 7269 6162 6c65 2e61 7267 6d69 6e28 2920  riable.argmin() 
-0004e480: 7769 7468 6f75 7420 220a 2020 2020 2020  without ".      
-0004e490: 2020 2020 2020 2020 2020 2264 696d 2063            "dim c
-0004e4a0: 6861 6e67 6573 2074 6f20 7265 7475 726e  hanges to return
-0004e4b0: 2061 2064 6963 7420 6f66 2069 6e64 6963   a dict of indic
-0004e4c0: 6573 206f 6620 6561 6368 2064 696d 656e  es of each dimen
-0004e4d0: 7369 6f6e 2c20 666f 7220 220a 2020 2020  sion, for ".    
-0004e4e0: 2020 2020 2020 2020 2020 2020 2263 6f6e              "con
-0004e4f0: 7369 7374 656e 6379 2069 7420 7769 6c6c  sistency it will
-0004e500: 2062 6520 616e 2065 7272 6f72 2074 6f20   be an error to 
-0004e510: 6361 6c6c 2044 6174 6173 6574 2e61 7267  call Dataset.arg
-0004e520: 6d69 6e28 2920 7769 7468 206e 6f20 6172  min() with no ar
-0004e530: 6775 6d65 6e74 2c22 0a20 2020 2020 2020  gument,".       
-0004e540: 2020 2020 2020 2020 2022 7369 6e63 6520           "since 
-0004e550: 7765 2064 6f6e 2774 2072 6574 7572 6e20  we don't return 
-0004e560: 6120 6469 6374 206f 6620 4461 7461 7365  a dict of Datase
-0004e570: 7473 2e22 2c0a 2020 2020 2020 2020 2020  ts.",.          
-0004e580: 2020 2020 2020 4465 7072 6563 6174 696f        Deprecatio
-0004e590: 6e57 6172 6e69 6e67 2c0a 2020 2020 2020  nWarning,.      
-0004e5a0: 2020 2020 2020 2020 2020 7374 6163 6b6c            stackl
-0004e5b0: 6576 656c 3d32 2c0a 2020 2020 2020 2020  evel=2,.        
-0004e5c0: 2020 2020 290a 2020 2020 2020 2020 6966      ).        if
-0004e5d0: 2028 0a20 2020 2020 2020 2020 2020 2064   (.            d
-0004e5e0: 696d 2069 7320 4e6f 6e65 0a20 2020 2020  im is None.     
-0004e5f0: 2020 2020 2020 206f 7220 286e 6f74 2069         or (not i
-0004e600: 7369 6e73 7461 6e63 6528 6469 6d2c 2053  sinstance(dim, S
-0004e610: 6571 7565 6e63 6529 2061 6e64 2064 696d  equence) and dim
-0004e620: 2069 7320 6e6f 7420 2e2e 2e29 0a20 2020   is not ...).   
-0004e630: 2020 2020 2020 2020 206f 7220 6973 696e           or isin
-0004e640: 7374 616e 6365 2864 696d 2c20 7374 7229  stance(dim, str)
-0004e650: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-0004e660: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
-0004e670: 2069 6e74 2069 6e64 6578 2069 6620 7369   int index if si
-0004e680: 6e67 6c65 2064 696d 656e 7369 6f6e 2069  ngle dimension i
-0004e690: 7320 7061 7373 6564 2c20 616e 6420 6973  s passed, and is
-0004e6a0: 206e 6f74 2070 6172 7420 6f66 2061 0a20   not part of a. 
-0004e6b0: 2020 2020 2020 2020 2020 2023 2073 6571             # seq
-0004e6c0: 7565 6e63 650a 2020 2020 2020 2020 2020  uence.          
-0004e6d0: 2020 6172 676d 696e 5f66 756e 6320 3d20    argmin_func = 
-0004e6e0: 6765 7461 7474 7228 6475 636b 5f61 7272  getattr(duck_arr
-0004e6f0: 6179 5f6f 7073 2c20 2261 7267 6d69 6e22  ay_ops, "argmin"
-0004e700: 290a 2020 2020 2020 2020 2020 2020 7265  ).            re
-0004e710: 7475 726e 2073 656c 662e 7265 6475 6365  turn self.reduce
-0004e720: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0004e730: 2020 6172 676d 696e 5f66 756e 632c 2064    argmin_func, d
-0004e740: 696d 3d4e 6f6e 6520 6966 2064 696d 2069  im=None if dim i
-0004e750: 7320 4e6f 6e65 2065 6c73 6520 5b64 696d  s None else [dim
-0004e760: 5d2c 202a 2a6b 7761 7267 730a 2020 2020  ], **kwargs.    
-0004e770: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0004e780: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
-0004e790: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-0004e7a0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-0004e7b0: 2020 2020 2020 2257 6865 6e20 6469 6d20        "When dim 
-0004e7c0: 6973 2061 2073 6571 7565 6e63 6520 6f72  is a sequence or
-0004e7d0: 202e 2e2e 2c20 4461 7461 4172 7261 792e   ..., DataArray.
-0004e7e0: 6172 676d 696e 2829 2072 6574 7572 6e73  argmin() returns
-0004e7f0: 2061 2064 6963 742e 2022 0a20 2020 2020   a dict. ".     
-0004e800: 2020 2020 2020 2020 2020 2022 6469 6374             "dict
-0004e810: 7320 6361 6e6e 6f74 2062 6520 636f 6e74  s cannot be cont
-0004e820: 6169 6e65 6420 696e 2061 2044 6174 6173  ained in a Datas
-0004e830: 6574 2c20 736f 2063 616e 6e6f 7420 6361  et, so cannot ca
-0004e840: 6c6c 2022 0a20 2020 2020 2020 2020 2020  ll ".           
-0004e850: 2020 2020 2022 4461 7461 7365 742e 6172       "Dataset.ar
-0004e860: 676d 696e 2829 2077 6974 6820 6120 7365  gmin() with a se
-0004e870: 7175 656e 6365 206f 7220 2e2e 2e20 666f  quence or ... fo
-0004e880: 7220 6469 6d22 0a20 2020 2020 2020 2020  r dim".         
-0004e890: 2020 2029 0a0a 2020 2020 6465 6620 6172     )..    def ar
-0004e8a0: 676d 6178 2873 656c 663a 2054 5f44 6174  gmax(self: T_Dat
-0004e8b0: 6173 6574 2c20 6469 6d3a 2048 6173 6861  aset, dim: Hasha
-0004e8c0: 626c 6520 7c20 4e6f 6e65 203d 204e 6f6e  ble | None = Non
-0004e8d0: 652c 202a 2a6b 7761 7267 7329 202d 3e20  e, **kwargs) -> 
-0004e8e0: 545f 4461 7461 7365 743a 0a20 2020 2020  T_Dataset:.     
-0004e8f0: 2020 2022 2222 496e 6469 6365 7320 6f66     """Indices of
-0004e900: 2074 6865 206d 6178 696d 6120 6f66 2074   the maxima of t
-0004e910: 6865 206d 656d 6265 7220 7661 7269 6162  he member variab
-0004e920: 6c65 732e 0a0a 2020 2020 2020 2020 4966  les...        If
-0004e930: 2074 6865 7265 2061 7265 206d 756c 7469   there are multi
-0004e940: 706c 6520 6d61 7869 6d61 2c20 7468 6520  ple maxima, the 
-0004e950: 696e 6469 6365 7320 6f66 2074 6865 2066  indices of the f
-0004e960: 6972 7374 206f 6e65 2066 6f75 6e64 2077  irst one found w
-0004e970: 696c 6c20 6265 0a20 2020 2020 2020 2072  ill be.        r
-0004e980: 6574 7572 6e65 642e 0a0a 2020 2020 2020  eturned...      
-0004e990: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-0004e9a0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
-0004e9b0: 2020 2020 2020 2020 6469 6d20 3a20 7374          dim : st
-0004e9c0: 722c 206f 7074 696f 6e61 6c0a 2020 2020  r, optional.    
-0004e9d0: 2020 2020 2020 2020 5468 6520 6469 6d65          The dime
-0004e9e0: 6e73 696f 6e20 6f76 6572 2077 6869 6368  nsion over which
-0004e9f0: 2074 6f20 6669 6e64 2074 6865 206d 6178   to find the max
-0004ea00: 696d 756d 2e20 4279 2064 6566 6175 6c74  imum. By default
-0004ea10: 2c20 6669 6e64 7320 6d61 7869 6d75 6d20  , finds maximum 
-0004ea20: 6f76 6572 0a20 2020 2020 2020 2020 2020  over.           
-0004ea30: 2061 6c6c 2064 696d 656e 7369 6f6e 7320   all dimensions 
-0004ea40: 2d20 666f 7220 6e6f 7720 7265 7475 726e  - for now return
-0004ea50: 696e 6720 616e 2069 6e74 2066 6f72 2062  ing an int for b
-0004ea60: 6163 6b77 6172 6420 636f 6d70 6174 6962  ackward compatib
-0004ea70: 696c 6974 792c 2062 7574 0a20 2020 2020  ility, but.     
-0004ea80: 2020 2020 2020 2074 6869 7320 6973 2064         this is d
-0004ea90: 6570 7265 6361 7465 642c 2069 6e20 6675  eprecated, in fu
-0004eaa0: 7475 7265 2077 696c 6c20 6265 2061 6e20  ture will be an 
-0004eab0: 6572 726f 722c 2073 696e 6365 2044 6174  error, since Dat
-0004eac0: 6141 7272 6179 2e61 7267 6d61 7820 7769  aArray.argmax wi
-0004ead0: 6c6c 0a20 2020 2020 2020 2020 2020 2072  ll.            r
-0004eae0: 6574 7572 6e20 6120 6469 6374 2077 6974  eturn a dict wit
-0004eaf0: 6820 696e 6469 6365 7320 666f 7220 616c  h indices for al
-0004eb00: 6c20 6469 6d65 6e73 696f 6e73 2c20 7768  l dimensions, wh
-0004eb10: 6963 6820 646f 6573 206e 6f74 206d 616b  ich does not mak
-0004eb20: 6520 7365 6e73 6520 666f 720a 2020 2020  e sense for.    
-0004eb30: 2020 2020 2020 2020 6120 4461 7461 7365          a Datase
-0004eb40: 742e 0a20 2020 2020 2020 206b 6565 705f  t..        keep_
-0004eb50: 6174 7472 7320 3a20 626f 6f6c 2c20 6f70  attrs : bool, op
-0004eb60: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-0004eb70: 2020 2049 6620 5472 7565 2c20 7468 6520     If True, the 
-0004eb80: 6174 7472 6962 7574 6573 2028 6061 7474  attributes (`att
-0004eb90: 7273 6029 2077 696c 6c20 6265 2063 6f70  rs`) will be cop
-0004eba0: 6965 6420 6672 6f6d 2074 6865 206f 7269  ied from the ori
-0004ebb0: 6769 6e61 6c0a 2020 2020 2020 2020 2020  ginal.          
-0004ebc0: 2020 6f62 6a65 6374 2074 6f20 7468 6520    object to the 
-0004ebd0: 6e65 7720 6f6e 652e 2020 4966 2046 616c  new one.  If Fal
-0004ebe0: 7365 2028 6465 6661 756c 7429 2c20 7468  se (default), th
-0004ebf0: 6520 6e65 7720 6f62 6a65 6374 2077 696c  e new object wil
-0004ec00: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
-0004ec10: 2072 6574 7572 6e65 6420 7769 7468 6f75   returned withou
-0004ec20: 7420 6174 7472 6962 7574 6573 2e0a 2020  t attributes..  
-0004ec30: 2020 2020 2020 736b 6970 6e61 203a 2062        skipna : b
-0004ec40: 6f6f 6c2c 206f 7074 696f 6e61 6c0a 2020  ool, optional.  
-0004ec50: 2020 2020 2020 2020 2020 4966 2054 7275            If Tru
-0004ec60: 652c 2073 6b69 7020 6d69 7373 696e 6720  e, skip missing 
-0004ec70: 7661 6c75 6573 2028 6173 206d 6172 6b65  values (as marke
-0004ec80: 6420 6279 204e 614e 292e 2042 7920 6465  d by NaN). By de
-0004ec90: 6661 756c 742c 206f 6e6c 790a 2020 2020  fault, only.    
-0004eca0: 2020 2020 2020 2020 736b 6970 7320 6d69          skips mi
-0004ecb0: 7373 696e 6720 7661 6c75 6573 2066 6f72  ssing values for
-0004ecc0: 2066 6c6f 6174 2064 7479 7065 733b 206f   float dtypes; o
-0004ecd0: 7468 6572 2064 7479 7065 7320 6569 7468  ther dtypes eith
-0004ece0: 6572 2064 6f20 6e6f 740a 2020 2020 2020  er do not.      
-0004ecf0: 2020 2020 2020 6861 7665 2061 2073 656e        have a sen
-0004ed00: 7469 6e65 6c20 6d69 7373 696e 6720 7661  tinel missing va
-0004ed10: 6c75 6520 2869 6e74 2920 6f72 2073 6b69  lue (int) or ski
-0004ed20: 706e 613d 5472 7565 2068 6173 206e 6f74  pna=True has not
-0004ed30: 2062 6565 6e0a 2020 2020 2020 2020 2020   been.          
-0004ed40: 2020 696d 706c 656d 656e 7465 6420 286f    implemented (o
-0004ed50: 626a 6563 742c 2064 6174 6574 696d 6536  bject, datetime6
-0004ed60: 3420 6f72 2074 696d 6564 656c 7461 3634  4 or timedelta64
-0004ed70: 292e 0a0a 2020 2020 2020 2020 5265 7475  )...        Retu
-0004ed80: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-0004ed90: 2d2d 2d0a 2020 2020 2020 2020 7265 7375  ---.        resu
-0004eda0: 6c74 203a 2044 6174 6173 6574 0a0a 2020  lt : Dataset..  
-0004edb0: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
-0004edc0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
-0004edd0: 2020 2020 2020 2020 4461 7461 4172 7261          DataArra
-0004ede0: 792e 6172 676d 6178 0a0a 2020 2020 2020  y.argmax..      
-0004edf0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-0004ee00: 2064 696d 2069 7320 4e6f 6e65 3a0a 2020   dim is None:.  
-0004ee10: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
-0004ee20: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
-0004ee30: 2020 2020 2020 2020 2022 4f6e 6365 2074           "Once t
-0004ee40: 6865 2062 6568 6176 696f 7572 206f 6620  he behaviour of 
-0004ee50: 4461 7461 4172 7261 792e 6172 676d 696e  DataArray.argmin
-0004ee60: 2829 2061 6e64 2056 6172 6961 626c 652e  () and Variable.
-0004ee70: 6172 676d 696e 2829 2077 6974 686f 7574  argmin() without
-0004ee80: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-0004ee90: 2020 2022 6469 6d20 6368 616e 6765 7320     "dim changes 
-0004eea0: 746f 2072 6574 7572 6e20 6120 6469 6374  to return a dict
-0004eeb0: 206f 6620 696e 6469 6365 7320 6f66 2065   of indices of e
-0004eec0: 6163 6820 6469 6d65 6e73 696f 6e2c 2066  ach dimension, f
-0004eed0: 6f72 2022 0a20 2020 2020 2020 2020 2020  or ".           
-0004eee0: 2020 2020 2022 636f 6e73 6973 7465 6e63       "consistenc
-0004eef0: 7920 6974 2077 696c 6c20 6265 2061 6e20  y it will be an 
-0004ef00: 6572 726f 7220 746f 2063 616c 6c20 4461  error to call Da
-0004ef10: 7461 7365 742e 6172 676d 696e 2829 2077  taset.argmin() w
-0004ef20: 6974 6820 6e6f 2061 7267 756d 656e 742c  ith no argument,
-0004ef30: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0004ef40: 2020 2273 696e 6365 2077 6520 646f 6e27    "since we don'
-0004ef50: 7420 7265 7475 726e 2061 2064 6963 7420  t return a dict 
-0004ef60: 6f66 2044 6174 6173 6574 732e 222c 0a20  of Datasets.",. 
-0004ef70: 2020 2020 2020 2020 2020 2020 2020 2044                 D
-0004ef80: 6570 7265 6361 7469 6f6e 5761 726e 696e  eprecationWarnin
-0004ef90: 672c 0a20 2020 2020 2020 2020 2020 2020  g,.             
-0004efa0: 2020 2073 7461 636b 6c65 7665 6c3d 322c     stacklevel=2,
-0004efb0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0004efc0: 2020 2020 2020 2069 6620 280a 2020 2020         if (.    
-0004efd0: 2020 2020 2020 2020 6469 6d20 6973 204e          dim is N
-0004efe0: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
-0004eff0: 6f72 2028 6e6f 7420 6973 696e 7374 616e  or (not isinstan
-0004f000: 6365 2864 696d 2c20 5365 7175 656e 6365  ce(dim, Sequence
-0004f010: 2920 616e 6420 6469 6d20 6973 206e 6f74  ) and dim is not
-0004f020: 202e 2e2e 290a 2020 2020 2020 2020 2020   ...).          
-0004f030: 2020 6f72 2069 7369 6e73 7461 6e63 6528    or isinstance(
-0004f040: 6469 6d2c 2073 7472 290a 2020 2020 2020  dim, str).      
-0004f050: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-0004f060: 2023 2052 6574 7572 6e20 696e 7420 696e   # Return int in
-0004f070: 6465 7820 6966 2073 696e 676c 6520 6469  dex if single di
-0004f080: 6d65 6e73 696f 6e20 6973 2070 6173 7365  mension is passe
-0004f090: 642c 2061 6e64 2069 7320 6e6f 7420 7061  d, and is not pa
-0004f0a0: 7274 206f 6620 610a 2020 2020 2020 2020  rt of a.        
-0004f0b0: 2020 2020 2320 7365 7175 656e 6365 0a20      # sequence. 
-0004f0c0: 2020 2020 2020 2020 2020 2061 7267 6d61             argma
-0004f0d0: 785f 6675 6e63 203d 2067 6574 6174 7472  x_func = getattr
-0004f0e0: 2864 7563 6b5f 6172 7261 795f 6f70 732c  (duck_array_ops,
-0004f0f0: 2022 6172 676d 6178 2229 0a20 2020 2020   "argmax").     
-0004f100: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0004f110: 6c66 2e72 6564 7563 6528 0a20 2020 2020  lf.reduce(.     
-0004f120: 2020 2020 2020 2020 2020 2061 7267 6d61             argma
-0004f130: 785f 6675 6e63 2c20 6469 6d3d 4e6f 6e65  x_func, dim=None
-0004f140: 2069 6620 6469 6d20 6973 204e 6f6e 6520   if dim is None 
-0004f150: 656c 7365 205b 6469 6d5d 2c20 2a2a 6b77  else [dim], **kw
-0004f160: 6172 6773 0a20 2020 2020 2020 2020 2020  args.           
-0004f170: 2029 0a20 2020 2020 2020 2065 6c73 653a   ).        else:
-0004f180: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-0004f190: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
-0004f1a0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-0004f1b0: 5768 656e 2064 696d 2069 7320 6120 7365  When dim is a se
-0004f1c0: 7175 656e 6365 206f 7220 2e2e 2e2c 2044  quence or ..., D
-0004f1d0: 6174 6141 7272 6179 2e61 7267 6d69 6e28  ataArray.argmin(
-0004f1e0: 2920 7265 7475 726e 7320 6120 6469 6374  ) returns a dict
-0004f1f0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-0004f200: 2020 2020 2264 6963 7473 2063 616e 6e6f      "dicts canno
-0004f210: 7420 6265 2063 6f6e 7461 696e 6564 2069  t be contained i
-0004f220: 6e20 6120 4461 7461 7365 742c 2073 6f20  n a Dataset, so 
-0004f230: 6361 6e6e 6f74 2063 616c 6c20 220a 2020  cannot call ".  
-0004f240: 2020 2020 2020 2020 2020 2020 2020 2244                "D
-0004f250: 6174 6173 6574 2e61 7267 6d69 6e28 2920  ataset.argmin() 
-0004f260: 7769 7468 2061 2073 6571 7565 6e63 6520  with a sequence 
-0004f270: 6f72 202e 2e2e 2066 6f72 2064 696d 220a  or ... for dim".
-0004f280: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-0004f290: 2020 2064 6566 2071 7565 7279 280a 2020     def query(.  
-0004f2a0: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
-0004f2b0: 7461 7365 742c 0a20 2020 2020 2020 2071  taset,.        q
-0004f2c0: 7565 7269 6573 3a20 4d61 7070 696e 675b  ueries: Mapping[
-0004f2d0: 416e 792c 2041 6e79 5d20 7c20 4e6f 6e65  Any, Any] | None
-0004f2e0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0004f2f0: 2070 6172 7365 723a 2051 7565 7279 5061   parser: QueryPa
-0004f300: 7273 6572 4f70 7469 6f6e 7320 3d20 2270  rserOptions = "p
-0004f310: 616e 6461 7322 2c0a 2020 2020 2020 2020  andas",.        
-0004f320: 656e 6769 6e65 3a20 5175 6572 7945 6e67  engine: QueryEng
-0004f330: 696e 654f 7074 696f 6e73 203d 204e 6f6e  ineOptions = Non
-0004f340: 652c 0a20 2020 2020 2020 206d 6973 7369  e,.        missi
-0004f350: 6e67 5f64 696d 733a 2045 7272 6f72 4f70  ng_dims: ErrorOp
-0004f360: 7469 6f6e 7357 6974 6857 6172 6e20 3d20  tionsWithWarn = 
-0004f370: 2272 6169 7365 222c 0a20 2020 2020 2020  "raise",.       
-0004f380: 202a 2a71 7565 7269 6573 5f6b 7761 7267   **queries_kwarg
-0004f390: 733a 2041 6e79 2c0a 2020 2020 2920 2d3e  s: Any,.    ) ->
-0004f3a0: 2054 5f44 6174 6173 6574 3a0a 2020 2020   T_Dataset:.    
-0004f3b0: 2020 2020 2222 2252 6574 7572 6e20 6120      """Return a 
-0004f3c0: 6e65 7720 6461 7461 7365 7420 7769 7468  new dataset with
-0004f3d0: 2065 6163 6820 6172 7261 7920 696e 6465   each array inde
-0004f3e0: 7865 6420 616c 6f6e 6720 7468 6520 7370  xed along the sp
-0004f3f0: 6563 6966 6965 640a 2020 2020 2020 2020  ecified.        
-0004f400: 6469 6d65 6e73 696f 6e28 7329 2c20 7768  dimension(s), wh
-0004f410: 6572 6520 7468 6520 696e 6465 7865 7273  ere the indexers
-0004f420: 2061 7265 2067 6976 656e 2061 7320 7374   are given as st
-0004f430: 7269 6e67 7320 636f 6e74 6169 6e69 6e67  rings containing
-0004f440: 0a20 2020 2020 2020 2050 7974 686f 6e20  .        Python 
-0004f450: 6578 7072 6573 7369 6f6e 7320 746f 2062  expressions to b
-0004f460: 6520 6576 616c 7561 7465 6420 6167 6169  e evaluated agai
-0004f470: 6e73 7420 7468 6520 6461 7461 2076 6172  nst the data var
-0004f480: 6961 626c 6573 2069 6e20 7468 650a 2020  iables in the.  
-0004f490: 2020 2020 2020 6461 7461 7365 742e 0a0a        dataset...
-0004f4a0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0004f4b0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
-0004f4c0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7175  -----.        qu
-0004f4d0: 6572 6965 7320 3a20 6469 6374 2d6c 696b  eries : dict-lik
-0004f4e0: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
-0004f4f0: 2020 2020 2020 2020 4120 6469 6374 2d6c          A dict-l
-0004f500: 696b 6520 7769 7468 206b 6579 7320 6d61  ike with keys ma
-0004f510: 7463 6869 6e67 2064 696d 656e 7369 6f6e  tching dimension
-0004f520: 7320 616e 6420 7661 6c75 6573 2067 6976  s and values giv
-0004f530: 656e 2062 7920 7374 7269 6e67 730a 2020  en by strings.  
-0004f540: 2020 2020 2020 2020 2020 636f 6e74 6169            contai
-0004f550: 6e69 6e67 2050 7974 686f 6e20 6578 7072  ning Python expr
-0004f560: 6573 7369 6f6e 7320 746f 2062 6520 6576  essions to be ev
-0004f570: 616c 7561 7465 6420 6167 6169 6e73 7420  aluated against 
-0004f580: 7468 6520 6461 7461 2076 6172 6961 626c  the data variabl
-0004f590: 6573 0a20 2020 2020 2020 2020 2020 2069  es.            i
-0004f5a0: 6e20 7468 6520 6461 7461 7365 742e 2054  n the dataset. T
-0004f5b0: 6865 2065 7870 7265 7373 696f 6e73 2077  he expressions w
-0004f5c0: 696c 6c20 6265 2065 7661 6c75 6174 6564  ill be evaluated
-0004f5d0: 2075 7369 6e67 2074 6865 2070 616e 6461   using the panda
-0004f5e0: 730a 2020 2020 2020 2020 2020 2020 6576  s.            ev
-0004f5f0: 616c 2829 2066 756e 6374 696f 6e2c 2061  al() function, a
-0004f600: 6e64 2063 616e 2063 6f6e 7461 696e 2061  nd can contain a
-0004f610: 6e79 2076 616c 6964 2050 7974 686f 6e20  ny valid Python 
-0004f620: 6578 7072 6573 7369 6f6e 7320 6275 7420  expressions but 
-0004f630: 6361 6e6e 6f74 0a20 2020 2020 2020 2020  cannot.         
-0004f640: 2020 2063 6f6e 7461 696e 2061 6e79 2050     contain any P
-0004f650: 7974 686f 6e20 7374 6174 656d 656e 7473  ython statements
-0004f660: 2e0a 2020 2020 2020 2020 7061 7273 6572  ..        parser
-0004f670: 203a 207b 2270 616e 6461 7322 2c20 2270   : {"pandas", "p
-0004f680: 7974 686f 6e22 7d2c 2064 6566 6175 6c74  ython"}, default
-0004f690: 3a20 2270 616e 6461 7322 0a20 2020 2020  : "pandas".     
-0004f6a0: 2020 2020 2020 2054 6865 2070 6172 7365         The parse
-0004f6b0: 7220 746f 2075 7365 2074 6f20 636f 6e73  r to use to cons
-0004f6c0: 7472 7563 7420 7468 6520 7379 6e74 6178  truct the syntax
-0004f6d0: 2074 7265 6520 6672 6f6d 2074 6865 2065   tree from the e
-0004f6e0: 7870 7265 7373 696f 6e2e 0a20 2020 2020  xpression..     
-0004f6f0: 2020 2020 2020 2054 6865 2064 6566 6175         The defau
-0004f700: 6c74 206f 6620 2770 616e 6461 7327 2070  lt of 'pandas' p
-0004f710: 6172 7365 7320 636f 6465 2073 6c69 6768  arses code sligh
-0004f720: 746c 7920 6469 6666 6572 656e 7420 7468  tly different th
-0004f730: 616e 2073 7461 6e64 6172 640a 2020 2020  an standard.    
-0004f740: 2020 2020 2020 2020 5079 7468 6f6e 2e20          Python. 
-0004f750: 416c 7465 726e 6174 6976 656c 792c 2079  Alternatively, y
-0004f760: 6f75 2063 616e 2070 6172 7365 2061 6e20  ou can parse an 
-0004f770: 6578 7072 6573 7369 6f6e 2075 7369 6e67  expression using
-0004f780: 2074 6865 2027 7079 7468 6f6e 270a 2020   the 'python'.  
-0004f790: 2020 2020 2020 2020 2020 7061 7273 6572            parser
-0004f7a0: 2074 6f20 7265 7461 696e 2073 7472 6963   to retain stric
-0004f7b0: 7420 5079 7468 6f6e 2073 656d 616e 7469  t Python semanti
-0004f7c0: 6373 2e0a 2020 2020 2020 2020 656e 6769  cs..        engi
-0004f7d0: 6e65 203a 207b 2270 7974 686f 6e22 2c20  ne : {"python", 
-0004f7e0: 226e 756d 6578 7072 222c 204e 6f6e 657d  "numexpr", None}
-0004f7f0: 2c20 6465 6661 756c 743a 204e 6f6e 650a  , default: None.
-0004f800: 2020 2020 2020 2020 2020 2020 5468 6520              The 
-0004f810: 656e 6769 6e65 2075 7365 6420 746f 2065  engine used to e
-0004f820: 7661 6c75 6174 6520 7468 6520 6578 7072  valuate the expr
-0004f830: 6573 7369 6f6e 2e20 5375 7070 6f72 7465  ession. Supporte
-0004f840: 6420 656e 6769 6e65 7320 6172 653a 0a0a  d engines are:..
-0004f850: 2020 2020 2020 2020 2020 2020 2d20 4e6f              - No
-0004f860: 6e65 3a20 7472 6965 7320 746f 2075 7365  ne: tries to use
-0004f870: 206e 756d 6578 7072 2c20 6661 6c6c 7320   numexpr, falls 
-0004f880: 6261 636b 2074 6f20 7079 7468 6f6e 0a20  back to python. 
-0004f890: 2020 2020 2020 2020 2020 202d 2022 6e75             - "nu
-0004f8a0: 6d65 7870 7222 3a20 6576 616c 7561 7465  mexpr": evaluate
-0004f8b0: 7320 6578 7072 6573 7369 6f6e 7320 7573  s expressions us
-0004f8c0: 696e 6720 6e75 6d65 7870 720a 2020 2020  ing numexpr.    
-0004f8d0: 2020 2020 2020 2020 2d20 2270 7974 686f          - "pytho
-0004f8e0: 6e22 3a20 7065 7266 6f72 6d73 206f 7065  n": performs ope
-0004f8f0: 7261 7469 6f6e 7320 6173 2069 6620 796f  rations as if yo
-0004f900: 7520 6861 6420 6576 616c e280 9964 2069  u had eval...d i
-0004f910: 6e20 746f 7020 6c65 7665 6c20 7079 7468  n top level pyth
-0004f920: 6f6e 0a0a 2020 2020 2020 2020 6d69 7373  on..        miss
-0004f930: 696e 675f 6469 6d73 203a 207b 2272 6169  ing_dims : {"rai
-0004f940: 7365 222c 2022 7761 726e 222c 2022 6967  se", "warn", "ig
-0004f950: 6e6f 7265 227d 2c20 6465 6661 756c 743a  nore"}, default:
-0004f960: 2022 7261 6973 6522 0a20 2020 2020 2020   "raise".       
-0004f970: 2020 2020 2057 6861 7420 746f 2064 6f20       What to do 
-0004f980: 6966 2064 696d 656e 7369 6f6e 7320 7468  if dimensions th
-0004f990: 6174 2073 686f 756c 6420 6265 2073 656c  at should be sel
-0004f9a0: 6563 7465 6420 6672 6f6d 2061 7265 206e  ected from are n
-0004f9b0: 6f74 2070 7265 7365 6e74 2069 6e20 7468  ot present in th
-0004f9c0: 650a 2020 2020 2020 2020 2020 2020 4461  e.            Da
-0004f9d0: 7461 7365 743a 0a0a 2020 2020 2020 2020  taset:..        
-0004f9e0: 2020 2020 2d20 2272 6169 7365 223a 2072      - "raise": r
-0004f9f0: 6169 7365 2061 6e20 6578 6365 7074 696f  aise an exceptio
-0004fa00: 6e0a 2020 2020 2020 2020 2020 2020 2d20  n.            - 
-0004fa10: 2277 6172 6e22 3a20 7261 6973 6520 6120  "warn": raise a 
-0004fa20: 7761 726e 696e 672c 2061 6e64 2069 676e  warning, and ign
-0004fa30: 6f72 6520 7468 6520 6d69 7373 696e 6720  ore the missing 
-0004fa40: 6469 6d65 6e73 696f 6e73 0a20 2020 2020  dimensions.     
-0004fa50: 2020 2020 2020 202d 2022 6967 6e6f 7265         - "ignore
-0004fa60: 223a 2069 676e 6f72 6520 7468 6520 6d69  ": ignore the mi
-0004fa70: 7373 696e 6720 6469 6d65 6e73 696f 6e73  ssing dimensions
-0004fa80: 0a0a 2020 2020 2020 2020 2a2a 7175 6572  ..        **quer
-0004fa90: 6965 735f 6b77 6172 6773 203a 207b 6469  ies_kwargs : {di
-0004faa0: 6d3a 2071 7565 7279 2c20 2e2e 2e7d 2c20  m: query, ...}, 
-0004fab0: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
-0004fac0: 2020 2020 2054 6865 206b 6579 776f 7264       The keyword
-0004fad0: 2061 7267 756d 656e 7473 2066 6f72 6d20   arguments form 
-0004fae0: 6f66 2060 6071 7565 7269 6573 6060 2e0a  of ``queries``..
-0004faf0: 2020 2020 2020 2020 2020 2020 4f6e 6520              One 
-0004fb00: 6f66 2071 7565 7269 6573 206f 7220 7175  of queries or qu
-0004fb10: 6572 6965 735f 6b77 6172 6773 206d 7573  eries_kwargs mus
-0004fb20: 7420 6265 2070 726f 7669 6465 642e 0a0a  t be provided...
-0004fb30: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
-0004fb40: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
-0004fb50: 2020 2020 2020 2020 6f62 6a20 3a20 4461          obj : Da
-0004fb60: 7461 7365 740a 2020 2020 2020 2020 2020  taset.          
-0004fb70: 2020 4120 6e65 7720 4461 7461 7365 7420    A new Dataset 
-0004fb80: 7769 7468 2074 6865 2073 616d 6520 636f  with the same co
-0004fb90: 6e74 656e 7473 2061 7320 7468 6973 2064  ntents as this d
-0004fba0: 6174 6173 6574 2c20 6578 6365 7074 2065  ataset, except e
-0004fbb0: 6163 680a 2020 2020 2020 2020 2020 2020  ach.            
-0004fbc0: 6172 7261 7920 616e 6420 6469 6d65 6e73  array and dimens
-0004fbd0: 696f 6e20 6973 2069 6e64 6578 6564 2062  ion is indexed b
-0004fbe0: 7920 7468 6520 7265 7375 6c74 7320 6f66  y the results of
-0004fbf0: 2074 6865 2061 7070 726f 7072 6961 7465   the appropriate
-0004fc00: 0a20 2020 2020 2020 2020 2020 2071 7565  .            que
-0004fc10: 7269 6573 2e0a 0a20 2020 2020 2020 2053  ries...        S
-0004fc20: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
-0004fc30: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-0004fc40: 2044 6174 6173 6574 2e69 7365 6c0a 2020   Dataset.isel.  
-0004fc50: 2020 2020 2020 7061 6e64 6173 2e65 7661        pandas.eva
-0004fc60: 6c0a 0a20 2020 2020 2020 2045 7861 6d70  l..        Examp
-0004fc70: 6c65 730a 2020 2020 2020 2020 2d2d 2d2d  les.        ----
-0004fc80: 2d2d 2d2d 0a20 2020 2020 2020 203e 3e3e  ----.        >>>
-0004fc90: 2061 203d 206e 702e 6172 616e 6765 2830   a = np.arange(0
-0004fca0: 2c20 352c 2031 290a 2020 2020 2020 2020  , 5, 1).        
-0004fcb0: 3e3e 3e20 6220 3d20 6e70 2e6c 696e 7370  >>> b = np.linsp
-0004fcc0: 6163 6528 302c 2031 2c20 3529 0a20 2020  ace(0, 1, 5).   
-0004fcd0: 2020 2020 203e 3e3e 2064 7320 3d20 7872       >>> ds = xr
-0004fce0: 2e44 6174 6173 6574 287b 2261 223a 2028  .Dataset({"a": (
-0004fcf0: 2278 222c 2061 292c 2022 6222 3a20 2822  "x", a), "b": ("
-0004fd00: 7822 2c20 6229 7d29 0a20 2020 2020 2020  x", b)}).       
-0004fd10: 203e 3e3e 2064 730a 2020 2020 2020 2020   >>> ds.        
-0004fd20: 3c78 6172 7261 792e 4461 7461 7365 743e  <xarray.Dataset>
-0004fd30: 0a20 2020 2020 2020 2044 696d 656e 7369  .        Dimensi
-0004fd40: 6f6e 733a 2020 2878 3a20 3529 0a20 2020  ons:  (x: 5).   
-0004fd50: 2020 2020 2044 696d 656e 7369 6f6e 7320       Dimensions 
-0004fd60: 7769 7468 6f75 7420 636f 6f72 6469 6e61  without coordina
-0004fd70: 7465 733a 2078 0a20 2020 2020 2020 2044  tes: x.        D
-0004fd80: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
-0004fd90: 2020 2020 2020 2020 2020 2061 2020 2020             a    
-0004fda0: 2020 2020 2878 2920 696e 7436 3420 3020      (x) int64 0 
-0004fdb0: 3120 3220 3320 340a 2020 2020 2020 2020  1 2 3 4.        
-0004fdc0: 2020 2020 6220 2020 2020 2020 2028 7829      b        (x)
-0004fdd0: 2066 6c6f 6174 3634 2030 2e30 2030 2e32   float64 0.0 0.2
-0004fde0: 3520 302e 3520 302e 3735 2031 2e30 0a20  5 0.5 0.75 1.0. 
-0004fdf0: 2020 2020 2020 203e 3e3e 2064 732e 7175         >>> ds.qu
-0004fe00: 6572 7928 783d 2261 203e 2032 2229 0a20  ery(x="a > 2"). 
-0004fe10: 2020 2020 2020 203c 7861 7272 6179 2e44         <xarray.D
-0004fe20: 6174 6173 6574 3e0a 2020 2020 2020 2020  ataset>.        
-0004fe30: 4469 6d65 6e73 696f 6e73 3a20 2028 783a  Dimensions:  (x:
-0004fe40: 2032 290a 2020 2020 2020 2020 4469 6d65   2).        Dime
-0004fe50: 6e73 696f 6e73 2077 6974 686f 7574 2063  nsions without c
-0004fe60: 6f6f 7264 696e 6174 6573 3a20 780a 2020  oordinates: x.  
-0004fe70: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
-0004fe80: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
-0004fe90: 2020 6120 2020 2020 2020 2028 7829 2069    a        (x) i
-0004fea0: 6e74 3634 2033 2034 0a20 2020 2020 2020  nt64 3 4.       
-0004feb0: 2020 2020 2062 2020 2020 2020 2020 2878       b        (x
-0004fec0: 2920 666c 6f61 7436 3420 302e 3735 2031  ) float64 0.75 1
-0004fed0: 2e30 0a20 2020 2020 2020 2022 2222 0a0a  .0.        """..
-0004fee0: 2020 2020 2020 2020 2320 616c 6c6f 7720          # allow 
-0004fef0: 7175 6572 6965 7320 746f 2062 6520 6769  queries to be gi
-0004ff00: 7665 6e20 6569 7468 6572 2061 7320 6120  ven either as a 
-0004ff10: 6469 6374 206f 7220 6173 206b 7761 7267  dict or as kwarg
-0004ff20: 730a 2020 2020 2020 2020 7175 6572 6965  s.        querie
-0004ff30: 7320 3d20 6569 7468 6572 5f64 6963 745f  s = either_dict_
-0004ff40: 6f72 5f6b 7761 7267 7328 7175 6572 6965  or_kwargs(querie
-0004ff50: 732c 2071 7565 7269 6573 5f6b 7761 7267  s, queries_kwarg
-0004ff60: 732c 2022 7175 6572 7922 290a 0a20 2020  s, "query")..   
-0004ff70: 2020 2020 2023 2063 6865 636b 2071 7565       # check que
-0004ff80: 7269 6573 0a20 2020 2020 2020 2066 6f72  ries.        for
-0004ff90: 2064 696d 2c20 6578 7072 2069 6e20 7175   dim, expr in qu
-0004ffa0: 6572 6965 732e 6974 656d 7328 293a 0a20  eries.items():. 
-0004ffb0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0004ffc0: 7420 6973 696e 7374 616e 6365 2865 7870  t isinstance(exp
-0004ffd0: 722c 2073 7472 293a 0a20 2020 2020 2020  r, str):.       
-0004ffe0: 2020 2020 2020 2020 206d 7367 203d 2066           msg = f
-0004fff0: 2265 7870 7220 666f 7220 6469 6d20 7b64  "expr for dim {d
-00050000: 696d 7d20 6d75 7374 2062 6520 6120 7374  im} must be a st
-00050010: 7269 6e67 2074 6f20 6265 2065 7661 6c75  ring to be evalu
-00050020: 6174 6564 2c20 7b74 7970 6528 6578 7072  ated, {type(expr
-00050030: 297d 2067 6976 656e 220a 2020 2020 2020  )} given".      
-00050040: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00050050: 5661 6c75 6545 7272 6f72 286d 7367 290a  ValueError(msg).
-00050060: 0a20 2020 2020 2020 2023 2065 7661 6c75  .        # evalu
-00050070: 6174 6520 7468 6520 7175 6572 6965 7320  ate the queries 
-00050080: 746f 2063 7265 6174 6520 7468 6520 696e  to create the in
-00050090: 6465 7865 7273 0a20 2020 2020 2020 2069  dexers.        i
-000500a0: 6e64 6578 6572 7320 3d20 7b0a 2020 2020  ndexers = {.    
-000500b0: 2020 2020 2020 2020 6469 6d3a 2070 642e          dim: pd.
-000500c0: 6576 616c 2865 7870 722c 2072 6573 6f6c  eval(expr, resol
-000500d0: 7665 7273 3d5b 7365 6c66 5d2c 2070 6172  vers=[self], par
-000500e0: 7365 723d 7061 7273 6572 2c20 656e 6769  ser=parser, engi
-000500f0: 6e65 3d65 6e67 696e 6529 0a20 2020 2020  ne=engine).     
-00050100: 2020 2020 2020 2066 6f72 2064 696d 2c20         for dim, 
-00050110: 6578 7072 2069 6e20 7175 6572 6965 732e  expr in queries.
-00050120: 6974 656d 7328 290a 2020 2020 2020 2020  items().        
-00050130: 7d0a 0a20 2020 2020 2020 2023 2061 7070  }..        # app
-00050140: 6c79 2074 6865 2073 656c 6563 7469 6f6e  ly the selection
-00050150: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00050160: 7365 6c66 2e69 7365 6c28 696e 6465 7865  self.isel(indexe
-00050170: 7273 2c20 6d69 7373 696e 675f 6469 6d73  rs, missing_dims
-00050180: 3d6d 6973 7369 6e67 5f64 696d 7329 0a0a  =missing_dims)..
-00050190: 2020 2020 6465 6620 6375 7276 6566 6974      def curvefit
-000501a0: 280a 2020 2020 2020 2020 7365 6c66 3a20  (.        self: 
-000501b0: 545f 4461 7461 7365 742c 0a20 2020 2020  T_Dataset,.     
-000501c0: 2020 2063 6f6f 7264 733a 2073 7472 207c     coords: str |
-000501d0: 2044 6174 6141 7272 6179 207c 2049 7465   DataArray | Ite
-000501e0: 7261 626c 655b 7374 7220 7c20 4461 7461  rable[str | Data
-000501f0: 4172 7261 795d 2c0a 2020 2020 2020 2020  Array],.        
-00050200: 6675 6e63 3a20 4361 6c6c 6162 6c65 5b2e  func: Callable[.
-00050210: 2e2e 2c20 416e 795d 2c0a 2020 2020 2020  .., Any],.      
-00050220: 2020 7265 6475 6365 5f64 696d 733a 2044    reduce_dims: D
-00050230: 696d 7320 3d20 4e6f 6e65 2c0a 2020 2020  ims = None,.    
-00050240: 2020 2020 736b 6970 6e61 3a20 626f 6f6c      skipna: bool
-00050250: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-00050260: 2070 303a 2064 6963 745b 7374 722c 2041   p0: dict[str, A
-00050270: 6e79 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ny] | None = Non
-00050280: 652c 0a20 2020 2020 2020 2062 6f75 6e64  e,.        bound
-00050290: 733a 2064 6963 745b 7374 722c 2041 6e79  s: dict[str, Any
-000502a0: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-000502b0: 0a20 2020 2020 2020 2070 6172 616d 5f6e  .        param_n
-000502c0: 616d 6573 3a20 5365 7175 656e 6365 5b73  ames: Sequence[s
-000502d0: 7472 5d20 7c20 4e6f 6e65 203d 204e 6f6e  tr] | None = Non
-000502e0: 652c 0a20 2020 2020 2020 206b 7761 7267  e,.        kwarg
-000502f0: 733a 2064 6963 745b 7374 722c 2041 6e79  s: dict[str, Any
-00050300: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
-00050310: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
-00050320: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
-00050330: 0a20 2020 2020 2020 2043 7572 7665 2066  .        Curve f
-00050340: 6974 7469 6e67 206f 7074 696d 697a 6174  itting optimizat
-00050350: 696f 6e20 666f 7220 6172 6269 7472 6172  ion for arbitrar
-00050360: 7920 6675 6e63 7469 6f6e 732e 0a0a 2020  y functions...  
-00050370: 2020 2020 2020 5772 6170 7320 6073 6369        Wraps `sci
-00050380: 7079 2e6f 7074 696d 697a 652e 6375 7276  py.optimize.curv
-00050390: 655f 6669 7460 2077 6974 6820 6061 7070  e_fit` with `app
-000503a0: 6c79 5f75 6675 6e63 602e 0a0a 2020 2020  ly_ufunc`...    
-000503b0: 2020 2020 5061 7261 6d65 7465 7273 0a20      Parameters. 
-000503c0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-000503d0: 2d0a 2020 2020 2020 2020 636f 6f72 6473  -.        coords
-000503e0: 203a 2068 6173 6861 626c 652c 2044 6174   : hashable, Dat
-000503f0: 6141 7272 6179 2c20 6f72 2073 6571 7565  aArray, or seque
-00050400: 6e63 6520 6f66 2068 6173 6861 626c 6520  nce of hashable 
-00050410: 6f72 2044 6174 6141 7272 6179 0a20 2020  or DataArray.   
-00050420: 2020 2020 2020 2020 2049 6e64 6570 656e           Indepen
-00050430: 6465 6e74 2063 6f6f 7264 696e 6174 6528  dent coordinate(
-00050440: 7329 206f 7665 7220 7768 6963 6820 746f  s) over which to
-00050450: 2070 6572 666f 726d 2074 6865 2063 7572   perform the cur
-00050460: 7665 2066 6974 7469 6e67 2e20 4d75 7374  ve fitting. Must
-00050470: 2073 6861 7265 0a20 2020 2020 2020 2020   share.         
-00050480: 2020 2061 7420 6c65 6173 7420 6f6e 6520     at least one 
-00050490: 6469 6d65 6e73 696f 6e20 7769 7468 2074  dimension with t
-000504a0: 6865 2063 616c 6c69 6e67 206f 626a 6563  he calling objec
-000504b0: 742e 2057 6865 6e20 6669 7474 696e 6720  t. When fitting 
-000504c0: 6d75 6c74 692d 6469 6d65 6e73 696f 6e61  multi-dimensiona
-000504d0: 6c0a 2020 2020 2020 2020 2020 2020 6675  l.            fu
-000504e0: 6e63 7469 6f6e 732c 2073 7570 706c 7920  nctions, supply 
-000504f0: 6063 6f6f 7264 7360 2061 7320 6120 7365  `coords` as a se
-00050500: 7175 656e 6365 2069 6e20 7468 6520 7361  quence in the sa
-00050510: 6d65 206f 7264 6572 2061 7320 6172 6775  me order as argu
-00050520: 6d65 6e74 7320 696e 0a20 2020 2020 2020  ments in.       
-00050530: 2020 2020 2060 6675 6e63 602e 2054 6f20       `func`. To 
-00050540: 6669 7420 616c 6f6e 6720 6578 6973 7469  fit along existi
-00050550: 6e67 2064 696d 656e 7369 6f6e 7320 6f66  ng dimensions of
-00050560: 2074 6865 2063 616c 6c69 6e67 206f 626a   the calling obj
-00050570: 6563 742c 2060 636f 6f72 6473 6020 6361  ect, `coords` ca
-00050580: 6e0a 2020 2020 2020 2020 2020 2020 616c  n.            al
-00050590: 736f 2062 6520 7370 6563 6966 6965 6420  so be specified 
-000505a0: 6173 2061 2073 7472 206f 7220 7365 7175  as a str or sequ
-000505b0: 656e 6365 206f 6620 7374 7273 2e0a 2020  ence of strs..  
-000505c0: 2020 2020 2020 6675 6e63 203a 2063 616c        func : cal
-000505d0: 6c61 626c 650a 2020 2020 2020 2020 2020  lable.          
-000505e0: 2020 5573 6572 2073 7065 6369 6669 6564    User specified
-000505f0: 2066 756e 6374 696f 6e20 696e 2074 6865   function in the
-00050600: 2066 6f72 6d20 6066 2878 2c20 2a70 6172   form `f(x, *par
-00050610: 616d 7329 6020 7768 6963 6820 7265 7475  ams)` which retu
-00050620: 726e 7320 6120 6e75 6d70 790a 2020 2020  rns a numpy.    
-00050630: 2020 2020 2020 2020 6172 7261 7920 6f66          array of
-00050640: 206c 656e 6774 6820 606c 656e 2878 2960   length `len(x)`
-00050650: 2e20 6070 6172 616d 7360 2061 7265 2074  . `params` are t
-00050660: 6865 2066 6974 7461 626c 6520 7061 7261  he fittable para
-00050670: 6d65 7465 7273 2077 6869 6368 2061 7265  meters which are
-00050680: 206f 7074 696d 697a 6564 0a20 2020 2020   optimized.     
-00050690: 2020 2020 2020 2062 7920 7363 6970 7920         by scipy 
-000506a0: 6375 7276 655f 6669 742e 2060 7860 2063  curve_fit. `x` c
-000506b0: 616e 2061 6c73 6f20 6265 2073 7065 6369  an also be speci
-000506c0: 6669 6564 2061 7320 6120 7365 7175 656e  fied as a sequen
-000506d0: 6365 2063 6f6e 7461 696e 696e 6720 6d75  ce containing mu
-000506e0: 6c74 6970 6c65 0a20 2020 2020 2020 2020  ltiple.         
-000506f0: 2020 2063 6f6f 7264 696e 6174 6573 2c20     coordinates, 
-00050700: 652e 672e 2060 6628 2878 302c 2078 3129  e.g. `f((x0, x1)
-00050710: 2c20 2a70 6172 616d 7329 602e 0a20 2020  , *params)`..   
-00050720: 2020 2020 2072 6564 7563 655f 6469 6d73       reduce_dims
-00050730: 203a 2073 7472 2c20 4974 6572 6162 6c65   : str, Iterable
-00050740: 206f 6620 4861 7368 6162 6c65 206f 7220   of Hashable or 
-00050750: 4e6f 6e65 2c20 6f70 7469 6f6e 616c 0a20  None, optional. 
-00050760: 2020 2020 2020 2020 2020 2041 6464 6974             Addit
-00050770: 696f 6e61 6c20 6469 6d65 6e73 696f 6e28  ional dimension(
-00050780: 7329 206f 7665 7220 7768 6963 6820 746f  s) over which to
-00050790: 2061 6767 7265 6761 7465 2077 6869 6c65   aggregate while
-000507a0: 2066 6974 7469 6e67 2e20 466f 7220 6578   fitting. For ex
-000507b0: 616d 706c 652c 0a20 2020 2020 2020 2020  ample,.         
-000507c0: 2020 2063 616c 6c69 6e67 2060 6473 2e63     calling `ds.c
-000507d0: 7572 7665 6669 7428 636f 6f72 6473 3d27  urvefit(coords='
-000507e0: 7469 6d65 272c 2072 6564 7563 655f 6469  time', reduce_di
-000507f0: 6d73 3d5b 276c 6174 272c 2027 6c6f 6e27  ms=['lat', 'lon'
-00050800: 5d2c 202e 2e2e 2960 2077 696c 6c0a 2020  ], ...)` will.  
-00050810: 2020 2020 2020 2020 2020 6167 6772 6567            aggreg
-00050820: 6174 6520 616c 6c20 6c61 7420 616e 6420  ate all lat and 
-00050830: 6c6f 6e20 706f 696e 7473 2061 6e64 2066  lon points and f
-00050840: 6974 2074 6865 2073 7065 6369 6669 6564  it the specified
-00050850: 2066 756e 6374 696f 6e20 616c 6f6e 6720   function along 
-00050860: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00050870: 7469 6d65 2064 696d 656e 7369 6f6e 2e0a  time dimension..
-00050880: 2020 2020 2020 2020 736b 6970 6e61 203a          skipna :
-00050890: 2062 6f6f 6c2c 2064 6566 6175 6c74 3a20   bool, default: 
-000508a0: 5472 7565 0a20 2020 2020 2020 2020 2020  True.           
-000508b0: 2057 6865 7468 6572 2074 6f20 736b 6970   Whether to skip
-000508c0: 206d 6973 7369 6e67 2076 616c 7565 7320   missing values 
-000508d0: 7768 656e 2066 6974 7469 6e67 2e20 4465  when fitting. De
-000508e0: 6661 756c 7420 6973 2054 7275 652e 0a20  fault is True.. 
-000508f0: 2020 2020 2020 2070 3020 3a20 6469 6374         p0 : dict
-00050900: 2d6c 696b 652c 206f 7074 696f 6e61 6c0a  -like, optional.
-00050910: 2020 2020 2020 2020 2020 2020 4f70 7469              Opti
-00050920: 6f6e 616c 2064 6963 7469 6f6e 6172 7920  onal dictionary 
-00050930: 6f66 2070 6172 616d 6574 6572 206e 616d  of parameter nam
-00050940: 6573 2074 6f20 696e 6974 6961 6c20 6775  es to initial gu
-00050950: 6573 7365 7320 7061 7373 6564 2074 6f20  esses passed to 
-00050960: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00050970: 6063 7572 7665 5f66 6974 6020 6070 3060  `curve_fit` `p0`
-00050980: 2061 7267 2e20 4966 206e 6f6e 6520 6f72   arg. If none or
-00050990: 206f 6e6c 7920 736f 6d65 2070 6172 616d   only some param
-000509a0: 6574 6572 7320 6172 6520 7061 7373 6564  eters are passed
-000509b0: 2c20 7468 6520 7265 7374 2077 696c 6c0a  , the rest will.
-000509c0: 2020 2020 2020 2020 2020 2020 6265 2061              be a
-000509d0: 7373 6967 6e65 6420 696e 6974 6961 6c20  ssigned initial 
-000509e0: 7661 6c75 6573 2066 6f6c 6c6f 7769 6e67  values following
-000509f0: 2074 6865 2064 6566 6175 6c74 2073 6369   the default sci
-00050a00: 7079 2062 6568 6176 696f 722e 0a20 2020  py behavior..   
-00050a10: 2020 2020 2062 6f75 6e64 7320 3a20 6469       bounds : di
-00050a20: 6374 2d6c 696b 652c 206f 7074 696f 6e61  ct-like, optiona
-00050a30: 6c0a 2020 2020 2020 2020 2020 2020 4f70  l.            Op
-00050a40: 7469 6f6e 616c 2064 6963 7469 6f6e 6172  tional dictionar
-00050a50: 7920 6f66 2070 6172 616d 6574 6572 206e  y of parameter n
-00050a60: 616d 6573 2074 6f20 626f 756e 6469 6e67  ames to bounding
-00050a70: 2076 616c 7565 7320 7061 7373 6564 2074   values passed t
-00050a80: 6f20 7468 650a 2020 2020 2020 2020 2020  o the.          
-00050a90: 2020 6063 7572 7665 5f66 6974 6020 6062    `curve_fit` `b
-00050aa0: 6f75 6e64 7360 2061 7267 2e20 4966 206e  ounds` arg. If n
-00050ab0: 6f6e 6520 6f72 206f 6e6c 7920 736f 6d65  one or only some
-00050ac0: 2070 6172 616d 6574 6572 7320 6172 6520   parameters are 
-00050ad0: 7061 7373 6564 2c20 7468 6520 7265 7374  passed, the rest
-00050ae0: 0a20 2020 2020 2020 2020 2020 2077 696c  .            wil
-00050af0: 6c20 6265 2075 6e62 6f75 6e64 6564 2066  l be unbounded f
-00050b00: 6f6c 6c6f 7769 6e67 2074 6865 2064 6566  ollowing the def
-00050b10: 6175 6c74 2073 6369 7079 2062 6568 6176  ault scipy behav
-00050b20: 696f 722e 0a20 2020 2020 2020 2070 6172  ior..        par
-00050b30: 616d 5f6e 616d 6573 203a 2073 6571 7565  am_names : seque
-00050b40: 6e63 6520 6f66 2068 6173 6861 626c 652c  nce of hashable,
-00050b50: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
-00050b60: 2020 2020 2020 5365 7175 656e 6365 206f        Sequence o
-00050b70: 6620 6e61 6d65 7320 666f 7220 7468 6520  f names for the 
-00050b80: 6669 7474 6162 6c65 2070 6172 616d 6574  fittable paramet
-00050b90: 6572 7320 6f66 2060 6675 6e63 602e 2049  ers of `func`. I
-00050ba0: 6620 6e6f 7420 7375 7070 6c69 6564 2c0a  f not supplied,.
-00050bb0: 2020 2020 2020 2020 2020 2020 7468 6973              this
-00050bc0: 2077 696c 6c20 6265 2061 7574 6f6d 6174   will be automat
-00050bd0: 6963 616c 6c79 2064 6574 6572 6d69 6e65  ically determine
-00050be0: 6420 6279 2061 7267 756d 656e 7473 206f  d by arguments o
-00050bf0: 6620 6066 756e 6360 2e20 6070 6172 616d  f `func`. `param
-00050c00: 5f6e 616d 6573 600a 2020 2020 2020 2020  _names`.        
-00050c10: 2020 2020 7368 6f75 6c64 2062 6520 6d61      should be ma
-00050c20: 6e75 616c 6c79 2073 7570 706c 6965 6420  nually supplied 
-00050c30: 7768 656e 2066 6974 7469 6e67 2061 2066  when fitting a f
-00050c40: 756e 6374 696f 6e20 7468 6174 2074 616b  unction that tak
-00050c50: 6573 2061 2076 6172 6961 626c 650a 2020  es a variable.  
-00050c60: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-00050c70: 206f 6620 7061 7261 6d65 7465 7273 2e0a   of parameters..
-00050c80: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-00050c90: 203a 206f 7074 696f 6e61 6c0a 2020 2020   : optional.    
-00050ca0: 2020 2020 2020 2020 4164 6469 7469 6f6e          Addition
-00050cb0: 616c 206b 6579 776f 7264 2061 7267 756d  al keyword argum
-00050cc0: 656e 7473 2074 6f20 7061 7373 6564 2074  ents to passed t
-00050cd0: 6f20 7363 6970 7920 6375 7276 655f 6669  o scipy curve_fi
-00050ce0: 742e 0a0a 2020 2020 2020 2020 5265 7475  t...        Retu
-00050cf0: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
-00050d00: 2d2d 2d0a 2020 2020 2020 2020 6375 7276  ---.        curv
-00050d10: 6566 6974 5f72 6573 756c 7473 203a 2044  efit_results : D
-00050d20: 6174 6173 6574 0a20 2020 2020 2020 2020  ataset.         
-00050d30: 2020 2041 2073 696e 676c 6520 6461 7461     A single data
-00050d40: 7365 7420 7768 6963 6820 636f 6e74 6169  set which contai
-00050d50: 6e73 3a0a 0a20 2020 2020 2020 2020 2020  ns:..           
-00050d60: 205b 7661 725d 5f63 7572 7665 6669 745f   [var]_curvefit_
-00050d70: 636f 6566 6669 6369 656e 7473 0a20 2020  coefficients.   
-00050d80: 2020 2020 2020 2020 2020 2020 2054 6865               The
-00050d90: 2063 6f65 6666 6963 6965 6e74 7320 6f66   coefficients of
-00050da0: 2074 6865 2062 6573 7420 6669 742e 0a20   the best fit.. 
-00050db0: 2020 2020 2020 2020 2020 205b 7661 725d             [var]
-00050dc0: 5f63 7572 7665 6669 745f 636f 7661 7269  _curvefit_covari
-00050dd0: 616e 6365 0a20 2020 2020 2020 2020 2020  ance.           
-00050de0: 2020 2020 2054 6865 2063 6f76 6172 6961       The covaria
-00050df0: 6e63 6520 6d61 7472 6978 206f 6620 7468  nce matrix of th
-00050e00: 6520 636f 6566 6669 6369 656e 7420 6573  e coefficient es
-00050e10: 7469 6d61 7465 732e 0a0a 2020 2020 2020  timates...      
-00050e20: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-00050e30: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00050e40: 2020 2020 4461 7461 7365 742e 706f 6c79      Dataset.poly
-00050e50: 6669 740a 2020 2020 2020 2020 7363 6970  fit.        scip
-00050e60: 792e 6f70 7469 6d69 7a65 2e63 7572 7665  y.optimize.curve
-00050e70: 5f66 6974 0a20 2020 2020 2020 2022 2222  _fit.        """
-00050e80: 0a20 2020 2020 2020 2066 726f 6d20 7363  .        from sc
-00050e90: 6970 792e 6f70 7469 6d69 7a65 2069 6d70  ipy.optimize imp
-00050ea0: 6f72 7420 6375 7276 655f 6669 740a 0a20  ort curve_fit.. 
-00050eb0: 2020 2020 2020 2066 726f 6d20 7861 7272         from xarr
-00050ec0: 6179 2e63 6f72 652e 616c 6967 6e6d 656e  ay.core.alignmen
-00050ed0: 7420 696d 706f 7274 2062 726f 6164 6361  t import broadca
-00050ee0: 7374 0a20 2020 2020 2020 2066 726f 6d20  st.        from 
-00050ef0: 7861 7272 6179 2e63 6f72 652e 636f 6d70  xarray.core.comp
-00050f00: 7574 6174 696f 6e20 696d 706f 7274 2061  utation import a
-00050f10: 7070 6c79 5f75 6675 6e63 0a20 2020 2020  pply_ufunc.     
-00050f20: 2020 2066 726f 6d20 7861 7272 6179 2e63     from xarray.c
-00050f30: 6f72 652e 6461 7461 6172 7261 7920 696d  ore.dataarray im
-00050f40: 706f 7274 205f 5448 4953 5f41 5252 4159  port _THIS_ARRAY
-00050f50: 2c20 4461 7461 4172 7261 790a 0a20 2020  , DataArray..   
-00050f60: 2020 2020 2069 6620 7030 2069 7320 4e6f       if p0 is No
-00050f70: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00050f80: 7030 203d 207b 7d0a 2020 2020 2020 2020  p0 = {}.        
-00050f90: 6966 2062 6f75 6e64 7320 6973 204e 6f6e  if bounds is Non
-00050fa0: 653a 0a20 2020 2020 2020 2020 2020 2062  e:.            b
-00050fb0: 6f75 6e64 7320 3d20 7b7d 0a20 2020 2020  ounds = {}.     
-00050fc0: 2020 2069 6620 6b77 6172 6773 2069 7320     if kwargs is 
-00050fd0: 4e6f 6e65 3a0a 2020 2020 2020 2020 2020  None:.          
-00050fe0: 2020 6b77 6172 6773 203d 207b 7d0a 0a20    kwargs = {}.. 
-00050ff0: 2020 2020 2020 2072 6564 7563 655f 6469         reduce_di
-00051000: 6d73 5f3a 206c 6973 745b 4861 7368 6162  ms_: list[Hashab
-00051010: 6c65 5d0a 2020 2020 2020 2020 6966 206e  le].        if n
-00051020: 6f74 2072 6564 7563 655f 6469 6d73 3a0a  ot reduce_dims:.
-00051030: 2020 2020 2020 2020 2020 2020 7265 6475              redu
-00051040: 6365 5f64 696d 735f 203d 205b 5d0a 2020  ce_dims_ = [].  
-00051050: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00051060: 7461 6e63 6528 7265 6475 6365 5f64 696d  tance(reduce_dim
-00051070: 732c 2073 7472 2920 6f72 206e 6f74 2069  s, str) or not i
-00051080: 7369 6e73 7461 6e63 6528 7265 6475 6365  sinstance(reduce
-00051090: 5f64 696d 732c 2049 7465 7261 626c 6529  _dims, Iterable)
-000510a0: 3a0a 2020 2020 2020 2020 2020 2020 7265  :.            re
-000510b0: 6475 6365 5f64 696d 735f 203d 205b 7265  duce_dims_ = [re
-000510c0: 6475 6365 5f64 696d 735d 0a20 2020 2020  duce_dims].     
-000510d0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-000510e0: 2020 2020 2072 6564 7563 655f 6469 6d73       reduce_dims
-000510f0: 5f20 3d20 6c69 7374 2872 6564 7563 655f  _ = list(reduce_
-00051100: 6469 6d73 290a 0a20 2020 2020 2020 2069  dims)..        i
-00051110: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-00051120: 6973 696e 7374 616e 6365 2863 6f6f 7264  isinstance(coord
-00051130: 732c 2073 7472 290a 2020 2020 2020 2020  s, str).        
-00051140: 2020 2020 6f72 2069 7369 6e73 7461 6e63      or isinstanc
-00051150: 6528 636f 6f72 6473 2c20 4461 7461 4172  e(coords, DataAr
-00051160: 7261 7929 0a20 2020 2020 2020 2020 2020  ray).           
-00051170: 206f 7220 6e6f 7420 6973 696e 7374 616e   or not isinstan
-00051180: 6365 2863 6f6f 7264 732c 2049 7465 7261  ce(coords, Itera
-00051190: 626c 6529 0a20 2020 2020 2020 2029 3a0a  ble).        ):.
-000511a0: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
-000511b0: 6473 203d 205b 636f 6f72 6473 5d0a 2020  ds = [coords].  
-000511c0: 2020 2020 2020 636f 6f72 6473 5f3a 2053        coords_: S
-000511d0: 6571 7565 6e63 655b 4461 7461 4172 7261  equence[DataArra
-000511e0: 795d 203d 205b 0a20 2020 2020 2020 2020  y] = [.         
-000511f0: 2020 2073 656c 665b 636f 6f72 645d 2069     self[coord] i
-00051200: 6620 6973 696e 7374 616e 6365 2863 6f6f  f isinstance(coo
-00051210: 7264 2c20 7374 7229 2065 6c73 6520 636f  rd, str) else co
-00051220: 6f72 6420 666f 7220 636f 6f72 6420 696e  ord for coord in
-00051230: 2063 6f6f 7264 730a 2020 2020 2020 2020   coords.        
-00051240: 5d0a 0a20 2020 2020 2020 2023 2044 6574  ]..        # Det
-00051250: 6572 6d69 6e65 2077 6865 7468 6572 2061  ermine whether a
-00051260: 6e79 2063 6f6f 7264 7320 6172 6520 6469  ny coords are di
-00051270: 6d73 206f 6e20 7365 6c66 0a20 2020 2020  ms on self.     
-00051280: 2020 2066 6f72 2063 6f6f 7264 2069 6e20     for coord in 
-00051290: 636f 6f72 6473 5f3a 0a20 2020 2020 2020  coords_:.       
-000512a0: 2020 2020 2072 6564 7563 655f 6469 6d73       reduce_dims
-000512b0: 5f20 2b3d 205b 6320 666f 7220 6320 696e  _ += [c for c in
-000512c0: 2073 656c 662e 6469 6d73 2069 6620 636f   self.dims if co
-000512d0: 6f72 642e 6571 7561 6c73 2873 656c 665b  ord.equals(self[
-000512e0: 635d 295d 0a20 2020 2020 2020 2072 6564  c])].        red
-000512f0: 7563 655f 6469 6d73 5f20 3d20 6c69 7374  uce_dims_ = list
-00051300: 2873 6574 2872 6564 7563 655f 6469 6d73  (set(reduce_dims
-00051310: 5f29 290a 2020 2020 2020 2020 7072 6573  _)).        pres
-00051320: 6572 7665 645f 6469 6d73 203d 206c 6973  erved_dims = lis
-00051330: 7428 7365 7428 7365 6c66 2e64 696d 7329  t(set(self.dims)
-00051340: 202d 2073 6574 2872 6564 7563 655f 6469   - set(reduce_di
-00051350: 6d73 5f29 290a 2020 2020 2020 2020 6966  ms_)).        if
-00051360: 206e 6f74 2072 6564 7563 655f 6469 6d73   not reduce_dims
-00051370: 5f3a 0a20 2020 2020 2020 2020 2020 2072  _:.            r
-00051380: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00051390: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000513a0: 2022 4e6f 2061 7267 756d 656e 7473 2074   "No arguments t
-000513b0: 6f20 6063 6f6f 7264 7360 2077 6572 6520  o `coords` were 
-000513c0: 6964 656e 7469 6669 6564 2061 7320 6120  identified as a 
-000513d0: 6469 6d65 6e73 696f 6e20 6f6e 2074 6865  dimension on the
-000513e0: 2063 616c 6c69 6e67 2022 0a20 2020 2020   calling ".     
-000513f0: 2020 2020 2020 2020 2020 2022 6f62 6a65             "obje
-00051400: 6374 2c20 616e 6420 6e6f 2064 696d 7320  ct, and no dims 
-00051410: 7765 7265 2073 7570 706c 6965 6420 746f  were supplied to
-00051420: 2060 7265 6475 6365 5f64 696d 7360 2e20   `reduce_dims`. 
-00051430: 5468 6973 2077 6f75 6c64 2072 6573 756c  This would resul
-00051440: 7420 220a 2020 2020 2020 2020 2020 2020  t ".            
-00051450: 2020 2020 2269 6e20 6669 7474 696e 6720      "in fitting 
-00051460: 6f6e 2073 6361 6c61 7220 6461 7461 2e22  on scalar data."
-00051470: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00051480: 2020 2020 2020 2020 2320 4272 6f61 6463          # Broadc
-00051490: 6173 7420 616c 6c20 636f 6f72 6473 2077  ast all coords w
-000514a0: 6974 6820 6561 6368 206f 7468 6572 0a20  ith each other. 
-000514b0: 2020 2020 2020 2063 6f6f 7264 735f 203d         coords_ =
-000514c0: 2062 726f 6164 6361 7374 282a 636f 6f72   broadcast(*coor
-000514d0: 6473 5f29 0a20 2020 2020 2020 2063 6f6f  ds_).        coo
-000514e0: 7264 735f 203d 205b 0a20 2020 2020 2020  rds_ = [.       
-000514f0: 2020 2020 2063 6f6f 7264 2e62 726f 6164       coord.broad
-00051500: 6361 7374 5f6c 696b 6528 7365 6c66 2c20  cast_like(self, 
-00051510: 6578 636c 7564 653d 7072 6573 6572 7665  exclude=preserve
-00051520: 645f 6469 6d73 2920 666f 7220 636f 6f72  d_dims) for coor
-00051530: 6420 696e 2063 6f6f 7264 735f 0a20 2020  d in coords_.   
-00051540: 2020 2020 205d 0a0a 2020 2020 2020 2020       ]..        
-00051550: 7061 7261 6d73 2c20 6675 6e63 5f61 7267  params, func_arg
-00051560: 7320 3d20 5f67 6574 5f66 756e 635f 6172  s = _get_func_ar
-00051570: 6773 2866 756e 632c 2070 6172 616d 5f6e  gs(func, param_n
-00051580: 616d 6573 290a 2020 2020 2020 2020 7061  ames).        pa
-00051590: 7261 6d5f 6465 6661 756c 7473 2c20 626f  ram_defaults, bo
-000515a0: 756e 6473 5f64 6566 6175 6c74 7320 3d20  unds_defaults = 
-000515b0: 5f69 6e69 7469 616c 697a 655f 6375 7276  _initialize_curv
-000515c0: 6566 6974 5f70 6172 616d 7328 0a20 2020  efit_params(.   
-000515d0: 2020 2020 2020 2020 2070 6172 616d 732c           params,
-000515e0: 2070 302c 2062 6f75 6e64 732c 2066 756e   p0, bounds, fun
-000515f0: 635f 6172 6773 0a20 2020 2020 2020 2029  c_args.        )
-00051600: 0a20 2020 2020 2020 206e 5f70 6172 616d  .        n_param
-00051610: 7320 3d20 6c65 6e28 7061 7261 6d73 290a  s = len(params).
-00051620: 2020 2020 2020 2020 6b77 6172 6773 2e73          kwargs.s
-00051630: 6574 6465 6661 756c 7428 2270 3022 2c20  etdefault("p0", 
-00051640: 5b70 6172 616d 5f64 6566 6175 6c74 735b  [param_defaults[
-00051650: 705d 2066 6f72 2070 2069 6e20 7061 7261  p] for p in para
-00051660: 6d73 5d29 0a20 2020 2020 2020 206b 7761  ms]).        kwa
-00051670: 7267 732e 7365 7464 6566 6175 6c74 280a  rgs.setdefault(.
-00051680: 2020 2020 2020 2020 2020 2020 2262 6f75              "bou
-00051690: 6e64 7322 2c0a 2020 2020 2020 2020 2020  nds",.          
-000516a0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-000516b0: 2020 2020 5b62 6f75 6e64 735f 6465 6661      [bounds_defa
-000516c0: 756c 7473 5b70 5d5b 305d 2066 6f72 2070  ults[p][0] for p
-000516d0: 2069 6e20 7061 7261 6d73 5d2c 0a20 2020   in params],.   
-000516e0: 2020 2020 2020 2020 2020 2020 205b 626f               [bo
-000516f0: 756e 6473 5f64 6566 6175 6c74 735b 705d  unds_defaults[p]
-00051700: 5b31 5d20 666f 7220 7020 696e 2070 6172  [1] for p in par
-00051710: 616d 735d 2c0a 2020 2020 2020 2020 2020  ams],.          
-00051720: 2020 5d2c 0a20 2020 2020 2020 2029 0a0a    ],.        )..
-00051730: 2020 2020 2020 2020 6465 6620 5f77 7261          def _wra
-00051740: 7070 6572 2859 2c20 2a63 6f6f 7264 735f  pper(Y, *coords_
-00051750: 2c20 2a2a 6b77 6172 6773 293a 0a20 2020  , **kwargs):.   
-00051760: 2020 2020 2020 2020 2023 2057 7261 7020           # Wrap 
-00051770: 6375 7276 655f 6669 7420 7769 7468 2072  curve_fit with r
-00051780: 6176 656c 6564 2063 6f6f 7264 696e 6174  aveled coordinat
-00051790: 6573 2061 6e64 2070 6f69 6e74 7769 7365  es and pointwise
-000517a0: 204e 614e 2068 616e 646c 696e 670a 2020   NaN handling.  
-000517b0: 2020 2020 2020 2020 2020 7820 3d20 6e70            x = np
-000517c0: 2e76 7374 6163 6b28 5b63 2e72 6176 656c  .vstack([c.ravel
-000517d0: 2829 2066 6f72 2063 2069 6e20 636f 6f72  () for c in coor
-000517e0: 6473 5f5d 290a 2020 2020 2020 2020 2020  ds_]).          
-000517f0: 2020 7920 3d20 592e 7261 7665 6c28 290a    y = Y.ravel().
-00051800: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00051810: 6b69 706e 613a 0a20 2020 2020 2020 2020  kipna:.         
-00051820: 2020 2020 2020 206d 6173 6b20 3d20 6e70         mask = np
-00051830: 2e61 6c6c 285b 6e70 2e61 6e79 287e 6e70  .all([np.any(~np
-00051840: 2e69 736e 616e 2878 292c 2061 7869 733d  .isnan(x), axis=
-00051850: 3029 2c20 7e6e 702e 6973 6e61 6e28 7929  0), ~np.isnan(y)
-00051860: 5d2c 2061 7869 733d 3029 0a20 2020 2020  ], axis=0).     
-00051870: 2020 2020 2020 2020 2020 2078 203d 2078             x = x
-00051880: 5b3a 2c20 6d61 736b 5d0a 2020 2020 2020  [:, mask].      
-00051890: 2020 2020 2020 2020 2020 7920 3d20 795b            y = y[
-000518a0: 6d61 736b 5d0a 2020 2020 2020 2020 2020  mask].          
-000518b0: 2020 2020 2020 6966 206e 6f74 206c 656e        if not len
-000518c0: 2879 293a 0a20 2020 2020 2020 2020 2020  (y):.           
-000518d0: 2020 2020 2020 2020 2070 6f70 7420 3d20           popt = 
-000518e0: 6e70 2e66 756c 6c28 5b6e 5f70 6172 616d  np.full([n_param
-000518f0: 735d 2c20 6e70 2e6e 616e 290a 2020 2020  s], np.nan).    
-00051900: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051910: 7063 6f76 203d 206e 702e 6675 6c6c 285b  pcov = np.full([
-00051920: 6e5f 7061 7261 6d73 2c20 6e5f 7061 7261  n_params, n_para
-00051930: 6d73 5d2c 206e 702e 6e61 6e29 0a20 2020  ms], np.nan).   
-00051940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051950: 2072 6574 7572 6e20 706f 7074 2c20 7063   return popt, pc
-00051960: 6f76 0a20 2020 2020 2020 2020 2020 2078  ov.            x
-00051970: 203d 206e 702e 7371 7565 657a 6528 7829   = np.squeeze(x)
-00051980: 0a20 2020 2020 2020 2020 2020 2070 6f70  .            pop
-00051990: 742c 2070 636f 7620 3d20 6375 7276 655f  t, pcov = curve_
-000519a0: 6669 7428 6675 6e63 2c20 782c 2079 2c20  fit(func, x, y, 
-000519b0: 2a2a 6b77 6172 6773 290a 2020 2020 2020  **kwargs).      
-000519c0: 2020 2020 2020 7265 7475 726e 2070 6f70        return pop
-000519d0: 742c 2070 636f 760a 0a20 2020 2020 2020  t, pcov..       
-000519e0: 2072 6573 756c 7420 3d20 7479 7065 2873   result = type(s
-000519f0: 656c 6629 2829 0a20 2020 2020 2020 2066  elf)().        f
-00051a00: 6f72 206e 616d 652c 2064 6120 696e 2073  or name, da in s
-00051a10: 656c 662e 6461 7461 5f76 6172 732e 6974  elf.data_vars.it
-00051a20: 656d 7328 293a 0a20 2020 2020 2020 2020  ems():.         
-00051a30: 2020 2069 6620 6e61 6d65 2069 7320 5f54     if name is _T
-00051a40: 4849 535f 4152 5241 593a 0a20 2020 2020  HIS_ARRAY:.     
-00051a50: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-00051a60: 3d20 2222 0a20 2020 2020 2020 2020 2020  = "".           
-00051a70: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00051a80: 2020 2020 2020 206e 616d 6520 3d20 6622         name = f"
-00051a90: 7b73 7472 286e 616d 6529 7d5f 220a 0a20  {str(name)}_".. 
-00051aa0: 2020 2020 2020 2020 2020 2070 6f70 742c             popt,
-00051ab0: 2070 636f 7620 3d20 6170 706c 795f 7566   pcov = apply_uf
-00051ac0: 756e 6328 0a20 2020 2020 2020 2020 2020  unc(.           
-00051ad0: 2020 2020 205f 7772 6170 7065 722c 0a20       _wrapper,. 
-00051ae0: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-00051af0: 612c 0a20 2020 2020 2020 2020 2020 2020  a,.             
-00051b00: 2020 202a 636f 6f72 6473 5f2c 0a20 2020     *coords_,.   
-00051b10: 2020 2020 2020 2020 2020 2020 2076 6563               vec
-00051b20: 746f 7269 7a65 3d54 7275 652c 0a20 2020  torize=True,.   
-00051b30: 2020 2020 2020 2020 2020 2020 2064 6173               das
-00051b40: 6b3d 2270 6172 616c 6c65 6c69 7a65 6422  k="parallelized"
-00051b50: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00051b60: 2020 696e 7075 745f 636f 7265 5f64 696d    input_core_dim
-00051b70: 733d 5b72 6564 7563 655f 6469 6d73 5f20  s=[reduce_dims_ 
-00051b80: 666f 7220 6420 696e 2072 616e 6765 286c  for d in range(l
-00051b90: 656e 2863 6f6f 7264 735f 2920 2b20 3129  en(coords_) + 1)
-00051ba0: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00051bb0: 2020 206f 7574 7075 745f 636f 7265 5f64     output_core_d
-00051bc0: 696d 733d 5b5b 2270 6172 616d 225d 2c20  ims=[["param"], 
-00051bd0: 5b22 636f 765f 6922 2c20 2263 6f76 5f6a  ["cov_i", "cov_j
-00051be0: 225d 5d2c 0a20 2020 2020 2020 2020 2020  "]],.           
-00051bf0: 2020 2020 2064 6173 6b5f 6775 6675 6e63       dask_gufunc
-00051c00: 5f6b 7761 7267 733d 7b0a 2020 2020 2020  _kwargs={.      
-00051c10: 2020 2020 2020 2020 2020 2020 2020 226f                "o
-00051c20: 7574 7075 745f 7369 7a65 7322 3a20 7b0a  utput_sizes": {.
-00051c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051c40: 2020 2020 2020 2020 2270 6172 616d 223a          "param":
-00051c50: 206e 5f70 6172 616d 732c 0a20 2020 2020   n_params,.     
-00051c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00051c70: 2020 2022 636f 765f 6922 3a20 6e5f 7061     "cov_i": n_pa
-00051c80: 7261 6d73 2c0a 2020 2020 2020 2020 2020  rams,.          
-00051c90: 2020 2020 2020 2020 2020 2020 2020 2263                "c
-00051ca0: 6f76 5f6a 223a 206e 5f70 6172 616d 732c  ov_j": n_params,
-00051cb0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00051cc0: 2020 2020 207d 2c0a 2020 2020 2020 2020       },.        
-00051cd0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-00051ce0: 2020 2020 2020 2020 2020 206f 7574 7075             outpu
-00051cf0: 745f 6474 7970 6573 3d28 6e70 2e66 6c6f  t_dtypes=(np.flo
-00051d00: 6174 3634 2c20 6e70 2e66 6c6f 6174 3634  at64, np.float64
-00051d10: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00051d20: 2020 2065 7863 6c75 6465 5f64 696d 733d     exclude_dims=
-00051d30: 7365 7428 7265 6475 6365 5f64 696d 735f  set(reduce_dims_
-00051d40: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00051d50: 2020 206b 7761 7267 733d 6b77 6172 6773     kwargs=kwargs
-00051d60: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
-00051d70: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00051d80: 6c74 5b6e 616d 6520 2b20 2263 7572 7665  lt[name + "curve
-00051d90: 6669 745f 636f 6566 6669 6369 656e 7473  fit_coefficients
-00051da0: 225d 203d 2070 6f70 740a 2020 2020 2020  "] = popt.      
-00051db0: 2020 2020 2020 7265 7375 6c74 5b6e 616d        result[nam
-00051dc0: 6520 2b20 2263 7572 7665 6669 745f 636f  e + "curvefit_co
-00051dd0: 7661 7269 616e 6365 225d 203d 2070 636f  variance"] = pco
-00051de0: 760a 0a20 2020 2020 2020 2072 6573 756c  v..        resul
-00051df0: 7420 3d20 7265 7375 6c74 2e61 7373 6967  t = result.assig
-00051e00: 6e5f 636f 6f72 6473 280a 2020 2020 2020  n_coords(.      
-00051e10: 2020 2020 2020 7b22 7061 7261 6d22 3a20        {"param": 
-00051e20: 7061 7261 6d73 2c20 2263 6f76 5f69 223a  params, "cov_i":
-00051e30: 2070 6172 616d 732c 2022 636f 765f 6a22   params, "cov_j"
-00051e40: 3a20 7061 7261 6d73 7d0a 2020 2020 2020  : params}.      
-00051e50: 2020 290a 2020 2020 2020 2020 7265 7375    ).        resu
-00051e60: 6c74 2e61 7474 7273 203d 2073 656c 662e  lt.attrs = self.
-00051e70: 6174 7472 732e 636f 7079 2829 0a0a 2020  attrs.copy()..  
-00051e80: 2020 2020 2020 7265 7475 726e 2072 6573        return res
-00051e90: 756c 740a 0a20 2020 2064 6566 2064 726f  ult..    def dro
-00051ea0: 705f 6475 706c 6963 6174 6573 280a 2020  p_duplicates(.  
-00051eb0: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
-00051ec0: 7461 7365 742c 0a20 2020 2020 2020 2064  taset,.        d
-00051ed0: 696d 3a20 4861 7368 6162 6c65 207c 2049  im: Hashable | I
-00051ee0: 7465 7261 626c 655b 4861 7368 6162 6c65  terable[Hashable
-00051ef0: 5d2c 0a20 2020 2020 2020 206b 6565 703a  ],.        keep:
-00051f00: 204c 6974 6572 616c 5b22 6669 7273 7422   Literal["first"
-00051f10: 2c20 226c 6173 7422 2c20 4661 6c73 655d  , "last", False]
-00051f20: 203d 2022 6669 7273 7422 2c0a 2020 2020   = "first",.    
-00051f30: 2920 2d3e 2054 5f44 6174 6173 6574 3a0a  ) -> T_Dataset:.
-00051f40: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-00051f50: 6e73 2061 206e 6577 2044 6174 6173 6574  ns a new Dataset
-00051f60: 2077 6974 6820 6475 706c 6963 6174 6520   with duplicate 
-00051f70: 6469 6d65 6e73 696f 6e20 7661 6c75 6573  dimension values
-00051f80: 2072 656d 6f76 6564 2e0a 0a20 2020 2020   removed...     
-00051f90: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00051fa0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00051fb0: 0a20 2020 2020 2020 2064 696d 203a 2064  .        dim : d
-00051fc0: 696d 656e 7369 6f6e 206c 6162 656c 206f  imension label o
-00051fd0: 7220 6c61 6265 6c73 0a20 2020 2020 2020  r labels.       
-00051fe0: 2020 2020 2050 6173 7320 602e 2e2e 6020       Pass `...` 
-00051ff0: 746f 2064 726f 7020 6475 706c 6963 6174  to drop duplicat
-00052000: 6573 2061 6c6f 6e67 2061 6c6c 2064 696d  es along all dim
-00052010: 656e 7369 6f6e 732e 0a20 2020 2020 2020  ensions..       
-00052020: 206b 6565 7020 3a20 7b22 6669 7273 7422   keep : {"first"
-00052030: 2c20 226c 6173 7422 2c20 4661 6c73 657d  , "last", False}
-00052040: 2c20 6465 6661 756c 743a 2022 6669 7273  , default: "firs
-00052050: 7422 0a20 2020 2020 2020 2020 2020 2044  t".            D
-00052060: 6574 6572 6d69 6e65 7320 7768 6963 6820  etermines which 
-00052070: 6475 706c 6963 6174 6573 2028 6966 2061  duplicates (if a
-00052080: 6e79 2920 746f 206b 6565 702e 0a20 2020  ny) to keep..   
-00052090: 2020 2020 2020 2020 202d 2060 6022 6669           - ``"fi
-000520a0: 7273 7422 6060 203a 2044 726f 7020 6475  rst"`` : Drop du
-000520b0: 706c 6963 6174 6573 2065 7863 6570 7420  plicates except 
-000520c0: 666f 7220 7468 6520 6669 7273 7420 6f63  for the first oc
-000520d0: 6375 7272 656e 6365 2e0a 2020 2020 2020  currence..      
-000520e0: 2020 2020 2020 2d20 6060 226c 6173 7422        - ``"last"
-000520f0: 6060 203a 2044 726f 7020 6475 706c 6963  `` : Drop duplic
-00052100: 6174 6573 2065 7863 6570 7420 666f 7220  ates except for 
-00052110: 7468 6520 6c61 7374 206f 6363 7572 7265  the last occurre
-00052120: 6e63 652e 0a20 2020 2020 2020 2020 2020  nce..           
-00052130: 202d 2046 616c 7365 203a 2044 726f 7020   - False : Drop 
-00052140: 616c 6c20 6475 706c 6963 6174 6573 2e0a  all duplicates..
-00052150: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00052160: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00052170: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
-00052180: 0a0a 2020 2020 2020 2020 5365 6520 416c  ..        See Al
-00052190: 736f 0a20 2020 2020 2020 202d 2d2d 2d2d  so.        -----
-000521a0: 2d2d 2d0a 2020 2020 2020 2020 4461 7461  ---.        Data
-000521b0: 4172 7261 792e 6472 6f70 5f64 7570 6c69  Array.drop_dupli
-000521c0: 6361 7465 730a 2020 2020 2020 2020 2222  cates.        ""
-000521d0: 220a 2020 2020 2020 2020 6966 2069 7369  ".        if isi
-000521e0: 6e73 7461 6e63 6528 6469 6d2c 2073 7472  nstance(dim, str
-000521f0: 293a 0a20 2020 2020 2020 2020 2020 2064  ):.            d
-00052200: 696d 733a 2049 7465 7261 626c 6520 3d20  ims: Iterable = 
-00052210: 2864 696d 2c29 0a20 2020 2020 2020 2065  (dim,).        e
-00052220: 6c69 6620 6469 6d20 6973 202e 2e2e 3a0a  lif dim is ...:.
-00052230: 2020 2020 2020 2020 2020 2020 6469 6d73              dims
-00052240: 203d 2073 656c 662e 6469 6d73 0a20 2020   = self.dims.   
-00052250: 2020 2020 2065 6c69 6620 6e6f 7420 6973       elif not is
-00052260: 696e 7374 616e 6365 2864 696d 2c20 4974  instance(dim, It
-00052270: 6572 6162 6c65 293a 0a20 2020 2020 2020  erable):.       
-00052280: 2020 2020 2064 696d 7320 3d20 5b64 696d       dims = [dim
-00052290: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
-000522a0: 2020 2020 2020 2020 2020 2020 6469 6d73              dims
-000522b0: 203d 2064 696d 0a0a 2020 2020 2020 2020   = dim..        
-000522c0: 6d69 7373 696e 675f 6469 6d73 203d 2073  missing_dims = s
-000522d0: 6574 2864 696d 7329 202d 2073 6574 2873  et(dims) - set(s
-000522e0: 656c 662e 6469 6d73 290a 2020 2020 2020  elf.dims).      
-000522f0: 2020 6966 206d 6973 7369 6e67 5f64 696d    if missing_dim
-00052300: 733a 0a20 2020 2020 2020 2020 2020 2072  s:.            r
-00052310: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00052320: 6622 277b 6d69 7373 696e 675f 6469 6d73  f"'{missing_dims
-00052330: 7d27 206e 6f74 2066 6f75 6e64 2069 6e20  }' not found in 
-00052340: 6469 6d65 6e73 696f 6e73 2229 0a0a 2020  dimensions")..  
-00052350: 2020 2020 2020 696e 6465 7865 7320 3d20        indexes = 
-00052360: 7b64 696d 3a20 7e73 656c 662e 6765 745f  {dim: ~self.get_
-00052370: 696e 6465 7828 6469 6d29 2e64 7570 6c69  index(dim).dupli
-00052380: 6361 7465 6428 6b65 6570 3d6b 6565 7029  cated(keep=keep)
-00052390: 2066 6f72 2064 696d 2069 6e20 6469 6d73   for dim in dims
-000523a0: 7d0a 2020 2020 2020 2020 7265 7475 726e  }.        return
-000523b0: 2073 656c 662e 6973 656c 2869 6e64 6578   self.isel(index
-000523c0: 6573 290a 0a20 2020 2064 6566 2063 6f6e  es)..    def con
-000523d0: 7665 7274 5f63 616c 656e 6461 7228 0a20  vert_calendar(. 
-000523e0: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
-000523f0: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
-00052400: 6361 6c65 6e64 6172 3a20 4346 4361 6c65  calendar: CFCale
-00052410: 6e64 6172 2c0a 2020 2020 2020 2020 6469  ndar,.        di
-00052420: 6d3a 2048 6173 6861 626c 6520 3d20 2274  m: Hashable = "t
-00052430: 696d 6522 2c0a 2020 2020 2020 2020 616c  ime",.        al
-00052440: 6967 6e5f 6f6e 3a20 4c69 7465 7261 6c5b  ign_on: Literal[
-00052450: 2264 6174 6522 2c20 2279 6561 7222 2c20  "date", "year", 
-00052460: 4e6f 6e65 5d20 3d20 4e6f 6e65 2c0a 2020  None] = None,.  
-00052470: 2020 2020 2020 6d69 7373 696e 673a 2041        missing: A
-00052480: 6e79 207c 204e 6f6e 6520 3d20 4e6f 6e65  ny | None = None
-00052490: 2c0a 2020 2020 2020 2020 7573 655f 6366  ,.        use_cf
-000524a0: 7469 6d65 3a20 626f 6f6c 207c 204e 6f6e  time: bool | Non
-000524b0: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2920  e = None,.    ) 
-000524c0: 2d3e 2054 5f44 6174 6173 6574 3a0a 2020  -> T_Dataset:.  
-000524d0: 2020 2020 2020 2222 2243 6f6e 7665 7274        """Convert
-000524e0: 2074 6865 2044 6174 6173 6574 2074 6f20   the Dataset to 
-000524f0: 616e 6f74 6865 7220 6361 6c65 6e64 6172  another calendar
-00052500: 2e0a 0a20 2020 2020 2020 204f 6e6c 7920  ...        Only 
-00052510: 636f 6e76 6572 7473 2074 6865 2069 6e64  converts the ind
-00052520: 6976 6964 7561 6c20 7469 6d65 7374 616d  ividual timestam
-00052530: 7073 2c20 646f 6573 206e 6f74 206d 6f64  ps, does not mod
-00052540: 6966 7920 616e 7920 6461 7461 2065 7863  ify any data exc
-00052550: 6570 740a 2020 2020 2020 2020 696e 2064  ept.        in d
-00052560: 726f 7070 696e 6720 696e 7661 6c69 642f  ropping invalid/
-00052570: 7375 7270 6c75 7320 6461 7465 7320 6f72  surplus dates or
-00052580: 2069 6e73 6572 7469 6e67 206d 6973 7369   inserting missi
-00052590: 6e67 2064 6174 6573 2e0a 0a20 2020 2020  ng dates...     
-000525a0: 2020 2049 6620 7468 6520 736f 7572 6365     If the source
-000525b0: 2061 6e64 2074 6172 6765 7420 6361 6c65   and target cale
-000525c0: 6e64 6172 7320 6172 6520 6569 7468 6572  ndars are either
-000525d0: 206e 6f5f 6c65 6170 2c20 616c 6c5f 6c65   no_leap, all_le
-000525e0: 6170 206f 7220 610a 2020 2020 2020 2020  ap or a.        
-000525f0: 7374 616e 6461 7264 2074 7970 652c 206f  standard type, o
-00052600: 6e6c 7920 7468 6520 7479 7065 206f 6620  nly the type of 
-00052610: 7468 6520 7469 6d65 2061 7272 6179 2069  the time array i
-00052620: 7320 6d6f 6469 6669 6564 2e0a 2020 2020  s modified..    
-00052630: 2020 2020 5768 656e 2063 6f6e 7665 7274      When convert
-00052640: 696e 6720 746f 2061 206c 6561 7020 7965  ing to a leap ye
-00052650: 6172 2066 726f 6d20 6120 6e6f 6e2d 6c65  ar from a non-le
-00052660: 6170 2079 6561 722c 2074 6865 2032 3974  ap year, the 29t
-00052670: 6820 6f66 2046 6562 7275 6172 790a 2020  h of February.  
-00052680: 2020 2020 2020 6973 2072 656d 6f76 6564        is removed
-00052690: 2066 726f 6d20 7468 6520 6172 7261 792e   from the array.
-000526a0: 2049 6e20 7468 6520 6f74 6865 7220 6469   In the other di
-000526b0: 7265 6374 696f 6e20 7468 6520 3239 7468  rection the 29th
-000526c0: 206f 6620 4665 6272 7561 7279 0a20 2020   of February.   
-000526d0: 2020 2020 2077 696c 6c20 6265 206d 6973       will be mis
-000526e0: 7369 6e67 2069 6e20 7468 6520 6f75 7470  sing in the outp
-000526f0: 7574 2c20 756e 6c65 7373 2060 6d69 7373  ut, unless `miss
-00052700: 696e 6760 2069 7320 7370 6563 6966 6965  ing` is specifie
-00052710: 642c 0a20 2020 2020 2020 2069 6e20 7768  d,.        in wh
-00052720: 6963 6820 6361 7365 2074 6861 7420 7661  ich case that va
-00052730: 6c75 6520 6973 2069 6e73 6572 7465 642e  lue is inserted.
-00052740: 0a0a 2020 2020 2020 2020 466f 7220 636f  ..        For co
-00052750: 6e76 6572 7369 6f6e 7320 696e 766f 6c76  nversions involv
-00052760: 696e 6720 6033 3630 5f64 6179 6020 6361  ing `360_day` ca
-00052770: 6c65 6e64 6172 732c 2073 6565 204e 6f74  lendars, see Not
-00052780: 6573 2e0a 0a20 2020 2020 2020 2054 6869  es...        Thi
-00052790: 7320 6d65 7468 6f64 2069 7320 7361 6665  s method is safe
-000527a0: 2074 6f20 7573 6520 7769 7468 2073 7562   to use with sub
-000527b0: 2d64 6169 6c79 2064 6174 6120 6173 2069  -daily data as i
-000527c0: 7420 646f 6573 6e27 7420 746f 7563 6820  t doesn't touch 
-000527d0: 7468 650a 2020 2020 2020 2020 7469 6d65  the.        time
-000527e0: 2070 6172 7420 6f66 2074 6865 2074 696d   part of the tim
-000527f0: 6573 7461 6d70 732e 0a0a 2020 2020 2020  estamps...      
-00052800: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
-00052810: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 0a20       ---------. 
-00052820: 2020 2020 2020 2063 616c 656e 6461 7220         calendar 
-00052830: 3a20 7374 720a 2020 2020 2020 2020 2020  : str.          
-00052840: 2020 5468 6520 7461 7267 6574 2063 616c    The target cal
-00052850: 656e 6461 7220 6e61 6d65 2e0a 2020 2020  endar name..    
-00052860: 2020 2020 6469 6d20 3a20 4861 7368 6162      dim : Hashab
-00052870: 6c65 2c20 6465 6661 756c 743a 2022 7469  le, default: "ti
-00052880: 6d65 220a 2020 2020 2020 2020 2020 2020  me".            
-00052890: 4e61 6d65 206f 6620 7468 6520 7469 6d65  Name of the time
-000528a0: 2063 6f6f 7264 696e 6174 652e 0a20 2020   coordinate..   
-000528b0: 2020 2020 2061 6c69 676e 5f6f 6e20 3a20       align_on : 
-000528c0: 7b4e 6f6e 652c 2027 6461 7465 272c 2027  {None, 'date', '
-000528d0: 7965 6172 277d 2c20 6f70 7469 6f6e 616c  year'}, optional
-000528e0: 0a20 2020 2020 2020 2020 2020 204d 7573  .            Mus
-000528f0: 7420 6265 2073 7065 6369 6669 6564 2077  t be specified w
-00052900: 6865 6e20 6569 7468 6572 2073 6f75 7263  hen either sourc
-00052910: 6520 6f72 2074 6172 6765 7420 6973 2061  e or target is a
-00052920: 2060 3336 305f 6461 7960 2063 616c 656e   `360_day` calen
-00052930: 6461 722c 0a20 2020 2020 2020 2020 2020  dar,.           
-00052940: 2069 676e 6f72 6564 206f 7468 6572 7769   ignored otherwi
-00052950: 7365 2e20 5365 6520 4e6f 7465 732e 0a20  se. See Notes.. 
-00052960: 2020 2020 2020 206d 6973 7369 6e67 203a         missing :
-00052970: 2041 6e79 206f 7220 4e6f 6e65 2c20 6f70   Any or None, op
-00052980: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00052990: 2020 2042 7920 6465 6661 756c 742c 2069     By default, i
-000529a0: 2e65 2e20 6966 2074 6865 2076 616c 7565  .e. if the value
-000529b0: 2069 7320 4e6f 6e65 2c20 7468 6973 206d   is None, this m
-000529c0: 6574 686f 6420 7769 6c6c 2073 696d 706c  ethod will simpl
-000529d0: 7920 6174 7465 6d70 740a 2020 2020 2020  y attempt.      
-000529e0: 2020 2020 2020 746f 2063 6f6e 7665 7274        to convert
-000529f0: 2074 6865 2064 6174 6573 2069 6e20 7468   the dates in th
-00052a00: 6520 736f 7572 6365 2063 616c 656e 6461  e source calenda
-00052a10: 7220 746f 2074 6865 2073 616d 6520 6461  r to the same da
-00052a20: 7465 7320 696e 2074 6865 0a20 2020 2020  tes in the.     
-00052a30: 2020 2020 2020 2074 6172 6765 7420 6361         target ca
-00052a40: 6c65 6e64 6172 2c20 616e 6420 6472 6f70  lendar, and drop
-00052a50: 2061 6e79 206f 6620 7468 6f73 6520 7468   any of those th
-00052a60: 6174 2061 7265 206e 6f74 2070 6f73 7369  at are not possi
-00052a70: 626c 6520 746f 0a20 2020 2020 2020 2020  ble to.         
-00052a80: 2020 2072 6570 7265 7365 6e74 2e20 2049     represent.  I
-00052a90: 6620 6120 7661 6c75 6520 6973 2070 726f  f a value is pro
-00052aa0: 7669 6465 642c 2061 206e 6577 2074 696d  vided, a new tim
-00052ab0: 6520 636f 6f72 6469 6e61 7465 2077 696c  e coordinate wil
-00052ac0: 6c20 6265 0a20 2020 2020 2020 2020 2020  l be.           
-00052ad0: 2063 7265 6174 6564 2069 6e20 7468 6520   created in the 
-00052ae0: 7461 7267 6574 2063 616c 656e 6461 7220  target calendar 
-00052af0: 7769 7468 2074 6865 2073 616d 6520 6672  with the same fr
-00052b00: 6571 7565 6e63 7920 6173 2074 6865 206f  equency as the o
-00052b10: 7269 6769 6e61 6c0a 2020 2020 2020 2020  riginal.        
-00052b20: 2020 2020 7469 6d65 2063 6f6f 7264 696e      time coordin
-00052b30: 6174 653b 2066 6f72 2061 6e79 2064 6174  ate; for any dat
-00052b40: 6573 2074 6861 7420 6172 6520 6e6f 7420  es that are not 
-00052b50: 7072 6573 656e 7420 696e 2074 6865 2073  present in the s
-00052b60: 6f75 7263 652c 2074 6865 0a20 2020 2020  ource, the.     
-00052b70: 2020 2020 2020 2064 6174 6120 7769 6c6c         data will
-00052b80: 2062 6520 6669 6c6c 6564 2077 6974 6820   be filled with 
-00052b90: 7468 6973 2076 616c 7565 2e20 204e 6f74  this value.  Not
-00052ba0: 6520 7468 6174 2075 7369 6e67 2074 6869  e that using thi
-00052bb0: 7320 6d6f 6465 2072 6571 7569 7265 730a  s mode requires.
-00052bc0: 2020 2020 2020 2020 2020 2020 7468 6174              that
-00052bd0: 2074 6865 2073 6f75 7263 6520 6461 7461   the source data
-00052be0: 2068 6176 6520 616e 2069 6e66 6572 6162   have an inferab
-00052bf0: 6c65 2066 7265 7175 656e 6379 3b20 666f  le frequency; fo
-00052c00: 7220 6d6f 7265 2069 6e66 6f72 6d61 7469  r more informati
-00052c10: 6f6e 0a20 2020 2020 2020 2020 2020 2073  on.            s
-00052c20: 6565 203a 7079 3a66 756e 633a 6078 6172  ee :py:func:`xar
-00052c30: 7261 792e 696e 6665 725f 6672 6571 602e  ray.infer_freq`.
-00052c40: 2020 466f 7220 6365 7274 6169 6e20 6672    For certain fr
-00052c50: 6571 7565 6e63 792c 2073 6f75 7263 652c  equency, source,
-00052c60: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
-00052c70: 2074 6172 6765 7420 6361 6c65 6e64 6172   target calendar
-00052c80: 2063 6f6d 6269 6e61 7469 6f6e 732c 2074   combinations, t
-00052c90: 6869 7320 636f 756c 6420 7265 7375 6c74  his could result
-00052ca0: 2069 6e20 6d61 6e79 206d 6973 7369 6e67   in many missing
-00052cb0: 2076 616c 7565 732c 2073 6565 206e 6f74   values, see not
-00052cc0: 6573 2e0a 2020 2020 2020 2020 7573 655f  es..        use_
-00052cd0: 6366 7469 6d65 203a 2062 6f6f 6c20 6f72  cftime : bool or
-00052ce0: 204e 6f6e 652c 206f 7074 696f 6e61 6c0a   None, optional.
-00052cf0: 2020 2020 2020 2020 2020 2020 5768 6574              Whet
-00052d00: 6865 7220 746f 2075 7365 2063 6674 696d  her to use cftim
-00052d10: 6520 6f62 6a65 6374 7320 696e 2074 6865  e objects in the
-00052d20: 206f 7574 7075 742c 206f 6e6c 7920 7573   output, only us
-00052d30: 6564 2069 6620 6063 616c 656e 6461 7260  ed if `calendar`
-00052d40: 0a20 2020 2020 2020 2020 2020 2069 7320  .            is 
-00052d50: 6f6e 6520 6f66 207b 2270 726f 6c65 7074  one of {"prolept
-00052d60: 6963 5f67 7265 676f 7269 616e 222c 2022  ic_gregorian", "
-00052d70: 6772 6567 6f72 6961 6e22 206f 7220 2273  gregorian" or "s
-00052d80: 7461 6e64 6172 6422 7d2e 0a20 2020 2020  tandard"}..     
-00052d90: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
-00052da0: 7468 6520 6e65 7720 7469 6d65 2061 7869  the new time axi
-00052db0: 7320 7573 6573 2063 6674 696d 6520 6f62  s uses cftime ob
-00052dc0: 6a65 6374 732e 0a20 2020 2020 2020 2020  jects..         
-00052dd0: 2020 2049 6620 4e6f 6e65 2028 6465 6661     If None (defa
-00052de0: 756c 7429 2c20 6974 2075 7365 7320 3a70  ult), it uses :p
-00052df0: 793a 636c 6173 733a 606e 756d 7079 2e64  y:class:`numpy.d
-00052e00: 6174 6574 696d 6536 3460 2076 616c 7565  atetime64` value
-00052e10: 7320 6966 2074 6865 0a20 2020 2020 2020  s if the.       
-00052e20: 2020 2020 2064 6174 6520 7261 6e67 6520       date range 
-00052e30: 7065 726d 6974 7320 6974 2c20 616e 6420  permits it, and 
-00052e40: 3a70 793a 636c 6173 733a 6063 6674 696d  :py:class:`cftim
-00052e50: 652e 6461 7465 7469 6d65 6020 6f62 6a65  e.datetime` obje
-00052e60: 6374 7320 6966 206e 6f74 2e0a 2020 2020  cts if not..    
-00052e70: 2020 2020 2020 2020 4966 2046 616c 7365          If False
-00052e80: 2c20 6974 2075 7365 7320 3a70 793a 636c  , it uses :py:cl
-00052e90: 6173 733a 606e 756d 7079 2e64 6174 6574  ass:`numpy.datet
-00052ea0: 696d 6536 3460 2020 6f72 2066 6169 6c73  ime64`  or fails
-00052eb0: 2e0a 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00052ec0: 6e73 0a20 2020 2020 2020 202d 2d2d 2d2d  ns.        -----
-00052ed0: 2d2d 0a20 2020 2020 2020 2044 6174 6173  --.        Datas
-00052ee0: 6574 0a20 2020 2020 2020 2020 2020 2043  et.            C
-00052ef0: 6f70 7920 6f66 2074 6865 2064 6174 6161  opy of the dataa
-00052f00: 7272 6179 2077 6974 6820 7468 6520 7469  rray with the ti
-00052f10: 6d65 2063 6f6f 7264 696e 6174 6520 636f  me coordinate co
-00052f20: 6e76 6572 7465 6420 746f 2074 6865 0a20  nverted to the. 
-00052f30: 2020 2020 2020 2020 2020 2074 6172 6765             targe
-00052f40: 7420 6361 6c65 6e64 6172 2e20 4966 2027  t calendar. If '
-00052f50: 6d69 7373 696e 6727 2077 6173 204e 6f6e  missing' was Non
-00052f60: 6520 2864 6566 6175 6c74 292c 2069 6e76  e (default), inv
-00052f70: 616c 6964 2064 6174 6573 2069 6e0a 2020  alid dates in.  
-00052f80: 2020 2020 2020 2020 2020 7468 6520 6e65            the ne
-00052f90: 7720 6361 6c65 6e64 6172 2061 7265 2064  w calendar are d
-00052fa0: 726f 7070 6564 2c20 6275 7420 6d69 7373  ropped, but miss
-00052fb0: 696e 6720 6461 7465 7320 6172 6520 6e6f  ing dates are no
-00052fc0: 7420 696e 7365 7274 6564 2e0a 2020 2020  t inserted..    
-00052fd0: 2020 2020 2020 2020 4966 2060 6d69 7373          If `miss
-00052fe0: 696e 6760 2077 6173 2067 6976 656e 2c20  ing` was given, 
-00052ff0: 7468 6520 6e65 7720 6461 7461 2069 7320  the new data is 
-00053000: 7265 696e 6465 7865 6420 746f 2068 6176  reindexed to hav
-00053010: 6520 6120 7469 6d65 2061 7869 730a 2020  e a time axis.  
-00053020: 2020 2020 2020 2020 2020 7769 7468 2074            with t
-00053030: 6865 2073 616d 6520 6672 6571 7565 6e63  he same frequenc
-00053040: 7920 6173 2074 6865 2073 6f75 7263 652c  y as the source,
-00053050: 2062 7574 2069 6e20 7468 6520 6e65 7720   but in the new 
-00053060: 6361 6c65 6e64 6172 3b20 616e 790a 2020  calendar; any.  
-00053070: 2020 2020 2020 2020 2020 6d69 7373 696e            missin
-00053080: 6720 6461 7461 706f 696e 7473 2061 7265  g datapoints are
-00053090: 2066 696c 6c65 6420 7769 7468 2060 6d69   filled with `mi
-000530a0: 7373 696e 6760 2e0a 0a20 2020 2020 2020  ssing`...       
-000530b0: 204e 6f74 6573 0a20 2020 2020 2020 202d   Notes.        -
-000530c0: 2d2d 2d2d 0a20 2020 2020 2020 2050 6173  ----.        Pas
-000530d0: 7369 6e67 2061 2076 616c 7565 2074 6f20  sing a value to 
-000530e0: 606d 6973 7369 6e67 6020 6973 206f 6e6c  `missing` is onl
-000530f0: 7920 7573 6162 6c65 2069 6620 7468 6520  y usable if the 
-00053100: 736f 7572 6365 2773 2074 696d 6520 636f  source's time co
-00053110: 6f72 6469 6e61 7465 2061 7320 616e 0a20  ordinate as an. 
-00053120: 2020 2020 2020 2069 6e66 6572 6162 6c65         inferable
-00053130: 2066 7265 7175 656e 6369 6573 2028 7365   frequencies (se
-00053140: 6520 3a70 793a 6675 6e63 3a60 7e78 6172  e :py:func:`~xar
-00053150: 7261 792e 696e 6665 725f 6672 6571 6029  ray.infer_freq`)
-00053160: 2061 6e64 2069 7320 6f6e 6c79 2061 7070   and is only app
-00053170: 726f 7072 6961 7465 0a20 2020 2020 2020  ropriate.       
-00053180: 2069 6620 7468 6520 7461 7267 6574 2063   if the target c
-00053190: 6f6f 7264 696e 6174 652c 2067 656e 6572  oordinate, gener
-000531a0: 6174 6564 2066 726f 6d20 7468 6973 2066  ated from this f
-000531b0: 7265 7175 656e 6379 2c20 6861 7320 6461  requency, has da
-000531c0: 7465 7320 6571 7569 7661 6c65 6e74 2074  tes equivalent t
-000531d0: 6f20 7468 650a 2020 2020 2020 2020 736f  o the.        so
-000531e0: 7572 6365 2e20 4974 2069 7320 7573 7561  urce. It is usua
-000531f0: 6c6c 7920 2a2a 6e6f 742a 2a20 6170 7072  lly **not** appr
-00053200: 6f70 7269 6174 6520 746f 2075 7365 2074  opriate to use t
-00053210: 6869 7320 6d6f 6465 2077 6974 683a 0a0a  his mode with:..
-00053220: 2020 2020 2020 2020 2d20 5065 7269 6f64          - Period
-00053230: 2d65 6e64 2066 7265 7175 656e 6369 6573  -end frequencies
-00053240: 203a 2027 4127 2c20 2759 272c 2027 5127   : 'A', 'Y', 'Q'
-00053250: 206f 7220 274d 272c 2069 6e20 6f70 706f   or 'M', in oppo
-00053260: 7369 7469 6f6e 2074 6f20 2741 5327 2027  sition to 'AS' '
-00053270: 5953 272c 2027 5153 2720 616e 6420 274d  YS', 'QS' and 'M
-00053280: 5327 0a20 2020 2020 2020 202d 2053 7562  S'.        - Sub
-00053290: 2d6d 6f6e 7468 6c79 2066 7265 7175 656e  -monthly frequen
-000532a0: 6369 6573 2074 6861 7420 646f 206e 6f74  cies that do not
-000532b0: 2064 6976 6964 6520 6120 6461 7920 6576   divide a day ev
-000532c0: 656e 6c79 203a 2027 5727 2c20 276e 4427  enly : 'W', 'nD'
-000532d0: 2077 6865 7265 2060 4e20 213d 2031 600a   where `N != 1`.
-000532e0: 2020 2020 2020 2020 2020 2020 6f72 2027              or '
-000532f0: 6d48 2720 7768 6572 6520 3234 2025 206d  mH' where 24 % m
-00053300: 2021 3d20 3029 2e0a 0a20 2020 2020 2020   != 0)...       
-00053310: 2049 6620 6f6e 6520 6f66 2074 6865 2073   If one of the s
-00053320: 6f75 7263 6520 6f72 2074 6172 6765 7420  ource or target 
-00053330: 6361 6c65 6e64 6172 7320 6973 2060 2233  calendars is `"3
-00053340: 3630 5f64 6179 2260 2c20 6061 6c69 676e  60_day"`, `align
-00053350: 5f6f 6e60 206d 7573 740a 2020 2020 2020  _on` must.      
-00053360: 2020 6265 2073 7065 6369 6669 6564 2061    be specified a
-00053370: 6e64 2074 776f 206f 7074 696f 6e73 2061  nd two options a
-00053380: 7265 206f 6666 6572 6564 2e0a 0a20 2020  re offered...   
-00053390: 2020 2020 202d 2022 7965 6172 220a 2020       - "year".  
-000533a0: 2020 2020 2020 2020 2020 5468 6520 6461            The da
-000533b0: 7465 7320 6172 6520 7472 616e 736c 6174  tes are translat
-000533c0: 6564 2061 6363 6f72 6469 6e67 2074 6f20  ed according to 
-000533d0: 7468 6569 7220 7265 6c61 7469 7665 2070  their relative p
-000533e0: 6f73 6974 696f 6e20 696e 2074 6865 2079  osition in the y
-000533f0: 6561 722c 0a20 2020 2020 2020 2020 2020  ear,.           
-00053400: 2069 676e 6f72 696e 6720 7468 6569 7220   ignoring their 
-00053410: 6f72 6967 696e 616c 206d 6f6e 7468 2061  original month a
-00053420: 6e64 2064 6179 2069 6e66 6f72 6d61 7469  nd day informati
-00053430: 6f6e 2c20 6d65 616e 696e 6720 7468 6174  on, meaning that
-00053440: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00053450: 206d 6973 7369 6e67 2f73 7572 706c 7573   missing/surplus
-00053460: 2064 6179 7320 6172 6520 6164 6465 642f   days are added/
-00053470: 7265 6d6f 7665 6420 6174 2072 6567 756c  removed at regul
-00053480: 6172 2069 6e74 6572 7661 6c73 2e0a 0a20  ar intervals... 
-00053490: 2020 2020 2020 2020 2020 2046 726f 6d20             From 
-000534a0: 6120 6033 3630 5f64 6179 6020 746f 2061  a `360_day` to a
-000534b0: 2073 7461 6e64 6172 6420 6361 6c65 6e64   standard calend
-000534c0: 6172 2c20 7468 6520 6f75 7470 7574 2077  ar, the output w
-000534d0: 696c 6c20 6265 206d 6973 7369 6e67 2074  ill be missing t
-000534e0: 6865 0a20 2020 2020 2020 2020 2020 2066  he.            f
-000534f0: 6f6c 6c6f 7769 6e67 2064 6174 6573 2028  ollowing dates (
-00053500: 6461 7920 6f66 2079 6561 7220 696e 2070  day of year in p
-00053510: 6172 656e 7468 6573 6573 293a 0a0a 2020  arentheses):..  
-00053520: 2020 2020 2020 2020 2020 546f 2061 206c            To a l
-00053530: 6561 7020 7965 6172 3a0a 2020 2020 2020  eap year:.      
-00053540: 2020 2020 2020 2020 2020 4a61 6e75 6172            Januar
-00053550: 7920 3331 7374 2028 3331 292c 204d 6172  y 31st (31), Mar
-00053560: 6368 2033 3173 7420 2839 3129 2c20 4a75  ch 31st (91), Ju
-00053570: 6e65 2031 7374 2028 3135 3329 2c20 4a75  ne 1st (153), Ju
-00053580: 6c79 2033 3173 7420 2832 3133 292c 0a20  ly 31st (213),. 
-00053590: 2020 2020 2020 2020 2020 2020 2020 2053                 S
-000535a0: 6570 7465 6d62 6572 2033 3173 7420 2832  eptember 31st (2
-000535b0: 3735 2920 616e 6420 4e6f 7665 6d62 6572  75) and November
-000535c0: 2033 3074 6820 2833 3335 292e 0a20 2020   30th (335)..   
-000535d0: 2020 2020 2020 2020 2054 6f20 6120 6e6f           To a no
-000535e0: 6e2d 6c65 6170 2079 6561 723a 0a20 2020  n-leap year:.   
-000535f0: 2020 2020 2020 2020 2020 2020 2046 6562               Feb
-00053600: 7275 6172 7920 3674 6820 2833 3629 2c20  ruary 6th (36), 
-00053610: 4170 7269 6c20 3139 7468 2028 3130 3929  April 19th (109)
-00053620: 2c20 4a75 6c79 2032 6e64 2028 3138 3329  , July 2nd (183)
-00053630: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00053640: 2020 5365 7074 656d 6265 7220 3132 7468    September 12th
-00053650: 2028 3235 3529 2c20 4e6f 7665 6d62 6572   (255), November
-00053660: 2032 3574 6820 2833 3239 292e 0a0a 2020   25th (329)...  
-00053670: 2020 2020 2020 2020 2020 4672 6f6d 2061            From a
-00053680: 2073 7461 6e64 6172 6420 6361 6c65 6e64   standard calend
-00053690: 6172 2074 6f20 6120 6022 3336 305f 6461  ar to a `"360_da
-000536a0: 7922 602c 2074 6865 2066 6f6c 6c6f 7769  y"`, the followi
-000536b0: 6e67 2064 6174 6573 2069 6e20 7468 650a  ng dates in the.
-000536c0: 2020 2020 2020 2020 2020 2020 736f 7572              sour
-000536d0: 6365 2061 7272 6179 2077 696c 6c20 6265  ce array will be
-000536e0: 2064 726f 7070 6564 3a0a 0a20 2020 2020   dropped:..     
-000536f0: 2020 2020 2020 2046 726f 6d20 6120 6c65         From a le
-00053700: 6170 2079 6561 723a 0a20 2020 2020 2020  ap year:.       
-00053710: 2020 2020 2020 2020 204a 616e 7561 7279           January
-00053720: 2033 3173 7420 2833 3129 2c20 4170 7269   31st (31), Apri
-00053730: 6c20 3173 7420 2839 3229 2c20 4a75 6e65  l 1st (92), June
-00053740: 2031 7374 2028 3135 3329 2c20 4175 6775   1st (153), Augu
-00053750: 7374 2031 7374 2028 3231 3429 2c0a 2020  st 1st (214),.  
-00053760: 2020 2020 2020 2020 2020 2020 2020 5365                Se
-00053770: 7074 656d 6265 7220 3331 7374 2028 3237  ptember 31st (27
-00053780: 3529 2c20 4465 6365 6d62 6572 2031 7374  5), December 1st
-00053790: 2028 3333 3629 0a20 2020 2020 2020 2020   (336).         
-000537a0: 2020 2046 726f 6d20 6120 6e6f 6e2d 6c65     From a non-le
-000537b0: 6170 2079 6561 723a 0a20 2020 2020 2020  ap year:.       
-000537c0: 2020 2020 2020 2020 2046 6562 7275 6172           Februar
-000537d0: 7920 3674 6820 2833 3729 2c20 4170 7269  y 6th (37), Apri
-000537e0: 6c20 3230 7468 2028 3131 3029 2c20 4a75  l 20th (110), Ju
-000537f0: 6c79 2032 6e64 2028 3138 3329 2c0a 2020  ly 2nd (183),.  
-00053800: 2020 2020 2020 2020 2020 2020 2020 5365                Se
-00053810: 7074 656d 6265 7220 3133 7468 2028 3235  ptember 13th (25
-00053820: 3629 2c20 4e6f 7665 6d62 6572 2032 3574  6), November 25t
-00053830: 6820 2833 3239 290a 0a20 2020 2020 2020  h (329)..       
-00053840: 2020 2020 2054 6869 7320 6f70 7469 6f6e       This option
-00053850: 2069 7320 6265 7374 2075 7365 6420 6f6e   is best used on
-00053860: 2064 6169 6c79 2061 6e64 2073 7562 6461   daily and subda
-00053870: 696c 7920 6461 7461 2e0a 0a20 2020 2020  ily data...     
-00053880: 2020 202d 2022 6461 7465 220a 2020 2020     - "date".    
-00053890: 2020 2020 2020 2020 5468 6520 6d6f 6e74          The mont
-000538a0: 682f 6461 7920 696e 666f 726d 6174 696f  h/day informatio
-000538b0: 6e20 6973 2063 6f6e 7365 7276 6564 2061  n is conserved a
-000538c0: 6e64 2069 6e76 616c 6964 2064 6174 6573  nd invalid dates
-000538d0: 2061 7265 2064 726f 7070 6564 0a20 2020   are dropped.   
-000538e0: 2020 2020 2020 2020 2066 726f 6d20 7468           from th
-000538f0: 6520 6f75 7470 7574 2e20 5468 6973 206d  e output. This m
-00053900: 6561 6e73 2074 6861 7420 7768 656e 2063  eans that when c
-00053910: 6f6e 7665 7274 696e 6720 6672 6f6d 2061  onverting from a
-00053920: 2060 2233 3630 5f64 6179 2260 2074 6f20   `"360_day"` to 
-00053930: 610a 2020 2020 2020 2020 2020 2020 7374  a.            st
-00053940: 616e 6461 7264 2063 616c 656e 6461 722c  andard calendar,
-00053950: 2061 6c6c 2033 3173 7420 284a 616e 2c20   all 31st (Jan, 
-00053960: 4d61 7263 682c 204d 6179 2c20 4a75 6c79  March, May, July
-00053970: 2c20 4175 6775 7374 2c20 4f63 746f 6265  , August, Octobe
-00053980: 7220 616e 640a 2020 2020 2020 2020 2020  r and.          
-00053990: 2020 4465 6365 6d62 6572 2920 7769 6c6c    December) will
-000539a0: 2062 6520 6d69 7373 696e 6720 6173 2074   be missing as t
-000539b0: 6865 7265 2069 7320 6e6f 2065 7175 6976  here is no equiv
-000539c0: 616c 656e 7420 6461 7465 7320 696e 2074  alent dates in t
-000539d0: 6865 0a20 2020 2020 2020 2020 2020 2060  he.            `
-000539e0: 2233 3630 5f64 6179 2260 2063 616c 656e  "360_day"` calen
-000539f0: 6461 7220 616e 6420 7468 6520 3239 7468  dar and the 29th
-00053a00: 2028 6f6e 206e 6f6e 2d6c 6561 7020 7965   (on non-leap ye
-00053a10: 6172 7329 2061 6e64 2033 3074 6820 6f66  ars) and 30th of
-00053a20: 2046 6562 7275 6172 790a 2020 2020 2020   February.      
-00053a30: 2020 2020 2020 7769 6c6c 2062 6520 6472        will be dr
-00053a40: 6f70 7065 6420 6173 2074 6865 7265 2061  opped as there a
-00053a50: 7265 206e 6f20 6571 7569 7661 6c65 6e74  re no equivalent
-00053a60: 2064 6174 6573 2069 6e20 6120 7374 616e   dates in a stan
-00053a70: 6461 7264 2063 616c 656e 6461 722e 0a0a  dard calendar...
-00053a80: 2020 2020 2020 2020 2020 2020 5468 6973              This
-00053a90: 206f 7074 696f 6e20 6973 2062 6573 7420   option is best 
-00053aa0: 7573 6564 2077 6974 6820 6461 7461 206f  used with data o
-00053ab0: 6e20 6120 6672 6571 7565 6e63 7920 636f  n a frequency co
-00053ac0: 6172 7365 7220 7468 616e 2064 6169 6c79  arser than daily
-00053ad0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00053ae0: 2020 2020 2020 7265 7475 726e 2063 6f6e        return con
-00053af0: 7665 7274 5f63 616c 656e 6461 7228 0a20  vert_calendar(. 
-00053b00: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-00053b10: 0a20 2020 2020 2020 2020 2020 2063 616c  .            cal
-00053b20: 656e 6461 722c 0a20 2020 2020 2020 2020  endar,.         
-00053b30: 2020 2064 696d 3d64 696d 2c0a 2020 2020     dim=dim,.    
-00053b40: 2020 2020 2020 2020 616c 6967 6e5f 6f6e          align_on
-00053b50: 3d61 6c69 676e 5f6f 6e2c 0a20 2020 2020  =align_on,.     
-00053b60: 2020 2020 2020 206d 6973 7369 6e67 3d6d         missing=m
-00053b70: 6973 7369 6e67 2c0a 2020 2020 2020 2020  issing,.        
-00053b80: 2020 2020 7573 655f 6366 7469 6d65 3d75      use_cftime=u
-00053b90: 7365 5f63 6674 696d 652c 0a20 2020 2020  se_cftime,.     
-00053ba0: 2020 2029 0a0a 2020 2020 6465 6620 696e     )..    def in
-00053bb0: 7465 7270 5f63 616c 656e 6461 7228 0a20  terp_calendar(. 
-00053bc0: 2020 2020 2020 2073 656c 663a 2054 5f44         self: T_D
-00053bd0: 6174 6173 6574 2c0a 2020 2020 2020 2020  ataset,.        
-00053be0: 7461 7267 6574 3a20 7064 2e44 6174 6574  target: pd.Datet
-00053bf0: 696d 6549 6e64 6578 207c 2043 4654 696d  imeIndex | CFTim
-00053c00: 6549 6e64 6578 207c 2044 6174 6141 7272  eIndex | DataArr
-00053c10: 6179 2c0a 2020 2020 2020 2020 6469 6d3a  ay,.        dim:
-00053c20: 2048 6173 6861 626c 6520 3d20 2274 696d   Hashable = "tim
-00053c30: 6522 2c0a 2020 2020 2920 2d3e 2054 5f44  e",.    ) -> T_D
-00053c40: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
-00053c50: 2222 2249 6e74 6572 706f 6c61 7465 7320  """Interpolates 
-00053c60: 7468 6520 4461 7461 7365 7420 746f 2061  the Dataset to a
-00053c70: 6e6f 7468 6572 2063 616c 656e 6461 7220  nother calendar 
-00053c80: 6261 7365 6420 6f6e 2064 6563 696d 616c  based on decimal
-00053c90: 2079 6561 7220 6d65 6173 7572 652e 0a0a   year measure...
-00053ca0: 2020 2020 2020 2020 4561 6368 2074 696d          Each tim
-00053cb0: 6573 7461 6d70 2069 6e20 6073 6f75 7263  estamp in `sourc
-00053cc0: 6560 2061 6e64 2060 7461 7267 6574 6020  e` and `target` 
-00053cd0: 6172 6520 6669 7273 7420 636f 6e76 6572  are first conver
-00053ce0: 7465 6420 746f 2074 6865 6972 2064 6563  ted to their dec
-00053cf0: 696d 616c 0a20 2020 2020 2020 2079 6561  imal.        yea
-00053d00: 7220 6571 7569 7661 6c65 6e74 2074 6865  r equivalent the
-00053d10: 6e20 6073 6f75 7263 6560 2069 7320 696e  n `source` is in
-00053d20: 7465 7270 6f6c 6174 6564 206f 6e20 7468  terpolated on th
-00053d30: 6520 7461 7267 6574 2063 6f6f 7264 696e  e target coordin
-00053d40: 6174 652e 0a20 2020 2020 2020 2054 6865  ate..        The
-00053d50: 2064 6563 696d 616c 2079 6561 7220 6f66   decimal year of
-00053d60: 2061 2074 696d 6573 7461 6d70 2069 7320   a timestamp is 
-00053d70: 6974 7320 7965 6172 2070 6c75 7320 6974  its year plus it
-00053d80: 7320 7375 622d 7965 6172 2063 6f6d 706f  s sub-year compo
-00053d90: 6e65 6e74 0a20 2020 2020 2020 2063 6f6e  nent.        con
-00053da0: 7665 7274 6564 2074 6f20 7468 6520 6672  verted to the fr
-00053db0: 6163 7469 6f6e 206f 6620 6974 7320 7965  action of its ye
-00053dc0: 6172 2e20 466f 7220 6578 616d 706c 6520  ar. For example 
-00053dd0: 2232 3030 302d 3033 2d30 3120 3132 3a30  "2000-03-01 12:0
-00053de0: 3022 2069 730a 2020 2020 2020 2020 3230  0" is.        20
-00053df0: 3030 2e31 3635 3320 696e 2061 2073 7461  00.1653 in a sta
-00053e00: 6e64 6172 6420 6361 6c65 6e64 6172 206f  ndard calendar o
-00053e10: 7220 3230 3030 2e31 3633 3031 2069 6e20  r 2000.16301 in 
-00053e20: 6120 6022 6e6f 6c65 6170 2260 2063 616c  a `"noleap"` cal
-00053e30: 656e 6461 722e 0a0a 2020 2020 2020 2020  endar...        
-00053e40: 5468 6973 206d 6574 686f 6420 7368 6f75  This method shou
-00053e50: 6c64 206f 6e6c 7920 6265 2075 7365 6420  ld only be used 
-00053e60: 7768 656e 2074 6865 2074 696d 6520 2848  when the time (H
-00053e70: 483a 4d4d 3a53 5329 2069 6e66 6f72 6d61  H:MM:SS) informa
-00053e80: 7469 6f6e 206f 660a 2020 2020 2020 2020  tion of.        
-00053e90: 7469 6d65 2063 6f6f 7264 696e 6174 6520  time coordinate 
-00053ea0: 6973 206e 6f74 2069 6d70 6f72 7461 6e74  is not important
-00053eb0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00053ec0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-00053ed0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-00053ee0: 2074 6172 6765 743a 2044 6174 6141 7272   target: DataArr
-00053ef0: 6179 206f 7220 4461 7465 7469 6d65 496e  ay or DatetimeIn
-00053f00: 6465 7820 6f72 2043 4654 696d 6549 6e64  dex or CFTimeInd
-00053f10: 6578 0a20 2020 2020 2020 2020 2020 2054  ex.            T
-00053f20: 6865 2074 6172 6765 7420 7469 6d65 2063  he target time c
-00053f30: 6f6f 7264 696e 6174 6520 6f66 2061 2076  oordinate of a v
-00053f40: 616c 6964 2064 7479 7065 0a20 2020 2020  alid dtype.     
-00053f50: 2020 2020 2020 2028 6e70 2e64 6174 6574         (np.datet
-00053f60: 696d 6536 3420 6f72 2063 6674 696d 6520  ime64 or cftime 
-00053f70: 6f62 6a65 6374 7329 0a20 2020 2020 2020  objects).       
-00053f80: 2064 696d 203a 2048 6173 6861 626c 652c   dim : Hashable,
-00053f90: 2064 6566 6175 6c74 3a20 2274 696d 6522   default: "time"
-00053fa0: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00053fb0: 2074 696d 6520 636f 6f72 6469 6e61 7465   time coordinate
-00053fc0: 206e 616d 652e 0a0a 2020 2020 2020 2020   name...        
-00053fd0: 5265 7475 726e 0a20 2020 2020 2020 202d  Return.        -
-00053fe0: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
-00053ff0: 7461 4172 7261 790a 2020 2020 2020 2020  taArray.        
-00054000: 2020 2020 5468 6520 736f 7572 6365 2069      The source i
-00054010: 6e74 6572 706f 6c61 7465 6420 6f6e 2074  nterpolated on t
-00054020: 6865 2064 6563 696d 616c 2079 6561 7273  he decimal years
-00054030: 206f 6620 7461 7267 6574 2c0a 2020 2020   of target,.    
-00054040: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00054050: 7265 7475 726e 2069 6e74 6572 705f 6361  return interp_ca
-00054060: 6c65 6e64 6172 2873 656c 662c 2074 6172  lendar(self, tar
-00054070: 6765 742c 2064 696d 3d64 696d 290a 0a20  get, dim=dim).. 
-00054080: 2020 2064 6566 2067 726f 7570 6279 280a     def groupby(.
-00054090: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-000540a0: 2020 2020 2020 6772 6f75 703a 2048 6173        group: Has
-000540b0: 6861 626c 6520 7c20 4461 7461 4172 7261  hable | DataArra
-000540c0: 7920 7c20 496e 6465 7856 6172 6961 626c  y | IndexVariabl
-000540d0: 652c 0a20 2020 2020 2020 2073 7175 6565  e,.        squee
-000540e0: 7a65 3a20 626f 6f6c 203d 2054 7275 652c  ze: bool = True,
-000540f0: 0a20 2020 2020 2020 2072 6573 746f 7265  .        restore
-00054100: 5f63 6f6f 7264 5f64 696d 733a 2062 6f6f  _coord_dims: boo
-00054110: 6c20 3d20 4661 6c73 652c 0a20 2020 2029  l = False,.    )
-00054120: 202d 3e20 4461 7461 7365 7447 726f 7570   -> DatasetGroup
-00054130: 4279 3a0a 2020 2020 2020 2020 2222 2252  By:.        """R
-00054140: 6574 7572 6e73 2061 2044 6174 6173 6574  eturns a Dataset
-00054150: 4772 6f75 7042 7920 6f62 6a65 6374 2066  GroupBy object f
-00054160: 6f72 2070 6572 666f 726d 696e 6720 6772  or performing gr
-00054170: 6f75 7065 6420 6f70 6572 6174 696f 6e73  ouped operations
-00054180: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00054190: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-000541a0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000541b0: 2067 726f 7570 203a 2048 6173 6861 626c   group : Hashabl
-000541c0: 652c 2044 6174 6141 7272 6179 206f 7220  e, DataArray or 
-000541d0: 496e 6465 7856 6172 6961 626c 650a 2020  IndexVariable.  
-000541e0: 2020 2020 2020 2020 2020 4172 7261 7920            Array 
-000541f0: 7768 6f73 6520 756e 6971 7565 2076 616c  whose unique val
-00054200: 7565 7320 7368 6f75 6c64 2062 6520 7573  ues should be us
-00054210: 6564 2074 6f20 6772 6f75 7020 7468 6973  ed to group this
-00054220: 2061 7272 6179 2e20 4966 2061 0a20 2020   array. If a.   
-00054230: 2020 2020 2020 2020 2073 7472 696e 672c           string,
-00054240: 206d 7573 7420 6265 2074 6865 206e 616d   must be the nam
-00054250: 6520 6f66 2061 2076 6172 6961 626c 6520  e of a variable 
-00054260: 636f 6e74 6169 6e65 6420 696e 2074 6869  contained in thi
-00054270: 7320 6461 7461 7365 742e 0a20 2020 2020  s dataset..     
-00054280: 2020 2073 7175 6565 7a65 203a 2062 6f6f     squeeze : boo
-00054290: 6c2c 2064 6566 6175 6c74 3a20 5472 7565  l, default: True
-000542a0: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
-000542b0: 2267 726f 7570 2220 6973 2061 2064 696d  "group" is a dim
-000542c0: 656e 7369 6f6e 206f 6620 616e 7920 6172  ension of any ar
-000542d0: 7261 7973 2069 6e20 7468 6973 2064 6174  rays in this dat
-000542e0: 6173 6574 2c20 6073 7175 6565 7a65 600a  aset, `squeeze`.
-000542f0: 2020 2020 2020 2020 2020 2020 636f 6e74              cont
-00054300: 726f 6c73 2077 6865 7468 6572 2074 6865  rols whether the
-00054310: 2073 7562 6172 7261 7973 2068 6176 6520   subarrays have 
-00054320: 6120 6469 6d65 6e73 696f 6e20 6f66 206c  a dimension of l
-00054330: 656e 6774 6820 3120 616c 6f6e 670a 2020  ength 1 along.  
-00054340: 2020 2020 2020 2020 2020 7468 6174 2064            that d
-00054350: 696d 656e 7369 6f6e 206f 7220 6966 2074  imension or if t
-00054360: 6865 2064 696d 656e 7369 6f6e 2069 7320  he dimension is 
-00054370: 7371 7565 657a 6564 206f 7574 2e0a 2020  squeezed out..  
-00054380: 2020 2020 2020 7265 7374 6f72 655f 636f        restore_co
-00054390: 6f72 645f 6469 6d73 203a 2062 6f6f 6c2c  ord_dims : bool,
-000543a0: 2064 6566 6175 6c74 3a20 4661 6c73 650a   default: False.
-000543b0: 2020 2020 2020 2020 2020 2020 4966 2054              If T
-000543c0: 7275 652c 2061 6c73 6f20 7265 7374 6f72  rue, also restor
-000543d0: 6520 7468 6520 6469 6d65 6e73 696f 6e20  e the dimension 
-000543e0: 6f72 6465 7220 6f66 206d 756c 7469 2d64  order of multi-d
-000543f0: 696d 656e 7369 6f6e 616c 0a20 2020 2020  imensional.     
-00054400: 2020 2020 2020 2063 6f6f 7264 696e 6174         coordinat
-00054410: 6573 2e0a 0a20 2020 2020 2020 2052 6574  es...        Ret
-00054420: 7572 6e73 0a20 2020 2020 2020 202d 2d2d  urns.        ---
-00054430: 2d2d 2d2d 0a20 2020 2020 2020 2067 726f  ----.        gro
-00054440: 7570 6564 203a 2044 6174 6173 6574 4772  uped : DatasetGr
-00054450: 6f75 7042 790a 2020 2020 2020 2020 2020  oupBy.          
-00054460: 2020 4120 6044 6174 6173 6574 4772 6f75    A `DatasetGrou
-00054470: 7042 7960 206f 626a 6563 7420 7061 7474  pBy` object patt
-00054480: 6572 6e65 6420 6166 7465 7220 6070 616e  erned after `pan
-00054490: 6461 732e 4772 6f75 7042 7960 2074 6861  das.GroupBy` tha
-000544a0: 7420 6361 6e20 6265 0a20 2020 2020 2020  t can be.       
-000544b0: 2020 2020 2069 7465 7261 7465 6420 6f76       iterated ov
-000544c0: 6572 2069 6e20 7468 6520 666f 726d 206f  er in the form o
-000544d0: 6620 6028 756e 6971 7565 5f76 616c 7565  f `(unique_value
-000544e0: 2c20 6772 6f75 7065 645f 6172 7261 7929  , grouped_array)
-000544f0: 6020 7061 6972 732e 0a0a 2020 2020 2020  ` pairs...      
-00054500: 2020 5365 6520 416c 736f 0a20 2020 2020    See Also.     
-00054510: 2020 202d 2d2d 2d2d 2d2d 2d0a 2020 2020     --------.    
-00054520: 2020 2020 3a72 6566 3a60 6772 6f75 7062      :ref:`groupb
-00054530: 7960 0a20 2020 2020 2020 2020 2020 2055  y`.            U
-00054540: 7365 7273 2067 7569 6465 2065 7870 6c61  sers guide expla
-00054550: 6e61 7469 6f6e 206f 6620 686f 7720 746f  nation of how to
-00054560: 2067 726f 7570 2061 6e64 2062 696e 2064   group and bin d
-00054570: 6174 612e 0a20 2020 2020 2020 2044 6174  ata..        Dat
-00054580: 6173 6574 2e67 726f 7570 6279 5f62 696e  aset.groupby_bin
-00054590: 730a 2020 2020 2020 2020 4461 7461 4172  s.        DataAr
-000545a0: 7261 792e 6772 6f75 7062 790a 2020 2020  ray.groupby.    
-000545b0: 2020 2020 636f 7265 2e67 726f 7570 6279      core.groupby
-000545c0: 2e44 6174 6173 6574 4772 6f75 7042 790a  .DatasetGroupBy.
-000545d0: 2020 2020 2020 2020 7061 6e64 6173 2e44          pandas.D
-000545e0: 6174 6146 7261 6d65 2e67 726f 7570 6279  ataFrame.groupby
-000545f0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
-00054600: 2e72 6573 616d 706c 650a 2020 2020 2020  .resample.      
-00054610: 2020 4461 7461 4172 7261 792e 7265 7361    DataArray.resa
-00054620: 6d70 6c65 0a20 2020 2020 2020 2022 2222  mple.        """
-00054630: 0a20 2020 2020 2020 2066 726f 6d20 7861  .        from xa
-00054640: 7272 6179 2e63 6f72 652e 6772 6f75 7062  rray.core.groupb
-00054650: 7920 696d 706f 7274 2028 0a20 2020 2020  y import (.     
-00054660: 2020 2020 2020 2044 6174 6173 6574 4772         DatasetGr
-00054670: 6f75 7042 792c 0a20 2020 2020 2020 2020  oupBy,.         
-00054680: 2020 2052 6573 6f6c 7665 6455 6e69 7175     ResolvedUniqu
-00054690: 6547 726f 7570 6572 2c0a 2020 2020 2020  eGrouper,.      
-000546a0: 2020 2020 2020 556e 6971 7565 4772 6f75        UniqueGrou
-000546b0: 7065 722c 0a20 2020 2020 2020 2020 2020  per,.           
-000546c0: 205f 7661 6c69 6461 7465 5f67 726f 7570   _validate_group
-000546d0: 6279 5f73 7175 6565 7a65 2c0a 2020 2020  by_squeeze,.    
-000546e0: 2020 2020 290a 0a20 2020 2020 2020 205f      )..        _
-000546f0: 7661 6c69 6461 7465 5f67 726f 7570 6279  validate_groupby
-00054700: 5f73 7175 6565 7a65 2873 7175 6565 7a65  _squeeze(squeeze
-00054710: 290a 2020 2020 2020 2020 7267 726f 7570  ).        rgroup
-00054720: 6572 203d 2052 6573 6f6c 7665 6455 6e69  er = ResolvedUni
-00054730: 7175 6547 726f 7570 6572 2855 6e69 7175  queGrouper(Uniqu
-00054740: 6547 726f 7570 6572 2829 2c20 6772 6f75  eGrouper(), grou
-00054750: 702c 2073 656c 6629 0a0a 2020 2020 2020  p, self)..      
-00054760: 2020 7265 7475 726e 2044 6174 6173 6574    return Dataset
-00054770: 4772 6f75 7042 7928 0a20 2020 2020 2020  GroupBy(.       
-00054780: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
-00054790: 2020 2020 2020 2028 7267 726f 7570 6572         (rgrouper
-000547a0: 2c29 2c0a 2020 2020 2020 2020 2020 2020  ,),.            
-000547b0: 7371 7565 657a 653d 7371 7565 657a 652c  squeeze=squeeze,
-000547c0: 0a20 2020 2020 2020 2020 2020 2072 6573  .            res
-000547d0: 746f 7265 5f63 6f6f 7264 5f64 696d 733d  tore_coord_dims=
-000547e0: 7265 7374 6f72 655f 636f 6f72 645f 6469  restore_coord_di
-000547f0: 6d73 2c0a 2020 2020 2020 2020 290a 0a20  ms,.        ).. 
-00054800: 2020 2064 6566 2067 726f 7570 6279 5f62     def groupby_b
-00054810: 696e 7328 0a20 2020 2020 2020 2073 656c  ins(.        sel
-00054820: 662c 0a20 2020 2020 2020 2067 726f 7570  f,.        group
-00054830: 3a20 4861 7368 6162 6c65 207c 2044 6174  : Hashable | Dat
-00054840: 6141 7272 6179 207c 2049 6e64 6578 5661  aArray | IndexVa
-00054850: 7269 6162 6c65 2c0a 2020 2020 2020 2020  riable,.        
-00054860: 6269 6e73 3a20 4172 7261 794c 696b 652c  bins: ArrayLike,
-00054870: 0a20 2020 2020 2020 2072 6967 6874 3a20  .        right: 
-00054880: 626f 6f6c 203d 2054 7275 652c 0a20 2020  bool = True,.   
-00054890: 2020 2020 206c 6162 656c 733a 2041 7272       labels: Arr
-000548a0: 6179 4c69 6b65 207c 204e 6f6e 6520 3d20  ayLike | None = 
-000548b0: 4e6f 6e65 2c0a 2020 2020 2020 2020 7072  None,.        pr
-000548c0: 6563 6973 696f 6e3a 2069 6e74 203d 2033  ecision: int = 3
-000548d0: 2c0a 2020 2020 2020 2020 696e 636c 7564  ,.        includ
-000548e0: 655f 6c6f 7765 7374 3a20 626f 6f6c 203d  e_lowest: bool =
-000548f0: 2046 616c 7365 2c0a 2020 2020 2020 2020   False,.        
-00054900: 7371 7565 657a 653a 2062 6f6f 6c20 3d20  squeeze: bool = 
-00054910: 5472 7565 2c0a 2020 2020 2020 2020 7265  True,.        re
-00054920: 7374 6f72 655f 636f 6f72 645f 6469 6d73  store_coord_dims
-00054930: 3a20 626f 6f6c 203d 2046 616c 7365 2c0a  : bool = False,.
-00054940: 2020 2020 2920 2d3e 2044 6174 6173 6574      ) -> Dataset
-00054950: 4772 6f75 7042 793a 0a20 2020 2020 2020  GroupBy:.       
-00054960: 2022 2222 5265 7475 726e 7320 6120 4461   """Returns a Da
-00054970: 7461 7365 7447 726f 7570 4279 206f 626a  tasetGroupBy obj
-00054980: 6563 7420 666f 7220 7065 7266 6f72 6d69  ect for performi
-00054990: 6e67 2067 726f 7570 6564 206f 7065 7261  ng grouped opera
-000549a0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-000549b0: 5261 7468 6572 2074 6861 6e20 7573 696e  Rather than usin
-000549c0: 6720 616c 6c20 756e 6971 7565 2076 616c  g all unique val
-000549d0: 7565 7320 6f66 2060 6772 6f75 7060 2c20  ues of `group`, 
-000549e0: 7468 6520 7661 6c75 6573 2061 7265 2064  the values are d
-000549f0: 6973 6372 6574 697a 6564 0a20 2020 2020  iscretized.     
-00054a00: 2020 2066 6972 7374 2062 7920 6170 706c     first by appl
-00054a10: 7969 6e67 2060 7061 6e64 6173 2e63 7574  ying `pandas.cut
-00054a20: 6020 5b31 5d5f 2074 6f20 6067 726f 7570  ` [1]_ to `group
-00054a30: 602e 0a0a 2020 2020 2020 2020 5061 7261  `...        Para
-00054a40: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
-00054a50: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
-00054a60: 2020 6772 6f75 7020 3a20 4861 7368 6162    group : Hashab
-00054a70: 6c65 2c20 4461 7461 4172 7261 7920 6f72  le, DataArray or
-00054a80: 2049 6e64 6578 5661 7269 6162 6c65 0a20   IndexVariable. 
-00054a90: 2020 2020 2020 2020 2020 2041 7272 6179             Array
-00054aa0: 2077 686f 7365 2062 696e 6e65 6420 7661   whose binned va
-00054ab0: 6c75 6573 2073 686f 756c 6420 6265 2075  lues should be u
-00054ac0: 7365 6420 746f 2067 726f 7570 2074 6869  sed to group thi
-00054ad0: 7320 6172 7261 792e 2049 6620 610a 2020  s array. If a.  
-00054ae0: 2020 2020 2020 2020 2020 7374 7269 6e67            string
-00054af0: 2c20 6d75 7374 2062 6520 7468 6520 6e61  , must be the na
-00054b00: 6d65 206f 6620 6120 7661 7269 6162 6c65  me of a variable
-00054b10: 2063 6f6e 7461 696e 6564 2069 6e20 7468   contained in th
-00054b20: 6973 2064 6174 6173 6574 2e0a 2020 2020  is dataset..    
-00054b30: 2020 2020 6269 6e73 203a 2069 6e74 206f      bins : int o
-00054b40: 7220 6172 7261 792d 6c69 6b65 0a20 2020  r array-like.   
-00054b50: 2020 2020 2020 2020 2049 6620 6269 6e73           If bins
-00054b60: 2069 7320 616e 2069 6e74 2c20 6974 2064   is an int, it d
-00054b70: 6566 696e 6573 2074 6865 206e 756d 6265  efines the numbe
-00054b80: 7220 6f66 2065 7175 616c 2d77 6964 7468  r of equal-width
-00054b90: 2062 696e 7320 696e 2074 6865 0a20 2020   bins in the.   
-00054ba0: 2020 2020 2020 2020 2072 616e 6765 206f           range o
-00054bb0: 6620 782e 2048 6f77 6576 6572 2c20 696e  f x. However, in
-00054bc0: 2074 6869 7320 6361 7365 2c20 7468 6520   this case, the 
-00054bd0: 7261 6e67 6520 6f66 2078 2069 7320 6578  range of x is ex
-00054be0: 7465 6e64 6564 2062 7920 2e31 250a 2020  tended by .1%.  
-00054bf0: 2020 2020 2020 2020 2020 6f6e 2065 6163            on eac
-00054c00: 6820 7369 6465 2074 6f20 696e 636c 7564  h side to includ
-00054c10: 6520 7468 6520 6d69 6e20 6f72 206d 6178  e the min or max
-00054c20: 2076 616c 7565 7320 6f66 2078 2e20 4966   values of x. If
-00054c30: 2062 696e 7320 6973 2061 0a20 2020 2020   bins is a.     
-00054c40: 2020 2020 2020 2073 6571 7565 6e63 6520         sequence 
-00054c50: 6974 2064 6566 696e 6573 2074 6865 2062  it defines the b
-00054c60: 696e 2065 6467 6573 2061 6c6c 6f77 696e  in edges allowin
-00054c70: 6720 666f 7220 6e6f 6e2d 756e 6966 6f72  g for non-unifor
-00054c80: 6d20 6269 6e0a 2020 2020 2020 2020 2020  m bin.          
-00054c90: 2020 7769 6474 682e 204e 6f20 6578 7465    width. No exte
-00054ca0: 6e73 696f 6e20 6f66 2074 6865 2072 616e  nsion of the ran
-00054cb0: 6765 206f 6620 7820 6973 2064 6f6e 6520  ge of x is done 
-00054cc0: 696e 2074 6869 7320 6361 7365 2e0a 2020  in this case..  
-00054cd0: 2020 2020 2020 7269 6768 7420 3a20 626f        right : bo
-00054ce0: 6f6c 2c20 6465 6661 756c 743a 2054 7275  ol, default: Tru
-00054cf0: 650a 2020 2020 2020 2020 2020 2020 496e  e.            In
-00054d00: 6469 6361 7465 7320 7768 6574 6865 7220  dicates whether 
-00054d10: 7468 6520 6269 6e73 2069 6e63 6c75 6465  the bins include
-00054d20: 2074 6865 2072 6967 6874 6d6f 7374 2065   the rightmost e
-00054d30: 6467 6520 6f72 206e 6f74 2e20 4966 0a20  dge or not. If. 
-00054d40: 2020 2020 2020 2020 2020 2072 6967 6874             right
-00054d50: 203d 3d20 5472 7565 2028 7468 6520 6465   == True (the de
-00054d60: 6661 756c 7429 2c20 7468 656e 2074 6865  fault), then the
-00054d70: 2062 696e 7320 5b31 2c32 2c33 2c34 5d20   bins [1,2,3,4] 
-00054d80: 696e 6469 6361 7465 0a20 2020 2020 2020  indicate.       
-00054d90: 2020 2020 2028 312c 325d 2c20 2832 2c33       (1,2], (2,3
-00054da0: 5d2c 2028 332c 345d 2e0a 2020 2020 2020  ], (3,4]..      
-00054db0: 2020 6c61 6265 6c73 203a 2061 7272 6179    labels : array
-00054dc0: 2d6c 696b 6520 6f72 2062 6f6f 6c2c 2064  -like or bool, d
-00054dd0: 6566 6175 6c74 3a20 4e6f 6e65 0a20 2020  efault: None.   
-00054de0: 2020 2020 2020 2020 2055 7365 6420 6173           Used as
-00054df0: 206c 6162 656c 7320 666f 7220 7468 6520   labels for the 
-00054e00: 7265 7375 6c74 696e 6720 6269 6e73 2e20  resulting bins. 
-00054e10: 4d75 7374 2062 6520 6f66 2074 6865 2073  Must be of the s
-00054e20: 616d 6520 6c65 6e67 7468 2061 730a 2020  ame length as.  
-00054e30: 2020 2020 2020 2020 2020 7468 6520 7265            the re
-00054e40: 7375 6c74 696e 6720 6269 6e73 2e20 4966  sulting bins. If
-00054e50: 2046 616c 7365 2c20 7374 7269 6e67 2062   False, string b
-00054e60: 696e 206c 6162 656c 7320 6172 6520 6173  in labels are as
-00054e70: 7369 676e 6564 2062 790a 2020 2020 2020  signed by.      
-00054e80: 2020 2020 2020 6070 616e 6461 732e 6375        `pandas.cu
-00054e90: 7460 2e0a 2020 2020 2020 2020 7072 6563  t`..        prec
-00054ea0: 6973 696f 6e20 3a20 696e 742c 2064 6566  ision : int, def
-00054eb0: 6175 6c74 3a20 330a 2020 2020 2020 2020  ault: 3.        
-00054ec0: 2020 2020 5468 6520 7072 6563 6973 696f      The precisio
-00054ed0: 6e20 6174 2077 6869 6368 2074 6f20 7374  n at which to st
-00054ee0: 6f72 6520 616e 6420 6469 7370 6c61 7920  ore and display 
-00054ef0: 7468 6520 6269 6e73 206c 6162 656c 732e  the bins labels.
-00054f00: 0a20 2020 2020 2020 2069 6e63 6c75 6465  .        include
-00054f10: 5f6c 6f77 6573 7420 3a20 626f 6f6c 2c20  _lowest : bool, 
-00054f20: 6465 6661 756c 743a 2046 616c 7365 0a20  default: False. 
-00054f30: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
-00054f40: 6572 2074 6865 2066 6972 7374 2069 6e74  er the first int
-00054f50: 6572 7661 6c20 7368 6f75 6c64 2062 6520  erval should be 
-00054f60: 6c65 6674 2d69 6e63 6c75 7369 7665 206f  left-inclusive o
-00054f70: 7220 6e6f 742e 0a20 2020 2020 2020 2073  r not..        s
-00054f80: 7175 6565 7a65 203a 2062 6f6f 6c2c 2064  queeze : bool, d
-00054f90: 6566 6175 6c74 3a20 5472 7565 0a20 2020  efault: True.   
-00054fa0: 2020 2020 2020 2020 2049 6620 2267 726f           If "gro
-00054fb0: 7570 2220 6973 2061 2064 696d 656e 7369  up" is a dimensi
-00054fc0: 6f6e 206f 6620 616e 7920 6172 7261 7973  on of any arrays
-00054fd0: 2069 6e20 7468 6973 2064 6174 6173 6574   in this dataset
-00054fe0: 2c20 6073 7175 6565 7a65 600a 2020 2020  , `squeeze`.    
-00054ff0: 2020 2020 2020 2020 636f 6e74 726f 6c73          controls
-00055000: 2077 6865 7468 6572 2074 6865 2073 7562   whether the sub
-00055010: 6172 7261 7973 2068 6176 6520 6120 6469  arrays have a di
-00055020: 6d65 6e73 696f 6e20 6f66 206c 656e 6774  mension of lengt
-00055030: 6820 3120 616c 6f6e 670a 2020 2020 2020  h 1 along.      
-00055040: 2020 2020 2020 7468 6174 2064 696d 656e        that dimen
-00055050: 7369 6f6e 206f 7220 6966 2074 6865 2064  sion or if the d
-00055060: 696d 656e 7369 6f6e 2069 7320 7371 7565  imension is sque
-00055070: 657a 6564 206f 7574 2e0a 2020 2020 2020  ezed out..      
-00055080: 2020 7265 7374 6f72 655f 636f 6f72 645f    restore_coord_
-00055090: 6469 6d73 203a 2062 6f6f 6c2c 2064 6566  dims : bool, def
-000550a0: 6175 6c74 3a20 4661 6c73 650a 2020 2020  ault: False.    
-000550b0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
-000550c0: 2061 6c73 6f20 7265 7374 6f72 6520 7468   also restore th
-000550d0: 6520 6469 6d65 6e73 696f 6e20 6f72 6465  e dimension orde
-000550e0: 7220 6f66 206d 756c 7469 2d64 696d 656e  r of multi-dimen
-000550f0: 7369 6f6e 616c 0a20 2020 2020 2020 2020  sional.         
-00055100: 2020 2063 6f6f 7264 696e 6174 6573 2e0a     coordinates..
-00055110: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00055120: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00055130: 0a20 2020 2020 2020 2067 726f 7570 6564  .        grouped
-00055140: 203a 2044 6174 6173 6574 4772 6f75 7042   : DatasetGroupB
-00055150: 790a 2020 2020 2020 2020 2020 2020 4120  y.            A 
-00055160: 6044 6174 6173 6574 4772 6f75 7042 7960  `DatasetGroupBy`
-00055170: 206f 626a 6563 7420 7061 7474 6572 6e65   object patterne
-00055180: 6420 6166 7465 7220 6070 616e 6461 732e  d after `pandas.
-00055190: 4772 6f75 7042 7960 2074 6861 7420 6361  GroupBy` that ca
-000551a0: 6e20 6265 0a20 2020 2020 2020 2020 2020  n be.           
-000551b0: 2069 7465 7261 7465 6420 6f76 6572 2069   iterated over i
-000551c0: 6e20 7468 6520 666f 726d 206f 6620 6028  n the form of `(
-000551d0: 756e 6971 7565 5f76 616c 7565 2c20 6772  unique_value, gr
-000551e0: 6f75 7065 645f 6172 7261 7929 6020 7061  ouped_array)` pa
-000551f0: 6972 732e 0a20 2020 2020 2020 2020 2020  irs..           
-00055200: 2054 6865 206e 616d 6520 6f66 2074 6865   The name of the
-00055210: 2067 726f 7570 2068 6173 2074 6865 2061   group has the a
-00055220: 6464 6564 2073 7566 6669 7820 605f 6269  dded suffix `_bi
-00055230: 6e73 6020 696e 206f 7264 6572 2074 6f0a  ns` in order to.
-00055240: 2020 2020 2020 2020 2020 2020 6469 7374              dist
-00055250: 696e 6775 6973 6820 6974 2066 726f 6d20  inguish it from 
-00055260: 7468 6520 6f72 6967 696e 616c 2076 6172  the original var
-00055270: 6961 626c 652e 0a0a 2020 2020 2020 2020  iable...        
-00055280: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
-00055290: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
-000552a0: 2020 3a72 6566 3a60 6772 6f75 7062 7960    :ref:`groupby`
-000552b0: 0a20 2020 2020 2020 2020 2020 2055 7365  .            Use
-000552c0: 7273 2067 7569 6465 2065 7870 6c61 6e61  rs guide explana
-000552d0: 7469 6f6e 206f 6620 686f 7720 746f 2067  tion of how to g
-000552e0: 726f 7570 2061 6e64 2062 696e 2064 6174  roup and bin dat
-000552f0: 612e 0a20 2020 2020 2020 2044 6174 6173  a..        Datas
-00055300: 6574 2e67 726f 7570 6279 0a20 2020 2020  et.groupby.     
-00055310: 2020 2044 6174 6141 7272 6179 2e67 726f     DataArray.gro
-00055320: 7570 6279 5f62 696e 730a 2020 2020 2020  upby_bins.      
-00055330: 2020 636f 7265 2e67 726f 7570 6279 2e44    core.groupby.D
-00055340: 6174 6173 6574 4772 6f75 7042 790a 2020  atasetGroupBy.  
-00055350: 2020 2020 2020 7061 6e64 6173 2e44 6174        pandas.Dat
-00055360: 6146 7261 6d65 2e67 726f 7570 6279 0a0a  aFrame.groupby..
-00055370: 2020 2020 2020 2020 5265 6665 7265 6e63          Referenc
-00055380: 6573 0a20 2020 2020 2020 202d 2d2d 2d2d  es.        -----
-00055390: 2d2d 2d2d 2d0a 2020 2020 2020 2020 2e2e  -----.        ..
-000553a0: 205b 315d 2068 7474 703a 2f2f 7061 6e64   [1] http://pand
-000553b0: 6173 2e70 7964 6174 612e 6f72 672f 7061  as.pydata.org/pa
-000553c0: 6e64 6173 2d64 6f63 732f 7374 6162 6c65  ndas-docs/stable
-000553d0: 2f67 656e 6572 6174 6564 2f70 616e 6461  /generated/panda
-000553e0: 732e 6375 742e 6874 6d6c 0a20 2020 2020  s.cut.html.     
-000553f0: 2020 2022 2222 0a20 2020 2020 2020 2066     """.        f
-00055400: 726f 6d20 7861 7272 6179 2e63 6f72 652e  rom xarray.core.
-00055410: 6772 6f75 7062 7920 696d 706f 7274 2028  groupby import (
-00055420: 0a20 2020 2020 2020 2020 2020 2042 696e  .            Bin
-00055430: 4772 6f75 7065 722c 0a20 2020 2020 2020  Grouper,.       
-00055440: 2020 2020 2044 6174 6173 6574 4772 6f75       DatasetGrou
-00055450: 7042 792c 0a20 2020 2020 2020 2020 2020  pBy,.           
-00055460: 2052 6573 6f6c 7665 6442 696e 4772 6f75   ResolvedBinGrou
-00055470: 7065 722c 0a20 2020 2020 2020 2020 2020  per,.           
-00055480: 205f 7661 6c69 6461 7465 5f67 726f 7570   _validate_group
-00055490: 6279 5f73 7175 6565 7a65 2c0a 2020 2020  by_squeeze,.    
-000554a0: 2020 2020 290a 0a20 2020 2020 2020 205f      )..        _
-000554b0: 7661 6c69 6461 7465 5f67 726f 7570 6279  validate_groupby
-000554c0: 5f73 7175 6565 7a65 2873 7175 6565 7a65  _squeeze(squeeze
-000554d0: 290a 2020 2020 2020 2020 6772 6f75 7065  ).        groupe
-000554e0: 7220 3d20 4269 6e47 726f 7570 6572 280a  r = BinGrouper(.
-000554f0: 2020 2020 2020 2020 2020 2020 6269 6e73              bins
-00055500: 3d62 696e 732c 0a20 2020 2020 2020 2020  =bins,.         
-00055510: 2020 2063 7574 5f6b 7761 7267 733d 7b0a     cut_kwargs={.
-00055520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055530: 2272 6967 6874 223a 2072 6967 6874 2c0a  "right": right,.
-00055540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00055550: 226c 6162 656c 7322 3a20 6c61 6265 6c73  "labels": labels
-00055560: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00055570: 2020 2270 7265 6369 7369 6f6e 223a 2070    "precision": p
-00055580: 7265 6369 7369 6f6e 2c0a 2020 2020 2020  recision,.      
-00055590: 2020 2020 2020 2020 2020 2269 6e63 6c75            "inclu
-000555a0: 6465 5f6c 6f77 6573 7422 3a20 696e 636c  de_lowest": incl
-000555b0: 7564 655f 6c6f 7765 7374 2c0a 2020 2020  ude_lowest,.    
-000555c0: 2020 2020 2020 2020 7d2c 0a20 2020 2020          },.     
-000555d0: 2020 2029 0a20 2020 2020 2020 2072 6772     ).        rgr
-000555e0: 6f75 7065 7220 3d20 5265 736f 6c76 6564  ouper = Resolved
-000555f0: 4269 6e47 726f 7570 6572 2867 726f 7570  BinGrouper(group
-00055600: 6572 2c20 6772 6f75 702c 2073 656c 6629  er, group, self)
-00055610: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-00055620: 2044 6174 6173 6574 4772 6f75 7042 7928   DatasetGroupBy(
-00055630: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00055640: 662c 0a20 2020 2020 2020 2020 2020 2028  f,.            (
-00055650: 7267 726f 7570 6572 2c29 2c0a 2020 2020  rgrouper,),.    
-00055660: 2020 2020 2020 2020 7371 7565 657a 653d          squeeze=
-00055670: 7371 7565 657a 652c 0a20 2020 2020 2020  squeeze,.       
-00055680: 2020 2020 2072 6573 746f 7265 5f63 6f6f       restore_coo
-00055690: 7264 5f64 696d 733d 7265 7374 6f72 655f  rd_dims=restore_
-000556a0: 636f 6f72 645f 6469 6d73 2c0a 2020 2020  coord_dims,.    
-000556b0: 2020 2020 290a 0a20 2020 2064 6566 2077      )..    def w
-000556c0: 6569 6768 7465 6428 7365 6c66 2c20 7765  eighted(self, we
-000556d0: 6967 6874 733a 2044 6174 6141 7272 6179  ights: DataArray
-000556e0: 2920 2d3e 2044 6174 6173 6574 5765 6967  ) -> DatasetWeig
-000556f0: 6874 6564 3a0a 2020 2020 2020 2020 2222  hted:.        ""
-00055700: 220a 2020 2020 2020 2020 5765 6967 6874  ".        Weight
-00055710: 6564 2044 6174 6173 6574 206f 7065 7261  ed Dataset opera
-00055720: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-00055730: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
-00055740: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
-00055750: 2020 2020 2020 7765 6967 6874 7320 3a20        weights : 
-00055760: 4461 7461 4172 7261 790a 2020 2020 2020  DataArray.      
-00055770: 2020 2020 2020 416e 2061 7272 6179 206f        An array o
-00055780: 6620 7765 6967 6874 7320 6173 736f 6369  f weights associ
-00055790: 6174 6564 2077 6974 6820 7468 6520 7661  ated with the va
-000557a0: 6c75 6573 2069 6e20 7468 6973 2044 6174  lues in this Dat
-000557b0: 6173 6574 2e0a 2020 2020 2020 2020 2020  aset..          
-000557c0: 2020 4561 6368 2076 616c 7565 2069 6e20    Each value in 
-000557d0: 7468 6520 6461 7461 2063 6f6e 7472 6962  the data contrib
-000557e0: 7574 6573 2074 6f20 7468 6520 7265 6475  utes to the redu
-000557f0: 6374 696f 6e20 6f70 6572 6174 696f 6e0a  ction operation.
-00055800: 2020 2020 2020 2020 2020 2020 6163 636f              acco
-00055810: 7264 696e 6720 746f 2069 7473 2061 7373  rding to its ass
-00055820: 6f63 6961 7465 6420 7765 6967 6874 2e0a  ociated weight..
-00055830: 0a20 2020 2020 2020 204e 6f74 6573 0a20  .        Notes. 
-00055840: 2020 2020 2020 202d 2d2d 2d2d 0a20 2020         -----.   
-00055850: 2020 2020 2060 6077 6569 6768 7473 6060       ``weights``
-00055860: 206d 7573 7420 6265 2061 2044 6174 6141   must be a DataA
-00055870: 7272 6179 2061 6e64 2063 616e 6e6f 7420  rray and cannot 
-00055880: 636f 6e74 6169 6e20 6d69 7373 696e 6720  contain missing 
-00055890: 7661 6c75 6573 2e0a 2020 2020 2020 2020  values..        
-000558a0: 4d69 7373 696e 6720 7661 6c75 6573 2063  Missing values c
-000558b0: 616e 2062 6520 7265 706c 6163 6564 2062  an be replaced b
-000558c0: 7920 6060 7765 6967 6874 732e 6669 6c6c  y ``weights.fill
-000558d0: 6e61 2830 2960 602e 0a0a 2020 2020 2020  na(0)``...      
-000558e0: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-000558f0: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-00055900: 2020 636f 7265 2e77 6569 6768 7465 642e    core.weighted.
-00055910: 4461 7461 7365 7457 6569 6768 7465 640a  DatasetWeighted.
-00055920: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
-00055930: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
-00055940: 2d2d 0a20 2020 2020 2020 2044 6174 6141  --.        DataA
-00055950: 7272 6179 2e77 6569 6768 7465 640a 2020  rray.weighted.  
-00055960: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00055970: 2020 6672 6f6d 2078 6172 7261 792e 636f    from xarray.co
-00055980: 7265 2e77 6569 6768 7465 6420 696d 706f  re.weighted impo
-00055990: 7274 2044 6174 6173 6574 5765 6967 6874  rt DatasetWeight
-000559a0: 6564 0a0a 2020 2020 2020 2020 7265 7475  ed..        retu
-000559b0: 726e 2044 6174 6173 6574 5765 6967 6874  rn DatasetWeight
-000559c0: 6564 2873 656c 662c 2077 6569 6768 7473  ed(self, weights
-000559d0: 290a 0a20 2020 2064 6566 2072 6f6c 6c69  )..    def rolli
-000559e0: 6e67 280a 2020 2020 2020 2020 7365 6c66  ng(.        self
-000559f0: 2c0a 2020 2020 2020 2020 6469 6d3a 204d  ,.        dim: M
-00055a00: 6170 7069 6e67 5b41 6e79 2c20 696e 745d  apping[Any, int]
-00055a10: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c0a   | None = None,.
-00055a20: 2020 2020 2020 2020 6d69 6e5f 7065 7269          min_peri
-00055a30: 6f64 733a 2069 6e74 207c 204e 6f6e 6520  ods: int | None 
-00055a40: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00055a50: 6365 6e74 6572 3a20 626f 6f6c 207c 204d  center: bool | M
-00055a60: 6170 7069 6e67 5b41 6e79 2c20 626f 6f6c  apping[Any, bool
-00055a70: 5d20 3d20 4661 6c73 652c 0a20 2020 2020  ] = False,.     
-00055a80: 2020 202a 2a77 696e 646f 775f 6b77 6172     **window_kwar
-00055a90: 6773 3a20 696e 742c 0a20 2020 2029 202d  gs: int,.    ) -
-00055aa0: 3e20 4461 7461 7365 7452 6f6c 6c69 6e67  > DatasetRolling
-00055ab0: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
-00055ac0: 2020 2020 2020 526f 6c6c 696e 6720 7769        Rolling wi
-00055ad0: 6e64 6f77 206f 626a 6563 7420 666f 7220  ndow object for 
-00055ae0: 4461 7461 7365 7473 2e0a 0a20 2020 2020  Datasets...     
-00055af0: 2020 2050 6172 616d 6574 6572 730a 2020     Parameters.  
-00055b00: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00055b10: 0a20 2020 2020 2020 2064 696d 203a 2064  .        dim : d
-00055b20: 6963 742c 206f 7074 696f 6e61 6c0a 2020  ict, optional.  
-00055b30: 2020 2020 2020 2020 2020 4d61 7070 696e            Mappin
-00055b40: 6720 6672 6f6d 2074 6865 2064 696d 656e  g from the dimen
-00055b50: 7369 6f6e 206e 616d 6520 746f 2063 7265  sion name to cre
-00055b60: 6174 6520 7468 6520 726f 6c6c 696e 6720  ate the rolling 
-00055b70: 6974 6572 6174 6f72 0a20 2020 2020 2020  iterator.       
-00055b80: 2020 2020 2061 6c6f 6e67 2028 652e 672e       along (e.g.
-00055b90: 2060 7469 6d65 6029 2074 6f20 6974 7320   `time`) to its 
-00055ba0: 6d6f 7669 6e67 2077 696e 646f 7720 7369  moving window si
-00055bb0: 7a65 2e0a 2020 2020 2020 2020 6d69 6e5f  ze..        min_
-00055bc0: 7065 7269 6f64 7320 3a20 696e 7420 6f72  periods : int or
-00055bd0: 204e 6f6e 652c 2064 6566 6175 6c74 3a20   None, default: 
-00055be0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00055bf0: 204d 696e 696d 756d 206e 756d 6265 7220   Minimum number 
-00055c00: 6f66 206f 6273 6572 7661 7469 6f6e 7320  of observations 
-00055c10: 696e 2077 696e 646f 7720 7265 7175 6972  in window requir
-00055c20: 6564 2074 6f20 6861 7665 2061 2076 616c  ed to have a val
-00055c30: 7565 0a20 2020 2020 2020 2020 2020 2028  ue.            (
-00055c40: 6f74 6865 7277 6973 6520 7265 7375 6c74  otherwise result
-00055c50: 2069 7320 4e41 292e 2054 6865 2064 6566   is NA). The def
-00055c60: 6175 6c74 2c20 4e6f 6e65 2c20 6973 2065  ault, None, is e
-00055c70: 7175 6976 616c 656e 7420 746f 0a20 2020  quivalent to.   
-00055c80: 2020 2020 2020 2020 2073 6574 7469 6e67           setting
-00055c90: 206d 696e 5f70 6572 696f 6473 2065 7175   min_periods equ
-00055ca0: 616c 2074 6f20 7468 6520 7369 7a65 206f  al to the size o
-00055cb0: 6620 7468 6520 7769 6e64 6f77 2e0a 2020  f the window..  
-00055cc0: 2020 2020 2020 6365 6e74 6572 203a 2062        center : b
-00055cd0: 6f6f 6c20 6f72 204d 6170 7069 6e67 2074  ool or Mapping t
-00055ce0: 6f20 696e 742c 2064 6566 6175 6c74 3a20  o int, default: 
-00055cf0: 4661 6c73 650a 2020 2020 2020 2020 2020  False.          
-00055d00: 2020 5365 7420 7468 6520 6c61 6265 6c73    Set the labels
-00055d10: 2061 7420 7468 6520 6365 6e74 6572 206f   at the center o
-00055d20: 6620 7468 6520 7769 6e64 6f77 2e0a 2020  f the window..  
-00055d30: 2020 2020 2020 2a2a 7769 6e64 6f77 5f6b        **window_k
-00055d40: 7761 7267 7320 3a20 6f70 7469 6f6e 616c  wargs : optional
-00055d50: 0a20 2020 2020 2020 2020 2020 2054 6865  .            The
-00055d60: 206b 6579 776f 7264 2061 7267 756d 656e   keyword argumen
-00055d70: 7473 2066 6f72 6d20 6f66 2060 6064 696d  ts form of ``dim
-00055d80: 6060 2e0a 2020 2020 2020 2020 2020 2020  ``..            
-00055d90: 4f6e 6520 6f66 2064 696d 206f 7220 7769  One of dim or wi
-00055da0: 6e64 6f77 5f6b 7761 7267 7320 6d75 7374  ndow_kwargs must
-00055db0: 2062 6520 7072 6f76 6964 6564 2e0a 0a20   be provided... 
-00055dc0: 2020 2020 2020 2052 6574 7572 6e73 0a20         Returns. 
-00055dd0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0a20         -------. 
-00055de0: 2020 2020 2020 2063 6f72 652e 726f 6c6c         core.roll
-00055df0: 696e 672e 4461 7461 7365 7452 6f6c 6c69  ing.DatasetRolli
-00055e00: 6e67 0a0a 2020 2020 2020 2020 5365 6520  ng..        See 
-00055e10: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
-00055e20: 2d2d 2d2d 2d0a 2020 2020 2020 2020 636f  -----.        co
-00055e30: 7265 2e72 6f6c 6c69 6e67 2e44 6174 6173  re.rolling.Datas
-00055e40: 6574 526f 6c6c 696e 670a 2020 2020 2020  etRolling.      
-00055e50: 2020 4461 7461 4172 7261 792e 726f 6c6c    DataArray.roll
-00055e60: 696e 670a 2020 2020 2020 2020 2222 220a  ing.        """.
-00055e70: 2020 2020 2020 2020 6672 6f6d 2078 6172          from xar
-00055e80: 7261 792e 636f 7265 2e72 6f6c 6c69 6e67  ray.core.rolling
-00055e90: 2069 6d70 6f72 7420 4461 7461 7365 7452   import DatasetR
-00055ea0: 6f6c 6c69 6e67 0a0a 2020 2020 2020 2020  olling..        
-00055eb0: 6469 6d20 3d20 6569 7468 6572 5f64 6963  dim = either_dic
-00055ec0: 745f 6f72 5f6b 7761 7267 7328 6469 6d2c  t_or_kwargs(dim,
-00055ed0: 2077 696e 646f 775f 6b77 6172 6773 2c20   window_kwargs, 
-00055ee0: 2272 6f6c 6c69 6e67 2229 0a20 2020 2020  "rolling").     
-00055ef0: 2020 2072 6574 7572 6e20 4461 7461 7365     return Datase
-00055f00: 7452 6f6c 6c69 6e67 2873 656c 662c 2064  tRolling(self, d
-00055f10: 696d 2c20 6d69 6e5f 7065 7269 6f64 733d  im, min_periods=
-00055f20: 6d69 6e5f 7065 7269 6f64 732c 2063 656e  min_periods, cen
-00055f30: 7465 723d 6365 6e74 6572 290a 0a20 2020  ter=center)..   
-00055f40: 2064 6566 2063 6f61 7273 656e 280a 2020   def coarsen(.  
-00055f50: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00055f60: 2020 2020 6469 6d3a 204d 6170 7069 6e67      dim: Mapping
-00055f70: 5b41 6e79 2c20 696e 745d 207c 204e 6f6e  [Any, int] | Non
-00055f80: 6520 3d20 4e6f 6e65 2c0a 2020 2020 2020  e = None,.      
-00055f90: 2020 626f 756e 6461 7279 3a20 436f 6172    boundary: Coar
-00055fa0: 7365 6e42 6f75 6e64 6172 794f 7074 696f  senBoundaryOptio
-00055fb0: 6e73 203d 2022 6578 6163 7422 2c0a 2020  ns = "exact",.  
-00055fc0: 2020 2020 2020 7369 6465 3a20 5369 6465        side: Side
-00055fd0: 4f70 7469 6f6e 7320 7c20 4d61 7070 696e  Options | Mappin
-00055fe0: 675b 416e 792c 2053 6964 654f 7074 696f  g[Any, SideOptio
-00055ff0: 6e73 5d20 3d20 226c 6566 7422 2c0a 2020  ns] = "left",.  
-00056000: 2020 2020 2020 636f 6f72 645f 6675 6e63        coord_func
-00056010: 3a20 7374 7220 7c20 4361 6c6c 6162 6c65  : str | Callable
-00056020: 207c 204d 6170 7069 6e67 5b41 6e79 2c20   | Mapping[Any, 
-00056030: 7374 7220 7c20 4361 6c6c 6162 6c65 5d20  str | Callable] 
-00056040: 3d20 226d 6561 6e22 2c0a 2020 2020 2020  = "mean",.      
-00056050: 2020 2a2a 7769 6e64 6f77 5f6b 7761 7267    **window_kwarg
-00056060: 733a 2069 6e74 2c0a 2020 2020 2920 2d3e  s: int,.    ) ->
-00056070: 2044 6174 6173 6574 436f 6172 7365 6e3a   DatasetCoarsen:
-00056080: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00056090: 2020 2020 2043 6f61 7273 656e 206f 626a       Coarsen obj
-000560a0: 6563 7420 666f 7220 4461 7461 7365 7473  ect for Datasets
-000560b0: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-000560c0: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
-000560d0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
-000560e0: 2064 696d 203a 206d 6170 7069 6e67 206f   dim : mapping o
-000560f0: 6620 6861 7368 6162 6c65 2074 6f20 696e  f hashable to in
-00056100: 742c 206f 7074 696f 6e61 6c0a 2020 2020  t, optional.    
-00056110: 2020 2020 2020 2020 4d61 7070 696e 6720          Mapping 
-00056120: 6672 6f6d 2074 6865 2064 696d 656e 7369  from the dimensi
-00056130: 6f6e 206e 616d 6520 746f 2074 6865 2077  on name to the w
-00056140: 696e 646f 7720 7369 7a65 2e0a 2020 2020  indow size..    
-00056150: 2020 2020 626f 756e 6461 7279 203a 207b      boundary : {
-00056160: 2265 7861 6374 222c 2022 7472 696d 222c  "exact", "trim",
-00056170: 2022 7061 6422 7d2c 2064 6566 6175 6c74   "pad"}, default
-00056180: 3a20 2265 7861 6374 220a 2020 2020 2020  : "exact".      
-00056190: 2020 2020 2020 4966 2027 6578 6163 7427        If 'exact'
-000561a0: 2c20 6120 5661 6c75 6545 7272 6f72 2077  , a ValueError w
-000561b0: 696c 6c20 6265 2072 6169 7365 6420 6966  ill be raised if
-000561c0: 2064 696d 656e 7369 6f6e 2073 697a 6520   dimension size 
-000561d0: 6973 206e 6f74 2061 0a20 2020 2020 2020  is not a.       
-000561e0: 2020 2020 206d 756c 7469 706c 6520 6f66       multiple of
-000561f0: 2074 6865 2077 696e 646f 7720 7369 7a65   the window size
-00056200: 2e20 4966 2027 7472 696d 272c 2074 6865  . If 'trim', the
-00056210: 2065 7863 6573 7320 656e 7472 6965 7320   excess entries 
-00056220: 6172 650a 2020 2020 2020 2020 2020 2020  are.            
-00056230: 6472 6f70 7065 642e 2049 6620 2770 6164  dropped. If 'pad
-00056240: 272c 204e 4120 7769 6c6c 2062 6520 7061  ', NA will be pa
-00056250: 6464 6564 2e0a 2020 2020 2020 2020 7369  dded..        si
-00056260: 6465 203a 207b 226c 6566 7422 2c20 2272  de : {"left", "r
-00056270: 6967 6874 227d 206f 7220 6d61 7070 696e  ight"} or mappin
-00056280: 6720 6f66 2073 7472 2074 6f20 7b22 6c65  g of str to {"le
-00056290: 6674 222c 2022 7269 6768 7422 7d2c 2064  ft", "right"}, d
-000562a0: 6566 6175 6c74 3a20 226c 6566 7422 0a20  efault: "left". 
-000562b0: 2020 2020 2020 2063 6f6f 7264 5f66 756e         coord_fun
-000562c0: 6320 3a20 7374 7220 6f72 206d 6170 7069  c : str or mappi
-000562d0: 6e67 206f 6620 6861 7368 6162 6c65 2074  ng of hashable t
-000562e0: 6f20 7374 722c 2064 6566 6175 6c74 3a20  o str, default: 
-000562f0: 226d 6561 6e22 0a20 2020 2020 2020 2020  "mean".         
-00056300: 2020 2066 756e 6374 696f 6e20 286e 616d     function (nam
-00056310: 6529 2074 6861 7420 6973 2061 7070 6c69  e) that is appli
-00056320: 6564 2074 6f20 7468 6520 636f 6f72 6469  ed to the coordi
-00056330: 6e61 7465 732c 0a20 2020 2020 2020 2020  nates,.         
-00056340: 2020 206f 7220 6120 6d61 7070 696e 6720     or a mapping 
-00056350: 6672 6f6d 2063 6f6f 7264 696e 6174 6520  from coordinate 
-00056360: 6e61 6d65 2074 6f20 6675 6e63 7469 6f6e  name to function
-00056370: 2028 6e61 6d65 292e 0a0a 2020 2020 2020   (name)...      
-00056380: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
-00056390: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
-000563a0: 2020 636f 7265 2e72 6f6c 6c69 6e67 2e44    core.rolling.D
-000563b0: 6174 6173 6574 436f 6172 7365 6e0a 0a20  atasetCoarsen.. 
-000563c0: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
-000563d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-000563e0: 0a20 2020 2020 2020 2063 6f72 652e 726f  .        core.ro
-000563f0: 6c6c 696e 672e 4461 7461 7365 7443 6f61  lling.DatasetCoa
-00056400: 7273 656e 0a20 2020 2020 2020 2044 6174  rsen.        Dat
-00056410: 6141 7272 6179 2e63 6f61 7273 656e 0a20  aArray.coarsen. 
-00056420: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00056430: 2020 2066 726f 6d20 7861 7272 6179 2e63     from xarray.c
-00056440: 6f72 652e 726f 6c6c 696e 6720 696d 706f  ore.rolling impo
-00056450: 7274 2044 6174 6173 6574 436f 6172 7365  rt DatasetCoarse
-00056460: 6e0a 0a20 2020 2020 2020 2064 696d 203d  n..        dim =
-00056470: 2065 6974 6865 725f 6469 6374 5f6f 725f   either_dict_or_
-00056480: 6b77 6172 6773 2864 696d 2c20 7769 6e64  kwargs(dim, wind
-00056490: 6f77 5f6b 7761 7267 732c 2022 636f 6172  ow_kwargs, "coar
-000564a0: 7365 6e22 290a 2020 2020 2020 2020 7265  sen").        re
-000564b0: 7475 726e 2044 6174 6173 6574 436f 6172  turn DatasetCoar
-000564c0: 7365 6e28 0a20 2020 2020 2020 2020 2020  sen(.           
-000564d0: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
-000564e0: 2020 2064 696d 2c0a 2020 2020 2020 2020     dim,.        
-000564f0: 2020 2020 626f 756e 6461 7279 3d62 6f75      boundary=bou
-00056500: 6e64 6172 792c 0a20 2020 2020 2020 2020  ndary,.         
-00056510: 2020 2073 6964 653d 7369 6465 2c0a 2020     side=side,.  
-00056520: 2020 2020 2020 2020 2020 636f 6f72 645f            coord_
-00056530: 6675 6e63 3d63 6f6f 7264 5f66 756e 632c  func=coord_func,
-00056540: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00056550: 6465 6620 7265 7361 6d70 6c65 280a 2020  def resample(.  
-00056560: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00056570: 2020 2020 696e 6465 7865 723a 204d 6170      indexer: Map
-00056580: 7069 6e67 5b41 6e79 2c20 7374 725d 207c  ping[Any, str] |
-00056590: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
-000565a0: 2020 2020 2020 736b 6970 6e61 3a20 626f        skipna: bo
-000565b0: 6f6c 207c 204e 6f6e 6520 3d20 4e6f 6e65  ol | None = None
-000565c0: 2c0a 2020 2020 2020 2020 636c 6f73 6564  ,.        closed
-000565d0: 3a20 5369 6465 4f70 7469 6f6e 7320 7c20  : SideOptions | 
-000565e0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
-000565f0: 2020 2020 206c 6162 656c 3a20 5369 6465       label: Side
-00056600: 4f70 7469 6f6e 7320 7c20 4e6f 6e65 203d  Options | None =
-00056610: 204e 6f6e 652c 0a20 2020 2020 2020 2062   None,.        b
-00056620: 6173 653a 2069 6e74 207c 204e 6f6e 6520  ase: int | None 
-00056630: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00056640: 6f66 6673 6574 3a20 7064 2e54 696d 6564  offset: pd.Timed
-00056650: 656c 7461 207c 2064 6174 6574 696d 652e  elta | datetime.
-00056660: 7469 6d65 6465 6c74 6120 7c20 7374 7220  timedelta | str 
-00056670: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
-00056680: 2020 2020 2020 206f 7269 6769 6e3a 2073         origin: s
-00056690: 7472 207c 2044 6174 6574 696d 654c 696b  tr | DatetimeLik
-000566a0: 6520 3d20 2273 7461 7274 5f64 6179 222c  e = "start_day",
-000566b0: 0a20 2020 2020 2020 206b 6565 705f 6174  .        keep_at
-000566c0: 7472 733a 2062 6f6f 6c20 7c20 4e6f 6e65  trs: bool | None
-000566d0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-000566e0: 206c 6f66 6673 6574 3a20 6461 7465 7469   loffset: dateti
-000566f0: 6d65 2e74 696d 6564 656c 7461 207c 2073  me.timedelta | s
-00056700: 7472 207c 204e 6f6e 6520 3d20 4e6f 6e65  tr | None = None
-00056710: 2c0a 2020 2020 2020 2020 7265 7374 6f72  ,.        restor
-00056720: 655f 636f 6f72 645f 6469 6d73 3a20 626f  e_coord_dims: bo
-00056730: 6f6c 207c 204e 6f6e 6520 3d20 4e6f 6e65  ol | None = None
-00056740: 2c0a 2020 2020 2020 2020 2a2a 696e 6465  ,.        **inde
-00056750: 7865 725f 6b77 6172 6773 3a20 7374 722c  xer_kwargs: str,
-00056760: 0a20 2020 2029 202d 3e20 4461 7461 7365  .    ) -> Datase
-00056770: 7452 6573 616d 706c 653a 0a20 2020 2020  tResample:.     
-00056780: 2020 2022 2222 5265 7475 726e 7320 6120     """Returns a 
-00056790: 5265 7361 6d70 6c65 206f 626a 6563 7420  Resample object 
-000567a0: 666f 7220 7065 7266 6f72 6d69 6e67 2072  for performing r
-000567b0: 6573 616d 706c 696e 6720 6f70 6572 6174  esampling operat
-000567c0: 696f 6e73 2e0a 0a20 2020 2020 2020 2048  ions...        H
-000567d0: 616e 646c 6573 2062 6f74 6820 646f 776e  andles both down
-000567e0: 7361 6d70 6c69 6e67 2061 6e64 2075 7073  sampling and ups
-000567f0: 616d 706c 696e 672e 2054 6865 2072 6573  ampling. The res
-00056800: 616d 706c 6564 0a20 2020 2020 2020 2064  ampled.        d
-00056810: 696d 656e 7369 6f6e 206d 7573 7420 6265  imension must be
-00056820: 2061 2064 6174 6574 696d 652d 6c69 6b65   a datetime-like
-00056830: 2063 6f6f 7264 696e 6174 652e 2049 6620   coordinate. If 
-00056840: 616e 7920 696e 7465 7276 616c 730a 2020  any intervals.  
-00056850: 2020 2020 2020 636f 6e74 6169 6e20 6e6f        contain no
-00056860: 2076 616c 7565 7320 6672 6f6d 2074 6865   values from the
-00056870: 206f 7269 6769 6e61 6c20 6f62 6a65 6374   original object
-00056880: 2c20 7468 6579 2077 696c 6c20 6265 2067  , they will be g
-00056890: 6976 656e 0a20 2020 2020 2020 2074 6865  iven.        the
-000568a0: 2076 616c 7565 2060 604e 614e 6060 2e0a   value ``NaN``..
-000568b0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-000568c0: 6572 730a 2020 2020 2020 2020 2d2d 2d2d  ers.        ----
-000568d0: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2069  ------.        i
-000568e0: 6e64 6578 6572 203a 204d 6170 7069 6e67  ndexer : Mapping
-000568f0: 206f 6620 4861 7368 6162 6c65 2074 6f20   of Hashable to 
-00056900: 7374 722c 206f 7074 696f 6e61 6c0a 2020  str, optional.  
-00056910: 2020 2020 2020 2020 2020 4d61 7070 696e            Mappin
-00056920: 6720 6672 6f6d 2074 6865 2064 696d 656e  g from the dimen
-00056930: 7369 6f6e 206e 616d 6520 746f 2072 6573  sion name to res
-00056940: 616d 706c 6520 6672 6571 7565 6e63 7920  ample frequency 
-00056950: 5b31 5d5f 2e20 5468 650a 2020 2020 2020  [1]_. The.      
-00056960: 2020 2020 2020 6469 6d65 6e73 696f 6e20        dimension 
-00056970: 6d75 7374 2062 6520 6461 7465 7469 6d65  must be datetime
-00056980: 2d6c 696b 652e 0a20 2020 2020 2020 2073  -like..        s
-00056990: 6b69 706e 6120 3a20 626f 6f6c 2c20 6f70  kipna : bool, op
-000569a0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-000569b0: 2020 2057 6865 7468 6572 2074 6f20 736b     Whether to sk
-000569c0: 6970 206d 6973 7369 6e67 2076 616c 7565  ip missing value
-000569d0: 7320 7768 656e 2061 6767 7265 6761 7469  s when aggregati
-000569e0: 6e67 2069 6e20 646f 776e 7361 6d70 6c69  ng in downsampli
-000569f0: 6e67 2e0a 2020 2020 2020 2020 636c 6f73  ng..        clos
-00056a00: 6564 203a 207b 226c 6566 7422 2c20 2272  ed : {"left", "r
-00056a10: 6967 6874 227d 2c20 6f70 7469 6f6e 616c  ight"}, optional
-00056a20: 0a20 2020 2020 2020 2020 2020 2053 6964  .            Sid
-00056a30: 6520 6f66 2065 6163 6820 696e 7465 7276  e of each interv
-00056a40: 616c 2074 6f20 7472 6561 7420 6173 2063  al to treat as c
-00056a50: 6c6f 7365 642e 0a20 2020 2020 2020 206c  losed..        l
-00056a60: 6162 656c 203a 207b 226c 6566 7422 2c20  abel : {"left", 
-00056a70: 2272 6967 6874 227d 2c20 6f70 7469 6f6e  "right"}, option
-00056a80: 616c 0a20 2020 2020 2020 2020 2020 2053  al.            S
-00056a90: 6964 6520 6f66 2065 6163 6820 696e 7465  ide of each inte
-00056aa0: 7276 616c 2074 6f20 7573 6520 666f 7220  rval to use for 
-00056ab0: 6c61 6265 6c69 6e67 2e0a 2020 2020 2020  labeling..      
-00056ac0: 2020 6261 7365 203a 2069 6e74 2c20 6f70    base : int, op
-00056ad0: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
-00056ae0: 2020 2046 6f72 2066 7265 7175 656e 6369     For frequenci
-00056af0: 6573 2074 6861 7420 6576 656e 6c79 2073  es that evenly s
-00056b00: 7562 6469 7669 6465 2031 2064 6179 2c20  ubdivide 1 day, 
-00056b10: 7468 6520 226f 7269 6769 6e22 206f 6620  the "origin" of 
-00056b20: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-00056b30: 6167 6772 6567 6174 6564 2069 6e74 6572  aggregated inter
-00056b40: 7661 6c73 2e20 466f 7220 6578 616d 706c  vals. For exampl
-00056b50: 652c 2066 6f72 2022 3234 4822 2066 7265  e, for "24H" fre
-00056b60: 7175 656e 6379 2c20 6261 7365 2063 6f75  quency, base cou
-00056b70: 6c64 0a20 2020 2020 2020 2020 2020 2072  ld.            r
-00056b80: 616e 6765 2066 726f 6d20 3020 7468 726f  ange from 0 thro
-00056b90: 7567 6820 3233 2e0a 2020 2020 2020 2020  ugh 23..        
-00056ba0: 6f72 6967 696e 203a 207b 2765 706f 6368  origin : {'epoch
-00056bb0: 272c 2027 7374 6172 7427 2c20 2773 7461  ', 'start', 'sta
-00056bc0: 7274 5f64 6179 272c 2027 656e 6427 2c20  rt_day', 'end', 
-00056bd0: 2765 6e64 5f64 6179 277d 2c20 7064 2e54  'end_day'}, pd.T
-00056be0: 696d 6573 7461 6d70 2c20 6461 7465 7469  imestamp, dateti
-00056bf0: 6d65 2e64 6174 6574 696d 652c 206e 702e  me.datetime, np.
-00056c00: 6461 7465 7469 6d65 3634 2c20 6f72 2063  datetime64, or c
-00056c10: 6674 696d 652e 6461 7465 7469 6d65 2c20  ftime.datetime, 
-00056c20: 6465 6661 756c 7420 2773 7461 7274 5f64  default 'start_d
-00056c30: 6179 270a 2020 2020 2020 2020 2020 2020  ay'.            
-00056c40: 5468 6520 6461 7465 7469 6d65 206f 6e20  The datetime on 
-00056c50: 7768 6963 6820 746f 2061 646a 7573 7420  which to adjust 
-00056c60: 7468 6520 6772 6f75 7069 6e67 2e20 5468  the grouping. Th
-00056c70: 6520 7469 6d65 7a6f 6e65 206f 6620 6f72  e timezone of or
-00056c80: 6967 696e 0a20 2020 2020 2020 2020 2020  igin.           
-00056c90: 206d 7573 7420 6d61 7463 6820 7468 6520   must match the 
-00056ca0: 7469 6d65 7a6f 6e65 206f 6620 7468 6520  timezone of the 
-00056cb0: 696e 6465 782e 0a0a 2020 2020 2020 2020  index...        
-00056cc0: 2020 2020 4966 2061 2064 6174 6574 696d      If a datetim
-00056cd0: 6520 6973 206e 6f74 2075 7365 642c 2074  e is not used, t
-00056ce0: 6865 7365 2076 616c 7565 7320 6172 6520  hese values are 
-00056cf0: 616c 736f 2073 7570 706f 7274 6564 3a0a  also supported:.
-00056d00: 2020 2020 2020 2020 2020 2020 2d20 2765              - 'e
-00056d10: 706f 6368 273a 2060 6f72 6967 696e 6020  poch': `origin` 
-00056d20: 6973 2031 3937 302d 3031 2d30 310a 2020  is 1970-01-01.  
-00056d30: 2020 2020 2020 2020 2020 2d20 2773 7461            - 'sta
-00056d40: 7274 273a 2060 6f72 6967 696e 6020 6973  rt': `origin` is
-00056d50: 2074 6865 2066 6972 7374 2076 616c 7565   the first value
-00056d60: 206f 6620 7468 6520 7469 6d65 7365 7269   of the timeseri
-00056d70: 6573 0a20 2020 2020 2020 2020 2020 202d  es.            -
-00056d80: 2027 7374 6172 745f 6461 7927 3a20 606f   'start_day': `o
-00056d90: 7269 6769 6e60 2069 7320 7468 6520 6669  rigin` is the fi
-00056da0: 7273 7420 6461 7920 6174 206d 6964 6e69  rst day at midni
-00056db0: 6768 7420 6f66 2074 6865 2074 696d 6573  ght of the times
-00056dc0: 6572 6965 730a 2020 2020 2020 2020 2020  eries.          
-00056dd0: 2020 2d20 2765 6e64 273a 2060 6f72 6967    - 'end': `orig
-00056de0: 696e 6020 6973 2074 6865 206c 6173 7420  in` is the last 
-00056df0: 7661 6c75 6520 6f66 2074 6865 2074 696d  value of the tim
-00056e00: 6573 6572 6965 730a 2020 2020 2020 2020  eseries.        
-00056e10: 2020 2020 2d20 2765 6e64 5f64 6179 273a      - 'end_day':
-00056e20: 2060 6f72 6967 696e 6020 6973 2074 6865   `origin` is the
-00056e30: 2063 6569 6c69 6e67 206d 6964 6e69 6768   ceiling midnigh
-00056e40: 7420 6f66 2074 6865 206c 6173 7420 6461  t of the last da
-00056e50: 790a 2020 2020 2020 2020 6f66 6673 6574  y.        offset
-00056e60: 203a 2070 642e 5469 6d65 6465 6c74 612c   : pd.Timedelta,
-00056e70: 2064 6174 6574 696d 652e 7469 6d65 6465   datetime.timede
-00056e80: 6c74 612c 206f 7220 7374 722c 2064 6566  lta, or str, def
-00056e90: 6175 6c74 2069 7320 4e6f 6e65 0a20 2020  ault is None.   
-00056ea0: 2020 2020 2020 2020 2041 6e20 6f66 6673           An offs
-00056eb0: 6574 2074 696d 6564 656c 7461 2061 6464  et timedelta add
-00056ec0: 6564 2074 6f20 7468 6520 6f72 6967 696e  ed to the origin
-00056ed0: 2e0a 2020 2020 2020 2020 6c6f 6666 7365  ..        loffse
-00056ee0: 7420 3a20 7469 6d65 6465 6c74 6120 6f72  t : timedelta or
-00056ef0: 2073 7472 2c20 6f70 7469 6f6e 616c 0a20   str, optional. 
-00056f00: 2020 2020 2020 2020 2020 204f 6666 7365             Offse
-00056f10: 7420 7573 6564 2074 6f20 6164 6a75 7374  t used to adjust
-00056f20: 2074 6865 2072 6573 616d 706c 6564 2074   the resampled t
-00056f30: 696d 6520 6c61 6265 6c73 2e20 536f 6d65  ime labels. Some
-00056f40: 2070 616e 6461 7320 6461 7465 0a20 2020   pandas date.   
-00056f50: 2020 2020 2020 2020 206f 6666 7365 7420           offset 
-00056f60: 7374 7269 6e67 7320 6172 6520 7375 7070  strings are supp
-00056f70: 6f72 7465 642e 0a20 2020 2020 2020 2072  orted..        r
-00056f80: 6573 746f 7265 5f63 6f6f 7264 5f64 696d  estore_coord_dim
-00056f90: 7320 3a20 626f 6f6c 2c20 6f70 7469 6f6e  s : bool, option
-00056fa0: 616c 0a20 2020 2020 2020 2020 2020 2049  al.            I
-00056fb0: 6620 5472 7565 2c20 616c 736f 2072 6573  f True, also res
-00056fc0: 746f 7265 2074 6865 2064 696d 656e 7369  tore the dimensi
-00056fd0: 6f6e 206f 7264 6572 206f 6620 6d75 6c74  on order of mult
-00056fe0: 692d 6469 6d65 6e73 696f 6e61 6c0a 2020  i-dimensional.  
-00056ff0: 2020 2020 2020 2020 2020 636f 6f72 6469            coordi
-00057000: 6e61 7465 732e 0a20 2020 2020 2020 202a  nates..        *
-00057010: 2a69 6e64 6578 6572 5f6b 7761 7267 7320  *indexer_kwargs 
-00057020: 3a20 7374 720a 2020 2020 2020 2020 2020  : str.          
-00057030: 2020 5468 6520 6b65 7977 6f72 6420 6172    The keyword ar
-00057040: 6775 6d65 6e74 7320 666f 726d 206f 6620  guments form of 
-00057050: 6060 696e 6465 7865 7260 602e 0a20 2020  ``indexer``..   
-00057060: 2020 2020 2020 2020 204f 6e65 206f 6620           One of 
-00057070: 696e 6465 7865 7220 6f72 2069 6e64 6578  indexer or index
-00057080: 6572 5f6b 7761 7267 7320 6d75 7374 2062  er_kwargs must b
-00057090: 6520 7072 6f76 6964 6564 2e0a 0a20 2020  e provided...   
-000570a0: 2020 2020 2052 6574 7572 6e73 0a20 2020       Returns.   
-000570b0: 2020 2020 202d 2d2d 2d2d 2d2d 0a20 2020       -------.   
-000570c0: 2020 2020 2072 6573 616d 706c 6564 203a       resampled :
-000570d0: 2063 6f72 652e 7265 7361 6d70 6c65 2e44   core.resample.D
-000570e0: 6174 6141 7272 6179 5265 7361 6d70 6c65  ataArrayResample
-000570f0: 0a20 2020 2020 2020 2020 2020 2054 6869  .            Thi
-00057100: 7320 6f62 6a65 6374 2072 6573 616d 706c  s object resampl
-00057110: 6564 2e0a 0a20 2020 2020 2020 2053 6565  ed...        See
-00057120: 2041 6c73 6f0a 2020 2020 2020 2020 2d2d   Also.        --
-00057130: 2d2d 2d2d 2d2d 0a20 2020 2020 2020 2044  ------.        D
-00057140: 6174 6141 7272 6179 2e72 6573 616d 706c  ataArray.resampl
-00057150: 650a 2020 2020 2020 2020 7061 6e64 6173  e.        pandas
-00057160: 2e53 6572 6965 732e 7265 7361 6d70 6c65  .Series.resample
-00057170: 0a20 2020 2020 2020 2070 616e 6461 732e  .        pandas.
-00057180: 4461 7461 4672 616d 652e 7265 7361 6d70  DataFrame.resamp
-00057190: 6c65 0a20 2020 2020 2020 2044 6174 6173  le.        Datas
-000571a0: 6574 2e67 726f 7570 6279 0a20 2020 2020  et.groupby.     
-000571b0: 2020 2044 6174 6141 7272 6179 2e67 726f     DataArray.gro
-000571c0: 7570 6279 0a0a 2020 2020 2020 2020 5265  upby..        Re
-000571d0: 6665 7265 6e63 6573 0a20 2020 2020 2020  ferences.       
-000571e0: 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020   ----------.    
-000571f0: 2020 2020 2e2e 205b 315d 2068 7474 703a      .. [1] http:
-00057200: 2f2f 7061 6e64 6173 2e70 7964 6174 612e  //pandas.pydata.
-00057210: 6f72 672f 7061 6e64 6173 2d64 6f63 732f  org/pandas-docs/
-00057220: 7374 6162 6c65 2f74 696d 6573 6572 6965  stable/timeserie
-00057230: 732e 6874 6d6c 236f 6666 7365 742d 616c  s.html#offset-al
-00057240: 6961 7365 730a 2020 2020 2020 2020 2222  iases.        ""
-00057250: 220a 2020 2020 2020 2020 6672 6f6d 2078  ".        from x
-00057260: 6172 7261 792e 636f 7265 2e72 6573 616d  array.core.resam
-00057270: 706c 6520 696d 706f 7274 2044 6174 6173  ple import Datas
-00057280: 6574 5265 7361 6d70 6c65 0a0a 2020 2020  etResample..    
-00057290: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000572a0: 5f72 6573 616d 706c 6528 0a20 2020 2020  _resample(.     
-000572b0: 2020 2020 2020 2072 6573 616d 706c 655f         resample_
-000572c0: 636c 733d 4461 7461 7365 7452 6573 616d  cls=DatasetResam
-000572d0: 706c 652c 0a20 2020 2020 2020 2020 2020  ple,.           
-000572e0: 2069 6e64 6578 6572 3d69 6e64 6578 6572   indexer=indexer
-000572f0: 2c0a 2020 2020 2020 2020 2020 2020 736b  ,.            sk
-00057300: 6970 6e61 3d73 6b69 706e 612c 0a20 2020  ipna=skipna,.   
-00057310: 2020 2020 2020 2020 2063 6c6f 7365 643d           closed=
-00057320: 636c 6f73 6564 2c0a 2020 2020 2020 2020  closed,.        
-00057330: 2020 2020 6c61 6265 6c3d 6c61 6265 6c2c      label=label,
-00057340: 0a20 2020 2020 2020 2020 2020 2062 6173  .            bas
-00057350: 653d 6261 7365 2c0a 2020 2020 2020 2020  e=base,.        
-00057360: 2020 2020 6f66 6673 6574 3d6f 6666 7365      offset=offse
-00057370: 742c 0a20 2020 2020 2020 2020 2020 206f  t,.            o
-00057380: 7269 6769 6e3d 6f72 6967 696e 2c0a 2020  rigin=origin,.  
-00057390: 2020 2020 2020 2020 2020 6b65 6570 5f61            keep_a
-000573a0: 7474 7273 3d6b 6565 705f 6174 7472 732c  ttrs=keep_attrs,
-000573b0: 0a20 2020 2020 2020 2020 2020 206c 6f66  .            lof
-000573c0: 6673 6574 3d6c 6f66 6673 6574 2c0a 2020  fset=loffset,.  
-000573d0: 2020 2020 2020 2020 2020 7265 7374 6f72            restor
-000573e0: 655f 636f 6f72 645f 6469 6d73 3d72 6573  e_coord_dims=res
-000573f0: 746f 7265 5f63 6f6f 7264 5f64 696d 732c  tore_coord_dims,
-00057400: 0a20 2020 2020 2020 2020 2020 202a 2a69  .            **i
-00057410: 6e64 6578 6572 5f6b 7761 7267 732c 0a20  ndexer_kwargs,. 
-00057420: 2020 2020 2020 2029 0a                          ).
+0004c0d0: 2020 2020 6b65 6570 5f61 7474 7273 3d6b      keep_attrs=k
+0004c0e0: 6565 705f 6174 7472 732c 0a20 2020 2020  eep_attrs,.     
+0004c0f0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0004c100: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0004c110: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0004c120: 6172 6961 626c 6573 5b6e 616d 655d 203d  ariables[name] =
+0004c130: 2076 6172 2e70 6164 280a 2020 2020 2020   var.pad(.      
+0004c140: 2020 2020 2020 2020 2020 2020 2020 7061                pa
+0004c150: 645f 7769 6474 683d 7661 725f 7061 645f  d_width=var_pad_
+0004c160: 7769 6474 682c 0a20 2020 2020 2020 2020  width,.         
+0004c170: 2020 2020 2020 2020 2020 206d 6f64 653d             mode=
+0004c180: 636f 6f72 645f 7061 645f 6d6f 6465 2c0a  coord_pad_mode,.
+0004c190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c1a0: 2020 2020 6b65 6570 5f61 7474 7273 3d6b      keep_attrs=k
+0004c1b0: 6565 705f 6174 7472 732c 0a20 2020 2020  eep_attrs,.     
+0004c1c0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+0004c1d0: 2a63 6f6f 7264 5f70 6164 5f6f 7074 696f  *coord_pad_optio
+0004c1e0: 6e73 2c20 2023 2074 7970 653a 2069 676e  ns,  # type: ign
+0004c1f0: 6f72 655b 6172 672d 7479 7065 5d0a 2020  ore[arg-type].  
+0004c200: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+0004c210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c220: 2320 7265 7365 7420 6465 6661 756c 7420  # reset default 
+0004c230: 696e 6465 7820 6f66 2064 696d 656e 7369  index of dimensi
+0004c240: 6f6e 2063 6f6f 7264 696e 6174 6573 0a20  on coordinates. 
+0004c250: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0004c260: 6620 286e 616d 652c 2920 3d3d 2076 6172  f (name,) == var
+0004c270: 2e64 696d 733a 0a20 2020 2020 2020 2020  .dims:.         
+0004c280: 2020 2020 2020 2020 2020 2064 696d 5f76             dim_v
+0004c290: 6172 203d 207b 6e61 6d65 3a20 7661 7269  ar = {name: vari
+0004c2a0: 6162 6c65 735b 6e61 6d65 5d7d 0a20 2020  ables[name]}.   
+0004c2b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004c2c0: 2069 6e64 6578 203d 2050 616e 6461 7349   index = PandasI
+0004c2d0: 6e64 6578 2e66 726f 6d5f 7661 7269 6162  ndex.from_variab
+0004c2e0: 6c65 7328 6469 6d5f 7661 722c 206f 7074  les(dim_var, opt
+0004c2f0: 696f 6e73 3d7b 7d29 0a20 2020 2020 2020  ions={}).       
+0004c300: 2020 2020 2020 2020 2020 2020 2069 6e64               ind
+0004c310: 6578 5f76 6172 7320 3d20 696e 6465 782e  ex_vars = index.
+0004c320: 6372 6561 7465 5f76 6172 6961 626c 6573  create_variables
+0004c330: 2864 696d 5f76 6172 290a 2020 2020 2020  (dim_var).      
+0004c340: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0004c350: 6465 7865 735b 6e61 6d65 5d20 3d20 696e  dexes[name] = in
+0004c360: 6465 780a 2020 2020 2020 2020 2020 2020  dex.            
+0004c370: 2020 2020 2020 2020 7661 7269 6162 6c65          variable
+0004c380: 735b 6e61 6d65 5d20 3d20 696e 6465 785f  s[name] = index_
+0004c390: 7661 7273 5b6e 616d 655d 0a0a 2020 2020  vars[name]..    
+0004c3a0: 2020 2020 6174 7472 7320 3d20 7365 6c66      attrs = self
+0004c3b0: 2e5f 6174 7472 7320 6966 206b 6565 705f  ._attrs if keep_
+0004c3c0: 6174 7472 7320 656c 7365 204e 6f6e 650a  attrs else None.
+0004c3d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0004c3e0: 656c 662e 5f72 6570 6c61 6365 5f77 6974  elf._replace_wit
+0004c3f0: 685f 6e65 775f 6469 6d73 2876 6172 6961  h_new_dims(varia
+0004c400: 626c 6573 2c20 696e 6465 7865 733d 696e  bles, indexes=in
+0004c410: 6465 7865 732c 2061 7474 7273 3d61 7474  dexes, attrs=att
+0004c420: 7273 290a 0a20 2020 2064 6566 2069 6478  rs)..    def idx
+0004c430: 6d69 6e28 0a20 2020 2020 2020 2073 656c  min(.        sel
+0004c440: 663a 2054 5f44 6174 6173 6574 2c0a 2020  f: T_Dataset,.  
+0004c450: 2020 2020 2020 6469 6d3a 2048 6173 6861        dim: Hasha
+0004c460: 626c 6520 7c20 4e6f 6e65 203d 204e 6f6e  ble | None = Non
+0004c470: 652c 0a20 2020 2020 2020 2073 6b69 706e  e,.        skipn
+0004c480: 613a 2062 6f6f 6c20 7c20 4e6f 6e65 203d  a: bool | None =
+0004c490: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
+0004c4a0: 696c 6c5f 7661 6c75 653a 2041 6e79 203d  ill_value: Any =
+0004c4b0: 2078 7264 7479 7065 732e 4e41 2c0a 2020   xrdtypes.NA,.  
+0004c4c0: 2020 2020 2020 6b65 6570 5f61 7474 7273        keep_attrs
+0004c4d0: 3a20 626f 6f6c 207c 204e 6f6e 6520 3d20  : bool | None = 
+0004c4e0: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 2054  None,.    ) -> T
+0004c4f0: 5f44 6174 6173 6574 3a0a 2020 2020 2020  _Dataset:.      
+0004c500: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
+0004c510: 636f 6f72 6469 6e61 7465 206c 6162 656c  coordinate label
+0004c520: 206f 6620 7468 6520 6d69 6e69 6d75 6d20   of the minimum 
+0004c530: 7661 6c75 6520 616c 6f6e 6720 6120 6469  value along a di
+0004c540: 6d65 6e73 696f 6e2e 0a0a 2020 2020 2020  mension...      
+0004c550: 2020 5265 7475 726e 7320 6120 6e65 7720    Returns a new 
+0004c560: 6044 6174 6173 6574 6020 6e61 6d65 6420  `Dataset` named 
+0004c570: 6166 7465 7220 7468 6520 6469 6d65 6e73  after the dimens
+0004c580: 696f 6e20 7769 7468 2074 6865 2076 616c  ion with the val
+0004c590: 7565 7320 6f66 0a20 2020 2020 2020 2074  ues of.        t
+0004c5a0: 6865 2063 6f6f 7264 696e 6174 6520 6c61  he coordinate la
+0004c5b0: 6265 6c73 2061 6c6f 6e67 2074 6861 7420  bels along that 
+0004c5c0: 6469 6d65 6e73 696f 6e20 636f 7272 6573  dimension corres
+0004c5d0: 706f 6e64 696e 6720 746f 206d 696e 696d  ponding to minim
+0004c5e0: 756d 0a20 2020 2020 2020 2076 616c 7565  um.        value
+0004c5f0: 7320 616c 6f6e 6720 7468 6174 2064 696d  s along that dim
+0004c600: 656e 7369 6f6e 2e0a 0a20 2020 2020 2020  ension...       
+0004c610: 2049 6e20 636f 6d70 6172 6973 6f6e 2074   In comparison t
+0004c620: 6f20 3a70 793a 6d65 7468 3a60 7e44 6174  o :py:meth:`~Dat
+0004c630: 6173 6574 2e61 7267 6d69 6e60 2c20 7468  aset.argmin`, th
+0004c640: 6973 2072 6574 7572 6e73 2074 6865 0a20  is returns the. 
+0004c650: 2020 2020 2020 2063 6f6f 7264 696e 6174         coordinat
+0004c660: 6520 6c61 6265 6c20 7768 696c 6520 3a70  e label while :p
+0004c670: 793a 6d65 7468 3a60 7e44 6174 6173 6574  y:meth:`~Dataset
+0004c680: 2e61 7267 6d69 6e60 2072 6574 7572 6e73  .argmin` returns
+0004c690: 2074 6865 2069 6e64 6578 2e0a 0a20 2020   the index...   
+0004c6a0: 2020 2020 2050 6172 616d 6574 6572 730a       Parameters.
+0004c6b0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0004c6c0: 2d2d 0a20 2020 2020 2020 2064 696d 203a  --.        dim :
+0004c6d0: 2048 6173 6861 626c 652c 206f 7074 696f   Hashable, optio
+0004c6e0: 6e61 6c0a 2020 2020 2020 2020 2020 2020  nal.            
+0004c6f0: 4469 6d65 6e73 696f 6e20 6f76 6572 2077  Dimension over w
+0004c700: 6869 6368 2074 6f20 6170 706c 7920 6069  hich to apply `i
+0004c710: 6478 6d69 6e60 2e20 2054 6869 7320 6973  dxmin`.  This is
+0004c720: 206f 7074 696f 6e61 6c20 666f 7220 3144   optional for 1D
+0004c730: 0a20 2020 2020 2020 2020 2020 2076 6172  .            var
+0004c740: 6961 626c 6573 2c20 6275 7420 7265 7175  iables, but requ
+0004c750: 6972 6564 2066 6f72 2076 6172 6961 626c  ired for variabl
+0004c760: 6573 2077 6974 6820 3220 6f72 206d 6f72  es with 2 or mor
+0004c770: 6520 6469 6d65 6e73 696f 6e73 2e0a 2020  e dimensions..  
+0004c780: 2020 2020 2020 736b 6970 6e61 203a 2062        skipna : b
+0004c790: 6f6f 6c20 6f72 204e 6f6e 652c 206f 7074  ool or None, opt
+0004c7a0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0004c7b0: 2020 4966 2054 7275 652c 2073 6b69 7020    If True, skip 
+0004c7c0: 6d69 7373 696e 6720 7661 6c75 6573 2028  missing values (
+0004c7d0: 6173 206d 6172 6b65 6420 6279 204e 614e  as marked by NaN
+0004c7e0: 292e 2042 7920 6465 6661 756c 742c 206f  ). By default, o
+0004c7f0: 6e6c 790a 2020 2020 2020 2020 2020 2020  nly.            
+0004c800: 736b 6970 7320 6d69 7373 696e 6720 7661  skips missing va
+0004c810: 6c75 6573 2066 6f72 2060 6066 6c6f 6174  lues for ``float
+0004c820: 6060 2c20 6060 636f 6d70 6c65 7860 602c  ``, ``complex``,
+0004c830: 2061 6e64 2060 606f 626a 6563 7460 600a   and ``object``.
+0004c840: 2020 2020 2020 2020 2020 2020 6474 7970              dtyp
+0004c850: 6573 3b20 6f74 6865 7220 6474 7970 6573  es; other dtypes
+0004c860: 2065 6974 6865 7220 646f 206e 6f74 2068   either do not h
+0004c870: 6176 6520 6120 7365 6e74 696e 656c 206d  ave a sentinel m
+0004c880: 6973 7369 6e67 2076 616c 7565 0a20 2020  issing value.   
+0004c890: 2020 2020 2020 2020 2028 6060 696e 7460           (``int`
+0004c8a0: 6029 206f 7220 6060 736b 6970 6e61 3d54  `) or ``skipna=T
+0004c8b0: 7275 6560 6020 6861 7320 6e6f 7420 6265  rue`` has not be
+0004c8c0: 656e 2069 6d70 6c65 6d65 6e74 6564 0a20  en implemented. 
+0004c8d0: 2020 2020 2020 2020 2020 2028 6060 6461             (``da
+0004c8e0: 7465 7469 6d65 3634 6060 206f 7220 6060  tetime64`` or ``
+0004c8f0: 7469 6d65 6465 6c74 6136 3460 6029 2e0a  timedelta64``)..
+0004c900: 2020 2020 2020 2020 6669 6c6c 5f76 616c          fill_val
+0004c910: 7565 203a 2041 6e79 2c20 6465 6661 756c  ue : Any, defaul
+0004c920: 743a 204e 614e 0a20 2020 2020 2020 2020  t: NaN.         
+0004c930: 2020 2056 616c 7565 2074 6f20 6265 2066     Value to be f
+0004c940: 696c 6c65 6420 696e 2063 6173 6520 616c  illed in case al
+0004c950: 6c20 6f66 2074 6865 2076 616c 7565 7320  l of the values 
+0004c960: 616c 6f6e 6720 6120 6469 6d65 6e73 696f  along a dimensio
+0004c970: 6e20 6172 650a 2020 2020 2020 2020 2020  n are.          
+0004c980: 2020 6e75 6c6c 2e20 2042 7920 6465 6661    null.  By defa
+0004c990: 756c 7420 7468 6973 2069 7320 4e61 4e2e  ult this is NaN.
+0004c9a0: 2020 5468 6520 6669 6c6c 2076 616c 7565    The fill value
+0004c9b0: 2061 6e64 2072 6573 756c 7420 6172 650a   and result are.
+0004c9c0: 2020 2020 2020 2020 2020 2020 6175 746f              auto
+0004c9d0: 6d61 7469 6361 6c6c 7920 636f 6e76 6572  matically conver
+0004c9e0: 7465 6420 746f 2061 2063 6f6d 7061 7469  ted to a compati
+0004c9f0: 626c 6520 6474 7970 6520 6966 2070 6f73  ble dtype if pos
+0004ca00: 7369 626c 652e 0a20 2020 2020 2020 2020  sible..         
+0004ca10: 2020 2049 676e 6f72 6564 2069 6620 6060     Ignored if ``
+0004ca20: 736b 6970 6e61 6060 2069 7320 4661 6c73  skipna`` is Fals
+0004ca30: 652e 0a20 2020 2020 2020 206b 6565 705f  e..        keep_
+0004ca40: 6174 7472 7320 3a20 626f 6f6c 206f 7220  attrs : bool or 
+0004ca50: 4e6f 6e65 2c20 6f70 7469 6f6e 616c 0a20  None, optional. 
+0004ca60: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
+0004ca70: 7565 2c20 7468 6520 6174 7472 6962 7574  ue, the attribut
+0004ca80: 6573 2028 6060 6174 7472 7360 6029 2077  es (``attrs``) w
+0004ca90: 696c 6c20 6265 2063 6f70 6965 6420 6672  ill be copied fr
+0004caa0: 6f6d 2074 6865 0a20 2020 2020 2020 2020  om the.         
+0004cab0: 2020 206f 7269 6769 6e61 6c20 6f62 6a65     original obje
+0004cac0: 6374 2074 6f20 7468 6520 6e65 7720 6f6e  ct to the new on
+0004cad0: 652e 2049 6620 4661 6c73 652c 2074 6865  e. If False, the
+0004cae0: 206e 6577 206f 626a 6563 740a 2020 2020   new object.    
+0004caf0: 2020 2020 2020 2020 7769 6c6c 2062 6520          will be 
+0004cb00: 7265 7475 726e 6564 2077 6974 686f 7574  returned without
+0004cb10: 2061 7474 7269 6275 7465 732e 0a0a 2020   attributes...  
+0004cb20: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+0004cb30: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+0004cb40: 2020 2020 2020 7265 6475 6365 6420 3a20        reduced : 
+0004cb50: 4461 7461 7365 740a 2020 2020 2020 2020  Dataset.        
+0004cb60: 2020 2020 4e65 7720 6044 6174 6173 6574      New `Dataset
+0004cb70: 6020 6f62 6a65 6374 2077 6974 6820 6069  ` object with `i
+0004cb80: 6478 6d69 6e60 2061 7070 6c69 6564 2074  dxmin` applied t
+0004cb90: 6f20 6974 7320 6461 7461 2061 6e64 2074  o its data and t
+0004cba0: 6865 0a20 2020 2020 2020 2020 2020 2069  he.            i
+0004cbb0: 6e64 6963 6174 6564 2064 696d 656e 7369  ndicated dimensi
+0004cbc0: 6f6e 2072 656d 6f76 6564 2e0a 0a20 2020  on removed...   
+0004cbd0: 2020 2020 2053 6565 2041 6c73 6f0a 2020       See Also.  
+0004cbe0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+0004cbf0: 2020 2020 2020 2044 6174 6141 7272 6179         DataArray
+0004cc00: 2e69 6478 6d69 6e2c 2044 6174 6173 6574  .idxmin, Dataset
+0004cc10: 2e69 6478 6d61 782c 2044 6174 6173 6574  .idxmax, Dataset
+0004cc20: 2e6d 696e 2c20 4461 7461 7365 742e 6172  .min, Dataset.ar
+0004cc30: 676d 696e 0a0a 2020 2020 2020 2020 4578  gmin..        Ex
+0004cc40: 616d 706c 6573 0a20 2020 2020 2020 202d  amples.        -
+0004cc50: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+0004cc60: 3e3e 3e20 6172 7261 7931 203d 2078 722e  >>> array1 = xr.
+0004cc70: 4461 7461 4172 7261 7928 0a20 2020 2020  DataArray(.     
+0004cc80: 2020 202e 2e2e 2020 2020 205b 302c 2032     ...     [0, 2
+0004cc90: 2c20 312c 2030 2c20 2d32 5d2c 2064 696d  , 1, 0, -2], dim
+0004cca0: 733d 2278 222c 2063 6f6f 7264 733d 7b22  s="x", coords={"
+0004ccb0: 7822 3a20 5b22 6122 2c20 2262 222c 2022  x": ["a", "b", "
+0004ccc0: 6322 2c20 2264 222c 2022 6522 5d7d 0a20  c", "d", "e"]}. 
+0004ccd0: 2020 2020 2020 202e 2e2e 2029 0a20 2020         ... ).   
+0004cce0: 2020 2020 203e 3e3e 2061 7272 6179 3220       >>> array2 
+0004ccf0: 3d20 7872 2e44 6174 6141 7272 6179 280a  = xr.DataArray(.
+0004cd00: 2020 2020 2020 2020 2e2e 2e20 2020 2020          ...     
+0004cd10: 5b0a 2020 2020 2020 2020 2e2e 2e20 2020  [.        ...   
+0004cd20: 2020 2020 2020 5b32 2e30 2c20 312e 302c        [2.0, 1.0,
+0004cd30: 2032 2e30 2c20 302e 302c 202d 322e 305d   2.0, 0.0, -2.0]
+0004cd40: 2c0a 2020 2020 2020 2020 2e2e 2e20 2020  ,.        ...   
+0004cd50: 2020 2020 2020 5b2d 342e 302c 206e 702e        [-4.0, np.
+0004cd60: 4e61 4e2c 2032 2e30 2c20 6e70 2e4e 614e  NaN, 2.0, np.NaN
+0004cd70: 2c20 2d32 2e30 5d2c 0a20 2020 2020 2020  , -2.0],.       
+0004cd80: 202e 2e2e 2020 2020 2020 2020 205b 6e70   ...         [np
+0004cd90: 2e4e 614e 2c20 6e70 2e4e 614e 2c20 312e  .NaN, np.NaN, 1.
+0004cda0: 302c 206e 702e 4e61 4e2c 206e 702e 4e61  0, np.NaN, np.Na
+0004cdb0: 4e5d 2c0a 2020 2020 2020 2020 2e2e 2e20  N],.        ... 
+0004cdc0: 2020 2020 5d2c 0a20 2020 2020 2020 202e      ],.        .
+0004cdd0: 2e2e 2020 2020 2064 696d 733d 5b22 7922  ..     dims=["y"
+0004cde0: 2c20 2278 225d 2c0a 2020 2020 2020 2020  , "x"],.        
+0004cdf0: 2e2e 2e20 2020 2020 636f 6f72 6473 3d7b  ...     coords={
+0004ce00: 2279 223a 205b 2d31 2c20 302c 2031 5d2c  "y": [-1, 0, 1],
+0004ce10: 2022 7822 3a20 5b22 6122 2c20 2262 222c   "x": ["a", "b",
+0004ce20: 2022 6322 2c20 2264 222c 2022 6522 5d7d   "c", "d", "e"]}
+0004ce30: 2c0a 2020 2020 2020 2020 2e2e 2e20 290a  ,.        ... ).
+0004ce40: 2020 2020 2020 2020 3e3e 3e20 6473 203d          >>> ds =
+0004ce50: 2078 722e 4461 7461 7365 7428 7b22 696e   xr.Dataset({"in
+0004ce60: 7422 3a20 6172 7261 7931 2c20 2266 6c6f  t": array1, "flo
+0004ce70: 6174 223a 2061 7272 6179 327d 290a 2020  at": array2}).  
+0004ce80: 2020 2020 2020 3e3e 3e20 6473 2e6d 696e        >>> ds.min
+0004ce90: 2864 696d 3d22 7822 290a 2020 2020 2020  (dim="x").      
+0004cea0: 2020 3c78 6172 7261 792e 4461 7461 7365    <xarray.Datase
+0004ceb0: 743e 0a20 2020 2020 2020 2044 696d 656e  t>.        Dimen
+0004cec0: 7369 6f6e 733a 2020 2879 3a20 3329 0a20  sions:  (y: 3). 
+0004ced0: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
+0004cee0: 6573 3a0a 2020 2020 2020 2020 2020 2a20  es:.          * 
+0004cef0: 7920 2020 2020 2020 2028 7929 2069 6e74  y        (y) int
+0004cf00: 3634 202d 3120 3020 310a 2020 2020 2020  64 -1 0 1.      
+0004cf10: 2020 4461 7461 2076 6172 6961 626c 6573    Data variables
+0004cf20: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+0004cf30: 7420 2020 2020 2069 6e74 3634 202d 320a  t      int64 -2.
+0004cf40: 2020 2020 2020 2020 2020 2020 666c 6f61              floa
+0004cf50: 7420 2020 2028 7929 2066 6c6f 6174 3634  t    (y) float64
+0004cf60: 202d 322e 3020 2d34 2e30 2031 2e30 0a20   -2.0 -4.0 1.0. 
+0004cf70: 2020 2020 2020 203e 3e3e 2064 732e 6172         >>> ds.ar
+0004cf80: 676d 696e 2864 696d 3d22 7822 290a 2020  gmin(dim="x").  
+0004cf90: 2020 2020 2020 3c78 6172 7261 792e 4461        <xarray.Da
+0004cfa0: 7461 7365 743e 0a20 2020 2020 2020 2044  taset>.        D
+0004cfb0: 696d 656e 7369 6f6e 733a 2020 2879 3a20  imensions:  (y: 
+0004cfc0: 3329 0a20 2020 2020 2020 2043 6f6f 7264  3).        Coord
+0004cfd0: 696e 6174 6573 3a0a 2020 2020 2020 2020  inates:.        
+0004cfe0: 2020 2a20 7920 2020 2020 2020 2028 7929    * y        (y)
+0004cff0: 2069 6e74 3634 202d 3120 3020 310a 2020   int64 -1 0 1.  
+0004d000: 2020 2020 2020 4461 7461 2076 6172 6961        Data varia
+0004d010: 626c 6573 3a0a 2020 2020 2020 2020 2020  bles:.          
+0004d020: 2020 696e 7420 2020 2020 2069 6e74 3634    int      int64
+0004d030: 2034 0a20 2020 2020 2020 2020 2020 2066   4.            f
+0004d040: 6c6f 6174 2020 2020 2879 2920 696e 7436  loat    (y) int6
+0004d050: 3420 3420 3020 320a 2020 2020 2020 2020  4 4 0 2.        
+0004d060: 3e3e 3e20 6473 2e69 6478 6d69 6e28 6469  >>> ds.idxmin(di
+0004d070: 6d3d 2278 2229 0a20 2020 2020 2020 203c  m="x").        <
+0004d080: 7861 7272 6179 2e44 6174 6173 6574 3e0a  xarray.Dataset>.
+0004d090: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
+0004d0a0: 6e73 3a20 2028 793a 2033 290a 2020 2020  ns:  (y: 3).    
+0004d0b0: 2020 2020 436f 6f72 6469 6e61 7465 733a      Coordinates:
+0004d0c0: 0a20 2020 2020 2020 2020 202a 2079 2020  .          * y  
+0004d0d0: 2020 2020 2020 2879 2920 696e 7436 3420        (y) int64 
+0004d0e0: 2d31 2030 2031 0a20 2020 2020 2020 2044  -1 0 1.        D
+0004d0f0: 6174 6120 7661 7269 6162 6c65 733a 0a20  ata variables:. 
+0004d100: 2020 2020 2020 2020 2020 2069 6e74 2020             int  
+0004d110: 2020 2020 3c55 3120 2765 270a 2020 2020      <U1 'e'.    
+0004d120: 2020 2020 2020 2020 666c 6f61 7420 2020          float   
+0004d130: 2028 7929 206f 626a 6563 7420 2765 2720   (y) object 'e' 
+0004d140: 2761 2720 2763 270a 2020 2020 2020 2020  'a' 'c'.        
+0004d150: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+0004d160: 726e 2073 656c 662e 6d61 7028 0a20 2020  rn self.map(.   
+0004d170: 2020 2020 2020 2020 206d 6574 686f 6463           methodc
+0004d180: 616c 6c65 7228 0a20 2020 2020 2020 2020  aller(.         
+0004d190: 2020 2020 2020 2022 6964 786d 696e 222c         "idxmin",
+0004d1a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0004d1b0: 2064 696d 3d64 696d 2c0a 2020 2020 2020   dim=dim,.      
+0004d1c0: 2020 2020 2020 2020 2020 736b 6970 6e61            skipna
+0004d1d0: 3d73 6b69 706e 612c 0a20 2020 2020 2020  =skipna,.       
+0004d1e0: 2020 2020 2020 2020 2066 696c 6c5f 7661           fill_va
+0004d1f0: 6c75 653d 6669 6c6c 5f76 616c 7565 2c0a  lue=fill_value,.
+0004d200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004d210: 6b65 6570 5f61 7474 7273 3d6b 6565 705f  keep_attrs=keep_
+0004d220: 6174 7472 732c 0a20 2020 2020 2020 2020  attrs,.         
+0004d230: 2020 2029 0a20 2020 2020 2020 2029 0a0a     ).        )..
+0004d240: 2020 2020 6465 6620 6964 786d 6178 280a      def idxmax(.
+0004d250: 2020 2020 2020 2020 7365 6c66 3a20 545f          self: T_
+0004d260: 4461 7461 7365 742c 0a20 2020 2020 2020  Dataset,.       
+0004d270: 2064 696d 3a20 4861 7368 6162 6c65 207c   dim: Hashable |
+0004d280: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+0004d290: 2020 2020 2020 736b 6970 6e61 3a20 626f        skipna: bo
+0004d2a0: 6f6c 207c 204e 6f6e 6520 3d20 4e6f 6e65  ol | None = None
+0004d2b0: 2c0a 2020 2020 2020 2020 6669 6c6c 5f76  ,.        fill_v
+0004d2c0: 616c 7565 3a20 416e 7920 3d20 7872 6474  alue: Any = xrdt
+0004d2d0: 7970 6573 2e4e 412c 0a20 2020 2020 2020  ypes.NA,.       
+0004d2e0: 206b 6565 705f 6174 7472 733a 2062 6f6f   keep_attrs: boo
+0004d2f0: 6c20 7c20 4e6f 6e65 203d 204e 6f6e 652c  l | None = None,
+0004d300: 0a20 2020 2029 202d 3e20 545f 4461 7461  .    ) -> T_Data
+0004d310: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+0004d320: 5265 7475 726e 2074 6865 2063 6f6f 7264  Return the coord
+0004d330: 696e 6174 6520 6c61 6265 6c20 6f66 2074  inate label of t
+0004d340: 6865 206d 6178 696d 756d 2076 616c 7565  he maximum value
+0004d350: 2061 6c6f 6e67 2061 2064 696d 656e 7369   along a dimensi
+0004d360: 6f6e 2e0a 0a20 2020 2020 2020 2052 6574  on...        Ret
+0004d370: 7572 6e73 2061 206e 6577 2060 4461 7461  urns a new `Data
+0004d380: 7365 7460 206e 616d 6564 2061 6674 6572  set` named after
+0004d390: 2074 6865 2064 696d 656e 7369 6f6e 2077   the dimension w
+0004d3a0: 6974 6820 7468 6520 7661 6c75 6573 206f  ith the values o
+0004d3b0: 660a 2020 2020 2020 2020 7468 6520 636f  f.        the co
+0004d3c0: 6f72 6469 6e61 7465 206c 6162 656c 7320  ordinate labels 
+0004d3d0: 616c 6f6e 6720 7468 6174 2064 696d 656e  along that dimen
+0004d3e0: 7369 6f6e 2063 6f72 7265 7370 6f6e 6469  sion correspondi
+0004d3f0: 6e67 2074 6f20 6d61 7869 6d75 6d0a 2020  ng to maximum.  
+0004d400: 2020 2020 2020 7661 6c75 6573 2061 6c6f        values alo
+0004d410: 6e67 2074 6861 7420 6469 6d65 6e73 696f  ng that dimensio
+0004d420: 6e2e 0a0a 2020 2020 2020 2020 496e 2063  n...        In c
+0004d430: 6f6d 7061 7269 736f 6e20 746f 203a 7079  omparison to :py
+0004d440: 3a6d 6574 683a 607e 4461 7461 7365 742e  :meth:`~Dataset.
+0004d450: 6172 676d 6178 602c 2074 6869 7320 7265  argmax`, this re
+0004d460: 7475 726e 7320 7468 650a 2020 2020 2020  turns the.      
+0004d470: 2020 636f 6f72 6469 6e61 7465 206c 6162    coordinate lab
+0004d480: 656c 2077 6869 6c65 203a 7079 3a6d 6574  el while :py:met
+0004d490: 683a 607e 4461 7461 7365 742e 6172 676d  h:`~Dataset.argm
+0004d4a0: 6178 6020 7265 7475 726e 7320 7468 6520  ax` returns the 
+0004d4b0: 696e 6465 782e 0a0a 2020 2020 2020 2020  index...        
+0004d4c0: 5061 7261 6d65 7465 7273 0a20 2020 2020  Parameters.     
+0004d4d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a 2020     ----------.  
+0004d4e0: 2020 2020 2020 6469 6d20 3a20 7374 722c        dim : str,
+0004d4f0: 206f 7074 696f 6e61 6c0a 2020 2020 2020   optional.      
+0004d500: 2020 2020 2020 4469 6d65 6e73 696f 6e20        Dimension 
+0004d510: 6f76 6572 2077 6869 6368 2074 6f20 6170  over which to ap
+0004d520: 706c 7920 6069 6478 6d61 7860 2e20 2054  ply `idxmax`.  T
+0004d530: 6869 7320 6973 206f 7074 696f 6e61 6c20  his is optional 
+0004d540: 666f 7220 3144 0a20 2020 2020 2020 2020  for 1D.         
+0004d550: 2020 2076 6172 6961 626c 6573 2c20 6275     variables, bu
+0004d560: 7420 7265 7175 6972 6564 2066 6f72 2076  t required for v
+0004d570: 6172 6961 626c 6573 2077 6974 6820 3220  ariables with 2 
+0004d580: 6f72 206d 6f72 6520 6469 6d65 6e73 696f  or more dimensio
+0004d590: 6e73 2e0a 2020 2020 2020 2020 736b 6970  ns..        skip
+0004d5a0: 6e61 203a 2062 6f6f 6c20 6f72 204e 6f6e  na : bool or Non
+0004d5b0: 652c 206f 7074 696f 6e61 6c0a 2020 2020  e, optional.    
+0004d5c0: 2020 2020 2020 2020 4966 2054 7275 652c          If True,
+0004d5d0: 2073 6b69 7020 6d69 7373 696e 6720 7661   skip missing va
+0004d5e0: 6c75 6573 2028 6173 206d 6172 6b65 6420  lues (as marked 
+0004d5f0: 6279 204e 614e 292e 2042 7920 6465 6661  by NaN). By defa
+0004d600: 756c 742c 206f 6e6c 790a 2020 2020 2020  ult, only.      
+0004d610: 2020 2020 2020 736b 6970 7320 6d69 7373        skips miss
+0004d620: 696e 6720 7661 6c75 6573 2066 6f72 2060  ing values for `
+0004d630: 6066 6c6f 6174 6060 2c20 6060 636f 6d70  `float``, ``comp
+0004d640: 6c65 7860 602c 2061 6e64 2060 606f 626a  lex``, and ``obj
+0004d650: 6563 7460 600a 2020 2020 2020 2020 2020  ect``.          
+0004d660: 2020 6474 7970 6573 3b20 6f74 6865 7220    dtypes; other 
+0004d670: 6474 7970 6573 2065 6974 6865 7220 646f  dtypes either do
+0004d680: 206e 6f74 2068 6176 6520 6120 7365 6e74   not have a sent
+0004d690: 696e 656c 206d 6973 7369 6e67 2076 616c  inel missing val
+0004d6a0: 7565 0a20 2020 2020 2020 2020 2020 2028  ue.            (
+0004d6b0: 6060 696e 7460 6029 206f 7220 6060 736b  ``int``) or ``sk
+0004d6c0: 6970 6e61 3d54 7275 6560 6020 6861 7320  ipna=True`` has 
+0004d6d0: 6e6f 7420 6265 656e 2069 6d70 6c65 6d65  not been impleme
+0004d6e0: 6e74 6564 0a20 2020 2020 2020 2020 2020  nted.           
+0004d6f0: 2028 6060 6461 7465 7469 6d65 3634 6060   (``datetime64``
+0004d700: 206f 7220 6060 7469 6d65 6465 6c74 6136   or ``timedelta6
+0004d710: 3460 6029 2e0a 2020 2020 2020 2020 6669  4``)..        fi
+0004d720: 6c6c 5f76 616c 7565 203a 2041 6e79 2c20  ll_value : Any, 
+0004d730: 6465 6661 756c 743a 204e 614e 0a20 2020  default: NaN.   
+0004d740: 2020 2020 2020 2020 2056 616c 7565 2074           Value t
+0004d750: 6f20 6265 2066 696c 6c65 6420 696e 2063  o be filled in c
+0004d760: 6173 6520 616c 6c20 6f66 2074 6865 2076  ase all of the v
+0004d770: 616c 7565 7320 616c 6f6e 6720 6120 6469  alues along a di
+0004d780: 6d65 6e73 696f 6e20 6172 650a 2020 2020  mension are.    
+0004d790: 2020 2020 2020 2020 6e75 6c6c 2e20 2042          null.  B
+0004d7a0: 7920 6465 6661 756c 7420 7468 6973 2069  y default this i
+0004d7b0: 7320 4e61 4e2e 2020 5468 6520 6669 6c6c  s NaN.  The fill
+0004d7c0: 2076 616c 7565 2061 6e64 2072 6573 756c   value and resul
+0004d7d0: 7420 6172 650a 2020 2020 2020 2020 2020  t are.          
+0004d7e0: 2020 6175 746f 6d61 7469 6361 6c6c 7920    automatically 
+0004d7f0: 636f 6e76 6572 7465 6420 746f 2061 2063  converted to a c
+0004d800: 6f6d 7061 7469 626c 6520 6474 7970 6520  ompatible dtype 
+0004d810: 6966 2070 6f73 7369 626c 652e 0a20 2020  if possible..   
+0004d820: 2020 2020 2020 2020 2049 676e 6f72 6564           Ignored
+0004d830: 2069 6620 6060 736b 6970 6e61 6060 2069   if ``skipna`` i
+0004d840: 7320 4661 6c73 652e 0a20 2020 2020 2020  s False..       
+0004d850: 206b 6565 705f 6174 7472 7320 3a20 626f   keep_attrs : bo
+0004d860: 6f6c 206f 7220 4e6f 6e65 2c20 6f70 7469  ol or None, opti
+0004d870: 6f6e 616c 0a20 2020 2020 2020 2020 2020  onal.           
+0004d880: 2049 6620 5472 7565 2c20 7468 6520 6174   If True, the at
+0004d890: 7472 6962 7574 6573 2028 6060 6174 7472  tributes (``attr
+0004d8a0: 7360 6029 2077 696c 6c20 6265 2063 6f70  s``) will be cop
+0004d8b0: 6965 6420 6672 6f6d 2074 6865 0a20 2020  ied from the.   
+0004d8c0: 2020 2020 2020 2020 206f 7269 6769 6e61           origina
+0004d8d0: 6c20 6f62 6a65 6374 2074 6f20 7468 6520  l object to the 
+0004d8e0: 6e65 7720 6f6e 652e 2049 6620 4661 6c73  new one. If Fals
+0004d8f0: 652c 2074 6865 206e 6577 206f 626a 6563  e, the new objec
+0004d900: 740a 2020 2020 2020 2020 2020 2020 7769  t.            wi
+0004d910: 6c6c 2062 6520 7265 7475 726e 6564 2077  ll be returned w
+0004d920: 6974 686f 7574 2061 7474 7269 6275 7465  ithout attribute
+0004d930: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
+0004d940: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+0004d950: 2d2d 2d0a 2020 2020 2020 2020 7265 6475  ---.        redu
+0004d960: 6365 6420 3a20 4461 7461 7365 740a 2020  ced : Dataset.  
+0004d970: 2020 2020 2020 2020 2020 4e65 7720 6044            New `D
+0004d980: 6174 6173 6574 6020 6f62 6a65 6374 2077  ataset` object w
+0004d990: 6974 6820 6069 6478 6d61 7860 2061 7070  ith `idxmax` app
+0004d9a0: 6c69 6564 2074 6f20 6974 7320 6461 7461  lied to its data
+0004d9b0: 2061 6e64 2074 6865 0a20 2020 2020 2020   and the.       
+0004d9c0: 2020 2020 2069 6e64 6963 6174 6564 2064       indicated d
+0004d9d0: 696d 656e 7369 6f6e 2072 656d 6f76 6564  imension removed
+0004d9e0: 2e0a 0a20 2020 2020 2020 2053 6565 2041  ...        See A
+0004d9f0: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+0004da00: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
+0004da10: 6141 7272 6179 2e69 6478 6d61 782c 2044  aArray.idxmax, D
+0004da20: 6174 6173 6574 2e69 6478 6d69 6e2c 2044  ataset.idxmin, D
+0004da30: 6174 6173 6574 2e6d 6178 2c20 4461 7461  ataset.max, Data
+0004da40: 7365 742e 6172 676d 6178 0a0a 2020 2020  set.argmax..    
+0004da50: 2020 2020 4578 616d 706c 6573 0a20 2020      Examples.   
+0004da60: 2020 2020 202d 2d2d 2d2d 2d2d 2d0a 2020       --------.  
+0004da70: 2020 2020 2020 3e3e 3e20 6172 7261 7931        >>> array1
+0004da80: 203d 2078 722e 4461 7461 4172 7261 7928   = xr.DataArray(
+0004da90: 0a20 2020 2020 2020 202e 2e2e 2020 2020  .        ...    
+0004daa0: 205b 302c 2032 2c20 312c 2030 2c20 2d32   [0, 2, 1, 0, -2
+0004dab0: 5d2c 2064 696d 733d 2278 222c 2063 6f6f  ], dims="x", coo
+0004dac0: 7264 733d 7b22 7822 3a20 5b22 6122 2c20  rds={"x": ["a", 
+0004dad0: 2262 222c 2022 6322 2c20 2264 222c 2022  "b", "c", "d", "
+0004dae0: 6522 5d7d 0a20 2020 2020 2020 202e 2e2e  e"]}.        ...
+0004daf0: 2029 0a20 2020 2020 2020 203e 3e3e 2061   ).        >>> a
+0004db00: 7272 6179 3220 3d20 7872 2e44 6174 6141  rray2 = xr.DataA
+0004db10: 7272 6179 280a 2020 2020 2020 2020 2e2e  rray(.        ..
+0004db20: 2e20 2020 2020 5b0a 2020 2020 2020 2020  .     [.        
+0004db30: 2e2e 2e20 2020 2020 2020 2020 5b32 2e30  ...         [2.0
+0004db40: 2c20 312e 302c 2032 2e30 2c20 302e 302c  , 1.0, 2.0, 0.0,
+0004db50: 202d 322e 305d 2c0a 2020 2020 2020 2020   -2.0],.        
+0004db60: 2e2e 2e20 2020 2020 2020 2020 5b2d 342e  ...         [-4.
+0004db70: 302c 206e 702e 4e61 4e2c 2032 2e30 2c20  0, np.NaN, 2.0, 
+0004db80: 6e70 2e4e 614e 2c20 2d32 2e30 5d2c 0a20  np.NaN, -2.0],. 
+0004db90: 2020 2020 2020 202e 2e2e 2020 2020 2020         ...      
+0004dba0: 2020 205b 6e70 2e4e 614e 2c20 6e70 2e4e     [np.NaN, np.N
+0004dbb0: 614e 2c20 312e 302c 206e 702e 4e61 4e2c  aN, 1.0, np.NaN,
+0004dbc0: 206e 702e 4e61 4e5d 2c0a 2020 2020 2020   np.NaN],.      
+0004dbd0: 2020 2e2e 2e20 2020 2020 5d2c 0a20 2020    ...     ],.   
+0004dbe0: 2020 2020 202e 2e2e 2020 2020 2064 696d       ...     dim
+0004dbf0: 733d 5b22 7922 2c20 2278 225d 2c0a 2020  s=["y", "x"],.  
+0004dc00: 2020 2020 2020 2e2e 2e20 2020 2020 636f        ...     co
+0004dc10: 6f72 6473 3d7b 2279 223a 205b 2d31 2c20  ords={"y": [-1, 
+0004dc20: 302c 2031 5d2c 2022 7822 3a20 5b22 6122  0, 1], "x": ["a"
+0004dc30: 2c20 2262 222c 2022 6322 2c20 2264 222c  , "b", "c", "d",
+0004dc40: 2022 6522 5d7d 2c0a 2020 2020 2020 2020   "e"]},.        
+0004dc50: 2e2e 2e20 290a 2020 2020 2020 2020 3e3e  ... ).        >>
+0004dc60: 3e20 6473 203d 2078 722e 4461 7461 7365  > ds = xr.Datase
+0004dc70: 7428 7b22 696e 7422 3a20 6172 7261 7931  t({"int": array1
+0004dc80: 2c20 2266 6c6f 6174 223a 2061 7272 6179  , "float": array
+0004dc90: 327d 290a 2020 2020 2020 2020 3e3e 3e20  2}).        >>> 
+0004dca0: 6473 2e6d 6178 2864 696d 3d22 7822 290a  ds.max(dim="x").
+0004dcb0: 2020 2020 2020 2020 3c78 6172 7261 792e          <xarray.
+0004dcc0: 4461 7461 7365 743e 0a20 2020 2020 2020  Dataset>.       
+0004dcd0: 2044 696d 656e 7369 6f6e 733a 2020 2879   Dimensions:  (y
+0004dce0: 3a20 3329 0a20 2020 2020 2020 2043 6f6f  : 3).        Coo
+0004dcf0: 7264 696e 6174 6573 3a0a 2020 2020 2020  rdinates:.      
+0004dd00: 2020 2020 2a20 7920 2020 2020 2020 2028      * y        (
+0004dd10: 7929 2069 6e74 3634 202d 3120 3020 310a  y) int64 -1 0 1.
+0004dd20: 2020 2020 2020 2020 4461 7461 2076 6172          Data var
+0004dd30: 6961 626c 6573 3a0a 2020 2020 2020 2020  iables:.        
+0004dd40: 2020 2020 696e 7420 2020 2020 2069 6e74      int      int
+0004dd50: 3634 2032 0a20 2020 2020 2020 2020 2020  64 2.           
+0004dd60: 2066 6c6f 6174 2020 2020 2879 2920 666c   float    (y) fl
+0004dd70: 6f61 7436 3420 322e 3020 322e 3020 312e  oat64 2.0 2.0 1.
+0004dd80: 300a 2020 2020 2020 2020 3e3e 3e20 6473  0.        >>> ds
+0004dd90: 2e61 7267 6d61 7828 6469 6d3d 2278 2229  .argmax(dim="x")
+0004dda0: 0a20 2020 2020 2020 203c 7861 7272 6179  .        <xarray
+0004ddb0: 2e44 6174 6173 6574 3e0a 2020 2020 2020  .Dataset>.      
+0004ddc0: 2020 4469 6d65 6e73 696f 6e73 3a20 2028    Dimensions:  (
+0004ddd0: 793a 2033 290a 2020 2020 2020 2020 436f  y: 3).        Co
+0004dde0: 6f72 6469 6e61 7465 733a 0a20 2020 2020  ordinates:.     
+0004ddf0: 2020 2020 202a 2079 2020 2020 2020 2020       * y        
+0004de00: 2879 2920 696e 7436 3420 2d31 2030 2031  (y) int64 -1 0 1
+0004de10: 0a20 2020 2020 2020 2044 6174 6120 7661  .        Data va
+0004de20: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
+0004de30: 2020 2020 2069 6e74 2020 2020 2020 696e       int      in
+0004de40: 7436 3420 310a 2020 2020 2020 2020 2020  t64 1.          
+0004de50: 2020 666c 6f61 7420 2020 2028 7929 2069    float    (y) i
+0004de60: 6e74 3634 2030 2032 2032 0a20 2020 2020  nt64 0 2 2.     
+0004de70: 2020 203e 3e3e 2064 732e 6964 786d 6178     >>> ds.idxmax
+0004de80: 2864 696d 3d22 7822 290a 2020 2020 2020  (dim="x").      
+0004de90: 2020 3c78 6172 7261 792e 4461 7461 7365    <xarray.Datase
+0004dea0: 743e 0a20 2020 2020 2020 2044 696d 656e  t>.        Dimen
+0004deb0: 7369 6f6e 733a 2020 2879 3a20 3329 0a20  sions:  (y: 3). 
+0004dec0: 2020 2020 2020 2043 6f6f 7264 696e 6174         Coordinat
+0004ded0: 6573 3a0a 2020 2020 2020 2020 2020 2a20  es:.          * 
+0004dee0: 7920 2020 2020 2020 2028 7929 2069 6e74  y        (y) int
+0004def0: 3634 202d 3120 3020 310a 2020 2020 2020  64 -1 0 1.      
+0004df00: 2020 4461 7461 2076 6172 6961 626c 6573    Data variables
+0004df10: 3a0a 2020 2020 2020 2020 2020 2020 696e  :.            in
+0004df20: 7420 2020 2020 203c 5531 2027 6227 0a20  t      <U1 'b'. 
+0004df30: 2020 2020 2020 2020 2020 2066 6c6f 6174             float
+0004df40: 2020 2020 2879 2920 6f62 6a65 6374 2027      (y) object '
+0004df50: 6127 2027 6327 2027 6327 0a20 2020 2020  a' 'c' 'c'.     
+0004df60: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+0004df70: 6574 7572 6e20 7365 6c66 2e6d 6170 280a  eturn self.map(.
+0004df80: 2020 2020 2020 2020 2020 2020 6d65 7468              meth
+0004df90: 6f64 6361 6c6c 6572 280a 2020 2020 2020  odcaller(.      
+0004dfa0: 2020 2020 2020 2020 2020 2269 6478 6d61            "idxma
+0004dfb0: 7822 2c0a 2020 2020 2020 2020 2020 2020  x",.            
+0004dfc0: 2020 2020 6469 6d3d 6469 6d2c 0a20 2020      dim=dim,.   
+0004dfd0: 2020 2020 2020 2020 2020 2020 2073 6b69               ski
+0004dfe0: 706e 613d 736b 6970 6e61 2c0a 2020 2020  pna=skipna,.    
+0004dff0: 2020 2020 2020 2020 2020 2020 6669 6c6c              fill
+0004e000: 5f76 616c 7565 3d66 696c 6c5f 7661 6c75  _value=fill_valu
+0004e010: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+0004e020: 2020 206b 6565 705f 6174 7472 733d 6b65     keep_attrs=ke
+0004e030: 6570 5f61 7474 7273 2c0a 2020 2020 2020  ep_attrs,.      
+0004e040: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0004e050: 290a 0a20 2020 2064 6566 2061 7267 6d69  )..    def argmi
+0004e060: 6e28 7365 6c66 3a20 545f 4461 7461 7365  n(self: T_Datase
+0004e070: 742c 2064 696d 3a20 4861 7368 6162 6c65  t, dim: Hashable
+0004e080: 207c 204e 6f6e 6520 3d20 4e6f 6e65 2c20   | None = None, 
+0004e090: 2a2a 6b77 6172 6773 2920 2d3e 2054 5f44  **kwargs) -> T_D
+0004e0a0: 6174 6173 6574 3a0a 2020 2020 2020 2020  ataset:.        
+0004e0b0: 2222 2249 6e64 6963 6573 206f 6620 7468  """Indices of th
+0004e0c0: 6520 6d69 6e69 6d61 206f 6620 7468 6520  e minima of the 
+0004e0d0: 6d65 6d62 6572 2076 6172 6961 626c 6573  member variables
+0004e0e0: 2e0a 0a20 2020 2020 2020 2049 6620 7468  ...        If th
+0004e0f0: 6572 6520 6172 6520 6d75 6c74 6970 6c65  ere are multiple
+0004e100: 206d 696e 696d 612c 2074 6865 2069 6e64   minima, the ind
+0004e110: 6963 6573 206f 6620 7468 6520 6669 7273  ices of the firs
+0004e120: 7420 6f6e 6520 666f 756e 6420 7769 6c6c  t one found will
+0004e130: 2062 650a 2020 2020 2020 2020 7265 7475   be.        retu
+0004e140: 726e 6564 2e0a 0a20 2020 2020 2020 2050  rned...        P
+0004e150: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+0004e160: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+0004e170: 2020 2020 2064 696d 203a 2048 6173 6861       dim : Hasha
+0004e180: 626c 652c 206f 7074 696f 6e61 6c0a 2020  ble, optional.  
+0004e190: 2020 2020 2020 2020 2020 5468 6520 6469            The di
+0004e1a0: 6d65 6e73 696f 6e20 6f76 6572 2077 6869  mension over whi
+0004e1b0: 6368 2074 6f20 6669 6e64 2074 6865 206d  ch to find the m
+0004e1c0: 696e 696d 756d 2e20 4279 2064 6566 6175  inimum. By defau
+0004e1d0: 6c74 2c20 6669 6e64 7320 6d69 6e69 6d75  lt, finds minimu
+0004e1e0: 6d20 6f76 6572 0a20 2020 2020 2020 2020  m over.         
+0004e1f0: 2020 2061 6c6c 2064 696d 656e 7369 6f6e     all dimension
+0004e200: 7320 2d20 666f 7220 6e6f 7720 7265 7475  s - for now retu
+0004e210: 726e 696e 6720 616e 2069 6e74 2066 6f72  rning an int for
+0004e220: 2062 6163 6b77 6172 6420 636f 6d70 6174   backward compat
+0004e230: 6962 696c 6974 792c 2062 7574 0a20 2020  ibility, but.   
+0004e240: 2020 2020 2020 2020 2074 6869 7320 6973           this is
+0004e250: 2064 6570 7265 6361 7465 642c 2069 6e20   deprecated, in 
+0004e260: 6675 7475 7265 2077 696c 6c20 6265 2061  future will be a
+0004e270: 6e20 6572 726f 722c 2073 696e 6365 2044  n error, since D
+0004e280: 6174 6141 7272 6179 2e61 7267 6d69 6e20  ataArray.argmin 
+0004e290: 7769 6c6c 0a20 2020 2020 2020 2020 2020  will.           
+0004e2a0: 2072 6574 7572 6e20 6120 6469 6374 2077   return a dict w
+0004e2b0: 6974 6820 696e 6469 6365 7320 666f 7220  ith indices for 
+0004e2c0: 616c 6c20 6469 6d65 6e73 696f 6e73 2c20  all dimensions, 
+0004e2d0: 7768 6963 6820 646f 6573 206e 6f74 206d  which does not m
+0004e2e0: 616b 6520 7365 6e73 6520 666f 720a 2020  ake sense for.  
+0004e2f0: 2020 2020 2020 2020 2020 6120 4461 7461            a Data
+0004e300: 7365 742e 0a20 2020 2020 2020 206b 6565  set..        kee
+0004e310: 705f 6174 7472 7320 3a20 626f 6f6c 2c20  p_attrs : bool, 
+0004e320: 6f70 7469 6f6e 616c 0a20 2020 2020 2020  optional.       
+0004e330: 2020 2020 2049 6620 5472 7565 2c20 7468       If True, th
+0004e340: 6520 6174 7472 6962 7574 6573 2028 6061  e attributes (`a
+0004e350: 7474 7273 6029 2077 696c 6c20 6265 2063  ttrs`) will be c
+0004e360: 6f70 6965 6420 6672 6f6d 2074 6865 206f  opied from the o
+0004e370: 7269 6769 6e61 6c0a 2020 2020 2020 2020  riginal.        
+0004e380: 2020 2020 6f62 6a65 6374 2074 6f20 7468      object to th
+0004e390: 6520 6e65 7720 6f6e 652e 2020 4966 2046  e new one.  If F
+0004e3a0: 616c 7365 2028 6465 6661 756c 7429 2c20  alse (default), 
+0004e3b0: 7468 6520 6e65 7720 6f62 6a65 6374 2077  the new object w
+0004e3c0: 696c 6c20 6265 0a20 2020 2020 2020 2020  ill be.         
+0004e3d0: 2020 2072 6574 7572 6e65 6420 7769 7468     returned with
+0004e3e0: 6f75 7420 6174 7472 6962 7574 6573 2e0a  out attributes..
+0004e3f0: 2020 2020 2020 2020 736b 6970 6e61 203a          skipna :
+0004e400: 2062 6f6f 6c2c 206f 7074 696f 6e61 6c0a   bool, optional.
+0004e410: 2020 2020 2020 2020 2020 2020 4966 2054              If T
+0004e420: 7275 652c 2073 6b69 7020 6d69 7373 696e  rue, skip missin
+0004e430: 6720 7661 6c75 6573 2028 6173 206d 6172  g values (as mar
+0004e440: 6b65 6420 6279 204e 614e 292e 2042 7920  ked by NaN). By 
+0004e450: 6465 6661 756c 742c 206f 6e6c 790a 2020  default, only.  
+0004e460: 2020 2020 2020 2020 2020 736b 6970 7320            skips 
+0004e470: 6d69 7373 696e 6720 7661 6c75 6573 2066  missing values f
+0004e480: 6f72 2066 6c6f 6174 2064 7479 7065 733b  or float dtypes;
+0004e490: 206f 7468 6572 2064 7479 7065 7320 6569   other dtypes ei
+0004e4a0: 7468 6572 2064 6f20 6e6f 740a 2020 2020  ther do not.    
+0004e4b0: 2020 2020 2020 2020 6861 7665 2061 2073          have a s
+0004e4c0: 656e 7469 6e65 6c20 6d69 7373 696e 6720  entinel missing 
+0004e4d0: 7661 6c75 6520 2869 6e74 2920 6f72 2073  value (int) or s
+0004e4e0: 6b69 706e 613d 5472 7565 2068 6173 206e  kipna=True has n
+0004e4f0: 6f74 2062 6565 6e0a 2020 2020 2020 2020  ot been.        
+0004e500: 2020 2020 696d 706c 656d 656e 7465 6420      implemented 
+0004e510: 286f 626a 6563 742c 2064 6174 6574 696d  (object, datetim
+0004e520: 6536 3420 6f72 2074 696d 6564 656c 7461  e64 or timedelta
+0004e530: 3634 292e 0a0a 2020 2020 2020 2020 5265  64)...        Re
+0004e540: 7475 726e 730a 2020 2020 2020 2020 2d2d  turns.        --
+0004e550: 2d2d 2d2d 2d0a 2020 2020 2020 2020 7265  -----.        re
+0004e560: 7375 6c74 203a 2044 6174 6173 6574 0a0a  sult : Dataset..
+0004e570: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+0004e580: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0004e590: 2d0a 2020 2020 2020 2020 4461 7461 4172  -.        DataAr
+0004e5a0: 7261 792e 6172 676d 696e 0a20 2020 2020  ray.argmin.     
+0004e5b0: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0004e5c0: 6620 6469 6d20 6973 204e 6f6e 653a 0a20  f dim is None:. 
+0004e5d0: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
+0004e5e0: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
+0004e5f0: 2020 2020 2020 2020 2020 224f 6e63 6520            "Once 
+0004e600: 7468 6520 6265 6861 7669 6f75 7220 6f66  the behaviour of
+0004e610: 2044 6174 6141 7272 6179 2e61 7267 6d69   DataArray.argmi
+0004e620: 6e28 2920 616e 6420 5661 7269 6162 6c65  n() and Variable
+0004e630: 2e61 7267 6d69 6e28 2920 7769 7468 6f75  .argmin() withou
+0004e640: 7420 220a 2020 2020 2020 2020 2020 2020  t ".            
+0004e650: 2020 2020 2264 696d 2063 6861 6e67 6573      "dim changes
+0004e660: 2074 6f20 7265 7475 726e 2061 2064 6963   to return a dic
+0004e670: 7420 6f66 2069 6e64 6963 6573 206f 6620  t of indices of 
+0004e680: 6561 6368 2064 696d 656e 7369 6f6e 2c20  each dimension, 
+0004e690: 666f 7220 220a 2020 2020 2020 2020 2020  for ".          
+0004e6a0: 2020 2020 2020 2263 6f6e 7369 7374 656e        "consisten
+0004e6b0: 6379 2069 7420 7769 6c6c 2062 6520 616e  cy it will be an
+0004e6c0: 2065 7272 6f72 2074 6f20 6361 6c6c 2044   error to call D
+0004e6d0: 6174 6173 6574 2e61 7267 6d69 6e28 2920  ataset.argmin() 
+0004e6e0: 7769 7468 206e 6f20 6172 6775 6d65 6e74  with no argument
+0004e6f0: 2c22 0a20 2020 2020 2020 2020 2020 2020  ,".             
+0004e700: 2020 2022 7369 6e63 6520 7765 2064 6f6e     "since we don
+0004e710: 2774 2072 6574 7572 6e20 6120 6469 6374  't return a dict
+0004e720: 206f 6620 4461 7461 7365 7473 2e22 2c0a   of Datasets.",.
+0004e730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004e740: 4465 7072 6563 6174 696f 6e57 6172 6e69  DeprecationWarni
+0004e750: 6e67 2c0a 2020 2020 2020 2020 2020 2020  ng,.            
+0004e760: 2020 2020 7374 6163 6b6c 6576 656c 3d32      stacklevel=2
+0004e770: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+0004e780: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
+0004e790: 2020 2020 2020 2020 2064 696d 2069 7320           dim is 
+0004e7a0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+0004e7b0: 206f 7220 286e 6f74 2069 7369 6e73 7461   or (not isinsta
+0004e7c0: 6e63 6528 6469 6d2c 2053 6571 7565 6e63  nce(dim, Sequenc
+0004e7d0: 6529 2061 6e64 2064 696d 2069 7320 6e6f  e) and dim is no
+0004e7e0: 7420 2e2e 2e29 0a20 2020 2020 2020 2020  t ...).         
+0004e7f0: 2020 206f 7220 6973 696e 7374 616e 6365     or isinstance
+0004e800: 2864 696d 2c20 7374 7229 0a20 2020 2020  (dim, str).     
+0004e810: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+0004e820: 2020 2320 5265 7475 726e 2069 6e74 2069    # Return int i
+0004e830: 6e64 6578 2069 6620 7369 6e67 6c65 2064  ndex if single d
+0004e840: 696d 656e 7369 6f6e 2069 7320 7061 7373  imension is pass
+0004e850: 6564 2c20 616e 6420 6973 206e 6f74 2070  ed, and is not p
+0004e860: 6172 7420 6f66 2061 0a20 2020 2020 2020  art of a.       
+0004e870: 2020 2020 2023 2073 6571 7565 6e63 650a       # sequence.
+0004e880: 2020 2020 2020 2020 2020 2020 6172 676d              argm
+0004e890: 696e 5f66 756e 6320 3d20 6765 7461 7474  in_func = getatt
+0004e8a0: 7228 6475 636b 5f61 7272 6179 5f6f 7073  r(duck_array_ops
+0004e8b0: 2c20 2261 7267 6d69 6e22 290a 2020 2020  , "argmin").    
+0004e8c0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0004e8d0: 656c 662e 7265 6475 6365 280a 2020 2020  elf.reduce(.    
+0004e8e0: 2020 2020 2020 2020 2020 2020 6172 676d              argm
+0004e8f0: 696e 5f66 756e 632c 2064 696d 3d4e 6f6e  in_func, dim=Non
+0004e900: 6520 6966 2064 696d 2069 7320 4e6f 6e65  e if dim is None
+0004e910: 2065 6c73 6520 5b64 696d 5d2c 202a 2a6b   else [dim], **k
+0004e920: 7761 7267 730a 2020 2020 2020 2020 2020  wargs.          
+0004e930: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+0004e940: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0004e950: 6973 6520 5661 6c75 6545 7272 6f72 280a  ise ValueError(.
+0004e960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0004e970: 2257 6865 6e20 6469 6d20 6973 2061 2073  "When dim is a s
+0004e980: 6571 7565 6e63 6520 6f72 202e 2e2e 2c20  equence or ..., 
+0004e990: 4461 7461 4172 7261 792e 6172 676d 696e  DataArray.argmin
+0004e9a0: 2829 2072 6574 7572 6e73 2061 2064 6963  () returns a dic
+0004e9b0: 742e 2022 0a20 2020 2020 2020 2020 2020  t. ".           
+0004e9c0: 2020 2020 2022 6469 6374 7320 6361 6e6e       "dicts cann
+0004e9d0: 6f74 2062 6520 636f 6e74 6169 6e65 6420  ot be contained 
+0004e9e0: 696e 2061 2044 6174 6173 6574 2c20 736f  in a Dataset, so
+0004e9f0: 2063 616e 6e6f 7420 6361 6c6c 2022 0a20   cannot call ". 
+0004ea00: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0004ea10: 4461 7461 7365 742e 6172 676d 696e 2829  Dataset.argmin()
+0004ea20: 2077 6974 6820 6120 7365 7175 656e 6365   with a sequence
+0004ea30: 206f 7220 2e2e 2e20 666f 7220 6469 6d22   or ... for dim"
+0004ea40: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+0004ea50: 2020 2020 6465 6620 6172 676d 6178 2873      def argmax(s
+0004ea60: 656c 663a 2054 5f44 6174 6173 6574 2c20  elf: T_Dataset, 
+0004ea70: 6469 6d3a 2048 6173 6861 626c 6520 7c20  dim: Hashable | 
+0004ea80: 4e6f 6e65 203d 204e 6f6e 652c 202a 2a6b  None = None, **k
+0004ea90: 7761 7267 7329 202d 3e20 545f 4461 7461  wargs) -> T_Data
+0004eaa0: 7365 743a 0a20 2020 2020 2020 2022 2222  set:.        """
+0004eab0: 496e 6469 6365 7320 6f66 2074 6865 206d  Indices of the m
+0004eac0: 6178 696d 6120 6f66 2074 6865 206d 656d  axima of the mem
+0004ead0: 6265 7220 7661 7269 6162 6c65 732e 0a0a  ber variables...
+0004eae0: 2020 2020 2020 2020 4966 2074 6865 7265          If there
+0004eaf0: 2061 7265 206d 756c 7469 706c 6520 6d61   are multiple ma
+0004eb00: 7869 6d61 2c20 7468 6520 696e 6469 6365  xima, the indice
+0004eb10: 7320 6f66 2074 6865 2066 6972 7374 206f  s of the first o
+0004eb20: 6e65 2066 6f75 6e64 2077 696c 6c20 6265  ne found will be
+0004eb30: 0a20 2020 2020 2020 2072 6574 7572 6e65  .        returne
+0004eb40: 642e 0a0a 2020 2020 2020 2020 5061 7261  d...        Para
+0004eb50: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+0004eb60: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+0004eb70: 2020 6469 6d20 3a20 7374 722c 206f 7074    dim : str, opt
+0004eb80: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0004eb90: 2020 5468 6520 6469 6d65 6e73 696f 6e20    The dimension 
+0004eba0: 6f76 6572 2077 6869 6368 2074 6f20 6669  over which to fi
+0004ebb0: 6e64 2074 6865 206d 6178 696d 756d 2e20  nd the maximum. 
+0004ebc0: 4279 2064 6566 6175 6c74 2c20 6669 6e64  By default, find
+0004ebd0: 7320 6d61 7869 6d75 6d20 6f76 6572 0a20  s maximum over. 
+0004ebe0: 2020 2020 2020 2020 2020 2061 6c6c 2064             all d
+0004ebf0: 696d 656e 7369 6f6e 7320 2d20 666f 7220  imensions - for 
+0004ec00: 6e6f 7720 7265 7475 726e 696e 6720 616e  now returning an
+0004ec10: 2069 6e74 2066 6f72 2062 6163 6b77 6172   int for backwar
+0004ec20: 6420 636f 6d70 6174 6962 696c 6974 792c  d compatibility,
+0004ec30: 2062 7574 0a20 2020 2020 2020 2020 2020   but.           
+0004ec40: 2074 6869 7320 6973 2064 6570 7265 6361   this is depreca
+0004ec50: 7465 642c 2069 6e20 6675 7475 7265 2077  ted, in future w
+0004ec60: 696c 6c20 6265 2061 6e20 6572 726f 722c  ill be an error,
+0004ec70: 2073 696e 6365 2044 6174 6141 7272 6179   since DataArray
+0004ec80: 2e61 7267 6d61 7820 7769 6c6c 0a20 2020  .argmax will.   
+0004ec90: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0004eca0: 6120 6469 6374 2077 6974 6820 696e 6469  a dict with indi
+0004ecb0: 6365 7320 666f 7220 616c 6c20 6469 6d65  ces for all dime
+0004ecc0: 6e73 696f 6e73 2c20 7768 6963 6820 646f  nsions, which do
+0004ecd0: 6573 206e 6f74 206d 616b 6520 7365 6e73  es not make sens
+0004ece0: 6520 666f 720a 2020 2020 2020 2020 2020  e for.          
+0004ecf0: 2020 6120 4461 7461 7365 742e 0a20 2020    a Dataset..   
+0004ed00: 2020 2020 206b 6565 705f 6174 7472 7320       keep_attrs 
+0004ed10: 3a20 626f 6f6c 2c20 6f70 7469 6f6e 616c  : bool, optional
+0004ed20: 0a20 2020 2020 2020 2020 2020 2049 6620  .            If 
+0004ed30: 5472 7565 2c20 7468 6520 6174 7472 6962  True, the attrib
+0004ed40: 7574 6573 2028 6061 7474 7273 6029 2077  utes (`attrs`) w
+0004ed50: 696c 6c20 6265 2063 6f70 6965 6420 6672  ill be copied fr
+0004ed60: 6f6d 2074 6865 206f 7269 6769 6e61 6c0a  om the original.
+0004ed70: 2020 2020 2020 2020 2020 2020 6f62 6a65              obje
+0004ed80: 6374 2074 6f20 7468 6520 6e65 7720 6f6e  ct to the new on
+0004ed90: 652e 2020 4966 2046 616c 7365 2028 6465  e.  If False (de
+0004eda0: 6661 756c 7429 2c20 7468 6520 6e65 7720  fault), the new 
+0004edb0: 6f62 6a65 6374 2077 696c 6c20 6265 0a20  object will be. 
+0004edc0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0004edd0: 6e65 6420 7769 7468 6f75 7420 6174 7472  ned without attr
+0004ede0: 6962 7574 6573 2e0a 2020 2020 2020 2020  ibutes..        
+0004edf0: 736b 6970 6e61 203a 2062 6f6f 6c2c 206f  skipna : bool, o
+0004ee00: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+0004ee10: 2020 2020 4966 2054 7275 652c 2073 6b69      If True, ski
+0004ee20: 7020 6d69 7373 696e 6720 7661 6c75 6573  p missing values
+0004ee30: 2028 6173 206d 6172 6b65 6420 6279 204e   (as marked by N
+0004ee40: 614e 292e 2042 7920 6465 6661 756c 742c  aN). By default,
+0004ee50: 206f 6e6c 790a 2020 2020 2020 2020 2020   only.          
+0004ee60: 2020 736b 6970 7320 6d69 7373 696e 6720    skips missing 
+0004ee70: 7661 6c75 6573 2066 6f72 2066 6c6f 6174  values for float
+0004ee80: 2064 7479 7065 733b 206f 7468 6572 2064   dtypes; other d
+0004ee90: 7479 7065 7320 6569 7468 6572 2064 6f20  types either do 
+0004eea0: 6e6f 740a 2020 2020 2020 2020 2020 2020  not.            
+0004eeb0: 6861 7665 2061 2073 656e 7469 6e65 6c20  have a sentinel 
+0004eec0: 6d69 7373 696e 6720 7661 6c75 6520 2869  missing value (i
+0004eed0: 6e74 2920 6f72 2073 6b69 706e 613d 5472  nt) or skipna=Tr
+0004eee0: 7565 2068 6173 206e 6f74 2062 6565 6e0a  ue has not been.
+0004eef0: 2020 2020 2020 2020 2020 2020 696d 706c              impl
+0004ef00: 656d 656e 7465 6420 286f 626a 6563 742c  emented (object,
+0004ef10: 2064 6174 6574 696d 6536 3420 6f72 2074   datetime64 or t
+0004ef20: 696d 6564 656c 7461 3634 292e 0a0a 2020  imedelta64)...  
+0004ef30: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+0004ef40: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+0004ef50: 2020 2020 2020 7265 7375 6c74 203a 2044        result : D
+0004ef60: 6174 6173 6574 0a0a 2020 2020 2020 2020  ataset..        
+0004ef70: 5365 6520 416c 736f 0a20 2020 2020 2020  See Also.       
+0004ef80: 202d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020   --------.      
+0004ef90: 2020 4461 7461 4172 7261 792e 6172 676d    DataArray.argm
+0004efa0: 6178 0a0a 2020 2020 2020 2020 2222 220a  ax..        """.
+0004efb0: 2020 2020 2020 2020 6966 2064 696d 2069          if dim i
+0004efc0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+0004efd0: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
+0004efe0: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+0004eff0: 2020 2022 4f6e 6365 2074 6865 2062 6568     "Once the beh
+0004f000: 6176 696f 7572 206f 6620 4461 7461 4172  aviour of DataAr
+0004f010: 7261 792e 6172 676d 696e 2829 2061 6e64  ray.argmin() and
+0004f020: 2056 6172 6961 626c 652e 6172 676d 696e   Variable.argmin
+0004f030: 2829 2077 6974 686f 7574 2022 0a20 2020  () without ".   
+0004f040: 2020 2020 2020 2020 2020 2020 2022 6469               "di
+0004f050: 6d20 6368 616e 6765 7320 746f 2072 6574  m changes to ret
+0004f060: 7572 6e20 6120 6469 6374 206f 6620 696e  urn a dict of in
+0004f070: 6469 6365 7320 6f66 2065 6163 6820 6469  dices of each di
+0004f080: 6d65 6e73 696f 6e2c 2066 6f72 2022 0a20  mension, for ". 
+0004f090: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+0004f0a0: 636f 6e73 6973 7465 6e63 7920 6974 2077  consistency it w
+0004f0b0: 696c 6c20 6265 2061 6e20 6572 726f 7220  ill be an error 
+0004f0c0: 746f 2063 616c 6c20 4461 7461 7365 742e  to call Dataset.
+0004f0d0: 6172 676d 696e 2829 2077 6974 6820 6e6f  argmin() with no
+0004f0e0: 2061 7267 756d 656e 742c 220a 2020 2020   argument,".    
+0004f0f0: 2020 2020 2020 2020 2020 2020 2273 696e              "sin
+0004f100: 6365 2077 6520 646f 6e27 7420 7265 7475  ce we don't retu
+0004f110: 726e 2061 2064 6963 7420 6f66 2044 6174  rn a dict of Dat
+0004f120: 6173 6574 732e 222c 0a20 2020 2020 2020  asets.",.       
+0004f130: 2020 2020 2020 2020 2044 6570 7265 6361           Depreca
+0004f140: 7469 6f6e 5761 726e 696e 672c 0a20 2020  tionWarning,.   
+0004f150: 2020 2020 2020 2020 2020 2020 2073 7461               sta
+0004f160: 636b 6c65 7665 6c3d 322c 0a20 2020 2020  cklevel=2,.     
+0004f170: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+0004f180: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
+0004f190: 2020 6469 6d20 6973 204e 6f6e 650a 2020    dim is None.  
+0004f1a0: 2020 2020 2020 2020 2020 6f72 2028 6e6f            or (no
+0004f1b0: 7420 6973 696e 7374 616e 6365 2864 696d  t isinstance(dim
+0004f1c0: 2c20 5365 7175 656e 6365 2920 616e 6420  , Sequence) and 
+0004f1d0: 6469 6d20 6973 206e 6f74 202e 2e2e 290a  dim is not ...).
+0004f1e0: 2020 2020 2020 2020 2020 2020 6f72 2069              or i
+0004f1f0: 7369 6e73 7461 6e63 6528 6469 6d2c 2073  sinstance(dim, s
+0004f200: 7472 290a 2020 2020 2020 2020 293a 0a20  tr).        ):. 
+0004f210: 2020 2020 2020 2020 2020 2023 2052 6574             # Ret
+0004f220: 7572 6e20 696e 7420 696e 6465 7820 6966  urn int index if
+0004f230: 2073 696e 676c 6520 6469 6d65 6e73 696f   single dimensio
+0004f240: 6e20 6973 2070 6173 7365 642c 2061 6e64  n is passed, and
+0004f250: 2069 7320 6e6f 7420 7061 7274 206f 6620   is not part of 
+0004f260: 610a 2020 2020 2020 2020 2020 2020 2320  a.            # 
+0004f270: 7365 7175 656e 6365 0a20 2020 2020 2020  sequence.       
+0004f280: 2020 2020 2061 7267 6d61 785f 6675 6e63       argmax_func
+0004f290: 203d 2067 6574 6174 7472 2864 7563 6b5f   = getattr(duck_
+0004f2a0: 6172 7261 795f 6f70 732c 2022 6172 676d  array_ops, "argm
+0004f2b0: 6178 2229 0a20 2020 2020 2020 2020 2020  ax").           
+0004f2c0: 2072 6574 7572 6e20 7365 6c66 2e72 6564   return self.red
+0004f2d0: 7563 6528 0a20 2020 2020 2020 2020 2020  uce(.           
+0004f2e0: 2020 2020 2061 7267 6d61 785f 6675 6e63       argmax_func
+0004f2f0: 2c20 6469 6d3d 4e6f 6e65 2069 6620 6469  , dim=None if di
+0004f300: 6d20 6973 204e 6f6e 6520 656c 7365 205b  m is None else [
+0004f310: 6469 6d5d 2c20 2a2a 6b77 6172 6773 0a20  dim], **kwargs. 
+0004f320: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0004f330: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0004f340: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
+0004f350: 7565 4572 726f 7228 0a20 2020 2020 2020  ueError(.       
+0004f360: 2020 2020 2020 2020 2022 5768 656e 2064           "When d
+0004f370: 696d 2069 7320 6120 7365 7175 656e 6365  im is a sequence
+0004f380: 206f 7220 2e2e 2e2c 2044 6174 6141 7272   or ..., DataArr
+0004f390: 6179 2e61 7267 6d69 6e28 2920 7265 7475  ay.argmin() retu
+0004f3a0: 726e 7320 6120 6469 6374 2e20 220a 2020  rns a dict. ".  
+0004f3b0: 2020 2020 2020 2020 2020 2020 2020 2264                "d
+0004f3c0: 6963 7473 2063 616e 6e6f 7420 6265 2063  icts cannot be c
+0004f3d0: 6f6e 7461 696e 6564 2069 6e20 6120 4461  ontained in a Da
+0004f3e0: 7461 7365 742c 2073 6f20 6361 6e6e 6f74  taset, so cannot
+0004f3f0: 2063 616c 6c20 220a 2020 2020 2020 2020   call ".        
+0004f400: 2020 2020 2020 2020 2244 6174 6173 6574          "Dataset
+0004f410: 2e61 7267 6d69 6e28 2920 7769 7468 2061  .argmin() with a
+0004f420: 2073 6571 7565 6e63 6520 6f72 202e 2e2e   sequence or ...
+0004f430: 2066 6f72 2064 696d 220a 2020 2020 2020   for dim".      
+0004f440: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
+0004f450: 2071 7565 7279 280a 2020 2020 2020 2020   query(.        
+0004f460: 7365 6c66 3a20 545f 4461 7461 7365 742c  self: T_Dataset,
+0004f470: 0a20 2020 2020 2020 2071 7565 7269 6573  .        queries
+0004f480: 3a20 4d61 7070 696e 675b 416e 792c 2041  : Mapping[Any, A
+0004f490: 6e79 5d20 7c20 4e6f 6e65 203d 204e 6f6e  ny] | None = Non
+0004f4a0: 652c 0a20 2020 2020 2020 2070 6172 7365  e,.        parse
+0004f4b0: 723a 2051 7565 7279 5061 7273 6572 4f70  r: QueryParserOp
+0004f4c0: 7469 6f6e 7320 3d20 2270 616e 6461 7322  tions = "pandas"
+0004f4d0: 2c0a 2020 2020 2020 2020 656e 6769 6e65  ,.        engine
+0004f4e0: 3a20 5175 6572 7945 6e67 696e 654f 7074  : QueryEngineOpt
+0004f4f0: 696f 6e73 203d 204e 6f6e 652c 0a20 2020  ions = None,.   
+0004f500: 2020 2020 206d 6973 7369 6e67 5f64 696d       missing_dim
+0004f510: 733a 2045 7272 6f72 4f70 7469 6f6e 7357  s: ErrorOptionsW
+0004f520: 6974 6857 6172 6e20 3d20 2272 6169 7365  ithWarn = "raise
+0004f530: 222c 0a20 2020 2020 2020 202a 2a71 7565  ",.        **que
+0004f540: 7269 6573 5f6b 7761 7267 733a 2041 6e79  ries_kwargs: Any
+0004f550: 2c0a 2020 2020 2920 2d3e 2054 5f44 6174  ,.    ) -> T_Dat
+0004f560: 6173 6574 3a0a 2020 2020 2020 2020 2222  aset:.        ""
+0004f570: 2252 6574 7572 6e20 6120 6e65 7720 6461  "Return a new da
+0004f580: 7461 7365 7420 7769 7468 2065 6163 6820  taset with each 
+0004f590: 6172 7261 7920 696e 6465 7865 6420 616c  array indexed al
+0004f5a0: 6f6e 6720 7468 6520 7370 6563 6966 6965  ong the specifie
+0004f5b0: 640a 2020 2020 2020 2020 6469 6d65 6e73  d.        dimens
+0004f5c0: 696f 6e28 7329 2c20 7768 6572 6520 7468  ion(s), where th
+0004f5d0: 6520 696e 6465 7865 7273 2061 7265 2067  e indexers are g
+0004f5e0: 6976 656e 2061 7320 7374 7269 6e67 7320  iven as strings 
+0004f5f0: 636f 6e74 6169 6e69 6e67 0a20 2020 2020  containing.     
+0004f600: 2020 2050 7974 686f 6e20 6578 7072 6573     Python expres
+0004f610: 7369 6f6e 7320 746f 2062 6520 6576 616c  sions to be eval
+0004f620: 7561 7465 6420 6167 6169 6e73 7420 7468  uated against th
+0004f630: 6520 6461 7461 2076 6172 6961 626c 6573  e data variables
+0004f640: 2069 6e20 7468 650a 2020 2020 2020 2020   in the.        
+0004f650: 6461 7461 7365 742e 0a0a 2020 2020 2020  dataset...      
+0004f660: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+0004f670: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+0004f680: 2020 2020 2020 2020 7175 6572 6965 7320          queries 
+0004f690: 3a20 6469 6374 2d6c 696b 652c 206f 7074  : dict-like, opt
+0004f6a0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+0004f6b0: 2020 4120 6469 6374 2d6c 696b 6520 7769    A dict-like wi
+0004f6c0: 7468 206b 6579 7320 6d61 7463 6869 6e67  th keys matching
+0004f6d0: 2064 696d 656e 7369 6f6e 7320 616e 6420   dimensions and 
+0004f6e0: 7661 6c75 6573 2067 6976 656e 2062 7920  values given by 
+0004f6f0: 7374 7269 6e67 730a 2020 2020 2020 2020  strings.        
+0004f700: 2020 2020 636f 6e74 6169 6e69 6e67 2050      containing P
+0004f710: 7974 686f 6e20 6578 7072 6573 7369 6f6e  ython expression
+0004f720: 7320 746f 2062 6520 6576 616c 7561 7465  s to be evaluate
+0004f730: 6420 6167 6169 6e73 7420 7468 6520 6461  d against the da
+0004f740: 7461 2076 6172 6961 626c 6573 0a20 2020  ta variables.   
+0004f750: 2020 2020 2020 2020 2069 6e20 7468 6520           in the 
+0004f760: 6461 7461 7365 742e 2054 6865 2065 7870  dataset. The exp
+0004f770: 7265 7373 696f 6e73 2077 696c 6c20 6265  ressions will be
+0004f780: 2065 7661 6c75 6174 6564 2075 7369 6e67   evaluated using
+0004f790: 2074 6865 2070 616e 6461 730a 2020 2020   the pandas.    
+0004f7a0: 2020 2020 2020 2020 6576 616c 2829 2066          eval() f
+0004f7b0: 756e 6374 696f 6e2c 2061 6e64 2063 616e  unction, and can
+0004f7c0: 2063 6f6e 7461 696e 2061 6e79 2076 616c   contain any val
+0004f7d0: 6964 2050 7974 686f 6e20 6578 7072 6573  id Python expres
+0004f7e0: 7369 6f6e 7320 6275 7420 6361 6e6e 6f74  sions but cannot
+0004f7f0: 0a20 2020 2020 2020 2020 2020 2063 6f6e  .            con
+0004f800: 7461 696e 2061 6e79 2050 7974 686f 6e20  tain any Python 
+0004f810: 7374 6174 656d 656e 7473 2e0a 2020 2020  statements..    
+0004f820: 2020 2020 7061 7273 6572 203a 207b 2270      parser : {"p
+0004f830: 616e 6461 7322 2c20 2270 7974 686f 6e22  andas", "python"
+0004f840: 7d2c 2064 6566 6175 6c74 3a20 2270 616e  }, default: "pan
+0004f850: 6461 7322 0a20 2020 2020 2020 2020 2020  das".           
+0004f860: 2054 6865 2070 6172 7365 7220 746f 2075   The parser to u
+0004f870: 7365 2074 6f20 636f 6e73 7472 7563 7420  se to construct 
+0004f880: 7468 6520 7379 6e74 6178 2074 7265 6520  the syntax tree 
+0004f890: 6672 6f6d 2074 6865 2065 7870 7265 7373  from the express
+0004f8a0: 696f 6e2e 0a20 2020 2020 2020 2020 2020  ion..           
+0004f8b0: 2054 6865 2064 6566 6175 6c74 206f 6620   The default of 
+0004f8c0: 2770 616e 6461 7327 2070 6172 7365 7320  'pandas' parses 
+0004f8d0: 636f 6465 2073 6c69 6768 746c 7920 6469  code slightly di
+0004f8e0: 6666 6572 656e 7420 7468 616e 2073 7461  fferent than sta
+0004f8f0: 6e64 6172 640a 2020 2020 2020 2020 2020  ndard.          
+0004f900: 2020 5079 7468 6f6e 2e20 416c 7465 726e    Python. Altern
+0004f910: 6174 6976 656c 792c 2079 6f75 2063 616e  atively, you can
+0004f920: 2070 6172 7365 2061 6e20 6578 7072 6573   parse an expres
+0004f930: 7369 6f6e 2075 7369 6e67 2074 6865 2027  sion using the '
+0004f940: 7079 7468 6f6e 270a 2020 2020 2020 2020  python'.        
+0004f950: 2020 2020 7061 7273 6572 2074 6f20 7265      parser to re
+0004f960: 7461 696e 2073 7472 6963 7420 5079 7468  tain strict Pyth
+0004f970: 6f6e 2073 656d 616e 7469 6373 2e0a 2020  on semantics..  
+0004f980: 2020 2020 2020 656e 6769 6e65 203a 207b        engine : {
+0004f990: 2270 7974 686f 6e22 2c20 226e 756d 6578  "python", "numex
+0004f9a0: 7072 222c 204e 6f6e 657d 2c20 6465 6661  pr", None}, defa
+0004f9b0: 756c 743a 204e 6f6e 650a 2020 2020 2020  ult: None.      
+0004f9c0: 2020 2020 2020 5468 6520 656e 6769 6e65        The engine
+0004f9d0: 2075 7365 6420 746f 2065 7661 6c75 6174   used to evaluat
+0004f9e0: 6520 7468 6520 6578 7072 6573 7369 6f6e  e the expression
+0004f9f0: 2e20 5375 7070 6f72 7465 6420 656e 6769  . Supported engi
+0004fa00: 6e65 7320 6172 653a 0a0a 2020 2020 2020  nes are:..      
+0004fa10: 2020 2020 2020 2d20 4e6f 6e65 3a20 7472        - None: tr
+0004fa20: 6965 7320 746f 2075 7365 206e 756d 6578  ies to use numex
+0004fa30: 7072 2c20 6661 6c6c 7320 6261 636b 2074  pr, falls back t
+0004fa40: 6f20 7079 7468 6f6e 0a20 2020 2020 2020  o python.       
+0004fa50: 2020 2020 202d 2022 6e75 6d65 7870 7222       - "numexpr"
+0004fa60: 3a20 6576 616c 7561 7465 7320 6578 7072  : evaluates expr
+0004fa70: 6573 7369 6f6e 7320 7573 696e 6720 6e75  essions using nu
+0004fa80: 6d65 7870 720a 2020 2020 2020 2020 2020  mexpr.          
+0004fa90: 2020 2d20 2270 7974 686f 6e22 3a20 7065    - "python": pe
+0004faa0: 7266 6f72 6d73 206f 7065 7261 7469 6f6e  rforms operation
+0004fab0: 7320 6173 2069 6620 796f 7520 6861 6420  s as if you had 
+0004fac0: 6576 616c e280 9964 2069 6e20 746f 7020  eval...d in top 
+0004fad0: 6c65 7665 6c20 7079 7468 6f6e 0a0a 2020  level python..  
+0004fae0: 2020 2020 2020 6d69 7373 696e 675f 6469        missing_di
+0004faf0: 6d73 203a 207b 2272 6169 7365 222c 2022  ms : {"raise", "
+0004fb00: 7761 726e 222c 2022 6967 6e6f 7265 227d  warn", "ignore"}
+0004fb10: 2c20 6465 6661 756c 743a 2022 7261 6973  , default: "rais
+0004fb20: 6522 0a20 2020 2020 2020 2020 2020 2057  e".            W
+0004fb30: 6861 7420 746f 2064 6f20 6966 2064 696d  hat to do if dim
+0004fb40: 656e 7369 6f6e 7320 7468 6174 2073 686f  ensions that sho
+0004fb50: 756c 6420 6265 2073 656c 6563 7465 6420  uld be selected 
+0004fb60: 6672 6f6d 2061 7265 206e 6f74 2070 7265  from are not pre
+0004fb70: 7365 6e74 2069 6e20 7468 650a 2020 2020  sent in the.    
+0004fb80: 2020 2020 2020 2020 4461 7461 7365 743a          Dataset:
+0004fb90: 0a0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0004fba0: 2272 6169 7365 223a 2072 6169 7365 2061  "raise": raise a
+0004fbb0: 6e20 6578 6365 7074 696f 6e0a 2020 2020  n exception.    
+0004fbc0: 2020 2020 2020 2020 2d20 2277 6172 6e22          - "warn"
+0004fbd0: 3a20 7261 6973 6520 6120 7761 726e 696e  : raise a warnin
+0004fbe0: 672c 2061 6e64 2069 676e 6f72 6520 7468  g, and ignore th
+0004fbf0: 6520 6d69 7373 696e 6720 6469 6d65 6e73  e missing dimens
+0004fc00: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
+0004fc10: 202d 2022 6967 6e6f 7265 223a 2069 676e   - "ignore": ign
+0004fc20: 6f72 6520 7468 6520 6d69 7373 696e 6720  ore the missing 
+0004fc30: 6469 6d65 6e73 696f 6e73 0a0a 2020 2020  dimensions..    
+0004fc40: 2020 2020 2a2a 7175 6572 6965 735f 6b77      **queries_kw
+0004fc50: 6172 6773 203a 207b 6469 6d3a 2071 7565  args : {dim: que
+0004fc60: 7279 2c20 2e2e 2e7d 2c20 6f70 7469 6f6e  ry, ...}, option
+0004fc70: 616c 0a20 2020 2020 2020 2020 2020 2054  al.            T
+0004fc80: 6865 206b 6579 776f 7264 2061 7267 756d  he keyword argum
+0004fc90: 656e 7473 2066 6f72 6d20 6f66 2060 6071  ents form of ``q
+0004fca0: 7565 7269 6573 6060 2e0a 2020 2020 2020  ueries``..      
+0004fcb0: 2020 2020 2020 4f6e 6520 6f66 2071 7565        One of que
+0004fcc0: 7269 6573 206f 7220 7175 6572 6965 735f  ries or queries_
+0004fcd0: 6b77 6172 6773 206d 7573 7420 6265 2070  kwargs must be p
+0004fce0: 726f 7669 6465 642e 0a0a 2020 2020 2020  rovided...      
+0004fcf0: 2020 5265 7475 726e 730a 2020 2020 2020    Returns.      
+0004fd00: 2020 2d2d 2d2d 2d2d 2d0a 2020 2020 2020    -------.      
+0004fd10: 2020 6f62 6a20 3a20 4461 7461 7365 740a    obj : Dataset.
+0004fd20: 2020 2020 2020 2020 2020 2020 4120 6e65              A ne
+0004fd30: 7720 4461 7461 7365 7420 7769 7468 2074  w Dataset with t
+0004fd40: 6865 2073 616d 6520 636f 6e74 656e 7473  he same contents
+0004fd50: 2061 7320 7468 6973 2064 6174 6173 6574   as this dataset
+0004fd60: 2c20 6578 6365 7074 2065 6163 680a 2020  , except each.  
+0004fd70: 2020 2020 2020 2020 2020 6172 7261 7920            array 
+0004fd80: 616e 6420 6469 6d65 6e73 696f 6e20 6973  and dimension is
+0004fd90: 2069 6e64 6578 6564 2062 7920 7468 6520   indexed by the 
+0004fda0: 7265 7375 6c74 7320 6f66 2074 6865 2061  results of the a
+0004fdb0: 7070 726f 7072 6961 7465 0a20 2020 2020  ppropriate.     
+0004fdc0: 2020 2020 2020 2071 7565 7269 6573 2e0a         queries..
+0004fdd0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+0004fde0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+0004fdf0: 2d2d 0a20 2020 2020 2020 2044 6174 6173  --.        Datas
+0004fe00: 6574 2e69 7365 6c0a 2020 2020 2020 2020  et.isel.        
+0004fe10: 7061 6e64 6173 2e65 7661 6c0a 0a20 2020  pandas.eval..   
+0004fe20: 2020 2020 2045 7861 6d70 6c65 730a 2020       Examples.  
+0004fe30: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0a20        --------. 
+0004fe40: 2020 2020 2020 203e 3e3e 2061 203d 206e         >>> a = n
+0004fe50: 702e 6172 616e 6765 2830 2c20 352c 2031  p.arange(0, 5, 1
+0004fe60: 290a 2020 2020 2020 2020 3e3e 3e20 6220  ).        >>> b 
+0004fe70: 3d20 6e70 2e6c 696e 7370 6163 6528 302c  = np.linspace(0,
+0004fe80: 2031 2c20 3529 0a20 2020 2020 2020 203e   1, 5).        >
+0004fe90: 3e3e 2064 7320 3d20 7872 2e44 6174 6173  >> ds = xr.Datas
+0004fea0: 6574 287b 2261 223a 2028 2278 222c 2061  et({"a": ("x", a
+0004feb0: 292c 2022 6222 3a20 2822 7822 2c20 6229  ), "b": ("x", b)
+0004fec0: 7d29 0a20 2020 2020 2020 203e 3e3e 2064  }).        >>> d
+0004fed0: 730a 2020 2020 2020 2020 3c78 6172 7261  s.        <xarra
+0004fee0: 792e 4461 7461 7365 743e 0a20 2020 2020  y.Dataset>.     
+0004fef0: 2020 2044 696d 656e 7369 6f6e 733a 2020     Dimensions:  
+0004ff00: 2878 3a20 3529 0a20 2020 2020 2020 2044  (x: 5).        D
+0004ff10: 696d 656e 7369 6f6e 7320 7769 7468 6f75  imensions withou
+0004ff20: 7420 636f 6f72 6469 6e61 7465 733a 2078  t coordinates: x
+0004ff30: 0a20 2020 2020 2020 2044 6174 6120 7661  .        Data va
+0004ff40: 7269 6162 6c65 733a 0a20 2020 2020 2020  riables:.       
+0004ff50: 2020 2020 2061 2020 2020 2020 2020 2878       a        (x
+0004ff60: 2920 696e 7436 3420 3020 3120 3220 3320  ) int64 0 1 2 3 
+0004ff70: 340a 2020 2020 2020 2020 2020 2020 6220  4.            b 
+0004ff80: 2020 2020 2020 2028 7829 2066 6c6f 6174         (x) float
+0004ff90: 3634 2030 2e30 2030 2e32 3520 302e 3520  64 0.0 0.25 0.5 
+0004ffa0: 302e 3735 2031 2e30 0a20 2020 2020 2020  0.75 1.0.       
+0004ffb0: 203e 3e3e 2064 732e 7175 6572 7928 783d   >>> ds.query(x=
+0004ffc0: 2261 203e 2032 2229 0a20 2020 2020 2020  "a > 2").       
+0004ffd0: 203c 7861 7272 6179 2e44 6174 6173 6574   <xarray.Dataset
+0004ffe0: 3e0a 2020 2020 2020 2020 4469 6d65 6e73  >.        Dimens
+0004fff0: 696f 6e73 3a20 2028 783a 2032 290a 2020  ions:  (x: 2).  
+00050000: 2020 2020 2020 4469 6d65 6e73 696f 6e73        Dimensions
+00050010: 2077 6974 686f 7574 2063 6f6f 7264 696e   without coordin
+00050020: 6174 6573 3a20 780a 2020 2020 2020 2020  ates: x.        
+00050030: 4461 7461 2076 6172 6961 626c 6573 3a0a  Data variables:.
+00050040: 2020 2020 2020 2020 2020 2020 6120 2020              a   
+00050050: 2020 2020 2028 7829 2069 6e74 3634 2033       (x) int64 3
+00050060: 2034 0a20 2020 2020 2020 2020 2020 2062   4.            b
+00050070: 2020 2020 2020 2020 2878 2920 666c 6f61          (x) floa
+00050080: 7436 3420 302e 3735 2031 2e30 0a20 2020  t64 0.75 1.0.   
+00050090: 2020 2020 2022 2222 0a0a 2020 2020 2020       """..      
+000500a0: 2020 2320 616c 6c6f 7720 7175 6572 6965    # allow querie
+000500b0: 7320 746f 2062 6520 6769 7665 6e20 6569  s to be given ei
+000500c0: 7468 6572 2061 7320 6120 6469 6374 206f  ther as a dict o
+000500d0: 7220 6173 206b 7761 7267 730a 2020 2020  r as kwargs.    
+000500e0: 2020 2020 7175 6572 6965 7320 3d20 6569      queries = ei
+000500f0: 7468 6572 5f64 6963 745f 6f72 5f6b 7761  ther_dict_or_kwa
+00050100: 7267 7328 7175 6572 6965 732c 2071 7565  rgs(queries, que
+00050110: 7269 6573 5f6b 7761 7267 732c 2022 7175  ries_kwargs, "qu
+00050120: 6572 7922 290a 0a20 2020 2020 2020 2023  ery")..        #
+00050130: 2063 6865 636b 2071 7565 7269 6573 0a20   check queries. 
+00050140: 2020 2020 2020 2066 6f72 2064 696d 2c20         for dim, 
+00050150: 6578 7072 2069 6e20 7175 6572 6965 732e  expr in queries.
+00050160: 6974 656d 7328 293a 0a20 2020 2020 2020  items():.       
+00050170: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+00050180: 7374 616e 6365 2865 7870 722c 2073 7472  stance(expr, str
+00050190: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+000501a0: 2020 206d 7367 203d 2066 2265 7870 7220     msg = f"expr 
+000501b0: 666f 7220 6469 6d20 7b64 696d 7d20 6d75  for dim {dim} mu
+000501c0: 7374 2062 6520 6120 7374 7269 6e67 2074  st be a string t
+000501d0: 6f20 6265 2065 7661 6c75 6174 6564 2c20  o be evaluated, 
+000501e0: 7b74 7970 6528 6578 7072 297d 2067 6976  {type(expr)} giv
+000501f0: 656e 220a 2020 2020 2020 2020 2020 2020  en".            
+00050200: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00050210: 7272 6f72 286d 7367 290a 0a20 2020 2020  rror(msg)..     
+00050220: 2020 2023 2065 7661 6c75 6174 6520 7468     # evaluate th
+00050230: 6520 7175 6572 6965 7320 746f 2063 7265  e queries to cre
+00050240: 6174 6520 7468 6520 696e 6465 7865 7273  ate the indexers
+00050250: 0a20 2020 2020 2020 2069 6e64 6578 6572  .        indexer
+00050260: 7320 3d20 7b0a 2020 2020 2020 2020 2020  s = {.          
+00050270: 2020 6469 6d3a 2070 642e 6576 616c 2865    dim: pd.eval(e
+00050280: 7870 722c 2072 6573 6f6c 7665 7273 3d5b  xpr, resolvers=[
+00050290: 7365 6c66 5d2c 2070 6172 7365 723d 7061  self], parser=pa
+000502a0: 7273 6572 2c20 656e 6769 6e65 3d65 6e67  rser, engine=eng
+000502b0: 696e 6529 0a20 2020 2020 2020 2020 2020  ine).           
+000502c0: 2066 6f72 2064 696d 2c20 6578 7072 2069   for dim, expr i
+000502d0: 6e20 7175 6572 6965 732e 6974 656d 7328  n queries.items(
+000502e0: 290a 2020 2020 2020 2020 7d0a 0a20 2020  ).        }..   
+000502f0: 2020 2020 2023 2061 7070 6c79 2074 6865       # apply the
+00050300: 2073 656c 6563 7469 6f6e 0a20 2020 2020   selection.     
+00050310: 2020 2072 6574 7572 6e20 7365 6c66 2e69     return self.i
+00050320: 7365 6c28 696e 6465 7865 7273 2c20 6d69  sel(indexers, mi
+00050330: 7373 696e 675f 6469 6d73 3d6d 6973 7369  ssing_dims=missi
+00050340: 6e67 5f64 696d 7329 0a0a 2020 2020 6465  ng_dims)..    de
+00050350: 6620 6375 7276 6566 6974 280a 2020 2020  f curvefit(.    
+00050360: 2020 2020 7365 6c66 3a20 545f 4461 7461      self: T_Data
+00050370: 7365 742c 0a20 2020 2020 2020 2063 6f6f  set,.        coo
+00050380: 7264 733a 2073 7472 207c 2044 6174 6141  rds: str | DataA
+00050390: 7272 6179 207c 2049 7465 7261 626c 655b  rray | Iterable[
+000503a0: 7374 7220 7c20 4461 7461 4172 7261 795d  str | DataArray]
+000503b0: 2c0a 2020 2020 2020 2020 6675 6e63 3a20  ,.        func: 
+000503c0: 4361 6c6c 6162 6c65 5b2e 2e2e 2c20 416e  Callable[..., An
+000503d0: 795d 2c0a 2020 2020 2020 2020 7265 6475  y],.        redu
+000503e0: 6365 5f64 696d 733a 2044 696d 7320 3d20  ce_dims: Dims = 
+000503f0: 4e6f 6e65 2c0a 2020 2020 2020 2020 736b  None,.        sk
+00050400: 6970 6e61 3a20 626f 6f6c 203d 2054 7275  ipna: bool = Tru
+00050410: 652c 0a20 2020 2020 2020 2070 303a 2064  e,.        p0: d
+00050420: 6963 745b 7374 722c 2066 6c6f 6174 207c  ict[str, float |
+00050430: 2044 6174 6141 7272 6179 5d20 7c20 4e6f   DataArray] | No
+00050440: 6e65 203d 204e 6f6e 652c 0a20 2020 2020  ne = None,.     
+00050450: 2020 2062 6f75 6e64 733a 2064 6963 745b     bounds: dict[
+00050460: 7374 722c 2074 7570 6c65 5b66 6c6f 6174  str, tuple[float
+00050470: 207c 2044 6174 6141 7272 6179 2c20 666c   | DataArray, fl
+00050480: 6f61 7420 7c20 4461 7461 4172 7261 795d  oat | DataArray]
+00050490: 5d20 7c20 4e6f 6e65 203d 204e 6f6e 652c  ] | None = None,
+000504a0: 0a20 2020 2020 2020 2070 6172 616d 5f6e  .        param_n
+000504b0: 616d 6573 3a20 5365 7175 656e 6365 5b73  ames: Sequence[s
+000504c0: 7472 5d20 7c20 4e6f 6e65 203d 204e 6f6e  tr] | None = Non
+000504d0: 652c 0a20 2020 2020 2020 2065 7272 6f72  e,.        error
+000504e0: 733a 2045 7272 6f72 4f70 7469 6f6e 7320  s: ErrorOptions 
+000504f0: 3d20 2272 6169 7365 222c 0a20 2020 2020  = "raise",.     
+00050500: 2020 206b 7761 7267 733a 2064 6963 745b     kwargs: dict[
+00050510: 7374 722c 2041 6e79 5d20 7c20 4e6f 6e65  str, Any] | None
+00050520: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+00050530: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
+00050540: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00050550: 2043 7572 7665 2066 6974 7469 6e67 206f   Curve fitting o
+00050560: 7074 696d 697a 6174 696f 6e20 666f 7220  ptimization for 
+00050570: 6172 6269 7472 6172 7920 6675 6e63 7469  arbitrary functi
+00050580: 6f6e 732e 0a0a 2020 2020 2020 2020 5772  ons...        Wr
+00050590: 6170 7320 6073 6369 7079 2e6f 7074 696d  aps `scipy.optim
+000505a0: 697a 652e 6375 7276 655f 6669 7460 2077  ize.curve_fit` w
+000505b0: 6974 6820 6061 7070 6c79 5f75 6675 6e63  ith `apply_ufunc
+000505c0: 602e 0a0a 2020 2020 2020 2020 5061 7261  `...        Para
+000505d0: 6d65 7465 7273 0a20 2020 2020 2020 202d  meters.        -
+000505e0: 2d2d 2d2d 2d2d 2d2d 2d0a 2020 2020 2020  ---------.      
+000505f0: 2020 636f 6f72 6473 203a 2068 6173 6861    coords : hasha
+00050600: 626c 652c 2044 6174 6141 7272 6179 2c20  ble, DataArray, 
+00050610: 6f72 2073 6571 7565 6e63 6520 6f66 2068  or sequence of h
+00050620: 6173 6861 626c 6520 6f72 2044 6174 6141  ashable or DataA
+00050630: 7272 6179 0a20 2020 2020 2020 2020 2020  rray.           
+00050640: 2049 6e64 6570 656e 6465 6e74 2063 6f6f   Independent coo
+00050650: 7264 696e 6174 6528 7329 206f 7665 7220  rdinate(s) over 
+00050660: 7768 6963 6820 746f 2070 6572 666f 726d  which to perform
+00050670: 2074 6865 2063 7572 7665 2066 6974 7469   the curve fitti
+00050680: 6e67 2e20 4d75 7374 2073 6861 7265 0a20  ng. Must share. 
+00050690: 2020 2020 2020 2020 2020 2061 7420 6c65             at le
+000506a0: 6173 7420 6f6e 6520 6469 6d65 6e73 696f  ast one dimensio
+000506b0: 6e20 7769 7468 2074 6865 2063 616c 6c69  n with the calli
+000506c0: 6e67 206f 626a 6563 742e 2057 6865 6e20  ng object. When 
+000506d0: 6669 7474 696e 6720 6d75 6c74 692d 6469  fitting multi-di
+000506e0: 6d65 6e73 696f 6e61 6c0a 2020 2020 2020  mensional.      
+000506f0: 2020 2020 2020 6675 6e63 7469 6f6e 732c        functions,
+00050700: 2073 7570 706c 7920 6063 6f6f 7264 7360   supply `coords`
+00050710: 2061 7320 6120 7365 7175 656e 6365 2069   as a sequence i
+00050720: 6e20 7468 6520 7361 6d65 206f 7264 6572  n the same order
+00050730: 2061 7320 6172 6775 6d65 6e74 7320 696e   as arguments in
+00050740: 0a20 2020 2020 2020 2020 2020 2060 6675  .            `fu
+00050750: 6e63 602e 2054 6f20 6669 7420 616c 6f6e  nc`. To fit alon
+00050760: 6720 6578 6973 7469 6e67 2064 696d 656e  g existing dimen
+00050770: 7369 6f6e 7320 6f66 2074 6865 2063 616c  sions of the cal
+00050780: 6c69 6e67 206f 626a 6563 742c 2060 636f  ling object, `co
+00050790: 6f72 6473 6020 6361 6e0a 2020 2020 2020  ords` can.      
+000507a0: 2020 2020 2020 616c 736f 2062 6520 7370        also be sp
+000507b0: 6563 6966 6965 6420 6173 2061 2073 7472  ecified as a str
+000507c0: 206f 7220 7365 7175 656e 6365 206f 6620   or sequence of 
+000507d0: 7374 7273 2e0a 2020 2020 2020 2020 6675  strs..        fu
+000507e0: 6e63 203a 2063 616c 6c61 626c 650a 2020  nc : callable.  
+000507f0: 2020 2020 2020 2020 2020 5573 6572 2073            User s
+00050800: 7065 6369 6669 6564 2066 756e 6374 696f  pecified functio
+00050810: 6e20 696e 2074 6865 2066 6f72 6d20 6066  n in the form `f
+00050820: 2878 2c20 2a70 6172 616d 7329 6020 7768  (x, *params)` wh
+00050830: 6963 6820 7265 7475 726e 7320 6120 6e75  ich returns a nu
+00050840: 6d70 790a 2020 2020 2020 2020 2020 2020  mpy.            
+00050850: 6172 7261 7920 6f66 206c 656e 6774 6820  array of length 
+00050860: 606c 656e 2878 2960 2e20 6070 6172 616d  `len(x)`. `param
+00050870: 7360 2061 7265 2074 6865 2066 6974 7461  s` are the fitta
+00050880: 626c 6520 7061 7261 6d65 7465 7273 2077  ble parameters w
+00050890: 6869 6368 2061 7265 206f 7074 696d 697a  hich are optimiz
+000508a0: 6564 0a20 2020 2020 2020 2020 2020 2062  ed.            b
+000508b0: 7920 7363 6970 7920 6375 7276 655f 6669  y scipy curve_fi
+000508c0: 742e 2060 7860 2063 616e 2061 6c73 6f20  t. `x` can also 
+000508d0: 6265 2073 7065 6369 6669 6564 2061 7320  be specified as 
+000508e0: 6120 7365 7175 656e 6365 2063 6f6e 7461  a sequence conta
+000508f0: 696e 696e 6720 6d75 6c74 6970 6c65 0a20  ining multiple. 
+00050900: 2020 2020 2020 2020 2020 2063 6f6f 7264             coord
+00050910: 696e 6174 6573 2c20 652e 672e 2060 6628  inates, e.g. `f(
+00050920: 2878 302c 2078 3129 2c20 2a70 6172 616d  (x0, x1), *param
+00050930: 7329 602e 0a20 2020 2020 2020 2072 6564  s)`..        red
+00050940: 7563 655f 6469 6d73 203a 2073 7472 2c20  uce_dims : str, 
+00050950: 4974 6572 6162 6c65 206f 6620 4861 7368  Iterable of Hash
+00050960: 6162 6c65 206f 7220 4e6f 6e65 2c20 6f70  able or None, op
+00050970: 7469 6f6e 616c 0a20 2020 2020 2020 2020  tional.         
+00050980: 2020 2041 6464 6974 696f 6e61 6c20 6469     Additional di
+00050990: 6d65 6e73 696f 6e28 7329 206f 7665 7220  mension(s) over 
+000509a0: 7768 6963 6820 746f 2061 6767 7265 6761  which to aggrega
+000509b0: 7465 2077 6869 6c65 2066 6974 7469 6e67  te while fitting
+000509c0: 2e20 466f 7220 6578 616d 706c 652c 0a20  . For example,. 
+000509d0: 2020 2020 2020 2020 2020 2063 616c 6c69             calli
+000509e0: 6e67 2060 6473 2e63 7572 7665 6669 7428  ng `ds.curvefit(
+000509f0: 636f 6f72 6473 3d27 7469 6d65 272c 2072  coords='time', r
+00050a00: 6564 7563 655f 6469 6d73 3d5b 276c 6174  educe_dims=['lat
+00050a10: 272c 2027 6c6f 6e27 5d2c 202e 2e2e 2960  ', 'lon'], ...)`
+00050a20: 2077 696c 6c0a 2020 2020 2020 2020 2020   will.          
+00050a30: 2020 6167 6772 6567 6174 6520 616c 6c20    aggregate all 
+00050a40: 6c61 7420 616e 6420 6c6f 6e20 706f 696e  lat and lon poin
+00050a50: 7473 2061 6e64 2066 6974 2074 6865 2073  ts and fit the s
+00050a60: 7065 6369 6669 6564 2066 756e 6374 696f  pecified functio
+00050a70: 6e20 616c 6f6e 6720 7468 650a 2020 2020  n along the.    
+00050a80: 2020 2020 2020 2020 7469 6d65 2064 696d          time dim
+00050a90: 656e 7369 6f6e 2e0a 2020 2020 2020 2020  ension..        
+00050aa0: 736b 6970 6e61 203a 2062 6f6f 6c2c 2064  skipna : bool, d
+00050ab0: 6566 6175 6c74 3a20 5472 7565 0a20 2020  efault: True.   
+00050ac0: 2020 2020 2020 2020 2057 6865 7468 6572           Whether
+00050ad0: 2074 6f20 736b 6970 206d 6973 7369 6e67   to skip missing
+00050ae0: 2076 616c 7565 7320 7768 656e 2066 6974   values when fit
+00050af0: 7469 6e67 2e20 4465 6661 756c 7420 6973  ting. Default is
+00050b00: 2054 7275 652e 0a20 2020 2020 2020 2070   True..        p
+00050b10: 3020 3a20 6469 6374 2d6c 696b 652c 206f  0 : dict-like, o
+00050b20: 7074 696f 6e61 6c0a 2020 2020 2020 2020  ptional.        
+00050b30: 2020 2020 4f70 7469 6f6e 616c 2064 6963      Optional dic
+00050b40: 7469 6f6e 6172 7920 6f66 2070 6172 616d  tionary of param
+00050b50: 6574 6572 206e 616d 6573 2074 6f20 696e  eter names to in
+00050b60: 6974 6961 6c20 6775 6573 7365 7320 7061  itial guesses pa
+00050b70: 7373 6564 2074 6f20 7468 650a 2020 2020  ssed to the.    
+00050b80: 2020 2020 2020 2020 6063 7572 7665 5f66          `curve_f
+00050b90: 6974 6020 6070 3060 2061 7267 2e20 4966  it` `p0` arg. If
+00050ba0: 2074 6865 2076 616c 7565 7320 6172 6520   the values are 
+00050bb0: 4461 7461 4172 7261 7973 2c20 7468 6579  DataArrays, they
+00050bc0: 2077 696c 6c20 6265 2061 7070 726f 7072   will be appropr
+00050bd0: 6961 7465 6c79 0a20 2020 2020 2020 2020  iately.         
+00050be0: 2020 2062 726f 6164 6361 7374 2074 6f20     broadcast to 
+00050bf0: 7468 6520 636f 6f72 6469 6e61 7465 7320  the coordinates 
+00050c00: 6f66 2074 6865 2061 7272 6179 2e20 4966  of the array. If
+00050c10: 206e 6f6e 6520 6f72 206f 6e6c 7920 736f   none or only so
+00050c20: 6d65 2070 6172 616d 6574 6572 7320 6172  me parameters ar
+00050c30: 650a 2020 2020 2020 2020 2020 2020 7061  e.            pa
+00050c40: 7373 6564 2c20 7468 6520 7265 7374 2077  ssed, the rest w
+00050c50: 696c 6c20 6265 2061 7373 6967 6e65 6420  ill be assigned 
+00050c60: 696e 6974 6961 6c20 7661 6c75 6573 2066  initial values f
+00050c70: 6f6c 6c6f 7769 6e67 2074 6865 2064 6566  ollowing the def
+00050c80: 6175 6c74 2073 6369 7079 0a20 2020 2020  ault scipy.     
+00050c90: 2020 2020 2020 2062 6568 6176 696f 722e         behavior.
+00050ca0: 0a20 2020 2020 2020 2062 6f75 6e64 7320  .        bounds 
+00050cb0: 3a20 6469 6374 2d6c 696b 652c 206f 7074  : dict-like, opt
+00050cc0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00050cd0: 2020 4f70 7469 6f6e 616c 2064 6963 7469    Optional dicti
+00050ce0: 6f6e 6172 7920 6f66 2070 6172 616d 6574  onary of paramet
+00050cf0: 6572 206e 616d 6573 2074 6f20 7475 706c  er names to tupl
+00050d00: 6573 206f 6620 626f 756e 6469 6e67 2076  es of bounding v
+00050d10: 616c 7565 7320 7061 7373 6564 2074 6f20  alues passed to 
+00050d20: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00050d30: 6063 7572 7665 5f66 6974 6020 6062 6f75  `curve_fit` `bou
+00050d40: 6e64 7360 2061 7267 2e20 4966 2061 6e79  nds` arg. If any
+00050d50: 206f 6620 7468 6520 626f 756e 6473 2061   of the bounds a
+00050d60: 7265 2044 6174 6141 7272 6179 732c 2074  re DataArrays, t
+00050d70: 6865 7920 7769 6c6c 2062 650a 2020 2020  hey will be.    
+00050d80: 2020 2020 2020 2020 6170 7072 6f70 7269          appropri
+00050d90: 6174 656c 7920 6272 6f61 6463 6173 7420  ately broadcast 
+00050da0: 746f 2074 6865 2063 6f6f 7264 696e 6174  to the coordinat
+00050db0: 6573 206f 6620 7468 6520 6172 7261 792e  es of the array.
+00050dc0: 2049 6620 6e6f 6e65 206f 7220 6f6e 6c79   If none or only
+00050dd0: 2073 6f6d 650a 2020 2020 2020 2020 2020   some.          
+00050de0: 2020 7061 7261 6d65 7465 7273 2061 7265    parameters are
+00050df0: 2070 6173 7365 642c 2074 6865 2072 6573   passed, the res
+00050e00: 7420 7769 6c6c 2062 6520 756e 626f 756e  t will be unboun
+00050e10: 6465 6420 666f 6c6c 6f77 696e 6720 7468  ded following th
+00050e20: 6520 6465 6661 756c 7420 7363 6970 790a  e default scipy.
+00050e30: 2020 2020 2020 2020 2020 2020 6265 6861              beha
+00050e40: 7669 6f72 2e0a 2020 2020 2020 2020 7061  vior..        pa
+00050e50: 7261 6d5f 6e61 6d65 7320 3a20 7365 7175  ram_names : sequ
+00050e60: 656e 6365 206f 6620 6861 7368 6162 6c65  ence of hashable
+00050e70: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00050e80: 2020 2020 2020 2053 6571 7565 6e63 6520         Sequence 
+00050e90: 6f66 206e 616d 6573 2066 6f72 2074 6865  of names for the
+00050ea0: 2066 6974 7461 626c 6520 7061 7261 6d65   fittable parame
+00050eb0: 7465 7273 206f 6620 6066 756e 6360 2e20  ters of `func`. 
+00050ec0: 4966 206e 6f74 2073 7570 706c 6965 642c  If not supplied,
+00050ed0: 0a20 2020 2020 2020 2020 2020 2074 6869  .            thi
+00050ee0: 7320 7769 6c6c 2062 6520 6175 746f 6d61  s will be automa
+00050ef0: 7469 6361 6c6c 7920 6465 7465 726d 696e  tically determin
+00050f00: 6564 2062 7920 6172 6775 6d65 6e74 7320  ed by arguments 
+00050f10: 6f66 2060 6675 6e63 602e 2060 7061 7261  of `func`. `para
+00050f20: 6d5f 6e61 6d65 7360 0a20 2020 2020 2020  m_names`.       
+00050f30: 2020 2020 2073 686f 756c 6420 6265 206d       should be m
+00050f40: 616e 7561 6c6c 7920 7375 7070 6c69 6564  anually supplied
+00050f50: 2077 6865 6e20 6669 7474 696e 6720 6120   when fitting a 
+00050f60: 6675 6e63 7469 6f6e 2074 6861 7420 7461  function that ta
+00050f70: 6b65 7320 6120 7661 7269 6162 6c65 0a20  kes a variable. 
+00050f80: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
+00050f90: 7220 6f66 2070 6172 616d 6574 6572 732e  r of parameters.
+00050fa0: 0a20 2020 2020 2020 2065 7272 6f72 7320  .        errors 
+00050fb0: 3a20 7b22 7261 6973 6522 2c20 2269 676e  : {"raise", "ign
+00050fc0: 6f72 6522 7d2c 2064 6566 6175 6c74 3a20  ore"}, default: 
+00050fd0: 2272 6169 7365 220a 2020 2020 2020 2020  "raise".        
+00050fe0: 2020 2020 4966 2027 7261 6973 6527 2c20      If 'raise', 
+00050ff0: 616e 7920 6572 726f 7273 2066 726f 6d20  any errors from 
+00051000: 7468 6520 6073 6369 7079 2e6f 7074 696d  the `scipy.optim
+00051010: 697a 655f 6375 7276 655f 6669 7460 206f  ize_curve_fit` o
+00051020: 7074 696d 697a 6174 696f 6e20 7769 6c6c  ptimization will
+00051030: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+00051040: 7365 2061 6e20 6578 6365 7074 696f 6e2e  se an exception.
+00051050: 2049 6620 2769 676e 6f72 6527 2c20 7468   If 'ignore', th
+00051060: 6520 636f 6566 6669 6369 656e 7473 2061  e coefficients a
+00051070: 6e64 2063 6f76 6172 6961 6e63 6573 2066  nd covariances f
+00051080: 6f72 2074 6865 0a20 2020 2020 2020 2020  or the.         
+00051090: 2020 2063 6f6f 7264 696e 6174 6573 2077     coordinates w
+000510a0: 6865 7265 2074 6865 2066 6974 7469 6e67  here the fitting
+000510b0: 2066 6169 6c65 6420 7769 6c6c 2062 6520   failed will be 
+000510c0: 4e61 4e2e 0a20 2020 2020 2020 202a 2a6b  NaN..        **k
+000510d0: 7761 7267 7320 3a20 6f70 7469 6f6e 616c  wargs : optional
+000510e0: 0a20 2020 2020 2020 2020 2020 2041 6464  .            Add
+000510f0: 6974 696f 6e61 6c20 6b65 7977 6f72 6420  itional keyword 
+00051100: 6172 6775 6d65 6e74 7320 746f 2070 6173  arguments to pas
+00051110: 7365 6420 746f 2073 6369 7079 2063 7572  sed to scipy cur
+00051120: 7665 5f66 6974 2e0a 0a20 2020 2020 2020  ve_fit...       
+00051130: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00051140: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00051150: 2063 7572 7665 6669 745f 7265 7375 6c74   curvefit_result
+00051160: 7320 3a20 4461 7461 7365 740a 2020 2020  s : Dataset.    
+00051170: 2020 2020 2020 2020 4120 7369 6e67 6c65          A single
+00051180: 2064 6174 6173 6574 2077 6869 6368 2063   dataset which c
+00051190: 6f6e 7461 696e 733a 0a0a 2020 2020 2020  ontains:..      
+000511a0: 2020 2020 2020 5b76 6172 5d5f 6375 7276        [var]_curv
+000511b0: 6566 6974 5f63 6f65 6666 6963 6965 6e74  efit_coefficient
+000511c0: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+000511d0: 2020 5468 6520 636f 6566 6669 6369 656e    The coefficien
+000511e0: 7473 206f 6620 7468 6520 6265 7374 2066  ts of the best f
+000511f0: 6974 2e0a 2020 2020 2020 2020 2020 2020  it..            
+00051200: 5b76 6172 5d5f 6375 7276 6566 6974 5f63  [var]_curvefit_c
+00051210: 6f76 6172 6961 6e63 650a 2020 2020 2020  ovariance.      
+00051220: 2020 2020 2020 2020 2020 5468 6520 636f            The co
+00051230: 7661 7269 616e 6365 206d 6174 7269 7820  variance matrix 
+00051240: 6f66 2074 6865 2063 6f65 6666 6963 6965  of the coefficie
+00051250: 6e74 2065 7374 696d 6174 6573 2e0a 0a20  nt estimates... 
+00051260: 2020 2020 2020 2053 6565 2041 6c73 6f0a         See Also.
+00051270: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00051280: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
+00051290: 2e70 6f6c 7966 6974 0a20 2020 2020 2020  .polyfit.       
+000512a0: 2073 6369 7079 2e6f 7074 696d 697a 652e   scipy.optimize.
+000512b0: 6375 7276 655f 6669 740a 2020 2020 2020  curve_fit.      
+000512c0: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
+000512d0: 6f6d 2073 6369 7079 2e6f 7074 696d 697a  om scipy.optimiz
+000512e0: 6520 696d 706f 7274 2063 7572 7665 5f66  e import curve_f
+000512f0: 6974 0a0a 2020 2020 2020 2020 6672 6f6d  it..        from
+00051300: 2078 6172 7261 792e 636f 7265 2e61 6c69   xarray.core.ali
+00051310: 676e 6d65 6e74 2069 6d70 6f72 7420 6272  gnment import br
+00051320: 6f61 6463 6173 740a 2020 2020 2020 2020  oadcast.        
+00051330: 6672 6f6d 2078 6172 7261 792e 636f 7265  from xarray.core
+00051340: 2e63 6f6d 7075 7461 7469 6f6e 2069 6d70  .computation imp
+00051350: 6f72 7420 6170 706c 795f 7566 756e 630a  ort apply_ufunc.
+00051360: 2020 2020 2020 2020 6672 6f6d 2078 6172          from xar
+00051370: 7261 792e 636f 7265 2e64 6174 6161 7272  ray.core.dataarr
+00051380: 6179 2069 6d70 6f72 7420 5f54 4849 535f  ay import _THIS_
+00051390: 4152 5241 592c 2044 6174 6141 7272 6179  ARRAY, DataArray
+000513a0: 0a0a 2020 2020 2020 2020 6966 2070 3020  ..        if p0 
+000513b0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000513c0: 2020 2020 2070 3020 3d20 7b7d 0a20 2020       p0 = {}.   
+000513d0: 2020 2020 2069 6620 626f 756e 6473 2069       if bounds i
+000513e0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+000513f0: 2020 2020 626f 756e 6473 203d 207b 7d0a      bounds = {}.
+00051400: 2020 2020 2020 2020 6966 206b 7761 7267          if kwarg
+00051410: 7320 6973 204e 6f6e 653a 0a20 2020 2020  s is None:.     
+00051420: 2020 2020 2020 206b 7761 7267 7320 3d20         kwargs = 
+00051430: 7b7d 0a0a 2020 2020 2020 2020 7265 6475  {}..        redu
+00051440: 6365 5f64 696d 735f 3a20 6c69 7374 5b48  ce_dims_: list[H
+00051450: 6173 6861 626c 655d 0a20 2020 2020 2020  ashable].       
+00051460: 2069 6620 6e6f 7420 7265 6475 6365 5f64   if not reduce_d
+00051470: 696d 733a 0a20 2020 2020 2020 2020 2020  ims:.           
+00051480: 2072 6564 7563 655f 6469 6d73 5f20 3d20   reduce_dims_ = 
+00051490: 5b5d 0a20 2020 2020 2020 2065 6c69 6620  [].        elif 
+000514a0: 6973 696e 7374 616e 6365 2872 6564 7563  isinstance(reduc
+000514b0: 655f 6469 6d73 2c20 7374 7229 206f 7220  e_dims, str) or 
+000514c0: 6e6f 7420 6973 696e 7374 616e 6365 2872  not isinstance(r
+000514d0: 6564 7563 655f 6469 6d73 2c20 4974 6572  educe_dims, Iter
+000514e0: 6162 6c65 293a 0a20 2020 2020 2020 2020  able):.         
+000514f0: 2020 2072 6564 7563 655f 6469 6d73 5f20     reduce_dims_ 
+00051500: 3d20 5b72 6564 7563 655f 6469 6d73 5d0a  = [reduce_dims].
+00051510: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00051520: 2020 2020 2020 2020 2020 7265 6475 6365            reduce
+00051530: 5f64 696d 735f 203d 206c 6973 7428 7265  _dims_ = list(re
+00051540: 6475 6365 5f64 696d 7329 0a0a 2020 2020  duce_dims)..    
+00051550: 2020 2020 6966 2028 0a20 2020 2020 2020      if (.       
+00051560: 2020 2020 2069 7369 6e73 7461 6e63 6528       isinstance(
+00051570: 636f 6f72 6473 2c20 7374 7229 0a20 2020  coords, str).   
+00051580: 2020 2020 2020 2020 206f 7220 6973 696e           or isin
+00051590: 7374 616e 6365 2863 6f6f 7264 732c 2044  stance(coords, D
+000515a0: 6174 6141 7272 6179 290a 2020 2020 2020  ataArray).      
+000515b0: 2020 2020 2020 6f72 206e 6f74 2069 7369        or not isi
+000515c0: 6e73 7461 6e63 6528 636f 6f72 6473 2c20  nstance(coords, 
+000515d0: 4974 6572 6162 6c65 290a 2020 2020 2020  Iterable).      
+000515e0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+000515f0: 2063 6f6f 7264 7320 3d20 5b63 6f6f 7264   coords = [coord
+00051600: 735d 0a20 2020 2020 2020 2063 6f6f 7264  s].        coord
+00051610: 735f 3a20 5365 7175 656e 6365 5b44 6174  s_: Sequence[Dat
+00051620: 6141 7272 6179 5d20 3d20 5b0a 2020 2020  aArray] = [.    
+00051630: 2020 2020 2020 2020 7365 6c66 5b63 6f6f          self[coo
+00051640: 7264 5d20 6966 2069 7369 6e73 7461 6e63  rd] if isinstanc
+00051650: 6528 636f 6f72 642c 2073 7472 2920 656c  e(coord, str) el
+00051660: 7365 2063 6f6f 7264 2066 6f72 2063 6f6f  se coord for coo
+00051670: 7264 2069 6e20 636f 6f72 6473 0a20 2020  rd in coords.   
+00051680: 2020 2020 205d 0a0a 2020 2020 2020 2020       ]..        
+00051690: 2320 4465 7465 726d 696e 6520 7768 6574  # Determine whet
+000516a0: 6865 7220 616e 7920 636f 6f72 6473 2061  her any coords a
+000516b0: 7265 2064 696d 7320 6f6e 2073 656c 660a  re dims on self.
+000516c0: 2020 2020 2020 2020 666f 7220 636f 6f72          for coor
+000516d0: 6420 696e 2063 6f6f 7264 735f 3a0a 2020  d in coords_:.  
+000516e0: 2020 2020 2020 2020 2020 7265 6475 6365            reduce
+000516f0: 5f64 696d 735f 202b 3d20 5b63 2066 6f72  _dims_ += [c for
+00051700: 2063 2069 6e20 7365 6c66 2e64 696d 7320   c in self.dims 
+00051710: 6966 2063 6f6f 7264 2e65 7175 616c 7328  if coord.equals(
+00051720: 7365 6c66 5b63 5d29 5d0a 2020 2020 2020  self[c])].      
+00051730: 2020 7265 6475 6365 5f64 696d 735f 203d    reduce_dims_ =
+00051740: 206c 6973 7428 7365 7428 7265 6475 6365   list(set(reduce
+00051750: 5f64 696d 735f 2929 0a20 2020 2020 2020  _dims_)).       
+00051760: 2070 7265 7365 7276 6564 5f64 696d 7320   preserved_dims 
+00051770: 3d20 6c69 7374 2873 6574 2873 656c 662e  = list(set(self.
+00051780: 6469 6d73 2920 2d20 7365 7428 7265 6475  dims) - set(redu
+00051790: 6365 5f64 696d 735f 2929 0a20 2020 2020  ce_dims_)).     
+000517a0: 2020 2069 6620 6e6f 7420 7265 6475 6365     if not reduce
+000517b0: 5f64 696d 735f 3a0a 2020 2020 2020 2020  _dims_:.        
+000517c0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+000517d0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
+000517e0: 2020 2020 2020 224e 6f20 6172 6775 6d65        "No argume
+000517f0: 6e74 7320 746f 2060 636f 6f72 6473 6020  nts to `coords` 
+00051800: 7765 7265 2069 6465 6e74 6966 6965 6420  were identified 
+00051810: 6173 2061 2064 696d 656e 7369 6f6e 206f  as a dimension o
+00051820: 6e20 7468 6520 6361 6c6c 696e 6720 220a  n the calling ".
+00051830: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051840: 226f 626a 6563 742c 2061 6e64 206e 6f20  "object, and no 
+00051850: 6469 6d73 2077 6572 6520 7375 7070 6c69  dims were suppli
+00051860: 6564 2074 6f20 6072 6564 7563 655f 6469  ed to `reduce_di
+00051870: 6d73 602e 2054 6869 7320 776f 756c 6420  ms`. This would 
+00051880: 7265 7375 6c74 2022 0a20 2020 2020 2020  result ".       
+00051890: 2020 2020 2020 2020 2022 696e 2066 6974           "in fit
+000518a0: 7469 6e67 206f 6e20 7363 616c 6172 2064  ting on scalar d
+000518b0: 6174 612e 220a 2020 2020 2020 2020 2020  ata.".          
+000518c0: 2020 290a 0a20 2020 2020 2020 2023 2043    )..        # C
+000518d0: 6865 636b 2074 6861 7420 696e 6974 6961  heck that initia
+000518e0: 6c20 6775 6573 7320 616e 6420 626f 756e  l guess and boun
+000518f0: 6473 206f 6e6c 7920 636f 6e74 6169 6e20  ds only contain 
+00051900: 636f 6f72 6469 6e61 7465 7320 7468 6174  coordinates that
+00051910: 2061 7265 2069 6e20 7072 6573 6572 7665   are in preserve
+00051920: 645f 6469 6d73 0a20 2020 2020 2020 2066  d_dims.        f
+00051930: 6f72 2070 6172 616d 2c20 6775 6573 7320  or param, guess 
+00051940: 696e 2070 302e 6974 656d 7328 293a 0a20  in p0.items():. 
+00051950: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00051960: 696e 7374 616e 6365 2867 7565 7373 2c20  instance(guess, 
+00051970: 4461 7461 4172 7261 7929 3a0a 2020 2020  DataArray):.    
+00051980: 2020 2020 2020 2020 2020 2020 756e 6578              unex
+00051990: 7065 6374 6564 203d 2073 6574 2867 7565  pected = set(gue
+000519a0: 7373 2e64 696d 7329 202d 2073 6574 2870  ss.dims) - set(p
+000519b0: 7265 7365 7276 6564 5f64 696d 7329 0a20  reserved_dims). 
+000519c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+000519d0: 6620 756e 6578 7065 6374 6564 3a0a 2020  f unexpected:.  
+000519e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000519f0: 2020 7261 6973 6520 5661 6c75 6545 7272    raise ValueErr
+00051a00: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00051a10: 2020 2020 2020 2020 2020 2020 6622 496e              f"In
+00051a20: 6974 6961 6c20 6775 6573 7320 666f 7220  itial guess for 
+00051a30: 277b 7061 7261 6d7d 2720 6861 7320 756e  '{param}' has un
+00051a40: 6578 7065 6374 6564 2064 696d 656e 7369  expected dimensi
+00051a50: 6f6e 7320 220a 2020 2020 2020 2020 2020  ons ".          
+00051a60: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00051a70: 7b74 7570 6c65 2875 6e65 7870 6563 7465  {tuple(unexpecte
+00051a80: 6429 7d2e 2049 7420 7368 6f75 6c64 206f  d)}. It should o
+00051a90: 6e6c 7920 6861 7665 2064 696d 656e 7369  nly have dimensi
+00051aa0: 6f6e 7320 7468 6174 2061 7265 2069 6e20  ons that are in 
+00051ab0: 6461 7461 2022 0a20 2020 2020 2020 2020  data ".         
+00051ac0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+00051ad0: 2264 696d 656e 7369 6f6e 7320 7b70 7265  "dimensions {pre
+00051ae0: 7365 7276 6564 5f64 696d 737d 2e22 0a20  served_dims}.". 
+00051af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051b00: 2020 2029 0a20 2020 2020 2020 2066 6f72     ).        for
+00051b10: 2070 6172 616d 2c20 286c 622c 2075 6229   param, (lb, ub)
+00051b20: 2069 6e20 626f 756e 6473 2e69 7465 6d73   in bounds.items
+00051b30: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00051b40: 666f 7220 6c61 6265 6c2c 2062 6f75 6e64  for label, bound
+00051b50: 2069 6e20 7a69 7028 2822 4c6f 7765 7222   in zip(("Lower"
+00051b60: 2c20 2255 7070 6572 2229 2c20 286c 622c  , "Upper"), (lb,
+00051b70: 2075 6229 293a 0a20 2020 2020 2020 2020   ub)):.         
+00051b80: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+00051b90: 616e 6365 2862 6f75 6e64 2c20 4461 7461  ance(bound, Data
+00051ba0: 4172 7261 7929 3a0a 2020 2020 2020 2020  Array):.        
+00051bb0: 2020 2020 2020 2020 2020 2020 756e 6578              unex
+00051bc0: 7065 6374 6564 203d 2073 6574 2862 6f75  pected = set(bou
+00051bd0: 6e64 2e64 696d 7329 202d 2073 6574 2870  nd.dims) - set(p
+00051be0: 7265 7365 7276 6564 5f64 696d 7329 0a20  reserved_dims). 
+00051bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051c00: 2020 2069 6620 756e 6578 7065 6374 6564     if unexpected
+00051c10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00051c20: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00051c30: 5661 6c75 6545 7272 6f72 280a 2020 2020  ValueError(.    
+00051c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051c50: 2020 2020 2020 2020 6622 7b6c 6162 656c          f"{label
+00051c60: 7d20 626f 756e 6420 666f 7220 277b 7061  } bound for '{pa
+00051c70: 7261 6d7d 2720 6861 7320 756e 6578 7065  ram}' has unexpe
+00051c80: 6374 6564 2064 696d 656e 7369 6f6e 7320  cted dimensions 
+00051c90: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00051ca0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+00051cb0: 7b74 7570 6c65 2875 6e65 7870 6563 7465  {tuple(unexpecte
+00051cc0: 6429 7d2e 2049 7420 7368 6f75 6c64 206f  d)}. It should o
+00051cd0: 6e6c 7920 6861 7665 2064 696d 656e 7369  nly have dimensi
+00051ce0: 6f6e 7320 7468 6174 2061 7265 2069 6e20  ons that are in 
+00051cf0: 6461 7461 2022 0a20 2020 2020 2020 2020  data ".         
+00051d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00051d10: 2020 2066 2264 696d 656e 7369 6f6e 7320     f"dimensions 
+00051d20: 7b70 7265 7365 7276 6564 5f64 696d 737d  {preserved_dims}
+00051d30: 2e22 0a20 2020 2020 2020 2020 2020 2020  .".             
+00051d40: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00051d50: 2020 2020 2020 6966 2065 7272 6f72 7320        if errors 
+00051d60: 6e6f 7420 696e 205b 2272 6169 7365 222c  not in ["raise",
+00051d70: 2022 6967 6e6f 7265 225d 3a0a 2020 2020   "ignore"]:.    
+00051d80: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00051d90: 6c75 6545 7272 6f72 2827 6572 726f 7273  lueError('errors
+00051da0: 206d 7573 7420 6265 2065 6974 6865 7220   must be either 
+00051db0: 2272 6169 7365 2220 6f72 2022 6967 6e6f  "raise" or "igno
+00051dc0: 7265 2227 290a 0a20 2020 2020 2020 2023  re"')..        #
+00051dd0: 2042 726f 6164 6361 7374 2061 6c6c 2063   Broadcast all c
+00051de0: 6f6f 7264 7320 7769 7468 2065 6163 6820  oords with each 
+00051df0: 6f74 6865 720a 2020 2020 2020 2020 636f  other.        co
+00051e00: 6f72 6473 5f20 3d20 6272 6f61 6463 6173  ords_ = broadcas
+00051e10: 7428 2a63 6f6f 7264 735f 290a 2020 2020  t(*coords_).    
+00051e20: 2020 2020 636f 6f72 6473 5f20 3d20 5b0a      coords_ = [.
+00051e30: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
+00051e40: 642e 6272 6f61 6463 6173 745f 6c69 6b65  d.broadcast_like
+00051e50: 2873 656c 662c 2065 7863 6c75 6465 3d70  (self, exclude=p
+00051e60: 7265 7365 7276 6564 5f64 696d 7329 2066  reserved_dims) f
+00051e70: 6f72 2063 6f6f 7264 2069 6e20 636f 6f72  or coord in coor
+00051e80: 6473 5f0a 2020 2020 2020 2020 5d0a 2020  ds_.        ].  
+00051e90: 2020 2020 2020 6e5f 636f 6f72 6473 203d        n_coords =
+00051ea0: 206c 656e 2863 6f6f 7264 735f 290a 0a20   len(coords_).. 
+00051eb0: 2020 2020 2020 2070 6172 616d 732c 2066         params, f
+00051ec0: 756e 635f 6172 6773 203d 205f 6765 745f  unc_args = _get_
+00051ed0: 6675 6e63 5f61 7267 7328 6675 6e63 2c20  func_args(func, 
+00051ee0: 7061 7261 6d5f 6e61 6d65 7329 0a20 2020  param_names).   
+00051ef0: 2020 2020 2070 6172 616d 5f64 6566 6175       param_defau
+00051f00: 6c74 732c 2062 6f75 6e64 735f 6465 6661  lts, bounds_defa
+00051f10: 756c 7473 203d 205f 696e 6974 6961 6c69  ults = _initiali
+00051f20: 7a65 5f63 7572 7665 6669 745f 7061 7261  ze_curvefit_para
+00051f30: 6d73 280a 2020 2020 2020 2020 2020 2020  ms(.            
+00051f40: 7061 7261 6d73 2c20 7030 2c20 626f 756e  params, p0, boun
+00051f50: 6473 2c20 6675 6e63 5f61 7267 730a 2020  ds, func_args.  
+00051f60: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+00051f70: 6e5f 7061 7261 6d73 203d 206c 656e 2870  n_params = len(p
+00051f80: 6172 616d 7329 0a0a 2020 2020 2020 2020  arams)..        
+00051f90: 6465 6620 5f77 7261 7070 6572 2859 2c20  def _wrapper(Y, 
+00051fa0: 2a61 7267 732c 202a 2a6b 7761 7267 7329  *args, **kwargs)
+00051fb0: 3a0a 2020 2020 2020 2020 2020 2020 2320  :.            # 
+00051fc0: 5772 6170 2063 7572 7665 5f66 6974 2077  Wrap curve_fit w
+00051fd0: 6974 6820 7261 7665 6c65 6420 636f 6f72  ith raveled coor
+00051fe0: 6469 6e61 7465 7320 616e 6420 706f 696e  dinates and poin
+00051ff0: 7477 6973 6520 4e61 4e20 6861 6e64 6c69  twise NaN handli
+00052000: 6e67 0a20 2020 2020 2020 2020 2020 2023  ng.            #
+00052010: 202a 6172 6773 2063 6f6e 7461 696e 733a   *args contains:
+00052020: 0a20 2020 2020 2020 2020 2020 2023 2020  .            #  
+00052030: 202d 2074 6865 2063 6f6f 7264 696e 6174   - the coordinat
+00052040: 6573 0a20 2020 2020 2020 2020 2020 2023  es.            #
+00052050: 2020 202d 2069 6e69 7469 616c 2067 7565     - initial gue
+00052060: 7373 0a20 2020 2020 2020 2020 2020 2023  ss.            #
+00052070: 2020 202d 206c 6f77 6572 2062 6f75 6e64     - lower bound
+00052080: 730a 2020 2020 2020 2020 2020 2020 2320  s.            # 
+00052090: 2020 2d20 7570 7065 7220 626f 756e 6473    - upper bounds
+000520a0: 0a20 2020 2020 2020 2020 2020 2063 6f6f  .            coo
+000520b0: 7264 735f 5f20 3d20 6172 6773 5b3a 6e5f  rds__ = args[:n_
+000520c0: 636f 6f72 6473 5d0a 2020 2020 2020 2020  coords].        
+000520d0: 2020 2020 7030 5f20 3d20 6172 6773 5b6e      p0_ = args[n
+000520e0: 5f63 6f6f 7264 7320 2b20 3020 2a20 6e5f  _coords + 0 * n_
+000520f0: 7061 7261 6d73 203a 206e 5f63 6f6f 7264  params : n_coord
+00052100: 7320 2b20 3120 2a20 6e5f 7061 7261 6d73  s + 1 * n_params
+00052110: 5d0a 2020 2020 2020 2020 2020 2020 6c62  ].            lb
+00052120: 203d 2061 7267 735b 6e5f 636f 6f72 6473   = args[n_coords
+00052130: 202b 2031 202a 206e 5f70 6172 616d 7320   + 1 * n_params 
+00052140: 3a20 6e5f 636f 6f72 6473 202b 2032 202a  : n_coords + 2 *
+00052150: 206e 5f70 6172 616d 735d 0a20 2020 2020   n_params].     
+00052160: 2020 2020 2020 2075 6220 3d20 6172 6773         ub = args
+00052170: 5b6e 5f63 6f6f 7264 7320 2b20 3220 2a20  [n_coords + 2 * 
+00052180: 6e5f 7061 7261 6d73 203a 5d0a 0a20 2020  n_params :]..   
+00052190: 2020 2020 2020 2020 2078 203d 206e 702e           x = np.
+000521a0: 7673 7461 636b 285b 632e 7261 7665 6c28  vstack([c.ravel(
+000521b0: 2920 666f 7220 6320 696e 2063 6f6f 7264  ) for c in coord
+000521c0: 735f 5f5d 290a 2020 2020 2020 2020 2020  s__]).          
+000521d0: 2020 7920 3d20 592e 7261 7665 6c28 290a    y = Y.ravel().
+000521e0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+000521f0: 6b69 706e 613a 0a20 2020 2020 2020 2020  kipna:.         
+00052200: 2020 2020 2020 206d 6173 6b20 3d20 6e70         mask = np
+00052210: 2e61 6c6c 285b 6e70 2e61 6e79 287e 6e70  .all([np.any(~np
+00052220: 2e69 736e 616e 2878 292c 2061 7869 733d  .isnan(x), axis=
+00052230: 3029 2c20 7e6e 702e 6973 6e61 6e28 7929  0), ~np.isnan(y)
+00052240: 5d2c 2061 7869 733d 3029 0a20 2020 2020  ], axis=0).     
+00052250: 2020 2020 2020 2020 2020 2078 203d 2078             x = x
+00052260: 5b3a 2c20 6d61 736b 5d0a 2020 2020 2020  [:, mask].      
+00052270: 2020 2020 2020 2020 2020 7920 3d20 795b            y = y[
+00052280: 6d61 736b 5d0a 2020 2020 2020 2020 2020  mask].          
+00052290: 2020 2020 2020 6966 206e 6f74 206c 656e        if not len
+000522a0: 2879 293a 0a20 2020 2020 2020 2020 2020  (y):.           
+000522b0: 2020 2020 2020 2020 2070 6f70 7420 3d20           popt = 
+000522c0: 6e70 2e66 756c 6c28 5b6e 5f70 6172 616d  np.full([n_param
+000522d0: 735d 2c20 6e70 2e6e 616e 290a 2020 2020  s], np.nan).    
+000522e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000522f0: 7063 6f76 203d 206e 702e 6675 6c6c 285b  pcov = np.full([
+00052300: 6e5f 7061 7261 6d73 2c20 6e5f 7061 7261  n_params, n_para
+00052310: 6d73 5d2c 206e 702e 6e61 6e29 0a20 2020  ms], np.nan).   
+00052320: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052330: 2072 6574 7572 6e20 706f 7074 2c20 7063   return popt, pc
+00052340: 6f76 0a20 2020 2020 2020 2020 2020 2078  ov.            x
+00052350: 203d 206e 702e 7371 7565 657a 6528 7829   = np.squeeze(x)
+00052360: 0a0a 2020 2020 2020 2020 2020 2020 7472  ..            tr
+00052370: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
+00052380: 2020 2070 6f70 742c 2070 636f 7620 3d20     popt, pcov = 
+00052390: 6375 7276 655f 6669 7428 6675 6e63 2c20  curve_fit(func, 
+000523a0: 782c 2079 2c20 7030 3d70 305f 2c20 626f  x, y, p0=p0_, bo
+000523b0: 756e 6473 3d28 6c62 2c20 7562 292c 202a  unds=(lb, ub), *
+000523c0: 2a6b 7761 7267 7329 0a20 2020 2020 2020  *kwargs).       
+000523d0: 2020 2020 2065 7863 6570 7420 5275 6e74       except Runt
+000523e0: 696d 6545 7272 6f72 3a0a 2020 2020 2020  imeError:.      
+000523f0: 2020 2020 2020 2020 2020 6966 2065 7272            if err
+00052400: 6f72 7320 3d3d 2022 7261 6973 6522 3a0a  ors == "raise":.
+00052410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052420: 2020 2020 7261 6973 650a 2020 2020 2020      raise.      
+00052430: 2020 2020 2020 2020 2020 706f 7074 203d            popt =
+00052440: 206e 702e 6675 6c6c 285b 6e5f 7061 7261   np.full([n_para
+00052450: 6d73 5d2c 206e 702e 6e61 6e29 0a20 2020  ms], np.nan).   
+00052460: 2020 2020 2020 2020 2020 2020 2070 636f               pco
+00052470: 7620 3d20 6e70 2e66 756c 6c28 5b6e 5f70  v = np.full([n_p
+00052480: 6172 616d 732c 206e 5f70 6172 616d 735d  arams, n_params]
+00052490: 2c20 6e70 2e6e 616e 290a 0a20 2020 2020  , np.nan)..     
+000524a0: 2020 2020 2020 2072 6574 7572 6e20 706f         return po
+000524b0: 7074 2c20 7063 6f76 0a0a 2020 2020 2020  pt, pcov..      
+000524c0: 2020 7265 7375 6c74 203d 2074 7970 6528    result = type(
+000524d0: 7365 6c66 2928 290a 2020 2020 2020 2020  self)().        
+000524e0: 666f 7220 6e61 6d65 2c20 6461 2069 6e20  for name, da in 
+000524f0: 7365 6c66 2e64 6174 615f 7661 7273 2e69  self.data_vars.i
+00052500: 7465 6d73 2829 3a0a 2020 2020 2020 2020  tems():.        
+00052510: 2020 2020 6966 206e 616d 6520 6973 205f      if name is _
+00052520: 5448 4953 5f41 5252 4159 3a0a 2020 2020  THIS_ARRAY:.    
+00052530: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00052540: 203d 2022 220a 2020 2020 2020 2020 2020   = "".          
+00052550: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00052560: 2020 2020 2020 2020 6e61 6d65 203d 2066          name = f
+00052570: 227b 7374 7228 6e61 6d65 297d 5f22 0a0a  "{str(name)}_"..
+00052580: 2020 2020 2020 2020 2020 2020 696e 7075              inpu
+00052590: 745f 636f 7265 5f64 696d 7320 3d20 5b72  t_core_dims = [r
+000525a0: 6564 7563 655f 6469 6d73 5f20 666f 7220  educe_dims_ for 
+000525b0: 5f20 696e 2072 616e 6765 286e 5f63 6f6f  _ in range(n_coo
+000525c0: 7264 7320 2b20 3129 5d0a 2020 2020 2020  rds + 1)].      
+000525d0: 2020 2020 2020 696e 7075 745f 636f 7265        input_core
+000525e0: 5f64 696d 732e 6578 7465 6e64 280a 2020  _dims.extend(.  
+000525f0: 2020 2020 2020 2020 2020 2020 2020 5b5b                [[
+00052600: 5d20 666f 7220 5f20 696e 2072 616e 6765  ] for _ in range
+00052610: 2833 202a 206e 5f70 6172 616d 7329 5d0a  (3 * n_params)].
+00052620: 2020 2020 2020 2020 2020 2020 2920 2023              )  #
+00052630: 2063 6f72 655f 6469 6d73 2066 6f72 2070   core_dims for p
+00052640: 3020 616e 6420 626f 756e 6473 0a0a 2020  0 and bounds..  
+00052650: 2020 2020 2020 2020 2020 706f 7074 2c20            popt, 
+00052660: 7063 6f76 203d 2061 7070 6c79 5f75 6675  pcov = apply_ufu
+00052670: 6e63 280a 2020 2020 2020 2020 2020 2020  nc(.            
+00052680: 2020 2020 5f77 7261 7070 6572 2c0a 2020      _wrapper,.  
+00052690: 2020 2020 2020 2020 2020 2020 2020 6461                da
+000526a0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000526b0: 2020 2a63 6f6f 7264 735f 2c0a 2020 2020    *coords_,.    
+000526c0: 2020 2020 2020 2020 2020 2020 2a70 6172              *par
+000526d0: 616d 5f64 6566 6175 6c74 732e 7661 6c75  am_defaults.valu
+000526e0: 6573 2829 2c0a 2020 2020 2020 2020 2020  es(),.          
+000526f0: 2020 2020 2020 2a5b 625b 305d 2066 6f72        *[b[0] for
+00052700: 2062 2069 6e20 626f 756e 6473 5f64 6566   b in bounds_def
+00052710: 6175 6c74 732e 7661 6c75 6573 2829 5d2c  aults.values()],
+00052720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00052730: 202a 5b62 5b31 5d20 666f 7220 6220 696e   *[b[1] for b in
+00052740: 2062 6f75 6e64 735f 6465 6661 756c 7473   bounds_defaults
+00052750: 2e76 616c 7565 7328 295d 2c0a 2020 2020  .values()],.    
+00052760: 2020 2020 2020 2020 2020 2020 7665 6374              vect
+00052770: 6f72 697a 653d 5472 7565 2c0a 2020 2020  orize=True,.    
+00052780: 2020 2020 2020 2020 2020 2020 6461 736b              dask
+00052790: 3d22 7061 7261 6c6c 656c 697a 6564 222c  ="parallelized",
+000527a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000527b0: 2069 6e70 7574 5f63 6f72 655f 6469 6d73   input_core_dims
+000527c0: 3d69 6e70 7574 5f63 6f72 655f 6469 6d73  =input_core_dims
+000527d0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+000527e0: 2020 6f75 7470 7574 5f63 6f72 655f 6469    output_core_di
+000527f0: 6d73 3d5b 5b22 7061 7261 6d22 5d2c 205b  ms=[["param"], [
+00052800: 2263 6f76 5f69 222c 2022 636f 765f 6a22  "cov_i", "cov_j"
+00052810: 5d5d 2c0a 2020 2020 2020 2020 2020 2020  ]],.            
+00052820: 2020 2020 6461 736b 5f67 7566 756e 635f      dask_gufunc_
+00052830: 6b77 6172 6773 3d7b 0a20 2020 2020 2020  kwargs={.       
+00052840: 2020 2020 2020 2020 2020 2020 2022 6f75               "ou
+00052850: 7470 7574 5f73 697a 6573 223a 207b 0a20  tput_sizes": {. 
+00052860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00052870: 2020 2020 2020 2022 7061 7261 6d22 3a20         "param": 
+00052880: 6e5f 7061 7261 6d73 2c0a 2020 2020 2020  n_params,.      
+00052890: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000528a0: 2020 2263 6f76 5f69 223a 206e 5f70 6172    "cov_i": n_par
+000528b0: 616d 732c 0a20 2020 2020 2020 2020 2020  ams,.           
+000528c0: 2020 2020 2020 2020 2020 2020 2022 636f               "co
+000528d0: 765f 6a22 3a20 6e5f 7061 7261 6d73 2c0a  v_j": n_params,.
+000528e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000528f0: 2020 2020 7d2c 0a20 2020 2020 2020 2020      },.         
+00052900: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00052910: 2020 2020 2020 2020 2020 6f75 7470 7574            output
+00052920: 5f64 7479 7065 733d 286e 702e 666c 6f61  _dtypes=(np.floa
+00052930: 7436 342c 206e 702e 666c 6f61 7436 3429  t64, np.float64)
+00052940: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00052950: 2020 6578 636c 7564 655f 6469 6d73 3d73    exclude_dims=s
+00052960: 6574 2872 6564 7563 655f 6469 6d73 5f29  et(reduce_dims_)
+00052970: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00052980: 2020 6b77 6172 6773 3d6b 7761 7267 732c    kwargs=kwargs,
+00052990: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+000529a0: 2020 2020 2020 2020 2020 2072 6573 756c             resul
+000529b0: 745b 6e61 6d65 202b 2022 6375 7276 6566  t[name + "curvef
+000529c0: 6974 5f63 6f65 6666 6963 6965 6e74 7322  it_coefficients"
+000529d0: 5d20 3d20 706f 7074 0a20 2020 2020 2020  ] = popt.       
+000529e0: 2020 2020 2072 6573 756c 745b 6e61 6d65       result[name
+000529f0: 202b 2022 6375 7276 6566 6974 5f63 6f76   + "curvefit_cov
+00052a00: 6172 6961 6e63 6522 5d20 3d20 7063 6f76  ariance"] = pcov
+00052a10: 0a0a 2020 2020 2020 2020 7265 7375 6c74  ..        result
+00052a20: 203d 2072 6573 756c 742e 6173 7369 676e   = result.assign
+00052a30: 5f63 6f6f 7264 7328 0a20 2020 2020 2020  _coords(.       
+00052a40: 2020 2020 207b 2270 6172 616d 223a 2070       {"param": p
+00052a50: 6172 616d 732c 2022 636f 765f 6922 3a20  arams, "cov_i": 
+00052a60: 7061 7261 6d73 2c20 2263 6f76 5f6a 223a  params, "cov_j":
+00052a70: 2070 6172 616d 737d 0a20 2020 2020 2020   params}.       
+00052a80: 2029 0a20 2020 2020 2020 2072 6573 756c   ).        resul
+00052a90: 742e 6174 7472 7320 3d20 7365 6c66 2e61  t.attrs = self.a
+00052aa0: 7474 7273 2e63 6f70 7928 290a 0a20 2020  ttrs.copy()..   
+00052ab0: 2020 2020 2072 6574 7572 6e20 7265 7375       return resu
+00052ac0: 6c74 0a0a 2020 2020 6465 6620 6472 6f70  lt..    def drop
+00052ad0: 5f64 7570 6c69 6361 7465 7328 0a20 2020  _duplicates(.   
+00052ae0: 2020 2020 2073 656c 663a 2054 5f44 6174       self: T_Dat
+00052af0: 6173 6574 2c0a 2020 2020 2020 2020 6469  aset,.        di
+00052b00: 6d3a 2048 6173 6861 626c 6520 7c20 4974  m: Hashable | It
+00052b10: 6572 6162 6c65 5b48 6173 6861 626c 655d  erable[Hashable]
+00052b20: 2c0a 2020 2020 2020 2020 6b65 6570 3a20  ,.        keep: 
+00052b30: 4c69 7465 7261 6c5b 2266 6972 7374 222c  Literal["first",
+00052b40: 2022 6c61 7374 222c 2046 616c 7365 5d20   "last", False] 
+00052b50: 3d20 2266 6972 7374 222c 0a20 2020 2029  = "first",.    )
+00052b60: 202d 3e20 545f 4461 7461 7365 743a 0a20   -> T_Dataset:. 
+00052b70: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
+00052b80: 7320 6120 6e65 7720 4461 7461 7365 7420  s a new Dataset 
+00052b90: 7769 7468 2064 7570 6c69 6361 7465 2064  with duplicate d
+00052ba0: 696d 656e 7369 6f6e 2076 616c 7565 7320  imension values 
+00052bb0: 7265 6d6f 7665 642e 0a0a 2020 2020 2020  removed...      
+00052bc0: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00052bd0: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00052be0: 2020 2020 2020 2020 6469 6d20 3a20 6469          dim : di
+00052bf0: 6d65 6e73 696f 6e20 6c61 6265 6c20 6f72  mension label or
+00052c00: 206c 6162 656c 730a 2020 2020 2020 2020   labels.        
+00052c10: 2020 2020 5061 7373 2060 2e2e 2e60 2074      Pass `...` t
+00052c20: 6f20 6472 6f70 2064 7570 6c69 6361 7465  o drop duplicate
+00052c30: 7320 616c 6f6e 6720 616c 6c20 6469 6d65  s along all dime
+00052c40: 6e73 696f 6e73 2e0a 2020 2020 2020 2020  nsions..        
+00052c50: 6b65 6570 203a 207b 2266 6972 7374 222c  keep : {"first",
+00052c60: 2022 6c61 7374 222c 2046 616c 7365 7d2c   "last", False},
+00052c70: 2064 6566 6175 6c74 3a20 2266 6972 7374   default: "first
+00052c80: 220a 2020 2020 2020 2020 2020 2020 4465  ".            De
+00052c90: 7465 726d 696e 6573 2077 6869 6368 2064  termines which d
+00052ca0: 7570 6c69 6361 7465 7320 2869 6620 616e  uplicates (if an
+00052cb0: 7929 2074 6f20 6b65 6570 2e0a 2020 2020  y) to keep..    
+00052cc0: 2020 2020 2020 2020 2d20 6060 2266 6972          - ``"fir
+00052cd0: 7374 2260 6020 3a20 4472 6f70 2064 7570  st"`` : Drop dup
+00052ce0: 6c69 6361 7465 7320 6578 6365 7074 2066  licates except f
+00052cf0: 6f72 2074 6865 2066 6972 7374 206f 6363  or the first occ
+00052d00: 7572 7265 6e63 652e 0a20 2020 2020 2020  urrence..       
+00052d10: 2020 2020 202d 2060 6022 6c61 7374 2260       - ``"last"`
+00052d20: 6020 3a20 4472 6f70 2064 7570 6c69 6361  ` : Drop duplica
+00052d30: 7465 7320 6578 6365 7074 2066 6f72 2074  tes except for t
+00052d40: 6865 206c 6173 7420 6f63 6375 7272 656e  he last occurren
+00052d50: 6365 2e0a 2020 2020 2020 2020 2020 2020  ce..            
+00052d60: 2d20 4661 6c73 6520 3a20 4472 6f70 2061  - False : Drop a
+00052d70: 6c6c 2064 7570 6c69 6361 7465 732e 0a0a  ll duplicates...
+00052d80: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00052d90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00052da0: 2020 2020 2020 2020 4461 7461 7365 740a          Dataset.
+00052db0: 0a20 2020 2020 2020 2053 6565 2041 6c73  .        See Als
+00052dc0: 6f0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  o.        ------
+00052dd0: 2d2d 0a20 2020 2020 2020 2044 6174 6141  --.        DataA
+00052de0: 7272 6179 2e64 726f 705f 6475 706c 6963  rray.drop_duplic
+00052df0: 6174 6573 0a20 2020 2020 2020 2022 2222  ates.        """
+00052e00: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+00052e10: 7374 616e 6365 2864 696d 2c20 7374 7229  stance(dim, str)
+00052e20: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+00052e30: 6d73 3a20 4974 6572 6162 6c65 203d 2028  ms: Iterable = (
+00052e40: 6469 6d2c 290a 2020 2020 2020 2020 656c  dim,).        el
+00052e50: 6966 2064 696d 2069 7320 2e2e 2e3a 0a20  if dim is ...:. 
+00052e60: 2020 2020 2020 2020 2020 2064 696d 7320             dims 
+00052e70: 3d20 7365 6c66 2e64 696d 730a 2020 2020  = self.dims.    
+00052e80: 2020 2020 656c 6966 206e 6f74 2069 7369      elif not isi
+00052e90: 6e73 7461 6e63 6528 6469 6d2c 2049 7465  nstance(dim, Ite
+00052ea0: 7261 626c 6529 3a0a 2020 2020 2020 2020  rable):.        
+00052eb0: 2020 2020 6469 6d73 203d 205b 6469 6d5d      dims = [dim]
+00052ec0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+00052ed0: 2020 2020 2020 2020 2020 2064 696d 7320             dims 
+00052ee0: 3d20 6469 6d0a 0a20 2020 2020 2020 206d  = dim..        m
+00052ef0: 6973 7369 6e67 5f64 696d 7320 3d20 7365  issing_dims = se
+00052f00: 7428 6469 6d73 2920 2d20 7365 7428 7365  t(dims) - set(se
+00052f10: 6c66 2e64 696d 7329 0a20 2020 2020 2020  lf.dims).       
+00052f20: 2069 6620 6d69 7373 696e 675f 6469 6d73   if missing_dims
+00052f30: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00052f40: 6973 6520 5661 6c75 6545 7272 6f72 2866  ise ValueError(f
+00052f50: 2227 7b6d 6973 7369 6e67 5f64 696d 737d  "'{missing_dims}
+00052f60: 2720 6e6f 7420 666f 756e 6420 696e 2064  ' not found in d
+00052f70: 696d 656e 7369 6f6e 7322 290a 0a20 2020  imensions")..   
+00052f80: 2020 2020 2069 6e64 6578 6573 203d 207b       indexes = {
+00052f90: 6469 6d3a 207e 7365 6c66 2e67 6574 5f69  dim: ~self.get_i
+00052fa0: 6e64 6578 2864 696d 292e 6475 706c 6963  ndex(dim).duplic
+00052fb0: 6174 6564 286b 6565 703d 6b65 6570 2920  ated(keep=keep) 
+00052fc0: 666f 7220 6469 6d20 696e 2064 696d 737d  for dim in dims}
+00052fd0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00052fe0: 7365 6c66 2e69 7365 6c28 696e 6465 7865  self.isel(indexe
+00052ff0: 7329 0a0a 2020 2020 6465 6620 636f 6e76  s)..    def conv
+00053000: 6572 745f 6361 6c65 6e64 6172 280a 2020  ert_calendar(.  
+00053010: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
+00053020: 7461 7365 742c 0a20 2020 2020 2020 2063  taset,.        c
+00053030: 616c 656e 6461 723a 2043 4643 616c 656e  alendar: CFCalen
+00053040: 6461 722c 0a20 2020 2020 2020 2064 696d  dar,.        dim
+00053050: 3a20 4861 7368 6162 6c65 203d 2022 7469  : Hashable = "ti
+00053060: 6d65 222c 0a20 2020 2020 2020 2061 6c69  me",.        ali
+00053070: 676e 5f6f 6e3a 204c 6974 6572 616c 5b22  gn_on: Literal["
+00053080: 6461 7465 222c 2022 7965 6172 222c 204e  date", "year", N
+00053090: 6f6e 655d 203d 204e 6f6e 652c 0a20 2020  one] = None,.   
+000530a0: 2020 2020 206d 6973 7369 6e67 3a20 416e       missing: An
+000530b0: 7920 7c20 4e6f 6e65 203d 204e 6f6e 652c  y | None = None,
+000530c0: 0a20 2020 2020 2020 2075 7365 5f63 6674  .        use_cft
+000530d0: 696d 653a 2062 6f6f 6c20 7c20 4e6f 6e65  ime: bool | None
+000530e0: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
+000530f0: 3e20 545f 4461 7461 7365 743a 0a20 2020  > T_Dataset:.   
+00053100: 2020 2020 2022 2222 436f 6e76 6572 7420       """Convert 
+00053110: 7468 6520 4461 7461 7365 7420 746f 2061  the Dataset to a
+00053120: 6e6f 7468 6572 2063 616c 656e 6461 722e  nother calendar.
+00053130: 0a0a 2020 2020 2020 2020 4f6e 6c79 2063  ..        Only c
+00053140: 6f6e 7665 7274 7320 7468 6520 696e 6469  onverts the indi
+00053150: 7669 6475 616c 2074 696d 6573 7461 6d70  vidual timestamp
+00053160: 732c 2064 6f65 7320 6e6f 7420 6d6f 6469  s, does not modi
+00053170: 6679 2061 6e79 2064 6174 6120 6578 6365  fy any data exce
+00053180: 7074 0a20 2020 2020 2020 2069 6e20 6472  pt.        in dr
+00053190: 6f70 7069 6e67 2069 6e76 616c 6964 2f73  opping invalid/s
+000531a0: 7572 706c 7573 2064 6174 6573 206f 7220  urplus dates or 
+000531b0: 696e 7365 7274 696e 6720 6d69 7373 696e  inserting missin
+000531c0: 6720 6461 7465 732e 0a0a 2020 2020 2020  g dates...      
+000531d0: 2020 4966 2074 6865 2073 6f75 7263 6520    If the source 
+000531e0: 616e 6420 7461 7267 6574 2063 616c 656e  and target calen
+000531f0: 6461 7273 2061 7265 2065 6974 6865 7220  dars are either 
+00053200: 6e6f 5f6c 6561 702c 2061 6c6c 5f6c 6561  no_leap, all_lea
+00053210: 7020 6f72 2061 0a20 2020 2020 2020 2073  p or a.        s
+00053220: 7461 6e64 6172 6420 7479 7065 2c20 6f6e  tandard type, on
+00053230: 6c79 2074 6865 2074 7970 6520 6f66 2074  ly the type of t
+00053240: 6865 2074 696d 6520 6172 7261 7920 6973  he time array is
+00053250: 206d 6f64 6966 6965 642e 0a20 2020 2020   modified..     
+00053260: 2020 2057 6865 6e20 636f 6e76 6572 7469     When converti
+00053270: 6e67 2074 6f20 6120 6c65 6170 2079 6561  ng to a leap yea
+00053280: 7220 6672 6f6d 2061 206e 6f6e 2d6c 6561  r from a non-lea
+00053290: 7020 7965 6172 2c20 7468 6520 3239 7468  p year, the 29th
+000532a0: 206f 6620 4665 6272 7561 7279 0a20 2020   of February.   
+000532b0: 2020 2020 2069 7320 7265 6d6f 7665 6420       is removed 
+000532c0: 6672 6f6d 2074 6865 2061 7272 6179 2e20  from the array. 
+000532d0: 496e 2074 6865 206f 7468 6572 2064 6972  In the other dir
+000532e0: 6563 7469 6f6e 2074 6865 2032 3974 6820  ection the 29th 
+000532f0: 6f66 2046 6562 7275 6172 790a 2020 2020  of February.    
+00053300: 2020 2020 7769 6c6c 2062 6520 6d69 7373      will be miss
+00053310: 696e 6720 696e 2074 6865 206f 7574 7075  ing in the outpu
+00053320: 742c 2075 6e6c 6573 7320 606d 6973 7369  t, unless `missi
+00053330: 6e67 6020 6973 2073 7065 6369 6669 6564  ng` is specified
+00053340: 2c0a 2020 2020 2020 2020 696e 2077 6869  ,.        in whi
+00053350: 6368 2063 6173 6520 7468 6174 2076 616c  ch case that val
+00053360: 7565 2069 7320 696e 7365 7274 6564 2e0a  ue is inserted..
+00053370: 0a20 2020 2020 2020 2046 6f72 2063 6f6e  .        For con
+00053380: 7665 7273 696f 6e73 2069 6e76 6f6c 7669  versions involvi
+00053390: 6e67 2060 3336 305f 6461 7960 2063 616c  ng `360_day` cal
+000533a0: 656e 6461 7273 2c20 7365 6520 4e6f 7465  endars, see Note
+000533b0: 732e 0a0a 2020 2020 2020 2020 5468 6973  s...        This
+000533c0: 206d 6574 686f 6420 6973 2073 6166 6520   method is safe 
+000533d0: 746f 2075 7365 2077 6974 6820 7375 622d  to use with sub-
+000533e0: 6461 696c 7920 6461 7461 2061 7320 6974  daily data as it
+000533f0: 2064 6f65 736e 2774 2074 6f75 6368 2074   doesn't touch t
+00053400: 6865 0a20 2020 2020 2020 2074 696d 6520  he.        time 
+00053410: 7061 7274 206f 6620 7468 6520 7469 6d65  part of the time
+00053420: 7374 616d 7073 2e0a 0a20 2020 2020 2020  stamps...       
+00053430: 2050 6172 616d 6574 6572 730a 2020 2020   Parameters.    
+00053440: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d0a 2020      ---------.  
+00053450: 2020 2020 2020 6361 6c65 6e64 6172 203a        calendar :
+00053460: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
+00053470: 2054 6865 2074 6172 6765 7420 6361 6c65   The target cale
+00053480: 6e64 6172 206e 616d 652e 0a20 2020 2020  ndar name..     
+00053490: 2020 2064 696d 203a 2048 6173 6861 626c     dim : Hashabl
+000534a0: 652c 2064 6566 6175 6c74 3a20 2274 696d  e, default: "tim
+000534b0: 6522 0a20 2020 2020 2020 2020 2020 204e  e".            N
+000534c0: 616d 6520 6f66 2074 6865 2074 696d 6520  ame of the time 
+000534d0: 636f 6f72 6469 6e61 7465 2e0a 2020 2020  coordinate..    
+000534e0: 2020 2020 616c 6967 6e5f 6f6e 203a 207b      align_on : {
+000534f0: 4e6f 6e65 2c20 2764 6174 6527 2c20 2779  None, 'date', 'y
+00053500: 6561 7227 7d2c 206f 7074 696f 6e61 6c0a  ear'}, optional.
+00053510: 2020 2020 2020 2020 2020 2020 4d75 7374              Must
+00053520: 2062 6520 7370 6563 6966 6965 6420 7768   be specified wh
+00053530: 656e 2065 6974 6865 7220 736f 7572 6365  en either source
+00053540: 206f 7220 7461 7267 6574 2069 7320 6120   or target is a 
+00053550: 6033 3630 5f64 6179 6020 6361 6c65 6e64  `360_day` calend
+00053560: 6172 2c0a 2020 2020 2020 2020 2020 2020  ar,.            
+00053570: 6967 6e6f 7265 6420 6f74 6865 7277 6973  ignored otherwis
+00053580: 652e 2053 6565 204e 6f74 6573 2e0a 2020  e. See Notes..  
+00053590: 2020 2020 2020 6d69 7373 696e 6720 3a20        missing : 
+000535a0: 416e 7920 6f72 204e 6f6e 652c 206f 7074  Any or None, opt
+000535b0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+000535c0: 2020 4279 2064 6566 6175 6c74 2c20 692e    By default, i.
+000535d0: 652e 2069 6620 7468 6520 7661 6c75 6520  e. if the value 
+000535e0: 6973 204e 6f6e 652c 2074 6869 7320 6d65  is None, this me
+000535f0: 7468 6f64 2077 696c 6c20 7369 6d70 6c79  thod will simply
+00053600: 2061 7474 656d 7074 0a20 2020 2020 2020   attempt.       
+00053610: 2020 2020 2074 6f20 636f 6e76 6572 7420       to convert 
+00053620: 7468 6520 6461 7465 7320 696e 2074 6865  the dates in the
+00053630: 2073 6f75 7263 6520 6361 6c65 6e64 6172   source calendar
+00053640: 2074 6f20 7468 6520 7361 6d65 2064 6174   to the same dat
+00053650: 6573 2069 6e20 7468 650a 2020 2020 2020  es in the.      
+00053660: 2020 2020 2020 7461 7267 6574 2063 616c        target cal
+00053670: 656e 6461 722c 2061 6e64 2064 726f 7020  endar, and drop 
+00053680: 616e 7920 6f66 2074 686f 7365 2074 6861  any of those tha
+00053690: 7420 6172 6520 6e6f 7420 706f 7373 6962  t are not possib
+000536a0: 6c65 2074 6f0a 2020 2020 2020 2020 2020  le to.          
+000536b0: 2020 7265 7072 6573 656e 742e 2020 4966    represent.  If
+000536c0: 2061 2076 616c 7565 2069 7320 7072 6f76   a value is prov
+000536d0: 6964 6564 2c20 6120 6e65 7720 7469 6d65  ided, a new time
+000536e0: 2063 6f6f 7264 696e 6174 6520 7769 6c6c   coordinate will
+000536f0: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+00053700: 6372 6561 7465 6420 696e 2074 6865 2074  created in the t
+00053710: 6172 6765 7420 6361 6c65 6e64 6172 2077  arget calendar w
+00053720: 6974 6820 7468 6520 7361 6d65 2066 7265  ith the same fre
+00053730: 7175 656e 6379 2061 7320 7468 6520 6f72  quency as the or
+00053740: 6967 696e 616c 0a20 2020 2020 2020 2020  iginal.         
+00053750: 2020 2074 696d 6520 636f 6f72 6469 6e61     time coordina
+00053760: 7465 3b20 666f 7220 616e 7920 6461 7465  te; for any date
+00053770: 7320 7468 6174 2061 7265 206e 6f74 2070  s that are not p
+00053780: 7265 7365 6e74 2069 6e20 7468 6520 736f  resent in the so
+00053790: 7572 6365 2c20 7468 650a 2020 2020 2020  urce, the.      
+000537a0: 2020 2020 2020 6461 7461 2077 696c 6c20        data will 
+000537b0: 6265 2066 696c 6c65 6420 7769 7468 2074  be filled with t
+000537c0: 6869 7320 7661 6c75 652e 2020 4e6f 7465  his value.  Note
+000537d0: 2074 6861 7420 7573 696e 6720 7468 6973   that using this
+000537e0: 206d 6f64 6520 7265 7175 6972 6573 0a20   mode requires. 
+000537f0: 2020 2020 2020 2020 2020 2074 6861 7420             that 
+00053800: 7468 6520 736f 7572 6365 2064 6174 6120  the source data 
+00053810: 6861 7665 2061 6e20 696e 6665 7261 626c  have an inferabl
+00053820: 6520 6672 6571 7565 6e63 793b 2066 6f72  e frequency; for
+00053830: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
+00053840: 6e0a 2020 2020 2020 2020 2020 2020 7365  n.            se
+00053850: 6520 3a70 793a 6675 6e63 3a60 7861 7272  e :py:func:`xarr
+00053860: 6179 2e69 6e66 6572 5f66 7265 7160 2e20  ay.infer_freq`. 
+00053870: 2046 6f72 2063 6572 7461 696e 2066 7265   For certain fre
+00053880: 7175 656e 6379 2c20 736f 7572 6365 2c20  quency, source, 
+00053890: 616e 640a 2020 2020 2020 2020 2020 2020  and.            
+000538a0: 7461 7267 6574 2063 616c 656e 6461 7220  target calendar 
+000538b0: 636f 6d62 696e 6174 696f 6e73 2c20 7468  combinations, th
+000538c0: 6973 2063 6f75 6c64 2072 6573 756c 7420  is could result 
+000538d0: 696e 206d 616e 7920 6d69 7373 696e 6720  in many missing 
+000538e0: 7661 6c75 6573 2c20 7365 6520 6e6f 7465  values, see note
+000538f0: 732e 0a20 2020 2020 2020 2075 7365 5f63  s..        use_c
+00053900: 6674 696d 6520 3a20 626f 6f6c 206f 7220  ftime : bool or 
+00053910: 4e6f 6e65 2c20 6f70 7469 6f6e 616c 0a20  None, optional. 
+00053920: 2020 2020 2020 2020 2020 2057 6865 7468             Wheth
+00053930: 6572 2074 6f20 7573 6520 6366 7469 6d65  er to use cftime
+00053940: 206f 626a 6563 7473 2069 6e20 7468 6520   objects in the 
+00053950: 6f75 7470 7574 2c20 6f6e 6c79 2075 7365  output, only use
+00053960: 6420 6966 2060 6361 6c65 6e64 6172 600a  d if `calendar`.
+00053970: 2020 2020 2020 2020 2020 2020 6973 206f              is o
+00053980: 6e65 206f 6620 7b22 7072 6f6c 6570 7469  ne of {"prolepti
+00053990: 635f 6772 6567 6f72 6961 6e22 2c20 2267  c_gregorian", "g
+000539a0: 7265 676f 7269 616e 2220 6f72 2022 7374  regorian" or "st
+000539b0: 616e 6461 7264 227d 2e0a 2020 2020 2020  andard"}..      
+000539c0: 2020 2020 2020 4966 2054 7275 652c 2074        If True, t
+000539d0: 6865 206e 6577 2074 696d 6520 6178 6973  he new time axis
+000539e0: 2075 7365 7320 6366 7469 6d65 206f 626a   uses cftime obj
+000539f0: 6563 7473 2e0a 2020 2020 2020 2020 2020  ects..          
+00053a00: 2020 4966 204e 6f6e 6520 2864 6566 6175    If None (defau
+00053a10: 6c74 292c 2069 7420 7573 6573 203a 7079  lt), it uses :py
+00053a20: 3a63 6c61 7373 3a60 6e75 6d70 792e 6461  :class:`numpy.da
+00053a30: 7465 7469 6d65 3634 6020 7661 6c75 6573  tetime64` values
+00053a40: 2069 6620 7468 650a 2020 2020 2020 2020   if the.        
+00053a50: 2020 2020 6461 7465 2072 616e 6765 2070      date range p
+00053a60: 6572 6d69 7473 2069 742c 2061 6e64 203a  ermits it, and :
+00053a70: 7079 3a63 6c61 7373 3a60 6366 7469 6d65  py:class:`cftime
+00053a80: 2e64 6174 6574 696d 6560 206f 626a 6563  .datetime` objec
+00053a90: 7473 2069 6620 6e6f 742e 0a20 2020 2020  ts if not..     
+00053aa0: 2020 2020 2020 2049 6620 4661 6c73 652c         If False,
+00053ab0: 2069 7420 7573 6573 203a 7079 3a63 6c61   it uses :py:cla
+00053ac0: 7373 3a60 6e75 6d70 792e 6461 7465 7469  ss:`numpy.dateti
+00053ad0: 6d65 3634 6020 206f 7220 6661 696c 732e  me64`  or fails.
+00053ae0: 0a0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00053af0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00053b00: 2d0a 2020 2020 2020 2020 4461 7461 7365  -.        Datase
+00053b10: 740a 2020 2020 2020 2020 2020 2020 436f  t.            Co
+00053b20: 7079 206f 6620 7468 6520 6461 7461 6172  py of the dataar
+00053b30: 7261 7920 7769 7468 2074 6865 2074 696d  ray with the tim
+00053b40: 6520 636f 6f72 6469 6e61 7465 2063 6f6e  e coordinate con
+00053b50: 7665 7274 6564 2074 6f20 7468 650a 2020  verted to the.  
+00053b60: 2020 2020 2020 2020 2020 7461 7267 6574            target
+00053b70: 2063 616c 656e 6461 722e 2049 6620 276d   calendar. If 'm
+00053b80: 6973 7369 6e67 2720 7761 7320 4e6f 6e65  issing' was None
+00053b90: 2028 6465 6661 756c 7429 2c20 696e 7661   (default), inva
+00053ba0: 6c69 6420 6461 7465 7320 696e 0a20 2020  lid dates in.   
+00053bb0: 2020 2020 2020 2020 2074 6865 206e 6577           the new
+00053bc0: 2063 616c 656e 6461 7220 6172 6520 6472   calendar are dr
+00053bd0: 6f70 7065 642c 2062 7574 206d 6973 7369  opped, but missi
+00053be0: 6e67 2064 6174 6573 2061 7265 206e 6f74  ng dates are not
+00053bf0: 2069 6e73 6572 7465 642e 0a20 2020 2020   inserted..     
+00053c00: 2020 2020 2020 2049 6620 606d 6973 7369         If `missi
+00053c10: 6e67 6020 7761 7320 6769 7665 6e2c 2074  ng` was given, t
+00053c20: 6865 206e 6577 2064 6174 6120 6973 2072  he new data is r
+00053c30: 6569 6e64 6578 6564 2074 6f20 6861 7665  eindexed to have
+00053c40: 2061 2074 696d 6520 6178 6973 0a20 2020   a time axis.   
+00053c50: 2020 2020 2020 2020 2077 6974 6820 7468           with th
+00053c60: 6520 7361 6d65 2066 7265 7175 656e 6379  e same frequency
+00053c70: 2061 7320 7468 6520 736f 7572 6365 2c20   as the source, 
+00053c80: 6275 7420 696e 2074 6865 206e 6577 2063  but in the new c
+00053c90: 616c 656e 6461 723b 2061 6e79 0a20 2020  alendar; any.   
+00053ca0: 2020 2020 2020 2020 206d 6973 7369 6e67           missing
+00053cb0: 2064 6174 6170 6f69 6e74 7320 6172 6520   datapoints are 
+00053cc0: 6669 6c6c 6564 2077 6974 6820 606d 6973  filled with `mis
+00053cd0: 7369 6e67 602e 0a0a 2020 2020 2020 2020  sing`...        
+00053ce0: 4e6f 7465 730a 2020 2020 2020 2020 2d2d  Notes.        --
+00053cf0: 2d2d 2d0a 2020 2020 2020 2020 5061 7373  ---.        Pass
+00053d00: 696e 6720 6120 7661 6c75 6520 746f 2060  ing a value to `
+00053d10: 6d69 7373 696e 6760 2069 7320 6f6e 6c79  missing` is only
+00053d20: 2075 7361 626c 6520 6966 2074 6865 2073   usable if the s
+00053d30: 6f75 7263 6527 7320 7469 6d65 2063 6f6f  ource's time coo
+00053d40: 7264 696e 6174 6520 6173 2061 6e0a 2020  rdinate as an.  
+00053d50: 2020 2020 2020 696e 6665 7261 626c 6520        inferable 
+00053d60: 6672 6571 7565 6e63 6965 7320 2873 6565  frequencies (see
+00053d70: 203a 7079 3a66 756e 633a 607e 7861 7272   :py:func:`~xarr
+00053d80: 6179 2e69 6e66 6572 5f66 7265 7160 2920  ay.infer_freq`) 
+00053d90: 616e 6420 6973 206f 6e6c 7920 6170 7072  and is only appr
+00053da0: 6f70 7269 6174 650a 2020 2020 2020 2020  opriate.        
+00053db0: 6966 2074 6865 2074 6172 6765 7420 636f  if the target co
+00053dc0: 6f72 6469 6e61 7465 2c20 6765 6e65 7261  ordinate, genera
+00053dd0: 7465 6420 6672 6f6d 2074 6869 7320 6672  ted from this fr
+00053de0: 6571 7565 6e63 792c 2068 6173 2064 6174  equency, has dat
+00053df0: 6573 2065 7175 6976 616c 656e 7420 746f  es equivalent to
+00053e00: 2074 6865 0a20 2020 2020 2020 2073 6f75   the.        sou
+00053e10: 7263 652e 2049 7420 6973 2075 7375 616c  rce. It is usual
+00053e20: 6c79 202a 2a6e 6f74 2a2a 2061 7070 726f  ly **not** appro
+00053e30: 7072 6961 7465 2074 6f20 7573 6520 7468  priate to use th
+00053e40: 6973 206d 6f64 6520 7769 7468 3a0a 0a20  is mode with:.. 
+00053e50: 2020 2020 2020 202d 2050 6572 696f 642d         - Period-
+00053e60: 656e 6420 6672 6571 7565 6e63 6965 7320  end frequencies 
+00053e70: 3a20 2741 272c 2027 5927 2c20 2751 2720  : 'A', 'Y', 'Q' 
+00053e80: 6f72 2027 4d27 2c20 696e 206f 7070 6f73  or 'M', in oppos
+00053e90: 6974 696f 6e20 746f 2027 4153 2720 2759  ition to 'AS' 'Y
+00053ea0: 5327 2c20 2751 5327 2061 6e64 2027 4d53  S', 'QS' and 'MS
+00053eb0: 270a 2020 2020 2020 2020 2d20 5375 622d  '.        - Sub-
+00053ec0: 6d6f 6e74 686c 7920 6672 6571 7565 6e63  monthly frequenc
+00053ed0: 6965 7320 7468 6174 2064 6f20 6e6f 7420  ies that do not 
+00053ee0: 6469 7669 6465 2061 2064 6179 2065 7665  divide a day eve
+00053ef0: 6e6c 7920 3a20 2757 272c 2027 6e44 2720  nly : 'W', 'nD' 
+00053f00: 7768 6572 6520 604e 2021 3d20 3160 0a20  where `N != 1`. 
+00053f10: 2020 2020 2020 2020 2020 206f 7220 276d             or 'm
+00053f20: 4827 2077 6865 7265 2032 3420 2520 6d20  H' where 24 % m 
+00053f30: 213d 2030 292e 0a0a 2020 2020 2020 2020  != 0)...        
+00053f40: 4966 206f 6e65 206f 6620 7468 6520 736f  If one of the so
+00053f50: 7572 6365 206f 7220 7461 7267 6574 2063  urce or target c
+00053f60: 616c 656e 6461 7273 2069 7320 6022 3336  alendars is `"36
+00053f70: 305f 6461 7922 602c 2060 616c 6967 6e5f  0_day"`, `align_
+00053f80: 6f6e 6020 6d75 7374 0a20 2020 2020 2020  on` must.       
+00053f90: 2062 6520 7370 6563 6966 6965 6420 616e   be specified an
+00053fa0: 6420 7477 6f20 6f70 7469 6f6e 7320 6172  d two options ar
+00053fb0: 6520 6f66 6665 7265 642e 0a0a 2020 2020  e offered...    
+00053fc0: 2020 2020 2d20 2279 6561 7222 0a20 2020      - "year".   
+00053fd0: 2020 2020 2020 2020 2054 6865 2064 6174           The dat
+00053fe0: 6573 2061 7265 2074 7261 6e73 6c61 7465  es are translate
+00053ff0: 6420 6163 636f 7264 696e 6720 746f 2074  d according to t
+00054000: 6865 6972 2072 656c 6174 6976 6520 706f  heir relative po
+00054010: 7369 7469 6f6e 2069 6e20 7468 6520 7965  sition in the ye
+00054020: 6172 2c0a 2020 2020 2020 2020 2020 2020  ar,.            
+00054030: 6967 6e6f 7269 6e67 2074 6865 6972 206f  ignoring their o
+00054040: 7269 6769 6e61 6c20 6d6f 6e74 6820 616e  riginal month an
+00054050: 6420 6461 7920 696e 666f 726d 6174 696f  d day informatio
+00054060: 6e2c 206d 6561 6e69 6e67 2074 6861 7420  n, meaning that 
+00054070: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+00054080: 6d69 7373 696e 672f 7375 7270 6c75 7320  missing/surplus 
+00054090: 6461 7973 2061 7265 2061 6464 6564 2f72  days are added/r
+000540a0: 656d 6f76 6564 2061 7420 7265 6775 6c61  emoved at regula
+000540b0: 7220 696e 7465 7276 616c 732e 0a0a 2020  r intervals...  
+000540c0: 2020 2020 2020 2020 2020 4672 6f6d 2061            From a
+000540d0: 2060 3336 305f 6461 7960 2074 6f20 6120   `360_day` to a 
+000540e0: 7374 616e 6461 7264 2063 616c 656e 6461  standard calenda
+000540f0: 722c 2074 6865 206f 7574 7075 7420 7769  r, the output wi
+00054100: 6c6c 2062 6520 6d69 7373 696e 6720 7468  ll be missing th
+00054110: 650a 2020 2020 2020 2020 2020 2020 666f  e.            fo
+00054120: 6c6c 6f77 696e 6720 6461 7465 7320 2864  llowing dates (d
+00054130: 6179 206f 6620 7965 6172 2069 6e20 7061  ay of year in pa
+00054140: 7265 6e74 6865 7365 7329 3a0a 0a20 2020  rentheses):..   
+00054150: 2020 2020 2020 2020 2054 6f20 6120 6c65           To a le
+00054160: 6170 2079 6561 723a 0a20 2020 2020 2020  ap year:.       
+00054170: 2020 2020 2020 2020 204a 616e 7561 7279           January
+00054180: 2033 3173 7420 2833 3129 2c20 4d61 7263   31st (31), Marc
+00054190: 6820 3331 7374 2028 3931 292c 204a 756e  h 31st (91), Jun
+000541a0: 6520 3173 7420 2831 3533 292c 204a 756c  e 1st (153), Jul
+000541b0: 7920 3331 7374 2028 3231 3329 2c0a 2020  y 31st (213),.  
+000541c0: 2020 2020 2020 2020 2020 2020 2020 5365                Se
+000541d0: 7074 656d 6265 7220 3331 7374 2028 3237  ptember 31st (27
+000541e0: 3529 2061 6e64 204e 6f76 656d 6265 7220  5) and November 
+000541f0: 3330 7468 2028 3333 3529 2e0a 2020 2020  30th (335)..    
+00054200: 2020 2020 2020 2020 546f 2061 206e 6f6e          To a non
+00054210: 2d6c 6561 7020 7965 6172 3a0a 2020 2020  -leap year:.    
+00054220: 2020 2020 2020 2020 2020 2020 4665 6272              Febr
+00054230: 7561 7279 2036 7468 2028 3336 292c 2041  uary 6th (36), A
+00054240: 7072 696c 2031 3974 6820 2831 3039 292c  pril 19th (109),
+00054250: 204a 756c 7920 326e 6420 2831 3833 292c   July 2nd (183),
+00054260: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00054270: 2053 6570 7465 6d62 6572 2031 3274 6820   September 12th 
+00054280: 2832 3535 292c 204e 6f76 656d 6265 7220  (255), November 
+00054290: 3235 7468 2028 3332 3929 2e0a 0a20 2020  25th (329)...   
+000542a0: 2020 2020 2020 2020 2046 726f 6d20 6120           From a 
+000542b0: 7374 616e 6461 7264 2063 616c 656e 6461  standard calenda
+000542c0: 7220 746f 2061 2060 2233 3630 5f64 6179  r to a `"360_day
+000542d0: 2260 2c20 7468 6520 666f 6c6c 6f77 696e  "`, the followin
+000542e0: 6720 6461 7465 7320 696e 2074 6865 0a20  g dates in the. 
+000542f0: 2020 2020 2020 2020 2020 2073 6f75 7263             sourc
+00054300: 6520 6172 7261 7920 7769 6c6c 2062 6520  e array will be 
+00054310: 6472 6f70 7065 643a 0a0a 2020 2020 2020  dropped:..      
+00054320: 2020 2020 2020 4672 6f6d 2061 206c 6561        From a lea
+00054330: 7020 7965 6172 3a0a 2020 2020 2020 2020  p year:.        
+00054340: 2020 2020 2020 2020 4a61 6e75 6172 7920          January 
+00054350: 3331 7374 2028 3331 292c 2041 7072 696c  31st (31), April
+00054360: 2031 7374 2028 3932 292c 204a 756e 6520   1st (92), June 
+00054370: 3173 7420 2831 3533 292c 2041 7567 7573  1st (153), Augus
+00054380: 7420 3173 7420 2832 3134 292c 0a20 2020  t 1st (214),.   
+00054390: 2020 2020 2020 2020 2020 2020 2053 6570               Sep
+000543a0: 7465 6d62 6572 2033 3173 7420 2832 3735  tember 31st (275
+000543b0: 292c 2044 6563 656d 6265 7220 3173 7420  ), December 1st 
+000543c0: 2833 3336 290a 2020 2020 2020 2020 2020  (336).          
+000543d0: 2020 4672 6f6d 2061 206e 6f6e 2d6c 6561    From a non-lea
+000543e0: 7020 7965 6172 3a0a 2020 2020 2020 2020  p year:.        
+000543f0: 2020 2020 2020 2020 4665 6272 7561 7279          February
+00054400: 2036 7468 2028 3337 292c 2041 7072 696c   6th (37), April
+00054410: 2032 3074 6820 2831 3130 292c 204a 756c   20th (110), Jul
+00054420: 7920 326e 6420 2831 3833 292c 0a20 2020  y 2nd (183),.   
+00054430: 2020 2020 2020 2020 2020 2020 2053 6570               Sep
+00054440: 7465 6d62 6572 2031 3374 6820 2832 3536  tember 13th (256
+00054450: 292c 204e 6f76 656d 6265 7220 3235 7468  ), November 25th
+00054460: 2028 3332 3929 0a0a 2020 2020 2020 2020   (329)..        
+00054470: 2020 2020 5468 6973 206f 7074 696f 6e20      This option 
+00054480: 6973 2062 6573 7420 7573 6564 206f 6e20  is best used on 
+00054490: 6461 696c 7920 616e 6420 7375 6264 6169  daily and subdai
+000544a0: 6c79 2064 6174 612e 0a0a 2020 2020 2020  ly data...      
+000544b0: 2020 2d20 2264 6174 6522 0a20 2020 2020    - "date".     
+000544c0: 2020 2020 2020 2054 6865 206d 6f6e 7468         The month
+000544d0: 2f64 6179 2069 6e66 6f72 6d61 7469 6f6e  /day information
+000544e0: 2069 7320 636f 6e73 6572 7665 6420 616e   is conserved an
+000544f0: 6420 696e 7661 6c69 6420 6461 7465 7320  d invalid dates 
+00054500: 6172 6520 6472 6f70 7065 640a 2020 2020  are dropped.    
+00054510: 2020 2020 2020 2020 6672 6f6d 2074 6865          from the
+00054520: 206f 7574 7075 742e 2054 6869 7320 6d65   output. This me
+00054530: 616e 7320 7468 6174 2077 6865 6e20 636f  ans that when co
+00054540: 6e76 6572 7469 6e67 2066 726f 6d20 6120  nverting from a 
+00054550: 6022 3336 305f 6461 7922 6020 746f 2061  `"360_day"` to a
+00054560: 0a20 2020 2020 2020 2020 2020 2073 7461  .            sta
+00054570: 6e64 6172 6420 6361 6c65 6e64 6172 2c20  ndard calendar, 
+00054580: 616c 6c20 3331 7374 2028 4a61 6e2c 204d  all 31st (Jan, M
+00054590: 6172 6368 2c20 4d61 792c 204a 756c 792c  arch, May, July,
+000545a0: 2041 7567 7573 742c 204f 6374 6f62 6572   August, October
+000545b0: 2061 6e64 0a20 2020 2020 2020 2020 2020   and.           
+000545c0: 2044 6563 656d 6265 7229 2077 696c 6c20   December) will 
+000545d0: 6265 206d 6973 7369 6e67 2061 7320 7468  be missing as th
+000545e0: 6572 6520 6973 206e 6f20 6571 7569 7661  ere is no equiva
+000545f0: 6c65 6e74 2064 6174 6573 2069 6e20 7468  lent dates in th
+00054600: 650a 2020 2020 2020 2020 2020 2020 6022  e.            `"
+00054610: 3336 305f 6461 7922 6020 6361 6c65 6e64  360_day"` calend
+00054620: 6172 2061 6e64 2074 6865 2032 3974 6820  ar and the 29th 
+00054630: 286f 6e20 6e6f 6e2d 6c65 6170 2079 6561  (on non-leap yea
+00054640: 7273 2920 616e 6420 3330 7468 206f 6620  rs) and 30th of 
+00054650: 4665 6272 7561 7279 0a20 2020 2020 2020  February.       
+00054660: 2020 2020 2077 696c 6c20 6265 2064 726f       will be dro
+00054670: 7070 6564 2061 7320 7468 6572 6520 6172  pped as there ar
+00054680: 6520 6e6f 2065 7175 6976 616c 656e 7420  e no equivalent 
+00054690: 6461 7465 7320 696e 2061 2073 7461 6e64  dates in a stand
+000546a0: 6172 6420 6361 6c65 6e64 6172 2e0a 0a20  ard calendar... 
+000546b0: 2020 2020 2020 2020 2020 2054 6869 7320             This 
+000546c0: 6f70 7469 6f6e 2069 7320 6265 7374 2075  option is best u
+000546d0: 7365 6420 7769 7468 2064 6174 6120 6f6e  sed with data on
+000546e0: 2061 2066 7265 7175 656e 6379 2063 6f61   a frequency coa
+000546f0: 7273 6572 2074 6861 6e20 6461 696c 792e  rser than daily.
+00054700: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00054710: 2020 2020 2072 6574 7572 6e20 636f 6e76       return conv
+00054720: 6572 745f 6361 6c65 6e64 6172 280a 2020  ert_calendar(.  
+00054730: 2020 2020 2020 2020 2020 7365 6c66 2c0a            self,.
+00054740: 2020 2020 2020 2020 2020 2020 6361 6c65              cale
+00054750: 6e64 6172 2c0a 2020 2020 2020 2020 2020  ndar,.          
+00054760: 2020 6469 6d3d 6469 6d2c 0a20 2020 2020    dim=dim,.     
+00054770: 2020 2020 2020 2061 6c69 676e 5f6f 6e3d         align_on=
+00054780: 616c 6967 6e5f 6f6e 2c0a 2020 2020 2020  align_on,.      
+00054790: 2020 2020 2020 6d69 7373 696e 673d 6d69        missing=mi
+000547a0: 7373 696e 672c 0a20 2020 2020 2020 2020  ssing,.         
+000547b0: 2020 2075 7365 5f63 6674 696d 653d 7573     use_cftime=us
+000547c0: 655f 6366 7469 6d65 2c0a 2020 2020 2020  e_cftime,.      
+000547d0: 2020 290a 0a20 2020 2064 6566 2069 6e74    )..    def int
+000547e0: 6572 705f 6361 6c65 6e64 6172 280a 2020  erp_calendar(.  
+000547f0: 2020 2020 2020 7365 6c66 3a20 545f 4461        self: T_Da
+00054800: 7461 7365 742c 0a20 2020 2020 2020 2074  taset,.        t
+00054810: 6172 6765 743a 2070 642e 4461 7465 7469  arget: pd.Dateti
+00054820: 6d65 496e 6465 7820 7c20 4346 5469 6d65  meIndex | CFTime
+00054830: 496e 6465 7820 7c20 4461 7461 4172 7261  Index | DataArra
+00054840: 792c 0a20 2020 2020 2020 2064 696d 3a20  y,.        dim: 
+00054850: 4861 7368 6162 6c65 203d 2022 7469 6d65  Hashable = "time
+00054860: 222c 0a20 2020 2029 202d 3e20 545f 4461  ",.    ) -> T_Da
+00054870: 7461 7365 743a 0a20 2020 2020 2020 2022  taset:.        "
+00054880: 2222 496e 7465 7270 6f6c 6174 6573 2074  ""Interpolates t
+00054890: 6865 2044 6174 6173 6574 2074 6f20 616e  he Dataset to an
+000548a0: 6f74 6865 7220 6361 6c65 6e64 6172 2062  other calendar b
+000548b0: 6173 6564 206f 6e20 6465 6369 6d61 6c20  ased on decimal 
+000548c0: 7965 6172 206d 6561 7375 7265 2e0a 0a20  year measure... 
+000548d0: 2020 2020 2020 2045 6163 6820 7469 6d65         Each time
+000548e0: 7374 616d 7020 696e 2060 736f 7572 6365  stamp in `source
+000548f0: 6020 616e 6420 6074 6172 6765 7460 2061  ` and `target` a
+00054900: 7265 2066 6972 7374 2063 6f6e 7665 7274  re first convert
+00054910: 6564 2074 6f20 7468 6569 7220 6465 6369  ed to their deci
+00054920: 6d61 6c0a 2020 2020 2020 2020 7965 6172  mal.        year
+00054930: 2065 7175 6976 616c 656e 7420 7468 656e   equivalent then
+00054940: 2060 736f 7572 6365 6020 6973 2069 6e74   `source` is int
+00054950: 6572 706f 6c61 7465 6420 6f6e 2074 6865  erpolated on the
+00054960: 2074 6172 6765 7420 636f 6f72 6469 6e61   target coordina
+00054970: 7465 2e0a 2020 2020 2020 2020 5468 6520  te..        The 
+00054980: 6465 6369 6d61 6c20 7965 6172 206f 6620  decimal year of 
+00054990: 6120 7469 6d65 7374 616d 7020 6973 2069  a timestamp is i
+000549a0: 7473 2079 6561 7220 706c 7573 2069 7473  ts year plus its
+000549b0: 2073 7562 2d79 6561 7220 636f 6d70 6f6e   sub-year compon
+000549c0: 656e 740a 2020 2020 2020 2020 636f 6e76  ent.        conv
+000549d0: 6572 7465 6420 746f 2074 6865 2066 7261  erted to the fra
+000549e0: 6374 696f 6e20 6f66 2069 7473 2079 6561  ction of its yea
+000549f0: 722e 2046 6f72 2065 7861 6d70 6c65 2022  r. For example "
+00054a00: 3230 3030 2d30 332d 3031 2031 323a 3030  2000-03-01 12:00
+00054a10: 2220 6973 0a20 2020 2020 2020 2032 3030  " is.        200
+00054a20: 302e 3136 3533 2069 6e20 6120 7374 616e  0.1653 in a stan
+00054a30: 6461 7264 2063 616c 656e 6461 7220 6f72  dard calendar or
+00054a40: 2032 3030 302e 3136 3330 3120 696e 2061   2000.16301 in a
+00054a50: 2060 226e 6f6c 6561 7022 6020 6361 6c65   `"noleap"` cale
+00054a60: 6e64 6172 2e0a 0a20 2020 2020 2020 2054  ndar...        T
+00054a70: 6869 7320 6d65 7468 6f64 2073 686f 756c  his method shoul
+00054a80: 6420 6f6e 6c79 2062 6520 7573 6564 2077  d only be used w
+00054a90: 6865 6e20 7468 6520 7469 6d65 2028 4848  hen the time (HH
+00054aa0: 3a4d 4d3a 5353 2920 696e 666f 726d 6174  :MM:SS) informat
+00054ab0: 696f 6e20 6f66 0a20 2020 2020 2020 2074  ion of.        t
+00054ac0: 696d 6520 636f 6f72 6469 6e61 7465 2069  ime coordinate i
+00054ad0: 7320 6e6f 7420 696d 706f 7274 616e 742e  s not important.
+00054ae0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00054af0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00054b00: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00054b10: 7461 7267 6574 3a20 4461 7461 4172 7261  target: DataArra
+00054b20: 7920 6f72 2044 6174 6574 696d 6549 6e64  y or DatetimeInd
+00054b30: 6578 206f 7220 4346 5469 6d65 496e 6465  ex or CFTimeInde
+00054b40: 780a 2020 2020 2020 2020 2020 2020 5468  x.            Th
+00054b50: 6520 7461 7267 6574 2074 696d 6520 636f  e target time co
+00054b60: 6f72 6469 6e61 7465 206f 6620 6120 7661  ordinate of a va
+00054b70: 6c69 6420 6474 7970 650a 2020 2020 2020  lid dtype.      
+00054b80: 2020 2020 2020 286e 702e 6461 7465 7469        (np.dateti
+00054b90: 6d65 3634 206f 7220 6366 7469 6d65 206f  me64 or cftime o
+00054ba0: 626a 6563 7473 290a 2020 2020 2020 2020  bjects).        
+00054bb0: 6469 6d20 3a20 4861 7368 6162 6c65 2c20  dim : Hashable, 
+00054bc0: 6465 6661 756c 743a 2022 7469 6d65 220a  default: "time".
+00054bd0: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00054be0: 7469 6d65 2063 6f6f 7264 696e 6174 6520  time coordinate 
+00054bf0: 6e61 6d65 2e0a 0a20 2020 2020 2020 2052  name...        R
+00054c00: 6574 7572 6e0a 2020 2020 2020 2020 2d2d  eturn.        --
+00054c10: 2d2d 2d2d 0a20 2020 2020 2020 2044 6174  ----.        Dat
+00054c20: 6141 7272 6179 0a20 2020 2020 2020 2020  aArray.         
+00054c30: 2020 2054 6865 2073 6f75 7263 6520 696e     The source in
+00054c40: 7465 7270 6f6c 6174 6564 206f 6e20 7468  terpolated on th
+00054c50: 6520 6465 6369 6d61 6c20 7965 6172 7320  e decimal years 
+00054c60: 6f66 2074 6172 6765 742c 0a20 2020 2020  of target,.     
+00054c70: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00054c80: 6574 7572 6e20 696e 7465 7270 5f63 616c  eturn interp_cal
+00054c90: 656e 6461 7228 7365 6c66 2c20 7461 7267  endar(self, targ
+00054ca0: 6574 2c20 6469 6d3d 6469 6d29 0a0a 2020  et, dim=dim)..  
+00054cb0: 2020 6465 6620 6772 6f75 7062 7928 0a20    def groupby(. 
+00054cc0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00054cd0: 2020 2020 2067 726f 7570 3a20 4861 7368       group: Hash
+00054ce0: 6162 6c65 207c 2044 6174 6141 7272 6179  able | DataArray
+00054cf0: 207c 2049 6e64 6578 5661 7269 6162 6c65   | IndexVariable
+00054d00: 2c0a 2020 2020 2020 2020 7371 7565 657a  ,.        squeez
+00054d10: 653a 2062 6f6f 6c20 3d20 5472 7565 2c0a  e: bool = True,.
+00054d20: 2020 2020 2020 2020 7265 7374 6f72 655f          restore_
+00054d30: 636f 6f72 645f 6469 6d73 3a20 626f 6f6c  coord_dims: bool
+00054d40: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
+00054d50: 2d3e 2044 6174 6173 6574 4772 6f75 7042  -> DatasetGroupB
+00054d60: 793a 0a20 2020 2020 2020 2022 2222 5265  y:.        """Re
+00054d70: 7475 726e 7320 6120 4461 7461 7365 7447  turns a DatasetG
+00054d80: 726f 7570 4279 206f 626a 6563 7420 666f  roupBy object fo
+00054d90: 7220 7065 7266 6f72 6d69 6e67 2067 726f  r performing gro
+00054da0: 7570 6564 206f 7065 7261 7469 6f6e 732e  uped operations.
+00054db0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00054dc0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00054dd0: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00054de0: 6772 6f75 7020 3a20 4861 7368 6162 6c65  group : Hashable
+00054df0: 2c20 4461 7461 4172 7261 7920 6f72 2049  , DataArray or I
+00054e00: 6e64 6578 5661 7269 6162 6c65 0a20 2020  ndexVariable.   
+00054e10: 2020 2020 2020 2020 2041 7272 6179 2077           Array w
+00054e20: 686f 7365 2075 6e69 7175 6520 7661 6c75  hose unique valu
+00054e30: 6573 2073 686f 756c 6420 6265 2075 7365  es should be use
+00054e40: 6420 746f 2067 726f 7570 2074 6869 7320  d to group this 
+00054e50: 6172 7261 792e 2049 6620 610a 2020 2020  array. If a.    
+00054e60: 2020 2020 2020 2020 7374 7269 6e67 2c20          string, 
+00054e70: 6d75 7374 2062 6520 7468 6520 6e61 6d65  must be the name
+00054e80: 206f 6620 6120 7661 7269 6162 6c65 2063   of a variable c
+00054e90: 6f6e 7461 696e 6564 2069 6e20 7468 6973  ontained in this
+00054ea0: 2064 6174 6173 6574 2e0a 2020 2020 2020   dataset..      
+00054eb0: 2020 7371 7565 657a 6520 3a20 626f 6f6c    squeeze : bool
+00054ec0: 2c20 6465 6661 756c 743a 2054 7275 650a  , default: True.
+00054ed0: 2020 2020 2020 2020 2020 2020 4966 2022              If "
+00054ee0: 6772 6f75 7022 2069 7320 6120 6469 6d65  group" is a dime
+00054ef0: 6e73 696f 6e20 6f66 2061 6e79 2061 7272  nsion of any arr
+00054f00: 6179 7320 696e 2074 6869 7320 6461 7461  ays in this data
+00054f10: 7365 742c 2060 7371 7565 657a 6560 0a20  set, `squeeze`. 
+00054f20: 2020 2020 2020 2020 2020 2063 6f6e 7472             contr
+00054f30: 6f6c 7320 7768 6574 6865 7220 7468 6520  ols whether the 
+00054f40: 7375 6261 7272 6179 7320 6861 7665 2061  subarrays have a
+00054f50: 2064 696d 656e 7369 6f6e 206f 6620 6c65   dimension of le
+00054f60: 6e67 7468 2031 2061 6c6f 6e67 0a20 2020  ngth 1 along.   
+00054f70: 2020 2020 2020 2020 2074 6861 7420 6469           that di
+00054f80: 6d65 6e73 696f 6e20 6f72 2069 6620 7468  mension or if th
+00054f90: 6520 6469 6d65 6e73 696f 6e20 6973 2073  e dimension is s
+00054fa0: 7175 6565 7a65 6420 6f75 742e 0a20 2020  queezed out..   
+00054fb0: 2020 2020 2072 6573 746f 7265 5f63 6f6f       restore_coo
+00054fc0: 7264 5f64 696d 7320 3a20 626f 6f6c 2c20  rd_dims : bool, 
+00054fd0: 6465 6661 756c 743a 2046 616c 7365 0a20  default: False. 
+00054fe0: 2020 2020 2020 2020 2020 2049 6620 5472             If Tr
+00054ff0: 7565 2c20 616c 736f 2072 6573 746f 7265  ue, also restore
+00055000: 2074 6865 2064 696d 656e 7369 6f6e 206f   the dimension o
+00055010: 7264 6572 206f 6620 6d75 6c74 692d 6469  rder of multi-di
+00055020: 6d65 6e73 696f 6e61 6c0a 2020 2020 2020  mensional.      
+00055030: 2020 2020 2020 636f 6f72 6469 6e61 7465        coordinate
+00055040: 732e 0a0a 2020 2020 2020 2020 5265 7475  s...        Retu
+00055050: 726e 730a 2020 2020 2020 2020 2d2d 2d2d  rns.        ----
+00055060: 2d2d 2d0a 2020 2020 2020 2020 6772 6f75  ---.        grou
+00055070: 7065 6420 3a20 4461 7461 7365 7447 726f  ped : DatasetGro
+00055080: 7570 4279 0a20 2020 2020 2020 2020 2020  upBy.           
+00055090: 2041 2060 4461 7461 7365 7447 726f 7570   A `DatasetGroup
+000550a0: 4279 6020 6f62 6a65 6374 2070 6174 7465  By` object patte
+000550b0: 726e 6564 2061 6674 6572 2060 7061 6e64  rned after `pand
+000550c0: 6173 2e47 726f 7570 4279 6020 7468 6174  as.GroupBy` that
+000550d0: 2063 616e 2062 650a 2020 2020 2020 2020   can be.        
+000550e0: 2020 2020 6974 6572 6174 6564 206f 7665      iterated ove
+000550f0: 7220 696e 2074 6865 2066 6f72 6d20 6f66  r in the form of
+00055100: 2060 2875 6e69 7175 655f 7661 6c75 652c   `(unique_value,
+00055110: 2067 726f 7570 6564 5f61 7272 6179 2960   grouped_array)`
+00055120: 2070 6169 7273 2e0a 0a20 2020 2020 2020   pairs...       
+00055130: 2053 6565 2041 6c73 6f0a 2020 2020 2020   See Also.      
+00055140: 2020 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020    --------.     
+00055150: 2020 203a 7265 663a 6067 726f 7570 6279     :ref:`groupby
+00055160: 600a 2020 2020 2020 2020 2020 2020 5573  `.            Us
+00055170: 6572 7320 6775 6964 6520 6578 706c 616e  ers guide explan
+00055180: 6174 696f 6e20 6f66 2068 6f77 2074 6f20  ation of how to 
+00055190: 6772 6f75 7020 616e 6420 6269 6e20 6461  group and bin da
+000551a0: 7461 2e0a 2020 2020 2020 2020 4461 7461  ta..        Data
+000551b0: 7365 742e 6772 6f75 7062 795f 6269 6e73  set.groupby_bins
+000551c0: 0a20 2020 2020 2020 2044 6174 6141 7272  .        DataArr
+000551d0: 6179 2e67 726f 7570 6279 0a20 2020 2020  ay.groupby.     
+000551e0: 2020 2063 6f72 652e 6772 6f75 7062 792e     core.groupby.
+000551f0: 4461 7461 7365 7447 726f 7570 4279 0a20  DatasetGroupBy. 
+00055200: 2020 2020 2020 2070 616e 6461 732e 4461         pandas.Da
+00055210: 7461 4672 616d 652e 6772 6f75 7062 790a  taFrame.groupby.
+00055220: 2020 2020 2020 2020 4461 7461 7365 742e          Dataset.
+00055230: 7265 7361 6d70 6c65 0a20 2020 2020 2020  resample.       
+00055240: 2044 6174 6141 7272 6179 2e72 6573 616d   DataArray.resam
+00055250: 706c 650a 2020 2020 2020 2020 2222 220a  ple.        """.
+00055260: 2020 2020 2020 2020 6672 6f6d 2078 6172          from xar
+00055270: 7261 792e 636f 7265 2e67 726f 7570 6279  ray.core.groupby
+00055280: 2069 6d70 6f72 7420 280a 2020 2020 2020   import (.      
+00055290: 2020 2020 2020 4461 7461 7365 7447 726f        DatasetGro
+000552a0: 7570 4279 2c0a 2020 2020 2020 2020 2020  upBy,.          
+000552b0: 2020 5265 736f 6c76 6564 556e 6971 7565    ResolvedUnique
+000552c0: 4772 6f75 7065 722c 0a20 2020 2020 2020  Grouper,.       
+000552d0: 2020 2020 2055 6e69 7175 6547 726f 7570       UniqueGroup
+000552e0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+000552f0: 5f76 616c 6964 6174 655f 6772 6f75 7062  _validate_groupb
+00055300: 795f 7371 7565 657a 652c 0a20 2020 2020  y_squeeze,.     
+00055310: 2020 2029 0a0a 2020 2020 2020 2020 5f76     )..        _v
+00055320: 616c 6964 6174 655f 6772 6f75 7062 795f  alidate_groupby_
+00055330: 7371 7565 657a 6528 7371 7565 657a 6529  squeeze(squeeze)
+00055340: 0a20 2020 2020 2020 2072 6772 6f75 7065  .        rgroupe
+00055350: 7220 3d20 5265 736f 6c76 6564 556e 6971  r = ResolvedUniq
+00055360: 7565 4772 6f75 7065 7228 556e 6971 7565  ueGrouper(Unique
+00055370: 4772 6f75 7065 7228 292c 2067 726f 7570  Grouper(), group
+00055380: 2c20 7365 6c66 290a 0a20 2020 2020 2020  , self)..       
+00055390: 2072 6574 7572 6e20 4461 7461 7365 7447   return DatasetG
+000553a0: 726f 7570 4279 280a 2020 2020 2020 2020  roupBy(.        
+000553b0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+000553c0: 2020 2020 2020 2872 6772 6f75 7065 722c        (rgrouper,
+000553d0: 292c 0a20 2020 2020 2020 2020 2020 2073  ),.            s
+000553e0: 7175 6565 7a65 3d73 7175 6565 7a65 2c0a  queeze=squeeze,.
+000553f0: 2020 2020 2020 2020 2020 2020 7265 7374              rest
+00055400: 6f72 655f 636f 6f72 645f 6469 6d73 3d72  ore_coord_dims=r
+00055410: 6573 746f 7265 5f63 6f6f 7264 5f64 696d  estore_coord_dim
+00055420: 732c 0a20 2020 2020 2020 2029 0a0a 2020  s,.        )..  
+00055430: 2020 6465 6620 6772 6f75 7062 795f 6269    def groupby_bi
+00055440: 6e73 280a 2020 2020 2020 2020 7365 6c66  ns(.        self
+00055450: 2c0a 2020 2020 2020 2020 6772 6f75 703a  ,.        group:
+00055460: 2048 6173 6861 626c 6520 7c20 4461 7461   Hashable | Data
+00055470: 4172 7261 7920 7c20 496e 6465 7856 6172  Array | IndexVar
+00055480: 6961 626c 652c 0a20 2020 2020 2020 2062  iable,.        b
+00055490: 696e 733a 2041 7272 6179 4c69 6b65 2c0a  ins: ArrayLike,.
+000554a0: 2020 2020 2020 2020 7269 6768 743a 2062          right: b
+000554b0: 6f6f 6c20 3d20 5472 7565 2c0a 2020 2020  ool = True,.    
+000554c0: 2020 2020 6c61 6265 6c73 3a20 4172 7261      labels: Arra
+000554d0: 794c 696b 6520 7c20 4e6f 6e65 203d 204e  yLike | None = N
+000554e0: 6f6e 652c 0a20 2020 2020 2020 2070 7265  one,.        pre
+000554f0: 6369 7369 6f6e 3a20 696e 7420 3d20 332c  cision: int = 3,
+00055500: 0a20 2020 2020 2020 2069 6e63 6c75 6465  .        include
+00055510: 5f6c 6f77 6573 743a 2062 6f6f 6c20 3d20  _lowest: bool = 
+00055520: 4661 6c73 652c 0a20 2020 2020 2020 2073  False,.        s
+00055530: 7175 6565 7a65 3a20 626f 6f6c 203d 2054  queeze: bool = T
+00055540: 7275 652c 0a20 2020 2020 2020 2072 6573  rue,.        res
+00055550: 746f 7265 5f63 6f6f 7264 5f64 696d 733a  tore_coord_dims:
+00055560: 2062 6f6f 6c20 3d20 4661 6c73 652c 0a20   bool = False,. 
+00055570: 2020 2029 202d 3e20 4461 7461 7365 7447     ) -> DatasetG
+00055580: 726f 7570 4279 3a0a 2020 2020 2020 2020  roupBy:.        
+00055590: 2222 2252 6574 7572 6e73 2061 2044 6174  """Returns a Dat
+000555a0: 6173 6574 4772 6f75 7042 7920 6f62 6a65  asetGroupBy obje
+000555b0: 6374 2066 6f72 2070 6572 666f 726d 696e  ct for performin
+000555c0: 6720 6772 6f75 7065 6420 6f70 6572 6174  g grouped operat
+000555d0: 696f 6e73 2e0a 0a20 2020 2020 2020 2052  ions...        R
+000555e0: 6174 6865 7220 7468 616e 2075 7369 6e67  ather than using
+000555f0: 2061 6c6c 2075 6e69 7175 6520 7661 6c75   all unique valu
+00055600: 6573 206f 6620 6067 726f 7570 602c 2074  es of `group`, t
+00055610: 6865 2076 616c 7565 7320 6172 6520 6469  he values are di
+00055620: 7363 7265 7469 7a65 640a 2020 2020 2020  scretized.      
+00055630: 2020 6669 7273 7420 6279 2061 7070 6c79    first by apply
+00055640: 696e 6720 6070 616e 6461 732e 6375 7460  ing `pandas.cut`
+00055650: 205b 315d 5f20 746f 2060 6772 6f75 7060   [1]_ to `group`
+00055660: 2e0a 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+00055670: 6574 6572 730a 2020 2020 2020 2020 2d2d  eters.        --
+00055680: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00055690: 2067 726f 7570 203a 2048 6173 6861 626c   group : Hashabl
+000556a0: 652c 2044 6174 6141 7272 6179 206f 7220  e, DataArray or 
+000556b0: 496e 6465 7856 6172 6961 626c 650a 2020  IndexVariable.  
+000556c0: 2020 2020 2020 2020 2020 4172 7261 7920            Array 
+000556d0: 7768 6f73 6520 6269 6e6e 6564 2076 616c  whose binned val
+000556e0: 7565 7320 7368 6f75 6c64 2062 6520 7573  ues should be us
+000556f0: 6564 2074 6f20 6772 6f75 7020 7468 6973  ed to group this
+00055700: 2061 7272 6179 2e20 4966 2061 0a20 2020   array. If a.   
+00055710: 2020 2020 2020 2020 2073 7472 696e 672c           string,
+00055720: 206d 7573 7420 6265 2074 6865 206e 616d   must be the nam
+00055730: 6520 6f66 2061 2076 6172 6961 626c 6520  e of a variable 
+00055740: 636f 6e74 6169 6e65 6420 696e 2074 6869  contained in thi
+00055750: 7320 6461 7461 7365 742e 0a20 2020 2020  s dataset..     
+00055760: 2020 2062 696e 7320 3a20 696e 7420 6f72     bins : int or
+00055770: 2061 7272 6179 2d6c 696b 650a 2020 2020   array-like.    
+00055780: 2020 2020 2020 2020 4966 2062 696e 7320          If bins 
+00055790: 6973 2061 6e20 696e 742c 2069 7420 6465  is an int, it de
+000557a0: 6669 6e65 7320 7468 6520 6e75 6d62 6572  fines the number
+000557b0: 206f 6620 6571 7561 6c2d 7769 6474 6820   of equal-width 
+000557c0: 6269 6e73 2069 6e20 7468 650a 2020 2020  bins in the.    
+000557d0: 2020 2020 2020 2020 7261 6e67 6520 6f66          range of
+000557e0: 2078 2e20 486f 7765 7665 722c 2069 6e20   x. However, in 
+000557f0: 7468 6973 2063 6173 652c 2074 6865 2072  this case, the r
+00055800: 616e 6765 206f 6620 7820 6973 2065 7874  ange of x is ext
+00055810: 656e 6465 6420 6279 202e 3125 0a20 2020  ended by .1%.   
+00055820: 2020 2020 2020 2020 206f 6e20 6561 6368           on each
+00055830: 2073 6964 6520 746f 2069 6e63 6c75 6465   side to include
+00055840: 2074 6865 206d 696e 206f 7220 6d61 7820   the min or max 
+00055850: 7661 6c75 6573 206f 6620 782e 2049 6620  values of x. If 
+00055860: 6269 6e73 2069 7320 610a 2020 2020 2020  bins is a.      
+00055870: 2020 2020 2020 7365 7175 656e 6365 2069        sequence i
+00055880: 7420 6465 6669 6e65 7320 7468 6520 6269  t defines the bi
+00055890: 6e20 6564 6765 7320 616c 6c6f 7769 6e67  n edges allowing
+000558a0: 2066 6f72 206e 6f6e 2d75 6e69 666f 726d   for non-uniform
+000558b0: 2062 696e 0a20 2020 2020 2020 2020 2020   bin.           
+000558c0: 2077 6964 7468 2e20 4e6f 2065 7874 656e   width. No exten
+000558d0: 7369 6f6e 206f 6620 7468 6520 7261 6e67  sion of the rang
+000558e0: 6520 6f66 2078 2069 7320 646f 6e65 2069  e of x is done i
+000558f0: 6e20 7468 6973 2063 6173 652e 0a20 2020  n this case..   
+00055900: 2020 2020 2072 6967 6874 203a 2062 6f6f       right : boo
+00055910: 6c2c 2064 6566 6175 6c74 3a20 5472 7565  l, default: True
+00055920: 0a20 2020 2020 2020 2020 2020 2049 6e64  .            Ind
+00055930: 6963 6174 6573 2077 6865 7468 6572 2074  icates whether t
+00055940: 6865 2062 696e 7320 696e 636c 7564 6520  he bins include 
+00055950: 7468 6520 7269 6768 746d 6f73 7420 6564  the rightmost ed
+00055960: 6765 206f 7220 6e6f 742e 2049 660a 2020  ge or not. If.  
+00055970: 2020 2020 2020 2020 2020 7269 6768 7420            right 
+00055980: 3d3d 2054 7275 6520 2874 6865 2064 6566  == True (the def
+00055990: 6175 6c74 292c 2074 6865 6e20 7468 6520  ault), then the 
+000559a0: 6269 6e73 205b 312c 322c 332c 345d 2069  bins [1,2,3,4] i
+000559b0: 6e64 6963 6174 650a 2020 2020 2020 2020  ndicate.        
+000559c0: 2020 2020 2831 2c32 5d2c 2028 322c 335d      (1,2], (2,3]
+000559d0: 2c20 2833 2c34 5d2e 0a20 2020 2020 2020  , (3,4]..       
+000559e0: 206c 6162 656c 7320 3a20 6172 7261 792d   labels : array-
+000559f0: 6c69 6b65 206f 7220 626f 6f6c 2c20 6465  like or bool, de
+00055a00: 6661 756c 743a 204e 6f6e 650a 2020 2020  fault: None.    
+00055a10: 2020 2020 2020 2020 5573 6564 2061 7320          Used as 
+00055a20: 6c61 6265 6c73 2066 6f72 2074 6865 2072  labels for the r
+00055a30: 6573 756c 7469 6e67 2062 696e 732e 204d  esulting bins. M
+00055a40: 7573 7420 6265 206f 6620 7468 6520 7361  ust be of the sa
+00055a50: 6d65 206c 656e 6774 6820 6173 0a20 2020  me length as.   
+00055a60: 2020 2020 2020 2020 2074 6865 2072 6573           the res
+00055a70: 756c 7469 6e67 2062 696e 732e 2049 6620  ulting bins. If 
+00055a80: 4661 6c73 652c 2073 7472 696e 6720 6269  False, string bi
+00055a90: 6e20 6c61 6265 6c73 2061 7265 2061 7373  n labels are ass
+00055aa0: 6967 6e65 6420 6279 0a20 2020 2020 2020  igned by.       
+00055ab0: 2020 2020 2060 7061 6e64 6173 2e63 7574       `pandas.cut
+00055ac0: 602e 0a20 2020 2020 2020 2070 7265 6369  `..        preci
+00055ad0: 7369 6f6e 203a 2069 6e74 2c20 6465 6661  sion : int, defa
+00055ae0: 756c 743a 2033 0a20 2020 2020 2020 2020  ult: 3.         
+00055af0: 2020 2054 6865 2070 7265 6369 7369 6f6e     The precision
+00055b00: 2061 7420 7768 6963 6820 746f 2073 746f   at which to sto
+00055b10: 7265 2061 6e64 2064 6973 706c 6179 2074  re and display t
+00055b20: 6865 2062 696e 7320 6c61 6265 6c73 2e0a  he bins labels..
+00055b30: 2020 2020 2020 2020 696e 636c 7564 655f          include_
+00055b40: 6c6f 7765 7374 203a 2062 6f6f 6c2c 2064  lowest : bool, d
+00055b50: 6566 6175 6c74 3a20 4661 6c73 650a 2020  efault: False.  
+00055b60: 2020 2020 2020 2020 2020 5768 6574 6865            Whethe
+00055b70: 7220 7468 6520 6669 7273 7420 696e 7465  r the first inte
+00055b80: 7276 616c 2073 686f 756c 6420 6265 206c  rval should be l
+00055b90: 6566 742d 696e 636c 7573 6976 6520 6f72  eft-inclusive or
+00055ba0: 206e 6f74 2e0a 2020 2020 2020 2020 7371   not..        sq
+00055bb0: 7565 657a 6520 3a20 626f 6f6c 2c20 6465  ueeze : bool, de
+00055bc0: 6661 756c 743a 2054 7275 650a 2020 2020  fault: True.    
+00055bd0: 2020 2020 2020 2020 4966 2022 6772 6f75          If "grou
+00055be0: 7022 2069 7320 6120 6469 6d65 6e73 696f  p" is a dimensio
+00055bf0: 6e20 6f66 2061 6e79 2061 7272 6179 7320  n of any arrays 
+00055c00: 696e 2074 6869 7320 6461 7461 7365 742c  in this dataset,
+00055c10: 2060 7371 7565 657a 6560 0a20 2020 2020   `squeeze`.     
+00055c20: 2020 2020 2020 2063 6f6e 7472 6f6c 7320         controls 
+00055c30: 7768 6574 6865 7220 7468 6520 7375 6261  whether the suba
+00055c40: 7272 6179 7320 6861 7665 2061 2064 696d  rrays have a dim
+00055c50: 656e 7369 6f6e 206f 6620 6c65 6e67 7468  ension of length
+00055c60: 2031 2061 6c6f 6e67 0a20 2020 2020 2020   1 along.       
+00055c70: 2020 2020 2074 6861 7420 6469 6d65 6e73       that dimens
+00055c80: 696f 6e20 6f72 2069 6620 7468 6520 6469  ion or if the di
+00055c90: 6d65 6e73 696f 6e20 6973 2073 7175 6565  mension is squee
+00055ca0: 7a65 6420 6f75 742e 0a20 2020 2020 2020  zed out..       
+00055cb0: 2072 6573 746f 7265 5f63 6f6f 7264 5f64   restore_coord_d
+00055cc0: 696d 7320 3a20 626f 6f6c 2c20 6465 6661  ims : bool, defa
+00055cd0: 756c 743a 2046 616c 7365 0a20 2020 2020  ult: False.     
+00055ce0: 2020 2020 2020 2049 6620 5472 7565 2c20         If True, 
+00055cf0: 616c 736f 2072 6573 746f 7265 2074 6865  also restore the
+00055d00: 2064 696d 656e 7369 6f6e 206f 7264 6572   dimension order
+00055d10: 206f 6620 6d75 6c74 692d 6469 6d65 6e73   of multi-dimens
+00055d20: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00055d30: 2020 636f 6f72 6469 6e61 7465 732e 0a0a    coordinates...
+00055d40: 2020 2020 2020 2020 5265 7475 726e 730a          Returns.
+00055d50: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0a          -------.
+00055d60: 2020 2020 2020 2020 6772 6f75 7065 6420          grouped 
+00055d70: 3a20 4461 7461 7365 7447 726f 7570 4279  : DatasetGroupBy
+00055d80: 0a20 2020 2020 2020 2020 2020 2041 2060  .            A `
+00055d90: 4461 7461 7365 7447 726f 7570 4279 6020  DatasetGroupBy` 
+00055da0: 6f62 6a65 6374 2070 6174 7465 726e 6564  object patterned
+00055db0: 2061 6674 6572 2060 7061 6e64 6173 2e47   after `pandas.G
+00055dc0: 726f 7570 4279 6020 7468 6174 2063 616e  roupBy` that can
+00055dd0: 2062 650a 2020 2020 2020 2020 2020 2020   be.            
+00055de0: 6974 6572 6174 6564 206f 7665 7220 696e  iterated over in
+00055df0: 2074 6865 2066 6f72 6d20 6f66 2060 2875   the form of `(u
+00055e00: 6e69 7175 655f 7661 6c75 652c 2067 726f  nique_value, gro
+00055e10: 7570 6564 5f61 7272 6179 2960 2070 6169  uped_array)` pai
+00055e20: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+00055e30: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
+00055e40: 6772 6f75 7020 6861 7320 7468 6520 6164  group has the ad
+00055e50: 6465 6420 7375 6666 6978 2060 5f62 696e  ded suffix `_bin
+00055e60: 7360 2069 6e20 6f72 6465 7220 746f 0a20  s` in order to. 
+00055e70: 2020 2020 2020 2020 2020 2064 6973 7469             disti
+00055e80: 6e67 7569 7368 2069 7420 6672 6f6d 2074  nguish it from t
+00055e90: 6865 206f 7269 6769 6e61 6c20 7661 7269  he original vari
+00055ea0: 6162 6c65 2e0a 0a20 2020 2020 2020 2053  able...        S
+00055eb0: 6565 2041 6c73 6f0a 2020 2020 2020 2020  ee Also.        
+00055ec0: 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020 2020  --------.       
+00055ed0: 203a 7265 663a 6067 726f 7570 6279 600a   :ref:`groupby`.
+00055ee0: 2020 2020 2020 2020 2020 2020 5573 6572              User
+00055ef0: 7320 6775 6964 6520 6578 706c 616e 6174  s guide explanat
+00055f00: 696f 6e20 6f66 2068 6f77 2074 6f20 6772  ion of how to gr
+00055f10: 6f75 7020 616e 6420 6269 6e20 6461 7461  oup and bin data
+00055f20: 2e0a 2020 2020 2020 2020 4461 7461 7365  ..        Datase
+00055f30: 742e 6772 6f75 7062 790a 2020 2020 2020  t.groupby.      
+00055f40: 2020 4461 7461 4172 7261 792e 6772 6f75    DataArray.grou
+00055f50: 7062 795f 6269 6e73 0a20 2020 2020 2020  pby_bins.       
+00055f60: 2063 6f72 652e 6772 6f75 7062 792e 4461   core.groupby.Da
+00055f70: 7461 7365 7447 726f 7570 4279 0a20 2020  tasetGroupBy.   
+00055f80: 2020 2020 2070 616e 6461 732e 4461 7461       pandas.Data
+00055f90: 4672 616d 652e 6772 6f75 7062 790a 0a20  Frame.groupby.. 
+00055fa0: 2020 2020 2020 2052 6566 6572 656e 6365         Reference
+00055fb0: 730a 2020 2020 2020 2020 2d2d 2d2d 2d2d  s.        ------
+00055fc0: 2d2d 2d2d 0a20 2020 2020 2020 202e 2e20  ----.        .. 
+00055fd0: 5b31 5d20 6874 7470 3a2f 2f70 616e 6461  [1] http://panda
+00055fe0: 732e 7079 6461 7461 2e6f 7267 2f70 616e  s.pydata.org/pan
+00055ff0: 6461 732d 646f 6373 2f73 7461 626c 652f  das-docs/stable/
+00056000: 6765 6e65 7261 7465 642f 7061 6e64 6173  generated/pandas
+00056010: 2e63 7574 2e68 746d 6c0a 2020 2020 2020  .cut.html.      
+00056020: 2020 2222 220a 2020 2020 2020 2020 6672    """.        fr
+00056030: 6f6d 2078 6172 7261 792e 636f 7265 2e67  om xarray.core.g
+00056040: 726f 7570 6279 2069 6d70 6f72 7420 280a  roupby import (.
+00056050: 2020 2020 2020 2020 2020 2020 4269 6e47              BinG
+00056060: 726f 7570 6572 2c0a 2020 2020 2020 2020  rouper,.        
+00056070: 2020 2020 4461 7461 7365 7447 726f 7570      DatasetGroup
+00056080: 4279 2c0a 2020 2020 2020 2020 2020 2020  By,.            
+00056090: 5265 736f 6c76 6564 4269 6e47 726f 7570  ResolvedBinGroup
+000560a0: 6572 2c0a 2020 2020 2020 2020 2020 2020  er,.            
+000560b0: 5f76 616c 6964 6174 655f 6772 6f75 7062  _validate_groupb
+000560c0: 795f 7371 7565 657a 652c 0a20 2020 2020  y_squeeze,.     
+000560d0: 2020 2029 0a0a 2020 2020 2020 2020 5f76     )..        _v
+000560e0: 616c 6964 6174 655f 6772 6f75 7062 795f  alidate_groupby_
+000560f0: 7371 7565 657a 6528 7371 7565 657a 6529  squeeze(squeeze)
+00056100: 0a20 2020 2020 2020 2067 726f 7570 6572  .        grouper
+00056110: 203d 2042 696e 4772 6f75 7065 7228 0a20   = BinGrouper(. 
+00056120: 2020 2020 2020 2020 2020 2062 696e 733d             bins=
+00056130: 6269 6e73 2c0a 2020 2020 2020 2020 2020  bins,.          
+00056140: 2020 6375 745f 6b77 6172 6773 3d7b 0a20    cut_kwargs={. 
+00056150: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00056160: 7269 6768 7422 3a20 7269 6768 742c 0a20  right": right,. 
+00056170: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00056180: 6c61 6265 6c73 223a 206c 6162 656c 732c  labels": labels,
+00056190: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000561a0: 2022 7072 6563 6973 696f 6e22 3a20 7072   "precision": pr
+000561b0: 6563 6973 696f 6e2c 0a20 2020 2020 2020  ecision,.       
+000561c0: 2020 2020 2020 2020 2022 696e 636c 7564           "includ
+000561d0: 655f 6c6f 7765 7374 223a 2069 6e63 6c75  e_lowest": inclu
+000561e0: 6465 5f6c 6f77 6573 742c 0a20 2020 2020  de_lowest,.     
+000561f0: 2020 2020 2020 207d 2c0a 2020 2020 2020         },.      
+00056200: 2020 290a 2020 2020 2020 2020 7267 726f    ).        rgro
+00056210: 7570 6572 203d 2052 6573 6f6c 7665 6442  uper = ResolvedB
+00056220: 696e 4772 6f75 7065 7228 6772 6f75 7065  inGrouper(groupe
+00056230: 722c 2067 726f 7570 2c20 7365 6c66 290a  r, group, self).
+00056240: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00056250: 4461 7461 7365 7447 726f 7570 4279 280a  DatasetGroupBy(.
+00056260: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00056270: 2c0a 2020 2020 2020 2020 2020 2020 2872  ,.            (r
+00056280: 6772 6f75 7065 722c 292c 0a20 2020 2020  grouper,),.     
+00056290: 2020 2020 2020 2073 7175 6565 7a65 3d73         squeeze=s
+000562a0: 7175 6565 7a65 2c0a 2020 2020 2020 2020  queeze,.        
+000562b0: 2020 2020 7265 7374 6f72 655f 636f 6f72      restore_coor
+000562c0: 645f 6469 6d73 3d72 6573 746f 7265 5f63  d_dims=restore_c
+000562d0: 6f6f 7264 5f64 696d 732c 0a20 2020 2020  oord_dims,.     
+000562e0: 2020 2029 0a0a 2020 2020 6465 6620 7765     )..    def we
+000562f0: 6967 6874 6564 2873 656c 662c 2077 6569  ighted(self, wei
+00056300: 6768 7473 3a20 4461 7461 4172 7261 7929  ghts: DataArray)
+00056310: 202d 3e20 4461 7461 7365 7457 6569 6768   -> DatasetWeigh
+00056320: 7465 643a 0a20 2020 2020 2020 2022 2222  ted:.        """
+00056330: 0a20 2020 2020 2020 2057 6569 6768 7465  .        Weighte
+00056340: 6420 4461 7461 7365 7420 6f70 6572 6174  d Dataset operat
+00056350: 696f 6e73 2e0a 0a20 2020 2020 2020 2050  ions...        P
+00056360: 6172 616d 6574 6572 730a 2020 2020 2020  arameters.      
+00056370: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020    ----------.   
+00056380: 2020 2020 2077 6569 6768 7473 203a 2044       weights : D
+00056390: 6174 6141 7272 6179 0a20 2020 2020 2020  ataArray.       
+000563a0: 2020 2020 2041 6e20 6172 7261 7920 6f66       An array of
+000563b0: 2077 6569 6768 7473 2061 7373 6f63 6961   weights associa
+000563c0: 7465 6420 7769 7468 2074 6865 2076 616c  ted with the val
+000563d0: 7565 7320 696e 2074 6869 7320 4461 7461  ues in this Data
+000563e0: 7365 742e 0a20 2020 2020 2020 2020 2020  set..           
+000563f0: 2045 6163 6820 7661 6c75 6520 696e 2074   Each value in t
+00056400: 6865 2064 6174 6120 636f 6e74 7269 6275  he data contribu
+00056410: 7465 7320 746f 2074 6865 2072 6564 7563  tes to the reduc
+00056420: 7469 6f6e 206f 7065 7261 7469 6f6e 0a20  tion operation. 
+00056430: 2020 2020 2020 2020 2020 2061 6363 6f72             accor
+00056440: 6469 6e67 2074 6f20 6974 7320 6173 736f  ding to its asso
+00056450: 6369 6174 6564 2077 6569 6768 742e 0a0a  ciated weight...
+00056460: 2020 2020 2020 2020 4e6f 7465 730a 2020          Notes.  
+00056470: 2020 2020 2020 2d2d 2d2d 2d0a 2020 2020        -----.    
+00056480: 2020 2020 6060 7765 6967 6874 7360 6020      ``weights`` 
+00056490: 6d75 7374 2062 6520 6120 4461 7461 4172  must be a DataAr
+000564a0: 7261 7920 616e 6420 6361 6e6e 6f74 2063  ray and cannot c
+000564b0: 6f6e 7461 696e 206d 6973 7369 6e67 2076  ontain missing v
+000564c0: 616c 7565 732e 0a20 2020 2020 2020 204d  alues..        M
+000564d0: 6973 7369 6e67 2076 616c 7565 7320 6361  issing values ca
+000564e0: 6e20 6265 2072 6570 6c61 6365 6420 6279  n be replaced by
+000564f0: 2060 6077 6569 6768 7473 2e66 696c 6c6e   ``weights.filln
+00056500: 6128 3029 6060 2e0a 0a20 2020 2020 2020  a(0)``...       
+00056510: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00056520: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00056530: 2063 6f72 652e 7765 6967 6874 6564 2e44   core.weighted.D
+00056540: 6174 6173 6574 5765 6967 6874 6564 0a0a  atasetWeighted..
+00056550: 2020 2020 2020 2020 5365 6520 416c 736f          See Also
+00056560: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00056570: 2d0a 2020 2020 2020 2020 4461 7461 4172  -.        DataAr
+00056580: 7261 792e 7765 6967 6874 6564 0a20 2020  ray.weighted.   
+00056590: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+000565a0: 2066 726f 6d20 7861 7272 6179 2e63 6f72   from xarray.cor
+000565b0: 652e 7765 6967 6874 6564 2069 6d70 6f72  e.weighted impor
+000565c0: 7420 4461 7461 7365 7457 6569 6768 7465  t DatasetWeighte
+000565d0: 640a 0a20 2020 2020 2020 2072 6574 7572  d..        retur
+000565e0: 6e20 4461 7461 7365 7457 6569 6768 7465  n DatasetWeighte
+000565f0: 6428 7365 6c66 2c20 7765 6967 6874 7329  d(self, weights)
+00056600: 0a0a 2020 2020 6465 6620 726f 6c6c 696e  ..    def rollin
+00056610: 6728 0a20 2020 2020 2020 2073 656c 662c  g(.        self,
+00056620: 0a20 2020 2020 2020 2064 696d 3a20 4d61  .        dim: Ma
+00056630: 7070 696e 675b 416e 792c 2069 6e74 5d20  pping[Any, int] 
+00056640: 7c20 4e6f 6e65 203d 204e 6f6e 652c 0a20  | None = None,. 
+00056650: 2020 2020 2020 206d 696e 5f70 6572 696f         min_perio
+00056660: 6473 3a20 696e 7420 7c20 4e6f 6e65 203d  ds: int | None =
+00056670: 204e 6f6e 652c 0a20 2020 2020 2020 2063   None,.        c
+00056680: 656e 7465 723a 2062 6f6f 6c20 7c20 4d61  enter: bool | Ma
+00056690: 7070 696e 675b 416e 792c 2062 6f6f 6c5d  pping[Any, bool]
+000566a0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+000566b0: 2020 2a2a 7769 6e64 6f77 5f6b 7761 7267    **window_kwarg
+000566c0: 733a 2069 6e74 2c0a 2020 2020 2920 2d3e  s: int,.    ) ->
+000566d0: 2044 6174 6173 6574 526f 6c6c 696e 673a   DatasetRolling:
+000566e0: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+000566f0: 2020 2020 2052 6f6c 6c69 6e67 2077 696e       Rolling win
+00056700: 646f 7720 6f62 6a65 6374 2066 6f72 2044  dow object for D
+00056710: 6174 6173 6574 732e 0a0a 2020 2020 2020  atasets...      
+00056720: 2020 5061 7261 6d65 7465 7273 0a20 2020    Parameters.   
+00056730: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0a       ----------.
+00056740: 2020 2020 2020 2020 6469 6d20 3a20 6469          dim : di
+00056750: 6374 2c20 6f70 7469 6f6e 616c 0a20 2020  ct, optional.   
+00056760: 2020 2020 2020 2020 204d 6170 7069 6e67           Mapping
+00056770: 2066 726f 6d20 7468 6520 6469 6d65 6e73   from the dimens
+00056780: 696f 6e20 6e61 6d65 2074 6f20 6372 6561  ion name to crea
+00056790: 7465 2074 6865 2072 6f6c 6c69 6e67 2069  te the rolling i
+000567a0: 7465 7261 746f 720a 2020 2020 2020 2020  terator.        
+000567b0: 2020 2020 616c 6f6e 6720 2865 2e67 2e20      along (e.g. 
+000567c0: 6074 696d 6560 2920 746f 2069 7473 206d  `time`) to its m
+000567d0: 6f76 696e 6720 7769 6e64 6f77 2073 697a  oving window siz
+000567e0: 652e 0a20 2020 2020 2020 206d 696e 5f70  e..        min_p
+000567f0: 6572 696f 6473 203a 2069 6e74 206f 7220  eriods : int or 
+00056800: 4e6f 6e65 2c20 6465 6661 756c 743a 204e  None, default: N
+00056810: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00056820: 4d69 6e69 6d75 6d20 6e75 6d62 6572 206f  Minimum number o
+00056830: 6620 6f62 7365 7276 6174 696f 6e73 2069  f observations i
+00056840: 6e20 7769 6e64 6f77 2072 6571 7569 7265  n window require
+00056850: 6420 746f 2068 6176 6520 6120 7661 6c75  d to have a valu
+00056860: 650a 2020 2020 2020 2020 2020 2020 286f  e.            (o
+00056870: 7468 6572 7769 7365 2072 6573 756c 7420  therwise result 
+00056880: 6973 204e 4129 2e20 5468 6520 6465 6661  is NA). The defa
+00056890: 756c 742c 204e 6f6e 652c 2069 7320 6571  ult, None, is eq
+000568a0: 7569 7661 6c65 6e74 2074 6f0a 2020 2020  uivalent to.    
+000568b0: 2020 2020 2020 2020 7365 7474 696e 6720          setting 
+000568c0: 6d69 6e5f 7065 7269 6f64 7320 6571 7561  min_periods equa
+000568d0: 6c20 746f 2074 6865 2073 697a 6520 6f66  l to the size of
+000568e0: 2074 6865 2077 696e 646f 772e 0a20 2020   the window..   
+000568f0: 2020 2020 2063 656e 7465 7220 3a20 626f       center : bo
+00056900: 6f6c 206f 7220 4d61 7070 696e 6720 746f  ol or Mapping to
+00056910: 2069 6e74 2c20 6465 6661 756c 743a 2046   int, default: F
+00056920: 616c 7365 0a20 2020 2020 2020 2020 2020  alse.           
+00056930: 2053 6574 2074 6865 206c 6162 656c 7320   Set the labels 
+00056940: 6174 2074 6865 2063 656e 7465 7220 6f66  at the center of
+00056950: 2074 6865 2077 696e 646f 772e 0a20 2020   the window..   
+00056960: 2020 2020 202a 2a77 696e 646f 775f 6b77       **window_kw
+00056970: 6172 6773 203a 206f 7074 696f 6e61 6c0a  args : optional.
+00056980: 2020 2020 2020 2020 2020 2020 5468 6520              The 
+00056990: 6b65 7977 6f72 6420 6172 6775 6d65 6e74  keyword argument
+000569a0: 7320 666f 726d 206f 6620 6060 6469 6d60  s form of ``dim`
+000569b0: 602e 0a20 2020 2020 2020 2020 2020 204f  `..            O
+000569c0: 6e65 206f 6620 6469 6d20 6f72 2077 696e  ne of dim or win
+000569d0: 646f 775f 6b77 6172 6773 206d 7573 7420  dow_kwargs must 
+000569e0: 6265 2070 726f 7669 6465 642e 0a0a 2020  be provided...  
+000569f0: 2020 2020 2020 5265 7475 726e 730a 2020        Returns.  
+00056a00: 2020 2020 2020 2d2d 2d2d 2d2d 2d0a 2020        -------.  
+00056a10: 2020 2020 2020 636f 7265 2e72 6f6c 6c69        core.rolli
+00056a20: 6e67 2e44 6174 6173 6574 526f 6c6c 696e  ng.DatasetRollin
+00056a30: 670a 0a20 2020 2020 2020 2053 6565 2041  g..        See A
+00056a40: 6c73 6f0a 2020 2020 2020 2020 2d2d 2d2d  lso.        ----
+00056a50: 2d2d 2d2d 0a20 2020 2020 2020 2063 6f72  ----.        cor
+00056a60: 652e 726f 6c6c 696e 672e 4461 7461 7365  e.rolling.Datase
+00056a70: 7452 6f6c 6c69 6e67 0a20 2020 2020 2020  tRolling.       
+00056a80: 2044 6174 6141 7272 6179 2e72 6f6c 6c69   DataArray.rolli
+00056a90: 6e67 0a20 2020 2020 2020 2022 2222 0a20  ng.        """. 
+00056aa0: 2020 2020 2020 2066 726f 6d20 7861 7272         from xarr
+00056ab0: 6179 2e63 6f72 652e 726f 6c6c 696e 6720  ay.core.rolling 
+00056ac0: 696d 706f 7274 2044 6174 6173 6574 526f  import DatasetRo
+00056ad0: 6c6c 696e 670a 0a20 2020 2020 2020 2064  lling..        d
+00056ae0: 696d 203d 2065 6974 6865 725f 6469 6374  im = either_dict
+00056af0: 5f6f 725f 6b77 6172 6773 2864 696d 2c20  _or_kwargs(dim, 
+00056b00: 7769 6e64 6f77 5f6b 7761 7267 732c 2022  window_kwargs, "
+00056b10: 726f 6c6c 696e 6722 290a 2020 2020 2020  rolling").      
+00056b20: 2020 7265 7475 726e 2044 6174 6173 6574    return Dataset
+00056b30: 526f 6c6c 696e 6728 7365 6c66 2c20 6469  Rolling(self, di
+00056b40: 6d2c 206d 696e 5f70 6572 696f 6473 3d6d  m, min_periods=m
+00056b50: 696e 5f70 6572 696f 6473 2c20 6365 6e74  in_periods, cent
+00056b60: 6572 3d63 656e 7465 7229 0a0a 2020 2020  er=center)..    
+00056b70: 6465 6620 636f 6172 7365 6e28 0a20 2020  def coarsen(.   
+00056b80: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00056b90: 2020 2064 696d 3a20 4d61 7070 696e 675b     dim: Mapping[
+00056ba0: 416e 792c 2069 6e74 5d20 7c20 4e6f 6e65  Any, int] | None
+00056bb0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+00056bc0: 2062 6f75 6e64 6172 793a 2043 6f61 7273   boundary: Coars
+00056bd0: 656e 426f 756e 6461 7279 4f70 7469 6f6e  enBoundaryOption
+00056be0: 7320 3d20 2265 7861 6374 222c 0a20 2020  s = "exact",.   
+00056bf0: 2020 2020 2073 6964 653a 2053 6964 654f       side: SideO
+00056c00: 7074 696f 6e73 207c 204d 6170 7069 6e67  ptions | Mapping
+00056c10: 5b41 6e79 2c20 5369 6465 4f70 7469 6f6e  [Any, SideOption
+00056c20: 735d 203d 2022 6c65 6674 222c 0a20 2020  s] = "left",.   
+00056c30: 2020 2020 2063 6f6f 7264 5f66 756e 633a       coord_func:
+00056c40: 2073 7472 207c 2043 616c 6c61 626c 6520   str | Callable 
+00056c50: 7c20 4d61 7070 696e 675b 416e 792c 2073  | Mapping[Any, s
+00056c60: 7472 207c 2043 616c 6c61 626c 655d 203d  tr | Callable] =
+00056c70: 2022 6d65 616e 222c 0a20 2020 2020 2020   "mean",.       
+00056c80: 202a 2a77 696e 646f 775f 6b77 6172 6773   **window_kwargs
+00056c90: 3a20 696e 742c 0a20 2020 2029 202d 3e20  : int,.    ) -> 
+00056ca0: 4461 7461 7365 7443 6f61 7273 656e 3a0a  DatasetCoarsen:.
+00056cb0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00056cc0: 2020 2020 436f 6172 7365 6e20 6f62 6a65      Coarsen obje
+00056cd0: 6374 2066 6f72 2044 6174 6173 6574 732e  ct for Datasets.
+00056ce0: 0a0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00056cf0: 7465 7273 0a20 2020 2020 2020 202d 2d2d  ters.        ---
+00056d00: 2d2d 2d2d 2d2d 2d0a 2020 2020 2020 2020  -------.        
+00056d10: 6469 6d20 3a20 6d61 7070 696e 6720 6f66  dim : mapping of
+00056d20: 2068 6173 6861 626c 6520 746f 2069 6e74   hashable to int
+00056d30: 2c20 6f70 7469 6f6e 616c 0a20 2020 2020  , optional.     
+00056d40: 2020 2020 2020 204d 6170 7069 6e67 2066         Mapping f
+00056d50: 726f 6d20 7468 6520 6469 6d65 6e73 696f  rom the dimensio
+00056d60: 6e20 6e61 6d65 2074 6f20 7468 6520 7769  n name to the wi
+00056d70: 6e64 6f77 2073 697a 652e 0a20 2020 2020  ndow size..     
+00056d80: 2020 2062 6f75 6e64 6172 7920 3a20 7b22     boundary : {"
+00056d90: 6578 6163 7422 2c20 2274 7269 6d22 2c20  exact", "trim", 
+00056da0: 2270 6164 227d 2c20 6465 6661 756c 743a  "pad"}, default:
+00056db0: 2022 6578 6163 7422 0a20 2020 2020 2020   "exact".       
+00056dc0: 2020 2020 2049 6620 2765 7861 6374 272c       If 'exact',
+00056dd0: 2061 2056 616c 7565 4572 726f 7220 7769   a ValueError wi
+00056de0: 6c6c 2062 6520 7261 6973 6564 2069 6620  ll be raised if 
+00056df0: 6469 6d65 6e73 696f 6e20 7369 7a65 2069  dimension size i
+00056e00: 7320 6e6f 7420 610a 2020 2020 2020 2020  s not a.        
+00056e10: 2020 2020 6d75 6c74 6970 6c65 206f 6620      multiple of 
+00056e20: 7468 6520 7769 6e64 6f77 2073 697a 652e  the window size.
+00056e30: 2049 6620 2774 7269 6d27 2c20 7468 6520   If 'trim', the 
+00056e40: 6578 6365 7373 2065 6e74 7269 6573 2061  excess entries a
+00056e50: 7265 0a20 2020 2020 2020 2020 2020 2064  re.            d
+00056e60: 726f 7070 6564 2e20 4966 2027 7061 6427  ropped. If 'pad'
+00056e70: 2c20 4e41 2077 696c 6c20 6265 2070 6164  , NA will be pad
+00056e80: 6465 642e 0a20 2020 2020 2020 2073 6964  ded..        sid
+00056e90: 6520 3a20 7b22 6c65 6674 222c 2022 7269  e : {"left", "ri
+00056ea0: 6768 7422 7d20 6f72 206d 6170 7069 6e67  ght"} or mapping
+00056eb0: 206f 6620 7374 7220 746f 207b 226c 6566   of str to {"lef
+00056ec0: 7422 2c20 2272 6967 6874 227d 2c20 6465  t", "right"}, de
+00056ed0: 6661 756c 743a 2022 6c65 6674 220a 2020  fault: "left".  
+00056ee0: 2020 2020 2020 636f 6f72 645f 6675 6e63        coord_func
+00056ef0: 203a 2073 7472 206f 7220 6d61 7070 696e   : str or mappin
+00056f00: 6720 6f66 2068 6173 6861 626c 6520 746f  g of hashable to
+00056f10: 2073 7472 2c20 6465 6661 756c 743a 2022   str, default: "
+00056f20: 6d65 616e 220a 2020 2020 2020 2020 2020  mean".          
+00056f30: 2020 6675 6e63 7469 6f6e 2028 6e61 6d65    function (name
+00056f40: 2920 7468 6174 2069 7320 6170 706c 6965  ) that is applie
+00056f50: 6420 746f 2074 6865 2063 6f6f 7264 696e  d to the coordin
+00056f60: 6174 6573 2c0a 2020 2020 2020 2020 2020  ates,.          
+00056f70: 2020 6f72 2061 206d 6170 7069 6e67 2066    or a mapping f
+00056f80: 726f 6d20 636f 6f72 6469 6e61 7465 206e  rom coordinate n
+00056f90: 616d 6520 746f 2066 756e 6374 696f 6e20  ame to function 
+00056fa0: 286e 616d 6529 2e0a 0a20 2020 2020 2020  (name)...       
+00056fb0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00056fc0: 202d 2d2d 2d2d 2d2d 0a20 2020 2020 2020   -------.       
+00056fd0: 2063 6f72 652e 726f 6c6c 696e 672e 4461   core.rolling.Da
+00056fe0: 7461 7365 7443 6f61 7273 656e 0a0a 2020  tasetCoarsen..  
+00056ff0: 2020 2020 2020 5365 6520 416c 736f 0a20        See Also. 
+00057000: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0a         --------.
+00057010: 2020 2020 2020 2020 636f 7265 2e72 6f6c          core.rol
+00057020: 6c69 6e67 2e44 6174 6173 6574 436f 6172  ling.DatasetCoar
+00057030: 7365 6e0a 2020 2020 2020 2020 4461 7461  sen.        Data
+00057040: 4172 7261 792e 636f 6172 7365 6e0a 2020  Array.coarsen.  
+00057050: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00057060: 2020 6672 6f6d 2078 6172 7261 792e 636f    from xarray.co
+00057070: 7265 2e72 6f6c 6c69 6e67 2069 6d70 6f72  re.rolling impor
+00057080: 7420 4461 7461 7365 7443 6f61 7273 656e  t DatasetCoarsen
+00057090: 0a0a 2020 2020 2020 2020 6469 6d20 3d20  ..        dim = 
+000570a0: 6569 7468 6572 5f64 6963 745f 6f72 5f6b  either_dict_or_k
+000570b0: 7761 7267 7328 6469 6d2c 2077 696e 646f  wargs(dim, windo
+000570c0: 775f 6b77 6172 6773 2c20 2263 6f61 7273  w_kwargs, "coars
+000570d0: 656e 2229 0a20 2020 2020 2020 2072 6574  en").        ret
+000570e0: 7572 6e20 4461 7461 7365 7443 6f61 7273  urn DatasetCoars
+000570f0: 656e 280a 2020 2020 2020 2020 2020 2020  en(.            
+00057100: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
+00057110: 2020 6469 6d2c 0a20 2020 2020 2020 2020    dim,.         
+00057120: 2020 2062 6f75 6e64 6172 793d 626f 756e     boundary=boun
+00057130: 6461 7279 2c0a 2020 2020 2020 2020 2020  dary,.          
+00057140: 2020 7369 6465 3d73 6964 652c 0a20 2020    side=side,.   
+00057150: 2020 2020 2020 2020 2063 6f6f 7264 5f66           coord_f
+00057160: 756e 633d 636f 6f72 645f 6675 6e63 2c0a  unc=coord_func,.
+00057170: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00057180: 6566 2072 6573 616d 706c 6528 0a20 2020  ef resample(.   
+00057190: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+000571a0: 2020 2069 6e64 6578 6572 3a20 4d61 7070     indexer: Mapp
+000571b0: 696e 675b 416e 792c 2073 7472 5d20 7c20  ing[Any, str] | 
+000571c0: 4e6f 6e65 203d 204e 6f6e 652c 0a20 2020  None = None,.   
+000571d0: 2020 2020 2073 6b69 706e 613a 2062 6f6f       skipna: boo
+000571e0: 6c20 7c20 4e6f 6e65 203d 204e 6f6e 652c  l | None = None,
+000571f0: 0a20 2020 2020 2020 2063 6c6f 7365 643a  .        closed:
+00057200: 2053 6964 654f 7074 696f 6e73 207c 204e   SideOptions | N
+00057210: 6f6e 6520 3d20 4e6f 6e65 2c0a 2020 2020  one = None,.    
+00057220: 2020 2020 6c61 6265 6c3a 2053 6964 654f      label: SideO
+00057230: 7074 696f 6e73 207c 204e 6f6e 6520 3d20  ptions | None = 
+00057240: 4e6f 6e65 2c0a 2020 2020 2020 2020 6261  None,.        ba
+00057250: 7365 3a20 696e 7420 7c20 4e6f 6e65 203d  se: int | None =
+00057260: 204e 6f6e 652c 0a20 2020 2020 2020 206f   None,.        o
+00057270: 6666 7365 743a 2070 642e 5469 6d65 6465  ffset: pd.Timede
+00057280: 6c74 6120 7c20 6461 7465 7469 6d65 2e74  lta | datetime.t
+00057290: 696d 6564 656c 7461 207c 2073 7472 207c  imedelta | str |
+000572a0: 204e 6f6e 6520 3d20 4e6f 6e65 2c0a 2020   None = None,.  
+000572b0: 2020 2020 2020 6f72 6967 696e 3a20 7374        origin: st
+000572c0: 7220 7c20 4461 7465 7469 6d65 4c69 6b65  r | DatetimeLike
+000572d0: 203d 2022 7374 6172 745f 6461 7922 2c0a   = "start_day",.
+000572e0: 2020 2020 2020 2020 6b65 6570 5f61 7474          keep_att
+000572f0: 7273 3a20 626f 6f6c 207c 204e 6f6e 6520  rs: bool | None 
+00057300: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
+00057310: 6c6f 6666 7365 743a 2064 6174 6574 696d  loffset: datetim
+00057320: 652e 7469 6d65 6465 6c74 6120 7c20 7374  e.timedelta | st
+00057330: 7220 7c20 4e6f 6e65 203d 204e 6f6e 652c  r | None = None,
+00057340: 0a20 2020 2020 2020 2072 6573 746f 7265  .        restore
+00057350: 5f63 6f6f 7264 5f64 696d 733a 2062 6f6f  _coord_dims: boo
+00057360: 6c20 7c20 4e6f 6e65 203d 204e 6f6e 652c  l | None = None,
+00057370: 0a20 2020 2020 2020 202a 2a69 6e64 6578  .        **index
+00057380: 6572 5f6b 7761 7267 733a 2073 7472 2c0a  er_kwargs: str,.
+00057390: 2020 2020 2920 2d3e 2044 6174 6173 6574      ) -> Dataset
+000573a0: 5265 7361 6d70 6c65 3a0a 2020 2020 2020  Resample:.      
+000573b0: 2020 2222 2252 6574 7572 6e73 2061 2052    """Returns a R
+000573c0: 6573 616d 706c 6520 6f62 6a65 6374 2066  esample object f
+000573d0: 6f72 2070 6572 666f 726d 696e 6720 7265  or performing re
+000573e0: 7361 6d70 6c69 6e67 206f 7065 7261 7469  sampling operati
+000573f0: 6f6e 732e 0a0a 2020 2020 2020 2020 4861  ons...        Ha
+00057400: 6e64 6c65 7320 626f 7468 2064 6f77 6e73  ndles both downs
+00057410: 616d 706c 696e 6720 616e 6420 7570 7361  ampling and upsa
+00057420: 6d70 6c69 6e67 2e20 5468 6520 7265 7361  mpling. The resa
+00057430: 6d70 6c65 640a 2020 2020 2020 2020 6469  mpled.        di
+00057440: 6d65 6e73 696f 6e20 6d75 7374 2062 6520  mension must be 
+00057450: 6120 6461 7465 7469 6d65 2d6c 696b 6520  a datetime-like 
+00057460: 636f 6f72 6469 6e61 7465 2e20 4966 2061  coordinate. If a
+00057470: 6e79 2069 6e74 6572 7661 6c73 0a20 2020  ny intervals.   
+00057480: 2020 2020 2063 6f6e 7461 696e 206e 6f20       contain no 
+00057490: 7661 6c75 6573 2066 726f 6d20 7468 6520  values from the 
+000574a0: 6f72 6967 696e 616c 206f 626a 6563 742c  original object,
+000574b0: 2074 6865 7920 7769 6c6c 2062 6520 6769   they will be gi
+000574c0: 7665 6e0a 2020 2020 2020 2020 7468 6520  ven.        the 
+000574d0: 7661 6c75 6520 6060 4e61 4e60 602e 0a0a  value ``NaN``...
+000574e0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+000574f0: 7273 0a20 2020 2020 2020 202d 2d2d 2d2d  rs.        -----
+00057500: 2d2d 2d2d 2d0a 2020 2020 2020 2020 696e  -----.        in
+00057510: 6465 7865 7220 3a20 4d61 7070 696e 6720  dexer : Mapping 
+00057520: 6f66 2048 6173 6861 626c 6520 746f 2073  of Hashable to s
+00057530: 7472 2c20 6f70 7469 6f6e 616c 0a20 2020  tr, optional.   
+00057540: 2020 2020 2020 2020 204d 6170 7069 6e67           Mapping
+00057550: 2066 726f 6d20 7468 6520 6469 6d65 6e73   from the dimens
+00057560: 696f 6e20 6e61 6d65 2074 6f20 7265 7361  ion name to resa
+00057570: 6d70 6c65 2066 7265 7175 656e 6379 205b  mple frequency [
+00057580: 315d 5f2e 2054 6865 0a20 2020 2020 2020  1]_. The.       
+00057590: 2020 2020 2064 696d 656e 7369 6f6e 206d       dimension m
+000575a0: 7573 7420 6265 2064 6174 6574 696d 652d  ust be datetime-
+000575b0: 6c69 6b65 2e0a 2020 2020 2020 2020 736b  like..        sk
+000575c0: 6970 6e61 203a 2062 6f6f 6c2c 206f 7074  ipna : bool, opt
+000575d0: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+000575e0: 2020 5768 6574 6865 7220 746f 2073 6b69    Whether to ski
+000575f0: 7020 6d69 7373 696e 6720 7661 6c75 6573  p missing values
+00057600: 2077 6865 6e20 6167 6772 6567 6174 696e   when aggregatin
+00057610: 6720 696e 2064 6f77 6e73 616d 706c 696e  g in downsamplin
+00057620: 672e 0a20 2020 2020 2020 2063 6c6f 7365  g..        close
+00057630: 6420 3a20 7b22 6c65 6674 222c 2022 7269  d : {"left", "ri
+00057640: 6768 7422 7d2c 206f 7074 696f 6e61 6c0a  ght"}, optional.
+00057650: 2020 2020 2020 2020 2020 2020 5369 6465              Side
+00057660: 206f 6620 6561 6368 2069 6e74 6572 7661   of each interva
+00057670: 6c20 746f 2074 7265 6174 2061 7320 636c  l to treat as cl
+00057680: 6f73 6564 2e0a 2020 2020 2020 2020 6c61  osed..        la
+00057690: 6265 6c20 3a20 7b22 6c65 6674 222c 2022  bel : {"left", "
+000576a0: 7269 6768 7422 7d2c 206f 7074 696f 6e61  right"}, optiona
+000576b0: 6c0a 2020 2020 2020 2020 2020 2020 5369  l.            Si
+000576c0: 6465 206f 6620 6561 6368 2069 6e74 6572  de of each inter
+000576d0: 7661 6c20 746f 2075 7365 2066 6f72 206c  val to use for l
+000576e0: 6162 656c 696e 672e 0a20 2020 2020 2020  abeling..       
+000576f0: 2062 6173 6520 3a20 696e 742c 206f 7074   base : int, opt
+00057700: 696f 6e61 6c0a 2020 2020 2020 2020 2020  ional.          
+00057710: 2020 466f 7220 6672 6571 7565 6e63 6965    For frequencie
+00057720: 7320 7468 6174 2065 7665 6e6c 7920 7375  s that evenly su
+00057730: 6264 6976 6964 6520 3120 6461 792c 2074  bdivide 1 day, t
+00057740: 6865 2022 6f72 6967 696e 2220 6f66 2074  he "origin" of t
+00057750: 6865 0a20 2020 2020 2020 2020 2020 2061  he.            a
+00057760: 6767 7265 6761 7465 6420 696e 7465 7276  ggregated interv
+00057770: 616c 732e 2046 6f72 2065 7861 6d70 6c65  als. For example
+00057780: 2c20 666f 7220 2232 3448 2220 6672 6571  , for "24H" freq
+00057790: 7565 6e63 792c 2062 6173 6520 636f 756c  uency, base coul
+000577a0: 640a 2020 2020 2020 2020 2020 2020 7261  d.            ra
+000577b0: 6e67 6520 6672 6f6d 2030 2074 6872 6f75  nge from 0 throu
+000577c0: 6768 2032 332e 0a20 2020 2020 2020 206f  gh 23..        o
+000577d0: 7269 6769 6e20 3a20 7b27 6570 6f63 6827  rigin : {'epoch'
+000577e0: 2c20 2773 7461 7274 272c 2027 7374 6172  , 'start', 'star
+000577f0: 745f 6461 7927 2c20 2765 6e64 272c 2027  t_day', 'end', '
+00057800: 656e 645f 6461 7927 7d2c 2070 642e 5469  end_day'}, pd.Ti
+00057810: 6d65 7374 616d 702c 2064 6174 6574 696d  mestamp, datetim
+00057820: 652e 6461 7465 7469 6d65 2c20 6e70 2e64  e.datetime, np.d
+00057830: 6174 6574 696d 6536 342c 206f 7220 6366  atetime64, or cf
+00057840: 7469 6d65 2e64 6174 6574 696d 652c 2064  time.datetime, d
+00057850: 6566 6175 6c74 2027 7374 6172 745f 6461  efault 'start_da
+00057860: 7927 0a20 2020 2020 2020 2020 2020 2054  y'.            T
+00057870: 6865 2064 6174 6574 696d 6520 6f6e 2077  he datetime on w
+00057880: 6869 6368 2074 6f20 6164 6a75 7374 2074  hich to adjust t
+00057890: 6865 2067 726f 7570 696e 672e 2054 6865  he grouping. The
+000578a0: 2074 696d 657a 6f6e 6520 6f66 206f 7269   timezone of ori
+000578b0: 6769 6e0a 2020 2020 2020 2020 2020 2020  gin.            
+000578c0: 6d75 7374 206d 6174 6368 2074 6865 2074  must match the t
+000578d0: 696d 657a 6f6e 6520 6f66 2074 6865 2069  imezone of the i
+000578e0: 6e64 6578 2e0a 0a20 2020 2020 2020 2020  ndex...         
+000578f0: 2020 2049 6620 6120 6461 7465 7469 6d65     If a datetime
+00057900: 2069 7320 6e6f 7420 7573 6564 2c20 7468   is not used, th
+00057910: 6573 6520 7661 6c75 6573 2061 7265 2061  ese values are a
+00057920: 6c73 6f20 7375 7070 6f72 7465 643a 0a20  lso supported:. 
+00057930: 2020 2020 2020 2020 2020 202d 2027 6570             - 'ep
+00057940: 6f63 6827 3a20 606f 7269 6769 6e60 2069  och': `origin` i
+00057950: 7320 3139 3730 2d30 312d 3031 0a20 2020  s 1970-01-01.   
+00057960: 2020 2020 2020 2020 202d 2027 7374 6172           - 'star
+00057970: 7427 3a20 606f 7269 6769 6e60 2069 7320  t': `origin` is 
+00057980: 7468 6520 6669 7273 7420 7661 6c75 6520  the first value 
+00057990: 6f66 2074 6865 2074 696d 6573 6572 6965  of the timeserie
+000579a0: 730a 2020 2020 2020 2020 2020 2020 2d20  s.            - 
+000579b0: 2773 7461 7274 5f64 6179 273a 2060 6f72  'start_day': `or
+000579c0: 6967 696e 6020 6973 2074 6865 2066 6972  igin` is the fir
+000579d0: 7374 2064 6179 2061 7420 6d69 646e 6967  st day at midnig
+000579e0: 6874 206f 6620 7468 6520 7469 6d65 7365  ht of the timese
+000579f0: 7269 6573 0a20 2020 2020 2020 2020 2020  ries.           
+00057a00: 202d 2027 656e 6427 3a20 606f 7269 6769   - 'end': `origi
+00057a10: 6e60 2069 7320 7468 6520 6c61 7374 2076  n` is the last v
+00057a20: 616c 7565 206f 6620 7468 6520 7469 6d65  alue of the time
+00057a30: 7365 7269 6573 0a20 2020 2020 2020 2020  series.         
+00057a40: 2020 202d 2027 656e 645f 6461 7927 3a20     - 'end_day': 
+00057a50: 606f 7269 6769 6e60 2069 7320 7468 6520  `origin` is the 
+00057a60: 6365 696c 696e 6720 6d69 646e 6967 6874  ceiling midnight
+00057a70: 206f 6620 7468 6520 6c61 7374 2064 6179   of the last day
+00057a80: 0a20 2020 2020 2020 206f 6666 7365 7420  .        offset 
+00057a90: 3a20 7064 2e54 696d 6564 656c 7461 2c20  : pd.Timedelta, 
+00057aa0: 6461 7465 7469 6d65 2e74 696d 6564 656c  datetime.timedel
+00057ab0: 7461 2c20 6f72 2073 7472 2c20 6465 6661  ta, or str, defa
+00057ac0: 756c 7420 6973 204e 6f6e 650a 2020 2020  ult is None.    
+00057ad0: 2020 2020 2020 2020 416e 206f 6666 7365          An offse
+00057ae0: 7420 7469 6d65 6465 6c74 6120 6164 6465  t timedelta adde
+00057af0: 6420 746f 2074 6865 206f 7269 6769 6e2e  d to the origin.
+00057b00: 0a20 2020 2020 2020 206c 6f66 6673 6574  .        loffset
+00057b10: 203a 2074 696d 6564 656c 7461 206f 7220   : timedelta or 
+00057b20: 7374 722c 206f 7074 696f 6e61 6c0a 2020  str, optional.  
+00057b30: 2020 2020 2020 2020 2020 4f66 6673 6574            Offset
+00057b40: 2075 7365 6420 746f 2061 646a 7573 7420   used to adjust 
+00057b50: 7468 6520 7265 7361 6d70 6c65 6420 7469  the resampled ti
+00057b60: 6d65 206c 6162 656c 732e 2053 6f6d 6520  me labels. Some 
+00057b70: 7061 6e64 6173 2064 6174 650a 2020 2020  pandas date.    
+00057b80: 2020 2020 2020 2020 6f66 6673 6574 2073          offset s
+00057b90: 7472 696e 6773 2061 7265 2073 7570 706f  trings are suppo
+00057ba0: 7274 6564 2e0a 2020 2020 2020 2020 7265  rted..        re
+00057bb0: 7374 6f72 655f 636f 6f72 645f 6469 6d73  store_coord_dims
+00057bc0: 203a 2062 6f6f 6c2c 206f 7074 696f 6e61   : bool, optiona
+00057bd0: 6c0a 2020 2020 2020 2020 2020 2020 4966  l.            If
+00057be0: 2054 7275 652c 2061 6c73 6f20 7265 7374   True, also rest
+00057bf0: 6f72 6520 7468 6520 6469 6d65 6e73 696f  ore the dimensio
+00057c00: 6e20 6f72 6465 7220 6f66 206d 756c 7469  n order of multi
+00057c10: 2d64 696d 656e 7369 6f6e 616c 0a20 2020  -dimensional.   
+00057c20: 2020 2020 2020 2020 2063 6f6f 7264 696e           coordin
+00057c30: 6174 6573 2e0a 2020 2020 2020 2020 2a2a  ates..        **
+00057c40: 696e 6465 7865 725f 6b77 6172 6773 203a  indexer_kwargs :
+00057c50: 2073 7472 0a20 2020 2020 2020 2020 2020   str.           
+00057c60: 2054 6865 206b 6579 776f 7264 2061 7267   The keyword arg
+00057c70: 756d 656e 7473 2066 6f72 6d20 6f66 2060  uments form of `
+00057c80: 6069 6e64 6578 6572 6060 2e0a 2020 2020  `indexer``..    
+00057c90: 2020 2020 2020 2020 4f6e 6520 6f66 2069          One of i
+00057ca0: 6e64 6578 6572 206f 7220 696e 6465 7865  ndexer or indexe
+00057cb0: 725f 6b77 6172 6773 206d 7573 7420 6265  r_kwargs must be
+00057cc0: 2070 726f 7669 6465 642e 0a0a 2020 2020   provided...    
+00057cd0: 2020 2020 5265 7475 726e 730a 2020 2020      Returns.    
+00057ce0: 2020 2020 2d2d 2d2d 2d2d 2d0a 2020 2020      -------.    
+00057cf0: 2020 2020 7265 7361 6d70 6c65 6420 3a20      resampled : 
+00057d00: 636f 7265 2e72 6573 616d 706c 652e 4461  core.resample.Da
+00057d10: 7461 4172 7261 7952 6573 616d 706c 650a  taArrayResample.
+00057d20: 2020 2020 2020 2020 2020 2020 5468 6973              This
+00057d30: 206f 626a 6563 7420 7265 7361 6d70 6c65   object resample
+00057d40: 642e 0a0a 2020 2020 2020 2020 5365 6520  d...        See 
+00057d50: 416c 736f 0a20 2020 2020 2020 202d 2d2d  Also.        ---
+00057d60: 2d2d 2d2d 2d0a 2020 2020 2020 2020 4461  -----.        Da
+00057d70: 7461 4172 7261 792e 7265 7361 6d70 6c65  taArray.resample
+00057d80: 0a20 2020 2020 2020 2070 616e 6461 732e  .        pandas.
+00057d90: 5365 7269 6573 2e72 6573 616d 706c 650a  Series.resample.
+00057da0: 2020 2020 2020 2020 7061 6e64 6173 2e44          pandas.D
+00057db0: 6174 6146 7261 6d65 2e72 6573 616d 706c  ataFrame.resampl
+00057dc0: 650a 2020 2020 2020 2020 4461 7461 7365  e.        Datase
+00057dd0: 742e 6772 6f75 7062 790a 2020 2020 2020  t.groupby.      
+00057de0: 2020 4461 7461 4172 7261 792e 6772 6f75    DataArray.grou
+00057df0: 7062 790a 0a20 2020 2020 2020 2052 6566  pby..        Ref
+00057e00: 6572 656e 6365 730a 2020 2020 2020 2020  erences.        
+00057e10: 2d2d 2d2d 2d2d 2d2d 2d2d 0a20 2020 2020  ----------.     
+00057e20: 2020 202e 2e20 5b31 5d20 6874 7470 3a2f     .. [1] http:/
+00057e30: 2f70 616e 6461 732e 7079 6461 7461 2e6f  /pandas.pydata.o
+00057e40: 7267 2f70 616e 6461 732d 646f 6373 2f73  rg/pandas-docs/s
+00057e50: 7461 626c 652f 7469 6d65 7365 7269 6573  table/timeseries
+00057e60: 2e68 746d 6c23 6f66 6673 6574 2d61 6c69  .html#offset-ali
+00057e70: 6173 6573 0a20 2020 2020 2020 2022 2222  ases.        """
+00057e80: 0a20 2020 2020 2020 2066 726f 6d20 7861  .        from xa
+00057e90: 7272 6179 2e63 6f72 652e 7265 7361 6d70  rray.core.resamp
+00057ea0: 6c65 2069 6d70 6f72 7420 4461 7461 7365  le import Datase
+00057eb0: 7452 6573 616d 706c 650a 0a20 2020 2020  tResample..     
+00057ec0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00057ed0: 7265 7361 6d70 6c65 280a 2020 2020 2020  resample(.      
+00057ee0: 2020 2020 2020 7265 7361 6d70 6c65 5f63        resample_c
+00057ef0: 6c73 3d44 6174 6173 6574 5265 7361 6d70  ls=DatasetResamp
+00057f00: 6c65 2c0a 2020 2020 2020 2020 2020 2020  le,.            
+00057f10: 696e 6465 7865 723d 696e 6465 7865 722c  indexer=indexer,
+00057f20: 0a20 2020 2020 2020 2020 2020 2073 6b69  .            ski
+00057f30: 706e 613d 736b 6970 6e61 2c0a 2020 2020  pna=skipna,.    
+00057f40: 2020 2020 2020 2020 636c 6f73 6564 3d63          closed=c
+00057f50: 6c6f 7365 642c 0a20 2020 2020 2020 2020  losed,.         
+00057f60: 2020 206c 6162 656c 3d6c 6162 656c 2c0a     label=label,.
+00057f70: 2020 2020 2020 2020 2020 2020 6261 7365              base
+00057f80: 3d62 6173 652c 0a20 2020 2020 2020 2020  =base,.         
+00057f90: 2020 206f 6666 7365 743d 6f66 6673 6574     offset=offset
+00057fa0: 2c0a 2020 2020 2020 2020 2020 2020 6f72  ,.            or
+00057fb0: 6967 696e 3d6f 7269 6769 6e2c 0a20 2020  igin=origin,.   
+00057fc0: 2020 2020 2020 2020 206b 6565 705f 6174           keep_at
+00057fd0: 7472 733d 6b65 6570 5f61 7474 7273 2c0a  trs=keep_attrs,.
+00057fe0: 2020 2020 2020 2020 2020 2020 6c6f 6666              loff
+00057ff0: 7365 743d 6c6f 6666 7365 742c 0a20 2020  set=loffset,.   
+00058000: 2020 2020 2020 2020 2072 6573 746f 7265           restore
+00058010: 5f63 6f6f 7264 5f64 696d 733d 7265 7374  _coord_dims=rest
+00058020: 6f72 655f 636f 6f72 645f 6469 6d73 2c0a  ore_coord_dims,.
+00058030: 2020 2020 2020 2020 2020 2020 2a2a 696e              **in
+00058040: 6465 7865 725f 6b77 6172 6773 2c0a 2020  dexer_kwargs,.  
+00058050: 2020 2020 2020 290a                            ).
```

### Comparing `xarray-2023.5.0/xarray/core/dtypes.py` & `xarray-2023.6.0/xarray/core/dtypes.py`

 * *Files 3% similar despite different names*

```diff
@@ -33,19 +33,19 @@
 NINF = AlwaysLessThan()
 
 
 # Pairs of types that, if both found, should be promoted to object dtype
 # instead of following NumPy's own type-promotion rules. These type promotion
 # rules match pandas instead. For reference, see the NumPy type hierarchy:
 # https://numpy.org/doc/stable/reference/arrays.scalars.html
-PROMOTE_TO_OBJECT = [
-    {np.number, np.character},  # numpy promotes to character
-    {np.bool_, np.character},  # numpy promotes to character
-    {np.bytes_, np.unicode_},  # numpy promotes to unicode
-]
+PROMOTE_TO_OBJECT: tuple[tuple[type[np.generic], type[np.generic]], ...] = (
+    (np.number, np.character),  # numpy promotes to character
+    (np.bool_, np.character),  # numpy promotes to character
+    (np.bytes_, np.unicode_),  # numpy promotes to unicode
+)
 
 
 def maybe_promote(dtype):
     """Simpler equivalent of pandas.core.common._maybe_promote
 
     Parameters
     ----------
@@ -70,15 +70,18 @@
     elif np.issubdtype(dtype, np.complexfloating):
         fill_value = np.nan + np.nan * 1j
     elif np.issubdtype(dtype, np.datetime64):
         fill_value = np.datetime64("NaT")
     else:
         dtype = object
         fill_value = np.nan
-    return np.dtype(dtype), fill_value
+
+    dtype = np.dtype(dtype)
+    fill_value = dtype.type(fill_value)
+    return dtype, fill_value
 
 
 NAT_TYPES = {np.datetime64("NaT").dtype, np.timedelta64("NaT").dtype}
 
 
 def get_fill_value(dtype):
     """Return an appropriate fill value for this dtype.
@@ -152,15 +155,17 @@
 
 
 def is_datetime_like(dtype):
     """Check if a dtype is a subclass of the numpy datetime types"""
     return np.issubdtype(dtype, np.datetime64) or np.issubdtype(dtype, np.timedelta64)
 
 
-def result_type(*arrays_and_dtypes):
+def result_type(
+    *arrays_and_dtypes: np.typing.ArrayLike | np.typing.DTypeLike,
+) -> np.dtype:
     """Like np.result_type, but with type promotion rules matching pandas.
 
     Examples of changed behavior:
     number + string -> object (not string)
     bytes + unicode -> object (not unicode)
 
     Parameters
```

### Comparing `xarray-2023.5.0/xarray/core/duck_array_ops.py` & `xarray-2023.6.0/xarray/core/duck_array_ops.py`

 * *Files 0% similar despite different names*

```diff
@@ -190,15 +190,18 @@
 
 def asarray(data, xp=np):
     return data if is_duck_array(data) else xp.asarray(data)
 
 
 def as_shared_dtype(scalars_or_arrays, xp=np):
     """Cast a arrays to a shared dtype using xarray's type promotion rules."""
-    if any(isinstance(x, array_type("cupy")) for x in scalars_or_arrays):
+    array_type_cupy = array_type("cupy")
+    if array_type_cupy and any(
+        isinstance(x, array_type_cupy) for x in scalars_or_arrays
+    ):
         import cupy as cp
 
         arrays = [asarray(x, xp=cp) for x in scalars_or_arrays]
     else:
         arrays = [asarray(x, xp=xp) for x in scalars_or_arrays]
     # Pass arrays directly instead of dtypes to result_type so scalars
     # get handled properly.
```

### Comparing `xarray-2023.5.0/xarray/core/extensions.py` & `xarray-2023.6.0/xarray/core/extensions.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/formatting.py` & `xarray-2023.6.0/xarray/core/formatting.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/formatting_html.py` & `xarray-2023.6.0/xarray/core/formatting_html.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/groupby.py` & `xarray-2023.6.0/xarray/core/groupby.py`

 * *Files 0% similar despite different names*

```diff
@@ -232,14 +232,18 @@
         return {}
 
     def __getitem__(self, key):
         if isinstance(key, tuple):
             key = key[0]
         return self.values[key]
 
+    def to_index(self) -> pd.Index:
+        # could be pd.RangeIndex?
+        return pd.Index(np.arange(self.size))
+
     def copy(self, deep: bool = True, data: Any = None):
         raise NotImplementedError
 
     def to_dataarray(self) -> DataArray:
         from xarray.core.dataarray import DataArray
 
         return DataArray(
@@ -377,15 +381,15 @@
             return True
         index = self.group_as_index
         return index.is_unique and index.is_monotonic_increasing
 
     @property
     def group_as_index(self) -> pd.Index:
         if self._group_as_index is None:
-            self._group_as_index = safe_cast_to_index(self.group1d)
+            self._group_as_index = self.group1d.to_index()
         return self._group_as_index
 
 
 @dataclass
 class ResolvedUniqueGrouper(ResolvedGrouper):
     grouper: UniqueGrouper
 
@@ -618,14 +622,15 @@
             raise ValueError(
                 "Grouping by multi-dimensional IndexVariables is not allowed."
                 "Convert to and pass a DataArray instead."
             )
         (group_dim,) = group.dims
         if len(group) != obj.sizes[group_dim]:
             raise ValueError(error_msg)
+        newgroup = DataArray(group)
 
     else:
         if not hashable(group):
             raise TypeError(
                 "`group` must be an xarray.DataArray or the "
                 "name of an xarray variable or dimension. "
                 f"Received {group!r} instead."
```

### Comparing `xarray-2023.5.0/xarray/core/indexes.py` & `xarray-2023.6.0/xarray/core/indexes.py`

 * *Files 0% similar despite different names*

```diff
@@ -1491,15 +1491,15 @@
 ) -> dict[Hashable, Index]:
     """Filter index items given a (sub)set of coordinate names.
 
     Drop all multi-coordinate related index items for any key missing in the set
     of coordinate names.
 
     """
-    filtered_indexes: dict[Any, Index] = dict(**indexes)
+    filtered_indexes: dict[Any, Index] = dict(indexes)
 
     index_coord_names: dict[Hashable, set[Hashable]] = defaultdict(set)
     for name, idx in indexes.items():
         index_coord_names[id(idx)].add(name)
 
     for idx_coord_names in index_coord_names.values():
         if not idx_coord_names <= filtered_coord_names:
```

### Comparing `xarray-2023.5.0/xarray/core/indexing.py` & `xarray-2023.6.0/xarray/core/indexing.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/merge.py` & `xarray-2023.6.0/xarray/core/merge.py`

 * *Files 1% similar despite different names*

```diff
@@ -191,19 +191,19 @@
                 f"cannot set or update variable(s) {common_names_str}, which would corrupt "
                 f"the following index built from coordinates {index_names_str}:\n"
                 f"{indexes[index_id]!r}"
             )
 
 
 def merge_collected(
-    grouped: dict[Hashable, list[MergeElement]],
+    grouped: dict[Any, list[MergeElement]],
     prioritized: Mapping[Any, MergeElement] | None = None,
     compat: CompatOptions = "minimal",
     combine_attrs: CombineAttrsOptions = "override",
-    equals: dict[Hashable, bool] | None = None,
+    equals: dict[Any, bool] | None = None,
 ) -> tuple[dict[Hashable, Variable], dict[Hashable, Index]]:
     """Merge dicts of variables, while resolving conflicts appropriately.
 
     Parameters
     ----------
     grouped : mapping
     prioritized : mapping
@@ -302,15 +302,15 @@
                         [var.attrs for var in variables], combine_attrs=combine_attrs
                     )
 
     return merged_vars, merged_indexes
 
 
 def collect_variables_and_indexes(
-    list_of_mappings: list[DatasetLike],
+    list_of_mappings: Iterable[DatasetLike],
     indexes: Mapping[Any, Any] | None = None,
 ) -> dict[Hashable, list[MergeElement]]:
     """Collect variables and indexes from list of mappings of xarray objects.
 
     Mappings must either be Dataset objects, or have values of one of the
     following types:
     - an xarray.Variable
@@ -552,29 +552,36 @@
     )
     collected = collect_variables_and_indexes(aligned, indexes=indexes)
     prioritized = _get_priority_vars_and_indexes(aligned, priority_arg, compat=compat)
     variables, out_indexes = merge_collected(collected, prioritized, compat=compat)
     return variables, out_indexes
 
 
-def merge_data_and_coords(data_vars, coords, compat="broadcast_equals", join="outer"):
+def merge_data_and_coords(
+    data_vars: Mapping[Any, Any],
+    coords: Mapping[Any, Any],
+    compat: CompatOptions = "broadcast_equals",
+    join: JoinOptions = "outer",
+) -> _MergeResult:
     """Used in Dataset.__init__."""
     indexes, coords = _create_indexes_from_coords(coords, data_vars)
     objects = [data_vars, coords]
     explicit_coords = coords.keys()
     return merge_core(
         objects,
         compat,
         join,
         explicit_coords=explicit_coords,
         indexes=Indexes(indexes, coords),
     )
 
 
-def _create_indexes_from_coords(coords, data_vars=None):
+def _create_indexes_from_coords(
+    coords: Mapping[Any, Any], data_vars: Mapping[Any, Any] | None = None
+) -> tuple[dict, dict]:
     """Maybe create default indexes from a mapping of coordinates.
 
     Return those indexes and updated coordinates.
     """
     all_variables = dict(coords)
     if data_vars is not None:
         all_variables.update(data_vars)
@@ -601,15 +608,19 @@
             all_variables.update(idx_vars)
         else:
             updated_coords[name] = obj
 
     return indexes, updated_coords
 
 
-def assert_valid_explicit_coords(variables, dims, explicit_coords):
+def assert_valid_explicit_coords(
+    variables: Mapping[Any, Any],
+    dims: Mapping[Any, int],
+    explicit_coords: Iterable[Hashable],
+) -> None:
     """Validate explicit coordinate names/dims.
 
     Raise a MergeError if an explicit coord shares a name with a dimension
     but is comprised of arbitrary dimensions.
     """
     for coord_name in explicit_coords:
         if coord_name in dims and variables[coord_name].dims != (coord_name,):
@@ -684,15 +695,15 @@
 
 def merge_core(
     objects: Iterable[CoercibleMapping],
     compat: CompatOptions = "broadcast_equals",
     join: JoinOptions = "outer",
     combine_attrs: CombineAttrsOptions = "override",
     priority_arg: int | None = None,
-    explicit_coords: Sequence | None = None,
+    explicit_coords: Iterable[Hashable] | None = None,
     indexes: Mapping[Any, Any] | None = None,
     fill_value: object = dtypes.NA,
 ) -> _MergeResult:
     """Core logic for merging labeled objects.
 
     This is not public API.
 
@@ -1031,15 +1042,15 @@
     combine_attrs: CombineAttrsOptions,
 ) -> _MergeResult:
     """Guts of the Dataset.merge method."""
     # we are locked into supporting overwrite_vars for the Dataset.merge
     # method due for backwards compatibility
     # TODO: consider deprecating it?
 
-    if isinstance(overwrite_vars, Iterable) and not isinstance(overwrite_vars, str):
+    if not isinstance(overwrite_vars, str) and isinstance(overwrite_vars, Iterable):
         overwrite_vars = set(overwrite_vars)
     else:
         overwrite_vars = {overwrite_vars}
 
     if not overwrite_vars:
         objs = [dataset, other]
         priority_arg = None
```

### Comparing `xarray-2023.5.0/xarray/core/missing.py` & `xarray-2023.6.0/xarray/core/missing.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/nanops.py` & `xarray-2023.6.0/xarray/core/nanops.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/npcompat.py` & `xarray-2023.6.0/xarray/core/npcompat.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/nputils.py` & `xarray-2023.6.0/xarray/core/nputils.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/ops.py` & `xarray-2023.6.0/xarray/core/ops.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/options.py` & `xarray-2023.6.0/xarray/core/options.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/parallel.py` & `xarray-2023.6.0/xarray/core/parallel.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/parallelcompat.py` & `xarray-2023.6.0/xarray/core/parallelcompat.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/pdcompat.py` & `xarray-2023.6.0/xarray/core/pdcompat.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/pycompat.py` & `xarray-2023.6.0/xarray/core/pycompat.py`

 * *Files 8% similar despite different names*

```diff
@@ -46,33 +46,45 @@
             elif mod == "sparse":
                 duck_array_type = (duck_array_module.SparseArray,)
             elif mod == "cubed":
                 duck_array_type = (duck_array_module.Array,)
             else:
                 raise NotImplementedError
 
-        except ImportError:  # pragma: no cover
+        except (ImportError, AttributeError):  # pragma: no cover
             duck_array_module = None
             duck_array_version = Version("0.0.0")
             duck_array_type = ()
 
         self.module = duck_array_module
         self.version = duck_array_version
         self.type = duck_array_type
         self.available = duck_array_module is not None
 
 
+_cached_duck_array_modules: dict[ModType, DuckArrayModule] = {}
+
+
+def _get_cached_duck_array_module(mod: ModType) -> DuckArrayModule:
+    if mod not in _cached_duck_array_modules:
+        duckmod = DuckArrayModule(mod)
+        _cached_duck_array_modules[mod] = duckmod
+        return duckmod
+    else:
+        return _cached_duck_array_modules[mod]
+
+
 def array_type(mod: ModType) -> DuckArrayTypes:
     """Quick wrapper to get the array class of the module."""
-    return DuckArrayModule(mod).type
+    return _get_cached_duck_array_module(mod).type
 
 
 def mod_version(mod: ModType) -> Version:
     """Quick wrapper to get the version of the module."""
-    return DuckArrayModule(mod).version
+    return _get_cached_duck_array_module(mod).version
 
 
 def is_dask_collection(x):
     if module_available("dask"):
         from dask.base import is_dask_collection
 
         return is_dask_collection(x)
```

### Comparing `xarray-2023.5.0/xarray/core/resample.py` & `xarray-2023.6.0/xarray/core/resample.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/resample_cftime.py` & `xarray-2023.6.0/xarray/core/resample_cftime.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/rolling.py` & `xarray-2023.6.0/xarray/core/rolling.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/rolling_exp.py` & `xarray-2023.6.0/xarray/core/rolling_exp.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/types.py` & `xarray-2023.6.0/xarray/core/types.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/core/utils.py` & `xarray-2023.6.0/xarray/core/utils.py`

 * *Files 0% similar despite different names*

```diff
@@ -532,16 +532,15 @@
 
     def discard(self, value: T) -> None:
         del self._d[value]
 
     # Additional methods
 
     def update(self, values: Iterable[T]) -> None:
-        for v in values:
-            self._d[v] = None
+        self._d.update(dict.fromkeys(values))
 
     def __repr__(self) -> str:
         return f"{type(self).__name__}({list(self)!r})"
 
 
 class NdimSizeLenMixin:
     """Mixin class that extends a class that defines a ``shape`` property to
```

### Comparing `xarray-2023.5.0/xarray/core/variable.py` & `xarray-2023.6.0/xarray/core/variable.py`

 * *Files 1% similar despite different names*

```diff
@@ -234,15 +234,15 @@
     before allowing such values to pass through unchanged."""
     if isinstance(data, (pd.DatetimeIndex, pd.TimedeltaIndex)):
         return _as_nanosecond_precision(data)
     else:
         return data
 
 
-def as_compatible_data(data, fastpath=False):
+def as_compatible_data(data, fastpath: bool = False):
     """Prepare and wrap data to put in a Variable.
 
     - If data does not have the necessary attributes, convert it to ndarray.
     - If data has dtype=datetime64, ensure that it has ns precision. If it's a
       pandas.Timestamp, convert it to datetime64.
     - If data is already a pandas or xarray object (other than an Index), just
       use the values.
@@ -673,15 +673,16 @@
     @dims.setter
     def dims(self, value: str | Iterable[Hashable]) -> None:
         self._dims = self._parse_dimensions(value)
 
     def _parse_dimensions(self, dims: str | Iterable[Hashable]) -> tuple[Hashable, ...]:
         if isinstance(dims, str):
             dims = (dims,)
-        dims = tuple(dims)
+        else:
+            dims = tuple(dims)
         if len(dims) != self.ndim:
             raise ValueError(
                 f"dimensions {dims} must have the same length as the "
                 f"number of data dimensions, ndim={self.ndim}"
             )
         return dims
 
@@ -1417,15 +1418,15 @@
             dtype = self.dtype
 
         width = min(abs(count), self.shape[axis])
         dim_pad = (width, 0) if count >= 0 else (0, width)
         pads = [(0, 0) if d != dim else dim_pad for d in self.dims]
 
         data = np.pad(
-            trimmed_data.astype(dtype),
+            duck_array_ops.astype(trimmed_data, dtype),
             pads,
             mode="constant",
             constant_values=fill_value,
         )
 
         if is_duck_dask_array(data):
             # chunked data should come out with the same chunks; this makes
@@ -1566,15 +1567,15 @@
             pad_option_kwargs["constant_values"] = constant_values
         if end_values is not None:
             pad_option_kwargs["end_values"] = end_values
         if reflect_type is not None:
             pad_option_kwargs["reflect_type"] = reflect_type
 
         array = np.pad(
-            self.data.astype(dtype, copy=False),
+            duck_array_ops.astype(self.data, dtype, copy=False),
             pad_width_by_index,
             mode=mode,
             **pad_option_kwargs,
         )
 
         if keep_attrs is None:
             keep_attrs = _get_keep_attrs(default=True)
@@ -2098,43 +2099,44 @@
         if not isinstance(dim, str):
             (dim,) = dim.dims
 
         # can't do this lazily: we need to loop through variables at least
         # twice
         variables = list(variables)
         first_var = variables[0]
+        first_var_dims = first_var.dims
 
-        arrays = [v.data for v in variables]
+        arrays = [v._data for v in variables]
 
-        if dim in first_var.dims:
+        if dim in first_var_dims:
             axis = first_var.get_axis_num(dim)
-            dims = first_var.dims
+            dims = first_var_dims
             data = duck_array_ops.concatenate(arrays, axis=axis)
             if positions is not None:
                 # TODO: deprecate this option -- we don't need it for groupby
                 # any more.
                 indices = nputils.inverse_permutation(np.concatenate(positions))
                 data = duck_array_ops.take(data, indices, axis=axis)
         else:
             axis = 0
-            dims = (dim,) + first_var.dims
+            dims = (dim,) + first_var_dims
             data = duck_array_ops.stack(arrays, axis=axis)
 
         attrs = merge_attrs(
             [var.attrs for var in variables], combine_attrs=combine_attrs
         )
         encoding = dict(first_var.encoding)
         if not shortcut:
             for var in variables:
-                if var.dims != first_var.dims:
+                if var.dims != first_var_dims:
                     raise ValueError(
-                        f"Variable has dimensions {list(var.dims)} but first Variable has dimensions {list(first_var.dims)}"
+                        f"Variable has dimensions {list(var.dims)} but first Variable has dimensions {list(first_var_dims)}"
                     )
 
-        return cls(dims, data, attrs, encoding)
+        return cls(dims, data, attrs, encoding, fastpath=True)
 
     def equals(self, other, equiv=duck_array_ops.array_equiv):
         """True if two Variables have the same dimensions and values;
         otherwise False.
 
         Variables can still be equal (like pandas objects) if they have NaN
         values in the same locations.
@@ -2434,15 +2436,15 @@
                [[nan,  4.,  5.],
                 [ 4.,  5.,  6.],
                 [ 5.,  6.,  7.],
                 [ 6.,  7., nan]]])
         """
         if fill_value is dtypes.NA:  # np.nan is passed
             dtype, fill_value = dtypes.maybe_promote(self.dtype)
-            var = self.astype(dtype, copy=False)
+            var = duck_array_ops.astype(self, dtype, copy=False)
         else:
             dtype = self.dtype
             var = self
 
         if utils.is_scalar(dim):
             for name, arg in zip(
                 ["window", "window_dim", "center"], [window, window_dim, center]
@@ -2478,15 +2480,15 @@
                 start = win // 2  # 10 -> 5,  9 -> 4
                 end = win - 1 - start
                 pads[d] = (start, end)
             else:
                 pads[d] = (win - 1, 0)
 
         padded = var.pad(pads, mode="constant", constant_values=fill_value)
-        axis = [self.get_axis_num(d) for d in dim]
+        axis = tuple(self.get_axis_num(d) for d in dim)
         new_dims = self.dims + tuple(window_dim)
         return Variable(
             new_dims,
             duck_array_ops.sliding_window_view(
                 padded.data, window_shape=window, axis=axis
             ),
         )
```

### Comparing `xarray-2023.5.0/xarray/core/weighted.py` & `xarray-2023.6.0/xarray/core/weighted.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/plot/__init__.py` & `xarray-2023.6.0/xarray/plot/__init__.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/plot/accessor.py` & `xarray-2023.6.0/xarray/plot/accessor.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/plot/dataarray_plot.py` & `xarray-2023.6.0/xarray/plot/dataarray_plot.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/plot/dataset_plot.py` & `xarray-2023.6.0/xarray/plot/dataset_plot.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/plot/facetgrid.py` & `xarray-2023.6.0/xarray/plot/facetgrid.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/plot/utils.py` & `xarray-2023.6.0/xarray/plot/utils.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/static/css/style.css` & `xarray-2023.6.0/xarray/static/css/style.css`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/static/html/icons-svg-inline.html` & `xarray-2023.6.0/xarray/static/html/icons-svg-inline.html`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/testing.py` & `xarray-2023.6.0/xarray/testing.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/__init__.py` & `xarray-2023.6.0/xarray/tests/__init__.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/conftest.py` & `xarray-2023.6.0/xarray/tests/conftest.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/data/bears.nc` & `xarray-2023.6.0/xarray/tests/data/bears.nc`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/data/example.grib` & `xarray-2023.6.0/xarray/tests/data/example.grib`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/data/example.ict` & `xarray-2023.6.0/xarray/tests/data/example.ict`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/data/example.uamiv` & `xarray-2023.6.0/xarray/tests/data/example.uamiv`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/data/example_1.nc` & `xarray-2023.6.0/xarray/tests/data/example_1.nc`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_accessor_dt.py` & `xarray-2023.6.0/xarray/tests/test_accessor_dt.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_accessor_str.py` & `xarray-2023.6.0/xarray/tests/test_accessor_str.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_array_api.py` & `xarray-2023.6.0/xarray/tests/test_array_api.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_backends.py` & `xarray-2023.6.0/xarray/tests/test_backends.py`

 * *Files 1% similar despite different names*

```diff
@@ -42,14 +42,15 @@
 from xarray.backends.netcdf3 import _nc3_dtype_coercions
 from xarray.backends.netCDF4_ import (
     NetCDF4BackendEntrypoint,
     _extract_nc4_variable_encoding,
 )
 from xarray.backends.pydap_ import PydapDataStore
 from xarray.backends.scipy_ import ScipyBackendEntrypoint
+from xarray.coding.strings import check_vlen_dtype, create_vlen_dtype
 from xarray.coding.variables import SerializationWarning
 from xarray.conventions import encode_dataset_coordinates
 from xarray.core import indexing
 from xarray.core.options import set_options
 from xarray.core.pycompat import array_type
 from xarray.tests import (
     arm_xfail,
@@ -855,14 +856,28 @@
         encoding = {"dtype": "S1", "_FillValue": b"X"}
         original = Dataset({"x": ("t", values, {}, encoding)})
         # Not supported yet.
         with pytest.raises(NotImplementedError):
             with self.roundtrip(original) as actual:
                 assert_identical(expected, actual)
 
+    def test_roundtrip_empty_vlen_string_array(self) -> None:
+        # checks preserving vlen dtype for empty arrays GH7862
+        dtype = create_vlen_dtype(str)
+        original = Dataset({"a": np.array([], dtype=dtype)})
+        assert check_vlen_dtype(original["a"].dtype) == str
+        with self.roundtrip(original) as actual:
+            assert_identical(original, actual)
+            assert object == actual["a"].dtype
+            assert actual["a"].dtype == original["a"].dtype
+            # only check metadata for capable backends
+            # eg. NETCDF3 based backends do not roundtrip metadata
+            if actual["a"].dtype.metadata is not None:
+                assert check_vlen_dtype(actual["a"].dtype) == str
+
     @pytest.mark.parametrize(
         "decoded_fn, encoded_fn",
         [
             (
                 create_unsigned_masked_scaled_data,
                 create_encoded_unsigned_masked_scaled_data,
             ),
@@ -1830,14 +1845,16 @@
             xr.open_zarr(f"{uuid.uuid4()}")
 
     def test_with_chunkstore(self) -> None:
         expected = create_test_data()
         with self.create_zarr_target() as store_target, self.create_zarr_target() as chunk_store:
             save_kwargs = {"chunk_store": chunk_store}
             self.save(expected, store_target, **save_kwargs)
+            # the chunk store must have been populated with some entries
+            assert len(chunk_store) > 0
             open_kwargs = {"backend_kwargs": {"chunk_store": chunk_store}}
             with self.open(store_target, **open_kwargs) as ds:
                 assert_equal(ds, expected)
 
     @requires_dask
     def test_auto_chunk(self) -> None:
         original = create_test_data().chunk()
```

### Comparing `xarray-2023.5.0/xarray/tests/test_backends_api.py` & `xarray-2023.6.0/xarray/tests/test_backends_api.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_backends_common.py` & `xarray-2023.6.0/xarray/tests/test_backends_common.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_backends_file_manager.py` & `xarray-2023.6.0/xarray/tests/test_backends_file_manager.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_backends_lru_cache.py` & `xarray-2023.6.0/xarray/tests/test_backends_lru_cache.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_calendar_ops.py` & `xarray-2023.6.0/xarray/tests/test_calendar_ops.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_cftime_offsets.py` & `xarray-2023.6.0/xarray/tests/test_cftime_offsets.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_cftimeindex.py` & `xarray-2023.6.0/xarray/tests/test_cftimeindex.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_cftimeindex_resample.py` & `xarray-2023.6.0/xarray/tests/test_cftimeindex_resample.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_coarsen.py` & `xarray-2023.6.0/xarray/tests/test_coarsen.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_coding.py` & `xarray-2023.6.0/xarray/tests/test_coding.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_coding_strings.py` & `xarray-2023.6.0/xarray/tests/test_coding_strings.py`

 * *Files 2% similar despite different names*

```diff
@@ -28,14 +28,18 @@
 
     dtype = strings.create_vlen_dtype(bytes)
     assert dtype.metadata["element_type"] == bytes
     assert not strings.is_unicode_dtype(dtype)
     assert strings.is_bytes_dtype(dtype)
     assert strings.check_vlen_dtype(dtype) is bytes
 
+    # check h5py variant ("vlen")
+    dtype = np.dtype("O", metadata={"vlen": str})  # type: ignore[call-overload]
+    assert strings.check_vlen_dtype(dtype) is str
+
     assert strings.check_vlen_dtype(np.dtype(object)) is None
 
 
 @pytest.mark.parametrize("numpy_str_type", (np.str_, np.bytes_))
 def test_numpy_subclass_handling(numpy_str_type) -> None:
     with pytest.raises(TypeError, match="unsupported type for vlen_dtype"):
         strings.create_vlen_dtype(numpy_str_type)
```

### Comparing `xarray-2023.5.0/xarray/tests/test_coding_times.py` & `xarray-2023.6.0/xarray/tests/test_coding_times.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_combine.py` & `xarray-2023.6.0/xarray/tests/test_combine.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_computation.py` & `xarray-2023.6.0/xarray/tests/test_computation.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_concat.py` & `xarray-2023.6.0/xarray/tests/test_concat.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_conventions.py` & `xarray-2023.6.0/xarray/tests/test_conventions.py`

 * *Files 3% similar despite different names*

```diff
@@ -483,7 +483,22 @@
     assert_identical(actual, var)
 
 
 def test_decode_cf_error_includes_variable_name():
     ds = Dataset({"invalid": ([], 1e36, {"units": "days since 2000-01-01"})})
     with pytest.raises(ValueError, match="Failed to decode variable 'invalid'"):
         decode_cf(ds)
+
+
+def test_encode_cf_variable_with_vlen_dtype() -> None:
+    v = Variable(
+        ["x"], np.array(["a", "b"], dtype=coding.strings.create_vlen_dtype(str))
+    )
+    encoded_v = conventions.encode_cf_variable(v)
+    assert encoded_v.data.dtype.kind == "O"
+    assert coding.strings.check_vlen_dtype(encoded_v.data.dtype) == str
+
+    # empty array
+    v = Variable(["x"], np.array([], dtype=coding.strings.create_vlen_dtype(str)))
+    encoded_v = conventions.encode_cf_variable(v)
+    assert encoded_v.data.dtype.kind == "O"
+    assert coding.strings.check_vlen_dtype(encoded_v.data.dtype) == str
```

### Comparing `xarray-2023.5.0/xarray/tests/test_cupy.py` & `xarray-2023.6.0/xarray/tests/test_cupy.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_dask.py` & `xarray-2023.6.0/xarray/tests/test_dask.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_dataarray.py` & `xarray-2023.6.0/xarray/tests/test_dataarray.py`

 * *Files 2% similar despite different names*

```diff
@@ -1694,14 +1694,27 @@
 
         actual = data.reindex(x=data.x)
         expected = data
 
         assert_identical(expected, actual)
         assert actual.dtype == expected.dtype
 
+    def test_reindex_empty_array_dtype(self) -> None:
+        # Dtype of reindex result should match dtype of the original DataArray.
+        # See GH issue #7299
+        x = xr.DataArray([], dims=("x",), coords={"x": []}).astype("float32")
+        y = x.reindex(x=[1.0, 2.0])
+
+        assert (
+            x.dtype == y.dtype
+        ), "Dtype of reindexed DataArray should match dtype of the original DataArray"
+        assert (
+            y.dtype == np.float32
+        ), "Dtype of reindexed DataArray should remain float32"
+
     def test_rename(self) -> None:
         da = xr.DataArray(
             [1, 2, 3], dims="dim", name="name", coords={"coord": ("dim", [5, 6, 7])}
         )
 
         # change name
         renamed_name = da.rename("name_new")
@@ -3544,14 +3557,18 @@
         # Fix GH issue 684 - masked arrays mask should be an array not a scalar
         N = 4
         v = range(N)
         da = DataArray(v)
         ma = da.to_masked_array()
         assert len(ma.mask) == N
 
+    @pytest.mark.skipif(
+        Version(np.__version__) > Version("1.24") or sys.version_info[:2] > (3, 10),
+        reason="cdms2 is unmaintained and does not support newer `numpy` or python versions",
+    )
     def test_to_and_from_cdms2_classic(self) -> None:
         """Classic with 1D axes"""
         pytest.importorskip("cdms2")
 
         original = DataArray(
             np.arange(6).reshape(2, 3),
             [
@@ -3561,36 +3578,42 @@
             name="foo",
             attrs={"baz": 123},
         )
         expected_coords = [
             IndexVariable("distance", [-2, 2]),
             IndexVariable("time", [0, 1, 2]),
         ]
-        actual = original.to_cdms2()
+        with pytest.deprecated_call(match=".*cdms2"):
+            actual = original.to_cdms2()
         assert_array_equal(actual.asma(), original)
         assert actual.id == original.name
         assert tuple(actual.getAxisIds()) == original.dims
         for axis, coord in zip(actual.getAxisList(), expected_coords):
             assert axis.id == coord.name
             assert_array_equal(axis, coord.values)
         assert actual.baz == original.attrs["baz"]
 
         component_times = actual.getAxis(1).asComponentTime()
         assert len(component_times) == 3
         assert str(component_times[0]) == "2000-1-1 0:0:0.0"
 
-        roundtripped = DataArray.from_cdms2(actual)
+        with pytest.deprecated_call(match=".*cdms2"):
+            roundtripped = DataArray.from_cdms2(actual)
         assert_identical(original, roundtripped)
 
         back = from_cdms2(actual)
         assert original.dims == back.dims
         assert original.coords.keys() == back.coords.keys()
         for coord_name in original.coords.keys():
             assert_array_equal(original.coords[coord_name], back.coords[coord_name])
 
+    @pytest.mark.skipif(
+        Version(np.__version__) > Version("1.24") or sys.version_info[:2] > (3, 10),
+        reason="cdms2 is unmaintained and does not support newer `numpy` or python versions",
+    )
     def test_to_and_from_cdms2_sgrid(self) -> None:
         """Curvilinear (structured) grid
 
         The rectangular grid case is covered by the classic case
         """
         pytest.importorskip("cdms2")
 
@@ -3601,36 +3624,42 @@
         y = DataArray(np.arange(lon.shape[0]), dims=["y"], name="y")
         original = DataArray(
             lonlat.sum(axis=0),
             dims=["y", "x"],
             coords=dict(x=x, y=y, lon=lon, lat=lat),
             name="sst",
         )
-        actual = original.to_cdms2()
+        with pytest.deprecated_call():
+            actual = original.to_cdms2()
         assert tuple(actual.getAxisIds()) == original.dims
         assert_array_equal(original.coords["lon"], actual.getLongitude().asma())
         assert_array_equal(original.coords["lat"], actual.getLatitude().asma())
 
         back = from_cdms2(actual)
         assert original.dims == back.dims
         assert set(original.coords.keys()) == set(back.coords.keys())
         assert_array_equal(original.coords["lat"], back.coords["lat"])
         assert_array_equal(original.coords["lon"], back.coords["lon"])
 
+    @pytest.mark.skipif(
+        Version(np.__version__) > Version("1.24") or sys.version_info[:2] > (3, 10),
+        reason="cdms2 is unmaintained and does not support newer `numpy` or python versions",
+    )
     def test_to_and_from_cdms2_ugrid(self) -> None:
         """Unstructured grid"""
         pytest.importorskip("cdms2")
 
         lon = DataArray(np.random.uniform(size=5), dims=["cell"], name="lon")
         lat = DataArray(np.random.uniform(size=5), dims=["cell"], name="lat")
         cell = DataArray(np.arange(5), dims=["cell"], name="cell")
         original = DataArray(
             np.arange(5), dims=["cell"], coords={"lon": lon, "lat": lat, "cell": cell}
         )
-        actual = original.to_cdms2()
+        with pytest.deprecated_call(match=".*cdms2"):
+            actual = original.to_cdms2()
         assert tuple(actual.getAxisIds()) == original.dims
         assert_array_equal(original.coords["lon"], actual.getLongitude().getValue())
         assert_array_equal(original.coords["lat"], actual.getLatitude().getValue())
 
         back = from_cdms2(actual)
         assert set(original.dims) == set(back.dims)
         assert set(original.coords.keys()) == set(back.coords.keys())
@@ -4395,15 +4424,15 @@
             coords={"x": [0, 1, 2], "param": ["n0", "tau"]},
         )
 
         if use_dask:
             da = da.chunk({"x": 1})
 
         fit = da.curvefit(
-            coords=[da.t], func=exp_decay, p0={"n0": 4}, bounds={"tau": [2, 6]}
+            coords=[da.t], func=exp_decay, p0={"n0": 4}, bounds={"tau": (2, 6)}
         )
         assert_allclose(fit.curvefit_coefficients, expected, rtol=1e-3)
 
         da = da.compute()
         fit = da.curvefit(coords="t", func=np.power, reduce_dims="x", param_names=["a"])
         assert "a" in fit.param
         assert "x" not in fit.dims
@@ -4416,20 +4445,191 @@
         assert params == ["n0", "tau"]
         param_defaults, bounds_defaults = xr.core.dataset._initialize_curvefit_params(
             params, {"n0": 4}, {"tau": [5, np.inf]}, func_args
         )
         assert param_defaults == {"n0": 4, "tau": 6}
         assert bounds_defaults == {"n0": (-np.inf, np.inf), "tau": (5, np.inf)}
 
+        # DataArray as bound
+        param_defaults, bounds_defaults = xr.core.dataset._initialize_curvefit_params(
+            params=params,
+            p0={"n0": 4},
+            bounds={"tau": [DataArray([3, 4], coords=[("x", [1, 2])]), np.inf]},
+            func_args=func_args,
+        )
+        assert param_defaults["n0"] == 4
+        assert (
+            param_defaults["tau"] == xr.DataArray([4, 5], coords=[("x", [1, 2])])
+        ).all()
+        assert bounds_defaults["n0"] == (-np.inf, np.inf)
+        assert (
+            bounds_defaults["tau"][0] == DataArray([3, 4], coords=[("x", [1, 2])])
+        ).all()
+        assert bounds_defaults["tau"][1] == np.inf
+
         param_names = ["a"]
         params, func_args = xr.core.dataset._get_func_args(np.power, param_names)
         assert params == param_names
         with pytest.raises(ValueError):
             xr.core.dataset._get_func_args(np.power, [])
 
+    @requires_scipy
+    @pytest.mark.parametrize("use_dask", [True, False])
+    def test_curvefit_multidimensional_guess(self, use_dask: bool) -> None:
+        if use_dask and not has_dask:
+            pytest.skip("requires dask")
+
+        def sine(t, a, f, p):
+            return a * np.sin(2 * np.pi * (f * t + p))
+
+        t = np.arange(0, 2, 0.02)
+        da = DataArray(
+            np.stack([sine(t, 1.0, 2, 0), sine(t, 1.0, 2, 0)]),
+            coords={"x": [0, 1], "t": t},
+        )
+
+        # Fitting to a sine curve produces a different result depending on the
+        # initial guess: either the phase is zero and the amplitude is positive
+        # or the phase is 0.5 * 2pi and the amplitude is negative.
+
+        expected = DataArray(
+            [[1, 2, 0], [-1, 2, 0.5]],
+            coords={"x": [0, 1], "param": ["a", "f", "p"]},
+        )
+
+        # Different initial guesses for different values of x
+        a_guess = DataArray([1, -1], coords=[da.x])
+        p_guess = DataArray([0, 0.5], coords=[da.x])
+
+        if use_dask:
+            da = da.chunk({"x": 1})
+
+        fit = da.curvefit(
+            coords=[da.t],
+            func=sine,
+            p0={"a": a_guess, "p": p_guess, "f": 2},
+        )
+        assert_allclose(fit.curvefit_coefficients, expected)
+
+        with pytest.raises(
+            ValueError,
+            match=r"Initial guess for 'a' has unexpected dimensions .* should only have "
+            "dimensions that are in data dimensions",
+        ):
+            # initial guess with additional dimensions should be an error
+            da.curvefit(
+                coords=[da.t],
+                func=sine,
+                p0={"a": DataArray([1, 2], coords={"foo": [1, 2]})},
+            )
+
+    @requires_scipy
+    @pytest.mark.parametrize("use_dask", [True, False])
+    def test_curvefit_multidimensional_bounds(self, use_dask: bool) -> None:
+        if use_dask and not has_dask:
+            pytest.skip("requires dask")
+
+        def sine(t, a, f, p):
+            return a * np.sin(2 * np.pi * (f * t + p))
+
+        t = np.arange(0, 2, 0.02)
+        da = xr.DataArray(
+            np.stack([sine(t, 1.0, 2, 0), sine(t, 1.0, 2, 0)]),
+            coords={"x": [0, 1], "t": t},
+        )
+
+        # Fit a sine with different bounds: positive amplitude should result in a fit with
+        # phase 0 and negative amplitude should result in phase 0.5 * 2pi.
+
+        expected = DataArray(
+            [[1, 2, 0], [-1, 2, 0.5]],
+            coords={"x": [0, 1], "param": ["a", "f", "p"]},
+        )
+
+        if use_dask:
+            da = da.chunk({"x": 1})
+
+        fit = da.curvefit(
+            coords=[da.t],
+            func=sine,
+            p0={"f": 2, "p": 0.25},  # this guess is needed to get the expected result
+            bounds={
+                "a": (
+                    DataArray([0, -2], coords=[da.x]),
+                    DataArray([2, 0], coords=[da.x]),
+                ),
+            },
+        )
+        assert_allclose(fit.curvefit_coefficients, expected)
+
+        # Scalar lower bound with array upper bound
+        fit2 = da.curvefit(
+            coords=[da.t],
+            func=sine,
+            p0={"f": 2, "p": 0.25},  # this guess is needed to get the expected result
+            bounds={
+                "a": (-2, DataArray([2, 0], coords=[da.x])),
+            },
+        )
+        assert_allclose(fit2.curvefit_coefficients, expected)
+
+        with pytest.raises(
+            ValueError,
+            match=r"Upper bound for 'a' has unexpected dimensions .* should only have "
+            "dimensions that are in data dimensions",
+        ):
+            # bounds with additional dimensions should be an error
+            da.curvefit(
+                coords=[da.t],
+                func=sine,
+                bounds={"a": (0, DataArray([1], coords={"foo": [1]}))},
+            )
+
+    @requires_scipy
+    @pytest.mark.parametrize("use_dask", [True, False])
+    def test_curvefit_ignore_errors(self, use_dask: bool) -> None:
+        if use_dask and not has_dask:
+            pytest.skip("requires dask")
+
+        # nonsense function to make the optimization fail
+        def line(x, a, b):
+            if a > 10:
+                return 0
+            return a * x + b
+
+        da = DataArray(
+            [[1, 3, 5], [0, 20, 40]],
+            coords={"i": [1, 2], "x": [0.0, 1.0, 2.0]},
+        )
+
+        if use_dask:
+            da = da.chunk({"i": 1})
+
+        expected = DataArray(
+            [[2, 1], [np.nan, np.nan]], coords={"i": [1, 2], "param": ["a", "b"]}
+        )
+
+        with pytest.raises(RuntimeError, match="calls to function has reached maxfev"):
+            da.curvefit(
+                coords="x",
+                func=line,
+                # limit maximum number of calls so the optimization fails
+                kwargs=dict(maxfev=5),
+            ).compute()  # have to compute to raise the error
+
+        fit = da.curvefit(
+            coords="x",
+            func=line,
+            errors="ignore",
+            # limit maximum number of calls so the optimization fails
+            kwargs=dict(maxfev=5),
+        ).compute()
+
+        assert_allclose(fit.curvefit_coefficients, expected)
+
 
 class TestReduce:
     @pytest.fixture(autouse=True)
     def setup(self):
         self.attrs = {"attr1": "value1", "attr2": 2929}
```

### Comparing `xarray-2023.5.0/xarray/tests/test_dataset.py` & `xarray-2023.6.0/xarray/tests/test_dataset.py`

 * *Files 0% similar despite different names*

```diff
@@ -6213,14 +6213,22 @@
         out = ds.polyfit("dim1", 2, full=True)
         assert "var1_polyfit_coefficients" in out
         assert "dim1_matrix_rank" in out
 
         out = ds.polyfit("time", 2)
         assert len(out.data_vars) == 0
 
+    def test_polyfit_weighted(self) -> None:
+        # Make sure weighted polyfit does not change the original object (issue #5644)
+        ds = create_test_data(seed=1)
+        ds_copy = ds.copy(deep=True)
+
+        ds.polyfit("dim2", 2, w=np.arange(ds.sizes["dim2"]))
+        xr.testing.assert_identical(ds, ds_copy)
+
     def test_polyfit_warnings(self) -> None:
         ds = create_test_data(seed=1)
 
         with warnings.catch_warnings(record=True) as ws:
             ds.var1.polyfit("dim2", 10, full=False)
             assert len(ws) == 1
             assert ws[0].category == np.RankWarning
```

### Comparing `xarray-2023.5.0/xarray/tests/test_deprecation_helpers.py` & `xarray-2023.6.0/xarray/tests/test_deprecation_helpers.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_distributed.py` & `xarray-2023.6.0/xarray/tests/test_distributed.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_dtypes.py` & `xarray-2023.6.0/xarray/tests/test_dtypes.py`

 * *Files 7% similar despite different names*

```diff
@@ -14,25 +14,25 @@
         ([np.float32, np.float64], np.float64),
         ([np.float32, np.string_], np.object_),
         ([np.unicode_, np.int64], np.object_),
         ([np.unicode_, np.unicode_], np.unicode_),
         ([np.bytes_, np.unicode_], np.object_),
     ],
 )
-def test_result_type(args, expected):
+def test_result_type(args, expected) -> None:
     actual = dtypes.result_type(*args)
     assert actual == expected
 
 
-def test_result_type_scalar():
+def test_result_type_scalar() -> None:
     actual = dtypes.result_type(np.arange(3, dtype=np.float32), np.nan)
     assert actual == np.float32
 
 
-def test_result_type_dask_array():
+def test_result_type_dask_array() -> None:
     # verify it works without evaluating dask arrays
     da = pytest.importorskip("dask.array")
     dask = pytest.importorskip("dask")
 
     def error():
         raise RuntimeError
 
@@ -46,15 +46,15 @@
     # note that this differs from the behavior for scalar numpy arrays, which
     # would get promoted to float32
     actual = dtypes.result_type(array, np.array([0.5, 1.0], dtype=np.float32))
     assert actual == np.float64
 
 
 @pytest.mark.parametrize("obj", [1.0, np.inf, "ab", 1.0 + 1.0j, True])
-def test_inf(obj):
+def test_inf(obj) -> None:
     assert dtypes.INF > obj
     assert dtypes.NINF < obj
 
 
 @pytest.mark.parametrize(
     "kind, expected",
     [
@@ -81,20 +81,20 @@
         ("q", (np.float64, "nan")),  # dtype('int64')
         ("Q", (np.float64, "nan")),  # dtype('uint64')
         ("S", (np.dtype("O"), "nan")),  # dtype('S')
         ("U", (np.dtype("O"), "nan")),  # dtype('<U')
         ("V", (np.dtype("O"), "nan")),  # dtype('V')
     ],
 )
-def test_maybe_promote(kind, expected):
+def test_maybe_promote(kind, expected) -> None:
     # 'g': np.float128 is not tested : not available on all platforms
     # 'G': np.complex256 is not tested : not available on all platforms
 
     actual = dtypes.maybe_promote(np.dtype(kind))
     assert actual[0] == expected[0]
     assert str(actual[1]) == expected[1]
 
 
-def test_nat_types_membership():
+def test_nat_types_membership() -> None:
     assert np.datetime64("NaT").dtype in dtypes.NAT_TYPES
     assert np.timedelta64("NaT").dtype in dtypes.NAT_TYPES
     assert np.float64 not in dtypes.NAT_TYPES
```

### Comparing `xarray-2023.5.0/xarray/tests/test_duck_array_ops.py` & `xarray-2023.6.0/xarray/tests/test_duck_array_ops.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_extensions.py` & `xarray-2023.6.0/xarray/tests/test_extensions.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_formatting.py` & `xarray-2023.6.0/xarray/tests/test_formatting.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_formatting_html.py` & `xarray-2023.6.0/xarray/tests/test_formatting_html.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_groupby.py` & `xarray-2023.6.0/xarray/tests/test_groupby.py`

 * *Files 1% similar despite different names*

```diff
@@ -133,14 +133,26 @@
     array_copy = array.copy()
     expected = xr.DataArray([3, 3], [("x", [1, 2])])
     actual = array.groupby("x").sum()
     assert_identical(expected, actual)
     assert_identical(array, array_copy)  # should not modify inputs
 
 
+@pytest.mark.parametrize("use_flox", [True, False])
+def test_groupby_indexvariable(use_flox: bool) -> None:
+    # regression test for GH7919
+    array = xr.DataArray([1, 2, 3], [("x", [2, 2, 1])])
+    iv = xr.IndexVariable(dims="x", data=pd.Index(array.x.values))
+    with xr.set_options(use_flox=use_flox):
+        actual = array.groupby(iv).sum()
+    actual = array.groupby(iv).sum()
+    expected = xr.DataArray([3, 3], [("x", [1, 2])])
+    assert_identical(expected, actual)
+
+
 @pytest.mark.parametrize(
     "obj",
     [
         xr.DataArray([1, 2, 3, 4, 5, 6], [("x", [1, 1, 1, 2, 2, 2])]),
         xr.Dataset({"foo": ("x", [1, 2, 3, 4, 5, 6])}, {"x": [1, 1, 1, 2, 2, 2]}),
     ],
 )
@@ -2336,14 +2348,22 @@
 
     # two typical ways of computing anomalies
     anom_gb = x_slice.groupby("time.month") - clim
 
     assert_identical(xr.zeros_like(anom_gb), anom_gb)
 
 
+def test_groupby_multiindex_level() -> None:
+    # GH6836
+    midx = pd.MultiIndex.from_product([list("abc"), [0, 1]], names=("one", "two"))
+    mda = xr.DataArray(np.random.rand(6, 3), [("x", midx), ("y", range(3))])
+    groups = mda.groupby("one").groups
+    assert groups == {"a": [0, 1], "b": [2, 3], "c": [4, 5]}
+
+
 @requires_flox
 @pytest.mark.parametrize("func", ["sum", "prod"])
 @pytest.mark.parametrize("skipna", [True, False])
 @pytest.mark.parametrize("min_count", [None, 1])
 def test_min_count_vs_flox(func: str, min_count: int | None, skipna: bool) -> None:
     da = DataArray(
         data=np.array([np.nan, 1, 1, np.nan, 1, 1]),
```

### Comparing `xarray-2023.5.0/xarray/tests/test_indexes.py` & `xarray-2023.6.0/xarray/tests/test_indexes.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_indexing.py` & `xarray-2023.6.0/xarray/tests/test_indexing.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_interp.py` & `xarray-2023.6.0/xarray/tests/test_interp.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_merge.py` & `xarray-2023.6.0/xarray/tests/test_merge.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_missing.py` & `xarray-2023.6.0/xarray/tests/test_missing.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_nputils.py` & `xarray-2023.6.0/xarray/tests/test_nputils.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_options.py` & `xarray-2023.6.0/xarray/tests/test_options.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_parallelcompat.py` & `xarray-2023.6.0/xarray/tests/test_parallelcompat.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_plot.py` & `xarray-2023.6.0/xarray/tests/test_plot.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_plugins.py` & `xarray-2023.6.0/xarray/tests/test_plugins.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_rolling.py` & `xarray-2023.6.0/xarray/tests/test_rolling.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_sparse.py` & `xarray-2023.6.0/xarray/tests/test_sparse.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_testing.py` & `xarray-2023.6.0/xarray/tests/test_testing.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_tutorial.py` & `xarray-2023.6.0/xarray/tests/test_tutorial.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_ufuncs.py` & `xarray-2023.6.0/xarray/tests/test_ufuncs.py`

 * *Files 3% similar despite different names*

```diff
@@ -1,35 +1,35 @@
 from __future__ import annotations
 
 import numpy as np
 import pytest
 
 import xarray as xr
-from xarray.tests import assert_array_equal, mock
+from xarray.tests import assert_allclose, assert_array_equal, mock
 from xarray.tests import assert_identical as assert_identical_
 
 
 def assert_identical(a, b):
     assert type(a) is type(b) or float(a) == float(b)
     if isinstance(a, (xr.DataArray, xr.Dataset, xr.Variable)):
         assert_identical_(a, b)
     else:
         assert_array_equal(a, b)
 
 
-def test_unary():
-    args = [
-        0,
-        np.zeros(2),
+@pytest.mark.parametrize(
+    "a",
+    [
         xr.Variable(["x"], [0, 0]),
         xr.DataArray([0, 0], dims="x"),
         xr.Dataset({"y": ("x", [0, 0])}),
-    ]
-    for a in args:
-        assert_identical(a + 1, np.cos(a))
+    ],
+)
+def test_unary(a):
+    assert_allclose(a + 1, np.cos(a))
 
 
 def test_binary():
     args = [
         0,
         np.zeros(2),
         xr.Variable(["x"], [0, 0]),
```

### Comparing `xarray-2023.5.0/xarray/tests/test_units.py` & `xarray-2023.6.0/xarray/tests/test_units.py`

 * *Files 0% similar despite different names*

```diff
@@ -5623,24 +5623,28 @@
 
         assert_units_equal(expected, actual)
         assert_equal(expected, actual)
 
 
 @requires_dask
 class TestPintWrappingDask:
+    @pytest.mark.skipif(
+        version.parse(pint.__version__) <= version.parse("0.21"),
+        reason="pint didn't support dask properly before 0.21",
+    )
     def test_duck_array_ops(self):
         import dask.array
 
         d = dask.array.array([1, 2, 3])
-        q = pint.Quantity(d, units="m")
+        q = unit_registry.Quantity(d, units="m")
         da = xr.DataArray(q, dims="x")
 
         actual = da.mean().compute()
         actual.name = None
-        expected = xr.DataArray(pint.Quantity(np.array(2.0), units="m"))
+        expected = xr.DataArray(unit_registry.Quantity(np.array(2.0), units="m"))
 
         assert_units_equal(expected, actual)
         # Don't use isinstance b/c we don't want to allow subclasses through
         assert type(expected.data) == type(actual.data)  # noqa
 
 
 @requires_matplotlib
```

### Comparing `xarray-2023.5.0/xarray/tests/test_utils.py` & `xarray-2023.6.0/xarray/tests/test_utils.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_variable.py` & `xarray-2023.6.0/xarray/tests/test_variable.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tests/test_weighted.py` & `xarray-2023.6.0/xarray/tests/test_weighted.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/tutorial.py` & `xarray-2023.6.0/xarray/tutorial.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/util/deprecation_helpers.py` & `xarray-2023.6.0/xarray/util/deprecation_helpers.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/util/generate_aggregations.py` & `xarray-2023.6.0/xarray/util/generate_aggregations.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/util/generate_ops.py` & `xarray-2023.6.0/xarray/util/generate_ops.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray/util/print_versions.py` & `xarray-2023.6.0/xarray/util/print_versions.py`

 * *Files identical despite different names*

### Comparing `xarray-2023.5.0/xarray.egg-info/PKG-INFO` & `xarray-2023.6.0/xarray.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: xarray
-Version: 2023.5.0
+Version: 2023.6.0
 Summary: N-D labeled arrays and datasets in Python
 Home-page: https://github.com/pydata/xarray
 Author: xarray Developers
 Author-email: xarray@googlegroups.com
 License: Apache-2.0
 Classifier: Development Status :: 5 - Production/Stable
 Classifier: License :: OSI Approved :: Apache Software License
```

### Comparing `xarray-2023.5.0/xarray.egg-info/SOURCES.txt` & `xarray-2023.6.0/xarray.egg-info/SOURCES.txt`

 * *Files 1% similar despite different names*

```diff
@@ -31,18 +31,17 @@
 .github/workflows/benchmarks-last-release.yml
 .github/workflows/benchmarks.yml
 .github/workflows/ci-additional.yaml
 .github/workflows/ci.yaml
 .github/workflows/configure-testpypi-version.py
 .github/workflows/label-all.yml
 .github/workflows/label-prs.yml
-.github/workflows/parse_logs.py
+.github/workflows/nightly-wheels.yml
 .github/workflows/publish-test-results.yaml
 .github/workflows/pypi-release.yaml
-.github/workflows/testpypi-release.yaml
 .github/workflows/upstream-dev-ci.yaml
 asv_bench/asv.conf.json
 asv_bench/benchmarks/README_CI.md
 asv_bench/benchmarks/__init__.py
 asv_bench/benchmarks/accessors.py
 asv_bench/benchmarks/alignment.py
 asv_bench/benchmarks/combine.py
```

### Comparing `xarray-2023.5.0/xarray.egg-info/requires.txt` & `xarray-2023.6.0/xarray.egg-info/requires.txt`

 * *Files identical despite different names*

